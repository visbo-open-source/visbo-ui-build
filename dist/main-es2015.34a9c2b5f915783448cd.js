(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(t,e,i){t.exports=i("zUnb")},KtZj:function(t,e,i){"use strict";var n,r;"undefined"!=typeof window&&window,void 0===(r="function"==typeof(n=function(){if("undefined"==typeof window)return null;var t="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),e=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||function(e){return t.setTimeout(e,20)},i=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||function(e){t.clearTimeout(e)};function n(t,e){var i=Object.prototype.toString.call(t),n="[object Array]"===i||"[object NodeList]"===i||"[object HTMLCollection]"===i||"[object Object]"===i||"undefined"!=typeof jQuery&&t instanceof jQuery||"undefined"!=typeof Elements&&t instanceof Elements,r=0,s=t.length;if(n)for(;r<s;r++)e(t[r]);else e(t)}function r(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var e=t.getBoundingClientRect();return{width:Math.round(e.width),height:Math.round(e.height)}}function s(t,e){Object.keys(e).forEach((function(i){t.style[i]=e[i]}))}var o=function(t,a){var l=0;function c(){var t,e,i=[];this.add=function(t){i.push(t)},this.call=function(n){for(t=0,e=i.length;t<e;t++)i[t].call(this,n)},this.remove=function(n){var r=[];for(t=0,e=i.length;t<e;t++)i[t]!==n&&r.push(i[t]);i=r},this.length=function(){return i.length}}n(t,(function(t){!function(t,i){if(t)if(t.resizedAttached)t.resizedAttached.add(i);else{t.resizedAttached=new c,t.resizedAttached.add(i),t.resizeSensor=document.createElement("div"),t.resizeSensor.dir="ltr",t.resizeSensor.className="resize-sensor";var n={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},o={position:"absolute",left:"0px",top:"0px",transition:"0s"};s(t.resizeSensor,n);var a=document.createElement("div");a.className="resize-sensor-expand",s(a,n);var d=document.createElement("div");s(d,o),a.appendChild(d);var u=document.createElement("div");u.className="resize-sensor-shrink",s(u,n);var h=document.createElement("div");s(h,o),s(h,{width:"200%",height:"200%"}),u.appendChild(h),t.resizeSensor.appendChild(a),t.resizeSensor.appendChild(u),t.appendChild(t.resizeSensor);var p=window.getComputedStyle(t),g=p?p.getPropertyValue("position"):null;"absolute"!==g&&"relative"!==g&&"fixed"!==g&&"sticky"!==g&&(t.style.position="relative");var m=!1,f=0,v=r(t),b=0,y=0,C=!0;l=0;var V=function(){if(C){if(0===t.offsetWidth&&0===t.offsetHeight)return void(l||(l=e((function(){l=0,V()}))));C=!1}var i,n;n=t.offsetHeight,d.style.width=(i=t.offsetWidth)+10+"px",d.style.height=n+10+"px",a.scrollLeft=i+10,a.scrollTop=n+10,u.scrollLeft=i+10,u.scrollTop=n+10};t.resizeSensor.resetSensor=V;var w=function(){f=0,m&&(b=v.width,y=v.height,t.resizedAttached&&t.resizedAttached.call(v))},A=function(){v=r(t),(m=v.width!==b||v.height!==y)&&!f&&(f=e(w)),V()},P=function(t,e,i){t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener(e,i)};P(a,"scroll",A),P(u,"scroll",A),l=e((function(){l=0,V()}))}}(t,a)})),this.detach=function(e){l||(i(l),l=0),o.detach(t,e)},this.reset=function(){t.resizeSensor.resetSensor()}};if(o.reset=function(t){n(t,(function(t){t.resizeSensor.resetSensor()}))},o.detach=function(t,e){n(t,(function(t){t&&(t.resizedAttached&&"function"==typeof e&&(t.resizedAttached.remove(e),t.resizedAttached.length())||t.resizeSensor&&(t.contains(t.resizeSensor)&&t.removeChild(t.resizeSensor),delete t.resizeSensor,delete t.resizedAttached))}))},"undefined"!=typeof MutationObserver){var a=new MutationObserver((function(t){for(var e in t)if(t.hasOwnProperty(e))for(var i=t[e].addedNodes,n=0;n<i.length;n++)i[n].resizeSensor&&o.reset(i[n])}));document.addEventListener("DOMContentLoaded",(function(t){a.observe(document.body,{childList:!0,subtree:!0})}))}return o})?n.call(e,i,e,t):n)||(t.exports=r)},crnd:function(t,e){function i(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}i.keys=function(){return[]},i.resolve=i,t.exports=i,i.id="crnd"},h9Sk:function(t,e,i){t.exports={ResizeSensor:i("KtZj"),ElementQueries:i("rnKy")}},rnKy:function(t,e,i){"use strict";var n,r,s;"undefined"!=typeof window&&window,r=[i("KtZj")],void 0===(s="function"==typeof(n=function(t){var e=function(){var e,i={},n=[];function r(t){t||(t=document.documentElement);var e=window.getComputedStyle(t,null).fontSize;return parseFloat(e)||16}function s(t,e){var i=e.split(/\d/),n=i[i.length-1];switch(e=parseFloat(e),n){case"px":return e;case"em":return e*r(t);case"rem":return e*r();case"vw":return e*document.documentElement.clientWidth/100;case"vh":return e*document.documentElement.clientHeight/100;case"vmin":case"vmax":var s=document.documentElement.clientWidth/100,o=document.documentElement.clientHeight/100;return e*(0,Math["vmin"===n?"min":"max"])(s,o);default:return e}}function o(t,e){var n,r,o,a,l,c,d,u;this.element=t;var h=["min-width","min-height","max-width","max-height"];this.call=function(){for(n in o=function(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var e=t.getBoundingClientRect();return{width:Math.round(e.width),height:Math.round(e.height)}}(this.element),c={},i[e])i[e].hasOwnProperty(n)&&(a=s(this.element,(r=i[e][n]).value),l="width"===r.property?o.width:o.height,d="","min"===r.mode&&l>=a&&(d+=r.value),"max"===r.mode&&l<=a&&(d+=r.value),c[u=r.mode+"-"+r.property]||(c[u]=""),d&&-1===(" "+c[u]+" ").indexOf(" "+d+" ")&&(c[u]+=" "+d));for(var t in h)h.hasOwnProperty(t)&&(c[h[t]]?this.element.setAttribute(h[t],c[h[t]].substr(1)):this.element.removeAttribute(h[t]))}}function a(e,i){e.elementQueriesSetupInformation||(e.elementQueriesSetupInformation=new o(e,i)),e.elementQueriesSensor||(e.elementQueriesSensor=new t(e,(function(){e.elementQueriesSetupInformation.call()})))}function l(t,r,s,o){if(void 0===i[t]){i[t]=[];var a=n.length;e.innerHTML+="\n"+t+" {animation: 0.1s element-queries;}",e.innerHTML+="\n"+t+" > .resize-sensor {min-width: "+a+"px;}",n.push(t)}i[t].push({mode:r,property:s,value:o})}function c(t){var e;if(document.querySelectorAll&&(e=t?t.querySelectorAll.bind(t):document.querySelectorAll.bind(document)),e||"undefined"==typeof $$||(e=$$),e||"undefined"==typeof jQuery||(e=jQuery),!e)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return e}function d(e){var i=[],n=[],r=[],s=0,o=-1,a=[];for(var l in e.children)if(e.children.hasOwnProperty(l)&&e.children[l].tagName&&"img"===e.children[l].tagName.toLowerCase()){i.push(e.children[l]);var c=e.children[l].getAttribute("min-width")||e.children[l].getAttribute("data-min-width"),d=e.children[l].getAttribute("data-src")||e.children[l].getAttribute("url");r.push(d),n.push({minWidth:c}),c?e.children[l].style.display="none":(s=i.length-1,e.children[l].style.display="block")}function u(){var t,l=!1;for(t in i)i.hasOwnProperty(t)&&n[t].minWidth&&e.offsetWidth>n[t].minWidth&&(l=t);if(l||(l=s),o!==l)if(a[l])i[o].style.display="none",i[l].style.display="block",o=l;else{var c=new Image;c.onload=function(){i[l].src=r[l],i[o].style.display="none",i[l].style.display="block",a[l]=!0,o=l},c.src=r[l]}else i[l].src=r[l]}o=s,e.resizeSensorInstance=new t(e,u),u()}var u=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,h=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function p(t){var e,i,n,r;for(t=t.replace(/'/g,'"');null!==(e=u.exec(t));)for(i=e[1]+e[3],n=e[2];null!==(r=h.exec(n));)l(i,r[1],r[2],r[3])}function g(t){var e="";if(t)if("string"==typeof t)-1===(t=t.toLowerCase()).indexOf("min-width")&&-1===t.indexOf("max-width")||p(t);else for(var i=0,n=t.length;i<n;i++)1===t[i].type?-1!==(e=t[i].selectorText||t[i].cssText).indexOf("min-height")||-1!==e.indexOf("max-height")?p(e):-1===e.indexOf("min-width")&&-1===e.indexOf("max-width")||p(e):4===t[i].type?g(t[i].cssRules||t[i].rules):3===t[i].type&&t[i].styleSheet.hasOwnProperty("cssRules")&&g(t[i].styleSheet.cssRules)}var m=!1;this.init=function(){var i="animationstart";void 0!==document.documentElement.style.webkitAnimationName?i="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?i="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(i="oanimationstart"),document.body.addEventListener(i,(function(e){var i=e.target,r=i&&window.getComputedStyle(i,null),s=r&&r.getPropertyValue("animation-name");if(s&&-1!==s.indexOf("element-queries")){i.elementQueriesSensor=new t(i,(function(){i.elementQueriesSetupInformation&&i.elementQueriesSetupInformation.call()}));var o=window.getComputedStyle(i.resizeSensor,null).getPropertyValue("min-width");o=parseInt(o.replace("px","")),a(e.target,n[o])}})),m||((e=document.createElement("style")).type="text/css",e.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",e.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(e),m=!0);for(var r=0,s=document.styleSheets.length;r<s;r++)try{document.styleSheets[r].href&&0===document.styleSheets[r].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[r].href),g(document.styleSheets[r].cssRules||document.styleSheets[r].rules||document.styleSheets[r].cssText)}catch(o){}!function(){for(var t=c()("[data-responsive-image],[responsive-image]"),e=0,i=t.length;e<i;e++)d(t[e])}()},this.findElementQueriesElements=function(t){!function(t){var e=c(t);for(var n in i)if(i.hasOwnProperty(n))for(var r=e(n,t),s=0,o=r.length;s<o;s++)a(r[s],n)}(t)},this.update=function(){this.init()}};return e.update=function(){e.instance.update()},e.detach=function(t){t.elementQueriesSetupInformation?(t.elementQueriesSensor.detach(),delete t.elementQueriesSetupInformation,delete t.elementQueriesSensor):t.resizeSensorInstance&&(t.resizeSensorInstance.detach(),delete t.resizeSensorInstance)},e.init=function(){e.instance||(e.instance=new e),e.instance.init()},e.findElementQueriesElements=function(t){e.instance.findElementQueriesElements(t)},e.listen=function(){!function(t){if(document.addEventListener)document.addEventListener("DOMContentLoaded",t,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var e=setInterval((function(){/loaded|complete/i.test(document.readyState)&&(t(),clearInterval(e))}),10);else window.onload=t}(e.init)},e})?n.apply(e,r):n)||(t.exports=s)},zUnb:function(t,e,i){"use strict";function n(t){return"function"==typeof t}i.r(e);let r=!1;const s={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else r&&console.log("RxJS: Back to a better error behavior. Thank you. <3");r=t},get useDeprecatedSynchronousErrorHandling(){return r}};function o(t){setTimeout(()=>{throw t},0)}const a={closed:!0,next(t){},error(t){if(s.useDeprecatedSynchronousErrorHandling)throw t;o(t)},complete(){}},l=(()=>Array.isArray||(t=>t&&"number"==typeof t.length))();function c(t){return null!==t&&"object"==typeof t}const d=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();let u=(()=>{class t{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:i,_ctorUnsubscribe:r,_unsubscribe:s,_subscriptions:o}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,i instanceof t)i.remove(this);else if(null!==i)for(let t=0;t<i.length;++t)i[t].remove(this);if(n(s)){r&&(this._unsubscribe=void 0);try{s.call(this)}catch(a){e=a instanceof d?h(a.errors):[a]}}if(l(o)){let t=-1,i=o.length;for(;++t<i;){const i=o[t];if(c(i))try{i.unsubscribe()}catch(a){e=e||[],a instanceof d?e=e.concat(h(a.errors)):e.push(a)}}}if(e)throw new d(e)}add(e){let i=e;if(!e)return t.EMPTY;switch(typeof e){case"function":i=new t(e);case"object":if(i===this||i.closed||"function"!=typeof i.unsubscribe)return i;if(this.closed)return i.unsubscribe(),i;if(!(i instanceof t)){const e=i;i=new t,i._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:n}=i;if(null===n)i._parentOrParents=this;else if(n instanceof t){if(n===this)return i;i._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return i;n.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[i]:r.push(i),i}remove(t){const e=this._subscriptions;if(e){const i=e.indexOf(t);-1!==i&&e.splice(i,1)}}}return t.EMPTY=function(t){return t.closed=!0,t}(new t),t})();function h(t){return t.reduce((t,e)=>t.concat(e instanceof d?e.errors:e),[])}const p=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())();class g extends u{constructor(t,e,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=a;break;case 1:if(!t){this.destination=a;break}if("object"==typeof t){t instanceof g?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new m(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new m(this,t,e,i)}}[p](){return this}static create(t,e,i){const n=new g(t,e,i);return n.syncErrorThrowable=!1,n}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class m extends g{constructor(t,e,i,r){let s;super(),this._parentSubscriber=t;let o=this;n(e)?s=e:e&&(s=e.next,i=e.error,r=e.complete,e!==a&&(o=Object.create(e),n(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=s,this._error=i,this._complete=r}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;s.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:i}=s;if(this._error)i&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)i?(e.syncErrorValue=t,e.syncErrorThrown=!0):o(t),this.unsubscribe();else{if(this.unsubscribe(),i)throw t;o(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);s.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(i){if(this.unsubscribe(),s.useDeprecatedSynchronousErrorHandling)throw i;o(i)}}__tryOrSetError(t,e,i){if(!s.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,i)}catch(n){return s.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=n,t.syncErrorThrown=!0,!0):(o(n),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const f=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")();function v(t){return t}let b=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(t,e,i){const{operator:n}=this,r=function(t,e,i){if(t){if(t instanceof g)return t;if(t[p])return t[p]()}return t||e||i?new g(t,e,i):new g(a)}(t,e,i);if(r.add(n?n.call(r,this.source):this.source||s.useDeprecatedSynchronousErrorHandling&&!r.syncErrorThrowable?this._subscribe(r):this._trySubscribe(r)),s.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable&&(r.syncErrorThrowable=!1,r.syncErrorThrown))throw r.syncErrorValue;return r}_trySubscribe(t){try{return this._subscribe(t)}catch(e){s.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:i,isStopped:n}=t;if(e||n)return!1;t=i&&i instanceof g?i:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=y(e))((e,i)=>{let n;n=this.subscribe(e=>{try{t(e)}catch(r){i(r),n&&n.unsubscribe()}},i,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[f](){return this}pipe(...t){return 0===t.length?this:(0===(e=t).length?v:1===e.length?e[0]:function(t){return e.reduce((t,e)=>e(t),t)})(this);var e}toPromise(t){return new(t=y(t))((t,e)=>{let i;this.subscribe(t=>i=t,t=>e(t),()=>t(i))})}}return t.create=e=>new t(e),t})();function y(t){if(t||(t=s.Promise||Promise),!t)throw new Error("no Promise impl found");return t}const C=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class V extends u{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const i=e.indexOf(this.subscriber);-1!==i&&e.splice(i,1)}}class w extends g{constructor(t){super(t),this.destination=t}}let A=(()=>{class t extends b{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[p](){return new w(this)}lift(t){const e=new P(this,this);return e.operator=t,e}next(t){if(this.closed)throw new C;if(!this.isStopped){const{observers:e}=this,i=e.length,n=e.slice();for(let r=0;r<i;r++)n[r].next(t)}}error(t){if(this.closed)throw new C;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,i=e.length,n=e.slice();for(let r=0;r<i;r++)n[r].error(t);this.observers.length=0}complete(){if(this.closed)throw new C;this.isStopped=!0;const{observers:t}=this,e=t.length,i=t.slice();for(let n=0;n<e;n++)i[n].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new C;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new C;return this.hasError?(t.error(this.thrownError),u.EMPTY):this.isStopped?(t.complete(),u.EMPTY):(this.observers.push(t),new V(this,t))}asObservable(){const t=new b;return t.source=this,t}}return t.create=(t,e)=>new P(t,e),t})();class P extends A{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):u.EMPTY}}function k(t){return t&&"function"==typeof t.schedule}function D(t,e){return function(i){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new M(t,e))}}class M{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new S(t,this.project,this.thisArg))}}class S extends g{constructor(t,e,i){super(t),this.project=e,this.count=0,this.thisArg=i||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(e)}}const I=t=>e=>{for(let i=0,n=t.length;i<n&&!e.closed;i++)e.next(t[i]);e.complete()};function x(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const T=x(),_=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function U(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const E=t=>{if(t&&"function"==typeof t[f])return n=t,t=>{const e=n[f]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(_(t))return I(t);if(U(t))return i=t,t=>(i.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,o),t);if(t&&"function"==typeof t[T])return e=t,t=>{const i=e[T]();for(;;){let e;try{e=i.next()}catch(n){return t.error(n),t}if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof i.return&&t.add(()=>{i.return&&i.return()}),t};{const e=c(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var e,i,n};function O(t,e){return new b(i=>{const n=new u;let r=0;return n.add(e.schedule((function(){r!==t.length?(i.next(t[r++]),i.closed||n.add(this.schedule())):i.complete()}))),n})}function G(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[f]}(t))return function(t,e){return new b(i=>{const n=new u;return n.add(e.schedule(()=>{const r=t[f]();n.add(r.subscribe({next(t){n.add(e.schedule(()=>i.next(t)))},error(t){n.add(e.schedule(()=>i.error(t)))},complete(){n.add(e.schedule(()=>i.complete()))}}))})),n})}(t,e);if(U(t))return function(t,e){return new b(i=>{const n=new u;return n.add(e.schedule(()=>t.then(t=>{n.add(e.schedule(()=>{i.next(t),n.add(e.schedule(()=>i.complete()))}))},t=>{n.add(e.schedule(()=>i.error(t)))}))),n})}(t,e);if(_(t))return O(t,e);if(function(t){return t&&"function"==typeof t[T]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new b(i=>{const n=new u;let r;return n.add(()=>{r&&"function"==typeof r.return&&r.return()}),n.add(e.schedule(()=>{r=t[T](),n.add(e.schedule((function(){if(i.closed)return;let t,e;try{const i=r.next();t=i.value,e=i.done}catch(n){return void i.error(n)}e?i.complete():(i.next(t),this.schedule())})))})),n})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof b?t:new b(E(t))}class L extends g{constructor(t){super(),this.parent=t}_next(t){this.parent.notifyNext(t)}_error(t){this.parent.notifyError(t),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class R extends g{notifyNext(t){this.destination.next(t)}notifyError(t){this.destination.error(t)}notifyComplete(){this.destination.complete()}}function j(t,e){if(!e.closed)return t instanceof b?t.subscribe(e):E(t)(e)}function $(t,e,i=Number.POSITIVE_INFINITY){return"function"==typeof e?n=>n.pipe($((i,n)=>G(t(i,n)).pipe(D((t,r)=>e(i,t,n,r))),i)):("number"==typeof e&&(i=e),e=>e.lift(new N(t,i)))}class N{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new F(t,this.project,this.concurrent))}}class F extends R{constructor(t,e,i=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const i=this.index++;try{e=this.project(t,i)}catch(n){return void this.destination.error(n)}this.active++,this._innerSub(e)}_innerSub(t){const e=new L(this),i=this.destination;i.add(e);const n=j(t,e);n!==e&&i.add(n)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t){this.destination.next(t)}notifyComplete(){const t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function B(t=Number.POSITIVE_INFINITY){return $(v,t)}function H(t,e){return e?O(t,e):new b(I(t))}function K(){return function(t){return t.lift(new q(t))}}class q{constructor(t){this.connectable=t}call(t,e){const{connectable:i}=this;i._refCount++;const n=new z(t,i),r=e.subscribe(n);return n.closed||(n.connection=i.connect()),r}}class z extends g{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:i}=this,n=t._connection;this.connection=null,!n||i&&n!==i||n.unsubscribe()}}class Q extends b{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new u,t.add(this.source.subscribe(new J(this.getSubject(),this))),t.closed&&(this._connection=null,t=u.EMPTY)),t}refCount(){return K()(this)}}const W=(()=>{const t=Q.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class J extends w{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function Y(){return new A}function Z(t){return{toString:t}.toString()}function X(t,e,i){return Z(()=>{const n=function(t){return function(...e){if(t){const i=t(...e);for(const t in i)this[t]=i[t]}}}(e);function r(...t){if(this instanceof r)return n.apply(this,t),this;const e=new r(...t);return i.annotation=e,i;function i(t,i,n){const r=t.hasOwnProperty("__parameters__")?t.__parameters__:Object.defineProperty(t,"__parameters__",{value:[]}).__parameters__;for(;r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(e),t}}return i&&(r.prototype=Object.create(i.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}const tt=X("Inject",t=>({token:t})),et=X("Optional"),it=X("Self"),nt=X("SkipSelf");var rt=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});function st(t){for(let e in t)if(t[e]===st)return e;throw Error("Could not find renamed property on target object.")}function ot(t,e){for(const i in e)e.hasOwnProperty(i)&&!t.hasOwnProperty(i)&&(t[i]=e[i])}function at(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function lt(t){return{factory:t.factory,providers:t.providers||[],imports:t.imports||[]}}function ct(t){return dt(t,t[ht])||dt(t,t[mt])}function dt(t,e){return e&&e.token===t?e:null}function ut(t){return t&&(t.hasOwnProperty(pt)||t.hasOwnProperty(ft))?t[pt]:null}const ht=st({\u0275prov:st}),pt=st({\u0275inj:st}),gt=st({\u0275provFallback:st}),mt=st({ngInjectableDef:st}),ft=st({ngInjectorDef:st});function vt(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(vt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return""+t.overriddenName;if(t.name)return""+t.name;const e=t.toString();if(null==e)return""+e;const i=e.indexOf("\n");return-1===i?e:e.substring(0,i)}function bt(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const yt=st({__forward_ref__:st});function Ct(t){return t.__forward_ref__=Ct,t.toString=function(){return vt(this())},t}function Vt(t){return wt(t)?t():t}function wt(t){return"function"==typeof t&&t.hasOwnProperty(yt)&&t.__forward_ref__===Ct}const At="undefined"!=typeof globalThis&&globalThis,Pt="undefined"!=typeof window&&window,kt="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Dt="undefined"!=typeof global&&global,Mt=At||Dt||Pt||kt,St=st({\u0275cmp:st}),It=st({\u0275dir:st}),xt=st({\u0275pipe:st}),Tt=st({\u0275mod:st}),_t=st({\u0275loc:st}),Ut=st({\u0275fac:st}),Et=st({__NG_ELEMENT_ID__:st});class Ot{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=at({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return"InjectionToken "+this._desc}}const Gt=new Ot("INJECTOR",-1),Lt={},Rt=/\n/gm,jt=st({provide:String,useValue:st});let $t,Nt=void 0;function Ft(t){const e=Nt;return Nt=t,e}function Bt(t){const e=$t;return $t=t,e}function Ht(t,e=rt.Default){if(void 0===Nt)throw new Error("inject() must be called from an injection context");return null===Nt?qt(t,void 0,e):Nt.get(t,e&rt.Optional?null:void 0,e)}function Kt(t,e=rt.Default){return($t||Ht)(Vt(t),e)}function qt(t,e,i){const n=ct(t);if(n&&"root"==n.providedIn)return void 0===n.value?n.value=n.factory():n.value;if(i&rt.Optional)return null;if(void 0!==e)return e;throw new Error(`Injector: NOT_FOUND [${vt(t)}]`)}function zt(t){const e=[];for(let i=0;i<t.length;i++){const n=Vt(t[i]);if(Array.isArray(n)){if(0===n.length)throw new Error("Arguments array must have arguments.");let t=void 0,i=rt.Default;for(let e=0;e<n.length;e++){const r=n[e];r instanceof et||"Optional"===r.ngMetadataName||r===et?i|=rt.Optional:r instanceof nt||"SkipSelf"===r.ngMetadataName||r===nt?i|=rt.SkipSelf:r instanceof it||"Self"===r.ngMetadataName||r===it?i|=rt.Self:t=r instanceof tt||r===tt?r.token:r}e.push(Kt(t,i))}else e.push(Kt(n))}return e}class Qt{get(t,e=Lt){if(e===Lt){const e=new Error(`NullInjectorError: No provider for ${vt(t)}!`);throw e.name="NullInjectorError",e}return e}}class Wt{}class Jt{}function Yt(t,e){t.forEach(t=>Array.isArray(t)?Yt(t,e):e(t))}function Zt(t,e,i){e>=t.length?t.push(i):t.splice(e,0,i)}function Xt(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function te(t,e,i){let n=ie(t,e);return n>=0?t[1|n]=i:(n=~n,function(t,e,i,n){let r=t.length;if(r==e)t.push(i,n);else if(1===r)t.push(n,t[0]),t[0]=i;else{for(r--,t.push(t[r-1],t[r]);r>e;)t[r]=t[r-2],r--;t[e]=i,t[e+1]=n}}(t,n,e,i)),n}function ee(t,e){const i=ie(t,e);if(i>=0)return t[1|i]}function ie(t,e){return function(t,e,i){let n=0,r=t.length>>1;for(;r!==n;){const i=n+(r-n>>1),s=t[i<<1];if(e===s)return i<<1;s>e?r=i:n=i+1}return~(r<<1)}(t,e)}var ne=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}({}),re=function(t){return t[t.Emulated=0]="Emulated",t[t.Native=1]="Native",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}({});const se={},oe=[];let ae=0;function le(t){return Z(()=>{const e={},i={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===ne.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||oe,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||re.Emulated,id:"c",styles:t.styles||oe,_:null,setInput:null,schemas:t.schemas||null,tView:null},n=t.directives,r=t.features,s=t.pipes;return i.id+=ae++,i.inputs=pe(t.inputs,e),i.outputs=pe(t.outputs),r&&r.forEach(t=>t(i)),i.directiveDefs=n?()=>("function"==typeof n?n():n).map(ce):null,i.pipeDefs=s?()=>("function"==typeof s?s():s).map(de):null,i})}function ce(t){return fe(t)||function(t){return t[It]||null}(t)}function de(t){return function(t){return t[xt]||null}(t)}const ue={};function he(t){const e={type:t.type,bootstrap:t.bootstrap||oe,declarations:t.declarations||oe,imports:t.imports||oe,exports:t.exports||oe,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&Z(()=>{ue[t.id]=t.type}),e}function pe(t,e){if(null==t)return se;const i={};for(const n in t)if(t.hasOwnProperty(n)){let r=t[n],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),i[r]=n,e&&(e[r]=s)}return i}const ge=le;function me(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function fe(t){return t[St]||null}function ve(t,e){return t.hasOwnProperty(Ut)?t[Ut]:null}function be(t,e){const i=t[Tt]||null;if(!i&&!0===e)throw new Error(`Type ${vt(t)} does not have '\u0275mod' property.`);return i}function ye(t){return Array.isArray(t)&&"object"==typeof t[1]}function Ce(t){return Array.isArray(t)&&!0===t[1]}function Ve(t){return 0!=(8&t.flags)}function we(t){return 2==(2&t.flags)}function Ae(t){return 1==(1&t.flags)}function Pe(t){return null!==t.template}function ke(t){return 0!=(512&t[2])}function De(t){return"string"==typeof t?t:null==t?"":""+t}function Me(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():De(t)}const Se=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Mt))();function Ie(t){return t instanceof Function?t():t}function xe(t,e){const i=e?" in "+e:"";throw new Error(`No provider for ${Me(t)} found${i}`)}class Te{constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function _e(){return Ue}function Ue(t){return t.type.prototype.ngOnChanges&&(t.setInput=Oe),Ee}function Ee(){const t=Ge(this),e=null==t?void 0:t.current;if(e){const i=t.previous;if(i===se)t.previous=e;else for(let t in e)i[t]=e[t];t.current=null,this.ngOnChanges(e)}}function Oe(t,e,i,n){const r=Ge(t)||function(t,e){return t.__ngSimpleChanges__=e}(t,{previous:se,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[i],l=o[a];s[a]=new Te(l&&l.currentValue,e,o===se),t[n]=e}function Ge(t){return t.__ngSimpleChanges__||null}_e.ngInherit=!0;let Le=void 0;function Re(t){return!!t.listen}const je={createRenderer:(t,e)=>void 0!==Le?Le:"undefined"!=typeof document?document:void 0};function $e(t){for(;Array.isArray(t);)t=t[0];return t}function Ne(t,e){return $e(e[t+20])}function Fe(t,e){return $e(e[t.index])}function Be(t,e){return t.data[e+20]}function He(t,e){return t[e+20]}function Ke(t,e){const i=e[t];return ye(i)?i:i[0]}function qe(t){const e=function(t){return t.__ngContext__||null}(t);return e?Array.isArray(e)?e:e.lView:null}function ze(t){return 128==(128&t[2])}function Qe(t,e){return null===t||null==e?null:t[e]}function We(t){t[18]=0}function Je(t,e){t[5]+=e;let i=t,n=t[3];for(;null!==n&&(1===e&&1===i[5]||-1===e&&0===i[5]);)n[5]+=e,i=n,n=n[3]}const Ye={lFrame:bi(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Ze(){return Ye.bindingsEnabled}function Xe(){return Ye.lFrame.lView}function ti(){return Ye.lFrame.tView}function ei(t){Ye.lFrame.contextLView=t}function ii(){return Ye.lFrame.currentTNode}function ni(t,e){Ye.lFrame.currentTNode=t,Ye.lFrame.isParent=e}function ri(){return Ye.lFrame.isParent}function si(){Ye.lFrame.isParent=!1}function oi(){return Ye.isInCheckNoChangesMode}function ai(t){Ye.isInCheckNoChangesMode=t}function li(){const t=Ye.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function ci(){return Ye.lFrame.bindingIndex}function di(){return Ye.lFrame.bindingIndex++}function ui(t){const e=Ye.lFrame,i=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,i}function hi(t,e){const i=Ye.lFrame;i.bindingIndex=i.bindingRootIndex=t,pi(e)}function pi(t){Ye.lFrame.currentDirectiveIndex=t}function gi(t){Ye.lFrame.currentQueryIndex=t}function mi(t,e){const i=vi();Ye.lFrame=i,i.currentTNode=e,i.lView=t}function fi(t){const e=vi(),i=t[1];Ye.lFrame=e,e.currentTNode=i.firstChild,e.lView=t,e.tView=i,e.contextLView=t,e.bindingIndex=i.bindingStartIndex}function vi(){const t=Ye.lFrame,e=null===t?null:t.child;return null===e?bi(t):e}function bi(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:0,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null};return null!==t&&(t.child=e),e}function yi(){const t=Ye.lFrame;return Ye.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Ci=yi;function Vi(){const t=yi();t.isParent=!0,t.tView=null,t.selectedIndex=0,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function wi(){return Ye.lFrame.selectedIndex}function Ai(t){Ye.lFrame.selectedIndex=t}function Pi(){const t=Ye.lFrame;return Be(t.tView,t.selectedIndex)}function ki(t,e){for(let i=e.directiveStart,n=e.directiveEnd;i<n;i++){const e=t.data[i].type.prototype,{ngAfterContentInit:n,ngAfterContentChecked:r,ngAfterViewInit:s,ngAfterViewChecked:o,ngOnDestroy:a}=e;n&&(t.contentHooks||(t.contentHooks=[])).push(-i,n),r&&((t.contentHooks||(t.contentHooks=[])).push(i,r),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(i,r)),s&&(t.viewHooks||(t.viewHooks=[])).push(-i,s),o&&((t.viewHooks||(t.viewHooks=[])).push(i,o),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(i,o)),null!=a&&(t.destroyHooks||(t.destroyHooks=[])).push(i,a)}}function Di(t,e,i){Ii(t,e,3,i)}function Mi(t,e,i,n){(3&t[2])===i&&Ii(t,e,i,n)}function Si(t,e){let i=t[2];(3&i)===e&&(i&=2047,i+=1,t[2]=i)}function Ii(t,e,i,n){const r=null!=n?n:-1;let s=0;for(let o=void 0!==n?65535&t[18]:0;o<e.length;o++)if("number"==typeof e[o+1]){if(s=e[o],null!=n&&s>=n)break}else e[o]<0&&(t[18]+=65536),(s<r||-1==r)&&(xi(t,i,e,o),t[18]=(4294901760&t[18])+o+2),o++}function xi(t,e,i,n){const r=i[n]<0,s=i[n+1],o=t[r?-i[n]:i[n]];r?t[2]>>11<t[18]>>16&&(3&t[2])===e&&(t[2]+=2048,s.call(o)):s.call(o)}class Ti{constructor(t,e,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function _i(t,e,i){const n=Re(t);let r=0;for(;r<i.length;){const s=i[r];if("number"==typeof s){if(0!==s)break;r++;const o=i[r++],a=i[r++],l=i[r++];n?t.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=i[++r];Ei(o)?n&&t.setProperty(e,o,a):n?t.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function Ui(t){return 3===t||4===t||6===t}function Ei(t){return 64===t.charCodeAt(0)}function Oi(t,e){if(null===e||0===e.length);else if(null===t||0===t.length)t=e.slice();else{let i=-1;for(let n=0;n<e.length;n++){const r=e[n];"number"==typeof r?i=r:0===i||Gi(t,i,r,null,-1===i||2===i?e[++n]:null)}}return t}function Gi(t,e,i,n,r){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const i=t[s++];if("number"==typeof i){if(i===e){o=-1;break}if(i>e){o=s-1;break}}}for(;s<t.length;){const e=t[s];if("number"==typeof e)break;if(e===i){if(null===n)return void(null!==r&&(t[s+1]=r));if(n===t[s+1])return void(t[s+2]=r)}s++,null!==n&&s++,null!==r&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,i),null!==n&&t.splice(s++,0,n),null!==r&&t.splice(s++,0,r)}function Li(t){return-1!==t}function Ri(t){return 32767&t}function ji(t,e){let i=t>>16,n=e;for(;i>0;)n=n[15],i--;return n}let $i=!0;function Ni(t){const e=$i;return $i=t,e}let Fi=0;function Bi(t,e){const i=Ki(t,e);if(-1!==i)return i;const n=e[1];n.firstCreatePass&&(t.injectorIndex=e.length,Hi(n.data,t),Hi(e,null),Hi(n.blueprint,null));const r=qi(t,e),s=t.injectorIndex;if(Li(r)){const t=Ri(r),i=ji(r,e),n=i[1].data;for(let r=0;r<8;r++)e[s+r]=i[t+r]|n[t+r]}return e[s+8]=r,s}function Hi(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Ki(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function qi(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let i=0,n=null,r=e;for(;null!==r;){const t=r[1],e=t.type;if(n=2===e?t.declTNode:1===e?r[6]:null,null===n)return-1;if(i++,r=r[15],-1!==n.injectorIndex)return n.injectorIndex|i<<16}return-1}function zi(t,e,i){!function(t,e,i){let n;"string"==typeof i?n=i.charCodeAt(0)||0:i.hasOwnProperty(Et)&&(n=i[Et]),null==n&&(n=i[Et]=Fi++);const r=255&n,s=1<<r,o=64&r,a=32&r,l=e.data;128&r?o?a?l[t+7]|=s:l[t+6]|=s:a?l[t+5]|=s:l[t+4]|=s:o?a?l[t+3]|=s:l[t+2]|=s:a?l[t+1]|=s:l[t]|=s}(t,e,i)}function Qi(t,e,i,n=rt.Default,r){if(null!==t){const r=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(Et)?t[Et]:void 0;return"number"==typeof e&&e>0?255&e:e}(i);if("function"==typeof r){mi(e,t);try{const t=r();if(null!=t||n&rt.Optional)return t;xe(i)}finally{Ci()}}else if("number"==typeof r){if(-1===r)return new tn(t,e);let s=null,o=Ki(t,e),a=-1,l=n&rt.Host?e[16][6]:null;for((-1===o||n&rt.SkipSelf)&&(a=-1===o?qi(t,e):e[o+8],-1!==a&&Xi(n,!1)?(s=e[1],o=Ri(a),e=ji(a,e)):o=-1);-1!==o;){const t=e[1];if(Zi(r,o,t.data)){const t=Ji(o,e,i,s,n,l);if(t!==Wi)return t}a=e[o+8],-1!==a&&Xi(n,e[1].data[o+8]===l)&&Zi(r,o,e)?(s=t,o=Ri(a),e=ji(a,e)):o=-1}}}if(n&rt.Optional&&void 0===r&&(r=null),0==(n&(rt.Self|rt.Host))){const t=e[9],s=Bt(void 0);try{return t?t.get(i,r,n&rt.Optional):qt(i,r,n&rt.Optional)}finally{Bt(s)}}if(n&rt.Optional)return r;xe(i,"NodeInjector")}const Wi={};function Ji(t,e,i,n,r,s){const o=e[1],a=o.data[t+8],l=function(t,e,i,n,r){const s=t.providerIndexes,o=e.data,a=1048575&s,l=t.directiveStart,c=s>>20,d=r?a+c:t.directiveEnd;for(let u=n?a:a+c;u<d;u++){const t=o[u];if(u<l&&i===t||u>=l&&t.type===i)return u}if(r){const t=o[l];if(t&&Pe(t)&&t.type===i)return l}return null}(a,o,i,null==n?we(a)&&$i:n!=o&&2===a.type,r&rt.Host&&s===a);return null!==l?Yi(e,o,l,a):Wi}function Yi(t,e,i,n){let r=t[i];const s=e.data;if(r instanceof Ti){const o=r;o.resolving&&function(t,e){throw new Error("Circular dependency in DI detected for "+t)}(Me(s[i]));const a=Ni(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Bt(o.injectImpl):null;mi(t,n);try{r=t[i]=o.factory(void 0,s,t,n),e.firstCreatePass&&i>=n.directiveStart&&function(t,e,i){const{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(n){const n=Ue(e);(i.preOrderHooks||(i.preOrderHooks=[])).push(t,n),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t,n)}r&&(i.preOrderHooks||(i.preOrderHooks=[])).push(0-t,r),s&&((i.preOrderHooks||(i.preOrderHooks=[])).push(t,s),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t,s))}(i,s[i],e)}finally{null!==l&&Bt(l),Ni(a),o.resolving=!1,Ci()}}return r}function Zi(t,e,i){const n=64&t,r=32&t;let s;return s=128&t?n?r?i[e+7]:i[e+6]:r?i[e+5]:i[e+4]:n?r?i[e+3]:i[e+2]:r?i[e+1]:i[e],!!(s&1<<t)}function Xi(t,e){return!(t&rt.Self||t&rt.Host&&e)}class tn{constructor(t,e){this._tNode=t,this._lView=e}get(t,e){return Qi(this._tNode,this._lView,t,void 0,e)}}function en(t){const e=t;if(wt(t))return()=>{const t=en(Vt(e));return t?t():null};let i=ve(e);if(null===i){const t=ut(e);i=t&&t.factory}return i||null}function nn(t){return Z(()=>{const e=t.prototype.constructor,i=e[Ut]||en(e),n=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==n;){const t=r[Ut]||en(r);if(t&&t!==i)return t;r=Object.getPrototypeOf(r)}return t=>new t})}function rn(t){return t.ngDebugContext}function sn(t){return t.ngOriginalError}function on(t,...e){t.error(...e)}class an{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),i=this._findContext(t),n=function(t){return t.ngErrorLogger||on}(t);n(this._console,"ERROR",t),e&&n(this._console,"ORIGINAL ERROR",e),i&&n(this._console,"ERROR CONTEXT",i)}_findContext(t){return t?rn(t)?rn(t):this._findContext(sn(t)):null}_findOriginalError(t){let e=sn(t);for(;e&&sn(e);)e=sn(e);return e}}class ln{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return"SafeValue must use [property]=binding: "+this.changingThisBreaksApplicationSecurity+" (see http://g.co/ng/security#xss)"}}function cn(t){return t instanceof ln?t.changingThisBreaksApplicationSecurity:t}let dn=!1;function un(){return dn=!0,!0}const hn=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,pn=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var gn=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}({});function mn(t){const e=function(){const t=Xe();return t&&t[12]}();return e?e.sanitize(gn.URL,t)||"":function(t,e){const i=function(t){return t instanceof ln&&t.getTypeName()||null}(t);if(null!=i&&i!==e){if("ResourceURL"===i&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${i} (see http://g.co/ng/security#xss)`)}return i===e}(t,"URL")?cn(t):(i=De(t),(i=String(i)).match(hn)||i.match(pn)?i:(un()&&console.warn(`WARNING: sanitizing unsafe URL value ${i} (see http://g.co/ng/security#xss)`),"unsafe:"+i));var i}function fn(t,e){t.__ngContext__=e}function vn(t,e,i){let n=t.length;for(;;){const r=t.indexOf(e,i);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const i=e.length;if(r+i===n||t.charCodeAt(r+i)<=32)return r}i=r+1}}function bn(t,e,i){let n=0;for(;n<t.length;){let r=t[n++];if(i&&"class"===r){if(r=t[n],-1!==vn(r.toLowerCase(),e,0))return!0}else if(1===r){for(;n<t.length&&"string"==typeof(r=t[n++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function yn(t){return 0===t.type&&"ng-template"!==t.tagName}function Cn(t,e,i){return e===(0!==t.type||i?t.tagName:"ng-template")}function Vn(t,e,i){let n=4;const r=t.attrs||[],s=function(t){for(let e=0;e<t.length;e++)if(Ui(t[e]))return e;return t.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&n){if(n=2|1&n,""!==l&&!Cn(t,l,i)||""===l&&1===e.length){if(wn(n))return!1;o=!0}}else{const c=8&n?l:e[++a];if(8&n&&null!==t.attrs){if(!bn(t.attrs,c,i)){if(wn(n))return!1;o=!0}continue}const d=An(8&n?"class":l,r,yn(t),i);if(-1===d){if(wn(n))return!1;o=!0;continue}if(""!==c){let t;t=d>s?"":r[d+1].toLowerCase();const e=8&n?t:null;if(e&&-1!==vn(e,c,0)||2&n&&c!==t){if(wn(n))return!1;o=!0}}}}else{if(!o&&!wn(n)&&!wn(l))return!1;if(o&&wn(l))continue;o=!1,n=l|1&n}}return wn(n)||o}function wn(t){return 0==(1&t)}function An(t,e,i,n){if(null===e)return-1;let r=0;if(n||!i){let i=!1;for(;r<e.length;){const n=e[r];if(n===t)return r;if(3===n||6===n)i=!0;else{if(1===n||2===n){let t=e[++r];for(;"string"==typeof t;)t=e[++r];continue}if(4===n)break;if(0===n){r+=4;continue}}r+=i?1:2}return-1}return function(t,e){let i=t.indexOf(4);if(i>-1)for(i++;i<t.length;){const n=t[i];if("number"==typeof n)return-1;if(n===e)return i;i++}return-1}(e,t)}function Pn(t,e,i=!1){for(let n=0;n<e.length;n++)if(Vn(t,e[n],i))return!0;return!1}function kn(t,e){return t?":not("+e.trim()+")":e}function Dn(t){let e=t[0],i=1,n=2,r="",s=!1;for(;i<t.length;){let o=t[i];if("string"==typeof o)if(2&n){const e=t[++i];r+="["+o+(e.length>0?'="'+e+'"':"")+"]"}else 8&n?r+="."+o:4&n&&(r+=" "+o);else""===r||wn(o)||(e+=kn(s,r),r=""),n=o,s=s||!wn(n);i++}return""!==r&&(e+=kn(s,r)),e}const Mn={};function Sn(t){const e=t[3];return Ce(e)?e[3]:e}function In(t){return Tn(t[13])}function xn(t){return Tn(t[4])}function Tn(t){for(;null!==t&&!Ce(t);)t=t[4];return t}function _n(t){Un(ti(),Xe(),wi()+t,oi())}function Un(t,e,i,n){if(!n)if(3==(3&e[2])){const n=t.preOrderCheckHooks;null!==n&&Di(e,n,i)}else{const n=t.preOrderHooks;null!==n&&Mi(e,n,0,i)}Ai(i)}function En(t,e){return t<<17|e<<2}function On(t){return t>>17&32767}function Gn(t){return 2|t}function Ln(t){return(131068&t)>>2}function Rn(t,e){return-131069&t|e<<2}function jn(t){return 1|t}function $n(t,e){const i=t.contentQueries;if(null!==i)for(let n=0;n<i.length;n+=2){const r=i[n],s=i[n+1];if(-1!==s){const i=t.data[s];gi(r),i.contentQueries(2,e[s],s)}}}function Nn(t,e,i){return Re(e)?e.createElement(t,i):null===i?e.createElement(t):e.createElementNS(i,t)}function Fn(t,e,i,n,r,s,o,a,l,c){const d=e.blueprint.slice();return d[0]=r,d[2]=140|n,We(d),d[3]=d[15]=t,d[8]=i,d[10]=o||t&&t[10],d[11]=a||t&&t[11],d[12]=l||t&&t[12]||null,d[9]=c||t&&t[9]||null,d[6]=s,d[16]=2==e.type?t[16]:d,d}function Bn(t,e,i,n,r){const s=e+20,o=t.data[s]||function(t,e,i,n,r){const s=ii(),o=ri(),a=t.data[e]=function(t,e,i,n,r,s){return{type:i,index:n,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,tagName:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,i,e,n,r);return null===t.firstChild&&(t.firstChild=a),null!==s&&(o&&null==s.child&&null!==a.parent?s.child=a:o||(s.next=a)),a}(t,s,i,n,r);return ni(o,!0),o}function Hn(t,e,i){fi(e);try{const n=t.viewQuery;null!==n&&Cr(1,n,i);const r=t.template;null!==r&&zn(t,e,r,1,i),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&$n(t,e),t.staticViewQueries&&Cr(2,t.viewQuery,i);const s=t.components;null!==s&&function(t,e){for(let i=0;i<e.length;i++)mr(t,e[i])}(e,s)}catch(n){throw t.firstCreatePass&&(t.incompleteFirstPass=!0),n}finally{e[2]&=-5,Vi()}}function Kn(t,e,i,n){const r=e[2];if(256==(256&r))return;fi(e);const s=oi();try{We(e),Ye.lFrame.bindingIndex=t.bindingStartIndex,null!==i&&zn(t,e,i,2,n);const o=3==(3&r);if(!s)if(o){const i=t.preOrderCheckHooks;null!==i&&Di(e,i,null)}else{const i=t.preOrderHooks;null!==i&&Mi(e,i,0,null),Si(e,0)}if(function(t){for(let e=In(t);null!==e;e=xn(e)){if(!e[2])continue;const t=e[9];for(let e=0;e<t.length;e++){const i=t[e],n=i[3];0==(1024&i[2])&&Je(n,1),i[2]|=1024}}}(e),function(t){for(let e=In(t);null!==e;e=xn(e))for(let t=10;t<e.length;t++){const i=e[t],n=i[1];ze(i)&&Kn(n,i,n.template,i[8])}}(e),null!==t.contentQueries&&$n(t,e),!s)if(o){const i=t.contentCheckHooks;null!==i&&Di(e,i)}else{const i=t.contentHooks;null!==i&&Mi(e,i,1),Si(e,1)}!function(t,e){try{const i=t.expandoInstructions;if(null!==i){let n=t.expandoStartIndex,r=-1,s=-1;for(let t=0;t<i.length;t++){const o=i[t];"number"==typeof o?o<=0?(s=0-o,Ai(s),n+=9+i[++t],r=n):n+=o:(null!==o&&(hi(n,r),o(2,e[r])),r++)}}}finally{Ai(-1)}}(t,e);const a=t.components;null!==a&&function(t,e){for(let i=0;i<e.length;i++)gr(t,e[i])}(e,a);const l=t.viewQuery;if(null!==l&&Cr(2,l,n),!s)if(o){const i=t.viewCheckHooks;null!==i&&Di(e,i)}else{const i=t.viewHooks;null!==i&&Mi(e,i,2),Si(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Je(e[3],-1))}finally{Vi()}}function qn(t,e,i,n){const r=e[10],s=!oi(),o=4==(4&e[2]);try{s&&!o&&r.begin&&r.begin(),o&&Hn(t,e,n),Kn(t,e,i,n)}finally{s&&!o&&r.end&&r.end()}}function zn(t,e,i,n,r){const s=wi();try{Ai(-1),2&n&&e.length>20&&Un(t,e,0,oi()),i(n,r)}finally{Ai(s)}}function Qn(t,e,i){if(Ve(e)){const n=e.directiveEnd;for(let r=e.directiveStart;r<n;r++){const e=t.data[r];e.contentQueries&&e.contentQueries(1,i[r],r)}}}function Wn(t,e,i){Ze()&&(function(t,e,i,n){const r=i.directiveStart,s=i.directiveEnd;t.firstCreatePass||Bi(i,e),fn(n,e);const o=i.initialInputs;for(let a=r;a<s;a++){const n=t.data[a],s=Pe(n);s&&dr(e,i,n);const l=Yi(e,t,a,i);fn(l,e),null!==o&&ur(0,a-r,l,n,0,o),s&&(Ke(i.index,e)[8]=l)}}(t,e,i,Fe(i,e)),128==(128&i.flags)&&function(t,e,i){const n=i.directiveStart,r=i.directiveEnd,s=t.expandoInstructions,o=t.firstCreatePass,a=i.index-20,l=Ye.lFrame.currentDirectiveIndex;try{Ai(a);for(let i=n;i<r;i++){const n=t.data[i],r=e[i];pi(i),null!==n.hostBindings||0!==n.hostVars||null!==n.hostAttrs?rr(n,r):o&&s.push(null)}}finally{Ai(-1),pi(l)}}(t,e,i))}function Jn(t,e,i=Fe){const n=e.localNames;if(null!==n){let r=e.index+1;for(let s=0;s<n.length;s+=2){const o=n[s+1],a=-1===o?i(e,t):t[o];t[r++]=a}}}function Yn(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Zn(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function Zn(t,e,i,n,r,s,o,a,l,c){const d=20+n,u=d+r,h=function(t,e){const i=[];for(let n=0;n<e;n++)i.push(n<t?null:Mn);return i}(d,u),p="function"==typeof c?c():c;return h[1]={type:t,blueprint:h,template:i,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:u,expandoInstructions:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1}}function Xn(t,e,i){for(let n in t)if(t.hasOwnProperty(n)){const r=t[n];(i=null===i?{}:i).hasOwnProperty(n)?i[n].push(e,r):i[n]=[e,r]}return i}function tr(t,e,i,n,r,s,o,a){const l=Fe(e,i);let c,d=e.inputs;!a&&null!=d&&(c=d[n])?(Pr(t,i,c,n,r),we(e)&&function(t,e){const i=Ke(e,t);16&i[2]||(i[2]|=64)}(i,e.index)):2===e.type&&(n=function(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(n),r=null!=o?o(r,e.tagName||"",n):r,Re(s)?s.setProperty(l,n,r):Ei(n)||(l.setProperty?l.setProperty(n,r):l[n]=r))}function er(t,e,i,n){let r=!1;if(Ze()){const s=function(t,e,i){const n=t.directiveRegistry;let r=null;if(n)for(let s=0;s<n.length;s++){const o=n[s];Pn(i,o.selectors,!1)&&(r||(r=[]),zi(Bi(i,e),t,o.type),Pe(o)?(or(t,i),r.unshift(o)):r.push(o))}return r}(t,e,i),o=null===n?null:{"":-1};if(null!==s){let n=0;r=!0,lr(i,t.data.length,s.length);for(let t=0;t<s.length;t++){const e=s[t];e.providersResolver&&e.providersResolver(e)}sr(t,i,s.length);let a=!1,l=!1;for(let r=0;r<s.length;r++){const c=s[r];i.mergedAttrs=Oi(i.mergedAttrs,c.hostAttrs),cr(t,e,c),ar(t.data.length-1,c,o),null!==c.contentQueries&&(i.flags|=8),null===c.hostBindings&&null===c.hostAttrs&&0===c.hostVars||(i.flags|=128);const d=c.type.prototype;!a&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(i.index-20),a=!0),l||!d.ngOnChanges&&!d.ngDoCheck||((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i.index-20),l=!0),ir(t,c),n+=c.hostVars}!function(t,e){const i=e.directiveEnd,n=t.data,r=e.attrs,s=[];let o=null,a=null;for(let l=e.directiveStart;l<i;l++){const t=n[l],i=t.inputs,c=null===r||yn(e)?null:hr(i,r);s.push(c),o=Xn(i,l,o),a=Xn(t.outputs,l,a)}null!==o&&(o.hasOwnProperty("class")&&(e.flags|=16),o.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=s,e.inputs=o,e.outputs=a}(t,i),nr(t,e,n)}o&&function(t,e,i){if(e){const n=t.localNames=[];for(let t=0;t<e.length;t+=2){const r=i[e[t+1]];if(null==r)throw new Error(`Export of name '${e[t+1]}' not found!`);n.push(e[t],r)}}}(i,n,o)}return i.mergedAttrs=Oi(i.mergedAttrs,i.attrs),r}function ir(t,e){const i=t.expandoInstructions;i.push(e.hostBindings),0!==e.hostVars&&i.push(e.hostVars)}function nr(t,e,i){for(let n=0;n<i;n++)e.push(Mn),t.blueprint.push(Mn),t.data.push(null)}function rr(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function sr(t,e,i){const n=20-e.index,r=t.data.length-(1048575&e.providerIndexes);(t.expandoInstructions||(t.expandoInstructions=[])).push(n,r,i)}function or(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function ar(t,e,i){if(i){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)i[e.exportAs[n]]=t;Pe(e)&&(i[""]=t)}}function lr(t,e,i){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+i,t.providerIndexes=e}function cr(t,e,i){t.data.push(i);const n=i.factory||(i.factory=ve(i.type)),r=new Ti(n,Pe(i),null);t.blueprint.push(r),e.push(r)}function dr(t,e,i){const n=Fe(e,t),r=Yn(i),s=t[10],o=fr(t,Fn(t,r,null,i.onPush?64:16,n,e,s,s.createRenderer(n,i),null,null));t[e.index]=o}function ur(t,e,i,n,r,s){const o=s[e];if(null!==o){const t=n.setInput;for(let e=0;e<o.length;){const r=o[e++],s=o[e++],a=o[e++];null!==t?n.setInput(i,a,r,s):i[s]=a}}}function hr(t,e){let i=null,n=0;for(;n<e.length;){const r=e[n];if(0!==r)if(5!==r){if("number"==typeof r)break;t.hasOwnProperty(r)&&(null===i&&(i=[]),i.push(r,t[r],e[n+1])),n+=2}else n+=2;else n+=4}return i}function pr(t,e,i,n){return new Array(t,!0,!1,e,null,0,n,i,null,null)}function gr(t,e){const i=Ke(e,t);if(ze(i)){const t=i[1];80&i[2]?Kn(t,i,t.template,i[8]):i[5]>0&&function t(e){for(let n=In(e);null!==n;n=xn(n))for(let e=10;e<n.length;e++){const i=n[e];if(1024&i[2]){const t=i[1];Kn(t,i,t.template,i[8])}else i[5]>0&&t(i)}const i=e[1].components;if(null!==i)for(let n=0;n<i.length;n++){const r=Ke(i[n],e);ze(r)&&r[5]>0&&t(r)}}(i)}}function mr(t,e){const i=Ke(e,t),n=i[1];!function(t,e){for(let i=e.length;i<t.blueprint.length;i++)e.push(t.blueprint[i])}(n,i),Hn(n,i,i[8])}function fr(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function vr(t){for(;t;){t[2]|=64;const e=Sn(t);if(ke(t)&&!e)return t;t=e}return null}function br(t,e,i){const n=e[10];n.begin&&n.begin();try{Kn(t,e,t.template,i)}catch(r){throw Ar(e,r),r}finally{n.end&&n.end()}}function yr(t){!function(t){for(let e=0;e<t.components.length;e++){const i=t.components[e],n=qe(i),r=n[1];qn(r,n,r.template,i)}}(t[8])}function Cr(t,e,i){gi(0),e(t,i)}const Vr=(()=>Promise.resolve(null))();function wr(t){return t[7]||(t[7]=[])}function Ar(t,e){const i=t[9],n=i?i.get(an,null):null;n&&n.handleError(e)}function Pr(t,e,i,n,r){for(let s=0;s<i.length;){const o=i[s++],a=i[s++],l=e[o],c=t.data[o];null!==c.setInput?c.setInput(l,r,n,a):l[a]=r}}function kr(t,e,i){const n=Ne(e,t),r=t[11];Re(r)?r.setValue(n,i):n.textContent=i}function Dr(t,e,i,n,r){if(null!=n){let s,o=!1;Ce(n)?s=n:ye(n)&&(o=!0,n=n[0]);const a=$e(n);0===t&&null!==i?null==r?_r(e,i,a):Tr(e,i,a,r||null):1===t&&null!==i?Tr(e,i,a,r||null):2===t?function(t,e,i){const n=Er(t,e);n&&function(t,e,i,n){Re(t)?t.removeChild(e,i,n):e.removeChild(i)}(t,n,e,i)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function(t,e,i,n,r){const s=i[7];s!==$e(i)&&Dr(e,t,n,s,r);for(let o=10;o<i.length;o++){const r=i[o];Lr(r[1],r,t,e,n,s)}}(e,t,s,i,r)}}function Mr(t,e){const i=t[9],n=i.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,Je(r,-1)),i.splice(n,1)}function Sr(t,e){if(t.length<=10)return;const i=10+e,n=t[i];if(n){const s=n[17];null!==s&&s!==t&&Mr(s,n),e>0&&(t[i-1][4]=n[4]);const o=Xt(t,10+e);Lr(n[1],r=n,r[11],2,null,null),r[0]=null,r[6]=null;const a=o[19];null!==a&&a.detachView(o[1]),n[3]=null,n[4]=null,n[2]&=-129}var r;return n}function Ir(t,e){if(!(256&e[2])){const i=e[11];Re(i)&&i.destroyNode&&Lr(t,e,i,3,null,null),function(t){let e=t[13];if(!e)return xr(t[1],t);for(;e;){let i=null;if(ye(e))i=e[13];else{const t=e[10];t&&(i=t)}if(!i){for(;e&&!e[4]&&e!==t;)ye(e)&&xr(e[1],e),e=e[3];null===e&&(e=t),ye(e)&&xr(e[1],e),i=e&&e[4]}e=i}}(e)}}function xr(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let i;if(null!=t&&null!=(i=t.destroyHooks))for(let n=0;n<i.length;n+=2){const t=e[i[n]];if(!(t instanceof Ti)){const e=i[n+1];if(Array.isArray(e))for(let i=0;i<e.length;i+=2)e[i+1].call(t[e[i]]);else e.call(t)}}}(t,e),function(t,e){const i=t.cleanup;if(null!==i){const t=e[7];for(let n=0;n<i.length-1;n+=2)if("string"==typeof i[n]){const r=i[n+1],s="function"==typeof r?r(e):$e(e[r]),o=t[i[n+2]],a=i[n+3];"boolean"==typeof a?s.removeEventListener(i[n],o,a):a>=0?t[a]():t[-a].unsubscribe(),n+=2}else i[n].call(t[i[n+1]]);e[7]=null}}(t,e),1===e[1].type&&Re(e[11])&&e[11].destroy();const i=e[17];if(null!==i&&Ce(e[3])){i!==e[3]&&Mr(i,e);const n=e[19];null!==n&&n.detachView(t)}}}function Tr(t,e,i,n){Re(t)?t.insertBefore(e,i,n):e.insertBefore(i,n,!0)}function _r(t,e,i){Re(t)?t.appendChild(e,i):e.appendChild(i)}function Ur(t,e,i,n){null!==n?Tr(t,e,i,n):_r(t,e,i)}function Er(t,e){return Re(t)?t.parentNode(e):e.parentNode}function Or(t,e,i,n){const r=function(t,e,i){let n=e.parent;for(;null!=n&&(3===n.type||4===n.type);)n=(e=n).parent;if(null===n)return i[0];if(e&&4===e.type&&4&e.flags)return Fe(e,i).parentNode;if(2&n.flags){const e=t.data,i=e[e[n.index].directiveStart].encapsulation;if(i!==re.ShadowDom&&i!==re.Native)return null}return Fe(n,i)}(t,n,e);if(null!=r){const t=e[11],s=function(t,e){return 3===t.type||4===t.type?Fe(t,e):null}(n.parent||e[6],e);if(Array.isArray(i))for(let e=0;e<i.length;e++)Ur(t,r,i[e],s);else Ur(t,r,i,s)}}function Gr(t,e,i,n,r,s,o){for(;null!=i;){const a=n[i.index],l=i.type;o&&0===e&&(a&&fn($e(a),n),i.flags|=4),64!=(64&i.flags)&&(3===l||4===l?(Gr(t,e,i.child,n,r,s,!1),Dr(e,t,r,a,s)):1===l?Rr(t,e,n,i,r,s):Dr(e,t,r,a,s)),i=o?i.projectionNext:i.next}}function Lr(t,e,i,n,r,s){Gr(i,n,t.firstChild,e,r,s,!1)}function Rr(t,e,i,n,r,s){const o=i[16],a=o[6].projection[n.projection];if(Array.isArray(a))for(let l=0;l<a.length;l++)Dr(e,t,r,a[l],s);else Gr(t,e,a,o[3],r,s,!0)}function jr(t,e,i){Re(t)?t.setAttribute(e,"style",i):e.style.cssText=i}function $r(t,e,i){Re(t)?""===i?t.removeAttribute(e,"class"):t.setAttribute(e,"class",i):e.className=i}class Nr{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._viewContainerRef=null}get rootNodes(){const t=this._lView,e=t[1];return function t(e,i,n,r,s=!1){for(;null!==n;){const o=i[n.index];if(null!==o&&r.push($e(o)),Ce(o))for(let e=10;e<o.length;e++){const i=o[e],n=i[1].firstChild;null!==n&&t(i[1],i,n,r)}const a=n.type;if(3===a||4===a)t(e,i,n.child,r);else if(1===a){const e=i[16],s=e[6].projection[n.projection];if(Array.isArray(s))r.push(...s);else{const i=Sn(e);t(i[1],i,s,r,!0)}}n=s?n.projectionNext:n.next}return r}(e,t,e.firstChild,[])}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){const t=this._viewContainerRef.indexOf(this);t>-1&&this._viewContainerRef.detach(t),this._viewContainerRef=null}Ir(this._lView[1],this._lView)}onDestroy(t){!function(t,e,i,n){const r=wr(e);r.push(null),t.firstCreatePass&&function(t){return t.cleanup||(t.cleanup=[])}(t).push(n,r.length-1)}(this._lView[1],this._lView,0,t)}markForCheck(){vr(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){br(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,i){ai(!0);try{br(t,e,i)}finally{ai(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(t){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=t}detachFromAppRef(){var t;this._appRef=null,Lr(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class Fr extends Nr{constructor(t){super(t),this._view=t}detectChanges(){yr(this._view)}checkNoChanges(){!function(t){ai(!0);try{yr(t)}finally{ai(!1)}}(this._view)}get context(){return null}}let Br,Hr,Kr;function qr(t,e,i){return Br||(Br=class extends t{}),new Br(Fe(e,i))}function zr(t,e,i,n){return Hr||(Hr=class extends t{constructor(t,e,i){super(),this._declarationView=t,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(t){const e=this._declarationTContainer.tViews,i=Fn(this._declarationView,e,t,16,null,e.declTNode,null,null,null,null);i[17]=this._declarationView[this._declarationTContainer.index];const n=this._declarationView[19];return null!==n&&(i[19]=n.createEmbeddedView(e)),Hn(e,i,t),new Nr(i)}}),0===i.type?new Hr(n,i,qr(e,i,n)):null}function Qr(t=!1){return function(t,e,i){if(!i&&we(t)){const i=Ke(t.index,e);return new Nr(i,i)}return 2===t.type||0===t.type||3===t.type||4===t.type?new Nr(e[16],e):null}(ii(),Xe(),t)}let Wr=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Jr(),t})();const Jr=Qr,Yr=Function,Zr=new Ot("Set Injector scope."),Xr={},ts={},es=[];let is=void 0;function ns(){return void 0===is&&(is=new Qt),is}function rs(t,e=null,i=null,n){return new ss(t,i,e||ns(),n)}class ss{constructor(t,e,i,n=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const r=[];e&&Yt(e,i=>this.processProvider(i,t,e)),Yt([t],t=>this.processInjectorType(t,[],r)),this.records.set(Gt,ls(void 0,this));const s=this.records.get(Zr);this.scope=null!=s?s.value:null,this.source=n||("object"==typeof t?null:vt(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=Lt,i=rt.Default){this.assertNotDestroyed();const n=Ft(this);try{if(!(i&rt.SkipSelf)){let e=this.records.get(t);if(void 0===e){const i=("function"==typeof(r=t)||"object"==typeof r&&r instanceof Ot)&&ct(t);e=i&&this.injectableDefInScope(i)?ls(os(t),Xr):null,this.records.set(t,e)}if(null!=e)return this.hydrate(t,e)}return(i&rt.Self?ns():this.parent).get(t,e=i&rt.Optional&&e===Lt?null:e)}catch(s){if("NullInjectorError"===s.name){if((s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(vt(t)),n)throw s;return function(t,e,i,n){const r=t.ngTempTokenPath;throw e.__source&&r.unshift(e.__source),t.message=function(t,e,i,n=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let r=vt(e);if(Array.isArray(e))r=e.map(vt).join(" -> ");else if("object"==typeof e){let t=[];for(let i in e)if(e.hasOwnProperty(i)){let n=e[i];t.push(i+":"+("string"==typeof n?JSON.stringify(n):vt(n)))}r=`{${t.join(", ")}}`}return`${i}${n?"("+n+")":""}[${r}]: ${t.replace(Rt,"\n  ")}`}("\n"+t.message,r,i,n),t.ngTokenPath=r,t.ngTempTokenPath=null,t}(s,t,"R3InjectorError",this.source)}throw s}finally{Ft(n)}var r}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((e,i)=>t.push(vt(i))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,i){if(!(t=Vt(t)))return!1;let n=ut(t);const r=null==n&&t.ngModule||void 0,s=void 0===r?t:r,o=-1!==i.indexOf(s);if(void 0!==r&&(n=ut(r)),null==n)return!1;if(null!=n.imports&&!o){let t;i.push(s);try{Yt(n.imports,n=>{this.processInjectorType(n,e,i)&&(void 0===t&&(t=[]),t.push(n))})}finally{}if(void 0!==t)for(let e=0;e<t.length;e++){const{ngModule:i,providers:n}=t[e];Yt(n,t=>this.processProvider(t,i,n||es))}}this.injectorDefTypes.add(s),this.records.set(s,ls(n.factory,Xr));const a=n.providers;if(null!=a&&!o){const e=t;Yt(a,t=>this.processProvider(t,e,a))}return void 0!==r&&void 0!==t.providers}processProvider(t,e,i){let n=ds(t=Vt(t))?t:Vt(t&&t.provide);const r=function(t,e,i){return cs(t)?ls(void 0,t.useValue):ls(as(t),Xr)}(t);if(ds(t)||!0!==t.multi)this.records.get(n);else{let e=this.records.get(n);e||(e=ls(void 0,Xr,!0),e.factory=()=>zt(e.multi),this.records.set(n,e)),n=t,e.multi.push(t)}this.records.set(n,r)}hydrate(t,e){var i;return e.value===Xr&&(e.value=ts,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(i=e.value)&&"object"==typeof i&&"function"==typeof i.ngOnDestroy&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){return!!t.providedIn&&("string"==typeof t.providedIn?"any"===t.providedIn||t.providedIn===this.scope:this.injectorDefTypes.has(t.providedIn))}}function os(t){const e=ct(t),i=null!==e?e.factory:ve(t);if(null!==i)return i;const n=ut(t);if(null!==n)return n.factory;if(t instanceof Ot)throw new Error(`Token ${vt(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const i=function(t,e){const i=[];for(let n=0;n<t;n++)i.push("?");return i}(e);throw new Error(`Can't resolve all parameters for ${vt(t)}: (${i.join(", ")}).`)}const i=function(t){const e=t&&(t[ht]||t[mt]||t[gt]&&t[gt]());if(e){const i=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${i}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${i}" class.`),e}return null}(t);return null!==i?()=>i.factory(t):()=>new t}(t);throw new Error("unreachable")}function as(t,e,i){let n=void 0;if(ds(t)){const e=Vt(t);return ve(e)||os(e)}if(cs(t))n=()=>Vt(t.useValue);else if((r=t)&&r.useFactory)n=()=>t.useFactory(...zt(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))n=()=>Kt(Vt(t.useExisting));else{const e=Vt(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return ve(e)||os(e);n=()=>new e(...zt(t.deps))}var r;return n}function ls(t,e,i=!1){return{factory:t,value:e,multi:i?[]:void 0}}function cs(t){return null!==t&&"object"==typeof t&&jt in t}function ds(t){return"function"==typeof t}const us=function(t,e,i){return function(t,e=null,i=null,n){const r=rs(t,e,i,n);return r._resolveInjectorDefTypes(),r}({name:i},e,t,i)};let hs=(()=>{class t{static create(t,e){return Array.isArray(t)?us(t,e,""):us(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=Lt,t.NULL=new Qt,t.\u0275prov=at({token:t,providedIn:"any",factory:()=>Kt(Gt)}),t.__NG_ELEMENT_ID__=-1,t})();const ps=new Ot("AnalyzeForEntryComponents");function gs(t,e,i){let n=i?t.styles:null,r=i?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const t=e[o];"number"==typeof t?s=t:1==s?r=bt(r,t):2==s&&(n=bt(n,t+": "+e[++o]+";"))}i?t.styles=n:t.stylesWithoutHost=n,i?t.classes=r:t.classesWithoutHost=r}function ms(t,e){const i=qe(t)[1],n=i.data.length-1;ki(i,{directiveStart:n,directiveEnd:n+1})}function fs(t){let e=Object.getPrototypeOf(t.type.prototype).constructor,i=!0;const n=[t];for(;e;){let r=void 0;if(Pe(t))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");r=e.\u0275dir}if(r){if(i){n.push(r);const e=t;e.inputs=vs(t.inputs),e.declaredInputs=vs(t.declaredInputs),e.outputs=vs(t.outputs);const i=r.hostBindings;i&&Cs(t,i);const s=r.viewQuery,o=r.contentQueries;if(s&&bs(t,s),o&&ys(t,o),ot(t.inputs,r.inputs),ot(t.declaredInputs,r.declaredInputs),ot(t.outputs,r.outputs),Pe(r)&&r.data.animation){const e=t.data;e.animation=(e.animation||[]).concat(r.data.animation)}}const e=r.features;if(e)for(let n=0;n<e.length;n++){const r=e[n];r&&r.ngInherit&&r(t),r===fs&&(i=!1)}}e=Object.getPrototypeOf(e)}!function(t){let e=0,i=null;for(let n=t.length-1;n>=0;n--){const r=t[n];r.hostVars=e+=r.hostVars,r.hostAttrs=Oi(r.hostAttrs,i=Oi(i,r.hostAttrs))}}(n)}function vs(t){return t===se?{}:t===oe?[]:t}function bs(t,e){const i=t.viewQuery;t.viewQuery=i?(t,n)=>{e(t,n),i(t,n)}:e}function ys(t,e){const i=t.contentQueries;t.contentQueries=i?(t,n,r)=>{e(t,n,r),i(t,n,r)}:e}function Cs(t,e){const i=t.hostBindings;t.hostBindings=i?(t,n)=>{e(t,n),i(t,n)}:e}let Vs=null;function ws(){if(!Vs){const t=Mt.Symbol;if(t&&t.iterator)Vs=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const i=t[e];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Vs=i)}}}return Vs}class As{constructor(t){this.wrapped=t}static wrap(t){return new As(t)}static unwrap(t){return As.isWrapped(t)?t.wrapped:t}static isWrapped(t){return t instanceof As}}function Ps(t){return!!ks(t)&&(Array.isArray(t)||!(t instanceof Map)&&ws()in t)}function ks(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Ds(t,e,i){return t[e]=i}function Ms(t,e){return t[e]}function Ss(t,e,i){return!Object.is(t[e],i)&&(t[e]=i,!0)}function Is(t,e,i,n){const r=Ss(t,e,i);return Ss(t,e+1,n)||r}function xs(t,e,i,n,r){const s=Is(t,e,i,n);return Ss(t,e+2,r)||s}function Ts(t,e,i,n,r,s){const o=Is(t,e,i,n);return Is(t,e+2,r,s)||o}function _s(t,e,i,n){const r=Xe();return Ss(r,di(),e)&&(ti(),function(t,e,i,n,r,s){const o=Fe(t,e),a=e[11];if(null==n)Re(a)?a.removeAttribute(o,i,s):o.removeAttribute(i);else{const e=null==r?De(n):r(n,t.tagName||"",i);Re(a)?a.setAttribute(o,i,e,s):s?o.setAttributeNS(s,i,e):o.setAttribute(i,e)}}(Pi(),r,t,e,i,n)),_s}function Us(t,e,i,n){return Ss(t,di(),i)?e+De(i)+n:Mn}function Es(t,e,i,n,r,s){const o=Is(t,ci(),i,r);return ui(2),o?e+De(i)+n+De(r)+s:Mn}function Os(t,e,i,n,r,s,o,a){const l=xs(t,ci(),i,r,o);return ui(3),l?e+De(i)+n+De(r)+s+De(o)+a:Mn}function Gs(t,e,i,n,r,s,o,a){const l=Xe(),c=ti(),d=t+20,u=c.firstCreatePass?function(t,e,i,n,r,s,o,a,l){const c=e.consts,d=Bn(e,t,0,o||null,Qe(c,a));er(e,i,d,Qe(c,l)),ki(e,d);const u=d.tViews=Zn(2,d,n,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,d),u.queries=e.queries.embeddedTView(d)),d}(t,c,l,e,i,n,r,s,o):c.data[d];ni(u,!1);const h=l[11].createComment("");Or(c,l,h,u),fn(h,l),fr(l,l[d]=pr(h,l,h,u)),Ae(u)&&Wn(c,l,u),null!=o&&Jn(l,u,a)}function Ls(t){return He(Ye.lFrame.contextLView,t)}function Rs(t,e=rt.Default){const i=Xe();return null===i?Kt(t,e):Qi(ii(),i,Vt(t),e)}function js(t,e,i){const n=Xe();return Ss(n,di(),e)&&tr(ti(),Pi(),n,t,e,n[11],i,!1),js}function $s(t,e,i,n,r){const s=r?"class":"style";Pr(t,i,e.inputs[s],s,n)}function Ns(t,e,i,n){const r=Xe(),s=ti(),o=20+t,a=r[11],l=r[o]=Nn(e,a,Ye.lFrame.currentNamespace),c=s.firstCreatePass?function(t,e,i,n,r,s,o){const a=e.consts,l=Bn(e,t,2,r,Qe(a,s));return er(e,i,l,Qe(a,o)),null!==l.attrs&&gs(l,l.attrs,!1),null!==l.mergedAttrs&&gs(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(t,s,r,0,e,i,n):s.data[o];ni(c,!0);const d=c.mergedAttrs;null!==d&&_i(a,l,d);const u=c.classes;null!==u&&$r(a,l,u);const h=c.styles;null!==h&&jr(a,l,h),Or(s,r,l,c),0===Ye.lFrame.elementDepthCount&&fn(l,r),Ye.lFrame.elementDepthCount++,Ae(c)&&(Wn(s,r,c),Qn(s,c,r)),null!==n&&Jn(r,c)}function Fs(){let t=ii();ri()?si():(t=t.parent,ni(t,!1));const e=t;Ye.lFrame.elementDepthCount--;const i=ti();i.firstCreatePass&&(ki(i,t),Ve(t)&&i.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&$s(i,e,Xe(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&$s(i,e,Xe(),e.stylesWithoutHost,!1)}function Bs(t,e,i,n){Ns(t,e,i,n),Fs()}function Hs(t,e,i){const n=Xe(),r=ti(),s=t+20,o=r.firstCreatePass?function(t,e,i,n,r){const s=e.consts,o=Qe(s,n),a=Bn(e,t,3,"ng-container",o);return null!==o&&gs(a,o,!0),er(e,i,a,Qe(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(t,r,n,e,i):r.data[s];ni(o,!0);const a=n[s]=n[11].createComment("");Or(r,n,a,o),fn(a,n),Ae(o)&&(Wn(r,n,o),Qn(r,o,n)),null!=i&&Jn(n,o)}function Ks(){let t=ii();const e=ti();ri()?si():(t=t.parent,ni(t,!1)),e.firstCreatePass&&(ki(e,t),Ve(t)&&e.queries.elementEnd(t))}function qs(t,e,i){Hs(t,e,i),Ks()}function zs(){return Xe()}function Qs(t){return!!t&&"function"==typeof t.then}function Ws(t){return!!t&&"function"==typeof t.subscribe}function Js(t,e,i=!1,n){const r=Xe(),s=ti(),o=ii();return function(t,e,i,n,r,s,o=!1,a){const l=Ae(n),c=t.firstCreatePass&&(t.cleanup||(t.cleanup=[])),d=wr(e);let u=!0;if(2===n.type){const h=Fe(n,e),p=a?a(h):se,g=p.target||h,m=d.length,f=a?t=>a($e(t[n.index])).target:n.index;if(Re(i)){let o=null;if(!a&&l&&(o=function(t,e,i,n){const r=t.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const t=r[s];if(t===i&&r[s+1]===n){const t=e[7],i=r[s+2];return t.length>i?t[i]:null}"string"==typeof t&&(s+=2)}return null}(t,e,r,n.index)),null!==o)(o.__ngLastListenerFn__||o).__ngNextListenerFn__=s,o.__ngLastListenerFn__=s,u=!1;else{s=Zs(n,e,s,!1);const t=i.listen(p.name||g,r,s);d.push(s,t),c&&c.push(r,f,m,m+1)}}else s=Zs(n,e,s,!0),g.addEventListener(r,s,o),d.push(s),c&&c.push(r,f,m,o)}const h=n.outputs;let p;if(u&&null!==h&&(p=h[r])){const t=p.length;if(t)for(let i=0;i<t;i+=2){const t=e[p[i]][p[i+1]].subscribe(s),o=d.length;d.push(s,t),c&&c.push(r,n.index,o,-(o+1))}}}(s,r,r[11],o,t,e,i,n),Js}function Ys(t,e,i){try{return!1!==e(i)}catch(n){return Ar(t,n),!1}}function Zs(t,e,i,n){return function r(s){if(s===Function)return i;const o=2&t.flags?Ke(t.index,e):e;0==(32&e[2])&&vr(o);let a=Ys(e,i,s),l=r.__ngNextListenerFn__;for(;l;)a=Ys(e,l,s)&&a,l=l.__ngNextListenerFn__;return n&&!1===a&&(s.preventDefault(),s.returnValue=!1),a}}function Xs(t=1){return function(t){return(Ye.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,Ye.lFrame.contextLView))[8]}(t)}function to(t,e,i){return eo(t,"",e,"",i),to}function eo(t,e,i,n,r){const s=Xe(),o=Us(s,e,i,n);return o!==Mn&&tr(ti(),Pi(),s,t,o,s[11],r,!1),eo}function io(t,e,i,n,r,s,o){const a=Xe(),l=Es(a,e,i,n,r,s);return l!==Mn&&tr(ti(),Pi(),a,t,l,a[11],o,!1),io}function no(t,e,i,n,r,s,o,a,l){const c=Xe(),d=Os(c,e,i,n,r,s,o,a);return d!==Mn&&tr(ti(),Pi(),c,t,d,c[11],l,!1),no}const ro=[];function so(t,e,i,n,r){const s=t[i+1],o=null===e;let a=n?On(s):Ln(s),l=!1;for(;0!==a&&(!1===l||o);){const i=t[a+1];oo(t[a],e)&&(l=!0,t[a+1]=n?jn(i):Gn(i)),a=n?On(i):Ln(i)}l&&(t[i+1]=n?Gn(s):jn(s))}function oo(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&ie(t,e)>=0}function ao(t,e,i){return co(t,e,i,!1),ao}function lo(t,e){return co(t,e,null,!0),lo}function co(t,e,i,n){const r=Xe(),s=ti(),o=ui(2);s.firstUpdatePass&&function(t,e,i,n){const r=t.data;if(null===r[i+1]){const s=r[wi()+20],o=function(t,e){return e>=t.expandoStartIndex}(t,i);(function(t,e){return 0!=(t.flags&(e?16:32))})(s,n)&&null===e&&!o&&(e=!1),e=function(t,e,i,n){const r=function(t){const e=Ye.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let s=n?e.residualClasses:e.residualStyles;if(null===r)0===(n?e.classBindings:e.styleBindings)&&(i=ho(i=uo(null,t,e,i,n),e.attrs,n),s=null);else{const o=e.directiveStylingLast;if(-1===o||t[o]!==r)if(i=uo(r,t,e,i,n),null===s){let i=function(t,e,i){const n=i?e.classBindings:e.styleBindings;if(0!==Ln(n))return t[On(n)]}(t,e,n);void 0!==i&&Array.isArray(i)&&(i=uo(null,t,e,i[1],n),i=ho(i,e.attrs,n),function(t,e,i,n){t[On(i?e.classBindings:e.styleBindings)]=n}(t,e,n,i))}else s=function(t,e,i){let n=void 0;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)n=ho(n,t[s].hostAttrs,i);return ho(n,e.attrs,i)}(t,e,n)}return void 0!==s&&(n?e.residualClasses=s:e.residualStyles=s),i}(r,s,e,n),function(t,e,i,n,r,s){let o=s?e.classBindings:e.styleBindings,a=On(o),l=Ln(o);t[n]=i;let c,d=!1;if(Array.isArray(i)){const t=i;c=t[1],(null===c||ie(t,c)>0)&&(d=!0)}else c=i;if(r)if(0!==l){const e=On(t[a+1]);t[n+1]=En(e,a),0!==e&&(t[e+1]=Rn(t[e+1],n)),t[a+1]=131071&t[a+1]|n<<17}else t[n+1]=En(a,0),0!==a&&(t[a+1]=Rn(t[a+1],n)),a=n;else t[n+1]=En(l,0),0===a?a=n:t[l+1]=Rn(t[l+1],n),l=n;d&&(t[n+1]=Gn(t[n+1])),so(t,c,n,!0),so(t,c,n,!1),function(t,e,i,n,r){const s=r?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof e&&ie(s,e)>=0&&(i[n+1]=jn(i[n+1]))}(e,c,t,n,s),o=En(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,i,o,n)}}(s,t,o,n),e!==Mn&&Ss(r,o,e)&&function(t,e,i,n,r,s,o,a){if(2!==e.type)return;const l=t.data,c=l[a+1];go(1==(1&c)?po(l,e,i,r,Ln(c),o):void 0)||(go(s)||function(t){return 2==(2&t)}(c)&&(s=po(l,null,i,r,a,o)),function(t,e,i,n,r){const s=Re(t);if(e)r?s?t.addClass(i,n):i.classList.add(n):s?t.removeClass(i,n):i.classList.remove(n);else{const e=-1==n.indexOf("-")?void 0:2;null==r?s?t.removeStyle(i,n,e):i.style.removeProperty(n):s?t.setStyle(i,n,r,e):i.style.setProperty(n,r)}}(n,o,Ne(wi(),i),r,s))}(s,s.data[wi()+20],r,r[11],t,r[o+1]=function(t,e){return null==t||("string"==typeof e?t+=e:"object"==typeof t&&(t=vt(cn(t)))),t}(e,i),n,o)}function uo(t,e,i,n,r){let s=null;const o=i.directiveEnd;let a=i.directiveStylingLast;for(-1===a?a=i.directiveStart:a++;a<o&&(s=e[a],n=ho(n,s.hostAttrs,r),s!==t);)a++;return null!==t&&(i.directiveStylingLast=a),n}function ho(t,e,i){const n=i?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===n&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),te(t,o,!!i||e[++s]))}return void 0===t?null:t}function po(t,e,i,n,r,s){const o=null===e;let a=void 0;for(;r>0;){const e=t[r],s=Array.isArray(e),l=s?e[1]:e,c=null===l;let d=i[r+1];d===Mn&&(d=c?ro:void 0);let u=c?ee(d,n):l===n?d:void 0;if(s&&!go(u)&&(u=ee(e,n)),go(u)&&(a=u,o))return a;const h=t[r+1];r=o?On(h):Ln(h)}if(null!==e){let t=s?e.residualClasses:e.residualStyles;null!=t&&(a=ee(t,n))}return a}function go(t){return void 0!==t}function mo(t,e=""){const i=Xe(),n=ti(),r=t+20,s=n.firstCreatePass?Bn(n,t,2,null,null):n.data[r],o=i[r]=function(t,e){return Re(e)?e.createText(t):e.createTextNode(t)}(e,i[11]);Or(n,i,o,s),ni(s,!1)}function fo(t){return vo("",t,""),fo}function vo(t,e,i){const n=Xe(),r=Us(n,t,e,i);return r!==Mn&&kr(n,wi(),r),vo}function bo(t,e,i,n,r){const s=Xe(),o=Es(s,t,e,i,n,r);return o!==Mn&&kr(s,wi(),o),bo}function yo(t,e,i,n,r,s,o){const a=Xe(),l=Os(a,t,e,i,n,r,s,o);return l!==Mn&&kr(a,wi(),l),yo}function Co(t,e,i,n,r,s,o,a,l){const c=Xe(),d=function(t,e,i,n,r,s,o,a,l,c){const d=Ts(t,ci(),i,r,o,l);return ui(4),d?e+De(i)+n+De(r)+s+De(o)+a+De(l)+c:Mn}(c,t,e,i,n,r,s,o,a,l);return d!==Mn&&kr(c,wi(),d),Co}function Vo(t,e,i){const n=Xe();return Ss(n,di(),e)&&tr(ti(),Pi(),n,t,e,n[11],i,!0),Vo}const wo=void 0;var Ao=["en",[["a","p"],["AM","PM"],wo],[["AM","PM"],wo,wo],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],wo,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],wo,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",wo,"{1} 'at' {0}",wo],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){let e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let Po={};function ko(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let i=Do(e);if(i)return i;const n=e.split("-")[0];if(i=Do(n),i)return i;if("en"===n)return Ao;throw new Error(`Missing locale data for the locale "${t}".`)}function Do(t){return t in Po||(Po[t]=Mt.ng&&Mt.ng.common&&Mt.ng.common.locales&&Mt.ng.common.locales[t]),Po[t]}var Mo=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}({});let So="en-US";function Io(t){var e,i;i="Expected localeId to be defined",null==(e=t)&&function(t,e,i,n){throw new Error("ASSERTION ERROR: "+t+` [Expected=> null != ${e} <=Actual]`)}(i,e),"string"==typeof t&&(So=t.toLowerCase().replace(/_/g,"-"))}function xo(t,e,i,n,r){if(t=Vt(t),Array.isArray(t))for(let s=0;s<t.length;s++)xo(t[s],e,i,n,r);else{const s=ti(),o=Xe();let a=ds(t)?t:Vt(t.provide),l=as(t);const c=ii(),d=1048575&c.providerIndexes,u=c.directiveStart,h=c.providerIndexes>>20;if(ds(t)||!t.multi){const n=new Ti(l,r,Rs),p=Uo(a,e,r?d:d+h,u);-1===p?(zi(Bi(c,o),s,a),To(s,t,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),i.push(n),o.push(n)):(i[p]=n,o[p]=n)}else{const p=Uo(a,e,d+h,u),g=Uo(a,e,d,d+h),m=p>=0&&i[p],f=g>=0&&i[g];if(r&&!f||!r&&!m){zi(Bi(c,o),s,a);const d=function(t,e,i,n,r){const s=new Ti(t,i,Rs);return s.multi=[],s.index=e,s.componentProviders=0,_o(s,r,n&&!i),s}(r?Oo:Eo,i.length,r,n,l);!r&&f&&(i[g].providerFactory=d),To(s,t,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),i.push(d),o.push(d)}else To(s,t,p>-1?p:g,_o(i[r?g:p],l,!r&&n));!r&&n&&f&&i[g].componentProviders++}}}function To(t,e,i,n){const r=ds(e);if(r||e.useClass){const s=(e.useClass||e).prototype.ngOnDestroy;if(s){const o=t.destroyHooks||(t.destroyHooks=[]);if(!r&&e.multi){const t=o.indexOf(i);-1===t?o.push(i,[n,s]):o[t+1].push(n,s)}else o.push(i,s)}}}function _o(t,e,i){return i&&t.componentProviders++,t.multi.push(e)-1}function Uo(t,e,i,n){for(let r=i;r<n;r++)if(e[r]===t)return r;return-1}function Eo(t,e,i,n){return Go(this.multi,[])}function Oo(t,e,i,n){const r=this.multi;let s;if(this.providerFactory){const t=this.providerFactory.componentProviders,e=Yi(i,i[1],this.providerFactory.index,n);s=e.slice(0,t),Go(r,s);for(let i=t;i<e.length;i++)s.push(e[i])}else s=[],Go(r,s);return s}function Go(t,e){for(let i=0;i<t.length;i++)e.push((0,t[i])());return e}function Lo(t,e=[]){return i=>{i.providersResolver=(i,n)=>function(t,e,i){const n=ti();if(n.firstCreatePass){const r=Pe(t);xo(i,n.data,n.blueprint,r,!0),xo(e,n.data,n.blueprint,r,!1)}}(i,n?n(t):t,e)}}class Ro{}class jo{resolveComponentFactory(t){throw function(t){const e=Error(`No component factory found for ${vt(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(t)}}let $o=(()=>{class t{}return t.NULL=new jo,t})(),No=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=()=>Fo(t),t})();const Fo=function(t){return qr(t,ii(),Xe())};class Bo{}var Ho=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}({});let Ko=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>qo(),t})();const qo=function(){const t=Xe(),e=Ke(ii().index,t);return function(t){const e=t[11];if(Re(e))return e;throw new Error("Cannot inject Renderer2 when the application uses Renderer3!")}(ye(e)?e:t)};let zo=(()=>{class t{}return t.\u0275prov=at({token:t,providedIn:"root",factory:()=>null}),t})();class Qo{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Wo=new Qo("10.2.4");class Jo{constructor(){}supports(t){return Ps(t)}create(t){return new Zo(t)}}const Yo=(t,e)=>e;class Zo{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||Yo}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,i=this._removalsHead,n=0,r=null;for(;e||i;){const s=!i||e&&e.currentIndex<ia(i,n,r)?e:i,o=ia(s,n,r),a=s.currentIndex;if(s===i)n--,i=i._nextRemoved;else if(e=e._next,null==s.previousIndex)n++;else{r||(r=[]);const t=o-n,e=a-n;if(t!=e){for(let i=0;i<t;i++){const n=i<r.length?r[i]:r[i]=0,s=n+i;e<=s&&s<t&&(r[i]=n+1)}r[s.previousIndex]=e-t}}o!==a&&t(s,o,a)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!Ps(t))throw new Error(`Error trying to diff '${vt(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,i,n,r=this._itHead,s=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)i=t[e],n=this._trackByFn(e,i),null!==r&&Object.is(r.trackById,n)?(s&&(r=this._verifyReinsertion(r,i,n,e)),Object.is(r.item,i)||this._addIdentityChange(r,i)):(r=this._mismatch(r,i,n,e),s=!0),r=r._next}else e=0,function(t,e){if(Array.isArray(t))for(let i=0;i<t.length;i++)e(t[i]);else{const i=t[ws()]();let n;for(;!(n=i.next()).done;)e(n.value)}}(t,t=>{n=this._trackByFn(e,t),null!==r&&Object.is(r.trackById,n)?(s&&(r=this._verifyReinsertion(r,t,n,e)),Object.is(r.item,t)||this._addIdentityChange(r,t)):(r=this._mismatch(r,t,n,e),s=!0),r=r._next,e++}),this.length=e;return this._truncate(r),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,i,n){let r;return null===t?r=this._itTail:(r=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,n))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,r,n)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,r,n)):t=this._addAfter(new Xo(e,i),r,n),t}_verifyReinsertion(t,e,i,n){let r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==r?t=this._reinsertAfter(r,t._prev,n):t.currentIndex!=n&&(t.currentIndex=n,this._addToMoves(t,n)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const n=t._prevRemoved,r=t._nextRemoved;return null===n?this._removalsHead=r:n._nextRemoved=r,null===r?this._removalsTail=n:r._prevRemoved=n,this._insertAfter(t,e,i),this._addToMoves(t,i),t}_moveAfter(t,e,i){return this._unlink(t),this._insertAfter(t,e,i),this._addToMoves(t,i),t}_addAfter(t,e,i){return this._insertAfter(t,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,i){const n=null===e?this._itHead:e._next;return t._next=n,t._prev=e,null===n?this._itTail=t:n._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new ea),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,i=t._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new ea),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Xo{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class ta{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const e=t._prevDup,i=t._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class ea{constructor(){this.map=new Map}put(t){const e=t.trackById;let i=this.map.get(e);i||(i=new ta,this.map.set(e,i)),i.add(t)}get(t,e){const i=this.map.get(t);return i?i.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function ia(t,e,i){const n=t.previousIndex;if(null===n)return n;let r=0;return i&&n<i.length&&(r=i[n]),n+e+r}class na{constructor(){}supports(t){return t instanceof Map||ks(t)}create(){return new ra}}class ra{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||ks(t)))throw new Error(`Error trying to diff '${vt(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,i)=>{if(e&&e.key===i)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const n=this._getOrCreateRecordForKey(i,t);e=this._insertBeforeOrAppend(e,n)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const i=t._prev;return e._next=t,e._prev=i,t._prev=e,i&&(i._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const i=this._records.get(t);this._maybeAddToChanges(i,e);const n=i._prev,r=i._next;return n&&(n._next=r),r&&(r._prev=n),i._next=null,i._prev=null,i}const i=new sa(t);return this._records.set(t,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(i=>e(t[i],i))}}class sa{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let oa=(()=>{class t{constructor(t){this.factories=t}static create(e,i){if(null!=i){const t=i.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>{if(!i)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,i)},deps:[[t,new nt,new et]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${i=t,i.name||typeof i}'`);var i}}return t.\u0275prov=at({token:t,providedIn:"root",factory:()=>new t([new Jo])}),t})(),aa=(()=>{class t{constructor(t){this.factories=t}static create(e,i){if(i){const t=i.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>{if(!i)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,i)},deps:[[t,new nt,new et]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.\u0275prov=at({token:t,providedIn:"root",factory:()=>new t([new na])}),t})();const la=[new na],ca=new oa([new Jo]),da=new aa(la);let ua=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>ha(t,No),t})();const ha=function(t,e){return zr(t,e,ii(),Xe())};let pa=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>ga(t,No),t})();const ga=function(t,e){return function(t,e,i,n){let r;Kr||(Kr=class extends t{constructor(t,e,i){super(),this._lContainer=t,this._hostTNode=e,this._hostView=i}get element(){return qr(e,this._hostTNode,this._hostView)}get injector(){return new tn(this._hostTNode,this._hostView)}get parentInjector(){const t=qi(this._hostTNode,this._hostView);if(Li(t)){const e=ji(t,this._hostView),i=Ri(t);return new tn(e[1].data[i+8],e)}return new tn(null,this._hostView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){return null!==this._lContainer[8]&&this._lContainer[8][t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,i){const n=t.createEmbeddedView(e||{});return this.insert(n,i),n}createComponent(t,e,i,n,r){const s=i||this.parentInjector;if(!r&&null==t.ngModule&&s){const t=s.get(Wt,null);t&&(r=t)}const o=t.create(s,n,void 0,r);return this.insert(o.hostView,e),o}insert(t,e){const i=t._lView,n=i[1];if(t.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");if(this.allocateContainerIfNeeded(),Ce(i[3])){const e=this.indexOf(t);if(-1!==e)this.detach(e);else{const e=i[3],n=new Kr(e,e[6],e[3]);n.detach(n.indexOf(t))}}const r=this._adjustIndex(e),s=this._lContainer;!function(t,e,i,n){const r=10+n,s=i.length;n>0&&(i[r-1][4]=e),n<s-10?(e[4]=i[r],Zt(i,10+n,e)):(i.push(e),e[4]=null),e[3]=i;const o=e[17];null!==o&&i!==o&&function(t,e){const i=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===i?t[9]=[e]:i.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(t),e[2]|=128}(n,i,s,r);const o=function t(e,i){const n=10+e+1;if(n<i.length){const e=i[n],r=e[1].firstChild;if(null!==r)return function e(i,n){if(null!==n){const r=n.type;if(2===r)return Fe(n,i);if(0===r)return t(-1,i[n.index]);if(3===r||4===r){const r=n.child;if(null!==r)return e(i,r);{const e=i[n.index];return Ce(e)?t(-1,e):$e(e)}}{const t=i[16],r=t[6],s=Sn(t),o=r.projection[n.projection];return null!=o?e(s,o):e(i,n.next)}}return null}(e,r)}return i[7]}(r,s),a=i[11],l=Er(a,s[7]);return null!==l&&function(t,e,i,n,r,s){n[0]=r,n[6]=e,Lr(t,n,i,1,r,s)}(n,s[6],a,i,l,o),t.attachToViewContainerRef(this),Zt(s[8],r,t),t}move(t,e){if(t.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");return this.insert(t,e)}indexOf(t){const e=this._lContainer[8];return null!==e?e.indexOf(t):-1}remove(t){this.allocateContainerIfNeeded();const e=this._adjustIndex(t,-1),i=Sr(this._lContainer,e);i&&(Xt(this._lContainer[8],e),Ir(i[1],i))}detach(t){this.allocateContainerIfNeeded();const e=this._adjustIndex(t,-1),i=Sr(this._lContainer,e);return i&&null!=Xt(this._lContainer[8],e)?new Nr(i):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}allocateContainerIfNeeded(){null===this._lContainer[8]&&(this._lContainer[8]=[])}});const s=n[i.index];if(Ce(s))r=s;else{let t;if(3===i.type)t=$e(s);else if(t=n[11].createComment(""),ke(n)){const e=n[11],r=Fe(i,n);Tr(e,Er(e,r),t,function(t,e){return Re(t)?t.nextSibling(e):e.nextSibling}(e,r))}else Or(n[1],n,t,i);n[i.index]=r=pr(s,n,t,i),fr(n,r)}return new Kr(r,i,n)}(t,e,ii(),Xe())},ma={};class fa extends $o{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=fe(t);return new ya(e,this.ngModule)}}function va(t){const e=[];for(let i in t)t.hasOwnProperty(i)&&e.push({propName:t[i],templateName:i});return e}const ba=new Ot("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Se});class ya extends Ro{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(Dn).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return va(this.componentDef.inputs)}get outputs(){return va(this.componentDef.outputs)}create(t,e,i,n){const r=(n=n||this.ngModule)?function(t,e){return{get:(i,n,r)=>{const s=t.get(i,ma,r);return s!==ma||n===ma?s:e.get(i,n,r)}}}(t,n.injector):t,s=r.get(Bo,je),o=r.get(zo,null),a=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",c=i?function(t,e,i){if(Re(t))return t.selectRootElement(e,i===re.ShadowDom);let n="string"==typeof e?t.querySelector(e):e;return n.textContent="",n}(a,i,this.componentDef.encapsulation):Nn(l,s.createRenderer(null,this.componentDef),function(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(l)),d=this.componentDef.onPush?576:528,u={components:[],scheduler:Se,clean:Vr,playerHandler:null,flags:0},h=Zn(0,null,null,1,0,null,null,null,null,null),p=Fn(null,h,u,d,null,null,s,a,o,r);let g,m;fi(p);try{const t=function(t,e,i,n,r,s){const o=i[1];i[20]=t;const a=Bn(o,0,2,null,null),l=a.mergedAttrs=e.hostAttrs;null!==l&&(gs(a,l,!0),null!==t&&(_i(r,t,l),null!==a.classes&&$r(r,t,a.classes),null!==a.styles&&jr(r,t,a.styles)));const c=n.createRenderer(t,e),d=Fn(i,Yn(e),null,e.onPush?64:16,i[20],a,n,c,null,null);return o.firstCreatePass&&(zi(Bi(a,i),o,e.type),or(o,a),lr(a,i.length,1)),fr(i,d),i[20]=d}(c,this.componentDef,p,s,a);if(c)if(i)_i(a,c,["ng-version",Wo.full]);else{const{attrs:t,classes:e}=function(t){const e=[],i=[];let n=1,r=2;for(;n<t.length;){let s=t[n];if("string"==typeof s)2===r?""!==s&&e.push(s,t[++n]):8===r&&i.push(s);else{if(!wn(r))break;r=s}n++}return{attrs:e,classes:i}}(this.componentDef.selectors[0]);t&&_i(a,c,t),e&&e.length>0&&$r(a,c,e.join(" "))}if(m=Be(h,0),void 0!==e){const t=m.projection=[];for(let i=0;i<this.ngContentSelectors.length;i++){const n=e[i];t.push(null!=n?Array.from(n):null)}}g=function(t,e,i,n,r){const s=i[1],o=function(t,e,i){const n=ii();t.firstCreatePass&&(i.providersResolver&&i.providersResolver(i),sr(t,n,1),cr(t,e,i));const r=Yi(e,t,e.length-1,n);fn(r,e);const s=Fe(n,e);return s&&fn(s,e),r}(s,i,e);n.components.push(o),t[8]=o,r&&r.forEach(t=>t(o,e)),e.contentQueries&&e.contentQueries(1,o,i.length-1);const a=ii();if(s.firstCreatePass&&(null!==e.hostBindings||null!==e.hostAttrs)){Ai(a.index-20);const t=i[1];ir(t,e),nr(t,i,e.hostVars),rr(e,o)}return o}(t,this.componentDef,p,u,[ms]),Hn(h,p,null)}finally{Vi()}return new Ca(this.componentType,g,qr(No,m,p),p,m)}}class Ca extends class{}{constructor(t,e,i,n,r){super(),this.location=i,this._rootLView=n,this._tNode=r,this.destroyCbs=[],this.instance=e,this.hostView=this.changeDetectorRef=new Fr(n),this.componentType=t}get injector(){return new tn(this._tNode,this._rootLView)}destroy(){this.destroyCbs&&(this.destroyCbs.forEach(t=>t()),this.destroyCbs=null,!this.hostView.destroyed&&this.hostView.destroy())}onDestroy(t){this.destroyCbs&&this.destroyCbs.push(t)}}const Va=new Map;class wa extends Wt{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new fa(this);const i=be(t),n=t[_t]||null;n&&Io(n),this._bootstrapComponents=Ie(i.bootstrap),this._r3Injector=rs(t,e,[{provide:Wt,useValue:this},{provide:$o,useValue:this.componentFactoryResolver}],vt(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=hs.THROW_IF_NOT_FOUND,i=rt.Default){return t===hs||t===Wt||t===Gt?this:this._r3Injector.get(t,e,i)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Aa extends Jt{constructor(t){super(),this.moduleType=t,null!==be(t)&&function(t){const e=new Set;!function t(i){const n=be(i,!0),r=n.id;null!==r&&(function(t,e,i){if(e&&e!==i)throw new Error(`Duplicate module registered for ${t} - ${vt(e)} vs ${vt(e.name)}`)}(r,Va.get(r),i),Va.set(r,i));const s=Ie(n.imports);for(const o of s)e.has(o)||(e.add(o),t(o))}(t)}(t)}create(t){return new wa(this.moduleType,t)}}function Pa(t,e,i){const n=li()+t,r=Xe();return r[n]===Mn?Ds(r,n,i?e.call(i):e()):Ms(r,n)}function ka(t,e,i,n){return Ta(Xe(),li(),t,e,i,n)}function Da(t,e,i,n,r){return _a(Xe(),li(),t,e,i,n,r)}function Ma(t,e,i,n,r,s){return function(t,e,i,n,r,s,o,a){const l=e+i;return xs(t,l,r,s,o)?Ds(t,l+3,a?n.call(a,r,s,o):n(r,s,o)):xa(t,l+3)}(Xe(),li(),t,e,i,n,r,s)}function Sa(t,e,i,n,r,s,o){return function(t,e,i,n,r,s,o,a,l){const c=e+i;return Ts(t,c,r,s,o,a)?Ds(t,c+4,l?n.call(l,r,s,o,a):n(r,s,o,a)):xa(t,c+4)}(Xe(),li(),t,e,i,n,r,s,o)}function Ia(t,e,i,n,r,s,o,a,l){const c=li()+t,d=Xe(),u=Ts(d,c,i,n,r,s);return Is(d,c+4,o,a)||u?Ds(d,c+6,l?e.call(l,i,n,r,s,o,a):e(i,n,r,s,o,a)):Ms(d,c+6)}function xa(t,e){const i=t[e];return i===Mn?void 0:i}function Ta(t,e,i,n,r,s){const o=e+i;return Ss(t,o,r)?Ds(t,o+1,s?n.call(s,r):n(r)):xa(t,o+1)}function _a(t,e,i,n,r,s,o){const a=e+i;return Is(t,a,r,s)?Ds(t,a+2,o?n.call(o,r,s):n(r,s)):xa(t,a+2)}function Ua(t,e){const i=ti();let n;const r=t+20;i.firstCreatePass?(n=function(t,e){if(e)for(let i=e.length-1;i>=0;i--){const n=e[i];if(t===n.name)return n}throw new Error(`The pipe '${t}' could not be found!`)}(e,i.pipeRegistry),i.data[r]=n,n.onDestroy&&(i.destroyHooks||(i.destroyHooks=[])).push(r,n.onDestroy)):n=i.data[r];const s=n.factory||(n.factory=ve(n.type)),o=Bt(Rs);try{const e=Ni(!1),n=s();return Ni(e),function(t,e,i,n){const r=i+20;r>=t.data.length&&(t.data[r]=null,t.blueprint[r]=null),e[r]=n}(i,Xe(),t,n),n}finally{Bt(o)}}function Ea(t,e,i){const n=Xe(),r=He(n,t);return La(n,Ga(n,t)?Ta(n,li(),e,r.transform,i,r):r.transform(i))}function Oa(t,e,i,n){const r=Xe(),s=He(r,t);return La(r,Ga(r,t)?_a(r,li(),e,s.transform,i,n,s):s.transform(i,n))}function Ga(t,e){return t[1].data[e+20].pure}function La(t,e){return As.isWrapped(e)&&(e=As.unwrap(e),t[ci()]=Mn),e}const Ra=class extends A{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,i){let n,r=t=>null,s=()=>null;t&&"object"==typeof t?(n=this.__isAsync?e=>{setTimeout(()=>t.next(e))}:e=>{t.next(e)},t.error&&(r=this.__isAsync?e=>{setTimeout(()=>t.error(e))}:e=>{t.error(e)}),t.complete&&(s=this.__isAsync?()=>{setTimeout(()=>t.complete())}:()=>{t.complete()})):(n=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)},e&&(r=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)}),i&&(s=this.__isAsync?()=>{setTimeout(()=>i())}:()=>{i()}));const o=super.subscribe(n,r,s);return t instanceof u&&t.add(o),o}};function ja(t,e){return zr(ua,No,t,e)}const $a=new Ot("Application Initializer");let Na=(()=>{class t{constructor(t){this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const e=this.appInits[i]();Qs(e)&&t.push(e)}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(Kt($a,8))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Fa=new Ot("AppId"),Ba={provide:Fa,useFactory:function(){return`${Ha()}${Ha()}${Ha()}`},deps:[]};function Ha(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Ka=new Ot("Platform Initializer"),qa=new Ot("Platform ID"),za=new Ot("appBootstrapListener");let Qa=(()=>{class t{log(t){console.log(t)}warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Wa=new Ot("LocaleId"),Ja=new Ot("DefaultCurrencyCode");class Ya{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const Za=function(t){return new Aa(t)},Xa=Za,tl=function(t){return Promise.resolve(Za(t))},el=function(t){const e=Za(t),i=Ie(be(t).declarations).reduce((t,e)=>{const i=fe(e);return i&&t.push(new ya(i)),t},[]);return new Ya(e,i)},il=el,nl=function(t){return Promise.resolve(el(t))};let rl=(()=>{class t{constructor(){this.compileModuleSync=Xa,this.compileModuleAsync=tl,this.compileModuleAndAllComponentsSync=il,this.compileModuleAndAllComponentsAsync=nl}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const sl=(()=>Promise.resolve(0))();function ol(t){"undefined"==typeof Zone?sl.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class al{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ra(!1),this.onMicrotaskEmpty=new Ra(!1),this.onStable=new Ra(!1),this.onError=new Ra(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=e,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){let t=Mt.requestAnimationFrame,e=Mt.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i);const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=!!t.shouldCoalesceEventChangeDetection&&t.nativeRequestAnimationFrame&&(()=>{!function(t){-1===t.lastRequestAnimationFrameId&&(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Mt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,ul(t),dl(t)},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),ul(t))}(t)});t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:e},onInvokeTask:(i,n,r,s,o,a)=>{try{return hl(t),i.invokeTask(r,s,o,a)}finally{e&&"eventTask"===s.type&&e(),pl(t)}},onInvoke:(e,i,n,r,s,o,a)=>{try{return hl(t),e.invoke(n,r,s,o,a)}finally{pl(t)}},onHasTask:(e,i,n,r)=>{e.hasTask(n,r),i===n&&("microTask"==r.change?(t._hasPendingMicrotasks=r.microTask,ul(t),dl(t)):"macroTask"==r.change&&(t.hasPendingMacrotasks=r.macroTask))},onHandleError:(e,i,n,r)=>(e.handleError(n,r),t.runOutsideAngular(()=>t.onError.emit(r)),!1)})}(this)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!al.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(al.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,n){const r=this._inner,s=r.scheduleEventTask("NgZoneEvent: "+n,t,cl,ll,ll);try{return r.runTask(s,e,i)}finally{r.cancelTask(s)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}}function ll(){}const cl={};function dl(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function ul(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||t.shouldCoalesceEventChangeDetection&&-1!==t.lastRequestAnimationFrameId)}function hl(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function pl(t){t._nesting--,dl(t)}class gl{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ra,this.onMicrotaskEmpty=new Ra,this.onStable=new Ra,this.onError=new Ra}run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,n){return t.apply(e,i)}}let ml=(()=>{class t{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{al.assertNotInAngularZone(),ol(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())ol(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,i){let n=-1;e&&e>0&&(n=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==n),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:n,updateCb:i})}whenStable(t,e,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,i){return[]}}return t.\u0275fac=function(e){return new(e||t)(Kt(al))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),fl=(()=>{class t{constructor(){this._applications=new Map,yl.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return yl.findTestabilityInTree(this,t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class vl{addToWindow(t){}findTestabilityInTree(t,e,i){return null}}let bl,yl=new vl;const Cl=new Ot("AllowMultipleToken");class Vl{constructor(t,e){this.name=t,this.token=e}}function wl(t,e,i=[]){const n="Platform: "+e,r=new Ot(n);return(e=[])=>{let s=Al();if(!s||s.injector.get(Cl,!1))if(t)t(i.concat(e).concat({provide:r,useValue:!0}));else{const t=i.concat(e).concat({provide:r,useValue:!0},{provide:Zr,useValue:"platform"});!function(t){if(bl&&!bl.destroyed&&!bl.injector.get(Cl,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");bl=t.get(Pl);const e=t.get(Ka,null);e&&e.forEach(t=>t())}(hs.create({providers:t,name:n}))}return function(t){const e=Al();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(r)}}function Al(){return bl&&!bl.destroyed?bl:null}let Pl=(()=>{class t{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const i=function(t,e){let i;return i="noop"===t?new gl:("zone.js"===t?void 0:t)||new al({enableLongStackTrace:un(),shouldCoalesceEventChangeDetection:e}),i}(e?e.ngZone:void 0,e&&e.ngZoneEventCoalescing||!1),n=[{provide:al,useValue:i}];return i.run(()=>{const e=hs.create({providers:n,parent:this.injector,name:t.moduleType.name}),r=t.create(e),s=r.injector.get(an,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return r.onDestroy(()=>Ml(this._modules,r)),i.runOutsideAngular(()=>i.onError.subscribe({next:t=>{s.handleError(t)}})),function(t,e,i){try{const n=i();return Qs(n)?n.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):n}catch(n){throw e.runOutsideAngular(()=>t.handleError(n)),n}}(s,i,()=>{const t=r.injector.get(Na);return t.runInitializers(),t.donePromise.then(()=>(Io(r.injector.get(Wa,"en-US")||"en-US"),this._moduleDoBootstrap(r),r))})})}bootstrapModule(t,e=[]){const i=kl({},e);return function(t,e,i){const n=new Aa(i);return Promise.resolve(n)}(0,0,t).then(t=>this.bootstrapModuleFactory(t,i))}_moduleDoBootstrap(t){const e=t.injector.get(Dl);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${vt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(Kt(hs))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function kl(t,e){return Array.isArray(e)?e.reduce(kl,t):Object.assign(Object.assign({},t),e)}let Dl=(()=>{class t{constructor(t,e,i,n,r,s){this._zone=t,this._console=e,this._injector=i,this._exceptionHandler=n,this._componentFactoryResolver=r,this._initStatus=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=un(),this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new b(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),a=new b(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{al.assertNotInAngularZone(),ol(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const i=this._zone.onUnstable.subscribe(()=>{al.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),i.unsubscribe()}});this.isStable=function(...t){let e=Number.POSITIVE_INFINITY,i=null,n=t[t.length-1];return k(n)?(i=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof n&&(e=t.pop()),null===i&&1===t.length&&t[0]instanceof b?t[0]:B(e)(H(t,i))}(o,a.pipe(t=>{return K()((e=Y,function(t){let i;i="function"==typeof e?e:function(){return e};const n=Object.create(t,W);return n.source=t,n.subjectFactory=i,n})(t));var e}))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let i;i=t instanceof Ro?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(i.componentType);const n=i.isBoundToModule?void 0:this._injector.get(Wt),r=i.create(hs.NULL,[],e||i.selector,n);r.onDestroy(()=>{this._unloadComponent(r)});const s=r.injector.get(ml,null);return s&&r.injector.get(fl).registerApplication(r.location.nativeElement,s),this._loadComponent(r),un()&&this._console.log("Angular is running in development mode. Call enableProdMode() to enable production mode."),r}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges();if(this._enforceNoNewChanges)for(let t of this._views)t.checkNoChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;Ml(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(za,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}_unloadComponent(t){this.detachView(t.hostView),Ml(this.components,t)}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy())}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(Kt(al),Kt(Qa),Kt(hs),Kt(an),Kt($o),Kt(Na))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function Ml(t,e){const i=t.indexOf(e);i>-1&&t.splice(i,1)}class Sl{}class Il{}const xl={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let Tl=(()=>{class t{constructor(t,e){this._compiler=t,this._config=e||xl}load(t){return this.loadAndCompile(t)}loadAndCompile(t){let[e,n]=t.split("#");return void 0===n&&(n="default"),i("crnd")(e).then(t=>t[n]).then(t=>_l(t,e,n)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,n]=t.split("#"),r="NgFactory";return void 0===n&&(n="default",r=""),i("crnd")(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[n+r]).then(t=>_l(t,e,n))}}return t.\u0275fac=function(e){return new(e||t)(Kt(rl),Kt(Il,8))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function _l(t,e,i){if(!t)throw new Error(`Cannot find '${i}' in '${e}'`);return t}const Ul=wl(null,"core",[{provide:qa,useValue:"unknown"},{provide:Pl,deps:[hs]},{provide:fl,deps:[]},{provide:Qa,deps:[]}]),El=[{provide:Dl,useClass:Dl,deps:[al,Qa,hs,an,$o,Na]},{provide:ba,deps:[al],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:Na,useClass:Na,deps:[[new et,$a]]},{provide:rl,useClass:rl,deps:[]},Ba,{provide:oa,useFactory:function(){return ca},deps:[]},{provide:aa,useFactory:function(){return da},deps:[]},{provide:Wa,useFactory:function(t){return Io(t=t||"undefined"!=typeof $localize&&$localize.locale||"en-US"),t},deps:[[new tt(Wa),new et,new nt]]},{provide:Ja,useValue:"USD"}];let Ol=(()=>{class t{constructor(t){}}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)(Kt(Dl))},providers:El}),t})(),Gl=null;function Ll(){return Gl}const Rl=new Ot("DocumentToken");let jl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({factory:$l,token:t,providedIn:"platform"}),t})();function $l(){return Kt(Fl)}const Nl=new Ot("Location Initialized");let Fl=(()=>{class t extends jl{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=Ll().getLocation(),this._history=Ll().getHistory()}getBaseHrefFromDOM(){return Ll().getBaseHref(this._doc)}onPopState(t){Ll().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}onHashChange(t){Ll().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,i){Bl()?this._history.pushState(t,e,i):this.location.hash=i}replaceState(t,e,i){Bl()?this._history.replaceState(t,e,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(Kt(Rl))},t.\u0275prov=at({factory:Hl,token:t,providedIn:"platform"}),t})();function Bl(){return!!window.history.pushState}function Hl(){return new Fl(Kt(Rl))}function Kl(t,e){if(0==t.length)return e;if(0==e.length)return t;let i=0;return t.endsWith("/")&&i++,e.startsWith("/")&&i++,2==i?t+e.substring(1):1==i?t+e:t+"/"+e}function ql(t){const e=t.match(/#|\?|$/),i=e&&e.index||t.length;return t.slice(0,i-("/"===t[i-1]?1:0))+t.slice(i)}function zl(t){return t&&"?"!==t[0]?"?"+t:t}let Ql=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({factory:Wl,token:t,providedIn:"root"}),t})();function Wl(t){const e=Kt(Rl).location;return new Yl(Kt(jl),e&&e.origin||"")}const Jl=new Ot("appBaseHref");let Yl=(()=>{class t extends Ql{constructor(t,e){if(super(),this._platformLocation=t,null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Kl(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+zl(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${e}${i}`:e}pushState(t,e,i,n){const r=this.prepareExternalUrl(i+zl(n));this._platformLocation.pushState(t,e,r)}replaceState(t,e,i,n){const r=this.prepareExternalUrl(i+zl(n));this._platformLocation.replaceState(t,e,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(Kt(jl),Kt(Jl,8))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Zl=(()=>{class t extends Ql{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",null!=e&&(this._baseHref=e)}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=Kl(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,i,n){let r=this.prepareExternalUrl(i+zl(n));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.pushState(t,e,r)}replaceState(t,e,i,n){let r=this.prepareExternalUrl(i+zl(n));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(Kt(jl),Kt(Jl,8))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Xl=(()=>{class t{constructor(t,e){this._subject=new Ra,this._urlChangeListeners=[],this._platformStrategy=t;const i=this._platformStrategy.getBaseHref();this._platformLocation=e,this._baseHref=ql(ec(i)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+zl(e))}normalize(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,ec(e)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e="",i=null){this._platformStrategy.pushState(i,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+zl(e)),i)}replaceState(t,e="",i=null){this._platformStrategy.replaceState(i,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+zl(e)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)}))}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(i=>i(t,e))}subscribe(t,e,i){return this._subject.subscribe({next:t,error:e,complete:i})}}return t.\u0275fac=function(e){return new(e||t)(Kt(Ql),Kt(jl))},t.normalizeQueryParams=zl,t.joinWithSlash=Kl,t.stripTrailingSlash=ql,t.\u0275prov=at({factory:tc,token:t,providedIn:"root"}),t})();function tc(){return new Xl(Kt(Ql),Kt(jl))}function ec(t){return t.replace(/\/index.html$/,"")}var ic=function(t){return t[t.Decimal=0]="Decimal",t[t.Percent=1]="Percent",t[t.Currency=2]="Currency",t[t.Scientific=3]="Scientific",t}({}),nc=function(t){return t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Two=2]="Two",t[t.Few=3]="Few",t[t.Many=4]="Many",t[t.Other=5]="Other",t}({}),rc=function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t}({}),sc=function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t}({}),oc=function(t){return t[t.Short=0]="Short",t[t.Medium=1]="Medium",t[t.Long=2]="Long",t[t.Full=3]="Full",t}({}),ac=function(t){return t[t.Decimal=0]="Decimal",t[t.Group=1]="Group",t[t.List=2]="List",t[t.PercentSign=3]="PercentSign",t[t.PlusSign=4]="PlusSign",t[t.MinusSign=5]="MinusSign",t[t.Exponential=6]="Exponential",t[t.SuperscriptingExponent=7]="SuperscriptingExponent",t[t.PerMille=8]="PerMille",t[t[1/0]=9]="Infinity",t[t.NaN=10]="NaN",t[t.TimeSeparator=11]="TimeSeparator",t[t.CurrencyDecimal=12]="CurrencyDecimal",t[t.CurrencyGroup=13]="CurrencyGroup",t}({});function lc(t,e){return pc(ko(t)[Mo.DateFormat],e)}function cc(t,e){return pc(ko(t)[Mo.TimeFormat],e)}function dc(t,e){return pc(ko(t)[Mo.DateTimeFormat],e)}function uc(t,e){const i=ko(t),n=i[Mo.NumberSymbols][e];if(void 0===n){if(e===ac.CurrencyDecimal)return i[Mo.NumberSymbols][ac.Decimal];if(e===ac.CurrencyGroup)return i[Mo.NumberSymbols][ac.Group]}return n}function hc(t){if(!t[Mo.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[Mo.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function pc(t,e){for(let i=e;i>-1;i--)if(void 0!==t[i])return t[i];throw new Error("Locale data API: locale data undefined")}function gc(t){const[e,i]=t.split(":");return{hours:+e,minutes:+i}}const mc=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,fc={},vc=/((?:[^GyMLwWdEabBhHmsSzZO']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var bc=function(t){return t[t.Short=0]="Short",t[t.ShortGMT=1]="ShortGMT",t[t.Long=2]="Long",t[t.Extended=3]="Extended",t}({}),yc=function(t){return t[t.FullYear=0]="FullYear",t[t.Month=1]="Month",t[t.Date=2]="Date",t[t.Hours=3]="Hours",t[t.Minutes=4]="Minutes",t[t.Seconds=5]="Seconds",t[t.FractionalSeconds=6]="FractionalSeconds",t[t.Day=7]="Day",t}({}),Cc=function(t){return t[t.DayPeriods=0]="DayPeriods",t[t.Days=1]="Days",t[t.Months=2]="Months",t[t.Eras=3]="Eras",t}({});function Vc(t,e){return e&&(t=t.replace(/\{([^}]+)}/g,(function(t,i){return null!=e&&i in e?e[i]:t}))),t}function wc(t,e,i="-",n,r){let s="";(t<0||r&&t<=0)&&(r?t=1-t:(t=-t,s=i));let o=String(t);for(;o.length<e;)o="0"+o;return n&&(o=o.substr(o.length-e)),s+o}function Ac(t,e,i=0,n=!1,r=!1){return function(s,o){let a=function(t,e){switch(t){case yc.FullYear:return e.getFullYear();case yc.Month:return e.getMonth();case yc.Date:return e.getDate();case yc.Hours:return e.getHours();case yc.Minutes:return e.getMinutes();case yc.Seconds:return e.getSeconds();case yc.FractionalSeconds:return e.getMilliseconds();case yc.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,s);if((i>0||a>-i)&&(a+=i),t===yc.Hours)0===a&&-12===i&&(a=12);else if(t===yc.FractionalSeconds)return l=e,wc(a,3).substr(0,l);var l;const c=uc(o,ac.MinusSign);return wc(a,e,c,n,r)}}function Pc(t,e,i=rc.Format,n=!1){return function(r,s){return function(t,e,i,n,r,s){switch(i){case Cc.Months:return function(t,e,i){const n=ko(t),r=pc([n[Mo.MonthsFormat],n[Mo.MonthsStandalone]],e);return pc(r,i)}(e,r,n)[t.getMonth()];case Cc.Days:return function(t,e,i){const n=ko(t),r=pc([n[Mo.DaysFormat],n[Mo.DaysStandalone]],e);return pc(r,i)}(e,r,n)[t.getDay()];case Cc.DayPeriods:const o=t.getHours(),a=t.getMinutes();if(s){const t=function(t){const e=ko(t);return hc(e),(e[Mo.ExtraData][2]||[]).map(t=>"string"==typeof t?gc(t):[gc(t[0]),gc(t[1])])}(e),i=function(t,e,i){const n=ko(t);hc(n);const r=pc([n[Mo.ExtraData][0],n[Mo.ExtraData][1]],e)||[];return pc(r,i)||[]}(e,r,n),s=t.findIndex(t=>{if(Array.isArray(t)){const[e,i]=t,n=o>=e.hours&&a>=e.minutes,r=o<i.hours||o===i.hours&&a<i.minutes;if(e.hours<i.hours){if(n&&r)return!0}else if(n||r)return!0}else if(t.hours===o&&t.minutes===a)return!0;return!1});if(-1!==s)return i[s]}return function(t,e,i){const n=ko(t),r=pc([n[Mo.DayPeriodsFormat],n[Mo.DayPeriodsStandalone]],e);return pc(r,i)}(e,r,n)[o<12?0:1];case Cc.Eras:return function(t,e){return pc(ko(t)[Mo.Eras],e)}(e,n)[t.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type "+i)}}(r,s,t,e,i,n)}}function kc(t){return function(e,i,n){const r=-1*n,s=uc(i,ac.MinusSign),o=r>0?Math.floor(r/60):Math.ceil(r/60);switch(t){case bc.Short:return(r>=0?"+":"")+wc(o,2,s)+wc(Math.abs(r%60),2,s);case bc.ShortGMT:return"GMT"+(r>=0?"+":"")+wc(o,1,s);case bc.Long:return"GMT"+(r>=0?"+":"")+wc(o,2,s)+":"+wc(Math.abs(r%60),2,s);case bc.Extended:return 0===n?"Z":(r>=0?"+":"")+wc(o,2,s)+":"+wc(Math.abs(r%60),2,s);default:throw new Error(`Unknown zone width "${t}"`)}}}function Dc(t,e=!1){return function(i,n){let r;if(e){const t=new Date(i.getFullYear(),i.getMonth(),1).getDay()-1,e=i.getDate();r=1+Math.floor((e+t)/7)}else{const t=(s=i,new Date(s.getFullYear(),s.getMonth(),s.getDate()+(4-s.getDay()))),e=function(t){const e=new Date(t,0,1).getDay();return new Date(t,0,1+(e<=4?4:11)-e)}(t.getFullYear()),n=t.getTime()-e.getTime();r=1+Math.round(n/6048e5)}var s;return wc(r,t,uc(n,ac.MinusSign))}}const Mc={};function Sc(t,e){t=t.replace(/:/g,"");const i=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(i)?e:i}function Ic(t){return t instanceof Date&&!isNaN(t.valueOf())}const xc=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function Tc(t){const e=parseInt(t);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+t);return e}class _c{}let Uc=(()=>{class t extends _c{constructor(t){super(),this.locale=t}getPluralCategory(t,e){switch(function(t){return ko(t)[Mo.PluralCase]}(e||this.locale)(t)){case nc.Zero:return"zero";case nc.One:return"one";case nc.Two:return"two";case nc.Few:return"few";case nc.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(Kt(Wa))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function Ec(t,e){e=encodeURIComponent(e);for(const i of t.split(";")){const t=i.indexOf("="),[n,r]=-1==t?[i,""]:[i.slice(0,t),i.slice(t+1)];if(n.trim()===e)return decodeURIComponent(r)}return null}let Oc=(()=>{class t{constructor(t,e,i,n){this._iterableDiffers=t,this._keyValueDiffers=e,this._ngEl=i,this._renderer=n,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(Ps(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachChangedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachRemovedItem(t=>{t.previousValue&&this._toggleClass(t.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(t=>{if("string"!=typeof t.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got "+vt(t.item));this._toggleClass(t.item,!0)}),t.forEachRemovedItem(t=>this._toggleClass(t.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!0)):Object.keys(t).forEach(e=>this._toggleClass(e,!!t[e])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!1)):Object.keys(t).forEach(t=>this._toggleClass(t,!1)))}_toggleClass(t,e){(t=t.trim())&&t.split(/\s+/g).forEach(t=>{e?this._renderer.addClass(this._ngEl.nativeElement,t):this._renderer.removeClass(this._ngEl.nativeElement,t)})}}return t.\u0275fac=function(e){return new(e||t)(Rs(oa),Rs(aa),Rs(No),Rs(Ko))},t.\u0275dir=ge({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),t})();class Gc{constructor(t,e,i,n){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=n}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Lc=(()=>{class t{constructor(t,e,i){this._viewContainer=t,this._template=e,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){un()&&null!=t&&"function"!=typeof t&&console&&console.warn&&console.warn(`trackBy must be a function, but received ${JSON.stringify(t)}. See https://angular.io/api/common/NgForOf#change-propagation for more information.`),this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const i=this._ngForOf;if(!this._differ&&i)try{this._differ=this._differs.find(i).create(this.ngForTrackBy)}catch(e){throw new Error(`Cannot find a differ supporting object '${i}' of type '${t=i,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,i,n)=>{if(null==t.previousIndex){const i=this._viewContainer.createEmbeddedView(this._template,new Gc(null,this._ngForOf,-1,-1),null===n?void 0:n),r=new Rc(t,i);e.push(r)}else if(null==n)this._viewContainer.remove(null===i?void 0:i);else if(null!==i){const r=this._viewContainer.get(i);this._viewContainer.move(r,n);const s=new Rc(t,r);e.push(s)}});for(let i=0;i<e.length;i++)this._perViewChange(e[i].view,e[i].record);for(let i=0,n=this._viewContainer.length;i<n;i++){const t=this._viewContainer.get(i);t.context.index=i,t.context.count=n,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(Rs(pa),Rs(ua),Rs(oa))},t.\u0275dir=ge({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class Rc{constructor(t,e){this.record=t,this.view=e}}let jc=(()=>{class t{constructor(t,e){this._viewContainer=t,this._context=new $c,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Nc("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Nc("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(Rs(pa),Rs(ua))},t.\u0275dir=ge({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class $c{constructor(){this.$implicit=null,this.ngIf=null}}function Nc(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${vt(e)}'.`)}let Fc=(()=>{class t{constructor(t,e,i){this._ngEl=t,this._differs=e,this._renderer=i,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,e){const[i,n]=t.split(".");null!=(e=null!=e&&n?`${e}${n}`:e)?this._renderer.setStyle(this._ngEl.nativeElement,i,e):this._renderer.removeStyle(this._ngEl.nativeElement,i)}_applyChanges(t){t.forEachRemovedItem(t=>this._setStyle(t.key,null)),t.forEachAddedItem(t=>this._setStyle(t.key,t.currentValue)),t.forEachChangedItem(t=>this._setStyle(t.key,t.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(Rs(No),Rs(aa),Rs(Ko))},t.\u0275dir=ge({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),t})(),Bc=(()=>{class t{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(t){if(this._shouldRecreateView(t)){const t=this._viewContainerRef;this._viewRef&&t.remove(t.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?t.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&this.ngTemplateOutletContext&&this._updateExistingContext(this.ngTemplateOutletContext)}_shouldRecreateView(t){const e=t.ngTemplateOutletContext;return!!t.ngTemplateOutlet||e&&this._hasContextShapeChanged(e)}_hasContextShapeChanged(t){const e=Object.keys(t.previousValue||{}),i=Object.keys(t.currentValue||{});if(e.length===i.length){for(let t of i)if(-1===e.indexOf(t))return!0;return!1}return!0}_updateExistingContext(t){for(let e of Object.keys(t))this._viewRef.context[e]=this.ngTemplateOutletContext[e]}}return t.\u0275fac=function(e){return new(e||t)(Rs(pa))},t.\u0275dir=ge({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[_e]}),t})();function Hc(t,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${vt(t)}'`)}let Kc=(()=>{class t{transform(e){if(!e)return e;if("string"!=typeof e)throw Hc(t,e);return e.toUpperCase()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=me({name:"uppercase",type:t,pure:!0}),t})(),qc=(()=>{class t{constructor(t){this.locale=t}transform(e,i="mediumDate",n,r){if(null==e||""===e||e!=e)return null;try{return function(t,e,i,n){let r=function(t){if(Ic(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){t=t.trim();const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);if(/^(\d{4}-\d{1,2}-\d{1,2})$/.test(t)){const[e,i,n]=t.split("-").map(t=>+t);return new Date(e,i-1,n)}let i;if(i=t.match(mc))return function(t){const e=new Date(0);let i=0,n=0;const r=t[8]?e.setUTCFullYear:e.setFullYear,s=t[8]?e.setUTCHours:e.setHours;t[9]&&(i=Number(t[9]+t[10]),n=Number(t[9]+t[11])),r.call(e,Number(t[1]),Number(t[2])-1,Number(t[3]));const o=Number(t[4]||0)-i,a=Number(t[5]||0)-n,l=Number(t[6]||0),c=Math.round(1e3*parseFloat("0."+(t[7]||0)));return s.call(e,o,a,l,c),e}(i)}const e=new Date(t);if(!Ic(e))throw new Error(`Unable to convert "${t}" into a date`);return e}(t);e=function t(e,i){const n=function(t){return ko(t)[Mo.LocaleId]}(e);if(fc[n]=fc[n]||{},fc[n][i])return fc[n][i];let r="";switch(i){case"shortDate":r=lc(e,oc.Short);break;case"mediumDate":r=lc(e,oc.Medium);break;case"longDate":r=lc(e,oc.Long);break;case"fullDate":r=lc(e,oc.Full);break;case"shortTime":r=cc(e,oc.Short);break;case"mediumTime":r=cc(e,oc.Medium);break;case"longTime":r=cc(e,oc.Long);break;case"fullTime":r=cc(e,oc.Full);break;case"short":const i=t(e,"shortTime"),n=t(e,"shortDate");r=Vc(dc(e,oc.Short),[i,n]);break;case"medium":const s=t(e,"mediumTime"),o=t(e,"mediumDate");r=Vc(dc(e,oc.Medium),[s,o]);break;case"long":const a=t(e,"longTime"),l=t(e,"longDate");r=Vc(dc(e,oc.Long),[a,l]);break;case"full":const c=t(e,"fullTime"),d=t(e,"fullDate");r=Vc(dc(e,oc.Full),[c,d])}return r&&(fc[n][i]=r),r}(i,e)||e;let s,o=[];for(;e;){if(s=vc.exec(e),!s){o.push(e);break}{o=o.concat(s.slice(1));const t=o.pop();if(!t)break;e=t}}let a=r.getTimezoneOffset();n&&(a=Sc(n,a),r=function(t,e,i){const n=t.getTimezoneOffset();return function(t,e){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+e),t}(t,-1*(Sc(e,n)-n))}(r,n));let l="";return o.forEach(t=>{const e=function(t){if(Mc[t])return Mc[t];let e;switch(t){case"G":case"GG":case"GGG":e=Pc(Cc.Eras,sc.Abbreviated);break;case"GGGG":e=Pc(Cc.Eras,sc.Wide);break;case"GGGGG":e=Pc(Cc.Eras,sc.Narrow);break;case"y":e=Ac(yc.FullYear,1,0,!1,!0);break;case"yy":e=Ac(yc.FullYear,2,0,!0,!0);break;case"yyy":e=Ac(yc.FullYear,3,0,!1,!0);break;case"yyyy":e=Ac(yc.FullYear,4,0,!1,!0);break;case"M":case"L":e=Ac(yc.Month,1,1);break;case"MM":case"LL":e=Ac(yc.Month,2,1);break;case"MMM":e=Pc(Cc.Months,sc.Abbreviated);break;case"MMMM":e=Pc(Cc.Months,sc.Wide);break;case"MMMMM":e=Pc(Cc.Months,sc.Narrow);break;case"LLL":e=Pc(Cc.Months,sc.Abbreviated,rc.Standalone);break;case"LLLL":e=Pc(Cc.Months,sc.Wide,rc.Standalone);break;case"LLLLL":e=Pc(Cc.Months,sc.Narrow,rc.Standalone);break;case"w":e=Dc(1);break;case"ww":e=Dc(2);break;case"W":e=Dc(1,!0);break;case"d":e=Ac(yc.Date,1);break;case"dd":e=Ac(yc.Date,2);break;case"E":case"EE":case"EEE":e=Pc(Cc.Days,sc.Abbreviated);break;case"EEEE":e=Pc(Cc.Days,sc.Wide);break;case"EEEEE":e=Pc(Cc.Days,sc.Narrow);break;case"EEEEEE":e=Pc(Cc.Days,sc.Short);break;case"a":case"aa":case"aaa":e=Pc(Cc.DayPeriods,sc.Abbreviated);break;case"aaaa":e=Pc(Cc.DayPeriods,sc.Wide);break;case"aaaaa":e=Pc(Cc.DayPeriods,sc.Narrow);break;case"b":case"bb":case"bbb":e=Pc(Cc.DayPeriods,sc.Abbreviated,rc.Standalone,!0);break;case"bbbb":e=Pc(Cc.DayPeriods,sc.Wide,rc.Standalone,!0);break;case"bbbbb":e=Pc(Cc.DayPeriods,sc.Narrow,rc.Standalone,!0);break;case"B":case"BB":case"BBB":e=Pc(Cc.DayPeriods,sc.Abbreviated,rc.Format,!0);break;case"BBBB":e=Pc(Cc.DayPeriods,sc.Wide,rc.Format,!0);break;case"BBBBB":e=Pc(Cc.DayPeriods,sc.Narrow,rc.Format,!0);break;case"h":e=Ac(yc.Hours,1,-12);break;case"hh":e=Ac(yc.Hours,2,-12);break;case"H":e=Ac(yc.Hours,1);break;case"HH":e=Ac(yc.Hours,2);break;case"m":e=Ac(yc.Minutes,1);break;case"mm":e=Ac(yc.Minutes,2);break;case"s":e=Ac(yc.Seconds,1);break;case"ss":e=Ac(yc.Seconds,2);break;case"S":e=Ac(yc.FractionalSeconds,1);break;case"SS":e=Ac(yc.FractionalSeconds,2);break;case"SSS":e=Ac(yc.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=kc(bc.Short);break;case"ZZZZZ":e=kc(bc.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=kc(bc.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=kc(bc.Long);break;default:return null}return Mc[t]=e,e}(t);l+=e?e(r,i,a):"''"===t?"'":t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}(e,i,r||this.locale,n)}catch(s){throw Hc(t,s.message)}}}return t.\u0275fac=function(e){return new(e||t)(Rs(Wa))},t.\u0275pipe=me({name:"date",type:t,pure:!0}),t})(),zc=(()=>{class t{constructor(t){this._locale=t}transform(e,i,n){if(function(t){return null==t||""===t||t!=t}(e))return null;n=n||this._locale;try{return function(t,e,i){return function(t,e,i,n,r,s,o=!1){let a="",l=!1;if(isFinite(t)){let c=function(t){let e,i,n,r,s,o=Math.abs(t)+"",a=0;for((i=o.indexOf("."))>-1&&(o=o.replace(".","")),(n=o.search(/e/i))>0?(i<0&&(i=n),i+=+o.slice(n+1),o=o.substring(0,n)):i<0&&(i=o.length),n=0;"0"===o.charAt(n);n++);if(n===(s=o.length))e=[0],i=1;else{for(s--;"0"===o.charAt(s);)s--;for(i-=n,e=[],r=0;n<=s;n++,r++)e[r]=Number(o.charAt(n))}return i>22&&(e=e.splice(0,21),a=i-1,i=1),{digits:e,exponent:a,integerLen:i}}(t);o&&(c=function(t){if(0===t.digits[0])return t;const e=t.digits.length-t.integerLen;return t.exponent?t.exponent+=2:(0===e?t.digits.push(0,0):1===e&&t.digits.push(0),t.integerLen+=2),t}(c));let d=e.minInt,u=e.minFrac,h=e.maxFrac;if(s){const t=s.match(xc);if(null===t)throw new Error(s+" is not a valid digit info");const e=t[1],i=t[3],n=t[5];null!=e&&(d=Tc(e)),null!=i&&(u=Tc(i)),null!=n?h=Tc(n):null!=i&&u>h&&(h=u)}!function(t,e,i){if(e>i)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${i}).`);let n=t.digits,r=n.length-t.integerLen;const s=Math.min(Math.max(e,r),i);let o=s+t.integerLen,a=n[o];if(o>0){n.splice(Math.max(t.integerLen,o));for(let t=o;t<n.length;t++)n[t]=0}else{r=Math.max(0,r),t.integerLen=1,n.length=Math.max(1,o=s+1),n[0]=0;for(let t=1;t<o;t++)n[t]=0}if(a>=5)if(o-1<0){for(let e=0;e>o;e--)n.unshift(0),t.integerLen++;n.unshift(1),t.integerLen++}else n[o-1]++;for(;r<Math.max(0,s);r++)n.push(0);let l=0!==s;const c=e+t.integerLen,d=n.reduceRight((function(t,e,i,n){return n[i]=(e+=t)<10?e:e-10,l&&(0===n[i]&&i>=c?n.pop():l=!1),e>=10?1:0}),0);d&&(n.unshift(d),t.integerLen++)}(c,u,h);let p=c.digits,g=c.integerLen;const m=c.exponent;let f=[];for(l=p.every(t=>!t);g<d;g++)p.unshift(0);for(;g<0;g++)p.unshift(0);g>0?f=p.splice(g,p.length):(f=p,p=[0]);const v=[];for(p.length>=e.lgSize&&v.unshift(p.splice(-e.lgSize,p.length).join(""));p.length>e.gSize;)v.unshift(p.splice(-e.gSize,p.length).join(""));p.length&&v.unshift(p.join("")),a=v.join(uc(i,n)),f.length&&(a+=uc(i,r)+f.join("")),m&&(a+=uc(i,ac.Exponential)+"+"+m)}else a=uc(i,ac.Infinity);return a=t<0&&!l?e.negPre+a+e.negSuf:e.posPre+a+e.posSuf,a}(t,function(t,e="-"){const i={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},n=t.split(";"),r=n[0],s=n[1],o=-1!==r.indexOf(".")?r.split("."):[r.substring(0,r.lastIndexOf("0")+1),r.substring(r.lastIndexOf("0")+1)],a=o[0],l=o[1]||"";i.posPre=a.substr(0,a.indexOf("#"));for(let d=0;d<l.length;d++){const t=l.charAt(d);"0"===t?i.minFrac=i.maxFrac=d+1:"#"===t?i.maxFrac=d+1:i.posSuf+=t}const c=a.split(",");if(i.gSize=c[1]?c[1].length:0,i.lgSize=c[2]||c[1]?(c[2]||c[1]).length:0,s){const t=r.length-i.posPre.length-i.posSuf.length,e=s.indexOf("#");i.negPre=s.substr(0,e).replace(/'/g,""),i.negSuf=s.substr(e+t).replace(/'/g,"")}else i.negPre=e+i.posPre,i.negSuf=i.posSuf;return i}(function(t,e){return ko(t)[Mo.NumberFormats][e]}(e,ic.Decimal),uc(e,ac.MinusSign)),e,ac.Group,ac.Decimal,i)}(function(t){if("string"==typeof t&&!isNaN(Number(t)-parseFloat(t)))return Number(t);if("number"!=typeof t)throw new Error(t+" is not a number");return t}(e),n,i)}catch(r){throw Hc(t,r.message)}}}return t.\u0275fac=function(e){return new(e||t)(Rs(Wa))},t.\u0275pipe=me({name:"number",type:t,pure:!0}),t})(),Qc=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[{provide:_c,useClass:Uc}]}),t})(),Wc=(()=>{class t{}return t.\u0275prov=at({token:t,providedIn:"root",factory:()=>new Jc(Kt(Rl),window,Kt(an))}),t})();class Jc{constructor(t,e,i){this.document=t,this.window=e,this.errorHandler=i,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.scrollX,this.window.scrollY]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(this.supportsScrolling()){const e=this.document.getElementById(t)||this.document.getElementsByName(t)[0];e&&this.scrollToElement(e)}}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),i=e.left+this.window.pageXOffset,n=e.top+this.window.pageYOffset,r=this.offset();this.window.scrollTo(i-r[0],n-r[1])}supportScrollRestoration(){try{if(!this.window||!this.window.scrollTo)return!1;const t=Yc(this.window.history)||Yc(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window.scrollTo}catch(t){return!1}}}function Yc(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class Zc extends class extends class{}{constructor(){super()}supportsDOMEvents(){return!0}}{static makeCurrent(){var t;t=new Zc,Gl||(Gl=t)}getProperty(t,e){return t[e]}log(t){window.console&&window.console.log&&window.console.log(t)}logGroup(t){window.console&&window.console.group&&window.console.group(t)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(t,e,i){return t.addEventListener(e,i,!1),()=>{t.removeEventListener(e,i,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){return t.parentNode&&t.parentNode.removeChild(t),t}getValue(t){return t.value}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(t){const e=td||(td=document.querySelector("base"),td)?td.getAttribute("href"):null;return null==e?null:(i=e,Xc||(Xc=document.createElement("a")),Xc.setAttribute("href",i),"/"===Xc.pathname.charAt(0)?Xc.pathname:"/"+Xc.pathname);var i}resetBaseElement(){td=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(t){return Ec(document.cookie,t)}}let Xc,td=null;const ed=new Ot("TRANSITION_ID"),id=[{provide:$a,useFactory:function(t,e,i){return()=>{i.get(Na).donePromise.then(()=>{const i=Ll();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter(e=>e.getAttribute("ng-transition")===t).forEach(t=>i.remove(t))})}},deps:[ed,Rl,hs],multi:!0}];class nd{static init(){var t;t=new nd,yl=t}addToWindow(t){Mt.getAngularTestability=(e,i=!0)=>{const n=t.findTestabilityInTree(e,i);if(null==n)throw new Error("Could not find testability for element.");return n},Mt.getAllAngularTestabilities=()=>t.getAllTestabilities(),Mt.getAllAngularRootElements=()=>t.getAllRootElements(),Mt.frameworkStabilizers||(Mt.frameworkStabilizers=[]),Mt.frameworkStabilizers.push(t=>{const e=Mt.getAllAngularTestabilities();let i=e.length,n=!1;const r=function(e){n=n||e,i--,0==i&&t(n)};e.forEach((function(t){t.whenStable(r)}))})}findTestabilityInTree(t,e,i){if(null==e)return null;const n=t.getTestability(e);return null!=n?n:i?Ll().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}const rd=new Ot("EventManagerPlugins");let sd=(()=>{class t{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,i){return this._findPluginFor(e).addEventListener(t,e,i)}addGlobalEventListener(t,e,i){return this._findPluginFor(e).addGlobalEventListener(t,e,i)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const i=this._plugins;for(let n=0;n<i.length;n++){const e=i[n];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error("No event manager plugin found for event "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(rd),Kt(al))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class od{constructor(t){this._doc=t}addGlobalEventListener(t,e,i){const n=Ll().getGlobalEventTarget(this._doc,t);if(!n)throw new Error(`Unsupported event target ${n} for event ${e}`);return this.addEventListener(n,e,i)}}let ad=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),ld=(()=>{class t extends ad{constructor(t){super(),this._doc=t,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(t.head)}_addStylesToHost(t,e){t.forEach(t=>{const i=this._doc.createElement("style");i.textContent=t,this._styleNodes.add(e.appendChild(i))})}addHost(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}removeHost(t){this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach(e=>this._addStylesToHost(t,e))}ngOnDestroy(){this._styleNodes.forEach(t=>Ll().remove(t))}}return t.\u0275fac=function(e){return new(e||t)(Kt(Rl))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const cd={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},dd=/%COMP%/g;function ud(t,e,i){for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)?ud(t,r,i):(r=r.replace(dd,t),i.push(r))}return i}function hd(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let pd=(()=>{class t{constructor(t,e,i){this.eventManager=t,this.sharedStylesHost=e,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new gd(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case re.Emulated:{let i=this.rendererByCompId.get(e.id);return i||(i=new md(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,i)),i.applyToHost(t),i}case re.Native:case re.ShadowDom:return new fd(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=ud(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(Kt(sd),Kt(ld),Kt(Fa))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class gd{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(cd[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,i){t&&t.insertBefore(e,i)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error(`The selector "${t}" did not match any elements`);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,n){if(n){e=n+":"+e;const r=cd[n];r?t.setAttributeNS(r,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){const n=cd[i];n?t.removeAttributeNS(n,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,n){n&Ho.DashCase?t.style.setProperty(e,i,n&Ho.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&Ho.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t[e]=i}setValue(t,e){t.nodeValue=e}listen(t,e,i){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,hd(i)):this.eventManager.addEventListener(t,e,hd(i))}}class md extends gd{constructor(t,e,i,n){super(t),this.component=i;const r=ud(n+"-"+i.id,i.styles,[]);e.addStyles(r),this.contentAttr="_ngcontent-%COMP%".replace(dd,n+"-"+i.id),this.hostAttr="_nghost-%COMP%".replace(dd,n+"-"+i.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}}class fd extends gd{constructor(t,e,i,n){super(t),this.sharedStylesHost=e,this.hostEl=i,this.component=n,this.shadowRoot=n.encapsulation===re.ShadowDom?i.attachShadow({mode:"open"}):i.createShadowRoot(),this.sharedStylesHost.addHost(this.shadowRoot);const r=ud(n.id,n.styles,[]);for(let s=0;s<r.length;s++){const t=document.createElement("style");t.textContent=r[s],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let vd=(()=>{class t extends od{constructor(t){super(t)}supports(t){return!0}addEventListener(t,e,i){return t.addEventListener(e,i,!1),()=>this.removeEventListener(t,e,i)}removeEventListener(t,e,i){return t.removeEventListener(e,i)}}return t.\u0275fac=function(e){return new(e||t)(Kt(Rl))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const bd=["alt","control","meta","shift"],yd={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Cd={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Vd={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let wd=(()=>{class t extends od{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,i,n){const r=t.parseEventName(i),s=t.eventCallback(r.fullKey,n,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ll().onAndCancel(e,r.domEventName,s))}static parseEventName(e){const i=e.toLowerCase().split("."),n=i.shift();if(0===i.length||"keydown"!==n&&"keyup"!==n)return null;const r=t._normalizeKey(i.pop());let s="";if(bd.forEach(t=>{const e=i.indexOf(t);e>-1&&(i.splice(e,1),s+=t+".")}),s+=r,0!=i.length||0===r.length)return null;const o={};return o.domEventName=n,o.fullKey=s,o}static getEventFullKey(t){let e="",i=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&Cd.hasOwnProperty(e)&&(e=Cd[e]))}return yd[e]||e}(t);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),bd.forEach(n=>{n!=i&&(0,Vd[n])(t)&&(e+=n+".")}),e+=i,e}static eventCallback(e,i,n){return r=>{t.getEventFullKey(r)===e&&n.runGuarded(()=>i(r))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return t.\u0275fac=function(e){return new(e||t)(Kt(Rl))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Ad=wl(Ul,"browser",[{provide:qa,useValue:"browser"},{provide:Ka,useValue:function(){Zc.makeCurrent(),nd.init()},multi:!0},{provide:Rl,useFactory:function(){return function(t){Le=t}(document),document},deps:[]}]),Pd=[[],{provide:Zr,useValue:"root"},{provide:an,useFactory:function(){return new an},deps:[]},{provide:rd,useClass:vd,multi:!0,deps:[Rl,al,qa]},{provide:rd,useClass:wd,multi:!0,deps:[Rl]},[],{provide:pd,useClass:pd,deps:[sd,ld,Fa]},{provide:Bo,useExisting:pd},{provide:ad,useExisting:ld},{provide:ld,useClass:ld,deps:[Rl]},{provide:ml,useClass:ml,deps:[al]},{provide:sd,useClass:sd,deps:[rd,al]},[]];let kd=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:Fa,useValue:e.appId},{provide:ed,useExisting:Fa},id]}}}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)(Kt(t,12))},providers:Pd,imports:[Qc,Ol]}),t})();function Dd(){return new Md(Kt(Rl))}let Md=(()=>{class t{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return t.\u0275fac=function(e){return new(e||t)(Kt(Rl))},t.\u0275prov=at({factory:Dd,token:t,providedIn:"root"}),t})();function Sd(...t){if(1===t.length){const e=t[0];if(l(e))return Id(e,null);if(c(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return Id(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return Id(t=1===t.length&&l(t[0])?t[0]:t,null).pipe(D(t=>e(...t)))}return Id(t,null)}function Id(t,e){return new b(i=>{const n=t.length;if(0===n)return void i.complete();const r=new Array(n);let s=0,o=0;for(let a=0;a<n;a++){const l=G(t[a]);let c=!1;i.add(l.subscribe({next:t=>{c||(c=!0,o++),r[a]=t},error:t=>i.error(t),complete:()=>{s++,s!==n&&c||(o===n&&i.next(e?e.reduce((t,e,i)=>(t[e]=r[i],t),{}):r),i.complete())}}))}})}"undefined"!=typeof window&&window;const xd=new Ot("NgValueAccessor"),Td={provide:xd,useExisting:Ct(()=>_d),multi:!0};let _d=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"checked",t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Ko),Rs(No))},t.\u0275dir=ge({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,e){1&t&&Js("change",(function(t){return e.onChange(t.target.checked)}))("blur",(function(){return e.onTouched()}))},features:[Lo([Td])]}),t})();const Ud={provide:xd,useExisting:Ct(()=>Od),multi:!0},Ed=new Ot("CompositionEventMode");let Od=(()=>{class t{constructor(t,e,i){this._renderer=t,this._elementRef=e,this._compositionMode=i,this.onChange=t=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const t=Ll()?Ll().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Ko),Rs(No),Rs(Ed,8))},t.\u0275dir=ge({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,e){1&t&&Js("input",(function(t){return e._handleInput(t.target.value)}))("blur",(function(){return e.onTouched()}))("compositionstart",(function(){return e._compositionStart()}))("compositionend",(function(t){return e._compositionEnd(t.target.value)}))},features:[Lo([Ud])]}),t})(),Gd=(()=>{class t{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=ge({type:t}),t})(),Ld=(()=>{class t extends Gd{get formDirective(){return null}get path(){return null}}return t.\u0275fac=function(e){return Rd(e||t)},t.\u0275dir=ge({type:t,features:[fs]}),t})();const Rd=nn(Ld);class jd extends Gd{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null,this._rawValidators=[],this._rawAsyncValidators=[]}get validator(){}get asyncValidator(){}}class $d{constructor(t){this._cd=t}get ngClassUntouched(){return!!this._cd.control&&this._cd.control.untouched}get ngClassTouched(){return!!this._cd.control&&this._cd.control.touched}get ngClassPristine(){return!!this._cd.control&&this._cd.control.pristine}get ngClassDirty(){return!!this._cd.control&&this._cd.control.dirty}get ngClassValid(){return!!this._cd.control&&this._cd.control.valid}get ngClassInvalid(){return!!this._cd.control&&this._cd.control.invalid}get ngClassPending(){return!!this._cd.control&&this._cd.control.pending}}let Nd=(()=>{class t extends $d{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(jd,2))},t.\u0275dir=ge({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,e){2&t&&lo("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[fs]}),t})(),Fd=(()=>{class t extends $d{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Ld,2))},t.\u0275dir=ge({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(t,e){2&t&&lo("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[fs]}),t})();function Bd(t){return null==t||0===t.length}function Hd(t){return null!=t&&"number"==typeof t.length}const Kd=new Ot("NgValidators"),qd=new Ot("NgAsyncValidators"),zd=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Qd{static min(t){return e=>{if(Bd(e.value)||Bd(t))return null;const i=parseFloat(e.value);return!isNaN(i)&&i<t?{min:{min:t,actual:e.value}}:null}}static max(t){return e=>{if(Bd(e.value)||Bd(t))return null;const i=parseFloat(e.value);return!isNaN(i)&&i>t?{max:{max:t,actual:e.value}}:null}}static required(t){return Bd(t.value)?{required:!0}:null}static requiredTrue(t){return!0===t.value?null:{required:!0}}static email(t){return Bd(t.value)||zd.test(t.value)?null:{email:!0}}static minLength(t){return e=>Bd(e.value)||!Hd(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}static maxLength(t){return e=>Hd(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}static pattern(t){if(!t)return Qd.nullValidator;let e,i;return"string"==typeof t?(i="","^"!==t.charAt(0)&&(i+="^"),i+=t,"$"!==t.charAt(t.length-1)&&(i+="$"),e=new RegExp(i)):(i=t.toString(),e=t),t=>{if(Bd(t.value))return null;const n=t.value;return e.test(n)?null:{pattern:{requiredPattern:i,actualValue:n}}}}static nullValidator(t){return null}static compose(t){if(!t)return null;const e=t.filter(Wd);return 0==e.length?null:function(t){return Yd(Zd(t,e))}}static composeAsync(t){if(!t)return null;const e=t.filter(Wd);return 0==e.length?null:function(t){return Sd(Zd(t,e).map(Jd)).pipe(D(Yd))}}}function Wd(t){return null!=t}function Jd(t){const e=Qs(t)?G(t):t;return Ws(e),e}function Yd(t){let e={};return t.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function Zd(t,e){return e.map(e=>e(t))}function Xd(t){return t.map(t=>function(t){return!t.validate}(t)?t:e=>t.validate(e))}const tu={provide:xd,useExisting:Ct(()=>eu),multi:!0};let eu=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Ko),Rs(No))},t.\u0275dir=ge({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,e){1&t&&Js("input",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},features:[Lo([tu])]}),t})();const iu={provide:xd,useExisting:Ct(()=>ru),multi:!0};let nu=(()=>{class t{constructor(){this._accessors=[]}add(t,e){this._accessors.push([t,e])}remove(t){for(let e=this._accessors.length-1;e>=0;--e)if(this._accessors[e][1]===t)return void this._accessors.splice(e,1)}select(t){this._accessors.forEach(e=>{this._isSameGroup(e,t)&&e[1]!==t&&e[1].fireUncheck(t.value)})}_isSameGroup(t,e){return!!t[0].control&&t[0]._parent===e._control._parent&&t[1].name===e.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),ru=(()=>{class t{constructor(t,e,i,n){this._renderer=t,this._elementRef=e,this._registry=i,this._injector=n,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this._control=this._injector.get(jd),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}fireUncheck(t){this.writeValue(t)}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Ko),Rs(No),Rs(nu),Rs(hs))},t.\u0275dir=ge({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(t,e){1&t&&Js("change",(function(){return e.onChange()}))("blur",(function(){return e.onTouched()}))},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Lo([iu])]}),t})();const su={provide:xd,useExisting:Ct(()=>ou),multi:!0};let ou=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(t))}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Ko),Rs(No))},t.\u0275dir=ge({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,e){1&t&&Js("change",(function(t){return e.onChange(t.target.value)}))("input",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},features:[Lo([su])]}),t})();const au={provide:xd,useExisting:Ct(()=>cu),multi:!0};function lu(t,e){return null==t?""+e:(e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}let cu=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const e=this._getOptionId(t);null==e&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const i=lu(e,t);this._renderer.setProperty(this._elementRef.nativeElement,"value",i)}registerOnChange(t){this.onChange=e=>{this.value=this._getOptionValue(e),t(this.value)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e),t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e):t}}return t.\u0275fac=function(e){return new(e||t)(Rs(Ko),Rs(No))},t.\u0275dir=ge({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,e){1&t&&Js("change",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},inputs:{compareWith:"compareWith"},features:[Lo([au])]}),t})(),du=(()=>{class t{constructor(t,e,i){this._element=t,this._renderer=e,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(lu(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(Rs(No),Rs(Ko),Rs(cu,9))},t.\u0275dir=ge({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const uu={provide:xd,useExisting:Ct(()=>pu),multi:!0};function hu(t,e){return null==t?""+e:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}let pu=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let e;if(this.value=t,Array.isArray(t)){const i=t.map(t=>this._getOptionId(t));e=(t,e)=>{t._setSelected(i.indexOf(e.toString())>-1)}}else e=(t,e)=>{t._setSelected(!1)};this._optionMap.forEach(e)}registerOnChange(t){this.onChange=e=>{const i=[];if(void 0!==e.selectedOptions){const t=e.selectedOptions;for(let e=0;e<t.length;e++){const n=t.item(e),r=this._getOptionValue(n.value);i.push(r)}}else{const t=e.options;for(let e=0;e<t.length;e++){const n=t.item(e);if(n.selected){const t=this._getOptionValue(n.value);i.push(t)}}}this.value=i,t(i)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(t){const e=(this._idCounter++).toString();return this._optionMap.set(e,t),e}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e)._value,t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e)._value:t}}return t.\u0275fac=function(e){return new(e||t)(Rs(Ko),Rs(No))},t.\u0275dir=ge({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,e){1&t&&Js("change",(function(t){return e.onChange(t.target)}))("blur",(function(){return e.onTouched()}))},inputs:{compareWith:"compareWith"},features:[Lo([uu])]}),t})(),gu=(()=>{class t{constructor(t,e,i){this._element=t,this._renderer=e,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(hu(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(hu(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(Rs(No),Rs(Ko),Rs(pu,9))},t.\u0275dir=ge({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();function mu(t,e){t.validator=Qd.compose([t.validator,e.validator]),t.asyncValidator=Qd.composeAsync([t.asyncValidator,e.asyncValidator]),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(i=>{t._pendingValue=i,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&fu(t,e)})}(t,e),function(t,e){t.registerOnChange((t,i)=>{e.valueAccessor.writeValue(t),i&&e.viewToModelUpdate(t)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&fu(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),e.valueAccessor.setDisabledState&&t.registerOnDisabledChange(t=>{e.valueAccessor.setDisabledState(t)}),e._rawValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())}),e._rawAsyncValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())})}function fu(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function vu(t){return null!=t?Qd.compose(Xd(t)):null}function bu(t){return null!=t?Qd.composeAsync(Xd(t)):null}const yu=[_d,ou,eu,cu,pu,ru];function Cu(t){return(Pu(t)?t.validators:t)||null}function Vu(t){return Array.isArray(t)?vu(t):t||null}function wu(t,e){return(Pu(e)?e.asyncValidators:t)||null}function Au(t){return Array.isArray(t)?bu(t):t||null}function Pu(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class ku{constructor(t,e){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=Vu(this._rawValidators),this._composedAsyncValidatorFn=Au(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return"VALID"===this.status}get invalid(){return"INVALID"===this.status}get pending(){return"PENDING"==this.status}get disabled(){return"DISABLED"===this.status}get enabled(){return"DISABLED"!==this.status}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=Vu(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=Au(t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status="PENDING",!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild(e=>{e.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status="VALID",this._forEachChild(e=>{e.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status="PENDING",this._hasOwnPendingAsyncValidator=!0;const e=Jd(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(e=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(e,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(t,e,i){if(null==e)return null;if(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length)return null;let n=t;return e.forEach(t=>{n=n instanceof Mu?n.controls.hasOwnProperty(t)?n.controls[t]:null:n instanceof Su&&n.at(t)||null}),n}(this,t)}getError(t,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Ra,this.statusChanges=new Ra}_calculateStatus(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Pu(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}}class Du extends ku{constructor(t=null,e,i){super(Cu(e),wu(i,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),this._initObservables()}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(t=>t(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_clearChangeFns(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=()=>{}}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class Mu extends ku{constructor(t,e,i){super(Cu(e),wu(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e){this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity(),this._onCollectionChange()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(i=>{this._throwIfControlMissing(i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){Object.keys(t).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t={},e={}){this._forEachChild((i,n)=>{i.reset(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,i)=>(t[i]=e instanceof Du?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(t,e)=>!!e._syncPendingControls()||t);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>t(this.controls[e],e))}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const i=this.controls[e];if(this.contains(e)&&t(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,i)=>((e.enabled||this.disabled)&&(t[i]=e.value),t))}_reduceChildren(t,e){let i=t;return this._forEachChild((t,n)=>{i=e(i,t,n)}),i}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,i)=>{if(void 0===t[i])throw new Error(`Must supply a value for form control with name: '${i}'.`)})}}class Su extends ku{constructor(t,e,i){super(Cu(e),wu(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}at(t){return this.controls[t]}push(t){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()}insert(t,e){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity()}removeAt(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((t,i)=>{this._throwIfControlMissing(i),this.at(i).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t.forEach((t,i)=>{this.at(i)&&this.at(i).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t=[],e={}){this._forEachChild((i,n)=>{i.reset(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t instanceof Du?t.value:t.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let t=this.controls.reduce((t,e)=>!!e._syncPendingControls()||t,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error("Cannot find form control at index "+t)}_forEachChild(t){this.controls.forEach((e,i)=>{t(e,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,i)=>{if(void 0===t[i])throw new Error(`Must supply a value for form control at index: ${i}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const Iu={provide:Ld,useExisting:Ct(()=>Tu)},xu=(()=>Promise.resolve(null))();let Tu=(()=>{class t extends Ld{constructor(t,e){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new Ra,this.form=new Mu({},vu(t),bu(e))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){xu.then(()=>{const e=this._findContainer(t.path);t.control=e.registerControl(t.name,t.control),mu(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){xu.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name),function(t,e){const i=t.indexOf(e);i>-1&&t.splice(i,1)}(this._directives,t)})}addFormGroup(t){xu.then(()=>{const e=this._findContainer(t.path),i=new Mu({});(function(t,e){t.validator=Qd.compose([t.validator,e.validator]),t.asyncValidator=Qd.composeAsync([t.asyncValidator,e.asyncValidator])})(i,t),e.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){xu.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,e){xu.then(()=>{this.form.get(t.path).setValue(e)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,e=this._directives,this.form._syncPendingControls(),e.forEach(t=>{const e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)}),this.ngSubmit.emit(t),!1;var e}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return t.\u0275fac=function(e){return new(e||t)(Rs(Kd,10),Rs(qd,10))},t.\u0275dir=ge({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,e){1&t&&Js("submit",(function(t){return e.onSubmit(t)}))("reset",(function(){return e.onReset()}))},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Lo([Iu]),fs]}),t})();const _u={provide:jd,useExisting:Ct(()=>Eu)},Uu=(()=>Promise.resolve(null))();let Eu=(()=>{class t extends jd{constructor(t,e,i,n){super(),this.control=new Du,this._registered=!1,this.update=new Ra,this._parent=t,this._rawValidators=e||[],this._rawAsyncValidators=i||[],this.valueAccessor=function(t,e){if(!e)return null;Array.isArray(e);let i=void 0,n=void 0,r=void 0;return e.forEach(t=>{var e;t.constructor===Od?i=t:(e=t,yu.some(t=>e.constructor===t)?n=t:r=t)}),r||n||i||null}(0,n)}ngOnChanges(t){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in t&&this._updateDisabled(t),function(t,e){if(!t.hasOwnProperty("model"))return!1;const i=t.model;return!!i.isFirstChange()||!Object.is(e,i.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?function(t,e){return[...e.path,t]}(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return vu(this._rawValidators)}get asyncValidator(){return bu(this._rawAsyncValidators)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){mu(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){Uu.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1})})}_updateDisabled(t){const e=t.isDisabled.currentValue,i=""===e||e&&"false"!==e;Uu.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable()})}}return t.\u0275fac=function(e){return new(e||t)(Rs(Ld,9),Rs(Kd,10),Rs(qd,10),Rs(xd,10))},t.\u0275dir=ge({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Lo([_u]),fs,_e]}),t})(),Ou=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=ge({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const Gu={provide:Kd,useExisting:Ct(()=>Ru),multi:!0},Lu={provide:Kd,useExisting:Ct(()=>ju),multi:!0};let Ru=(()=>{class t{constructor(){this._required=!1}get required(){return this._required}set required(t){this._required=null!=t&&!1!==t&&""+t!="false",this._onChange&&this._onChange()}validate(t){return this.required?Qd.required(t):null}registerOnValidatorChange(t){this._onChange=t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=ge({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(t,e){2&t&&_s("required",e.required?"":null)},inputs:{required:"required"},features:[Lo([Gu])]}),t})(),ju=(()=>{class t extends Ru{validate(t){return this.required?Qd.requiredTrue(t):null}}return t.\u0275fac=function(e){return $u(e||t)},t.\u0275dir=ge({type:t,selectors:[["input","type","checkbox","required","","formControlName",""],["input","type","checkbox","required","","formControl",""],["input","type","checkbox","required","","ngModel",""]],hostVars:1,hostBindings:function(t,e){2&t&&_s("required",e.required?"":null)},features:[Lo([Lu]),fs]}),t})();const $u=nn(ju),Nu={provide:Kd,useExisting:Ct(()=>Fu),multi:!0};let Fu=(()=>{class t{constructor(){this._validator=Qd.nullValidator}ngOnChanges(t){"minlength"in t&&(this._createValidator(),this._onChange&&this._onChange())}validate(t){return null==this.minlength?null:this._validator(t)}registerOnValidatorChange(t){this._onChange=t}_createValidator(){this._validator=Qd.minLength("number"==typeof this.minlength?this.minlength:parseInt(this.minlength,10))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=ge({type:t,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(t,e){2&t&&_s("minlength",e.minlength?e.minlength:null)},inputs:{minlength:"minlength"},features:[Lo([Nu]),_e]}),t})();const Bu={provide:Kd,useExisting:Ct(()=>Hu),multi:!0};let Hu=(()=>{class t{constructor(){this._validator=Qd.nullValidator}ngOnChanges(t){"pattern"in t&&(this._createValidator(),this._onChange&&this._onChange())}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}_createValidator(){this._validator=Qd.pattern(this.pattern)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=ge({type:t,selectors:[["","pattern","","formControlName",""],["","pattern","","formControl",""],["","pattern","","ngModel",""]],hostVars:1,hostBindings:function(t,e){2&t&&_s("pattern",e.pattern?e.pattern:null)},inputs:{pattern:"pattern"},features:[Lo([Bu]),_e]}),t})(),Ku=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)}}),t})(),qu=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[nu],imports:[Ku]}),t})();function zu(...t){let e=t[t.length-1];return k(e)?(t.pop(),O(t,e)):H(t)}function Qu(t,e){return $(t,e,1)}function Wu(t,e){return function(i){return i.lift(new Ju(t,e))}}class Ju{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new Yu(t,this.predicate,this.thisArg))}}class Yu extends g{constructor(t,e,i){super(t),this.predicate=e,this.thisArg=i,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(i){return void this.destination.error(i)}e&&this.destination.next(t)}}class Zu{}class Xu{}class th{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(t=>{const e=t.indexOf(":");if(e>0){const i=t.slice(0,e),n=i.toLowerCase(),r=t.slice(e+1).trim();this.maybeSetNormalizedName(i,n),this.headers.has(n)?this.headers.get(n).push(r):this.headers.set(n,[r])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let i=t[e];const n=e.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(n,i),this.maybeSetNormalizedName(e,n))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof th?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new th;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof th?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(t.name,e);const n=("a"===t.op?this.headers.get(e):void 0)||[];n.push(...i),this.headers.set(e,n);break;case"d":const r=t.value;if(r){let t=this.headers.get(e);if(!t)return;t=t.filter(t=>-1===r.indexOf(t)),0===t.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,t)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class eh{encodeKey(t){return ih(t)}encodeValue(t){return ih(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}function ih(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class nh{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new eh,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){const i=new Map;return t.length>0&&t.split("&").forEach(t=>{const n=t.indexOf("="),[r,s]=-1==n?[e.decodeKey(t),""]:[e.decodeKey(t.slice(0,n)),e.decodeValue(t.slice(n+1))],o=i.get(r)||[];o.push(s),i.set(r,o)}),i}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const i=t.fromObject[e];this.map.set(e,Array.isArray(i)?i:[i])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(t=>e+"="+this.encoder.encodeValue(t)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new nh({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat([t]),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(t.value),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let e=this.map.get(t.param)||[];const i=e.indexOf(t.value);-1!==i&&e.splice(i,1),e.length>0?this.map.set(t.param,e):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}function rh(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function sh(t){return"undefined"!=typeof Blob&&t instanceof Blob}function oh(t){return"undefined"!=typeof FormData&&t instanceof FormData}class ah{constructor(t,e,i,n){let r;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||n?(this.body=void 0!==i?i:null,r=n):r=i,r&&(this.reportProgress=!!r.reportProgress,this.withCredentials=!!r.withCredentials,r.responseType&&(this.responseType=r.responseType),r.headers&&(this.headers=r.headers),r.params&&(this.params=r.params)),this.headers||(this.headers=new th),this.params){const t=this.params.toString();if(0===t.length)this.urlWithParams=e;else{const i=e.indexOf("?");this.urlWithParams=e+(-1===i?"?":i<e.length-1?"&":"")+t}}else this.params=new nh,this.urlWithParams=e}serializeBody(){return null===this.body?null:rh(this.body)||sh(this.body)||oh(this.body)||"string"==typeof this.body?this.body:this.body instanceof nh?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||oh(this.body)?null:sh(this.body)?this.body.type||null:rh(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof nh?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}clone(t={}){const e=t.method||this.method,i=t.url||this.url,n=t.responseType||this.responseType,r=void 0!==t.body?t.body:this.body,s=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,o=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let a=t.headers||this.headers,l=t.params||this.params;return void 0!==t.setHeaders&&(a=Object.keys(t.setHeaders).reduce((e,i)=>e.set(i,t.setHeaders[i]),a)),t.setParams&&(l=Object.keys(t.setParams).reduce((e,i)=>e.set(i,t.setParams[i]),l)),new ah(e,i,r,{params:l,headers:a,reportProgress:o,responseType:n,withCredentials:s})}}var lh=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}({});class ch{constructor(t,e=200,i="OK"){this.headers=t.headers||new th,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||i,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class dh extends ch{constructor(t={}){super(t),this.type=lh.ResponseHeader}clone(t={}){return new dh({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class uh extends ch{constructor(t={}){super(t),this.type=lh.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new uh({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class hh extends ch{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?"Http failure during parsing for "+(t.url||"(unknown url)"):`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function ph(t,e){return{body:e,headers:t.headers,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let gh=(()=>{class t{constructor(t){this.handler=t}request(t,e,i={}){let n;if(t instanceof ah)n=t;else{let r=void 0;r=i.headers instanceof th?i.headers:new th(i.headers);let s=void 0;i.params&&(s=i.params instanceof nh?i.params:new nh({fromObject:i.params})),n=new ah(t,e,void 0!==i.body?i.body:null,{headers:r,params:s,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const r=zu(n).pipe(Qu(t=>this.handler.handle(t)));if(t instanceof ah||"events"===i.observe)return r;const s=r.pipe(Wu(t=>t instanceof uh));switch(i.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return s.pipe(D(t=>{if(null!==t.body&&!(t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return t.body}));case"blob":return s.pipe(D(t=>{if(null!==t.body&&!(t.body instanceof Blob))throw new Error("Response is not a Blob.");return t.body}));case"text":return s.pipe(D(t=>{if(null!==t.body&&"string"!=typeof t.body)throw new Error("Response is not a string.");return t.body}));case"json":default:return s.pipe(D(t=>t.body))}case"response":return s;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(t,e={}){return this.request("DELETE",t,e)}get(t,e={}){return this.request("GET",t,e)}head(t,e={}){return this.request("HEAD",t,e)}jsonp(t,e){return this.request("JSONP",t,{params:(new nh).append(e,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,e={}){return this.request("OPTIONS",t,e)}patch(t,e,i={}){return this.request("PATCH",t,ph(i,e))}post(t,e,i={}){return this.request("POST",t,ph(i,e))}put(t,e,i={}){return this.request("PUT",t,ph(i,e))}}return t.\u0275fac=function(e){return new(e||t)(Kt(Zu))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class mh{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const fh=new Ot("HTTP_INTERCEPTORS");let vh=(()=>{class t{intercept(t,e){return e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const bh=/^\)\]\}',?\n/;class yh{}let Ch=(()=>{class t{constructor(){}build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Vh=(()=>{class t{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new b(e=>{const i=this.xhrFactory.build();if(i.open(t.method,t.urlWithParams),t.withCredentials&&(i.withCredentials=!0),t.headers.forEach((t,e)=>i.setRequestHeader(t,e.join(","))),t.headers.has("Accept")||i.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const e=t.detectContentTypeHeader();null!==e&&i.setRequestHeader("Content-Type",e)}if(t.responseType){const e=t.responseType.toLowerCase();i.responseType="json"!==e?e:"text"}const n=t.serializeBody();let r=null;const s=()=>{if(null!==r)return r;const e=1223===i.status?204:i.status,n=i.statusText||"OK",s=new th(i.getAllResponseHeaders()),o=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(i)||t.url;return r=new dh({headers:s,status:e,statusText:n,url:o}),r},o=()=>{let{headers:n,status:r,statusText:o,url:a}=s(),l=null;204!==r&&(l=void 0===i.response?i.responseText:i.response),0===r&&(r=l?200:0);let c=r>=200&&r<300;if("json"===t.responseType&&"string"==typeof l){const t=l;l=l.replace(bh,"");try{l=""!==l?JSON.parse(l):null}catch(d){l=t,c&&(c=!1,l={error:d,text:l})}}c?(e.next(new uh({body:l,headers:n,status:r,statusText:o,url:a||void 0})),e.complete()):e.error(new hh({error:l,headers:n,status:r,statusText:o,url:a||void 0}))},a=t=>{const{url:n}=s(),r=new hh({error:t,status:i.status||0,statusText:i.statusText||"Unknown Error",url:n||void 0});e.error(r)};let l=!1;const c=n=>{l||(e.next(s()),l=!0);let r={type:lh.DownloadProgress,loaded:n.loaded};n.lengthComputable&&(r.total=n.total),"text"===t.responseType&&i.responseText&&(r.partialText=i.responseText),e.next(r)},d=t=>{let i={type:lh.UploadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),e.next(i)};return i.addEventListener("load",o),i.addEventListener("error",a),t.reportProgress&&(i.addEventListener("progress",c),null!==n&&i.upload&&i.upload.addEventListener("progress",d)),i.send(n),e.next({type:lh.Sent}),()=>{i.removeEventListener("error",a),i.removeEventListener("load",o),t.reportProgress&&(i.removeEventListener("progress",c),null!==n&&i.upload&&i.upload.removeEventListener("progress",d)),i.readyState!==i.DONE&&i.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(Kt(yh))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const wh=new Ot("XSRF_COOKIE_NAME"),Ah=new Ot("XSRF_HEADER_NAME");class Ph{}let kh=(()=>{class t{constructor(t,e,i){this.doc=t,this.platform=e,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Ec(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(Kt(Rl),Kt(qa),Kt(wh))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Dh=(()=>{class t{constructor(t,e){this.tokenService=t,this.headerName=e}intercept(t,e){const i=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||i.startsWith("http://")||i.startsWith("https://"))return e.handle(t);const n=this.tokenService.getToken();return null===n||t.headers.has(this.headerName)||(t=t.clone({headers:t.headers.set(this.headerName,n)})),e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(Ph),Kt(Ah))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Mh=(()=>{class t{constructor(t,e){this.backend=t,this.injector=e,this.chain=null}handle(t){if(null===this.chain){const t=this.injector.get(fh,[]);this.chain=t.reduceRight((t,e)=>new mh(t,e),this.backend)}return this.chain.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(Xu),Kt(hs))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Sh=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:Dh,useClass:vh}]}}static withOptions(e={}){return{ngModule:t,providers:[e.cookieName?{provide:wh,useValue:e.cookieName}:[],e.headerName?{provide:Ah,useValue:e.headerName}:[]]}}}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[Dh,{provide:fh,useExisting:Dh,multi:!0},{provide:Ph,useClass:kh},{provide:wh,useValue:"XSRF-TOKEN"},{provide:Ah,useValue:"X-XSRF-TOKEN"}]}),t})(),Ih=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[gh,{provide:Zu,useClass:Mh},Vh,{provide:Xu,useExisting:Vh},Ch,{provide:yh,useExisting:Ch}],imports:[[Sh.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})();function xh(t,e){let i=0;return i=(t=t||"").localeCompare(e=e||""),i}function Th(t,e){let i=0;return void 0===t&&(t=new Date(-864e13)),void 0===e&&(e=new Date(-864e13)),t<e?i=-1:t>e&&(i=1),i}function _h(t,e,i="en"){return t.toLocaleDateString(i,"longDate"==e?{year:"4-digit",month:"2-digit",day:"2-digit"}:"fullDate"==e?{year:"2-digit",month:"2-digit",day:"2-digit"}:"shortDate"==e?{year:"2-digit",month:"short"}:{year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function Uh(t,e){if(!e&&!t)return;const i=t?new Date(t):new Date;return i?i.toISOString():void 0}function Eh(t){const e=new Date;return e.setHours(0,0,0,0),!!(t&&t.getTime()>=e.getTime())}function Oh(t,e){if(!t||!e)return!1;let i=new Date(t),n=new Date(e);return i.setHours(0,0,0,0),n.setHours(0,0,0,0),i.toISOString()===n.toISOString()}function Gh(t,e,i){return t?t.length<e?t:e<3?"...":i?"...".concat(t.substr(t.length-e)):t.substring(0,e-3).concat("..."):""}function Lh(t){let e="Unknown Error";return t&&(0===t.status?(e="Server not reachable with ",e=e.concat(t.url||""),console.log(`Rest Server not reachable: ${t.status} ${t.statusText}, Message ${t.message}`)):(console.log(`Rest Error Status: ${t.status} ${t.statusText}, Message ${t.message}, Name: ${t.error.name||""}`),t.error&&t.error.message?e=t.error.message:t.message?e=t.message:t.statusText&&(e=t.statusText))),e}let Rh=(()=>{class t{constructor(){this.messages=[],this.activateMessages=void 0,this.activateMessageToggle=new Ra(!0)}initstatus(){void 0===this.activateMessages&&(this.activateMessages="On"===localStorage.getItem("activateMessages"))}toggle(){return this.initstatus(),this.activateMessages=!this.activateMessages,localStorage.setItem("activateMessages",this.activateMessages?"On":"Off"),this.activateMessageToggle.emit(this.activateMessages),console.log("Messages Toggle to %s",this.activateMessages),this.activateMessages}getstatus(){return this.initstatus(),this.activateMessages}add(t){this.messages.push(t),this.messages.length>20&&this.messages.shift()}clear(){this.messages=[]}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function jh(t,e){return new b(e?i=>e.schedule($h,0,{error:t,subscriber:i}):e=>e.error(t))}function $h({error:t,subscriber:e}){e.error(t)}function Nh(t){return function(e){const i=new Fh(t),n=e.lift(i);return i.caught=n}}class Fh{constructor(t){this.selector=t}call(t,e){return e.subscribe(new Bh(t,this.selector,this.caught))}}class Bh extends R{constructor(t,e,i){super(t),this.selector=e,this.caught=i}error(t){if(!this.isStopped){let i;try{i=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const n=new L(this);this.add(n);const r=j(i,n);r!==n&&this.add(r)}}}function Hh(){}function Kh(t,e,i){return function(n){return n.lift(new qh(t,e,i))}}class qh{constructor(t,e,i){this.nextOrObserver=t,this.error=e,this.complete=i}call(t,e){return e.subscribe(new zh(t,this.nextOrObserver,this.error,this.complete))}}class zh extends g{constructor(t,e,i,r){super(t),this._tapNext=Hh,this._tapError=Hh,this._tapComplete=Hh,this._tapError=i||Hh,this._tapComplete=r||Hh,n(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||Hh,this._tapError=e.error||Hh,this._tapComplete=e.complete||Hh)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}class Qh{}class Wh{}class Jh{}class Yh{}class Zh{}function Xh(t){this.message=t}(Xh.prototype=new Error).name="InvalidCharacterError";var tp="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new Xh("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,n,r=0,s=0,o="";n=e.charAt(s++);~n&&(i=r%4?64*i+n:n,r++%4)?o+=String.fromCharCode(255&i>>(-2*r&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return o};function ep(t){this.message=t}(ep.prototype=new Error).name="InvalidTokenError";var ip=function(t,e){if("string"!=typeof t)throw new ep("Invalid token specified");var i=!0===(e=e||{}).header?0:1;try{return JSON.parse(function(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(t){return decodeURIComponent(tp(t).replace(/(.)/g,(function(t,e){var i=e.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i})))}(e)}catch(t){return tp(e)}}(t.split(".")[i]))}catch(t){throw new ep("Invalid token specified: "+t.message)}};class np{constructor(){this.restUrl="https://dev.visbo.net/api"}}const rp={headers:new th({"Content-Type":"application/json"})};let sp=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.isLoggedIn=!1,this.authUrl=this.env.restUrl.concat("/token/user")}logoutCheck(){if(this.isLoggedIn)return this.logoutTime}login(t,e){const i=this.authUrl+"/login";this.log(`Calling HTTP Request: ${i} for: ${t}`);const n=new Qh;return n.email=t,n.password=e,this.http.post(i,n).pipe(D(t=>{if(t&&t.token){this.log("Login Request Successful:  "+t.user.email),localStorage.setItem("currentUser",JSON.stringify(t.user)),localStorage.setItem("currentToken",JSON.stringify(t.token)),this.isLoggedIn=!0;const e=ip(t.token);return e&&e.exp&&(this.logoutTime=new Date(1e3*e.exp)),this.log("Login Request logoutTime:  "+this.logoutTime),t.user}return null}),Nh(this.handleError("LoginError")))}loginGoogleUrl(){return this.authUrl+"/logingoogle"}loginGoogle(){const t=this.authUrl+"/logingoogle";return this.log("Calling HTTP Request: "+t),this.http.post(t,{}).pipe(D(t=>{if(console.log("google Login :  "+JSON.stringify(t)),t&&t.token){this.log("Login Request Successful:  "+t.user.email),localStorage.setItem("currentUser",JSON.stringify(t.user)),localStorage.setItem("currentToken",JSON.stringify(t.token)),this.isLoggedIn=!0;const e=ip(t.token);return e&&e.exp&&(this.logoutTime=new Date(1e3*e.exp)),this.log("Login Request logoutTime:  "+this.logoutTime),t.user}return null}),Nh(this.handleError("LoginError")))}oauthconfirm(t){localStorage.setItem("currentUser",JSON.stringify({profile:{company:"Privat",firstName:"Markus (G)",lastName:"Seyfried"},status:{registeredAt:"2020-11-10T16:20:32.620Z",lastLoginAt:"2020-11-10T18:10:31.694Z",loginRetries:0},_id:"5b60762decb6077f42ba27d2",email:"markus.seyfried@gmail.com",createdAt:"2018-07-31T14:46:05.138Z",updatedAt:"2020-11-10T18:22:39.469Z",__v:3,userAgents:[]})),localStorage.setItem("currentToken",JSON.stringify(t))}logout(){this.isLoggedIn=!1,localStorage.clear()}getActiveUser(){return JSON.parse(localStorage.getItem("currentUser"))}pwforgotten(t){const e=this.authUrl+"/pwforgotten",i=new Zh;return i.email=t.email,this.log(`Calling HTTP Request: ${e} for: ${i.email} `),this.http.post(e,i).pipe(D(t=>(this.log("PW Forgotten Request executed"),t&&this.log("PW Forgotten Request Successful:  "+JSON.stringify(t)),t)),Nh(this.handleError("pwforgotten")))}pwreset(t,e){const i=this.authUrl+"/pwreset",n={token:e,password:t.password};return this.log(`Calling HTTP Request: ${i} with: ${e} `),this.http.post(i,n).pipe(D(t=>(this.log("PW Reset Request executed"),this.log(t?"PW Reset Request Successful:  "+JSON.stringify(t):"PW Reset Request Unsuccessful:  "+JSON.stringify(t)),t)),Nh(this.handleError("pwreset")))}registerconfirm(t,e){const i=this.authUrl+"/confirm",n={_id:t,hash:e};return this.log(`Calling HTTP Request: ${i} for: ${t} `),this.http.post(i,n).pipe(D(t=>(this.log("e-mail confirm Request executed"),t&&this.log("e-mail confirm Request Successful:  "+JSON.stringify(t)),t)),Nh(this.handleError("pwreset")))}getUser(t,e){const i=this.authUrl+"/signup",n=new th({"Content-Type":"application/json"});let r=new nh;return t&&(r=r.append("id",t)),e&&(r=r.append("hash",e)),this.log(`Calling HTTP Request: ${i} for: ${t} hash ${e}`),this.http.get(i,{headers:n,params:r}).pipe(D(t=>t.user),Nh(this.handleError("get registerUser")))}createUser(t,e){const i=this.authUrl+"/signup",n=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("hash",e)),this.log(`Calling HTTP Request: ${i} for: ${t.email||t._id} hash ${e} Profile: ${JSON.stringify(t.profile)}`),this.http.post(i,t,{headers:n,params:r}).pipe(D(t=>(this.log("Registration Request executed:  "+JSON.stringify(t)),t.user?(this.log("Registration Request Successful:  "+t.user.email),t.user):new Zh)),Nh(this.handleError("registerUser")))}restVersion(){const t=this.env.restUrl.concat("/status");return this.log("Calling HTTP Request: "+t),this.http.get(t,rp).pipe(D(t=>t.status),Kh(()=>this.log("fetched Status  ")),Nh(this.handleError("restVersion")))}initPWPolicy(){const t=this.env.restUrl.concat("/status/pwpolicy");return this.log("Calling HTTP Request: "+t),this.http.get(t,rp).pipe(D(t=>{var e;return this.pwPolicy=null===(e=t.value)||void 0===e?void 0:e.PWPolicy,t.value}),Kh(t=>this.log("fetched PW Policy "+JSON.stringify(t))),Nh(this.handleError("initPWPolicy")))}getSetting(){const t=this.env.restUrl.concat("/status/setting");return this.log("Calling HTTP Request: "+t),this.http.get(t,rp).pipe(D(t=>t.vcsetting),Kh(t=>this.log("fetched Setting "+JSON.stringify(t))),Nh(this.handleError("initSetting")))}getPWPolicy(){return this.pwPolicy}handleError(t="operation",e){return i=>(this.log(`${t} failed: ${JSON.stringify(i)} Status: ${i.status}, StatusText: ${i.statusText}, Message: ${i.message}, Result ${JSON.stringify(e)} `),jh(i))}log(t){this.messageService.add("AuthenticationService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(Rh),Kt(np))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class op extends A{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new C;return this._value}next(t){super.next(this._value=t)}}class ap extends g{notifyNext(t,e,i,n,r){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}class lp extends g{constructor(t,e,i){super(),this.parent=t,this.outerValue=e,this.outerIndex=i,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function cp(t,e,i,n,r=new lp(t,i,n)){if(!r.closed)return e instanceof b?e.subscribe(r):E(e)(r)}const dp={};class up{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new hp(t,this.resultSelector))}}class hp extends ap{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(dp),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let i=0;i<e;i++)this.add(cp(this,t[i],void 0,i))}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,i){const n=this.values,r=this.toRespond?n[i]===dp?--this.toRespond:this.toRespond:0;n[i]=e,0===r&&(this.resultSelector?this._tryResultSelector(n):this.destination.next(n.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(i){return void this.destination.error(i)}this.destination.next(e)}}const pp=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})(),gp=new b(t=>t.complete());function mp(t){return t?function(t){return new b(e=>t.schedule(()=>e.complete()))}(t):gp}function fp(t){return new b(e=>{let i;try{i=t()}catch(n){return void e.error(n)}return(i?G(i):mp()).subscribe(e)})}function vp(){return B(1)}const bp=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function yp(t){return function(e){return 0===t?mp():e.lift(new Cp(t))}}class Cp{constructor(t){if(this.total=t,this.total<0)throw new bp}call(t,e){return e.subscribe(new Vp(t,this.total))}}class Vp extends g{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,i=this.total,n=this.count++;e.length<i?e.push(t):e[n%i]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const i=this.count>=this.total?this.total:this.count,n=this.ring;for(let r=0;r<i;r++){const r=e++%i;t.next(n[r])}}t.complete()}}function wp(t=kp){return e=>e.lift(new Ap(t))}class Ap{constructor(t){this.errorFactory=t}call(t,e){return e.subscribe(new Pp(t,this.errorFactory))}}class Pp extends g{constructor(t,e){super(t),this.errorFactory=e,this.hasValue=!1}_next(t){this.hasValue=!0,this.destination.next(t)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}}function kp(){return new pp}function Dp(t=null){return e=>e.lift(new Mp(t))}class Mp{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new Sp(t,this.defaultValue))}}class Sp extends g{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function Ip(t,e){return"function"==typeof e?i=>i.pipe(Ip((i,n)=>G(t(i,n)).pipe(D((t,r)=>e(i,t,n,r))))):e=>e.lift(new xp(t))}class xp{constructor(t){this.project=t}call(t,e){return e.subscribe(new Tp(t,this.project))}}class Tp extends R{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const i=this.index++;try{e=this.project(t,i)}catch(n){return void this.destination.error(n)}this._innerSub(e)}_innerSub(t){const e=this.innerSubscription;e&&e.unsubscribe();const i=new L(this),n=this.destination;n.add(i),this.innerSubscription=j(t,i),this.innerSubscription!==i&&n.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(t){this.destination.next(t)}}function _p(t){return e=>0===t?mp():e.lift(new Up(t))}class Up{constructor(t){if(this.total=t,this.total<0)throw new bp}call(t,e){return e.subscribe(new Ep(t,this.total))}}class Ep extends g{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,i=++this.count;i<=e&&(this.destination.next(t),i===e&&(this.destination.complete(),this.unsubscribe()))}}function Op(...t){return vp()(zu(...t))}class Gp{constructor(t,e,i=!1){this.accumulator=t,this.seed=e,this.hasSeed=i}call(t,e){return e.subscribe(new Lp(t,this.accumulator,this.seed,this.hasSeed))}}class Lp extends g{constructor(t,e,i,n){super(t),this.accumulator=e,this._seed=i,this.hasSeed=n,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let i;try{i=this.accumulator(this.seed,t,e)}catch(n){this.destination.error(n)}this.seed=i,this.destination.next(i)}}function Rp(t,e){const i=arguments.length>=2;return n=>n.pipe(t?Wu((e,i)=>t(e,i,n)):v,_p(1),i?Dp(e):wp(()=>new pp))}class jp{constructor(t){this.callback=t}call(t,e){return e.subscribe(new $p(t,this.callback))}}class $p extends g{constructor(t,e){super(t),this.add(new u(e))}}class Np{constructor(t,e){this.id=t,this.url=e}}class Fp extends Np{constructor(t,e,i="imperative",n=null){super(t,e),this.navigationTrigger=i,this.restoredState=n}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Bp extends Np{constructor(t,e,i){super(t,e),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Hp extends Np{constructor(t,e,i){super(t,e),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Kp extends Np{constructor(t,e,i){super(t,e),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class qp extends Np{constructor(t,e,i,n){super(t,e),this.urlAfterRedirects=i,this.state=n}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class zp extends Np{constructor(t,e,i,n){super(t,e),this.urlAfterRedirects=i,this.state=n}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Qp extends Np{constructor(t,e,i,n,r){super(t,e),this.urlAfterRedirects=i,this.state=n,this.shouldActivate=r}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Wp extends Np{constructor(t,e,i,n){super(t,e),this.urlAfterRedirects=i,this.state=n}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Jp extends Np{constructor(t,e,i,n){super(t,e),this.urlAfterRedirects=i,this.state=n}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Yp{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Zp{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Xp{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class tg{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class eg{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ig{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ng{constructor(t,e,i){this.routerEvent=t,this.position=e,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class rg{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function sg(t){return new rg(t)}function og(t){const e=Error("NavigationCancelingError: "+t);return e.ngNavigationCancelingError=!0,e}function ag(t,e,i){const n=i.path.split("/");if(n.length>t.length)return null;if("full"===i.pathMatch&&(e.hasChildren()||n.length<t.length))return null;const r={};for(let s=0;s<n.length;s++){const e=n[s],i=t[s];if(e.startsWith(":"))r[e.substring(1)]=i;else if(e!==i.path)return null}return{consumed:t.slice(0,n.length),posParams:r}}function lg(t,e){const i=Object.keys(t),n=Object.keys(e);if(!i||!n||i.length!=n.length)return!1;let r;for(let s=0;s<i.length;s++)if(r=i[s],!cg(t[r],e[r]))return!1;return!0}function cg(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const i=[...t].sort(),n=[...e].sort();return i.every((t,e)=>n[e]===t)}return t===e}function dg(t){return Array.prototype.concat.apply([],t)}function ug(t){return t.length>0?t[t.length-1]:null}function hg(t,e){for(const i in t)t.hasOwnProperty(i)&&e(t[i],i)}function pg(t){return Ws(t)?t:Qs(t)?G(Promise.resolve(t)):zu(t)}function gg(t,e,i){return i?function(t,e){return lg(t,e)}(t.queryParams,e.queryParams)&&function t(e,i){if(!bg(e.segments,i.segments))return!1;if(e.numberOfChildren!==i.numberOfChildren)return!1;for(const n in i.children){if(!e.children[n])return!1;if(!t(e.children[n],i.children[n]))return!1}return!0}(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(i=>cg(t[i],e[i]))}(t.queryParams,e.queryParams)&&function t(e,i){return function e(i,n,r){if(i.segments.length>r.length)return!!bg(i.segments.slice(0,r.length),r)&&!n.hasChildren();if(i.segments.length===r.length){if(!bg(i.segments,r))return!1;for(const e in n.children){if(!i.children[e])return!1;if(!t(i.children[e],n.children[e]))return!1}return!0}{const t=r.slice(0,i.segments.length),s=r.slice(i.segments.length);return!!bg(i.segments,t)&&!!i.children.primary&&e(i.children.primary,n,s)}}(e,i,i.segments)}(t.root,e.root)}class mg{constructor(t,e,i){this.root=t,this.queryParams=e,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=sg(this.queryParams)),this._queryParamMap}toString(){return wg.serialize(this)}}class fg{constructor(t,e){this.segments=t,this.children=e,this.parent=null,hg(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ag(this)}}class vg{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=sg(this.parameters)),this._parameterMap}toString(){return Ig(this)}}function bg(t,e){return t.length===e.length&&t.every((t,i)=>t.path===e[i].path)}function yg(t,e){let i=[];return hg(t.children,(t,n)=>{"primary"===n&&(i=i.concat(e(t,n)))}),hg(t.children,(t,n)=>{"primary"!==n&&(i=i.concat(e(t,n)))}),i}class Cg{}class Vg{parse(t){const e=new Eg(t);return new mg(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){return`${"/"+function t(e,i){if(!e.hasChildren())return Ag(e);if(i){const i=e.children.primary?t(e.children.primary,!1):"",n=[];return hg(e.children,(e,i)=>{"primary"!==i&&n.push(`${i}:${t(e,!1)}`)}),n.length>0?`${i}(${n.join("//")})`:i}{const i=yg(e,(i,n)=>"primary"===n?[t(e.children.primary,!1)]:[`${n}:${t(i,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children.primary?`${Ag(e)}/${i[0]}`:`${Ag(e)}/(${i.join("//")})`}}(t.root,!0)}${function(t){const e=Object.keys(t).map(e=>{const i=t[e];return Array.isArray(i)?i.map(t=>`${kg(e)}=${kg(t)}`).join("&"):`${kg(e)}=${kg(i)}`});return e.length?"?"+e.join("&"):""}(t.queryParams)}${"string"==typeof t.fragment?"#"+encodeURI(t.fragment):""}`}}const wg=new Vg;function Ag(t){return t.segments.map(t=>Ig(t)).join("/")}function Pg(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function kg(t){return Pg(t).replace(/%3B/gi,";")}function Dg(t){return Pg(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Mg(t){return decodeURIComponent(t)}function Sg(t){return Mg(t.replace(/\+/g,"%20"))}function Ig(t){return`${Dg(t.path)}${e=t.parameters,Object.keys(e).map(t=>`;${Dg(t)}=${Dg(e[t])}`).join("")}`;var e}const xg=/^[^\/()?;=#]+/;function Tg(t){const e=t.match(xg);return e?e[0]:""}const _g=/^[^=?&#]+/,Ug=/^[^?&#]+/;class Eg{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new fg([],{}):new fg([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(i.primary=new fg(t,e)),i}parseSegment(){const t=Tg(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new vg(Mg(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=Tg(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const t=Tg(this.remaining);t&&(i=t,this.capture(i))}t[Mg(e)]=Mg(i)}parseQueryParam(t){const e=function(t){const e=t.match(_g);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(Ug);return e?e[0]:""}(this.remaining);t&&(i=t,this.capture(i))}const n=Sg(e),r=Sg(i);if(t.hasOwnProperty(n)){let e=t[n];Array.isArray(e)||(e=[e],t[n]=e),e.push(r)}else t[n]=r}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Tg(this.remaining),n=this.remaining[i.length];if("/"!==n&&")"!==n&&";"!==n)throw new Error(`Cannot parse url '${this.url}'`);let r=void 0;i.indexOf(":")>-1?(r=i.substr(0,i.indexOf(":")),this.capture(r),this.capture(":")):t&&(r="primary");const s=this.parseChildren();e[r]=1===Object.keys(s).length?s.primary:new fg([],s),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class Og{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=Gg(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=Gg(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=Lg(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return Lg(t,this._root).map(t=>t.value)}}function Gg(t,e){if(t===e.value)return e;for(const i of e.children){const e=Gg(t,i);if(e)return e}return null}function Lg(t,e){if(t===e.value)return[e];for(const i of e.children){const n=Lg(t,i);if(n.length)return n.unshift(e),n}return[]}class Rg{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function jg(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class $g extends Og{constructor(t,e){super(t),this.snapshot=e,qg(this,t)}toString(){return this.snapshot.toString()}}function Ng(t,e){const i=function(t,e){const i=new Hg([],{},{},"",{},"primary",e,null,t.root,-1,{});return new Kg("",new Rg(i,[]))}(t,e),n=new op([new vg("",{})]),r=new op({}),s=new op({}),o=new op({}),a=new op(""),l=new Fg(n,r,o,a,s,"primary",e,i.root);return l.snapshot=i.root,new $g(new Rg(l,[]),i)}class Fg{constructor(t,e,i,n,r,s,o,a){this.url=t,this.params=e,this.queryParams=i,this.fragment=n,this.data=r,this.outlet=s,this.component=o,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(D(t=>sg(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(D(t=>sg(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Bg(t,e="emptyOnly"){const i=t.pathFromRoot;let n=0;if("always"!==e)for(n=i.length-1;n>=1;){const t=i[n],e=i[n-1];if(t.routeConfig&&""===t.routeConfig.path)n--;else{if(e.component)break;n--}}return function(t){return t.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(i.slice(n))}class Hg{constructor(t,e,i,n,r,s,o,a,l,c,d){this.url=t,this.params=e,this.queryParams=i,this.fragment=n,this.data=r,this.outlet=s,this.component=o,this.routeConfig=a,this._urlSegment=l,this._lastPathIndex=c,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=sg(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=sg(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Kg extends Og{constructor(t,e){super(e),this.url=t,qg(this,e)}toString(){return zg(this._root)}}function qg(t,e){e.value._routerState=t,e.children.forEach(e=>qg(t,e))}function zg(t){const e=t.children.length>0?` { ${t.children.map(zg).join(", ")} } `:"";return`${t.value}${e}`}function Qg(t){if(t.snapshot){const e=t.snapshot,i=t._futureSnapshot;t.snapshot=i,lg(e.queryParams,i.queryParams)||t.queryParams.next(i.queryParams),e.fragment!==i.fragment&&t.fragment.next(i.fragment),lg(e.params,i.params)||t.params.next(i.params),function(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!lg(t[i],e[i]))return!1;return!0}(e.url,i.url)||t.url.next(i.url),lg(e.data,i.data)||t.data.next(i.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function Wg(t,e){var i,n;return lg(t.params,e.params)&&bg(i=t.url,n=e.url)&&i.every((t,e)=>lg(t.parameters,n[e].parameters))&&!(!t.parent!=!e.parent)&&(!t.parent||Wg(t.parent,e.parent))}function Jg(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function Yg(t){return"object"==typeof t&&null!=t&&t.outlets}function Zg(t,e,i,n,r){let s={};return n&&hg(n,(t,e)=>{s[e]=Array.isArray(t)?t.map(t=>""+t):""+t}),new mg(i.root===t?e:function t(e,i,n){const r={};return hg(e.children,(e,s)=>{r[s]=e===i?n:t(e,i,n)}),new fg(e.segments,r)}(i.root,t,e),s,r)}class Xg{constructor(t,e,i){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=i,t&&i.length>0&&Jg(i[0]))throw new Error("Root segment cannot have matrix parameters");const n=i.find(Yg);if(n&&n!==ug(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class tm{constructor(t,e,i){this.segmentGroup=t,this.processChildren=e,this.index=i}}function em(t,e,i){if(t||(t=new fg([],{})),0===t.segments.length&&t.hasChildren())return im(t,e,i);const n=function(t,e,i){let n=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<t.segments.length;){if(n>=i.length)return s;const e=t.segments[r],o=i[n];if(Yg(o))break;const a=""+o,l=n<i.length-1?i[n+1]:null;if(r>0&&void 0===a)break;if(a&&l&&"object"==typeof l&&void 0===l.outlets){if(!om(a,l,e))return s;n+=2}else{if(!om(a,{},e))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(t,e,i),r=i.slice(n.commandIndex);if(n.match&&n.pathIndex<t.segments.length){const e=new fg(t.segments.slice(0,n.pathIndex),{});return e.children.primary=new fg(t.segments.slice(n.pathIndex),t.children),im(e,0,r)}return n.match&&0===r.length?new fg(t.segments,{}):n.match&&!t.hasChildren()?nm(t,e,i):n.match?im(t,0,r):nm(t,e,i)}function im(t,e,i){if(0===i.length)return new fg(t.segments,{});{const n=function(t){return Yg(t[0])?t[0].outlets:{primary:t}}(i),r={};return hg(n,(i,n)=>{null!==i&&(r[n]=em(t.children[n],e,i))}),hg(t.children,(t,e)=>{void 0===n[e]&&(r[e]=t)}),new fg(t.segments,r)}}function nm(t,e,i){const n=t.segments.slice(0,e);let r=0;for(;r<i.length;){const s=i[r];if(Yg(s)){const t=rm(s.outlets);return new fg(n,t)}if(0===r&&Jg(i[0])){n.push(new vg(t.segments[e].path,i[0])),r++;continue}const o=Yg(s)?s.outlets.primary:""+s,a=r<i.length-1?i[r+1]:null;o&&a&&Jg(a)?(n.push(new vg(o,sm(a))),r+=2):(n.push(new vg(o,{})),r++)}return new fg(n,{})}function rm(t){const e={};return hg(t,(t,i)=>{null!==t&&(e[i]=nm(new fg([],{}),0,t))}),e}function sm(t){const e={};return hg(t,(t,i)=>e[i]=""+t),e}function om(t,e,i){return t==i.path&&lg(e,i.parameters)}class am{constructor(t,e,i,n){this.routeReuseStrategy=t,this.futureState=e,this.currState=i,this.forwardEvent=n}activate(t){const e=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,i,t),Qg(this.futureState.root),this.activateChildRoutes(e,i,t)}deactivateChildRoutes(t,e,i){const n=jg(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,n[e],i),delete n[e]}),hg(n,(t,e)=>{this.deactivateRouteAndItsChildren(t,i)})}deactivateRoutes(t,e,i){const n=t.value,r=e?e.value:null;if(n===r)if(n.component){const r=i.getContext(n.outlet);r&&this.deactivateChildRoutes(t,e,r.children)}else this.deactivateChildRoutes(t,e,i);else r&&this.deactivateRouteAndItsChildren(e,i)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const i=e.getContext(t.value.outlet);if(i&&i.outlet){const e=i.outlet.detach(),n=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:n})}}deactivateRouteAndOutlet(t,e){const i=e.getContext(t.value.outlet);if(i){const n=jg(t),r=t.value.component?i.children:e;hg(n,(t,e)=>this.deactivateRouteAndItsChildren(t,r)),i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated())}}activateChildRoutes(t,e,i){const n=jg(e);t.children.forEach(t=>{this.activateRoutes(t,n[t.value.outlet],i),this.forwardEvent(new ig(t.value.snapshot))}),t.children.length&&this.forwardEvent(new tg(t.value.snapshot))}activateRoutes(t,e,i){const n=t.value,r=e?e.value:null;if(Qg(n),n===r)if(n.component){const r=i.getOrCreateContext(n.outlet);this.activateChildRoutes(t,e,r.children)}else this.activateChildRoutes(t,e,i);else if(n.component){const e=i.getOrCreateContext(n.outlet);if(this.routeReuseStrategy.shouldAttach(n.snapshot)){const t=this.routeReuseStrategy.retrieve(n.snapshot);this.routeReuseStrategy.store(n.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),lm(t.route)}else{const i=function(t){for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(n.snapshot),r=i?i.module.componentFactoryResolver:null;e.attachRef=null,e.route=n,e.resolver=r,e.outlet&&e.outlet.activateWith(n,r),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,i)}}function lm(t){Qg(t.value),t.children.forEach(lm)}class cm{constructor(t,e){this.routes=t,this.module=e}}function dm(t){return"function"==typeof t}function um(t){return t instanceof mg}const hm=Symbol("INITIAL_VALUE");function pm(){return Ip(t=>function(...t){let e=void 0,i=void 0;return k(t[t.length-1])&&(i=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&l(t[0])&&(t=t[0]),H(t,i).lift(new up(e))}(...t.map(t=>t.pipe(_p(1),function(...t){const e=t[t.length-1];return k(e)?(t.pop(),i=>Op(t,i,e)):e=>Op(t,e)}(hm)))).pipe(function(t,e){let i=!1;return arguments.length>=2&&(i=!0),function(n){return n.lift(new Gp(t,e,i))}}((t,e)=>{let i=!1;return e.reduce((t,n,r)=>{if(t!==hm)return t;if(n===hm&&(i=!0),!i){if(!1===n)return n;if(r===e.length-1||um(n))return n}return t},t)},hm),Wu(t=>t!==hm),D(t=>um(t)?t:!0===t),_p(1)))}class gm{constructor(t){this.segmentGroup=t||null}}class mm{constructor(t){this.urlTree=t}}function fm(t){return new b(e=>e.error(new gm(t)))}function vm(t){return new b(e=>e.error(new mm(t)))}function bm(t){return new b(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class ym{constructor(t,e,i,n,r){this.configLoader=e,this.urlSerializer=i,this.urlTree=n,this.config=r,this.allowRedirects=!0,this.ngModule=t.get(Wt)}apply(){return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,"primary").pipe(D(t=>this.createUrlTree(t,this.urlTree.queryParams,this.urlTree.fragment))).pipe(Nh(t=>{if(t instanceof mm)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof gm)throw this.noMatchError(t);throw t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,"primary").pipe(D(e=>this.createUrlTree(e,t.queryParams,t.fragment))).pipe(Nh(t=>{if(t instanceof gm)throw this.noMatchError(t);throw t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,i){const n=t.segments.length>0?new fg([],{primary:t}):t;return new mg(n,e,i)}expandSegmentGroup(t,e,i,n){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(t,e,i).pipe(D(t=>new fg([],t))):this.expandSegment(t,i,e,i.segments,n,!0)}expandChildren(t,e,i){return function(t,e){if(0===Object.keys(t).length)return zu({});const i=[],n=[],r={};return hg(t,(t,s)=>{const o=e(s,t).pipe(D(t=>r[s]=t));"primary"===s?i.push(o):n.push(o)}),zu.apply(null,i.concat(n)).pipe(vp(),function(t,e){const i=arguments.length>=2;return n=>n.pipe(t?Wu((e,i)=>t(e,i,n)):v,yp(1),i?Dp(e):wp(()=>new pp))}(),D(()=>r))}(i.children,(i,n)=>this.expandSegmentGroup(t,e,n,i))}expandSegment(t,e,i,n,r,s){return zu(...i).pipe(Qu(o=>this.expandSegmentAgainstRoute(t,e,i,o,n,r,s).pipe(Nh(t=>{if(t instanceof gm)return zu(null);throw t}))),Rp(t=>!!t),Nh((t,i)=>{if(t instanceof pp||"EmptyError"===t.name){if(this.noLeftoversInUrl(e,n,r))return zu(new fg([],{}));throw new gm(e)}throw t}))}noLeftoversInUrl(t,e,i){return 0===e.length&&!t.children[i]}expandSegmentAgainstRoute(t,e,i,n,r,s,o){return Am(n)!==s?fm(e):void 0===n.redirectTo?this.matchSegmentAgainstRoute(t,e,n,r):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,i,n,r,s):fm(e)}expandSegmentAgainstRouteUsingRedirect(t,e,i,n,r,s){return"**"===n.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,i,n,s):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,n,r,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,i,n){const r=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?vm(r):this.lineralizeSegments(i,r).pipe($(i=>{const r=new fg(i,{});return this.expandSegment(t,r,e,i,n,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,n,r,s){const{matched:o,consumedSegments:a,lastChild:l,positionalParamSegments:c}=Cm(e,n,r);if(!o)return fm(e);const d=this.applyRedirectCommands(a,n.redirectTo,c);return n.redirectTo.startsWith("/")?vm(d):this.lineralizeSegments(n,d).pipe($(n=>this.expandSegment(t,e,i,n.concat(r.slice(l)),s,!1)))}matchSegmentAgainstRoute(t,e,i,n){if("**"===i.path)return i.loadChildren?this.configLoader.load(t.injector,i).pipe(D(t=>(i._loadedConfig=t,new fg(n,{})))):zu(new fg(n,{}));const{matched:r,consumedSegments:s,lastChild:o}=Cm(e,i,n);if(!r)return fm(e);const a=n.slice(o);return this.getChildConfig(t,i,n).pipe($(t=>{const i=t.module,n=t.routes,{segmentGroup:r,slicedSegments:o}=function(t,e,i,n){return i.length>0&&function(t,e,i){return i.some(i=>wm(t,e,i)&&"primary"!==Am(i))}(t,i,n)?{segmentGroup:Vm(new fg(e,function(t,e){const i={};i.primary=e;for(const n of t)""===n.path&&"primary"!==Am(n)&&(i[Am(n)]=new fg([],{}));return i}(n,new fg(i,t.children)))),slicedSegments:[]}:0===i.length&&function(t,e,i){return i.some(i=>wm(t,e,i))}(t,i,n)?{segmentGroup:Vm(new fg(t.segments,function(t,e,i,n){const r={};for(const s of i)wm(t,e,s)&&!n[Am(s)]&&(r[Am(s)]=new fg([],{}));return Object.assign(Object.assign({},n),r)}(t,i,n,t.children))),slicedSegments:i}:{segmentGroup:t,slicedSegments:i}}(e,s,a,n);return 0===o.length&&r.hasChildren()?this.expandChildren(i,n,r).pipe(D(t=>new fg(s,t))):0===n.length&&0===o.length?zu(new fg(s,{})):this.expandSegment(i,r,n,o,"primary",!0).pipe(D(t=>new fg(s.concat(t.segments),t.children)))}))}getChildConfig(t,e,i){return e.children?zu(new cm(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?zu(e._loadedConfig):this.runCanLoadGuards(t.injector,e,i).pipe($(i=>i?this.configLoader.load(t.injector,e).pipe(D(t=>(e._loadedConfig=t,t))):function(t){return new b(e=>e.error(og(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):zu(new cm([],t))}runCanLoadGuards(t,e,i){const n=e.canLoad;return n&&0!==n.length?zu(n.map(n=>{const r=t.get(n);let s;if(function(t){return t&&dm(t.canLoad)}(r))s=r.canLoad(e,i);else{if(!dm(r))throw new Error("Invalid CanLoad guard");s=r(e,i)}return pg(s)})).pipe(pm(),Kh(t=>{if(!um(t))return;const e=og(`Redirecting to "${this.urlSerializer.serialize(t)}"`);throw e.url=t,e}),D(t=>!0===t)):zu(!0)}lineralizeSegments(t,e){let i=[],n=e.root;for(;;){if(i=i.concat(n.segments),0===n.numberOfChildren)return zu(i);if(n.numberOfChildren>1||!n.children.primary)return bm(t.redirectTo);n=n.children.primary}}applyRedirectCommands(t,e,i){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,i)}applyRedirectCreatreUrlTree(t,e,i,n){const r=this.createSegmentGroup(t,e.root,i,n);return new mg(r,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const i={};return hg(t,(t,n)=>{if("string"==typeof t&&t.startsWith(":")){const r=t.substring(1);i[n]=e[r]}else i[n]=t}),i}createSegmentGroup(t,e,i,n){const r=this.createSegments(t,e.segments,i,n);let s={};return hg(e.children,(e,r)=>{s[r]=this.createSegmentGroup(t,e,i,n)}),new fg(r,s)}createSegments(t,e,i,n){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,n):this.findOrReturn(e,i))}findPosParam(t,e,i){const n=i[e.path.substring(1)];if(!n)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return n}findOrReturn(t,e){let i=0;for(const n of e){if(n.path===t.path)return e.splice(i),n;i++}return t}}function Cm(t,e,i){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||i.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};const n=(e.matcher||ag)(i,t,e);return n?{matched:!0,consumedSegments:n.consumed,lastChild:n.consumed.length,positionalParamSegments:n.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function Vm(t){if(1===t.numberOfChildren&&t.children.primary){const e=t.children.primary;return new fg(t.segments.concat(e.segments),e.children)}return t}function wm(t,e,i){return(!(t.hasChildren()||e.length>0)||"full"!==i.pathMatch)&&""===i.path&&void 0!==i.redirectTo}function Am(t){return t.outlet||"primary"}class Pm{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class km{constructor(t,e){this.component=t,this.route=e}}function Dm(t,e,i){const n=t._root;return function t(e,i,n,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const o=jg(i);return e.children.forEach(e=>{!function(e,i,n,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const o=e.value,a=i?i.value:null,l=n?n.getContext(e.value.outlet):null;if(a&&o.routeConfig===a.routeConfig){const c=function(t,e,i){if("function"==typeof i)return i(t,e);switch(i){case"pathParamsChange":return!bg(t.url,e.url);case"pathParamsOrQueryParamsChange":return!bg(t.url,e.url)||!lg(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Wg(t,e)||!lg(t.queryParams,e.queryParams);case"paramsChange":default:return!Wg(t,e)}}(a,o,o.routeConfig.runGuardsAndResolvers);c?s.canActivateChecks.push(new Pm(r)):(o.data=a.data,o._resolvedData=a._resolvedData),t(e,i,o.component?l?l.children:null:n,r,s),c&&l&&l.outlet&&l.outlet.isActivated&&s.canDeactivateChecks.push(new km(l.outlet.component,a))}else a&&Sm(i,l,s),s.canActivateChecks.push(new Pm(r)),t(e,null,o.component?l?l.children:null:n,r,s)}(e,o[e.value.outlet],n,r.concat([e.value]),s),delete o[e.value.outlet]}),hg(o,(t,e)=>Sm(t,n.getContext(e),s)),s}(n,e?e._root:null,i,[n.value])}function Mm(t,e,i){const n=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(n?n.module.injector:i).get(t)}function Sm(t,e,i){const n=jg(t),r=t.value;hg(n,(t,n)=>{Sm(t,r.component?e?e.children.getContext(n):null:e,i)}),i.canDeactivateChecks.push(new km(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function Im(t,e){return null!==t&&e&&e(new eg(t)),zu(!0)}function xm(t,e){return null!==t&&e&&e(new Xp(t)),zu(!0)}function Tm(t,e,i){const n=e.routeConfig?e.routeConfig.canActivate:null;return n&&0!==n.length?zu(n.map(n=>fp(()=>{const r=Mm(n,e,i);let s;if(function(t){return t&&dm(t.canActivate)}(r))s=pg(r.canActivate(e,t));else{if(!dm(r))throw new Error("Invalid CanActivate guard");s=pg(r(e,t))}return s.pipe(Rp())}))).pipe(pm()):zu(!0)}function _m(t,e,i){const n=e[e.length-1],r=e.slice(0,e.length-1).reverse().map(t=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)).filter(t=>null!==t).map(e=>fp(()=>zu(e.guards.map(r=>{const s=Mm(r,e.node,i);let o;if(function(t){return t&&dm(t.canActivateChild)}(s))o=pg(s.canActivateChild(n,t));else{if(!dm(s))throw new Error("Invalid CanActivateChild guard");o=pg(s(n,t))}return o.pipe(Rp())})).pipe(pm())));return zu(r).pipe(pm())}class Um{}class Em{constructor(t,e,i,n,r,s){this.rootComponentType=t,this.config=e,this.urlTree=i,this.url=n,this.paramsInheritanceStrategy=r,this.relativeLinkResolution=s}recognize(){try{const t=Lm(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,"primary"),i=new Hg([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),n=new Rg(i,e),r=new Kg(this.url,n);return this.inheritParamsAndData(r._root),zu(r)}catch(t){return new b(e=>e.error(t))}}inheritParamsAndData(t){const e=t.value,i=Bg(e,this.paramsInheritanceStrategy);e.params=Object.freeze(i.params),e.data=Object.freeze(i.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,i){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,i)}processChildren(t,e){const i=yg(e,(e,i)=>this.processSegmentGroup(t,e,i));return function(t){const e={};t.forEach(t=>{const i=e[t.value.outlet];if(i){const e=i.url.map(t=>t.toString()).join("/"),n=t.value.url.map(t=>t.toString()).join("/");throw new Error(`Two segments cannot have the same outlet name: '${e}' and '${n}'.`)}e[t.value.outlet]=t.value})}(i),i.sort((t,e)=>"primary"===t.value.outlet?-1:"primary"===e.value.outlet?1:t.value.outlet.localeCompare(e.value.outlet)),i}processSegment(t,e,i,n){for(const s of t)try{return this.processSegmentAgainstRoute(s,e,i,n)}catch(r){if(!(r instanceof Um))throw r}if(this.noLeftoversInUrl(e,i,n))return[];throw new Um}noLeftoversInUrl(t,e,i){return 0===e.length&&!t.children[i]}processSegmentAgainstRoute(t,e,i,n){if(t.redirectTo)throw new Um;if((t.outlet||"primary")!==n)throw new Um;let r,s=[],o=[];if("**"===t.path){const s=i.length>0?ug(i).parameters:{};r=new Hg(i,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,$m(t),n,t.component,t,Om(e),Gm(e)+i.length,Nm(t))}else{const a=function(t,e,i){if(""===e.path){if("full"===e.pathMatch&&(t.hasChildren()||i.length>0))throw new Um;return{consumedSegments:[],lastChild:0,parameters:{}}}const n=(e.matcher||ag)(i,t,e);if(!n)throw new Um;const r={};hg(n.posParams,(t,e)=>{r[e]=t.path});const s=n.consumed.length>0?Object.assign(Object.assign({},r),n.consumed[n.consumed.length-1].parameters):r;return{consumedSegments:n.consumed,lastChild:n.consumed.length,parameters:s}}(e,t,i);s=a.consumedSegments,o=i.slice(a.lastChild),r=new Hg(s,a.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,$m(t),n,t.component,t,Om(e),Gm(e)+s.length,Nm(t))}const a=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:l,slicedSegments:c}=Lm(e,s,o,a,this.relativeLinkResolution);if(0===c.length&&l.hasChildren()){const t=this.processChildren(a,l);return[new Rg(r,t)]}if(0===a.length&&0===c.length)return[new Rg(r,[])];const d=this.processSegment(a,l,c,"primary");return[new Rg(r,d)]}}function Om(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function Gm(t){let e=t,i=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,i+=e._segmentIndexShift?e._segmentIndexShift:0;return i-1}function Lm(t,e,i,n,r){if(i.length>0&&function(t,e,i){return i.some(i=>Rm(t,e,i)&&"primary"!==jm(i))}(t,i,n)){const r=new fg(e,function(t,e,i,n){const r={};r.primary=n,n._sourceSegment=t,n._segmentIndexShift=e.length;for(const s of i)if(""===s.path&&"primary"!==jm(s)){const i=new fg([],{});i._sourceSegment=t,i._segmentIndexShift=e.length,r[jm(s)]=i}return r}(t,e,n,new fg(i,t.children)));return r._sourceSegment=t,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:[]}}if(0===i.length&&function(t,e,i){return i.some(i=>Rm(t,e,i))}(t,i,n)){const s=new fg(t.segments,function(t,e,i,n,r,s){const o={};for(const a of n)if(Rm(t,i,a)&&!r[jm(a)]){const i=new fg([],{});i._sourceSegment=t,i._segmentIndexShift="legacy"===s?t.segments.length:e.length,o[jm(a)]=i}return Object.assign(Object.assign({},r),o)}(t,e,i,n,t.children,r));return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:i}}const s=new fg(t.segments,t.children);return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:i}}function Rm(t,e,i){return(!(t.hasChildren()||e.length>0)||"full"!==i.pathMatch)&&""===i.path&&void 0===i.redirectTo}function jm(t){return t.outlet||"primary"}function $m(t){return t.data||{}}function Nm(t){return t.resolve||{}}function Fm(t){return function(e){return e.pipe(Ip(e=>{const i=t(e);return i?G(i).pipe(D(()=>e)):G([e])}))}}class Bm extends class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}let Hm=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=le({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&Bs(0,"router-outlet")},directives:function(){return[af]},encapsulation:2}),t})();function Km(t,e=""){for(let i=0;i<t.length;i++){const n=t[i];qm(n,zm(e,n))}}function qm(t,e){if(!t)throw new Error(`\n      Invalid configuration of route '${e}': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    `);if(Array.isArray(t))throw new Error(`Invalid configuration of route '${e}': Array cannot be specified`);if(!t.component&&!t.children&&!t.loadChildren&&t.outlet&&"primary"!==t.outlet)throw new Error(`Invalid configuration of route '${e}': a componentless route without children or loadChildren cannot have a named outlet set`);if(t.redirectTo&&t.children)throw new Error(`Invalid configuration of route '${e}': redirectTo and children cannot be used together`);if(t.redirectTo&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': redirectTo and loadChildren cannot be used together`);if(t.children&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': children and loadChildren cannot be used together`);if(t.redirectTo&&t.component)throw new Error(`Invalid configuration of route '${e}': redirectTo and component cannot be used together`);if(t.path&&t.matcher)throw new Error(`Invalid configuration of route '${e}': path and matcher cannot be used together`);if(void 0===t.redirectTo&&!t.component&&!t.children&&!t.loadChildren)throw new Error(`Invalid configuration of route '${e}'. One of the following must be provided: component, redirectTo, children or loadChildren`);if(void 0===t.path&&void 0===t.matcher)throw new Error(`Invalid configuration of route '${e}': routes must have either a path or a matcher specified`);if("string"==typeof t.path&&"/"===t.path.charAt(0))throw new Error(`Invalid configuration of route '${e}': path cannot start with a slash`);if(""===t.path&&void 0!==t.redirectTo&&void 0===t.pathMatch)throw new Error(`Invalid configuration of route '{path: "${e}", redirectTo: "${t.redirectTo}"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`);if(void 0!==t.pathMatch&&"full"!==t.pathMatch&&"prefix"!==t.pathMatch)throw new Error(`Invalid configuration of route '${e}': pathMatch can only be set to 'prefix' or 'full'`);t.children&&Km(t.children,e)}function zm(t,e){return e?t||e.path?t&&!e.path?t+"/":!t&&e.path?e.path:`${t}/${e.path}`:"":t}function Qm(t){const e=t.children&&t.children.map(Qm),i=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!i.component&&(e||i.loadChildren)&&i.outlet&&"primary"!==i.outlet&&(i.component=Hm),i}const Wm=new Ot("ROUTES");class Jm{constructor(t,e,i,n){this.loader=t,this.compiler=e,this.onLoadStartListener=i,this.onLoadEndListener=n}load(t,e){return this.onLoadStartListener&&this.onLoadStartListener(e),this.loadModuleFactory(e.loadChildren).pipe(D(i=>{this.onLoadEndListener&&this.onLoadEndListener(e);const n=i.create(t);return new cm(dg(n.injector.get(Wm)).map(Qm),n)}))}loadModuleFactory(t){return"string"==typeof t?G(this.loader.load(t)):pg(t()).pipe($(t=>t instanceof Jt?zu(t):G(this.compiler.compileModuleAsync(t))))}}class Ym{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Zm,this.attachRef=null}}class Zm{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const i=this.getOrCreateContext(t);i.outlet=e,this.contexts.set(t,i)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new Ym,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}class Xm{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function tf(t){throw t}function ef(t,e,i){return e.parse("/")}function nf(t,e){return zu(null)}let rf=(()=>{class t{constructor(t,e,i,n,r,s,o,a){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=i,this.location=n,this.config=a,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.lastLocationChangeInfo=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new A,this.errorHandler=tf,this.malformedUriErrorHandler=ef,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:nf,afterPreactivation:nf},this.urlHandlingStrategy=new Xm,this.routeReuseStrategy=new Bm,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=r.get(Wt),this.console=r.get(Qa);const l=r.get(al);this.isNgZoneEnabled=l instanceof al,this.resetConfig(a),this.currentUrlTree=new mg(new fg([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Jm(s,o,t=>this.triggerEvent(new Yp(t)),t=>this.triggerEvent(new Zp(t))),this.routerState=Ng(this.currentUrlTree,this.rootComponentType),this.transitions=new op({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(t){const e=this.events;return t.pipe(Wu(t=>0!==t.id),D(t=>Object.assign(Object.assign({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),Ip(t=>{let i=!1,n=!1;return zu(t).pipe(Kh(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Ip(t=>{const i=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||i)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return zu(t).pipe(Ip(t=>{const i=this.transitions.getValue();return e.next(new Fp(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),i!==this.transitions.getValue()?gp:[t]}),Ip(t=>Promise.resolve(t)),(n=this.ngModule.injector,r=this.configLoader,s=this.urlSerializer,o=this.config,function(t){return t.pipe(Ip(t=>function(t,e,i,n,r){return new ym(t,e,i,n,r).apply()}(n,r,s,t.extractedUrl,o).pipe(D(e=>Object.assign(Object.assign({},t),{urlAfterRedirects:e})))))}),Kh(t=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:t.urlAfterRedirects})}),function(t,e,i,n,r){return function(s){return s.pipe($(s=>function(t,e,i,n,r="emptyOnly",s="legacy"){return new Em(t,e,i,n,r,s).recognize()}(t,e,s.urlAfterRedirects,i(s.urlAfterRedirects),n,r).pipe(D(t=>Object.assign(Object.assign({},s),{targetSnapshot:t})))))}}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),Kh(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),Kh(t=>{const i=new qp(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(i)}));var n,r,s,o;if(i&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:i,extractedUrl:n,source:r,restoredState:s,extras:o}=t,a=new Fp(i,this.serializeUrl(n),r,s);e.next(a);const l=Ng(n,this.rootComponentType).snapshot;return zu(Object.assign(Object.assign({},t),{targetSnapshot:l,urlAfterRedirects:n,extras:Object.assign(Object.assign({},o),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),gp}),Fm(t=>{const{targetSnapshot:e,id:i,extractedUrl:n,rawUrl:r,extras:{skipLocationChange:s,replaceUrl:o}}=t;return this.hooks.beforePreactivation(e,{navigationId:i,appliedUrlTree:n,rawUrlTree:r,skipLocationChange:!!s,replaceUrl:!!o})}),Kh(t=>{const e=new zp(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),D(t=>Object.assign(Object.assign({},t),{guards:Dm(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return function(i){return i.pipe($(i=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=i;return 0===o.length&&0===s.length?zu(Object.assign(Object.assign({},i),{guardsResult:!0})):function(t,e,i,n){return G(t).pipe($(t=>function(t,e,i,n,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?zu(s.map(s=>{const o=Mm(s,e,r);let a;if(function(t){return t&&dm(t.canDeactivate)}(o))a=pg(o.canDeactivate(t,e,i,n));else{if(!dm(o))throw new Error("Invalid CanDeactivate guard");a=pg(o(t,e,i,n))}return a.pipe(Rp())})).pipe(pm()):zu(!0)}(t.component,t.route,i,e,n)),Rp(t=>!0!==t,!0))}(o,n,r,t).pipe($(i=>i&&"boolean"==typeof i?function(t,e,i,n){return G(e).pipe(Qu(e=>G([xm(e.route.parent,n),Im(e.route,n),_m(t,e.path,i),Tm(t,e.route,i)]).pipe(vp(),Rp(t=>!0!==t,!0))),Rp(t=>!0!==t,!0))}(n,s,t,e):zu(i)),D(t=>Object.assign(Object.assign({},i),{guardsResult:t})))}))}}(this.ngModule.injector,t=>this.triggerEvent(t)),Kh(t=>{if(um(t.guardsResult)){const e=og(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}}),Kh(t=>{const e=new Qp(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),Wu(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const i=new Hp(t.id,this.serializeUrl(t.extractedUrl),"");return e.next(i),t.resolve(!1),!1}return!0}),Fm(t=>{if(t.guards.canActivateChecks.length)return zu(t).pipe(Kh(t=>{const e=new Wp(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),Ip(t=>{let i=!1;return zu(t).pipe((n=this.paramsInheritanceStrategy,r=this.ngModule.injector,function(t){return t.pipe($(t=>{const{targetSnapshot:e,guards:{canActivateChecks:i}}=t;if(!i.length)return zu(t);let s=0;return G(i).pipe(Qu(t=>function(t,e,i,n){return function(t,e,i,n){const r=Object.keys(t);if(0===r.length)return zu({});const s={};return G(r).pipe($(r=>function(t,e,i,n){const r=Mm(t,e,n);return pg(r.resolve?r.resolve(e,i):r(e,i))}(t[r],e,i,n).pipe(Kh(t=>{s[r]=t}))),yp(1),$(()=>Object.keys(s).length===r.length?zu(s):gp))}(t._resolve,t,e,n).pipe(D(e=>(t._resolvedData=e,t.data=Object.assign(Object.assign({},t.data),Bg(t,i).resolve),null)))}(t.route,e,n,r)),Kh(()=>s++),yp(1),$(e=>s===i.length?zu(t):gp))}))}),Kh({next:()=>i=!0,complete:()=>{if(!i){const i=new Hp(t.id,this.serializeUrl(t.extractedUrl),"At least one route resolver didn't emit any value.");e.next(i),t.resolve(!1)}}}));var n,r}),Kh(t=>{const e=new Jp(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}))}),Fm(t=>{const{targetSnapshot:e,id:i,extractedUrl:n,rawUrl:r,extras:{skipLocationChange:s,replaceUrl:o}}=t;return this.hooks.afterPreactivation(e,{navigationId:i,appliedUrlTree:n,rawUrlTree:r,skipLocationChange:!!s,replaceUrl:!!o})}),D(t=>{const e=function(t,e,i){const n=function t(e,i,n){if(n&&e.shouldReuseRoute(i.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=i.value;const s=function(e,i,n){return i.children.map(i=>{for(const r of n.children)if(e.shouldReuseRoute(r.value.snapshot,i.value))return t(e,i,r);return t(e,i)})}(e,i,n);return new Rg(r,s)}{const n=e.retrieve(i.value);if(n){const t=n.route;return function t(e,i){if(e.value.routeConfig!==i.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==i.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");i.value._futureSnapshot=e.value;for(let n=0;n<e.children.length;++n)t(e.children[n],i.children[n])}(i,t),t}{const n=new Fg(new op((r=i.value).url),new op(r.params),new op(r.queryParams),new op(r.fragment),new op(r.data),r.outlet,r.component,r),s=i.children.map(i=>t(e,i));return new Rg(n,s)}}var r}(t,e._root,i?i._root:void 0);return new $g(n,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign(Object.assign({},t),{targetRouterState:e})}),Kh(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),(s=this.rootContexts,o=this.routeReuseStrategy,a=t=>this.triggerEvent(t),D(t=>(new am(o,t.targetRouterState,t.currentRouterState,a).activate(s),t))),Kh({next(){i=!0},complete(){i=!0}}),(r=()=>{if(!i&&!n){this.resetUrlToCurrentUrlTree();const i=new Hp(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);e.next(i),t.resolve(!1)}this.currentNavigation=null},t=>t.lift(new jp(r))),Nh(i=>{if(n=!0,(r=i)&&r.ngNavigationCancelingError){const n=um(i.url);n||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const r=new Hp(t.id,this.serializeUrl(t.extractedUrl),i.message);e.next(r),n?setTimeout(()=>{const e=this.urlHandlingStrategy.merge(i.url,this.rawUrlTree);return this.scheduleNavigation(e,"imperative",null,{skipLocationChange:t.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:t.resolve,reject:t.reject,promise:t.promise})},0):t.resolve(!1)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const n=new Kp(t.id,this.serializeUrl(t.extractedUrl),i);e.next(n);try{t.resolve(this.errorHandler(i))}catch(s){t.reject(s)}}var r;return gp}));var r,s,o,a}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const e=this.extractLocationChangeInfoFromEvent(t);this.shouldScheduleNavigation(this.lastLocationChangeInfo,e)&&setTimeout(()=>{const{source:t,state:i,urlTree:n}=e,r={replaceUrl:!0};if(i){const t=Object.assign({},i);delete t.navigationId,0!==Object.keys(t).length&&(r.state=t)}this.scheduleNavigation(n,t,i,r)},0),this.lastLocationChangeInfo=e}))}extractLocationChangeInfoFromEvent(t){var e;return{source:"popstate"===t.type?"popstate":"hashchange",urlTree:this.parseUrl(t.url),state:(null===(e=t.state)||void 0===e?void 0:e.navigationId)?t.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(t,e){if(!t)return!0;const i=e.urlTree.toString()===t.urlTree.toString();return!(e.transitionId===t.transitionId&&i&&("hashchange"===e.source&&"popstate"===t.source||"popstate"===e.source&&"hashchange"===t.source))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){Km(t),this.config=t.map(Qm),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0)}createUrlTree(t,e={}){const{relativeTo:i,queryParams:n,fragment:r,preserveQueryParams:s,queryParamsHandling:o,preserveFragment:a}=e;un()&&s&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");const l=i||this.routerState.root,c=a?this.currentUrlTree.fragment:r;let d=null;if(o)switch(o){case"merge":d=Object.assign(Object.assign({},this.currentUrlTree.queryParams),n);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=n||null}else d=s?this.currentUrlTree.queryParams:n||null;return null!==d&&(d=this.removeEmptyProps(d)),function(t,e,i,n,r){if(0===i.length)return Zg(e.root,e.root,e,n,r);const s=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new Xg(!0,0,t);let e=0,i=!1;const n=t.reduce((t,n,r)=>{if("object"==typeof n&&null!=n){if(n.outlets){const e={};return hg(n.outlets,(t,i)=>{e[i]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(n.segmentPath)return[...t,n.segmentPath]}return"string"!=typeof n?[...t,n]:0===r?(n.split("/").forEach((n,r)=>{0==r&&"."===n||(0==r&&""===n?i=!0:".."===n?e++:""!=n&&t.push(n))}),t):[...t,n]},[]);return new Xg(i,e,n)}(i);if(s.toRoot())return Zg(e.root,new fg([],{}),e,n,r);const o=function(t,e,i){if(t.isAbsolute)return new tm(e.root,!0,0);if(-1===i.snapshot._lastPathIndex){const t=i.snapshot._urlSegment;return new tm(t,t===e.root,0)}const n=Jg(t.commands[0])?0:1;return function(t,e,i){let n=t,r=e,s=i;for(;s>r;){if(s-=r,n=n.parent,!n)throw new Error("Invalid number of '../'");r=n.segments.length}return new tm(n,!1,r-s)}(i.snapshot._urlSegment,i.snapshot._lastPathIndex+n,t.numberOfDoubleDots)}(s,e,t),a=o.processChildren?im(o.segmentGroup,o.index,s.commands):em(o.segmentGroup,o.index,s.commands);return Zg(o.segmentGroup,a,e,n,r)}(l,this.currentUrlTree,t,d,c)}navigateByUrl(t,e={skipLocationChange:!1}){un()&&this.isNgZoneEnabled&&!al.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");const i=um(t)?t:this.parseUrl(t),n=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(n,"imperative",null,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const i=t[e];if(null==i)throw new Error(`The requested path contains ${i} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(i){e=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return e}isActive(t,e){if(um(t))return gg(this.currentUrlTree,t,e);const i=this.parseUrl(t);return gg(this.currentUrlTree,i,e)}removeEmptyProps(t){return Object.keys(t).reduce((e,i)=>{const n=t[i];return null!=n&&(e[i]=n),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new Bp(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,e,i,n,r){const s=this.getTransition(),o="imperative"!==e&&"imperative"===(null==s?void 0:s.source),a=(this.lastSuccessfulId===s.id||this.currentNavigation?s.rawUrl:s.urlAfterRedirects).toString()===t.toString();if(o&&a)return Promise.resolve(!0);let l,c,d;r?(l=r.resolve,c=r.reject,d=r.promise):d=new Promise((t,e)=>{l=t,c=e});const u=++this.navigationId;return this.setTransition({id:u,source:e,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:n,resolve:l,reject:c,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(t=>Promise.reject(t))}setBrowserUrl(t,e,i,n){const r=this.urlSerializer.serialize(t);n=n||{},this.location.isCurrentPathEqualTo(r)||e?this.location.replaceState(r,"",Object.assign(Object.assign({},n),{navigationId:i})):this.location.go(r,"",Object.assign(Object.assign({},n),{navigationId:i}))}resetStateAndUrl(t,e,i){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}return t.\u0275fac=function(e){return new(e||t)(Kt(Yr),Kt(Cg),Kt(Zm),Kt(Xl),Kt(hs),Kt(Sl),Kt(rl),Kt(void 0))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),sf=(()=>{class t{constructor(t,e,i){this.router=t,this.route=e,this.locationStrategy=i,this.commands=[],this.onChanges=new A,this.subscription=t.events.subscribe(t=>{t instanceof Bp&&this.updateTargetUrlAndHref()})}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:[]}set preserveQueryParams(t){un()&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead."),this.preserve=t}ngOnChanges(t){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,e,i,n,r){if(0!==t||e||i||n||r)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;const s={skipLocationChange:of(this.skipLocationChange),replaceUrl:of(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,s),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:of(this.preserve),queryParamsHandling:this.queryParamsHandling,preserveFragment:of(this.preserveFragment)})}}return t.\u0275fac=function(e){return new(e||t)(Rs(rf),Rs(Fg),Rs(Ql))},t.\u0275dir=ge({type:t,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(t,e){1&t&&Js("click",(function(t){return e.onClick(t.button,t.ctrlKey,t.shiftKey,t.altKey,t.metaKey)})),2&t&&(Vo("href",e.href,mn),_s("target",e.target))},inputs:{routerLink:"routerLink",preserveQueryParams:"preserveQueryParams",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state"},features:[_e]}),t})();function of(t){return""===t||!!t}let af=(()=>{class t{constructor(t,e,i,n,r){this.parentContexts=t,this.location=e,this.resolver=i,this.changeDetector=r,this.activated=null,this._activatedRoute=null,this.activateEvents=new Ra,this.deactivateEvents=new Ra,this.name=n||"primary",t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const i=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),n=this.parentContexts.getOrCreateContext(this.name).children,r=new lf(t,n,this.location.injector);this.activated=this.location.createComponent(i,this.location.length,r),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Zm),Rs(pa),Rs($o),("name",function(t,e){const i=t.attrs;if(i){const t=i.length;let e=0;for(;e<t;){const n=i[e];if(Ui(n))break;if(0===n)e+=2;else if("number"==typeof n)for(e++;e<t&&"string"==typeof i[e];)e++;else{if("name"===n)return i[e+1];e+=2}}}return null}(ii())),Rs(Wr))},t.\u0275dir=ge({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),t})();class lf{constructor(t,e,i){this.route=t,this.childContexts=e,this.parent=i}get(t,e){return t===Fg?this.route:t===Zm?this.childContexts:this.parent.get(t,e)}}class cf{}class df{preload(t,e){return zu(null)}}let uf=(()=>{class t{constructor(t,e,i,n,r){this.router=t,this.injector=n,this.preloadingStrategy=r,this.loader=new Jm(e,i,e=>t.triggerEvent(new Yp(e)),e=>t.triggerEvent(new Zp(e)))}setUpPreloading(){this.subscription=this.router.events.pipe(Wu(t=>t instanceof Bp),Qu(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(Wt);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,e){const i=[];for(const n of e)if(n.loadChildren&&!n.canLoad&&n._loadedConfig){const t=n._loadedConfig;i.push(this.processRoutes(t.module,t.routes))}else n.loadChildren&&!n.canLoad?i.push(this.preloadConfig(t,n)):n.children&&i.push(this.processRoutes(t,n.children));return G(i).pipe(B(),D(t=>{}))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>this.loader.load(t.injector,e).pipe($(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}return t.\u0275fac=function(e){return new(e||t)(Kt(rf),Kt(Sl),Kt(rl),Kt(hs),Kt(cf))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),hf=(()=>{class t{constructor(t,e,i={}){this.router=t,this.viewportScroller=e,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Fp?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Bp&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof ng&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new ng(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(Kt(rf),Kt(Wc),Kt(void 0))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const pf=new Ot("ROUTER_CONFIGURATION"),gf=new Ot("ROUTER_FORROOT_GUARD"),mf=[Xl,{provide:Cg,useClass:Vg},{provide:rf,useFactory:function(t,e,i,n,r,s,o,a={},l,c){const d=new rf(null,t,e,i,n,r,s,dg(o));if(l&&(d.urlHandlingStrategy=l),c&&(d.routeReuseStrategy=c),a.errorHandler&&(d.errorHandler=a.errorHandler),a.malformedUriErrorHandler&&(d.malformedUriErrorHandler=a.malformedUriErrorHandler),a.enableTracing){const t=Ll();d.events.subscribe(e=>{t.logGroup("Router Event: "+e.constructor.name),t.log(e.toString()),t.log(e),t.logGroupEnd()})}return a.onSameUrlNavigation&&(d.onSameUrlNavigation=a.onSameUrlNavigation),a.paramsInheritanceStrategy&&(d.paramsInheritanceStrategy=a.paramsInheritanceStrategy),a.urlUpdateStrategy&&(d.urlUpdateStrategy=a.urlUpdateStrategy),a.relativeLinkResolution&&(d.relativeLinkResolution=a.relativeLinkResolution),d},deps:[Cg,Zm,Xl,hs,Sl,rl,Wm,pf,[class{},new et],[class{},new et]]},Zm,{provide:Fg,useFactory:function(t){return t.routerState.root},deps:[rf]},{provide:Sl,useClass:Tl},uf,df,class{preload(t,e){return e().pipe(Nh(()=>zu(null)))}},{provide:pf,useValue:{enableTracing:!1}}];function ff(){return new Vl("Router",rf)}let vf=(()=>{class t{constructor(t,e){}static forRoot(e,i){return{ngModule:t,providers:[mf,Vf(e),{provide:gf,useFactory:Cf,deps:[[rf,new et,new nt]]},{provide:pf,useValue:i||{}},{provide:Ql,useFactory:yf,deps:[jl,[new tt(Jl),new et],pf]},{provide:hf,useFactory:bf,deps:[rf,Wc,pf]},{provide:cf,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:df},{provide:Vl,multi:!0,useFactory:ff},[wf,{provide:$a,multi:!0,useFactory:Af,deps:[wf]},{provide:kf,useFactory:Pf,deps:[wf]},{provide:za,multi:!0,useExisting:kf}]]}}static forChild(e){return{ngModule:t,providers:[Vf(e)]}}}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)(Kt(gf,8),Kt(rf,8))}}),t})();function bf(t,e,i){return i.scrollOffset&&e.setOffset(i.scrollOffset),new hf(t,e,i)}function yf(t,e,i={}){return i.useHash?new Zl(t,e):new Yl(t,e)}function Cf(t){if(t)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Vf(t){return[{provide:ps,multi:!0,useValue:t},{provide:Wm,multi:!0,useValue:t}]}let wf=(()=>{class t{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new A}appInitializer(){return this.injector.get(Nl,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),i=this.injector.get(rf),n=this.injector.get(pf);if(this.isLegacyDisabled(n)||this.isLegacyEnabled(n))t(!0);else if("disabled"===n.initialNavigation)i.setUpLocationChangeListener(),t(!0);else{if("enabled"!==n.initialNavigation)throw new Error(`Invalid initialNavigation options: '${n.initialNavigation}'`);i.hooks.afterPreactivation=()=>this.initNavigation?zu(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),i.initialNavigation()}return e})}bootstrapListener(t){const e=this.injector.get(pf),i=this.injector.get(uf),n=this.injector.get(hf),r=this.injector.get(rf),s=this.injector.get(Dl);t===s.components[0]&&(this.isLegacyEnabled(e)?r.initialNavigation():this.isLegacyDisabled(e)&&r.setUpLocationChangeListener(),i.setUpPreloading(),n.init(),r.resetRootComponentType(s.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}isLegacyEnabled(t){return"legacy_enabled"===t.initialNavigation||!0===t.initialNavigation||void 0===t.initialNavigation}isLegacyDisabled(t){return"legacy_disabled"===t.initialNavigation||!1===t.initialNavigation}}return t.\u0275fac=function(e){return new(e||t)(Kt(hs))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function Af(t){return t.appInitializer.bind(t)}function Pf(t){return t.bootstrapListener.bind(t)}const kf=new Ot("Router Initializer");let Df=(()=>{class t{constructor(t){this.router=t,this.subject=new A,this.keepAfterNavigationChange=!1,t.events.subscribe(t=>{t instanceof Fp&&(this.keepAfterNavigationChange?this.keepAfterNavigationChange=!1:this.subject.next())})}clear(){this.subject.next()}success(t,e=!1){this.keepAfterNavigationChange=e,this.subject.next({type:"success",text:t})}error(t,e=!1){t||(t="Unknown Error reaching the Server"),this.keepAfterNavigationChange=e,this.subject.next({type:"error",text:t})}getMessage(){return this.subject.asObservable()}}return t.\u0275fac=function(e){return new(e||t)(Kt(rf))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function Mf(t){return!!t&&(t instanceof b||"function"==typeof t.lift&&"function"==typeof t.subscribe)}class Sf extends u{constructor(t,e){super()}schedule(t,e=0){return this}}class If extends Sf{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this}requestAsyncId(t,e,i=0){return setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let i=!1,n=void 0;try{this.work(t)}catch(r){i=!0,n=!!r&&r||new Error(r)}if(i)return this.unsubscribe(),n}_unsubscribe(){const t=this.id,e=this.scheduler,i=e.actions,n=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&i.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}class xf extends If{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(t,e,i):t.flush(this)}}let Tf=(()=>{class t{constructor(e,i=t.now){this.SchedulerAction=e,this.now=i}schedule(t,e=0,i){return new this.SchedulerAction(this,t).schedule(i,e)}}return t.now=()=>Date.now(),t})();class _f extends Tf{constructor(t,e=Tf.now){super(t,()=>_f.delegate&&_f.delegate!==this?_f.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,i){return _f.delegate&&_f.delegate!==this?_f.delegate.schedule(t,e,i):super.schedule(t,e,i)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let i;this.active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}class Uf extends _f{}const Ef=new Uf(xf);let Of=(()=>{class t{constructor(t,e,i){this.kind=t,this.value=e,this.error=i,this.hasValue="N"===t}observe(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}}do(t,e,i){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return i&&i()}}accept(t,e,i){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,i)}toObservable(){switch(this.kind){case"N":return zu(this.value);case"E":return jh(this.error);case"C":return mp()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new t("N",e):t.undefinedValueNotification}static createError(e){return new t("E",void 0,e)}static createComplete(){return t.completeNotification}}return t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t})();class Gf extends g{constructor(t,e,i=0){super(t),this.scheduler=e,this.delay=i}static dispatch(t){const{notification:e,destination:i}=t;e.observe(i),this.unsubscribe()}scheduleMessage(t){this.destination.add(this.scheduler.schedule(Gf.dispatch,this.delay,new Lf(t,this.destination)))}_next(t){this.scheduleMessage(Of.createNext(t))}_error(t){this.scheduleMessage(Of.createError(t)),this.unsubscribe()}_complete(){this.scheduleMessage(Of.createComplete()),this.unsubscribe()}}class Lf{constructor(t,e){this.notification=t,this.destination=e}}class Rf extends A{constructor(t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=t<1?1:t,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(t){if(!this.isStopped){const e=this._events;e.push(t),e.length>this._bufferSize&&e.shift()}super.next(t)}nextTimeWindow(t){this.isStopped||(this._events.push(new jf(this._getNow(),t)),this._trimBufferThenGetEvents()),super.next(t)}_subscribe(t){const e=this._infiniteTimeWindow,i=e?this._events:this._trimBufferThenGetEvents(),n=this.scheduler,r=i.length;let s;if(this.closed)throw new C;if(this.isStopped||this.hasError?s=u.EMPTY:(this.observers.push(t),s=new V(this,t)),n&&t.add(t=new Gf(t,n)),e)for(let o=0;o<r&&!t.closed;o++)t.next(i[o]);else for(let o=0;o<r&&!t.closed;o++)t.next(i[o].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),s}_getNow(){return(this.scheduler||Ef).now()}_trimBufferThenGetEvents(){const t=this._getNow(),e=this._bufferSize,i=this._windowTime,n=this._events,r=n.length;let s=0;for(;s<r&&!(t-n[s].time<i);)s++;return r>e&&(s=Math.max(s,r-e)),s>0&&n.splice(0,s),n}}class jf{constructor(t,e){this.time=t,this.value=e}}function $f(t,e,i){let n;return n=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:i},t=>t.lift(function({bufferSize:t=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:i,scheduler:n}){let r,s,o=0,a=!1,l=!1;return function(c){let d;o++,!r||a?(a=!1,r=new Rf(t,e,n),d=r.subscribe(this),s=c.subscribe({next(t){r.next(t)},error(t){a=!0,r.error(t)},complete(){l=!0,s=void 0,r.complete()}})):d=r.subscribe(this),this.add(()=>{o--,d.unsubscribe(),s&&!l&&i&&0===o&&(s.unsubscribe(),s=void 0,r=void 0)})}}(n))}class Nf{}let Ff=(()=>{class t extends Nf{getTranslation(t){return zu({})}}return t.\u0275fac=function(e){return Bf(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Bf=nn(Ff);class Hf{}let Kf=(()=>{class t{handle(t){return t.key}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function qf(t,e){if(t===e)return!0;if(null===t||null===e)return!1;if(t!=t&&e!=e)return!0;let i,n,r,s=typeof t;if(s==typeof e&&"object"==s){if(!Array.isArray(t)){if(Array.isArray(e))return!1;for(n in r=Object.create(null),t){if(!qf(t[n],e[n]))return!1;r[n]=!0}for(n in e)if(!(n in r)&&void 0!==e[n])return!1;return!0}if(!Array.isArray(e))return!1;if((i=t.length)==e.length){for(n=0;n<i;n++)if(!qf(t[n],e[n]))return!1;return!0}}return!1}function zf(t){return null!=t}function Qf(t){return t&&"object"==typeof t&&!Array.isArray(t)}class Wf{}let Jf=(()=>{class t extends Wf{constructor(){super(...arguments),this.templateMatcher=/{{\s?([^{}\s]*)\s?}}/g}interpolate(t,e){let i;return i="string"==typeof t?this.interpolateString(t,e):"function"==typeof t?this.interpolateFunction(t,e):t,i}getValue(t,e){let i="string"==typeof e?e.split("."):[e];e="";do{e+=i.shift(),!zf(t)||!zf(t[e])||"object"!=typeof t[e]&&i.length?i.length?e+=".":t=void 0:(t=t[e],e="")}while(i.length);return t}interpolateFunction(t,e){return t(e)}interpolateString(t,e){return e?t.replace(this.templateMatcher,(t,i)=>{let n=this.getValue(e,i);return zf(n)?n:t}):t}}return t.\u0275fac=function(e){return Yf(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Yf=nn(Jf);class Zf{}let Xf=(()=>{class t extends Zf{compile(t,e){return t}compileTranslations(t,e){return t}}return t.\u0275fac=function(e){return tv(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const tv=nn(Xf);class ev{constructor(){this.currentLang=this.defaultLang,this.translations={},this.langs=[],this.onTranslationChange=new Ra,this.onLangChange=new Ra,this.onDefaultLangChange=new Ra}}const iv=new Ot("USE_STORE"),nv=new Ot("USE_DEFAULT_LANG"),rv=new Ot("DEFAULT_LANGUAGE"),sv=new Ot("USE_EXTEND");let ov=(()=>{class t{constructor(t,e,i,n,r,s=!0,o=!1,a=!1,l){this.store=t,this.currentLoader=e,this.compiler=i,this.parser=n,this.missingTranslationHandler=r,this.useDefaultLang=s,this.isolate=o,this.extend=a,this.pending=!1,this._onTranslationChange=new Ra,this._onLangChange=new Ra,this._onDefaultLangChange=new Ra,this._langs=[],this._translations={},this._translationRequests={},l&&this.setDefaultLang(l)}get onTranslationChange(){return this.isolate?this._onTranslationChange:this.store.onTranslationChange}get onLangChange(){return this.isolate?this._onLangChange:this.store.onLangChange}get onDefaultLangChange(){return this.isolate?this._onDefaultLangChange:this.store.onDefaultLangChange}get defaultLang(){return this.isolate?this._defaultLang:this.store.defaultLang}set defaultLang(t){this.isolate?this._defaultLang=t:this.store.defaultLang=t}get currentLang(){return this.isolate?this._currentLang:this.store.currentLang}set currentLang(t){this.isolate?this._currentLang=t:this.store.currentLang=t}get langs(){return this.isolate?this._langs:this.store.langs}set langs(t){this.isolate?this._langs=t:this.store.langs=t}get translations(){return this.isolate?this._translations:this.store.translations}set translations(t){this.isolate?this._translations=t:this.store.translations=t}setDefaultLang(t){if(t===this.defaultLang)return;let e=this.retrieveTranslations(t);void 0!==e?(null==this.defaultLang&&(this.defaultLang=t),e.pipe(_p(1)).subscribe(e=>{this.changeDefaultLang(t)})):this.changeDefaultLang(t)}getDefaultLang(){return this.defaultLang}use(t){if(t===this.currentLang)return zu(this.translations[t]);let e=this.retrieveTranslations(t);return void 0!==e?(this.currentLang||(this.currentLang=t),e.pipe(_p(1)).subscribe(e=>{this.changeLang(t)}),e):(this.changeLang(t),zu(this.translations[t]))}retrieveTranslations(t){let e;return(void 0===this.translations[t]||this.extend)&&(this._translationRequests[t]=this._translationRequests[t]||this.getTranslation(t),e=this._translationRequests[t]),e}getTranslation(t){this.pending=!0;const e=this.currentLoader.getTranslation(t).pipe($f(1),_p(1));return this.loadingTranslations=e.pipe(D(e=>this.compiler.compileTranslations(e,t)),$f(1),_p(1)),this.loadingTranslations.subscribe({next:e=>{this.translations[t]=this.extend&&this.translations[t]?Object.assign(Object.assign({},e),this.translations[t]):e,this.updateLangs(),this.pending=!1},error:t=>{this.pending=!1}}),e}setTranslation(t,e,i=!1){e=this.compiler.compileTranslations(e,t),this.translations[t]=(i||this.extend)&&this.translations[t]?function t(e,i){let n=Object.assign({},e);return Qf(e)&&Qf(i)&&Object.keys(i).forEach(r=>{Qf(i[r])?r in e?n[r]=t(e[r],i[r]):Object.assign(n,{[r]:i[r]}):Object.assign(n,{[r]:i[r]})}),n}(this.translations[t],e):e,this.updateLangs(),this.onTranslationChange.emit({lang:t,translations:this.translations[t]})}getLangs(){return this.langs}addLangs(t){t.forEach(t=>{-1===this.langs.indexOf(t)&&this.langs.push(t)})}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResult(t,e,i){let n;if(e instanceof Array){let n={},r=!1;for(let s of e)n[s]=this.getParsedResult(t,s,i),Mf(n[s])&&(r=!0);return r?Sd(e.map(t=>Mf(n[t])?n[t]:zu(n[t]))).pipe(D(t=>{let i={};return t.forEach((t,n)=>{i[e[n]]=t}),i})):n}if(t&&(n=this.parser.interpolate(this.parser.getValue(t,e),i)),void 0===n&&null!=this.defaultLang&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(n=this.parser.interpolate(this.parser.getValue(this.translations[this.defaultLang],e),i)),void 0===n){let t={key:e,translateService:this};void 0!==i&&(t.interpolateParams=i),n=this.missingTranslationHandler.handle(t)}return void 0!==n?n:e}get(t,e){if(!zf(t)||!t.length)throw new Error('Parameter "key" required');if(this.pending)return this.loadingTranslations.pipe(Qu(i=>Mf(i=this.getParsedResult(i,t,e))?i:zu(i)));{let i=this.getParsedResult(this.translations[this.currentLang],t,e);return Mf(i)?i:zu(i)}}getStreamOnTranslationChange(t,e){if(!zf(t)||!t.length)throw new Error('Parameter "key" required');return Op(fp(()=>this.get(t,e)),this.onTranslationChange.pipe(Ip(i=>{const n=this.getParsedResult(i.translations,t,e);return"function"==typeof n.subscribe?n:zu(n)})))}stream(t,e){if(!zf(t)||!t.length)throw new Error('Parameter "key" required');return Op(fp(()=>this.get(t,e)),this.onLangChange.pipe(Ip(i=>{const n=this.getParsedResult(i.translations,t,e);return Mf(n)?n:zu(n)})))}instant(t,e){if(!zf(t)||!t.length)throw new Error('Parameter "key" required');let i=this.getParsedResult(this.translations[this.currentLang],t,e);if(Mf(i)){if(t instanceof Array){let e={};return t.forEach((i,n)=>{e[t[n]]=t[n]}),e}return t}return i}set(t,e,i=this.currentLang){this.translations[i][t]=this.compiler.compile(e,i),this.updateLangs(),this.onTranslationChange.emit({lang:i,translations:this.translations[i]})}changeLang(t){this.currentLang=t,this.onLangChange.emit({lang:t,translations:this.translations[t]}),null==this.defaultLang&&this.changeDefaultLang(t)}changeDefaultLang(t){this.defaultLang=t,this.onDefaultLangChange.emit({lang:t,translations:this.translations[t]})}reloadLang(t){return this.resetLang(t),this.getTranslation(t)}resetLang(t){this._translationRequests[t]=void 0,this.translations[t]=void 0}getBrowserLang(){if("undefined"==typeof window||void 0===window.navigator)return;let t=window.navigator.languages?window.navigator.languages[0]:null;return t=t||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,void 0!==t?(-1!==t.indexOf("-")&&(t=t.split("-")[0]),-1!==t.indexOf("_")&&(t=t.split("_")[0]),t):void 0}getBrowserCultureLang(){if("undefined"==typeof window||void 0===window.navigator)return;let t=window.navigator.languages?window.navigator.languages[0]:null;return t=t||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,t}}return t.\u0275fac=function(e){return new(e||t)(Kt(ev),Kt(Nf),Kt(Zf),Kt(Wf),Kt(Hf),Kt(nv),Kt(iv),Kt(sv),Kt(rv))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),av=(()=>{class t{constructor(t,e){this.translate=t,this._ref=e,this.value=""}updateValue(t,e,i){let n=e=>{this.value=void 0!==e?e:t,this.lastKey=t,this._ref.markForCheck()};if(i){let r=this.translate.getParsedResult(i,t,e);Mf(r.subscribe)?r.subscribe(n):n(r)}this.translate.get(t,e).subscribe(n)}transform(t,...e){if(!t||!t.length)return t;if(qf(t,this.lastKey)&&qf(e,this.lastParams))return this.value;let i;if(zf(e[0])&&e.length)if("string"==typeof e[0]&&e[0].length){let t=e[0].replace(/(\')?([a-zA-Z0-9_]+)(\')?(\s)?:/g,'"$2":').replace(/:(\s)?(\')(.*?)(\')/g,':"$3"');try{i=JSON.parse(t)}catch(n){throw new SyntaxError("Wrong parameter in TranslatePipe. Expected a valid Object, received: "+e[0])}}else"object"!=typeof e[0]||Array.isArray(e[0])||(i=e[0]);return this.lastKey=t,this.lastParams=e,this.updateValue(t,i),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(e=>{this.lastKey&&e.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(t,i,e.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(e=>{this.lastKey&&(this.lastKey=null,this.updateValue(t,i,e.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(t,i))})),this.value}_dispose(){void 0!==this.onTranslationChange&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),void 0!==this.onLangChange&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),void 0!==this.onDefaultLangChange&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}}return t.\u0275fac=function(e){return new(e||t)(Rs(ov),function(t=rt.Default){const e=Qr(!0);if(null!=e||t&rt.Optional)return e;xe("ChangeDetectorRef")}())},t.\u0275pipe=me({name:"translate",type:t,pure:!1}),t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),lv=(()=>{class t{static forRoot(e={}){return{ngModule:t,providers:[e.loader||{provide:Nf,useClass:Ff},e.compiler||{provide:Zf,useClass:Xf},e.parser||{provide:Wf,useClass:Jf},e.missingTranslationHandler||{provide:Hf,useClass:Kf},ev,{provide:iv,useValue:e.isolate},{provide:nv,useValue:e.useDefaultLang},{provide:sv,useValue:e.extend},{provide:rv,useValue:e.defaultLanguage},ov]}}static forChild(e={}){return{ngModule:t,providers:[e.loader||{provide:Nf,useClass:Ff},e.compiler||{provide:Zf,useClass:Xf},e.parser||{provide:Wf,useClass:Jf},e.missingTranslationHandler||{provide:Hf,useClass:Kf},{provide:iv,useValue:e.isolate},{provide:nv,useValue:e.useDefaultLang},{provide:sv,useValue:e.extend},{provide:rv,useValue:e.defaultLanguage},ov]}}}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)}}),t})();const cv=new _f(If);function dv(t){const{subscriber:e,counter:i,period:n}=t;e.next(i),this.schedule({subscriber:e,counter:i+1,period:n},n)}function uv(t,e){1&t&&Bs(0,"div")}let hv=(()=>{class t{constructor(t,e,i,n,r,s){this.route=t,this.router=e,this.alertService=i,this.authenticationService=n,this.messageService=r,this.translate=s,this.logoutTimer=!0,this.logoutTime=new Date}ngOnInit(){this.logoutTime=new Date,this.logoutTime.setSeconds(this.logoutTime.getSeconds()+100),this.log(`Logout Time Init ${this.logoutTime.toISOString()} `),this.checkLogout()}checkLogout(){(function(t=0,e=cv){var i;return(l(i=t)||!(i-parseFloat(i)+1>=0)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=cv),new b(i=>(i.add(e.schedule(dv,t,{subscriber:i,counter:0,period:t})),i))})(1e4).subscribe(()=>{const t=new Date;let e=this.authenticationService.logoutCheck();e||(e=t);const i=Math.round((e.getTime()-t.getTime())/1e3);if(i>0&&i<=120){const t=this.translate.instant("autologout.msg.sessionExpires",{remaining:i});this.alertService.error(t)}if(i<0){const t=this.translate.instant("autologout.msg.sessionExpired");this.alertService.error(t,!0),this.router.navigate(["login"],{queryParams:{returnUrl:this.router.url}})}})}log(t){this.messageService.add("logoutTimer: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Fg),Rs(rf),Rs(Df),Rs(sp),Rs(Rh),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-logouttimer"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(t,e){1&t&&Gs(0,uv,1,0,"div",0),2&t&&js("ngIf",e.logoutTimer)},directives:[jc],styles:["h2[_ngcontent-%COMP%]{color:red;font-family:Arial,Helvetica,sans-serif;font-weight:lighter}body[_ngcontent-%COMP%]{margin:2em}body[_ngcontent-%COMP%], button[_ngcontent-%COMP%], input[text][_ngcontent-%COMP%]{color:#dc143c;font-family:Cambria,Georgia}button.clear[_ngcontent-%COMP%]{font-family:Arial;background-color:#eee;border:none;padding:5px 10px;border-radius:4px;cursor:pointer;cursor:hand}button[_ngcontent-%COMP%]:hover{background-color:#cfd8dc}button[_ngcontent-%COMP%]:disabled{background-color:#eee;color:#aaa;cursor:auto}button.clear[_ngcontent-%COMP%]{color:#888;margin-bottom:12px}"]}),t})();function pv(t,e){if(1&t&&(Ns(0,"div"),mo(1),Fs()),2&t){const t=e.$implicit;_n(1),vo(" ",t," ")}}function gv(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"h2"),mo(2,"Messages"),Fs(),Ns(3,"button",1),Js("click",(function(){return ei(t),Xs().messageService.clear()})),mo(4,"clear"),Fs(),Gs(5,pv,2,1,"div",2),Fs()}if(2&t){const t=Xs();_n(5),js("ngForOf",t.messageService.messages)}}let mv=(()=>{class t{constructor(t){this.messageService=t}ngOnInit(){this.activateMessage=this.messageService.getstatus(),this.messageService.activateMessageToggle.subscribe(()=>{this.activateMessage=this.messageService.getstatus()})}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh))},t.\u0275cmp=le({type:t,selectors:[["app-messages"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"clear",3,"click"],[4,"ngFor","ngForOf"]],template:function(t,e){1&t&&Gs(0,gv,6,1,"div",0),2&t&&js("ngIf",e.activateMessage)},directives:[jc,Lc],styles:["h2[_ngcontent-%COMP%]{color:red;font-family:Arial,Helvetica,sans-serif;font-weight:lighter}body[_ngcontent-%COMP%]{margin:2em}body[_ngcontent-%COMP%], button[_ngcontent-%COMP%], input[text][_ngcontent-%COMP%]{color:#dc143c;font-family:Cambria,Georgia}button.clear[_ngcontent-%COMP%]{font-family:Arial;background-color:#eee;border:none;padding:5px 10px;border-radius:4px;cursor:pointer;cursor:hand}button[_ngcontent-%COMP%]:hover{background-color:#cfd8dc}button[_ngcontent-%COMP%]:disabled{background-color:#eee;color:#aaa;cursor:auto}button.clear[_ngcontent-%COMP%]{color:#888;margin-bottom:12px}"]}),t})();const fv=function(t,e,i){return{alert:t,"alert-success":e,"alert-danger":i}};function vv(t,e){if(1&t&&(Ns(0,"div",1),mo(1),Fs()),2&t){const t=Xs();js("ngClass",Ma(2,fv,t.message,"success"===t.message.type,"error"===t.message.type)),_n(1),vo("",t.message.text,"\n")}}let bv=(()=>{class t{constructor(t){this.alertService=t,this.subscription=t.getMessage().subscribe(t=>{this.message=t})}ngOnDestroy(){this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(Rs(Df))},t.\u0275cmp=le({type:t,selectors:[["app-alert"]],decls:1,vars:1,consts:[["id","alertMessage",3,"ngClass",4,"ngIf"],["id","alertMessage",3,"ngClass"]],template:function(t,e){1&t&&Gs(0,vv,2,6,"div",0),2&t&&js("ngIf",e.message)},directives:[jc,Oc],encapsulation:2}),t})();function yv(t,e){1&t&&(Ns(0,"div",23),Ns(1,"div",24),Bs(2,"app-alert"),Ns(3,"div",25),Bs(4,"img",26),Fs(),Bs(5,"router-outlet"),Fs(),Fs())}let Cv=(()=>{class t{constructor(t,e,i,n){this.messageService=t,this.authenticationService=e,this.alertService=i,this.translate=n,this.version="2.0",this.restVersionString=new Date,this.restUIVersionString=new Date,this.localsAvailable=!1}ngOnInit(){const t=this.translate.getBrowserLang();this.log("Browser Language: "+t),this.translate.use(t).subscribe(()=>{this.log(`Successfully initialized '${t}' language.'`),this.localsAvailable=!0},()=>{this.log(`Problem with '${t}' language initialization.'`)}),this.restVersion()}restVersion(){this.authenticationService.restVersion().subscribe(t=>{this.log("Version Status check result "+JSON.stringify(t)),t.version&&(this.restVersionString=new Date(t.version)),t.versionUI&&(this.restUIVersionString=new Date(t.versionUI)),this.log(`Version check success ${t.version}/${this.restVersionString} UI ${t.versionUI}/${this.restUIVersionString}`)},t=>{this.log(`Version Status check Failed: ${t.status} ${t.error.message} `),this.alertService.error(Lh(t))})}pwPolicy(){this.authenticationService.initPWPolicy().subscribe(()=>{this.log("Init PW Policy success")},t=>{this.log(`Init PW Policy Failed: ${t.status} ${t.error.message} `),this.alertService.error(Lh(t))})}log(t){this.messageService.add("App: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(sp),Rs(Df),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-root"]],decls:54,vars:36,consts:[[1,"jumbotron","pt-0","mt-0",2,"background-color","#ffffff"],["class","wrapper",4,"ngIf"],[1,"col-12","bg-light","text-dark","mt-3"],["href","https://visbo.de/",1,"text-secondary"],["data-toggle","modal","data-target","#versionModal"],[1,"row"],[1,"col"],["href","mailto:support@visbo.de"],["href","https://visbo.de/impressum","target","_blank"],["href","https://visbo.de/visbo-terms-conditions","target","_blank"],["href","https://visbo.de/visbo-data-protection/","target","_blank"],["id","versionModal","tabindex","-1","role","dialog","aria-labelledby","versionModalTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","versionModalTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group","row"],["for","restServer",1,"col-4","col-form-label"],[1,"col-8","form-control-static",3,"title"],["for","restUIServer",1,"col-4","col-form-label"],[1,"wrapper"],[1,"container-fluid"],[1,"ml-3","mt-0",2,"float","right"],["src","assets/visbologo.svg"]],template:function(t,e){1&t&&(Ns(0,"div",0),Gs(1,yv,6,0,"div",1),Ns(2,"div",2),mo(3," Copyright 2020 \xa9 "),Ns(4,"a",3),mo(5,"VISBO GmbH"),Fs(),mo(6,", "),Ns(7,"a",4),mo(8),Ua(9,"translate"),Fs(),Ns(10,"div",5),Ns(11,"div",6),Ns(12,"a",7),mo(13),Ua(14,"translate"),Fs(),Fs(),Ns(15,"div",6),Ns(16,"a",8),mo(17),Ua(18,"translate"),Fs(),Fs(),Ns(19,"div",6),Ns(20,"a",9),mo(21),Ua(22,"translate"),Fs(),Fs(),Ns(23,"div",6),Ns(24,"a",10),mo(25),Ua(26,"translate"),Fs(),Fs(),Fs(),Fs(),Bs(27,"app-logouttimer"),Bs(28,"app-messages"),Ns(29,"div",11),Ns(30,"div",12),Ns(31,"div",13),Ns(32,"div",14),Ns(33,"h5",15),mo(34),Ua(35,"translate"),Fs(),Ns(36,"button",16),Ns(37,"span",17),mo(38,"\xd7"),Fs(),Fs(),Fs(),Ns(39,"div",18),Ns(40,"div",19),Ns(41,"label",20),mo(42),Ua(43,"translate"),Fs(),Ns(44,"label",21),mo(45),Ua(46,"date"),Fs(),Fs(),Ns(47,"div",19),Ns(48,"label",22),mo(49),Ua(50,"translate"),Fs(),Ns(51,"label",21),mo(52),Ua(53,"date"),Fs(),Fs(),Fs(),Fs(),Fs(),Fs(),Fs()),2&t&&(_n(1),js("ngIf",e.localsAvailable),_n(7),bo("",Ea(9,14,"app.product")," ",e.version,""),_n(5),fo(Ea(14,16,"app.support")),_n(4),fo(Ea(18,18,"app.impressum")),_n(4),fo(Ea(22,20,"app.terms")),_n(4),fo(Ea(26,22,"app.dataProtection")),_n(9),fo(Ea(35,24,"app.versionInfo")),_n(8),vo("",Ea(43,26,"app.serverVersion"),":"),_n(2),to("title",e.restVersionString.toLocaleString()),_n(1),vo("",Oa(46,28,e.restVersionString,"dd.MM.yyyy")," "),_n(4),vo("",Ea(50,31,"app.uiVersion"),":"),_n(2),to("title",e.restVersionString.toLocaleString()),_n(1),vo("",Oa(53,33,e.restUIVersionString,"dd.MM.yyyy")," "))},directives:[jc,hv,mv,bv,af],pipes:[av,qc],encapsulation:2}),t})();class Vv{}var wv=function(t){return t[t.View=1]="View",t[t.ViewAudit=2]="ViewAudit",t[t.ViewLog=4]="ViewLog",t[t.Modify=16]="Modify",t[t.ManagePerm=32]="ManagePerm",t[t.CreateVC=256]="CreateVC",t[t.DeleteVC=1024]="DeleteVC",t}({}),Av=function(t){return t[t.View=1]="View",t[t.ViewAudit=2]="ViewAudit",t[t.Modify=16]="Modify",t[t.ManagePerm=32]="ManagePerm",t[t.CreateVP=256]="CreateVP",t}({}),Pv=function(t){return t[t.View=1]="View",t[t.ViewAudit=2]="ViewAudit",t[t.Modify=16]="Modify",t[t.ManagePerm=32]="ManagePerm",t[t.CreateVariant=256]="CreateVariant",t[t.ViewRestricted=512]="ViewRestricted",t[t.DeleteVP=1024]="DeleteVP",t}({});class kv{}class Dv{}class Mv{}class Sv{}const Iv=new th({"Content-Type":"application/json"});let xv=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.vcUrl=this.env.restUrl.concat("/vc")}getVisboCenters(t=!1,e=!1){const i=this.vcUrl;let n=new nh;return t&&(n=n.append("sysadmin","1")),e&&(n=n.append("deleted","1")),this.log(`Calling HTTP Request: ${i} `),this.http.get(i,{headers:Iv,params:n}).pipe(D(t=>t.vc),Kh(t=>this.log(`fetched ${t.length} VisboCenters `)),Nh(this.handleError("getVisboCenters")))}getSysVisboCenter(){const t=this.vcUrl;let e=new nh;return e=e.append("systemvc","true"),e=e.append("sysadmin","1"),this.log("Calling HTTP Request for SysVC: "+t),this.http.get(t,{headers:Iv,params:e}).pipe(D(t=>(this.log("fetched System VisboCenter "+JSON.stringify(t)),t.vc&&t.vc.length>0&&(t.vc[0].perm=t.perm,this.combinedPerm=t.perm,localStorage.setItem("combinedPerm",JSON.stringify(t.perm)),localStorage.setItem("systemVC",t.vc[0]._id)),t.vc)),Kh(t=>{this.log("fetched System VisboCenter user Role is "+(t[0].perm.system||"None"))}),Nh(this.handleError("getSysVisboCenters")))}getSysAdminRole(){let t;return t=void 0===this.combinedPerm?JSON.parse(localStorage.getItem("combinedPerm")):this.combinedPerm,this.log("SysAdmin Role: "+JSON.stringify(t)),t}getSysVCId(){const t=localStorage.getItem("systemVC");return this.log("Sysem VC ID: "+t),t}getVisboCenter(t,e=!1,i=!1){const n=`${this.vcUrl}/${t}`;let r=new nh;return e&&(r=r.append("sysadmin","1")),i&&(r=r.append("deleted","1")),this.log("Calling HTTP Request for a specific entry: "+n),this.http.get(n,{headers:Iv,params:r}).pipe(D(t=>(t.vc[0].perm=t.perm,t.vc[0])),Kh(e=>this.log(`fetched VC ${e.name} id:${t} perm:${JSON.stringify(e.perm)}`)),Nh(this.handleError("getVisboCenter id:"+t)))}getCapacity(t,e,i,n=!1,r=!1,s=!1,o=!1){const a=`${this.vcUrl}/${t}/capacity`;let l=new nh;return n&&(l=l.append("hierarchy","1")),r&&(l=l.append("pfv","1")),s&&(l=l.append("sysadmin","1")),o&&(l=l.append("deleted","1")),i&&(this.log("Calling RoleID: "+i),l=l.append("roleID",i)),this.log(`Calling Capacity for a VC: ${a} params  ${JSON.stringify(l)}`),this.http.get(a,{headers:Iv,params:l}).pipe(D(t=>(t.vc[0].perm=t.perm,t.vc[0])),Kh(e=>this.log(`fetched Capacity for VC ${e.name} id:${t} perm:${JSON.stringify(e.perm)}`)),Nh(this.handleError("getVisboCenter id:"+t)))}addVisboCenter(t){const e=this.vcUrl;let i=new nh;return i=i.append("sysadmin","1"),this.log(`Calling HTTP Request: ${e} ${JSON.stringify(t)}`),this.http.post(e,t,{headers:Iv,params:i}).pipe(D(t=>t.vc[0]),Kh(t=>this.log(`added VisboCenter ${t.name} with id=${t._id}`)),Nh(this.handleError("addVisboCenter")))}deleteVisboCenter(t,e=!1,i=!1){const n=t._id,r=`${this.vcUrl}/${n}`;let s=new nh;return e&&(s=s.append("sysadmin","1")),i&&(s=s.append("deleted","1")),this.log(`Calling HTTP Request: ${r} `),this.http.delete(r,{headers:Iv,params:s}).pipe(Kh(()=>this.log("deleted VisboCenter id="+n)),Nh(this.handleError("deleteVisboCenter")))}updateVisboCenter(t,e=!1,i=!1){const n=`${this.vcUrl}/${t._id}`;let r=new nh;return e&&(r=r.append("sysadmin","1")),i&&(r=r.append("deleted","1")),this.log(`Calling HTTP Request PUT: ${n} `),this.http.put(n,t,{headers:Iv,params:r}).pipe(D(t=>t.vc[0]),Kh(t=>this.log(`updated VisboCenter ${t.name} with id=${t._id}`)),Nh(this.handleError("updateVisboCenter")))}getVCUsers(t,e=!1,i=!1){const n=`${this.vcUrl}/${t}/group?userlist=1`;let r=new nh;return e&&(r=r.append("sysadmin","1")),i&&(r=r.append("deleted","1")),this.log(`Calling HTTP Request GET Users: ${n} `),this.http.get(n,{headers:Iv,params:r}).pipe(D(t=>{const e=new Sv;return e.users=t.users,e.groups=t.groups,e.vpusers=t.vpusers,e}),Kh(()=>this.log("fetched Users & Groups Users ")),Nh(this.handleError("getVisboCenterUsers")))}addVCUser(t,e,i,n,r){const s=`${this.vcUrl}/${n}/group/${e}/user`;let o=new nh;r&&(o=o.append("sysadmin","1"));const a={email:t,message:i||""};return this.log(`Calling HTTP Request: ${s} for ${t} `),this.http.post(s,a,{headers:Iv,params:o}).pipe(D(t=>t.groups[0]),Kh(t=>this.log("added Visbo User to Group with id="+t._id)),Nh(this.handleError("addVCUser")))}deleteVCUser(t,e,i){const n=`${this.vcUrl}/${e}/group/${t.groupId}/user/${t.userId}`;let r=new nh;return i&&(r=r.append("sysadmin","1")),this.log(`Calling HTTP Request: ${n} for ${t.email} as ${t.groupName} `),this.http.delete(n,{headers:Iv,params:r}).pipe(Kh(()=>this.log("deleted Visbo Center User "+t.email)),Nh(this.handleError("deleteVisboCenterUser")))}addVCGroup(t,e){const i=`${this.vcUrl}/${t.vcid}/group`;let n=new nh;return e&&(n=n.append("sysadmin","1")),this.log(`Calling HTTP Request: ${i} for ${t.name} `),this.http.post(i,t,{headers:Iv,params:n}).pipe(D(t=>t.groups[0]),Kh(t=>this.log("added Visbo Group with id="+t._id)),Nh(this.handleError("addVCGroup")))}modifyVCGroup(t,e){const i=`${this.vcUrl}/${t.vcid}/group/${t._id}`;let n=new nh;return e&&(n=n.append("sysadmin","1")),this.log(`Calling HTTP Request: ${i} for ${t.name} Perm: ${JSON.stringify(t.permission)} `),this.http.put(i,t,{headers:Iv,params:n}).pipe(D(t=>t.groups[0]),Kh(t=>this.log("modified Visbo Group with id="+JSON.stringify(t))),Nh(this.handleError("addVCGroup")))}deleteVCGroup(t,e){const i=`${this.vcUrl}/${t.vcid}/group/${t._id}`;let n=new nh;return e&&(n=n.append("sysadmin","1")),this.log(`Calling HTTP Request: ${i} for Group ${t.name} `),this.http.delete(i,{headers:Iv,params:n}).pipe(Kh(()=>this.log("deleted Visbo Center Group "+t.name)),Nh(this.handleError("deleteVisboCenterGroup")))}handleError(t="operation"){return this.log(`HTTP Request ${t} failed`),e=>(this.log(`HTTP Request ${t} failed: ${e.error.message} status:${e.status}`),jh(e))}log(t){this.messageService.add("VisboCenterService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(Rh),Kt(np))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function Tv(t,e){1&t&&(Ns(0,"div",23),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"login.msg.emailRequired")))}function _v(t,e){1&t&&(Ns(0,"div",24),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"login.msg.pwRequired")))}function Uv(t,e){1&t&&Bs(0,"img",25)}function Ev(t,e){1&t&&(Ns(0,"a",26),mo(1),Ua(2,"translate"),Fs()),2&t&&(to("href",Xs().loginGoogleUrl(),mn),_n(1),fo(Ea(2,2,"login.btn.loginGoogle")))}const Ov=function(t){return{"has-error":t}};let Gv=(()=>{class t{constructor(t,e,i,n,r,s,o,a){this.route=t,this.router=e,this.messageService=i,this.authenticationService=n,this.visbocenterService=r,this.alertService=s,this.translate=o,this.titleService=a,this.loading=!1,this.currentLang="en"}ngOnInit(){this.authenticationService.logout(),this.getSetting(),this.log(`current Language ${this.translate.currentLang} getLangs() ${JSON.stringify(this.translate.getLangs())}`),this.currentLang=this.translate.currentLang,this.titleService.setTitle(this.translate.instant("login.title")),this.route.snapshot.queryParams.email&&(this.email=this.route.snapshot.queryParams.email);const t=(this.route.snapshot.queryParams.returnUrl||"/").split("?");this.returnUrl=t[0],this.returnParams=t[1],this.log(`return url ${this.returnUrl} params ${this.returnParams}`)}restVersion(){this.restVersionString||this.authenticationService.restVersion().subscribe(t=>{this.restVersionString=t.version.toISOString(),this.log("Version Status check success "+this.restVersionString)},t=>{this.log(`Version Status check Failed: ${t.status} ${t.error.message} `),this.alertService.error(Lh(t))})}login(){this.loading=!0,this.authenticationService.login(this.email,this.userpw).subscribe(t=>{if(t.status&&t.status.expiresAt){const e=new Date(t.status.expiresAt);this.log("Login Success BUT EXPIRATION at: "+e.toLocaleString());const i=this.translate.instant("autologout.msg.pwExpires",{expiresAt:e.toLocaleString()});this.alertService.error(i,!0)}else{const e=new Date(t.status.lastLoginAt),i=this.translate.instant("login.msg.loginSuccess",{lastLogin:e.toLocaleString()});this.alertService.success(i,!0)}this.visbocenterService.getSysVisboCenter().subscribe(()=>{this.log(`Login Success ${this.returnUrl} Role ${JSON.stringify(this.visbocenterService.getSysAdminRole())} `),this.router.navigate([this.returnUrl],{replaceUrl:!0,queryParams:this.queryStringToJSON(this.returnParams)})},t=>{this.log(`No SysVC found:  ${t.status} ${t.error.message}`),this.router.navigate(["/"],{replaceUrl:!0})})},t=>{this.log(`Login Failed: ${t.status} ${t.error.message} `);let e=Lh(t);403===t.status&&(e=this.translate.instant("login.msg.loginFailure",{user:this.email})),this.alertService.error(e),this.loading=!1})}loginGoogleUrl(){return this.authenticationService.loginGoogleUrl()}loginGoogle(){this.loading=!0,console.log("GoogleLogin Start "),this.authenticationService.loginGoogle().subscribe(t=>{console.log(`Google Login Success ${this.returnUrl} Role ${JSON.stringify(t)} `),this.log("Google Login Success Result "+JSON.stringify(t));const e=new Date(t.status.lastLoginAt),i=this.translate.instant("login.msg.loginSuccess",{lastLogin:e.toLocaleString()});this.alertService.success(i,!0),this.visbocenterService.getSysVisboCenter().subscribe(()=>{this.log(`Login Success ${this.returnUrl} Role ${JSON.stringify(this.visbocenterService.getSysAdminRole())} `),this.router.navigate([this.returnUrl],{replaceUrl:!0,queryParams:this.queryStringToJSON(this.returnParams)})},t=>{this.log(`No SysVC found:  ${t.status} ${t.error.message}`),this.router.navigate(["/"],{replaceUrl:!0})})},t=>{this.log(`Google Login Failed: ${t.status} ${t.error.message} `);let e=Lh(t);403===t.status&&(e=this.translate.instant("login.msg.loginFailure",{user:this.email})),this.alertService.error(e),this.loading=!1})}pwforgotten(){const t=(this.email||"").trim();this.log(`Forward to password forgotten ${t} `),this.router.navigate(["pwforgotten"],{queryParams:{email:t}})}register(){this.log("Forward to Register"),this.router.navigate(["register"])}relogin(){this.authenticationService.logout(),this.log("reLogin after error 401 to URL "+this.route.snapshot.queryParams.returnUrl),this.returnUrl=this.route.snapshot.queryParams.returnUrl||"/"}useLanguage(t){this.translate.use(t)}queryStringToJSON(t){const e=(t||"").split("&"),i={};return e.forEach((function(t){const e=t.split("=");e[0]&&(i[e[0]]=e[1]||"")})),i}hasSetting(t){let e=void 0;if(t&&this.setting){const i=this.setting.find(e=>e.name==t);i&&(e=i.value)}return e}getSetting(){this.authenticationService.getSetting().subscribe(t=>{this.log("ReST Server Setting success "+JSON.stringify(t)),this.setting=t},t=>{this.log(`Init Settings Failed: ${t.status} ${t.error.message} `),this.alertService.error(Lh(t))})}log(t){this.messageService.add("Login: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Fg),Rs(rf),Rs(Rh),Rs(sp),Rs(xv),Rs(Df),Rs(ov),Rs(Md))},t.\u0275cmp=le({type:t,selectors:[["app-login"]],decls:43,vars:38,consts:[[1,"well"],[1,"d-flex","flex-row-reverse"],["name","currentLang",1,"col-1",3,"ngModel","ngModelChange","change"],["value","en"],["value","de"],[1,"col-md-6","col-md-offset-3"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group",3,"ngClass"],["for","username"],["id","loginName","type","text","name","username","required","","pattern","[^@\\s]+@[^@\\s]+\\.[^@\\s]+",1,"form-control",3,"ngModel","ngModelChange"],["username","ngModel"],["id","loginNameError","class","help-block",4,"ngIf"],["for","password"],["id","loginPW","type","password","name","password","required","",1,"form-control",3,"ngModel","ngModelChange"],["password","ngModel"],["id","loginPWError","class","help-block",4,"ngIf"],[1,"form-group"],["id","loginButtonLogin",1,"btn","btn-primary",3,"disabled"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==",4,"ngIf"],["class","btn btn-link","style","float: right",3,"href",4,"ngIf"],["id","loginButtonRegister",1,"btn","btn-link",3,"click"],["id","loginButtonPWForgotten",1,"btn","btn-link",3,"click"],["id","loginNameError",1,"help-block"],["id","loginPWError",1,"help-block"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="],[1,"btn","btn-link",2,"float","right",3,"href"]],template:function(t,e){if(1&t){const t=zs();Ns(0,"div",0),Ns(1,"h2"),mo(2),Ua(3,"translate"),Fs(),Bs(4,"br"),Ns(5,"div",1),Ns(6,"select",2),Js("ngModelChange",(function(t){return e.currentLang=t}))("change",(function(){return e.useLanguage(e.currentLang)})),Ns(7,"option",3),mo(8),Ua(9,"translate"),Fs(),Ns(10,"option",4),mo(11),Ua(12,"translate"),Fs(),Fs(),Fs(),Ns(13,"div",5),Ns(14,"form",6,7),Js("ngSubmit",(function(){return ei(t),Ls(15).form.valid&&e.login()})),Ns(16,"div",8),Ns(17,"label",9),mo(18),Ua(19,"translate"),Fs(),Ns(20,"input",10,11),Js("ngModelChange",(function(t){return e.email=t})),Fs(),Gs(22,Tv,3,3,"div",12),Fs(),Ns(23,"div",8),Ns(24,"label",13),mo(25),Ua(26,"translate"),Fs(),Ns(27,"input",14,15),Js("ngModelChange",(function(t){return e.userpw=t})),Fs(),Gs(29,_v,3,3,"div",16),Fs(),Ns(30,"div",17),Ns(31,"button",18),mo(32),Ua(33,"translate"),Fs(),Gs(34,Uv,1,0,"img",19),Gs(35,Ev,3,4,"a",20),Fs(),Fs(),Fs(),Ns(36,"div"),Ns(37,"button",21),Js("click",(function(){return e.register()})),mo(38),Ua(39,"translate"),Fs(),Ns(40,"button",22),Js("click",(function(){return e.pwforgotten()})),mo(41),Ua(42,"translate"),Fs(),Fs(),Fs()}if(2&t){const t=Ls(15),i=Ls(21),n=Ls(28);_n(2),fo(Ea(3,18,"login.title")),_n(4),js("ngModel",e.currentLang),_n(2),fo(Ea(9,20,"language.en")),_n(3),fo(Ea(12,22,"language.de")),_n(5),js("ngClass",ka(34,Ov,t.submitted&&!i.valid)),_n(2),fo(Ea(19,24,"login.lbl.email")),_n(2),js("ngModel",e.email),_n(2),js("ngIf",t.submitted&&!i.valid),_n(1),js("ngClass",ka(36,Ov,t.submitted&&!n.valid)),_n(2),fo(Ea(26,26,"login.lbl.password")),_n(2),js("ngModel",e.userpw),_n(2),js("ngIf",t.submitted&&!n.valid),_n(2),js("disabled",e.loading),_n(1),fo(Ea(33,28,"login.btn.login")),_n(2),js("ngIf",e.loading),_n(1),js("ngIf",e.hasSetting("OAuthGoogle")),_n(3),fo(Ea(39,30,"login.btn.register")),_n(3),fo(Ea(42,32,"login.btn.pwForgotten"))}},directives:[cu,Nd,Eu,du,gu,Ou,Fd,Tu,Oc,Od,Ru,Hu,jc],pipes:[av],encapsulation:2}),t})();function Lv(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"h4"),mo(2),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo(" ",t.user.email," ")}}function Rv(t,e){1&t&&(Ns(0,"div",38),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"register.msg.firstNameRequired")))}function jv(t,e){1&t&&(Ns(0,"div",38),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"register.msg.lastNameRequired")))}function $v(t,e){1&t&&(Ns(0,"div",38),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"register.msg.companyRequired")))}function Nv(t,e){1&t&&(Ns(0,"div",38),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"register.msg.emailRequired")))}const Fv=function(t){return{"has-error":t}};function Bv(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div",5),Ns(2,"label",39),mo(3),Ua(4,"translate"),Fs(),Ns(5,"input",40,41),Js("ngModelChange",(function(e){return ei(t),Xs(2).user.email=e})),Fs(),Gs(7,Nv,3,3,"div",9),Fs(),Fs()}if(2&t){const t=Ls(6);Xs();const e=Ls(1),i=Xs();_n(1),js("ngClass",ka(6,Fv,e.submitted&&!t.valid)),_n(2),fo(Ea(4,4,"register.lbl.email")),_n(2),js("ngModel",i.user.email),_n(2),js("ngIf",e.submitted&&!t.valid)}}function Hv(t,e){1&t&&(Ns(0,"div",38),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"register.msg.followPolicy")))}function Kv(t,e){if(1&t&&(Ns(0,"div",38),mo(1),Fs()),2&t){const t=Xs(2);_n(1),fo(t.PWPolicyDescription)}}function qv(t,e){1&t&&Bs(0,"img",42)}const zv=function(){return["/login"]};function Qv(t,e){if(1&t){const t=zs();Ns(0,"form",2,3),Js("ngSubmit",(function(){ei(t);const e=Ls(1),i=Xs();return e.form.valid&&i.register()})),Gs(2,Lv,3,1,"div",4),Ns(3,"div",5),Ns(4,"label",6),mo(5),Ua(6,"translate"),Fs(),Ns(7,"input",7,8),Js("ngModelChange",(function(e){return ei(t),Xs().user.profile.firstName=e})),Fs(),Gs(9,Rv,3,3,"div",9),Fs(),Ns(10,"div",5),Ns(11,"label",10),mo(12),Ua(13,"translate"),Fs(),Ns(14,"input",11,12),Js("ngModelChange",(function(e){return ei(t),Xs().user.profile.lastName=e})),Fs(),Gs(16,jv,3,3,"div",9),Fs(),Ns(17,"div",13),Ns(18,"label",14),mo(19),Ua(20,"translate"),Fs(),Ns(21,"input",15,16),Js("ngModelChange",(function(e){return ei(t),Xs().user.profile.company=e})),Fs(),Gs(23,$v,3,3,"div",9),Fs(),Ns(24,"div",13),Ns(25,"label",17),mo(26),Ua(27,"translate"),Fs(),Ns(28,"input",18,19),Js("ngModelChange",(function(e){return ei(t),Xs().user.profile.phone=e})),Fs(),Fs(),Gs(30,Bv,8,8,"div",4),Ns(31,"div",5),Ns(32,"label",20),mo(33),Ua(34,"translate"),Fs(),Ns(35,"input",21,22),Js("ngModelChange",(function(e){return ei(t),Xs().user.password=e})),Fs(),Gs(37,Hv,3,3,"div",9),Gs(38,Kv,2,1,"div",9),Fs(),Ns(39,"form",23,24),Ns(41,"div"),mo(42),Ua(43,"translate"),Fs(),Ns(44,"div",25),Ns(45,"input",26,27),Js("ngModelChange",(function(e){return ei(t),Xs().check_TOU=e})),Fs(),Bs(47,"label",28),Ns(48,"a",29),mo(49),Ua(50,"translate"),Fs(),Fs(),Ns(51,"div",30),Ns(52,"input",31,32),Js("ngModelChange",(function(e){return ei(t),Xs().check_DP=e})),Fs(),Bs(54,"label",33),Ns(55,"a",34),mo(56),Ua(57,"translate"),Fs(),Fs(),Fs(),Ns(58,"div",13),Ns(59,"button",35),mo(60),Ua(61,"translate"),Fs(),Gs(62,qv,1,0,"img",36),Ns(63,"a",37),mo(64),Ua(65,"translate"),Fs(),Fs(),Fs()}if(2&t){const t=Ls(1),e=Ls(8),i=Ls(15),n=Ls(22),r=Ls(36),s=Xs();_n(2),js("ngIf",s.user._id),_n(1),js("ngClass",ka(51,Fv,t.submitted&&!e.valid)),_n(2),fo(Ea(6,31,"register.lbl.firstName")),_n(2),js("ngModel",s.user.profile.firstName),_n(2),js("ngIf",t.submitted&&!e.valid),_n(1),js("ngClass",ka(53,Fv,t.submitted&&!i.valid)),_n(2),fo(Ea(13,33,"register.lbl.lastName")),_n(2),js("ngModel",s.user.profile.lastName),_n(2),js("ngIf",t.submitted&&!i.valid),_n(3),fo(Ea(20,35,"register.lbl.company")),_n(2),js("ngModel",s.user.profile.company),_n(2),js("ngIf",t.submitted&&!n.valid),_n(3),fo(Ea(27,37,"register.lbl.phone")),_n(2),js("ngModel",s.user.profile.phone),_n(2),js("ngIf",!s.user._id),_n(1),js("ngClass",ka(55,Fv,t.submitted&&!r.valid)),_n(1),eo("title","Password Rule: ",s.PWPolicyDescription,""),_n(1),vo(" ",Ea(34,39,"register.lbl.password")," (*) "),_n(2),to("pattern",s.PWPolicy),js("ngModel",s.user.password),_n(2),js("ngIf",!r.valid),_n(1),js("ngIf",!r.valid&&s.PWPolicyDescription),_n(4),fo(Ea(43,41,"register.titleTC")),_n(3),js("ngModel",s.check_TOU),_n(4),fo(Ea(50,43,"register.lbl.acceptTC")),_n(3),js("ngModel",s.check_DP),_n(4),fo(Ea(57,45,"register.lbl.acceptDP")),_n(4),fo(Ea(61,47,"register.btn.register")),_n(2),js("ngIf",s.loading),_n(1),js("routerLink",Pa(57,zv)),_n(1),fo(Ea(65,49,"register.btn.cancel"))}}let Wv=(()=>{class t{constructor(t,e,i,n,r,s){this.messageService=t,this.route=e,this.router=i,this.authenticationService=n,this.alertService=r,this.translate=s,this.hash=void 0,this.loading=!1}ngOnInit(){this.getPWPolicy();const t=this.route.snapshot.paramMap.get("id");if(this.hash=this.route.snapshot.queryParams.hash,t)this.getUser(t,this.hash);else{const t=new Zh;t.profile=new Wh,t.status=new Jh,this.user=t}this.log(`Register for User ${t} hash ${this.hash}`)}register(){if(this.check_DP&&this.check_TOU)this.loading=!0,this.log("Call register Service "+JSON.stringify(this.user)),this.authenticationService.createUser(this.user,this.hash).subscribe(t=>{if(this.hash){const e=this.translate.instant("register.msg.registerSuccess",{email:t.email});this.alertService.success(e,!0)}else{const e=this.translate.instant("register.msg.registerSuccessConfirm",{email:t.email});this.alertService.success(e,!0)}this.router.navigate(["login"])},t=>{this.log("Error during Create User "+t.error.message),this.alertService.error(Lh(t)),this.loading=!1});else{const t=this.translate.instant("register.msg.confirmDP_TOU");this.alertService.error(t,!1)}}getUser(t,e){this.authenticationService.getUser(t,e).subscribe(t=>{this.log("Init Signup User success "+JSON.stringify(t)),t.profile||(t.profile=new Wh),this.user=t},t=>{this.log(`Init Signup User Failed: ${t.status} ${t.error.message} `),this.alertService.error(Lh(t))})}getPWPolicy(){this.authenticationService.initPWPolicy().subscribe(t=>{this.log("Init PW Policy success "+JSON.stringify(t)),this.PWPolicy=t.PWPolicy,this.PWPolicyDescription=t.Description},t=>{this.log(`Init PW Policy Failed: ${t.status} ${t.error.message} `),this.alertService.error(Lh(t))})}log(t){this.messageService.add("Register: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(Fg),Rs(rf),Rs(sp),Rs(Df),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-register"]],decls:5,vars:4,consts:[[1,"col-md-6","col-md-offset-3"],["name","form","novalidate","",3,"ngSubmit",4,"ngIf"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[4,"ngIf"],[1,"form-group",3,"ngClass"],["for","firstName"],["type","text","name","firstName","required","","autocomplete","on",1,"form-control",3,"ngModel","ngModelChange"],["firstName","ngModel"],["class","help-block",4,"ngIf"],["for","lastName"],["type","text","name","lastName","required","","autocomplete","on",1,"form-control",3,"ngModel","ngModelChange"],["lastName","ngModel"],[1,"form-group"],["for","company"],["type","text","name","company","required","","autocomplete","on",1,"form-control",3,"ngModel","ngModelChange"],["company","ngModel"],["for","phone"],["type","text","name","phone",1,"form-control",3,"ngModel","ngModelChange"],["phone","ngModel"],["for","password-new","data-toggle","tooltip","data-placement","top","data-delay","50",3,"title"],["type","password","name","password-new","required","","autocomplete","off",1,"form-control",3,"ngModel","pattern","ngModelChange"],["password","ngModel"],["name","legal","novalidate",""],["fLegal","ngForm"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","IDcheckTOU","name","checkTOU","required","",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkTOU","ngModel"],["for","IDcheckTOU",1,"custom-control-label"],["href","https://visbo.de/visbo-terms-conditions","target","_blank"],[1,"custom-control","custom-checkbox","mb-3"],["type","checkbox","id","IDcheckDP","name","checkDP","required","",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkDP","ngModel"],["for","IDcheckDP",1,"custom-control-label"],["href","https://visbo.de/visbo-data-protection","target","_blank"],["type","submit",1,"btn","btn-primary"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==",4,"ngIf"],[1,"btn","btn-link",3,"routerLink"],[1,"help-block"],["for","username"],["type","email","name","username","required","","pattern","[^@\\s]+@[^@\\s]+\\.[^@\\s]+","required","","autocomplete","on",1,"form-control",3,"ngModel","ngModelChange"],["username","ngModel"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="]],template:function(t,e){1&t&&(Ns(0,"div",0),Ns(1,"h2"),mo(2),Ua(3,"translate"),Fs(),Gs(4,Qv,66,58,"form",1),Fs()),2&t&&(_n(2),fo(Ea(3,2,"register.title")),_n(2),js("ngIf",e.user))},directives:[jc,Ou,Fd,Tu,Oc,Od,Ru,Nd,Eu,Hu,ju,_d,sf],pipes:[av],styles:[""]}),t})();const Jv=function(){return["/login"]};let Yv=(()=>{class t{constructor(t,e,i,n,r,s){this.messageService=t,this.router=e,this.route=i,this.authenticationService=n,this.alertService=r,this.translate=s}ngOnInit(){const t=this.route.snapshot.queryParams.hash,e=this.route.snapshot.queryParams.id;this.log(`Init Register Confirm userid ${e} Token ${t}`),this.authenticationService.registerconfirm(e,t).subscribe(()=>{this.log("Register Confirm Success");const t=this.translate.instant("registerConfirm.msg.registerSuccess");this.alertService.success(t,!0),this.router.navigate(["login"])},t=>{this.log("Error during Register Confirm "+t.error.message),this.alertService.error(Lh(t)),this.router.navigate(["login"])})}log(t){this.messageService.add("Register Confirm: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(rf),Rs(Fg),Rs(sp),Rs(Df),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-registerconfirm"]],decls:12,vars:8,consts:[[1,"col-md-6","col-md-offset-3"],["name","form","novalidate",""],["f","ngForm"],[1,"form-group"],[1,"btn","btn-link",3,"routerLink"]],template:function(t,e){1&t&&(Ns(0,"div",0),Ns(1,"h2"),mo(2),Ua(3,"translate"),Fs(),Ns(4,"form",1,2),Ns(6,"p"),mo(7),Ua(8,"translate"),Fs(),Ns(9,"div",3),Ns(10,"a",4),mo(11,"Cancel"),Fs(),Fs(),Fs(),Fs()),2&t&&(_n(2),fo(Ea(3,3,"registerConfirm.title")),_n(5),vo(" ",Ea(8,5,"registerConfirm.description")," This is an inbetween page without specific content, you should get redirected to login. If not please use the button below. "),_n(3),js("routerLink",Pa(7,Jv)))},directives:[Ou,Fd,Tu,sf],pipes:[av],styles:[""]}),t})();const Zv=function(){return["/login"]};let Xv=(()=>{class t{constructor(t,e,i,n,r,s){this.messageService=t,this.router=e,this.route=i,this.authenticationService=n,this.alertService=r,this.translate=s}ngOnInit(){const t=this.route.snapshot.queryParams.hash;console.log("Init OAuth Confirm Hash "+t),this.authenticationService.oauthconfirm(t),console.log("OAuth Confirm Success");const e=this.translate.instant("oauthconfirm.msg.loginSuccess");this.alertService.success(e,!0),this.router.navigate(["/"])}log(t){this.messageService.add("OAuth Confirm: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(rf),Rs(Fg),Rs(sp),Rs(Df),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-oauthconfirm"]],decls:12,vars:8,consts:[[1,"col-md-6","col-md-offset-3"],["name","form","novalidate",""],["f","ngForm"],[1,"form-group"],[1,"btn","btn-link",3,"routerLink"]],template:function(t,e){1&t&&(Ns(0,"div",0),Ns(1,"h2"),mo(2),Ua(3,"translate"),Fs(),Ns(4,"form",1,2),Ns(6,"p"),mo(7),Ua(8,"translate"),Fs(),Ns(9,"div",3),Ns(10,"a",4),mo(11,"Cancel"),Fs(),Fs(),Fs(),Fs()),2&t&&(_n(2),fo(Ea(3,3,"oauthconfirm.title")),_n(5),vo(" ",Ea(8,5,"oauthconfirm.description")," This is an inbetween page without specific content, you should get redirected to login. If not please use the button below. "),_n(3),js("routerLink",Pa(7,Zv)))},directives:[Ou,Fd,Tu,sf],pipes:[av],styles:[""]}),t})(),tb=(()=>{class t{constructor(t){this.router=t}canActivate(t,e){return!!localStorage.getItem("currentUser")||(this.router.navigate(["login"],{queryParams:{returnUrl:e.url}}),!1)}}return t.\u0275fac=function(e){return new(e||t)(Kt(rf))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function eb(t,e){1&t&&(Ns(0,"div",12),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"pwForgotten.msg.emailRequired")))}function ib(t,e){1&t&&Bs(0,"img",13)}const nb=function(t){return{"has-error":t}},rb=function(){return["/login"]};let sb=(()=>{class t{constructor(t,e,i,n,r,s){this.messageService=t,this.route=e,this.router=i,this.authenticationService=n,this.alertService=r,this.translate=s,this.loading=!1}ngOnInit(){this.user=new Zh,this.route.snapshot.queryParams.email&&(this.user.email=this.route.snapshot.queryParams.email),this.log("Password Forgotten for User "+this.user.email)}pwforgotten(){this.loading=!0,this.authenticationService.pwforgotten(this.user).subscribe(()=>{this.alertService.success("Password Forgotten Request successful. Please check your Mail to continue.",!0),this.router.navigate(["login"])},t=>{this.log("Error during Password Forgotten "+t.error.message),this.alertService.error(Lh(t),!0),this.loading=!1})}log(t){this.messageService.add("PW Forgotten: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(Fg),Rs(rf),Rs(sp),Rs(Df),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-pwforgotten"]],decls:21,vars:21,consts:[[1,"col-md-6","col-md-offset-3"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group",3,"ngClass"],["for","username"],["type","text","name","username","required","",1,"form-control",3,"ngModel","ngModelChange"],["username","ngModel"],["class","help-block",4,"ngIf"],[1,"form-group"],[1,"btn","btn-primary",3,"disabled"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==",4,"ngIf"],[1,"btn","btn-link",3,"routerLink"],[1,"help-block"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="]],template:function(t,e){if(1&t){const t=zs();Ns(0,"div",0),Ns(1,"h2"),mo(2),Ua(3,"translate"),Fs(),Ns(4,"form",1,2),Js("ngSubmit",(function(){return ei(t),Ls(5).form.valid&&e.pwforgotten()})),Ns(6,"div",3),Ns(7,"label",4),mo(8),Ua(9,"translate"),Fs(),Ns(10,"input",5,6),Js("ngModelChange",(function(t){return e.user.email=t})),Fs(),Gs(12,eb,3,3,"div",7),Fs(),Ns(13,"div",8),Ns(14,"button",9),mo(15),Ua(16,"translate"),Fs(),Gs(17,ib,1,0,"img",10),Ns(18,"a",11),mo(19),Ua(20,"translate"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Ls(5),i=Ls(11);_n(2),fo(Ea(3,10,"pwForgotten.title")),_n(4),js("ngClass",ka(18,nb,t.submitted&&!i.valid)),_n(2),fo(Ea(9,12,"pwForgotten.lbl.email")),_n(2),js("ngModel",e.user.email),_n(2),js("ngIf",t.submitted&&!i.valid),_n(2),js("disabled",e.loading),_n(1),fo(Ea(16,14,"pwForgotten.btn.resetPW")),_n(2),js("ngIf",e.loading),_n(1),js("routerLink",Pa(20,rb)),_n(1),fo(Ea(20,16,"pwForgotten.btn.cancel"))}},directives:[Ou,Fd,Tu,Oc,Od,Ru,Nd,Eu,jc,sf],pipes:[av],styles:[""]}),t})();function ob(t,e){1&t&&(Ns(0,"div",12),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"pwReset.msg.followPolicy")))}function ab(t,e){1&t&&(Ns(0,"div",12),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"pwReset.msg.followRule")))}function lb(t,e){1&t&&Bs(0,"img",13)}const cb=function(t){return{"has-error":t}},db=function(){return["/login"]};let ub=(()=>{class t{constructor(t,e,i,n,r,s){this.messageService=t,this.router=e,this.route=i,this.authenticationService=n,this.alertService=r,this.translate=s,this.loading=!1}ngOnInit(){this.getPWPolicy(),this.user=new Zh,this.token=this.route.snapshot.queryParams.token,this.log("Init PW Reset Token "+this.token)}pwreset(){this.loading=!0,this.authenticationService.pwreset(this.user,this.token).subscribe(()=>{const t=this.translate.instant("pwReset.msg.pwResetSuccess");this.alertService.success(t,!0),this.router.navigate(["login"])},t=>{this.loading=!1;const e=this.translate.instant("pwReset.msg.pwResetError");this.alertService.error(e,!0),this.log("Error during Reset Password "+t.error.message)})}getPWPolicy(){this.authenticationService.initPWPolicy().subscribe(t=>{this.log("Init PW Policy success "+JSON.stringify(t)),this.PWPolicy=t.PWPolicy,this.PWPolicyDescription=t.Description},t=>{this.log(`Init PW Policy Failed: ${t.status} ${t.error.message} `),this.alertService.error(Lh(t))})}log(t){this.messageService.add("PW Reset: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(rf),Rs(Fg),Rs(sp),Rs(Df),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-pwreset"]],decls:22,vars:23,consts:[[1,"col-md-6","col-md-offset-3"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group",3,"ngClass"],["for","password","data-toggle","tooltip","data-placement","top","data-delay","50","title","Password Rule: At least one alpha, one capital, one number and one special character and a length of minimum 8."],["type","password","name","password","required","","autocomplete","off",1,"form-control",3,"ngModel","pattern","ngModelChange"],["password","ngModel"],["class","help-block",4,"ngIf"],[1,"form-group"],[1,"btn","btn-primary",3,"disabled"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==",4,"ngIf"],[1,"btn","btn-link",3,"routerLink"],[1,"help-block"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="]],template:function(t,e){if(1&t){const t=zs();Ns(0,"div",0),Ns(1,"h2"),mo(2),Ua(3,"translate"),Fs(),Ns(4,"form",1,2),Js("ngSubmit",(function(){return ei(t),Ls(5).form.valid&&e.pwreset()})),Ns(6,"div",3),Ns(7,"label",4),mo(8),Ua(9,"translate"),Fs(),Ns(10,"input",5,6),Js("ngModelChange",(function(t){return e.user.password=t})),Fs(),Gs(12,ob,3,3,"div",7),Gs(13,ab,3,3,"div",7),Fs(),Ns(14,"div",8),Ns(15,"button",9),mo(16),Ua(17,"translate"),Fs(),Gs(18,lb,1,0,"img",10),Ns(19,"a",11),mo(20),Ua(21,"translate"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Ls(5),i=Ls(11);_n(2),fo(Ea(3,12,"pwReset.title")),_n(4),js("ngClass",ka(20,cb,t.submitted&&!i.valid)),_n(2),vo(" ",Ea(9,14,"pwReset.lbl.newPassword")," (*) "),_n(2),to("pattern",e.PWPolicy),js("ngModel",e.user.password),_n(2),js("ngIf",!i.valid),_n(1),js("ngIf",!i.valid),_n(2),js("disabled",e.loading),_n(1),fo(Ea(17,16,"pwReset.btn.resetPW")),_n(2),js("ngIf",e.loading),_n(1),js("routerLink",Pa(22,db)),_n(1),fo(Ea(21,18,"pwReset.btn.cancel"))}},directives:[Ou,Fd,Tu,Oc,Od,Ru,Nd,Eu,Hu,jc,sf],pipes:[av],styles:[""]}),t})();var hb=function(t){return t[t.Project=0]="Project",t[t.Portfolio=1]="Portfolio",t[t.Template=2]="Template",t}({});class pb{}class gb{}const mb={headers:new th({"Content-Type":"application/json"})};let fb=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.vpUrl=this.env.restUrl.concat("/vp")}getVisboProjects(t,e=!1,i=!1){const n=""+this.vpUrl,r=new th({"Content-Type":"application/json"});let s=new nh;return t&&(s=s.append("vcid",t)),e&&(s=s.append("sysadmin","1")),i&&(s=s.append("deleted","1")),this.log(`VP getVisboProjects Sysadmin ${e} Deleted ${i}`),this.http.get(n,{headers:r,params:s}).pipe(D(t=>t.vp),Kh(t=>this.log(`fetched ${t.length} VisboProjects `)),Nh(this.handleError("getVisboProjects")))}getVisboProjectNo404(t){const e=""+this.vpUrl;return this.log("Calling HTTP Request: "+this.vpUrl),this.http.get(e).pipe(D(t=>t[0]),Kh(e=>{this.log(`getVisboProject404 ${e?"fetched":"did not find"} VisboProject id=${t}`)}),Nh(this.handleError("getVisboProject id="+t)))}getVisboProject(t,e=!1,i=!1){const n=`${this.vpUrl}/${t}`,r=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("sysadmin","1")),i&&(s=s.append("deleted","1")),this.log(`Calling HTTP Request for a specific entry: ${n} params ${s}`),this.http.get(n,{headers:r,params:s}).pipe(D(t=>(t.vp[0].perm=t.perm,t.vp[0])),Kh(t=>this.log(`fetched vp id=${t._id} ${t.name}`)),Nh(this.handleError("getVisboProject id="+t)))}getCapacity(t,e,i,n,r=!1,s=!1,o=!1,a=!1){const l=`${this.vpUrl}/${t}/portfolio/${e}/capacity`,c=new th({"Content-Type":"application/json"});let d=new nh;return r&&(d=d.append("hierarchy","1")),s&&(d=d.append("pfv","1")),o&&(d=d.append("sysadmin","1")),a&&(d=d.append("deleted","1")),n&&(this.log("Calling RoleID: "+n),d=d.append("roleID",n)),i&&(d=d.append("refDate",i.toISOString())),this.log("Calling HTTP Request for a specific entry: "+l),this.http.get(l,{headers:c,params:d}).pipe(D(t=>t.vp[0]),Kh(i=>this.log(`fetched Capacity for VP/VPF ${t}/ ${e} Len: ${i.capacity.length}`)),Nh(this.handleError("getVisboPortfolio Capacity id:"+e)))}addVisboProject(t){return this.http.post(this.vpUrl,t,mb).pipe(D(t=>t.vp[0]),Kh(t=>this.log("added VisboProject with id="+t._id)),Nh(this.handleError("addVisboProject")))}deleteVisboProject(t,e=!1){const i=t._id,n=`${this.vpUrl}/${i}`,r=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("deleted","1")),this.log(`Calling HTTP Request: ${n} `),this.http.delete(n,{headers:r,params:s}).pipe(Kh(()=>this.log("deleted VisboProject id="+i)),Nh(this.handleError("deleteVisboProject")))}updateVisboProject(t,e=!1){const i=`${this.vpUrl}/${t._id}`,n=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("deleted","1")),this.log(`Calling HTTP Request PUT: ${i} `),this.http.put(i,t,{headers:n,params:r}).pipe(D(t=>t.vp[0]),Kh(()=>this.log(`updated VisboProject id=${t._id} url=${this.vpUrl}`)),Nh(this.handleError("updateVisboProject")))}getVPUsers(t,e=!1,i=!1){const n=`${this.vpUrl}/${t}/group?userlist=1`,r=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("sysadmin","1")),i&&(s=s.append("deleted","1")),this.log(`Calling HTTP Request GET: ${n} `),this.http.get(n,{headers:r,params:s}).pipe(D(t=>{const e=new Sv;return e.users=t.users,e.groups=t.groups,e}),Nh(this.handleError("getVisboProjectUsers")))}addVPUser(t,e,i,n,r=!1){const s=`${this.vpUrl}/${n}/group/${e}/user`,o=new th({"Content-Type":"application/json"});let a=new nh;r&&(a=a.append("sysadmin","1"));const l={email:t,message:i};return this.log(`Calling HTTP Request: ${s} for ${t} `),this.http.post(s,l,{headers:o,params:a}).pipe(D(t=>t.groups[0]),Kh(t=>this.log("added Visbo User to Group with id="+t._id)),Nh(this.handleError("addVPUser")))}deleteVPUser(t,e,i=!1){const n=`${this.vpUrl}/${e}/group/${t.groupId}/user/${t.userId}`,r=new th({"Content-Type":"application/json"});let s=new nh;return i&&(s=s.append("sysadmin","1")),this.log(`Calling HTTP Request: ${n} for ${t.email} as ${t.groupName} `),this.http.delete(n,{headers:r,params:s}).pipe(D(t=>t.groups[0]),Kh(()=>this.log("deleted Visbo Project User "+t.email)),Nh(this.handleError("deleteVisboProjectUser")))}addVPGroup(t,e=!1){const i=`${this.vpUrl}/${t.vpids[0]}/group`,n=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("sysadmin","1")),this.log(`Calling HTTP Request: ${i} for ${t.name} `),this.http.post(i,t,{headers:n,params:r}).pipe(D(t=>t.groups[0]),Kh(t=>this.log("added Visbo Group with id="+t._id)),Nh(this.handleError("addVPGroup")))}modifyVPGroup(t,e=!1){const i=`${this.vpUrl}/${t.vpids[0]}/group/${t._id}`,n=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("sysadmin","1")),this.log(`Calling HTTP Request: ${i} for ${t.name} `),this.http.put(i,t,{headers:n,params:r}).pipe(D(t=>t.groups[0]),Kh(t=>this.log("modified Visbo Group with id="+JSON.stringify(t))),Nh(this.handleError("addVPGroup")))}deleteVPGroup(t,e,i=!1){const n=`${this.vpUrl}/${e}/group/${t._id}`,r=new th({"Content-Type":"application/json"});let s=new nh;return i&&(s=s.append("sysadmin","1")),this.log(`Calling HTTP Request: ${n} for Group ${t.name} `),this.http.delete(n,{headers:r,params:s}).pipe(Kh(()=>this.log("deleted Visbo Project Group "+t.name)),Nh(this.handleError("deleteVisboProjectGroup")))}unlockVP(t,e,i=!1){const n=`${this.vpUrl}/${e}/lock`,r=new th({"Content-Type":"application/json"});let s=new nh;return i&&(s=s.append("sysadmin","1")),t&&(s=s.append("variantID",t)),this.log(`Calling HTTP Request: ${n} Params ${s} `),this.http.delete(n,{headers:r,params:s}).pipe(D(t=>t.lock),Kh(()=>this.log("deleted Visbo Project Lock for Variant "+t)),Nh(this.handleError("deleteVisboProjectLock")))}deleteRestriction(t,e){const i=`${this.vpUrl}/${t}/restrict/${e}`,n=new th({"Content-Type":"application/json"}),r=new nh;return this.log(`Calling HTTP Request: ${i} Params ${r} `),this.http.delete(i,{headers:n,params:r}).pipe(D(t=>t.vp[0]),Kh(t=>this.log("deleted Visbo Project Restriction in VP "+t.name)),Nh(this.handleError("deleteVisboProjectRestriction")))}addRestriction(t,e){const i=`${this.vpUrl}/${t}/restrict`,n=new th({"Content-Type":"application/json"}),r=new nh;return this.log(`Calling HTTP Request: ${i} Params ${r} `),this.http.post(i,e,{headers:n,params:r}).pipe(D(t=>t.restrict[0]),Kh(t=>this.log("added Visbo Project Restriction "+JSON.stringify(t))),Nh(this.handleError("addVisboProjectRestriction")))}createVariant(t,e,i=!1){const n=`${this.vpUrl}/${e}/variant`,r=new th({"Content-Type":"application/json"});let s=new nh;i&&(s=s.append("sysadmin","1"));const o={variantName:t};return this.log(`Calling HTTP Request: ${n} for ${t} `),this.http.post(n,o,{headers:r,params:s}).pipe(D(t=>t.variant[0]),Kh(t=>this.log("added VP Variant with id="+t._id)),Nh(this.handleError("createVariant")))}deleteVariant(t,e){const i=`${this.vpUrl}/${e}/variant/${t}`,n=new th({"Content-Type":"application/json"}),r=new nh;return this.log(`Calling HTTP Request: ${i} Params ${r} `),this.http.delete(i,{headers:n,params:r}).pipe(D(t=>t.vp[0]),Kh(t=>this.log("deleted Visbo Project Variant in VP "+t.name)),Nh(this.handleError("deleteVisboProjectVariant")))}handleError(t="operation"){return e=>(this.log(`HTTP Request failed: ${e.error.message} ${e.status}`),this.log(`${t} failed: ${e.error.message}`),jh(e))}log(t){this.messageService.add("VisboProjectService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(Rh),Kt(np))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function vb(t,e){if(1&t){const t=zs();Ns(0,"li",10),Ns(1,"a",11),mo(2),Ua(3,"translate"),Fs(),Ns(4,"div",12),Ns(5,"a",13),Js("click",(function(){return ei(t),Xs().gotoClickedItem("settings")})),mo(6),Ua(7,"translate"),Fs(),Ns(8,"a",13),Js("click",(function(){return ei(t),Xs().gotoClickedItem("sysadmins")})),mo(9),Ua(10,"translate"),Fs(),Fs(),Fs()}2&t&&(_n(2),vo(" ",Ea(3,3,"navbar.others")," "),_n(4),fo(Ea(7,5,"navbar.settings")),_n(3),fo(Ea(10,7,"navbar.appAdmin")))}let bb=(()=>{class t{constructor(t,e,i,n,r){this.route=t,this.router=e,this.alertService=i,this.messageService=n,this.visbocenterService=r,this.permSystem=wv}ngOnInit(){this.combinedPerm=this.visbocenterService.getSysAdminRole(),this.log(`Navbar Init Sys Role ${JSON.stringify(this.combinedPerm)} View ${this.permSystem.View}`)}gotoClickedItem(t){this.router.navigate([t])}hasSystemPerm(t){var e;return((null===(e=this.combinedPerm)||void 0===e?void 0:e.system)&t)>0}log(t){this.messageService.add("NavBar: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Fg),Rs(rf),Rs(Df),Rs(Rh),Rs(xv))},t.\u0275cmp=le({type:t,selectors:[["app-usernavbar"]],decls:25,vars:16,consts:[[1,"navbar","navbar-expand-md","navbar-white","bg-light","sticky-top"],[1,"navbar-brand","bg-light",3,"click"],["type","button","data-toggle","collapse","data-target","#navbarMainNavigation","aria-controls","navbarMainNavigation","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"fas","fa-bars"],["id","navbarMainNavigation",1,"collapse","navbar-collapse"],[1,"navbar-nav","mr-auto"],[1,"nav-item"],[1,"nav-link","bg-light",3,"click"],["class","nav-item dropdown",4,"ngIf"],[1,"nav-link","bg-light","align-right",3,"click"],[1,"nav-item","dropdown"],["href","#","id","navbarDropdown","role","button","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"nav-link","dropdown-toggle","bg-light"],["aria-labelledby","navbarDropdown",1,"dropdown-menu"],[1,"dropdown-item",3,"click"]],template:function(t,e){1&t&&(Ns(0,"nav",0),Ns(1,"a",1),Js("click",(function(){return e.gotoClickedItem("dashboard")})),mo(2),Ua(3,"translate"),Fs(),Ns(4,"button",2),Bs(5,"i",3),Fs(),Ns(6,"div",4),Ns(7,"ul",5),Ns(8,"li",6),Ns(9,"a",7),Js("click",(function(){return e.gotoClickedItem("vc")})),mo(10),Ua(11,"translate"),Fs(),Fs(),Ns(12,"li",6),Ns(13,"a",7),Js("click",(function(){return e.gotoClickedItem("vp")})),mo(14),Ua(15,"translate"),Fs(),Fs(),Ns(16,"li",6),Ns(17,"a",7),Js("click",(function(){return e.gotoClickedItem("profile")})),mo(18),Ua(19,"translate"),Fs(),Fs(),Gs(20,vb,11,9,"li",8),Ns(21,"li",6),Ns(22,"a",9),Js("click",(function(){return e.gotoClickedItem("login")})),mo(23),Ua(24,"translate"),Fs(),Fs(),Fs(),Fs(),Fs()),2&t&&(_n(2),fo(Ea(3,6,"navbar.visbo")),_n(8),fo(Ea(11,8,"navbar.vc")),_n(4),fo(Ea(15,10,"navbar.vp")),_n(4),fo(Ea(19,12,"navbar.profile")),_n(2),js("ngIf",e.hasSystemPerm(e.permSystem.View)),_n(3),fo(Ea(24,14,"navbar.logout")))},directives:[jc],pipes:[av],styles:[".navbar[_ngcontent-%COMP%]{padding:0;margin-bottom:1em;margin-top:1em}"]}),t})();function yb(t,e){if(1&t){const t=zs();Ns(0,"div",7),Ns(1,"div",8),Ns(2,"div",9),Ns(3,"h3",10),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(2).gotoClickedVc(i)})),Ns(4,"a"),mo(5),Fs(),Fs(),Ns(6,"h6",11),mo(7),Ua(8,"date"),Fs(),Ns(9,"p",12),mo(10),Fs(),Ns(11,"div",13),Ns(12,"button",14),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(2).gotoClickedVc(i)})),mo(13),Ua(14,"translate"),Fs(),Ns(15,"button",15),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(2).gotoClickedVcDetail(i)})),mo(16),Ua(17,"translate"),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit;_n(5),fo(t.name),_n(2),fo(Oa(8,6,t.updatedAt,"dd.MM.yyyy HH:mm")),_n(3),fo(t.description),_n(3),bo("",t.vpCount," ",Ea(14,9,"dashboard.projects"),""),_n(3),fo(Ea(17,11,"dashboard.detail"))}}function Cb(t,e){if(1&t&&(Ns(0,"div",2),Ns(1,"div",3),Ns(2,"h2"),mo(3),Ua(4,"translate"),Fs(),Fs(),Ns(5,"div",4),Ns(6,"div",5),Gs(7,yb,18,13,"div",6),Fs(),Fs(),Fs()),2&t){const t=Xs();_n(3),fo(Ea(4,2,"dashboard.topvc")),_n(4),js("ngForOf",t.visbocenters)}}function Vb(t,e){if(1&t){const t=zs();Ns(0,"div",7),Ns(1,"div",8),Ns(2,"div",9),Ns(3,"h3",10),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(2).gotoClickedVp(i)})),Ns(4,"a"),mo(5),Fs(),Fs(),Ns(6,"h6",16),mo(7),Fs(),Ns(8,"h6",11),mo(9),Ua(10,"date"),Fs(),Ns(11,"p",12),mo(12),Fs(),Ns(13,"div",13),Ns(14,"button",14),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(2).gotoClickedVp(i)})),mo(15),Ua(16,"translate"),Fs(),Ns(17,"button",15),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(2).gotoClickedVpDetail(i)})),mo(18),Ua(19,"translate"),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit;_n(5),fo(t.name),_n(2),fo(t.vc.name),_n(2),fo(Oa(10,7,t.updatedAt,"dd.MM.yyyy HH:mm")),_n(3),fo(t.description),_n(3),bo("",t.vpfCount||t.vpvCount," ",Ea(16,10,"dashboard.versions"),""),_n(3),fo(Ea(19,12,"dashboard.detail"))}}function wb(t,e){if(1&t&&(Ns(0,"div",2),Ns(1,"div",0),Ns(2,"div",3),Ns(3,"h2"),mo(4),Ua(5,"translate"),Fs(),Fs(),Fs(),Ns(6,"div",4),Ns(7,"div",5),Gs(8,Vb,20,14,"div",6),Fs(),Fs(),Fs()),2&t){const t=Xs();_n(4),fo(Ea(5,2,"dashboard.topvp")),_n(4),js("ngForOf",t.visboprojects)}}function Ab(t,e){1&t&&(Ns(0,"div",2),Ns(1,"div",3),Ns(2,"h2"),mo(3),Ua(4,"translate"),Fs(),Ns(5,"div"),mo(6),Ua(7,"translate"),Fs(),Fs(),Fs()),2&t&&(_n(3),fo(Ea(4,2,"dashboard.noVC")),_n(3),vo(" ",Ea(7,4,"dashboard.msg.noVC")," "))}let Pb=(()=>{class t{constructor(t,e,i,n,r,s,o,a){this.visbocenterService=t,this.visboprojectService=e,this.messageService=i,this.alertService=n,this.route=r,this.router=s,this.translate=o,this.titleService=a,this.visbocenters=[],this.visboprojects=[],this.combinedPerm=void 0,this.permVC=Av,this.permVP=Pv}ngOnInit(){this.currentLang=this.translate.currentLang,this.titleService.setTitle(this.translate.instant("dashboard.title")),this.getVisboCenters(),this.getVisboProjects()}getVisboCenters(){this.visbocenterService.getVisboCenters().subscribe(t=>{this.visbocenters=t.sort((function(t,e){return t.updatedAt>e.updatedAt?-1:1})).slice(0,3)},t=>{console.log("get VCs failed: error: %d message: %s",t.status,t.error.message),this.alertService.error(Lh(t))})}getVisboProjects(){this.visboprojectService.getVisboProjects(null).subscribe(t=>{this.visboprojects=t.sort((function(t,e){return t.updatedAt>e.updatedAt?-1:1})).slice(0,3)},t=>{console.log("get VPs failed: error: %d message: %s",t.status,t.error.message),this.alertService.error(Lh(t))})}hasVCPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vc&t)>0}gotoClickedVc(t){this.router.navigate(["vp/"+t._id])}gotoClickedVcDetail(t){this.router.navigate(["vcDetail/"+t._id])}gotoClickedVp(t){this.router.navigate(t.vpType===hb.Portfolio?["vpf/"+t._id]:["vpKeyMetrics/"+t._id])}gotoClickedVpVc(t){this.router.navigate(["vp/"+t.vcid])}gotoClickedVpDetail(t){this.router.navigate(["vpDetail/"+t._id])}}return t.\u0275fac=function(e){return new(e||t)(Rs(xv),Rs(fb),Rs(Rh),Rs(Df),Rs(Fg),Rs(rf),Rs(ov),Rs(Md))},t.\u0275cmp=le({type:t,selectors:[["app-dashboard"]],decls:5,vars:3,consts:[[1,"well"],["class","container-fluit",4,"ngIf"],[1,"container-fluit"],[1,"panel-heading"],[1,"col-12"],[1,"row"],["class","card-group col-sm-8 col-md-6 col-lg-4 mb-2",4,"ngFor","ngForOf"],[1,"card-group","col-sm-8","col-md-6","col-lg-4","mb-2"],[1,"card",2,"width","18rem"],[1,"card-body","d-flex","flex-column"],[1,"card-title",3,"click"],[1,"card-subtitle","mb-2","text-muted"],[1,"card-text"],[1,"align-self-bottom",2,"margin-top","auto"],["type","button",1,"mx-1","btn","btn-primary",3,"click"],["type","button",1,"mx-1","btn","btn-secondary",3,"click"],[1,"card-subtitle","mb-2","text-black"]],template:function(t,e){1&t&&(Ns(0,"div",0),Bs(1,"app-usernavbar"),Fs(),Gs(2,Cb,8,4,"div",1),Gs(3,wb,9,4,"div",1),Gs(4,Ab,8,6,"div",1)),2&t&&(_n(2),js("ngIf",e.visbocenters&&e.visbocenters.length>0),_n(1),js("ngIf",e.visboprojects&&e.visboprojects.length>0),_n(1),js("ngIf",e.visbocenters&&0==e.visbocenters.length&&e.visboprojects&&0==e.visboprojects.length))},directives:[bb,jc,Lc],pipes:[av,qc],styles:[""]}),t})();function kb(t,e){if(1&t){const t=zs();Ns(0,"tr",12),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(2).gotoClickedRow(i)})),Ns(1,"td",6),mo(2),Fs(),Ns(3,"td",13),Ns(4,"a"),mo(5),Fs(),Fs(),Ns(6,"td",14),mo(7),Ua(8,"date"),Fs(),Ns(9,"td",15),mo(10),Ua(11,"date"),Fs(),Ns(12,"td",16),mo(13),Fs(),Ns(14,"td",17),Ns(15,"button",18),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(2).gotoDetail(i)})),Ua(16,"translate"),mo(17,"i"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit,i=e.index;_n(2),fo(i+1),_n(3),fo(t.name),_n(2),fo(Oa(8,6,t.updatedAt,"dd.MM.yyyy HH:mm")),_n(3),fo(Oa(11,9,t.updatedAt,"dd.MM.yy")),_n(3),fo(t.vpCount),_n(2),to("title",Ea(16,12,"vc.msg.detail"))}}function Db(t,e){if(1&t){const t=zs();Ns(0,"div",2),Ns(1,"h2",3),mo(2),Ua(3,"translate"),Fs(),Ns(4,"table",4),Ns(5,"thead",5),Ns(6,"tr"),Ns(7,"th",6),mo(8),Ua(9,"translate"),Fs(),Ns(10,"th",7),Js("click",(function(){return ei(t),Xs().sortVCTable(1)})),mo(11),Ua(12,"translate"),Fs(),Ns(13,"th",8),Js("click",(function(){return ei(t),Xs().sortVCTable(2)})),mo(14),Ua(15,"translate"),Fs(),Ns(16,"th",9),Js("click",(function(){return ei(t),Xs().sortVCTable(3)})),mo(17),Ua(18,"translate"),Fs(),Ns(19,"th"),mo(20,"Detail"),Fs(),Fs(),Fs(),Ns(21,"tbody",10),Gs(22,kb,18,14,"tr",11),Fs(),Fs(),Fs()}if(2&t){const t=Xs();_n(2),vo(" ",Ea(3,6,"vc.title")," "),_n(6),fo(Ea(9,8,"vc.lbl.nr")),_n(3),fo(Ea(12,10,"vc.lbl.name")),_n(3),fo(Ea(15,12,"vc.lbl.modified")),_n(3),fo(Ea(18,14,"vc.lbl.projects")),_n(5),js("ngForOf",t.visbocenters)}}function Mb(t,e){1&t&&(Ns(0,"div",2),Ns(1,"div",3),Ns(2,"h2"),mo(3),Ua(4,"translate"),Fs(),Ns(5,"div"),mo(6),Ua(7,"translate"),Fs(),Fs(),Fs()),2&t&&(_n(3),fo(Ea(4,2,"vc.noVC")),_n(3),vo(" ",Ea(7,4,"vc.msg.noVC")," "))}let Sb=(()=>{class t{constructor(t,e,i,n,r,s,o){this.visbocenterService=t,this.messageService=e,this.alertService=i,this.route=n,this.router=r,this.translate=s,this.titleService=o}ngOnInit(){this.titleService.setTitle(this.translate.instant("vc.title")),this.getVisboCenters()}getVisboCenters(){this.visbocenterService.getVisboCenters().subscribe(t=>{this.visbocenters=t,this.sortVCTable(1),this.log("get VCs success")},t=>{this.log(`get VCs failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}gotoDetail(t){this.router.navigate(["vcDetail/"+t._id])}gotoClickedRow(t){this.router.navigate(["vp/"+t._id])}sortVCTable(t){this.visbocenters&&(void 0===t&&void 0!==this.sortColumn||(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t:!this.sortAscending),1===this.sortColumn?this.visbocenters.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortColumn?this.visbocenters.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})):3===this.sortColumn&&this.visbocenters.sort((function(t,e){return t.vpCount-e.vpCount})),this.sortAscending||this.visbocenters.reverse())}log(t){this.messageService.add("VisboCenter: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(xv),Rs(Rh),Rs(Df),Rs(Fg),Rs(rf),Rs(ov),Rs(Md))},t.\u0275cmp=le({type:t,selectors:[["app-visbocenters"]],decls:4,vars:2,consts:[[1,"well"],["class","panel-body",4,"ngIf"],[1,"panel-body"],[1,"panel-heading"],[1,"table","table-hover","table-sortable"],["id","VCHead"],[1,"d-none","d-md-table-cell"],["id","SortName",3,"click"],["id","SortDate",1,"d-none","d-sm-table-cell",3,"click"],["id","SortProjects",1,"d-none","d-md-table-cell",3,"click"],["id","VCList"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["id","ColName"],["id","ColDate",1,"d-none","d-md-table-cell"],["id","ColDate",1,"d-none","d-sm-table-cell","d-md-none"],["id","ColProjects",1,"d-none","d-md-table-cell"],["id","ColDetail"],[1,"Detail",3,"title","click"]],template:function(t,e){1&t&&(Bs(0,"app-usernavbar"),Ns(1,"div",0),Gs(2,Db,23,16,"div",1),Gs(3,Mb,8,6,"div",1),Fs()),2&t&&(_n(2),js("ngIf",e.visbocenters&&e.visbocenters.length>0),_n(1),js("ngIf",e.visbocenters&&0==e.visbocenters.length))},directives:[bb,jc,Lc],pipes:[av,qc],encapsulation:2}),t})(),Ib=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.vcUrl=this.env.restUrl.concat("/vc")}getVCSettings(t,e=!1){const i=`${this.vcUrl}/${t}/setting`,n=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("sysadmin","1")),this.log(`Calling HTTP Request: ${i} `),this.http.get(i,{headers:n,params:r}).pipe(D(t=>t.vcsetting),Kh(t=>this.log(`fetched ${t.length} VCSettings `)),Nh(this.handleError("getVCSettings",[])))}getVCOrganisations(t,e=!1,i,n=!1){const r=`${this.vcUrl}/${t}/organisation`,s=new th({"Content-Type":"application/json"});let o=new nh;return e&&(o=o.append("sysadmin","1")),null!=i&&(o=o.append("refDate",i)),this.log(`Calling HTTP Request: ${r} ${n}`),this.http.get(r,{headers:s,params:o}).pipe(D(t=>t.vcsetting),Kh(t=>this.log(`fetched ${t.length} VCOrganisations `)),Nh(this.handleError("getVCOrganisations",[])))}getVCSetting(t,e,i=!1){const n=`${this.vcUrl}/${t}/setting/${e}`,r=new th({"Content-Type":"application/json"});let s=new nh;return i&&(s=s.append("sysadmin","1")),this.log("Calling HTTP Request for a specific entry: "+n),this.http.get(n,{headers:r,params:s}).pipe(D(t=>t.vcsetting[0]),Kh(t=>this.log(`fetched VC Setting ${t.name} id:${e} `)),Nh(this.handleError("getVCSetting id:"+e)))}getVCSettingByName(t,e,i=!1){const n=`${this.vcUrl}/${t}/setting?name=${e}`,r=new th({"Content-Type":"application/json"});let s=new nh;return i&&(s=s.append("sysadmin","1")),this.log("Calling HTTP Request for a specific entry: "+n),this.http.get(n,{headers:r,params:s}).pipe(D(t=>t.vcsetting),Kh(t=>this.log(`fetched ${t.length} VCSettings `)),Nh(this.handleError("getVCSettings by Name",[])))}getVCSettingByType(t,e,i=!1){const n=`${this.vcUrl}/${t}/setting?type=${e}`,r=new th({"Content-Type":"application/json"});let s=new nh;return i&&(s=s.append("sysadmin","1")),this.log("Calling HTTP Request for a specific entry: "+n),this.http.get(n,{headers:r,params:s}).pipe(D(t=>t.vcsetting),Kh(t=>this.log(`fetched ${t.length} VCSettings `)),Nh(this.handleError("getVCSettings by Type",[])))}addVCSetting(t,e,i=!1){const n=`${this.vcUrl}/${t}/setting`,r=new th({"Content-Type":"application/json"});let s=new nh;return i&&(s=s.append("sysadmin","1")),this.log(`Calling HTTP Request: ${n} ${JSON.stringify(e)}`),this.http.post(n,e,{headers:r,params:s}).pipe(D(t=>t.vcsetting[0]),Kh(t=>this.log(`added VCSetting ${t.name} with id=${t._id}`)),Nh(this.handleError("addVCSetting")))}deleteVCSetting(t,e=!1){const i=t._id,n=`${this.vcUrl}/${t.vcid}/setting/${i}`,r=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("sysadmin","1")),this.log(`Calling HTTP Request: ${n} `),this.http.delete(n,{headers:r,params:s}).pipe(Kh(()=>this.log("deleted VCSetting id="+i)),Nh(this.handleError("deleteVCSetting")))}updateVCSetting(t,e,i=!1){const n=`${this.vcUrl}/${t}/setting/${e._id}`,r=new th({"Content-Type":"application/json"});let s=new nh;return i&&(s=s.append("sysadmin","1")),this.log(`Calling HTTP Request PUT: ${n} `),this.http.put(n,e,{headers:r,params:s}).pipe(D(t=>t.vcsetting[0]),Kh(t=>this.log(`updated VCSetting ${t.name} with id=${t._id}`)),Nh(this.handleError("updateVCSetting")))}handleError(t="operation",e){return i=>(this.log(`HTTP Request ${t} failed: ${i.error.message} status:${i.status}, Result ${JSON.stringify(e)}`),jh(i))}log(t){this.messageService.add("VisboSettingService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(Rh),Kt(np))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function xb(t,e){if(1&t){const t=zs();Ns(0,"input",49),Js("ngModelChange",(function(e){return ei(t),Xs(2).visbocenter.name=e})),Fs()}2&t&&js("ngModel",Xs(2).visbocenter.name)}function Tb(t,e){if(1&t&&(Ns(0,"label",50),mo(1),Fs()),2&t){const t=Xs(2);_n(1),vo("",t.visbocenter.name," ")}}function _b(t,e){if(1&t){const t=zs();Ns(0,"textarea",51),Js("ngModelChange",(function(e){return ei(t),Xs(2).visbocenter.description=e})),Fs()}2&t&&js("ngModel",Xs(2).visbocenter.description)}function Ub(t,e){if(1&t&&(Ns(0,"label",52),mo(1),Fs()),2&t){const t=Xs(2);_n(1),vo("",t.visbocenter.description," ")}}function Eb(t,e){if(1&t){const t=zs();Ns(0,"button",59),Js("click",(function(){ei(t);const e=Xs(3);return e.gotoVCAudit(e.visbocenter)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vcDetail.btn.viewAudit")))}function Ob(t,e){if(1&t){const t=zs();Ns(0,"button",60),Js("click",(function(){return ei(t),Xs(3).switchView("Groups")})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vcDetail.btn.viewGroups")))}function Gb(t,e){if(1&t){const t=zs();Ns(0,"button",61),Js("click",(function(){return ei(t),Xs(3).switchView("Users")})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vcDetail.btn.viewUsers")))}function Lb(t,e){if(1&t){const t=zs();Ns(0,"button",62),Js("click",(function(){return ei(t),Xs(3).switchView("ProjectUsers")})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vcDetail.btn.viewProjectUsers")))}function Rb(t,e){if(1&t){const t=zs();Ns(0,"button",63),Js("click",(function(){return ei(t),Xs(3).showSetting()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vcDetail.btn.ViewSetting")))}function jb(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"div",53),Gs(2,Eb,3,3,"button",54),Gs(3,Ob,3,3,"button",55),Gs(4,Gb,3,3,"button",56),Gs(5,Lb,3,3,"button",57),Gs(6,Rb,3,3,"button",58),Fs(),Fs()),2&t){const t=Xs(2);_n(2),js("ngIf",t.hasVCPerm(t.permVC.ViewAudit)),_n(1),js("ngIf","Users"==t.showList),_n(1),js("ngIf","Users"!=t.showList),_n(1),js("ngIf",t.vgVPUsers&&t.vgVPUsers.length>0),_n(1),js("ngIf",t.hasVCPerm(t.permVC.Modify))}}function $b(t,e){1&t&&(Ns(0,"div",65),Ns(1,"button",72),mo(2),Ua(3,"translate"),Fs(),Fs()),2&t&&(_n(2),vo(" ",Ea(3,1,"vcDetail.btn.addUser")," "))}function Nb(t,e){1&t&&(Ns(0,"th"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vcDetail.lbl.delete")))}function Fb(t,e){if(1&t){const t=zs();Ns(0,"td"),Ns(1,"button",75),Js("click",(function(){ei(t);const e=Xs().index;return Xs(4).helperUserIndex(e)})),Ua(2,"translate"),mo(3,"\xd7"),Fs(),Fs()}2&t&&(_n(1),to("title",Ea(2,1,"vcDetail.lbl.deleteUser")))}function Bb(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td"),mo(2),Fs(),Ns(3,"td",73),Js("click",(function(){ei(t);const i=e.index;return Xs(4).calcCombinedPerm(i)})),Ns(4,"a"),mo(5),Fs(),Fs(),Ns(6,"td",74),Js("click",(function(){return ei(t),Xs(4).switchView("Groups")})),Ns(7,"a"),mo(8),Fs(),Fs(),Gs(9,Fb,4,3,"td",0),Fs()}if(2&t){const t=e.$implicit,i=e.index,n=Xs(4);_n(2),fo(i+1),_n(3),fo(t.email),_n(3),fo(t.groupName),_n(1),js("ngIf",n.hasVCPerm(n.permVC.ManagePerm))}}function Hb(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div",64),Ns(2,"div",65),Ns(3,"h4",66),mo(4),Ua(5,"translate"),Fs(),Fs(),Gs(6,$b,4,3,"div",67),Fs(),Ns(7,"div",68),Ns(8,"table",69),Ns(9,"thead",70),Ns(10,"tr"),Ns(11,"th"),mo(12),Ua(13,"translate"),Fs(),Ns(14,"th",1),Js("click",(function(){return ei(t),Xs(3).sortUserTable(1)})),mo(15),Ua(16,"translate"),Fs(),Ns(17,"th",1),Js("click",(function(){return ei(t),Xs(3).sortUserTable(2)})),mo(18),Ua(19,"translate"),Fs(),Gs(20,Nb,3,3,"th",0),Fs(),Fs(),Ns(21,"tbody",71),Gs(22,Bb,10,4,"tr",34),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(3);_n(4),vo(" ",Ea(5,7,"vcDetail.titleUsers")," "),_n(2),js("ngIf",t.hasVCPerm(t.permVC.ManagePerm)),_n(6),fo(Ea(13,9,"vcDetail.lbl.nr")),_n(3),fo(Ea(16,11,"vcDetail.lbl.email")),_n(3),fo(Ea(19,13,"vcDetail.lbl.group")),_n(2),js("ngIf",t.hasVCPerm(t.permVC.ManagePerm)),_n(2),js("ngForOf",t.vgUsers)}}function Kb(t,e){if(1&t){const t=zs();Ns(0,"div",65),Ns(1,"button",79),Js("click",(function(){return ei(t),Xs(4).initGroup(null)})),mo(2),Ua(3,"translate"),Fs(),Fs()}2&t&&(_n(2),vo(" ",Ea(3,1,"vcDetail.btn.addGroup")," "))}function qb(t,e){1&t&&(Ns(0,"th"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vcDetail.lbl.delete")))}function zb(t,e){1&t&&(Ns(0,"td",84),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vcDetail.lbl.global")))}function Qb(t,e){1&t&&Bs(0,"td",84)}function Wb(t,e){if(1&t){const t=zs();Ns(0,"td"),Ns(1,"button",85),Js("click",(function(){ei(t);const e=Xs().index;return Xs(4).helperRemoveGroup(e)})),Ua(2,"translate"),mo(3,"\xd7"),Fs(),Fs()}2&t&&(_n(1),to("title",Ea(2,1,"vcDetail.msg.removeGroup")))}function Jb(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td"),mo(2),Fs(),Ns(3,"td",80),Js("click",(function(){ei(t);const i=e.index,n=e.$implicit,r=Xs(4);return r.groupIndex=i,r.initGroup(n)})),Ns(4,"a"),mo(5),Fs(),Fs(),Ns(6,"td",81),Js("click",(function(){return ei(t),Xs(4).switchView("Users")})),Ns(7,"a"),mo(8),Fs(),Fs(),Gs(9,zb,3,3,"td",82),Gs(10,Qb,1,0,"td",82),Gs(11,Wb,4,3,"td",0),Ns(12,"td"),Ns(13,"button",83),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(4).initGroup(i)})),Ua(14,"translate"),mo(15,"i"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit,i=e.index,n=Xs(4);_n(2),fo(i+1),_n(3),fo(t.name),_n(3),fo(t.users.length),_n(1),js("ngIf",t.global),_n(1),js("ngIf",!t.global),_n(1),js("ngIf",n.hasVCPerm(n.permVC.ManagePerm)),_n(2),to("title",Ea(14,7,"vcDetail.msg.detailGroup"))}}function Yb(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div",64),Ns(2,"div",65),Ns(3,"h5",76),mo(4),Ua(5,"translate"),Fs(),Fs(),Gs(6,Kb,4,3,"div",67),Fs(),Ns(7,"div",68),Ns(8,"table",69),Ns(9,"thead",77),Ns(10,"tr"),Ns(11,"th"),mo(12),Ua(13,"translate"),Fs(),Ns(14,"th",1),Js("click",(function(){return ei(t),Xs(3).sortGroupTable(1)})),mo(15),Ua(16,"translate"),Fs(),Ns(17,"th",1),Js("click",(function(){return ei(t),Xs(3).sortGroupTable(2)})),mo(18),Ua(19,"translate"),Fs(),Ns(20,"th"),mo(21),Ua(22,"translate"),Fs(),Gs(23,qb,3,3,"th",0),Ns(24,"th"),mo(25),Ua(26,"translate"),Fs(),Fs(),Fs(),Ns(27,"tbody",78),Gs(28,Jb,16,9,"tr",34),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(3);_n(4),vo(" ",Ea(5,9,"vcDetail.titleGroups")," "),_n(2),js("ngIf",t.hasVCPerm(t.permVC.ManagePerm)),_n(6),fo(Ea(13,11,"vcDetail.lbl.nr")),_n(3),fo(Ea(16,13,"vcDetail.lbl.group")),_n(3),fo(Ea(19,15,"vcDetail.lbl.members")),_n(3),fo(Ea(22,17,"vcDetail.lbl.type")),_n(2),js("ngIf",t.hasVCPerm(t.permVC.ManagePerm)),_n(2),fo(Ea(26,19,"vcDetail.lbl.info")),_n(3),js("ngForOf",t.vgGroups)}}function Zb(t,e){if(1&t){const t=zs();Ns(0,"tr",1),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(4).gotoVPDetail(i.vpid)})),Ns(1,"td"),mo(2),Fs(),Ns(3,"td"),mo(4),Fs(),Ns(5,"td"),mo(6),Fs(),Ns(7,"td"),mo(8),Fs(),Fs()}if(2&t){const t=e.$implicit,i=e.index;_n(2),fo(i+1),_n(2),fo(t.users.email),_n(2),fo(t.vp.name),_n(2),fo(t.groupName)}}function Xb(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div",64),Ns(2,"div",65),Ns(3,"h5",86),mo(4),Ua(5,"translate"),Fs(),Fs(),Fs(),Ns(6,"div",68),Ns(7,"table",69),Ns(8,"thead"),Ns(9,"tr"),Ns(10,"th"),mo(11),Ua(12,"translate"),Fs(),Ns(13,"th",1),Js("click",(function(){return ei(t),Xs(3).sortVPUserTable(1)})),mo(14),Ua(15,"translate"),Fs(),Ns(16,"th",1),Js("click",(function(){return ei(t),Xs(3).sortVPUserTable(2)})),mo(17),Ua(18,"translate"),Fs(),Ns(19,"th"),mo(20),Ua(21,"translate"),Fs(),Fs(),Fs(),Ns(22,"tbody"),Gs(23,Zb,9,4,"tr",87),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(3);_n(4),vo(" ",Ea(5,6,"vcDetail.titleProjectUsers")," "),_n(7),fo(Ea(12,8,"vcDetail.lbl.nr")),_n(3),fo(Ea(15,10,"vcDetail.lbl.email")),_n(3),fo(Ea(18,12,"vcDetail.lbl.project")),_n(3),fo(Ea(21,14,"vcDetail.lbl.group")),_n(3),js("ngForOf",t.vgVPUsers)}}function ty(t,e){if(1&t&&(Ns(0,"div"),Gs(1,Hb,23,15,"div",0),Gs(2,Yb,29,21,"div",0),Gs(3,Xb,24,16,"div",0),Fs()),2&t){const t=Xs(2);_n(1),js("ngIf","Users"==t.showList),_n(1),js("ngIf","Groups"==t.showList),_n(1),js("ngIf","ProjectUsers"==t.showList)}}function ey(t,e){1&t&&(Ns(0,"th"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vcDetail.lbl.delete")))}function iy(t,e){if(1&t&&(Ns(0,"td",93),mo(1),Ua(2,"date"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.updatedAt,"HH:mm:ss"))}}function ny(t,e){if(1&t&&(Ns(0,"td",93),mo(1),Ua(2,"date"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.updatedAt,"dd.MM.yy"))}}function ry(t,e){if(1&t){const t=zs();Ns(0,"td"),Ns(1,"button",94),Js("click",(function(){ei(t);const e=Xs().index;return Xs(3).initSetting(e)}))("click",(function(){ei(t);const e=Xs().index;return Xs(3).helperSettingIndex(e)})),Ua(2,"translate"),mo(3,"\xd7"),Fs(),Fs()}2&t&&(_n(1),to("title",Ea(2,1,"vcDetail.lbl.deleteSetting")))}function sy(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td"),mo(2),Fs(),Ns(3,"td",90),Js("click",(function(){ei(t);const i=e.index;return Xs(3).initSetting(i)})),Ns(4,"a"),mo(5),Fs(),Fs(),Ns(6,"td",91),mo(7),Ua(8,"date"),Fs(),Gs(9,iy,3,4,"td",92),Gs(10,ny,3,4,"td",92),Gs(11,ry,4,3,"td",0),Fs()}if(2&t){const t=e.$implicit,i=e.index,n=Xs(3);_n(2),fo(i+1),_n(3),fo(t.name),_n(2),fo(Oa(8,6,t.timestamp,"dd.MM.yyyy")),_n(2),js("ngIf",n.isToday(t.updatedAt)),_n(1),js("ngIf",!n.isToday(t.updatedAt)),_n(1),js("ngIf",n.hasVCPerm(n.permVC.Modify))}}function oy(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div"),Ns(2,"div",64),Ns(3,"div",65),Ns(4,"h4",66),mo(5),Ua(6,"translate"),Fs(),Fs(),Fs(),Ns(7,"div",68),Ns(8,"table",69),Ns(9,"thead",88),Ns(10,"tr"),Ns(11,"th"),mo(12),Ua(13,"translate"),Fs(),Ns(14,"th",1),Js("click",(function(){return ei(t),Xs(2).sortSettingTable(1)})),mo(15),Ua(16,"translate"),Fs(),Ns(17,"th",1),Js("click",(function(){return ei(t),Xs(2).sortSettingTable(2)})),mo(18),Ua(19,"translate"),Fs(),Ns(20,"th",1),Js("click",(function(){return ei(t),Xs(2).sortSettingTable(3)})),mo(21),Ua(22,"translate"),Fs(),Gs(23,ey,3,3,"th",0),Fs(),Fs(),Ns(24,"tbody",89),Gs(25,sy,12,9,"tr",34),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(5),vo(" ",Ea(6,7,"vcDetail.titleSettings")," "),_n(7),fo(Ea(13,9,"vcDetail.lbl.nr")),_n(3),fo(Ea(16,11,"vcDetail.lbl.settingName")),_n(3),fo(Ea(19,13,"vcDetail.lbl.timestamp")),_n(3),fo(Ea(22,15,"vcDetail.lbl.updatedAt")),_n(2),js("ngIf",t.hasVCPerm(t.permVC.ManagePerm)),_n(2),js("ngForOf",t.vcSettings)}}function ay(t,e){if(1&t){const t=zs();Ns(0,"button",95),Js("click",(function(){return ei(t),Xs(2).save()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vcDetail.btn.save")))}function ly(t,e){1&t&&(Ns(0,"div",96),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vcDetail.msg.emailRequired")))}function cy(t,e){if(1&t&&(Ns(0,"option"),mo(1),Fs()),2&t){const t=e.$implicit;_n(1),fo(t.name)}}function dy(t,e){1&t&&(Ns(0,"div",96),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vcDetail.msg.groupRequired")))}function uy(t,e){1&t&&(Ns(0,"div",96),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vcDetail.msg.invalidMessage")))}function hy(t,e){1&t&&(Ns(0,"button",97),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vcDetail.btn.invite")))}function py(t,e){if(1&t){const t=zs();Ns(0,"button",98),Js("click",(function(){return ei(t),Xs(2).addNewVCUser()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vcDetail.btn.invite")))}function gy(t,e){if(1&t){const t=zs();Ns(0,"div",17),Ns(1,"div",18),Ns(2,"div",19),Ns(3,"h5",99),mo(4),Ua(5,"translate"),Fs(),Ns(6,"button",21),Ns(7,"span",22),mo(8,"\xd7"),Fs(),Fs(),Fs(),Ns(9,"div",23),Ns(10,"div"),Ns(11,"label",100),mo(12),Ua(13,"translate"),Fs(),Fs(),Ns(14,"form"),Ns(15,"div",101),Ns(16,"label",102),mo(17),Ua(18,"translate"),Fs(),Ns(19,"label",103),mo(20),Fs(),Fs(),Ns(21,"div",101),Ns(22,"label",104),mo(23),Ua(24,"translate"),Fs(),Ns(25,"label",103),mo(26),Fs(),Fs(),Ns(27,"div",101),Ns(28,"label",104),mo(29),Ua(30,"translate"),Fs(),Ns(31,"label",103),mo(32),Fs(),Fs(),Fs(),Fs(),Ns(33,"div",38),Ns(34,"button",105),mo(35),Ua(36,"translate"),Fs(),Ns(37,"button",106),Js("click",(function(){ei(t);const e=Xs(2);return e.removeVCUser(e.vgUsers[e.userIndex],e.visbocenter._id)})),mo(38),Ua(39,"translate"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(4),fo(Ea(5,10,"vcDetail.titleRemoveUser")),_n(8),fo(Ea(13,12,"vcDetail.msg.removeUserConfirm")),_n(5),vo("",Ea(18,14,"vcDetail.lbl.vc"),":"),_n(3),vo("",t.visbocenter.name," "),_n(3),vo("",Ea(24,16,"vcDetail.lbl.user"),":"),_n(3),fo(t.vgUsers[t.userIndex].email),_n(3),vo("",Ea(30,18,"vcDetail.lbl.group"),":"),_n(3),fo(t.vgUsers[t.userIndex].groupName),_n(3),fo(Ea(36,20,"vcDetail.btn.back")),_n(3),fo(Ea(39,22,"vcDetail.btn.delete"))}}function my(t,e){1&t&&(Ns(0,"h5",133),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vcDetail.titleModifyGroup")))}function fy(t,e){1&t&&(Ns(0,"h5",133),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vcDetail.titleAddGroup")))}const vy=function(t){return{"has-error":t}};function by(t,e){if(1&t&&(Ns(0,"div",26),Ns(1,"label",134),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",135),mo(5),Fs(),Fs()),2&t){Xs();const t=Ls(10),e=Xs(2);js("ngClass",ka(5,vy,t.submitted)),_n(2),vo("",Ea(3,3,"vcDetail.lbl.name"),":"),_n(3),fo(e.actGroup.name)}}function yy(t,e){1&t&&(Ns(0,"div",96),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vcDetail.msg.groupNameRequired")))}function Cy(t,e){if(1&t){const t=zs();Ns(0,"div",26),Ns(1,"label",134),mo(2),Ua(3,"translate"),Fs(),Ns(4,"input",136,137),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.name=e})),Fs(),Gs(6,yy,3,3,"div",30),Fs()}if(2&t){const t=Ls(5);Xs();const e=Ls(10),i=Xs(2);js("ngClass",ka(6,vy,e.submitted)),_n(2),vo("",Ea(3,4,"vcDetail.lbl.name"),":"),_n(2),js("ngModel",i.actGroup.name),_n(2),js("ngIf",t.errors&&(t.dirty||t.touched))}}function Vy(t,e){if(1&t){const t=zs();Ns(0,"div",138),Ns(1,"div"),mo(2),Ua(3,"translate"),Fs(),Ns(4,"div",111),Ns(5,"input",139,140),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedVPView=e})),Fs(),Ns(7,"label",141),mo(8),Ua(9,"translate"),Fs(),Fs(),Ns(10,"div",111),Ns(11,"input",142,143),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedVPViewAudit=e})),Fs(),Ns(13,"label",144),mo(14),Ua(15,"translate"),Fs(),Fs(),Ns(16,"div",111),Ns(17,"input",145,146),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedVPModify=e})),Fs(),Ns(19,"label",147),mo(20),Ua(21,"translate"),Fs(),Fs(),Ns(22,"div",111),Ns(23,"input",148,149),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedCreateVariant=e})),Fs(),Ns(25,"label",150),mo(26),Ua(27,"translate"),Fs(),Fs(),Ns(28,"div",111),Ns(29,"input",151,152),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedVPManagePerm=e})),Fs(),Ns(31,"label",153),mo(32),Ua(33,"translate"),Fs(),Fs(),Ns(34,"div",111),Ns(35,"input",154,155),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedVPDelete=e})),Fs(),Ns(37,"label",156),mo(38),Ua(39,"translate"),Fs(),Fs(),Fs()}if(2&t){const t=Xs(3);_n(2),fo(Ea(3,13,"perm.titleVPPerm")),_n(3),js("ngModel",t.actGroup.checkedVPView),_n(3),fo(Ea(9,15,"perm.vpView")),_n(3),js("ngModel",t.actGroup.checkedVPViewAudit),_n(3),fo(Ea(15,17,"perm.vpViewAudit")),_n(3),js("ngModel",t.actGroup.checkedVPModify),_n(3),fo(Ea(21,19,"perm.vpModify")),_n(3),js("ngModel",t.actGroup.checkedCreateVariant),_n(3),fo(Ea(27,21,"perm.vpCreateVariant")),_n(3),js("ngModel",t.actGroup.checkedVPManagePerm),_n(3),fo(Ea(33,23,"perm.vpManagePerm")),_n(3),js("ngModel",t.actGroup.checkedVPDelete),_n(3),fo(Ea(39,25,"perm.vpDelete"))}}function wy(t,e){if(1&t){const t=zs();Ns(0,"div",160),Ns(1,"a",161),Js("click",(function(){return ei(t),Xs(5).switchView("Users")})),mo(2),Fs(),Fs()}if(2&t){const t=Xs().$implicit;_n(2),fo(t.email)}}function Ay(t,e){if(1&t&&(Hs(0,64),Gs(1,wy,3,1,"div",159),Ks()),2&t){const t=e.$implicit,i=Xs(4);_n(1),js("ngIf",t.groupName==i.actGroup.name)}}function Py(t,e){if(1&t&&(Ns(0,"div",138),Ns(1,"label",157),mo(2),Ua(3,"translate"),Fs(),Gs(4,Ay,2,1,"ng-container",158),Fs()),2&t){const t=Xs(3);_n(2),fo(Ea(3,2,"perm.lblGroupMembers")),_n(2),js("ngForOf",t.vgUsers)}}function ky(t,e){1&t&&(Ns(0,"div",138),Ns(1,"label",157),mo(2),Ua(3,"translate"),Fs(),Fs()),2&t&&(_n(2),fo(Ea(3,1,"perm.lblNoGroupMembers")))}function Dy(t,e){if(1&t&&(Ns(0,"button",162),mo(1),Fs()),2&t){const t=Xs(3);_n(1),fo(t.confirm)}}function My(t,e){if(1&t){const t=zs();Ns(0,"button",163),Js("click",(function(){return ei(t),Xs(3).addModifyVCGroup()})),mo(1),Fs()}if(2&t){const t=Xs(3);_n(1),fo(t.confirm)}}function Sy(t,e){if(1&t){const t=zs();Ns(0,"div",17),Ns(1,"div",18),Ns(2,"div",19),Gs(3,my,3,3,"h5",107),Gs(4,fy,3,3,"h5",107),Ns(5,"button",21),Ns(6,"span",22),mo(7,"\xd7"),Fs(),Fs(),Fs(),Ns(8,"div",23),Ns(9,"form",108,109),Gs(11,by,6,7,"div",110),Gs(12,Cy,7,8,"div",110),Ns(13,"div"),mo(14),Ua(15,"translate"),Fs(),Ns(16,"div",111),Ns(17,"input",112,113),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedView=e})),Fs(),Ns(19,"label",114),mo(20),Ua(21,"translate"),Fs(),Fs(),Ns(22,"div",111),Ns(23,"input",115,116),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedViewAudit=e})),Fs(),Ns(25,"label",117),mo(26),Ua(27,"translate"),Fs(),Fs(),Ns(28,"div",111),Ns(29,"input",118,119),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedModify=e})),Fs(),Ns(31,"label",120),mo(32),Ua(33,"translate"),Fs(),Fs(),Ns(34,"div",111),Ns(35,"input",121,122),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedCreateVP=e})),Fs(),Ns(37,"label",123),mo(38),Ua(39,"translate"),Fs(),Fs(),Ns(40,"div",111),Ns(41,"input",124,125),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedManagePerm=e})),Fs(),Ns(43,"label",126),mo(44),Ua(45,"translate"),Fs(),Fs(),Bs(46,"br"),Ns(47,"div",111),Ns(48,"input",127,128),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.global=e})),Fs(),Ns(50,"label",129),mo(51),Ua(52,"translate"),Fs(),Fs(),Gs(53,Vy,40,27,"div",130),Gs(54,Py,5,4,"div",130),Gs(55,ky,4,3,"div",130),Ns(56,"div",38),Ns(57,"button",39),mo(58),Ua(59,"translate"),Fs(),Gs(60,Dy,2,1,"button",131),Gs(61,My,2,1,"button",132),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Ls(10),e=Xs(2);_n(3),js("ngIf",e.actGroup._id),_n(1),js("ngIf",!e.actGroup._id),_n(7),js("ngIf",e.actGroup.internal),_n(1),js("ngIf",!e.actGroup.internal),_n(2),fo(Ea(15,23,"perm.titleVCPerm")),_n(3),js("ngModel",e.actGroup.checkedView),_n(3),fo(Ea(21,25,"perm.vcView")),_n(3),js("ngModel",e.actGroup.checkedViewAudit),_n(3),fo(Ea(27,27,"perm.vcViewAudit")),_n(3),js("ngModel",e.actGroup.checkedModify),_n(3),fo(Ea(33,29,"perm.vcModify")),_n(3),js("ngModel",e.actGroup.checkedCreateVP),_n(3),fo(Ea(39,31,"perm.vcCreateVP")),_n(3),js("ngModel",e.actGroup.checkedManagePerm),_n(3),fo(Ea(45,33,"perm.vcManagePerm")),_n(4),js("ngModel",e.actGroup.global),_n(3),fo(Ea(52,35,"perm.vcGlobal")),_n(2),js("ngIf",e.actGroup.global),_n(1),js("ngIf",e.helperUsersPerGroup(e.actGroup.name)),_n(1),js("ngIf",!e.helperUsersPerGroup(e.actGroup.name)),_n(3),fo(Ea(59,37,"vcDetail.btn.back")),_n(2),js("ngIf",!(t.form.valid&&e.hasVCPerm(e.permVC.ManagePerm))),_n(1),js("ngIf",t.form.valid&&e.hasVCPerm(e.permVC.ManagePerm))}}function Iy(t,e){if(1&t){const t=zs();Ns(0,"div",17),Ns(1,"div",18),Ns(2,"div",19),Ns(3,"h5",99),mo(4),Ua(5,"translate"),Fs(),Ns(6,"button",21),Ns(7,"span",22),mo(8,"\xd7"),Fs(),Fs(),Fs(),Ns(9,"div",23),Ns(10,"div"),Ns(11,"label",100),mo(12),Ua(13,"translate"),Fs(),Fs(),Ns(14,"form"),Ns(15,"div",101),Ns(16,"label",102),mo(17),Ua(18,"translate"),Fs(),Ns(19,"label",103),mo(20),Fs(),Fs(),Ns(21,"div",101),Ns(22,"label",104),mo(23),Ua(24,"translate"),Fs(),Ns(25,"label",103),mo(26),Fs(),Fs(),Ns(27,"div",101),Ns(28,"label",104),mo(29),Ua(30,"translate"),Fs(),Ns(31,"label",103),mo(32),Fs(),Fs(),Fs(),Fs(),Ns(33,"div",38),Ns(34,"button",39),mo(35),Ua(36,"translate"),Fs(),Ns(37,"button",164),Js("click",(function(){ei(t);const e=Xs(2);return e.removeVCGroup(e.vgGroups[e.groupIndex])})),mo(38),Ua(39,"translate"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(4),fo(Ea(5,10,"vcDetail.titleDeleteGroup")),_n(8),fo(Ea(13,12,"vcDetail.msg.removeGroupConfirm")),_n(5),vo("",Ea(18,14,"vcDetail.lbl.vc"),":"),_n(3),vo("",t.visbocenter.name," "),_n(3),vo("",Ea(24,16,"vcDetail.lbl.group"),":"),_n(3),fo(t.vgGroups[t.groupIndex].name),_n(3),vo("",Ea(30,18,"vcDetail.lbl.members"),":"),_n(3),fo(t.vgGroups[t.groupIndex].users.length),_n(3),fo(Ea(36,20,"vcDetail.btn.back")),_n(3),fo(Ea(39,22,"vcDetail.btn.delete"))}}function xy(t,e){1&t&&Bs(0,"input",192)}function Ty(t,e){1&t&&Bs(0,"input",193)}function _y(t,e){1&t&&Bs(0,"input",194)}function Uy(t,e){1&t&&Bs(0,"input",195)}function Ey(t,e){1&t&&Bs(0,"input",196)}function Oy(t,e){1&t&&Bs(0,"input",197)}function Gy(t,e){1&t&&Bs(0,"input",198)}function Ly(t,e){1&t&&Bs(0,"input",199)}function Ry(t,e){1&t&&Bs(0,"input",200)}function jy(t,e){1&t&&Bs(0,"input",201)}function $y(t,e){1&t&&Bs(0,"input",202)}function Ny(t,e){1&t&&Bs(0,"input",203)}function Fy(t,e){1&t&&Bs(0,"input",204)}function By(t,e){1&t&&Bs(0,"input",205)}function Hy(t,e){1&t&&Bs(0,"input",206)}function Ky(t,e){1&t&&Bs(0,"input",207)}function qy(t,e){1&t&&Bs(0,"input",208)}function zy(t,e){1&t&&Bs(0,"input",209)}function Qy(t,e){1&t&&Bs(0,"input",210)}function Wy(t,e){1&t&&Bs(0,"input",211)}function Jy(t,e){1&t&&Bs(0,"input",212)}function Yy(t,e){1&t&&Bs(0,"input",213)}function Zy(t,e){if(1&t){const t=zs();Ns(0,"div",160),Ns(1,"a",161),Js("click",(function(){return ei(t),Xs(4).switchView("Groups")})),mo(2),Fs(),Fs()}if(2&t){const t=Xs().$implicit;_n(2),fo(t.groupName)}}function Xy(t,e){if(1&t&&(Hs(0,64),Gs(1,Zy,3,1,"div",159),Ks()),2&t){const t=e.$implicit,i=Xs(3);_n(1),js("ngIf",t.email==i.vgUsers[i.userIndex].email)}}const tC=function(t){return{name:t}};function eC(t,e){if(1&t&&(Ns(0,"div",165),Ns(1,"div",166),Ns(2,"div",18),Ns(3,"div",19),Ns(4,"h5",167),mo(5),Ua(6,"translate"),Fs(),Ns(7,"button",21),Ns(8,"span",22),mo(9,"\xd7"),Fs(),Fs(),Fs(),Ns(10,"div",23),Ns(11,"div",138),mo(12),Ua(13,"translate"),Fs(),Ns(14,"div",111),Gs(15,xy,1,0,"input",168),Gs(16,Ty,1,0,"input",169),Ns(17,"label",114),mo(18),Ua(19,"translate"),Fs(),Fs(),Ns(20,"div",111),Gs(21,_y,1,0,"input",170),Gs(22,Uy,1,0,"input",171),Ns(23,"label",117),mo(24),Ua(25,"translate"),Fs(),Fs(),Ns(26,"div",111),Gs(27,Ey,1,0,"input",172),Gs(28,Oy,1,0,"input",173),Ns(29,"label",120),mo(30),Ua(31,"translate"),Fs(),Fs(),Ns(32,"div",111),Gs(33,Gy,1,0,"input",174),Gs(34,Ly,1,0,"input",175),Ns(35,"label",123),mo(36),Ua(37,"translate"),Fs(),Fs(),Ns(38,"div",111),Gs(39,Ry,1,0,"input",176),Gs(40,jy,1,0,"input",177),Ns(41,"label",126),mo(42),Ua(43,"translate"),Fs(),Fs(),Bs(44,"br"),Ns(45,"div"),mo(46),Ua(47,"translate"),Fs(),Ns(48,"div",111),Gs(49,$y,1,0,"input",178),Gs(50,Ny,1,0,"input",179),Ns(51,"label",141),mo(52),Ua(53,"translate"),Fs(),Fs(),Ns(54,"div",111),Gs(55,Fy,1,0,"input",180),Gs(56,By,1,0,"input",181),Ns(57,"label",144),mo(58),Ua(59,"translate"),Fs(),Fs(),Ns(60,"div",111),Gs(61,Hy,1,0,"input",182),Gs(62,Ky,1,0,"input",183),Ns(63,"label",147),mo(64),Ua(65,"translate"),Fs(),Fs(),Ns(66,"div",111),Gs(67,qy,1,0,"input",184),Gs(68,zy,1,0,"input",185),Ns(69,"label",150),mo(70),Ua(71,"translate"),Fs(),Fs(),Ns(72,"div",111),Gs(73,Qy,1,0,"input",186),Gs(74,Wy,1,0,"input",187),Ns(75,"label",153),mo(76),Ua(77,"translate"),Fs(),Fs(),Ns(78,"div",111),Gs(79,Jy,1,0,"input",188),Gs(80,Yy,1,0,"input",189),Ns(81,"label",156),mo(82),Ua(83,"translate"),Fs(),Fs(),Ns(84,"label",190),mo(85),Ua(86,"translate"),Fs(),Gs(87,Xy,2,1,"ng-container",158),Ns(88,"div",38),Ns(89,"button",191),mo(90),Ua(91,"translate"),Fs(),Fs(),Fs(),Fs(),Fs(),Fs()),2&t){const t=Xs(2);_n(5),fo(Oa(6,39,"vcDetail.titlePermUser",ka(72,tC,t.vgUsers[t.userIndex].email))),_n(7),fo(Ea(13,42,"perm.titleVCPerm")),_n(3),js("ngIf",t.hasUserVCPerm(t.permVC.View)),_n(1),js("ngIf",!t.hasUserVCPerm(t.permVC.View)),_n(2),fo(Ea(19,44,"perm.vcView")),_n(3),js("ngIf",t.hasUserVCPerm(t.permVC.ViewAudit)),_n(1),js("ngIf",!t.hasUserVCPerm(t.permVC.ViewAudit)),_n(2),fo(Ea(25,46,"perm.vcViewAudit")),_n(3),js("ngIf",t.hasUserVCPerm(t.permVC.Modify)),_n(1),js("ngIf",!t.hasUserVCPerm(t.permVC.Modify)),_n(2),fo(Ea(31,48,"perm.vcModify")),_n(3),js("ngIf",t.hasUserVCPerm(t.permVC.CreateVP)),_n(1),js("ngIf",!t.hasUserVCPerm(t.permVC.CreateVP)),_n(2),fo(Ea(37,50,"perm.vcCreateVP")),_n(3),js("ngIf",t.hasUserVCPerm(t.permVC.ManagePerm)),_n(1),js("ngIf",!t.hasUserVCPerm(t.permVC.ManagePerm)),_n(2),fo(Ea(43,52,"perm.vcManagePerm")),_n(4),fo(Ea(47,54,"perm.titleVPPerm")),_n(3),js("ngIf",t.hasUserVPPerm(t.permVP.View)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.View)),_n(2),fo(Ea(53,56,"perm.vpView")),_n(3),js("ngIf",t.hasUserVPPerm(t.permVP.ViewAudit)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.ViewAudit)),_n(2),fo(Ea(59,58,"perm.vpViewAudit")),_n(3),js("ngIf",t.hasUserVPPerm(t.permVP.Modify)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.Modify)),_n(2),fo(Ea(65,60,"perm.vpModify")),_n(3),js("ngIf",t.hasUserVPPerm(t.permVP.CreateVariant)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.CreateVariant)),_n(2),fo(Ea(71,62,"perm.vpCreateVariant")),_n(3),js("ngIf",t.hasUserVPPerm(t.permVP.ManagePerm)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.ManagePerm)),_n(2),fo(Ea(77,64,"perm.vpManagePerm")),_n(3),js("ngIf",t.hasUserVPPerm(t.permVP.DeleteVP)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.DeleteVP)),_n(2),fo(Ea(83,66,"perm.vpDelete")),_n(3),fo(Ea(86,68,"perm.lblGroupMembership")),_n(2),js("ngForOf",t.vgUsers),_n(3),fo(Ea(91,70,"vcDetail.btn.back"))}}function iC(t,e){if(1&t){const t=zs();Ns(0,"div",17),Ns(1,"div",18),Ns(2,"div",19),Ns(3,"h5",214),mo(4),Ua(5,"translate"),Fs(),Ns(6,"button",21),Ns(7,"span",22),mo(8,"\xd7"),Fs(),Fs(),Fs(),Ns(9,"div",23),Ns(10,"form",215),Ns(11,"div",101),Ns(12,"label",216),mo(13),Ua(14,"translate"),Fs(),Ns(15,"label",217),mo(16),Fs(),Fs(),Ns(17,"div",101),Ns(18,"label",218),mo(19),Ua(20,"translate"),Fs(),Ns(21,"label",219),mo(22),Fs(),Fs(),Ns(23,"div",101),Ns(24,"label",220),mo(25),Ua(26,"translate"),Fs(),Ns(27,"label",221),mo(28),Ua(29,"date"),Fs(),Fs(),Ns(30,"div",101),Ns(31,"label",222),mo(32),Ua(33,"translate"),Fs(),Ns(34,"label",223),mo(35),Ua(36,"date"),Fs(),Fs(),Fs(),Fs(),Ns(37,"div",38),Ns(38,"button",39),mo(39),Ua(40,"translate"),Fs(),Ns(41,"button",224),Js("click",(function(){return ei(t),Xs(2).downloadSetting()})),mo(42),Ua(43,"translate"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(4),fo(Ea(5,11,"vcDetail.titleSettings")),_n(9),vo("",Ea(14,13,"vcDetail.lbl.settingName"),":"),_n(3),vo("",t.vcSetting.name," "),_n(3),vo("",Ea(20,15,"vcDetail.lbl.settingType"),":"),_n(3),vo("",t.vcSetting.type," "),_n(3),vo("",Ea(26,17,"vcDetail.lbl.timestamp"),":"),_n(3),vo("",Oa(29,19,t.vcSetting.timestamp,"dd.MM.yy")," "),_n(4),vo("",Ea(33,22,"vcDetail.lbl.updatedAt"),":"),_n(3),vo("",Oa(36,24,t.vcSetting.updatedAt,"dd.MM.yy")," "),_n(4),fo(Ea(40,27,"vcDetail.btn.cancel")),_n(3),fo(Ea(43,29,"vcDetail.btn.download"))}}function nC(t,e){if(1&t&&(Ns(0,"div",101),Ns(1,"label",228),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",103),mo(5),Ua(6,"date"),Fs(),Fs()),2&t){const t=Xs(3);_n(2),vo("",Ea(3,2,"vcDetail.lbl.timestamp"),":"),_n(3),vo("",Oa(6,4,t.vcSetting.timestamp,"dd.MM.yyyy HH:mm")," ")}}function rC(t,e){if(1&t){const t=zs();Ns(0,"div",17),Ns(1,"div",18),Ns(2,"div",19),Ns(3,"h5",225),mo(4),Ua(5,"translate"),Fs(),Ns(6,"button",21),Ns(7,"span",22),mo(8,"\xd7"),Fs(),Fs(),Fs(),Ns(9,"div",23),Ns(10,"div"),Ns(11,"label",100),mo(12),Ua(13,"translate"),Fs(),Fs(),Ns(14,"form"),Ns(15,"div",101),Ns(16,"label",216),mo(17),Ua(18,"translate"),Fs(),Ns(19,"label",103),mo(20),Fs(),Fs(),Ns(21,"div",101),Ns(22,"label",218),mo(23),Ua(24,"translate"),Fs(),Ns(25,"label",103),mo(26),Fs(),Fs(),Gs(27,nC,7,7,"div",226),Ns(28,"div",101),Ns(29,"label",227),mo(30),Ua(31,"translate"),Fs(),Ns(32,"label",103),mo(33),Ua(34,"date"),Fs(),Fs(),Fs(),Fs(),Ns(35,"div",38),Ns(36,"button",39),mo(37),Ua(38,"translate"),Fs(),Ns(39,"button",164),Js("click",(function(){ei(t);const e=Xs(2);return e.removeVCSetting(e.vcSetting)})),mo(40),Ua(41,"translate"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(4),fo(Ea(5,11,"vcDetail.titleDeleteSetting")),_n(8),fo(Ea(13,13,"vcDetail.msg.removeSettingConfirm")),_n(5),vo("",Ea(18,15,"vcDetail.lbl.setting"),":"),_n(3),vo("",t.vcSetting.name," "),_n(3),vo("",Ea(24,17,"vcDetail.lbl.settingType"),":"),_n(3),vo("",t.vcSetting.type," "),_n(1),js("ngIf",t.vcSetting.timestamp),_n(3),vo("",Ea(31,19,"vcDetail.lbl.updatedAt"),":"),_n(3),vo("",Oa(34,21,t.vcSetting.updatedAt,"dd.MM.yyyy HH:mm")," "),_n(4),fo(Ea(38,24,"vcDetail.btn.back")),_n(3),fo(Ea(41,26,"vcDetail.btn.delete"))}}function sC(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"h3"),mo(2),Ua(3,"translate"),Ns(4,"a",1),Js("click",(function(){ei(t);const e=Xs();return e.gotoVPList(e.visbocenter)})),mo(5),Ua(6,"uppercase"),Fs(),Fs(),Ns(7,"form"),Ns(8,"div",2),Ns(9,"label",3),mo(10),Ua(11,"translate"),Fs(),Gs(12,xb,1,1,"input",4),Gs(13,Tb,2,1,"label",5),Fs(),Ns(14,"div",2),Ns(15,"label",6),mo(16),Ua(17,"translate"),Fs(),Gs(18,_b,1,1,"textarea",7),Gs(19,Ub,2,1,"label",8),Fs(),Ns(20,"div",9),Ns(21,"label",10),mo(22),Ua(23,"translate"),Fs(),Ns(24,"label",11),mo(25),Ua(26,"date"),Fs(),Ns(27,"label",12),mo(28),Ua(29,"date"),Fs(),Fs(),Fs(),Gs(30,jb,7,5,"div",0),Gs(31,ty,4,3,"div",0),Ns(32,"div"),Gs(33,oy,26,17,"div",0),Fs(),Ns(34,"div",13),Gs(35,ay,3,3,"button",14),Ns(36,"button",15),Js("click",(function(){return ei(t),Xs().goBack()})),mo(37),Ua(38,"translate"),Fs(),Fs(),Ns(39,"div",16),Ns(40,"div",17),Ns(41,"div",18),Ns(42,"div",19),Ns(43,"h5",20),mo(44),Ua(45,"translate"),Fs(),Ns(46,"button",21),Ns(47,"span",22),mo(48,"\xd7"),Fs(),Fs(),Fs(),Ns(49,"div",23),Ns(50,"form",24,25),Ns(52,"div",26),Ns(53,"label",27),mo(54),Ua(55,"translate"),Fs(),Ns(56,"input",28,29),Js("ngModelChange",(function(e){return ei(t),Xs().newUserInvite.email=e})),Fs(),Gs(58,ly,3,3,"div",30),Fs(),Ns(59,"div",26),Ns(60,"label",31),mo(61),Ua(62,"translate"),Fs(),Ns(63,"select",32,33),Js("ngModelChange",(function(e){return ei(t),Xs().newUserInvite.groupName=e})),Bs(65,"option"),Gs(66,cy,2,1,"option",34),Fs(),Gs(67,dy,3,3,"div",30),Fs(),Ns(68,"div",26),Ns(69,"label",35),mo(70),Ua(71,"translate"),Fs(),Ns(72,"textarea",36,37),Js("ngModelChange",(function(e){return ei(t),Xs().newUserInvite.inviteMessage=e})),mo(74," "),Fs(),Fs(),Gs(75,uy,3,3,"div",30),Ns(76,"div",38),Ns(77,"button",39),mo(78),Ua(79,"translate"),Fs(),Gs(80,hy,3,3,"button",40),Gs(81,py,3,3,"button",41),Fs(),Fs(),Fs(),Fs(),Fs(),Fs(),Ns(82,"div",42),Gs(83,gy,40,24,"div",43),Fs(),Ns(84,"div",44),Gs(85,Sy,62,39,"div",43),Fs(),Ns(86,"div",45),Gs(87,Iy,40,24,"div",43),Fs(),Gs(88,eC,92,74,"div",46),Ns(89,"div",47),Gs(90,iC,44,31,"div",43),Fs(),Ns(91,"div",48),Gs(92,rC,42,28,"div",43),Fs(),Fs()}if(2&t){const t=Ls(51),e=Ls(57),i=Ls(64),n=Ls(73),r=Xs();_n(2),vo("",Ea(3,39,"vcDetail.title"),": "),_n(3),fo(Ea(6,41,r.visbocenter.name)),_n(5),vo("",Ea(11,43,"vcDetail.lbl.name"),":"),_n(2),js("ngIf",r.hasVCPerm(r.permVC.Modify)),_n(1),js("ngIf",!r.hasVCPerm(r.permVC.Modify)),_n(3),vo("",Ea(17,45,"vcDetail.lbl.description"),":"),_n(2),js("ngIf",r.hasVCPerm(r.permVC.Modify)),_n(1),js("ngIf",!r.hasVCPerm(r.permVC.Modify)),_n(3),vo("",Ea(23,47,"vcDetail.lbl.createdUpdated"),":"),_n(3),vo("",Oa(26,49,r.visbocenter.createdAt,"dd.MM.yyyy HH:mm:ss")," "),_n(3),vo("",Oa(29,52,r.visbocenter.updatedAt,"dd.MM.yyyy HH:mm:ss")," "),_n(2),js("ngIf",r.getVCPerm()!=r.permVC.View),_n(1),js("ngIf",r.getVCPerm()!=r.permVC.View),_n(2),js("ngIf","Settings"==r.showList),_n(2),js("ngIf",r.hasVCPerm(r.permVC.Modify)),_n(2),fo(Ea(38,55,"vcDetail.btn.back")),_n(7),fo(Ea(45,57,"vcDetail.titleAddUser")),_n(8),js("ngClass",ka(67,vy,t.submitted&&!e.valid)),_n(2),vo("",Ea(55,59,"vcDetail.lbl.email"),":"),_n(2),js("ngModel",r.newUserInvite.email),_n(2),js("ngIf",t.submitted&&!e.valid),_n(1),js("ngClass",ka(69,vy,t.submitted&&!i.valid)),_n(2),vo("",Ea(62,61,"vcDetail.lbl.group"),":"),_n(2),js("ngModel",r.newUserInvite.groupName),_n(3),js("ngForOf",r.vgGroups),_n(1),js("ngIf",t.submitted&&!i.valid),_n(1),js("ngClass",ka(71,vy,t.submitted&&!n.valid)),_n(2),vo("",Ea(71,63,"vcDetail.lbl.message"),":"),_n(2),js("ngModel",r.newUserInvite.inviteMessage),_n(3),js("ngIf",t.submitted&&!n.valid),_n(3),fo(Ea(79,65,"vcDetail.btn.cancel")),_n(2),js("ngIf",!(e.valid&&i.valid)),_n(1),js("ngIf",e.valid&&i.valid),_n(2),js("ngIf",r.userIndex>=0&&r.userIndex<r.vgUsers.length),_n(2),js("ngIf",r.actGroup),_n(2),js("ngIf",r.groupIndex>=0&&r.groupIndex<r.vgGroups.length),_n(1),js("ngIf",r.vgUsers&&r.userIndex>=0),_n(2),js("ngIf",r.vcSetting),_n(2),js("ngIf",r.vcSetting)}}class oC{}let aC=(()=>{class t{constructor(t,e,i,n,r,s,o,a,l){this.messageService=t,this.visbocenterService=e,this.visbosettingService=i,this.route=n,this.location=r,this.router=s,this.alertService=o,this.translate=a,this.titleService=l,this.newUserInvite=new Yh,this.showList="Users",this.permVC=Av,this.permVP=Pv,this.sortUserColumn=1,this.sortUserAscending=!0,this.sortVPUserColumn=1,this.sortVPUserAscending=!0,this.sortGroupColumn=1,this.sortGroupAscending=!0,this.sortSettingColumn=1,this.sortSettingAscending=!0}ngOnInit(){this.getVisboCenter(),this.getVisboCenterUsers()}getVisboCenter(){const t=this.route.snapshot.paramMap.get("id");this.visbocenterService.getVisboCenter(t).subscribe(t=>{this.visbocenter=t,this.combinedPerm=t.perm,this.titleService.setTitle(this.translate.instant("vcDetail.titleName",{name:t.name})),this.log(`VisboCenter initialised ${this.visbocenter._id} Perm ${JSON.stringify(this.combinedPerm)} `)},t=>{if(this.log(`Get VC failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vcDetail.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Lh(t))})}hasVCPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vc&t)>0}getVCPerm(){return void 0===this.combinedPerm?0:this.combinedPerm.vc}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}hasUserVCPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vc&t)>0}hasUserVPPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vp&t)>0}getVisboCenterUsers(){const t=this.route.snapshot.paramMap.get("id");this.log("VisboCenter UserList of: "+t),this.visbocenterService.getVCUsers(t).subscribe(t=>{this.vgUsers=t.users,this.vgGroups=t.groups,this.vgVPUsers=t.vpusers,this.log(`fetched Users ${this.vgUsers.length}, Groups ${this.vgGroups.length} Project Users ${this.vgVPUsers.length}`),this.sortUserTable(),this.sortGroupTable()},t=>{if(this.log(`Get VC Users failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vcDetail.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Lh(t))})}gotoVCAudit(t){this.router.navigate(["vcAudit/".concat(t._id)])}goBack(){this.location.back()}gotoVPList(t){this.router.navigate(["vp/".concat(t._id)])}gotoVPDetail(t){this.router.navigate(["vpDetail/".concat(t)])}save(){this.visbocenterService.updateVisboCenter(this.visbocenter).subscribe(t=>{const e=this.translate.instant("vcDetail.msg.updateVCSuccess",{name:t.name});this.alertService.success(e,!0),this.goBack()},t=>{if(this.log(`save VC failed: error: ${t.status} message: ${t.error.message} `),403===t.status){const t=this.translate.instant("vcDetail.msg.errorPermVC",{name:this.visbocenter.name});this.alertService.error(t)}else if(409===t.status){const t=this.translate.instant("vcDetail.msg.errorVCConflict",{name:this.visbocenter.name});this.alertService.error(t)}else this.alertService.error(Lh(t))})}switchView(t){this.showList=t,this.log("VisboCenter new View: "+t)}showSetting(){this.showList="Settings";const t=this.route.snapshot.paramMap.get("id");this.log("VisboCenter Settings of: "+t),this.visbosettingService.getVCSettings(t).subscribe(t=>{this.log("fetched VC Settings "+t.length),this.vcSettings=t,this.sortSettingTable()},t=>{if(this.log(`Get VC Settings failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vcDetail.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Lh(t))})}addNewVCUser(){const t=this.newUserInvite.email.trim(),e=this.newUserInvite.groupName.trim(),i=this.vgGroups.filter(t=>t.name===e)[0],n=i._id;let r="";this.newUserInvite.inviteMessage&&(r=this.newUserInvite.inviteMessage.trim());const s=this.visbocenter._id;this.log(`Add VisboCenter User: ${t} Group: ${e}/${n} VC: ${s}`),t&&n&&this.visbocenterService.addVCUser(t,n,r,s).subscribe(e=>{const n=new Mv;n.userId=e.users.filter(e=>e.email===t)[0].userId,n.email=t,n.groupId=e._id,n.groupName=e.name,n.groupType=i.groupType,n.internal=i.internal,this.log("Add VisboCenter User Push: "+JSON.stringify(n)),this.vgUsers.push(n),this.sortUserTable();for(let t=0;t<this.vgGroups.length;t++)if(this.vgGroups[t]._id===e._id){this.vgGroups[t]=e;break}const r=this.translate.instant("vcDetail.msg.addUserSuccess",{name:t});this.alertService.success(r)},t=>{if(this.log("Add VisboCenter User error: "+JSON.stringify(t)),403===t.status){const t=this.translate.instant("vcDetail.msg.errorAddUserPerm",{name:this.visbocenter.name});this.alertService.error(t)}else t.error&&(this.log("Error during add VC user "+t.error.message),this.alertService.error(Lh(t)))})}helperUserIndex(t){this.userIndex=t}helperSettingIndex(t){this.settingIndex=t}calcCombinedPerm(t){this.userIndex=t,this.combinedUserPerm={system:0,vc:0,vp:0},this.vgUsers.forEach(this.addUserPerm,this),this.log(`Combined Permission for ${this.vgUsers[t].email}  ${JSON.stringify(this.combinedUserPerm)}`)}addUserPerm(t){if(t.email!==this.vgUsers[this.userIndex].email)return;this.log("Add User Permission for "+t.groupName);const e=this.vgGroups.findIndex(e=>e.name===t.groupName);e>=0?this.vgGroups[e].permission?(this.combinedUserPerm.system=this.combinedUserPerm.system|(this.vgGroups[e].permission.system||0),this.combinedUserPerm.vc=this.combinedUserPerm.vc|(this.vgGroups[e].permission.vc||0),this.combinedUserPerm.vp=this.combinedUserPerm.vp|(this.vgGroups[e].permission.vp||0)):this.log("Permission for Group not set "+t.groupName):this.log("Group not found "+t.groupName)}helperRemoveGroup(t){this.groupIndex=t}helperUsersPerGroup(t){const e=this.vgGroups&&this.vgGroups.find(e=>e.name===t);return e?e.users.length:0}removeVCUser(t,e){this.log(`Remove VisboCenter User: ${t.email}/${t.userId} Group: ${t.groupName} VC: ${e}`),this.visbocenterService.deleteVCUser(t,e).subscribe(()=>{this.vgUsers=this.vgUsers.filter(e=>e!==t);for(let i=0;i<this.vgGroups.length;i++)if(this.vgGroups[i]._id===t.groupId){for(let e=0;e<this.vgGroups[i].users.length;e++)if(this.vgGroups[i].users[e].userId===t.userId){this.vgGroups[i].users.splice(e,1);break}break}const e=this.translate.instant("vcDetail.msg.removeUserSuccess",{name:t.email});this.alertService.success(e)},e=>{if(this.log("Remove VisboCenter User error: "+e.error.message),403===e.status){const e=this.translate.instant("vcDetail.msg.errorRemoveUserPerm",{name:t.email});this.alertService.error(e)}else this.log("Error during remove VC user "+e.error.message),this.alertService.error(Lh(e))})}helperVCPerm(t){let e=0;return t.checkedView&&(e+=this.permVC.View),t.checkedViewAudit&&(e+=this.permVC.ViewAudit),t.checkedModify&&(e+=this.permVC.Modify),t.checkedCreateVP&&(e+=this.permVC.CreateVP),t.checkedManagePerm&&(e+=this.permVC.ManagePerm),e}helperVPPerm(t){let e=0;return t.checkedVPView&&(e+=this.permVP.View),t.checkedVPViewAudit&&(e+=this.permVP.ViewAudit),t.checkedVPModify&&(e+=this.permVP.Modify),t.checkedCreateVariant&&(e+=this.permVP.CreateVariant),t.checkedVPManagePerm&&(e+=this.permVP.ManagePerm),t.checkedVPDelete&&(e+=this.permVP.DeleteVP),e}initGroup(t){this.actGroup=new Dv,t?(this.confirm=this.translate.instant("VC"===t.groupType?"vcDetail.btn.save":"vcDetail.btn.view"),this.actGroup._id=t._id,this.log(`Init Group Set GroupID : ${this.actGroup._id} ID ${t._id}`),this.actGroup.name=t.name,this.actGroup.groupType=t.groupType,this.actGroup.internal=t.internal,this.actGroup.global=t.global,this.actGroup.checkedView=(t.permission.vc&this.permVC.View)>0,this.actGroup.checkedViewAudit=(t.permission.vc&this.permVC.ViewAudit)>0,this.actGroup.checkedModify=(t.permission.vc&this.permVC.Modify)>0,this.actGroup.checkedCreateVP=(t.permission.vc&this.permVC.CreateVP)>0,this.actGroup.checkedManagePerm=(t.permission.vc&this.permVC.ManagePerm)>0,this.actGroup.checkedVPView=(t.permission.vp&this.permVP.View)>0,this.actGroup.checkedVPViewAudit=(t.permission.vp&this.permVP.ViewAudit)>0,this.actGroup.checkedVPModify=(t.permission.vp&this.permVP.Modify)>0,this.actGroup.checkedCreateVariant=(t.permission.vp&this.permVP.CreateVariant)>0,this.actGroup.checkedVPManagePerm=(t.permission.vp&this.permVP.ManagePerm)>0,this.actGroup.checkedVPDelete=(t.permission.vp&this.permVP.DeleteVP)>0):(this.confirm=this.translate.instant("vcDetail.btn.addGroup"),this.actGroup._id=void 0,this.actGroup.name="",this.actGroup.groupType="VC",this.actGroup.internal=!1,this.actGroup.global=!1,this.actGroup.checkedView=!0),this.log(`Init Group for Creation / Modification: ${this.actGroup.name} ID ${this.actGroup._id} Action ${this.confirm} `)}addModifyVCGroup(){const t=new kv;t.name=this.actGroup.name.trim(),t.global=this.actGroup.global,t.vcid=this.visbocenter._id,t.permission=new Vv,t.permission.vc=this.helperVCPerm(this.actGroup),t.permission.vp=this.helperVPPerm(this.actGroup),this.log(`Add/Modify VisboCenter Group: Group: ${t.name} New/Modify ${this.actGroup._id}`),this.actGroup._id?(this.log(`Modify VisboCenter Group: Group: ${t.name} VC: ${t.vcid} Perm: vc ${t.permission.vc} vp ${t.permission.vp}`),t._id=this.actGroup._id,this.visbocenterService.modifyVCGroup(t).subscribe(e=>{this.vgGroups=this.vgGroups.filter(e=>e._id!==t._id),this.vgGroups.push(e);for(let n=0;n<this.vgUsers.length;n++)this.vgUsers[n].groupId===t._id&&(this.vgUsers[n].groupName=e.name);this.sortUserTable(),this.sortGroupTable();const i=this.translate.instant("vcDetail.msg.changeGroupSuccess",{name:e.name});this.alertService.success(i)},e=>{if(this.log("Modify VisboCenter Group error: "+e.error.message),403===e.status){const e=this.translate.instant("vcDetail.msg.errorChangeGroupPerm",{name:t.name});this.alertService.error(e)}else this.log("Error during modify VC Group "+e.error.message),this.alertService.error(Lh(e))})):(this.log(`Add VisboCenter Group: Group: ${t.name} VC: ${t.vcid} Perm: vc ${t.permission.vc} vp ${t.permission.vp}`),this.visbocenterService.addVCGroup(t).subscribe(e=>{this.vgGroups.push(e);const i=this.translate.instant("vcDetail.msg.createGroupSuccess",{name:t.name});this.alertService.success(i)},e=>{if(this.log("Add VisboCenter Group error: "+e.error.message),403===e.status){const e=this.translate.instant("vcDetail.msg.errorCreateGroupPerm",{name:t.name});this.alertService.error(e)}else this.log("Error during add VC Group "+e.error.message),this.alertService.error(Lh(e))}))}removeVCGroup(t){this.log(`Remove VisboCenter Group: ${t.name}/${t._id} VC: ${t.vcid}`),this.visbocenterService.deleteVCGroup(t).subscribe(e=>{this.log("Remove VisboCenter Group result: "+JSON.stringify(e)),this.vgGroups=this.vgGroups.filter(e=>e!==t),this.vgUsers=this.vgUsers.filter(e=>e.groupId!==t._id);const i=this.translate.instant("vcDetail.msg.removeGroupSuccess",{name:t.name});this.alertService.success(i)},e=>{if(this.log("Remove VisboCenter Group error: "+e.error.message),403===e.status){const e=this.translate.instant("vcDetail.msg.errorRemoveGroupPerm",{name:t.name});this.alertService.error(e)}else this.log("Error during remove VC user "+e.error.message),this.alertService.error(Lh(e))})}initSetting(t){this.vcSetting=this.vcSettings[t]}removeVCSetting(t){this.log(`Remove VisboCenter Setting: ${t.name}/${t.type} Timestamp: ${t.timestamp}`),this.visbosettingService.deleteVCSetting(t).subscribe(e=>{this.log("Remove VisboCenter Setting result: "+JSON.stringify(e)),this.vcSettings=this.vcSettings.filter(e=>e!==t);const i=this.translate.instant("vcDetail.msg.removeSettingSuccess",{name:t.name});this.alertService.success(i)},e=>{if(this.log("Remove VisboCenter Setting error: "+e.error.message),403===e.status){const e=this.translate.instant("vcDetail.msg.errorRemoveSettingPerm",{name:t.name});this.alertService.error(e)}else this.log("Error during remove VC setting "+e.error.message),this.alertService.error(Lh(e))})}calcFullPath(t,e){if(!(e&&t>=0))return;let i="",n=t,r=-1;if(e[n]){const t=e[n]&&e[n].pid;t>=0&&(e[n].parent=e[t]&&e[t].name)}for(;n>=0&&e[n];)i="/".concat(e[n].name,i),n=e[n].pid,r+=1;e[t].path=i,e[t].level=r}downloadSetting(){var t;const e=this.vcSetting;if(this.log(`Download Setting ${e.name} ${e.type} ${e.updatedAt}`),"organisation"==e.type&&(null===(t=e.value)||void 0===t?void 0:t.allRoles)){const t=[];for(let h=0;e.value.allRoles&&h<e.value.allRoles.length;h++){const i=e.value.allRoles[h],n=i.uid;t[n]||(t[n]=new oC,t[n].uid=n,t[n].calcid=n,t[n].pid=void 0),t[n].name=i.name,t[n].isExternRole=i.isExternRole,t[n].defaultKapa=i.defaultKapa,t[n].tagessatz=i.tagessatzIntern,t[n].employeeNr=i.employeeNr,t[n].defaultDayCapa=i.defaultDayCapa,i.entryDate>"0001-01-01T00:00:00Z"&&(t[n].entryDate=i.entryDate),i.exitDate<"2200-11-30T23:00:00Z"&&(t[n].exitDate=i.exitDate),t[n].aliases=i.aliases,i.isTeam?(this.log("Skip Handling of Team Members"),t[n].type=2,t[n].isTeam=!0):t[n].type=1;for(let e=0;e<i.subRoleIDs.length;e++){const r=Number(i.subRoleIDs[e].key);if(r<0){this.log(`Inconsistent Org Structure Role ${n} SubRole ${i.subRoleIDs[e].key}`);break}t[r]?this.log(`SubRole already exists ${n} SubRole ${r}`):(t[r]=new oC,t[r].uid=r,t[r].calcid=r),t[r].pid||(t[r].pid=n)}}let i=0;e.value.allRoles.forEach(t=>{t.uid>i&&(i=t.uid)}),this.log("MaxID "+i);for(let h=0;h<e.value.allRoles.length;h++){const n=e.value.allRoles[h];if(n.isTeam&&n.subRoleIDs&&n.subRoleIDs.length>0)for(let e=0;e<n.subRoleIDs.length;e++){const r=n.subRoleIDs[e].key;if(!t[r]||t[r].isTeam)continue;const s=t[r];i+=1,t[i]=new oC,t[i].uid=r,t[i].calcid=i,t[i].type=2,t[i].pid=n.uid,t[i].name=s.name,t[i].parent=n.name,s.employeeNr&&(t[i].employeeNr=s.employeeNr),s.isExternRole&&(t[i].isExternRole=s.isExternRole),s.defaultDayCapa>=0&&(t[i].defaultDayCapa=s.defaultDayCapa),s.defaultKapa>=0&&(t[i].defaultKapa=s.defaultKapa),s.tagessatz>=0&&(t[i].tagessatz=s.tagessatz),s.entryDate&&(t[i].entryDate=s.entryDate),s.exitDate&&(t[i].exitDate=s.exitDate),s.aliases&&(t[i].aliases=s.aliases),t[i].percent=Number(n.subRoleIDs[e].value)||0}}t.forEach(e=>this.calcFullPath(e.calcid,t)),t.sort((function(t,e){return t.type!=e.type?t.type-e.type:xh(t.path,e.path)}));const n=[];for(let h=0;e.value.allCosts&&h<e.value.allCosts.length;h++){const t=e.value.allCosts[h],i=t.uid;n[i]||(n[i]=new oC,n[i].uid=i,n[i].calcid=i,n[i].pid=void 0),n[i].name=t.name,n[i].type=3;for(let e=0;t.subCostIDs&&e<t.subCostIDs.length;e++){const r=Number(t.subCostIDs[e].key);if(r<0){this.log(`Inconsistent Org Structure Cost ${i} SubCost ${t.subCostIDs[e].key}`);break}n[r]?this.log(`listCost already exists ${i} listCost ${r}`):(n[r]=new oC,n[r].uid=r,n[r].calcid=r),n[r].pid=i}}n.forEach(t=>this.calcFullPath(t.calcid,n)),n.sort((function(t,e){return t.type!=e.type?t.type-e.type:xh(t.path,e.path)})),n.forEach(e=>t.push(e)),this.log("Orga Structure "+JSON.stringify(t));let r="";const s="\t";r="sep="+s+"\n",r=r+"name"+s+"uid"+s+"type"+s+"organisation"+s+"isExternal"+s+"isTeam"+s+"defaultKapa"+s+"tagessatz"+s+"employeeNr"+s+"defaultDayCapa"+s+"entryDate"+s+"exitDate"+s+"percent"+s+"aliases\n";for(let e=0;e<t.length;e++){const i=t[e];if(!i)continue;const n='"'+i.name.padStart(i.name.length+i.level," ")+'"'+s+i.uid+s+(i.type||"")+s+(i.parent||"")+s+(i.isExternRole?"1":"")+s+(i.isTeam?"1":"")+s+(i.defaultKapa||"").toLocaleString()+s+(i.tagessatz||"").toLocaleString()+s+(i.employeeNr||"")+s+(i.defaultDayCapa||"").toLocaleString()+s+(i.entryDate?new Date(i.entryDate).toLocaleDateString():"")+s+(i.exitDate?new Date(i.exitDate).toLocaleDateString():"")+s+(i.percent?i.percent.toLocaleString():"")+s+(i.aliases&&i.aliases.length>0?i.aliases.join("#"):"")+"\n";r=r.concat(n)}this.log(`VC Setting Orga CSV Len ${r.length} `);const o=new Blob([r],{type:"text/csv;charset=utf-8"});r="\ufeff"+r;const a=window.URL.createObjectURL(o);this.log("Open URL "+a);const l=document.createElement("a");document.body.appendChild(l),l.href=a;const c=new Date(e.timestamp),d=(c.getMonth()+1).toString(),u=c.getFullYear()+"-"+d.padStart(2,"0");l.download=`VisboCenterOrganisation_${u}.csv`,this.log(`Open URL ${a} doc ${JSON.stringify(l)}`),l.click(),window.URL.revokeObjectURL(a)}else{const t=JSON.stringify(e.value);this.log(`VC Setting JSON Len ${t.length} `);const i=new Blob([t],{type:"text/plain"}),n=window.URL.createObjectURL(i);this.log("Open URL "+n);const r=document.createElement("a");document.body.appendChild(r),r.href=n,r.download=`VisboCenterSetting_${e.name}.json`,this.log(`Open URL ${n} doc ${JSON.stringify(r)}`),r.click(),window.URL.revokeObjectURL(n)}}sortUserTable(t){this.vgUsers&&(void 0===t&&void 0!==this.sortUserColumn||(t!==this.sortUserColumn&&(this.sortUserColumn=t,this.sortUserAscending=void 0),this.sortUserAscending=void 0===this.sortUserAscending?1===t||2===t:!this.sortUserAscending),1===this.sortUserColumn?this.vgUsers.sort((function(t,e){return xh(t.email,e.email)})):2===this.sortUserColumn&&this.vgUsers.sort((function(t,e){return xh(t.groupName.toLowerCase(),e.groupName.toLowerCase())})),this.sortUserAscending||this.vgUsers.reverse())}sortVPUserTable(t){this.vgVPUsers&&(void 0===t&&void 0!==this.sortVPUserColumn||(t!==this.sortVPUserColumn&&(this.sortVPUserColumn=t,this.sortVPUserAscending=void 0),this.sortVPUserAscending=void 0===this.sortVPUserAscending?1===t||2===t:!this.sortVPUserAscending),1===this.sortVPUserColumn?this.vgVPUsers.sort((function(t,e){return xh(t.users.email,e.users.email)})):2===this.sortVPUserColumn&&this.vgVPUsers.sort((function(t,e){return xh(t.vp.name.toLowerCase(),e.vp.name.toLowerCase())})),this.log(`Sort VP Users Column ${this.sortVPUserColumn} Reverse: ${this.sortVPUserAscending}`),this.sortVPUserAscending||this.vgVPUsers.reverse())}sortGroupTable(t){this.vgGroups&&(void 0===t&&void 0!==this.sortGroupColumn||(t!==this.sortGroupColumn&&(this.sortGroupColumn=t,this.sortGroupAscending=void 0),this.sortGroupAscending=void 0===this.sortGroupAscending?1===t:!this.sortGroupAscending),1===this.sortGroupColumn?this.vgGroups.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortGroupColumn&&this.vgGroups.sort((function(t,e){return e.users.length-t.users.length})),this.sortGroupAscending||this.vgGroups.reverse())}sortSettingTable(t){this.vcSettings&&(void 0===t&&void 0!==this.sortSettingColumn||(t!==this.sortSettingColumn&&(this.sortSettingColumn=t,this.sortSettingAscending=void 0),this.sortSettingAscending=void 0===this.sortSettingAscending?1===t:!this.sortSettingAscending),1===this.sortSettingColumn?this.vcSettings.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortSettingColumn?this.vcSettings.sort((function(t,e){return Th(t.timestamp,e.timestamp)})):3===this.sortSettingColumn&&this.vcSettings.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})),this.sortSettingAscending||this.vcSettings.reverse())}isToday(t){return this.today||(this.today=new Date,this.today.setHours(0,0,0,0)),new Date(t)>=this.today}log(t){this.messageService.add("VisboCenter Details: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(xv),Rs(Ib),Rs(Fg),Rs(Xl),Rs(rf),Rs(Df),Rs(ov),Rs(Md))},t.\u0275cmp=le({type:t,selectors:[["app-visbocenter-detail"]],inputs:{visbocenter:"visbocenter"},decls:2,vars:1,consts:[[4,"ngIf"],[3,"click"],[1,"form-group","row"],["for","vcName",1,"col-3","col-md-2","col-form-label"],["id","VCName","type","text","name","vcName","class","col-8 form-control","placeholder","Name",3,"ngModel","ngModelChange",4,"ngIf"],["id","VCName","class","col-8 form-control-static",4,"ngIf"],["for","vcDescription",1,"col-3","col-md-2","col-form-label"],["id","VCDesc","name","vcDescription","class","col-8 form-control","placeholder","Type in your description",3,"ngModel","ngModelChange",4,"ngIf"],["id","VCDesc","class","col-8 form-control-static",4,"ngIf"],[1,"form-group","row","d-none","d-md-block"],["for","Created",1,"col-3","col-md-2","col-form-label"],["id","VCCreated",1,"col-4","form-control-static","col-form-label"],["id","VCUpdated",1,"col-4","form-control-static","col-form-label"],[1,"mb-3"],["id","Save","class","btn btn-primary mx-1",3,"click",4,"ngIf"],[1,"btn","btn-secondary","mx-1",3,"click"],["id","VcUserModalCreate","tabindex","-1","role","dialog","aria-labelledby","VcUserModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VcUserModalCenterTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["name","newUserInvite","novalidate",""],["f1","ngForm"],[1,"form-group",3,"ngClass"],["for","email",1,"col-form-label"],["id","AddUserName","type","email","name","email","required","","pattern","[^@\\s]+@[^@\\s]+\\.[^@\\s]+","autocomplete","email",1,"form-control",3,"ngModel","ngModelChange"],["email","ngModel"],["class","help-block",4,"ngIf"],["for","group",1,"col-form-label"],["id","AddUserGroupName","name","group","required","",1,"form-control",3,"ngModel","ngModelChange"],["group","ngModel"],[4,"ngFor","ngForOf"],["for","inviteMessage",1,"col-form-label"],["id","AddUserMessage","name","inviteMessage",1,"form-control",3,"ngModel","ngModelChange"],["inviteMessage","ngModel"],[1,"modal-footer","align-items-end"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-secondary","mx-1"],["id","AddUserConfirm","type","submit","class","btn btn-primary mx-1",4,"ngIf"],["id","AddUserConfirm","type","submit","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","VcUserRemove","tabindex","-1","role","dialog","aria-labelledby","VcUserModalRemoveTitle","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-dialog-centered","role","document",4,"ngIf"],["id","VcGroupModalCreate","tabindex","-1","role","dialog","aria-labelledby","VcGroupModalCreateTitle","aria-hidden","true",1,"modal","fade"],["id","VcGroupRemove","tabindex","-1","role","dialog","aria-labelledby","VcGroupModalRemoveTitle","aria-hidden","true",1,"modal","fade"],["class","modal fade","id","VCUserDetail","tabindex","-1","role","dialog","aria-labelledby","VCUserDetailTitle","aria-hidden","true",4,"ngIf"],["id","VcSettingDetail","tabindex","-1","role","dialog","aria-labelledby","VcSettingDetailTitle","aria-hidden","true",1,"modal","fade"],["id","VcSettingRemove","tabindex","-1","role","dialog","aria-labelledby","VcSettingRemoveTitle","aria-hidden","true",1,"modal","fade"],["id","VCName","type","text","name","vcName","placeholder","Name",1,"col-8","form-control",3,"ngModel","ngModelChange"],["id","VCName",1,"col-8","form-control-static"],["id","VCDesc","name","vcDescription","placeholder","Type in your description",1,"col-8","form-control",3,"ngModel","ngModelChange"],["id","VCDesc",1,"col-8","form-control-static"],[1,"btn-toolbar"],["id","ViewAudit","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["id","ViewGroup","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewUser","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewProjectUser","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewSetting","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewAudit","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["id","ViewGroup","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],["id","ViewUser","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],["id","ViewProjectUser","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],["id","ViewSetting","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],[1,"row"],[1,"col"],[1,"panel-heading","mt-2"],["class","col",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover"],["id","UserHead"],["id","UserList"],["id","AddUser","type","button","data-toggle","modal","data-target","#VcUserModalCreate",1,"my-1","btn","btn-primary","float-right"],["id","ColUser","data-toggle","modal","data-target","#VCUserDetail",3,"click"],["id","ColGroup",3,"click"],["id","ColDeleteUser","data-toggle","modal","data-target","#VcUserRemove",1,"Detail",3,"title","click"],[1,"panel-heading","mt-3"],["id","GroupHead"],["id","GroupList"],["id","AddGroup","type","button","data-toggle","modal","data-target","#VcGroupModalCreate",1,"btn","btn-primary","float-right",3,"click"],["id","ColGroup","data-toggle","modal","data-target","#VcGroupModalCreate",3,"click"],["id","ColMembers",3,"click"],["id","ColGlobal",4,"ngIf"],["id","ColDetail","data-toggle","modal","data-target","#VcGroupModalCreate",1,"Detail",3,"title","click"],["id","ColGlobal"],["id","ColDeleteGroup","data-toggle","modal","data-target","#VcGroupRemove",1,"Detail",3,"title","click"],[1,"panel-heading"],[3,"click",4,"ngFor","ngForOf"],["id","SettingHead"],["id","SettingList"],["id","ColSettingName","data-toggle","modal","data-target","#VcSettingDetail",3,"click"],["id","ColSettingTimestamp"],["id","ColSettingDate",4,"ngIf"],["id","ColSettingDate"],["id","ColDeleteSetting","data-toggle","modal","data-target","#VcSettingRemove",1,"Detail",3,"title","click"],["id","Save",1,"btn","btn-primary","mx-1",3,"click"],[1,"help-block"],["id","AddUserConfirm","type","submit",1,"btn","btn-primary","mx-1"],["id","AddUserConfirm","type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["id","VcUserRemoveTitle",1,"modal-title"],[1,"bg-warning"],[1,"form-group"],["for","VcName",1,"col-form-label"],[1,"col-8","form-control-static"],[1,"col-form-label"],["type","button","data-dismiss","modal",1,"btn","btn-secondary","mx-1"],["id","DeleteUserConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning","mx-1",3,"click"],["class","modal-title","id","VcGroupModalCenterTitle",4,"ngIf"],["name","actGroup","novalidate",""],["f2","ngForm"],["class","form-group",3,"ngClass",4,"ngIf"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","perm1","name","checkedView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedView","ngModel"],["for","perm1",1,"custom-control-label"],["type","checkbox","id","perm2","name","checkedViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedViewAudit","ngModel"],["for","perm2",1,"custom-control-label"],["type","checkbox","id","perm3","name","checkedModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedModify","ngModel"],["for","perm3",1,"custom-control-label"],["type","checkbox","id","perm4","name","checkedCreateVP",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVP","ngModel"],["for","perm4",1,"custom-control-label"],["type","checkbox","id","perm5","name","checkedManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedManagePerm","ngModel"],["for","perm5",1,"custom-control-label"],["type","checkbox","id","global","name","global",1,"custom-control-input",3,"ngModel","ngModelChange"],["global","ngModel"],["for","global",1,"custom-control-label"],["class","mt-2",4,"ngIf"],["id","AddGroupConfirm","class","btn btn-primary disabled mx-1",4,"ngIf"],["id","AddGroupConfirm","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","VcGroupModalCenterTitle",1,"modal-title"],["for","groupName",1,"col-form-label"],["name","groupName",1,"col-form-label"],["id","AddGroupName","type","text","name","groupName","required","","minlength","3",1,"form-control",3,"ngModel","ngModelChange"],["groupName","ngModel"],[1,"mt-2"],["type","checkbox","id","permVP1","name","checkedVPView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPView","ngModel"],["for","permVP1",1,"custom-control-label"],["type","checkbox","id","permVP2","name","checkedVPViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPViewAudit","ngModel"],["for","permVP2",1,"custom-control-label"],["type","checkbox","id","permVP3","name","checkedVPModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPModify","ngModel"],["for","permVP3",1,"custom-control-label"],["type","checkbox","id","permVP4","name","checkedCreateVariant",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVariant","ngModel"],["for","permVP4",1,"custom-control-label"],["type","checkbox","id","permVP5","name","checkedVPManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPManagePerm","ngModel"],["for","permVP5",1,"custom-control-label"],["type","checkbox","id","permVP6","name","checkedVPDelete",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPDelete","ngModel"],["for","permVP6",1,"custom-control-label"],[1,"form-control-static"],["class","row",4,"ngFor","ngForOf"],["class","col-8 ml-3",4,"ngIf"],[1,"col-8","ml-3"],["data-dismiss","modal",3,"click"],["id","AddGroupConfirm",1,"btn","btn-primary","disabled","mx-1"],["id","AddGroupConfirm","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["id","DeleteGroupConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning","mx-1",3,"click"],["id","VCUserDetail","tabindex","-1","role","dialog","aria-labelledby","VCUserDetailTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],["id","VCUserDetailTitle",1,"modal-title"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],[1,"form-control-static","mt-2"],["id","ButtonBack","data-dismiss","modal",1,"btn","btn-primary"],["type","checkbox","checked","","disabled","","id","perm1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["id","VcSettingDetailTitle",1,"modal-title"],["name","settingDetail"],["for","SettingName",1,"col-4","col-form-label"],["id","SettingName",1,"col-8","form-control-static"],["for","SettingType",1,"col-4","col-form-label"],["id","SettingType",1,"col-8","form-control-static"],["for","Timestamp",1,"col-4","col-form-label"],["id","Timestamp",1,"col-8","form-control-static"],["for","updatedAt",1,"col-4","col-form-label"],["id","updatedAt",1,"col-8","form-control-static"],["id","SettingDownload","type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["id","VcSettingRemoveTitle",1,"modal-title"],["class","form-group",4,"ngIf"],["for","SettingUpdated",1,"col-4","col-form-label"],["for","SettingTS",1,"col-4","col-form-label"]],template:function(t,e){1&t&&(Bs(0,"app-usernavbar"),Gs(1,sC,93,73,"div",0)),2&t&&(_n(1),js("ngIf",e.visbocenter))},directives:[bb,jc,Ou,Fd,Tu,Oc,Od,Ru,Hu,Nd,Eu,cu,du,gu,Lc,_d,Fu],pipes:[av,Kc,qc],styles:[""]}),t})();class lC{}const cC=new th({"Content-Type":"application/json"});let dC=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.serviceBaseUrl=this.env.restUrl}getVisboAudits(t,e){const i=this.serviceBaseUrl.concat("/audit");let n=new nh;return t&&(n=n.append("sysadmin","1")),e&&(e.from&&(n=n.append("from",e.from.toISOString())),e.to&&(n=n.append("to",e.to.toISOString())),e.text&&(n=n.append("text",e.text)),e.maxcount&&(n=n.append("maxcount",e.maxcount.toString())),e.actionType&&(n=n.append("action",e.actionType)),e.area&&(n=n.append("area",e.area))),this.log(`Calling HTTP Request: ${i} ${t?"as sysadmin":""}`),this.http.get(i,{headers:cC,params:n}).pipe(D(t=>t.audit),Kh(t=>this.log(`fetched ${t.length} Audits `)),Nh(this.handleError("getVisboAudit",[])))}getVisboCenterAudits(t,e,i,n){const r=this.serviceBaseUrl.concat("/vc/",t,"/audit");let s=new nh;return e&&(s=s.append("sysadmin","1")),i&&(s=s.append("deleted","1")),n&&(n.from&&(s=s.append("from",n.from.toISOString())),n.to&&(s=s.append("to",n.to.toISOString())),n.text&&(s=s.append("text",n.text)),n.maxcount&&(s=s.append("maxcount",n.maxcount.toString())),n.actionType&&(s=s.append("action",n.actionType)),n.area&&(s=s.append("area",n.area))),this.log(`Calling HTTP Request: ${r} for VC ${t}`),this.http.get(r,{headers:cC,params:s}).pipe(D(t=>t.audit),Kh(t=>this.log(`fetched ${t.length} Audits `)),Nh(this.handleError("getVisboAudit",[])))}getVisboProjectAudits(t,e,i,n){const r=this.serviceBaseUrl.concat("/vp/",t,"/audit");let s=new nh;return e&&(s=s.append("sysadmin","1")),i&&(s=s.append("deleted","1")),n&&(n.from&&(s=s.append("from",n.from.toISOString())),n.to&&(s=s.append("to",n.to.toISOString())),n.text&&(s=s.append("text",n.text)),n.maxcount&&(s=s.append("maxcount",n.maxcount.toString())),n.actionType&&(s=s.append("action",n.actionType)),n.area&&(s=s.append("area",n.area))),this.log(`Calling HTTP Request: ${r} for VP ${t}`),this.http.get(r,{headers:cC,params:s}).pipe(D(t=>t.audit),Kh(t=>this.log(`fetched ${t.length} Audits `)),Nh(this.handleError("getVisboAudit",[])))}handleError(t="operation",e){return i=>(this.log(`HTTP Request ${t} failed: ${i.error.message} status:${i.status} result: ${JSON.stringify(e)}`),jh(i))}log(t){this.messageService.add("VisboAuditService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(Rh),Kt(np))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function uC(t,e){if(1&t){const t=zs();Ns(0,"li",6),Ns(1,"a",7),Js("click",(function(){return ei(t),Xs().gotoClickedItem("sysvc")})),mo(2,"Visbo Centers"),Fs(),Fs()}}function hC(t,e){if(1&t){const t=zs();Ns(0,"li",6),Ns(1,"a",7),Js("click",(function(){return ei(t),Xs().gotoClickedItem("sysaudit")})),mo(2,"Audit"),Fs(),Fs()}}function pC(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"a",13),Js("click",(function(){return ei(t),Xs().gotoClickedItem("syslog")})),mo(2,"Log Files"),Fs(),Fs()}}let gC=(()=>{class t{constructor(t,e,i,n,r){this.route=t,this.router=e,this.alertService=i,this.messageService=n,this.visbocenterService=r,this.permSystem=wv,this.permVC=Av,this.permVP=Pv}ngOnInit(){this.combinedPerm=this.visbocenterService.getSysAdminRole(),this.log(`Navbar Init Sys Role ${JSON.stringify(this.combinedPerm)} ${this.permSystem.View}`)}gotoClickedItem(t){this.router.navigate([t])}hasSystemPerm(t){return(this.combinedPerm.system&t)>0}hasVCPerm(t){return(this.combinedPerm.vc&t)>0}log(t){this.messageService.add("Sys NavBar: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Fg),Rs(rf),Rs(Df),Rs(Rh),Rs(xv))},t.\u0275cmp=le({type:t,selectors:[["app-sysnavbar"]],decls:29,vars:3,consts:[[1,"navbar","navbar-expand-md","bg-light","sticky-top"],[1,"navbar-brand","bg-light",3,"click"],["type","button","data-toggle","collapse","data-target","#navbarSupportedContent","aria-controls","navbarSupportedContent","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"fas","fa-bars"],["id","navbarSupportedContent",1,"collapse","navbar-collapse"],[1,"navbar-nav","mr-auto"],[1,"nav-item"],[1,"nav-link","bg-light",3,"click"],["class","nav-item",4,"ngIf"],[1,"nav-item","dropdown"],["href","#","id","navbarDropdown","role","button","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"nav-link","dropdown-toggle","bg-light"],["aria-labelledby","navbarDropdown",1,"dropdown-menu"],[4,"ngIf"],[1,"dropdown-item",3,"click"],[1,"nav-link","bg-light","align-right",3,"click"]],template:function(t,e){1&t&&(Ns(0,"nav",0),Ns(1,"a",1),Js("click",(function(){return e.gotoClickedItem("sysdashboard")})),mo(2,"Overviews"),Fs(),Ns(3,"button",2),Bs(4,"i",3),Fs(),Ns(5,"div",4),Ns(6,"ul",5),Ns(7,"li",6),Ns(8,"a",7),Js("click",(function(){return e.gotoClickedItem("sysadmins")})),mo(9,"Administrators"),Fs(),Fs(),Gs(10,uC,3,0,"li",8),Ns(11,"li",6),Ns(12,"a",7),Js("click",(function(){return e.gotoClickedItem("sysuser")})),mo(13,"Users"),Fs(),Fs(),Gs(14,hC,3,0,"li",8),Ns(15,"li",9),Ns(16,"a",10),mo(17," Others "),Fs(),Ns(18,"div",11),Gs(19,pC,3,0,"div",12),Ns(20,"div"),Ns(21,"a",13),Js("click",(function(){return e.gotoClickedItem("systasks")})),mo(22,"Tasks"),Fs(),Fs(),Ns(23,"div"),Ns(24,"a",13),Js("click",(function(){return e.gotoClickedItem("sysconfig")})),mo(25,"Configuration"),Fs(),Fs(),Fs(),Fs(),Ns(26,"li",6),Ns(27,"a",14),Js("click",(function(){return e.gotoClickedItem("/")})),mo(28,"Back"),Fs(),Fs(),Fs(),Fs(),Fs()),2&t&&(_n(10),js("ngIf",e.hasVCPerm(e.permVC.View)),_n(4),js("ngIf",e.hasSystemPerm(e.permSystem.ViewAudit)),_n(5),js("ngIf",e.hasSystemPerm(e.permSystem.ViewLog)))},directives:[jc],styles:[".navbar[_ngcontent-%COMP%]{padding:0;margin-bottom:1em;margin-top:1em}"]}),t})();function mC(t,e){1&t&&(Ns(0,"div"),Bs(1,"app-usernavbar"),Fs())}function fC(t,e){1&t&&(Ns(0,"div"),Bs(1,"app-sysnavbar"),Fs())}function vC(t,e){if(1&t){const t=zs();Ns(0,"div",11),Ns(1,"label",34),mo(2),Ua(3,"translate"),Fs(),Ns(4,"input",35),Js("ngModelChange",(function(e){return ei(t),Xs(2).auditFrom=e})),Fs(),Ns(5,"label",36),mo(6),Ua(7,"translate"),Fs(),Ns(8,"input",37),Js("ngModelChange",(function(e){return ei(t),Xs(2).auditTo=e})),Fs(),Fs()}if(2&t){const t=Xs(2);_n(2),vo("",Ea(3,4,"vcAudit.lbl.from"),":"),_n(2),js("ngModel",t.auditFrom),_n(2),vo("",Ea(7,6,"vcAudit.lbl.to"),":"),_n(2),js("ngModel",t.auditTo)}}function bC(t,e){if(1&t){const t=zs();Ns(0,"div",11),Ns(1,"label",34),mo(2),Ua(3,"translate"),Fs(),Ns(4,"input",38),Js("ngModelChange",(function(e){return ei(t),Xs(2).auditFrom=e})),Fs(),Ns(5,"label",36),mo(6),Ua(7,"translate"),Fs(),Ns(8,"input",39),Js("ngModelChange",(function(e){return ei(t),Xs(2).auditTo=e})),Fs(),Fs()}if(2&t){const t=Xs(2);_n(2),vo("",Ea(3,4,"vcAudit.lbl.from"),":"),_n(2),js("ngModel",t.auditFrom),_n(2),vo("",Ea(7,6,"vcAudit.lbl.to"),":"),_n(2),js("ngModel",t.auditTo)}}function yC(t,e){if(1&t&&(Ns(0,"option",40),mo(1),Ua(2,"translate"),Fs()),2&t){const t=e.$implicit;to("value",t.name),_n(1),fo(Ea(2,2,"vcAudit.dropDown."+t.name))}}function CC(t,e){if(1&t&&(Ns(0,"option",40),mo(1),Ua(2,"translate"),Fs()),2&t){const t=e.$implicit;to("value",t.name),_n(1),fo(Ea(2,2,"vcAudit.dropDown."+t.name))}}function VC(t,e){if(1&t&&(Ns(0,"td",49),mo(1),Ua(2,"date"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.createdAt,"HH:mm:ss"))}}function wC(t,e){if(1&t&&(Ns(0,"td",49),mo(1),Ua(2,"date"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.createdAt,"dd.MM HH:mm"))}}function AC(t,e){if(1&t&&(Ns(0,"td",50),mo(1),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(t.user.email)}}function PC(t,e){1&t&&(Ns(0,"td",50),mo(1," Unknown "),Fs())}function kC(t,e){if(1&t){const t=zs();Ns(0,"tr",41),Js("click",(function(){ei(t);const i=e.index;return Xs(2).helperAuditIndex(i)})),Gs(1,VC,3,4,"td",42),Gs(2,wC,3,4,"td",42),Gs(3,AC,2,1,"td",43),Gs(4,PC,2,0,"td",43),Ns(5,"td",44),mo(6),Fs(),Ns(7,"td",45),mo(8),Fs(),Ns(9,"td",46),mo(10),Fs(),Ns(11,"td",47),mo(12),Fs(),Ns(13,"td"),Ns(14,"button",48),Js("click",(function(){ei(t);const i=e.index;return Xs(2).helperAuditIndex(i)})),mo(15,"i"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit,i=Xs(2);_n(1),js("ngIf",i.isToday(t.createdAt)),_n(1),js("ngIf",!i.isToday(t.createdAt)),_n(1),js("ngIf",t.user),_n(1),js("ngIf",!t.user),_n(2),fo(t.actionDescription),_n(2),fo(t.vp?t.vp.name:""),_n(2),fo(i.helperShortenText(t.actionInfo,30)),_n(2),fo(i.helperResponseText(t))}}function DC(t,e){1&t&&(Ns(0,"div"),Ns(1,"h3",51),mo(2),Ua(3,"translate"),Fs(),Fs()),2&t&&(_n(2),vo(" ",Ea(3,1,"vcAudit.msg.noAudit")," "))}function MC(t,e){if(1&t){const t=zs();Ns(0,"div",4),Ns(1,"div",5),Ns(2,"h2",6),mo(3),Ua(4,"translate"),Ns(5,"a",7),Js("click",(function(){return ei(t),Xs().goBack()})),mo(6),Fs(),Fs(),Fs(),Ns(7,"form",8,9),Js("ngSubmit",(function(){return ei(t),Xs().getVisboCenterAudits()})),Gs(9,vC,9,8,"div",10),Gs(10,bC,9,8,"div",10),Ns(11,"div",11),Ns(12,"label",12),mo(13),Ua(14,"translate"),Fs(),Ns(15,"input",13),Js("ngModelChange",(function(e){return ei(t),Xs().auditText=e})),Fs(),Ns(16,"label",14),mo(17),Ua(18,"translate"),Fs(),Ns(19,"select",15),Js("ngModelChange",(function(e){return ei(t),Xs().auditCount=e})),Ns(20,"option"),mo(21,"50"),Fs(),Ns(22,"option"),mo(23,"100"),Fs(),Ns(24,"option"),mo(25,"500"),Fs(),Ns(26,"option"),mo(27,"2000"),Fs(),Fs(),Ns(28,"select",16),Js("ngModelChange",(function(e){return ei(t),Xs().auditArea=e})),Gs(29,yC,3,4,"option",17),Fs(),Ns(30,"select",18),Js("ngModelChange",(function(e){return ei(t),Xs().auditType=e})),Gs(31,CC,3,4,"option",17),Fs(),Ns(32,"div",19),Ns(33,"button",20),Js("click",(function(){return ei(t),Xs().getVisboCenterAudits()})),mo(34),Ua(35,"translate"),Fs(),Ns(36,"button",21),Js("click",(function(){return ei(t),Xs().downloadVisboAudit()})),mo(37),Ua(38,"translate"),Fs(),Fs(),Fs(),Fs(),Ns(39,"div",22),Ns(40,"div",23),Ns(41,"table",24),Ns(42,"thead",25),Ns(43,"tr"),Ns(44,"th",26),Js("click",(function(){return ei(t),Xs().sortTable(1)})),mo(45),Ua(46,"translate"),Fs(),Ns(47,"th",27),Js("click",(function(){return ei(t),Xs().sortTable(2)})),mo(48),Ua(49,"translate"),Fs(),Ns(50,"th",28),Js("click",(function(){return ei(t),Xs().sortTable(3)})),mo(51),Ua(52,"translate"),Fs(),Ns(53,"th",29),Js("click",(function(){return ei(t),Xs().sortTable(8)})),mo(54),Ua(55,"translate"),Fs(),Ns(56,"th",30),Js("click",(function(){return ei(t),Xs().sortTable(4)})),mo(57),Ua(58,"translate"),Fs(),Ns(59,"th",31),Js("click",(function(){return ei(t),Xs().sortTable(5)})),mo(60),Ua(61,"translate"),Fs(),Ns(62,"th"),mo(63,"Detail"),Fs(),Fs(),Fs(),Ns(64,"tbody",32),Gs(65,kC,16,8,"tr",33),Fs(),Fs(),Gs(66,DC,4,3,"div",0),Fs(),Fs(),Fs()}if(2&t){const t=Xs();_n(3),vo(" ",Ea(4,22,"vcAudit.title"),": "),_n(3),fo(t.visbocenter.name),_n(3),js("ngIf",t.sysadmin),_n(1),js("ngIf",!t.sysadmin),_n(3),vo("",Ea(14,24,"vcAudit.lbl.filter"),":"),_n(2),js("ngModel",t.auditText),_n(2),vo("",Ea(18,26,"vcAudit.lbl.max"),":"),_n(2),js("ngModel",t.auditCount),_n(9),js("ngModel",t.auditArea),_n(1),js("ngForOf",t.auditAreaList),_n(1),js("ngModel",t.auditType),_n(1),js("ngForOf",t.auditTypeList),_n(3),fo(Ea(35,28,"vcAudit.btn.filter")),_n(3),fo(Ea(38,30,"vcAudit.btn.download")),_n(8),fo(Ea(46,32,"vcAudit.lbl.created")),_n(3),fo(Ea(49,34,"vcAudit.lbl.user")),_n(3),vo(" ",Ea(52,36,"vcAudit.lbl.action"),""),_n(3),vo(" ",Ea(55,38,"vcAudit.lbl.vp"),""),_n(3),vo(" ",Ea(58,40,"vcAudit.lbl.info"),""),_n(3),vo(" ",Ea(61,42,"vcAudit.lbl.result"),""),_n(5),js("ngForOf",t.audit),_n(1),js("ngIf",t.audit&&0==t.audit.length)}}function SC(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",75),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vcAudit.lbl.info"),":"),_n(3),vo("",t.audit[t.auditIndex].actionInfo," ")}}function IC(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",76),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vcAudit.lbl.vc"),":"),_n(3),vo("",t.audit[t.auditIndex].vc.name," ")}}function xC(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",77),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,3,"vcAudit.lbl.vp"),":"),_n(3),bo("",t.audit[t.auditIndex].vp.name," (",t.audit[t.auditIndex].vp.vpid,") ")}}function TC(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",78),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,3,"vcAudit.lbl.vpv"),":"),_n(3),bo("",t.audit[t.auditIndex].vpv.name," (",t.audit[t.auditIndex].vpv.vpvid,")")}}function _C(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",70),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vcAudit.lbl.techAction"),":"),_n(3),vo("",t.audit[t.auditIndex].action," ")}}function UC(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",79),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vcAudit.lbl.url"),":"),_n(3),vo("",t.audit[t.auditIndex].url," ")}}function EC(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",70),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vcAudit.lbl.responseTime"),":"),_n(3),vo("",t.audit[t.auditIndex].result.time," ms ")}}function OC(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",70),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vcAudit.lbl.responseSize"),":"),_n(3),vo("",t.helperFormatBytes(t.audit[t.auditIndex].result.size||0,2)," ")}}function GC(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",70),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vcAudit.lbl.userAgent"),":"),_n(3),fo(t.audit[t.auditIndex].userAgent)}}function LC(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",70),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vcAudit.lbl.ip"),":"),_n(3),fo(t.audit[t.auditIndex].ip)}}function RC(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",70),mo(5),Ua(6,"date"),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vcAudit.lbl.ttl"),":"),_n(3),fo(Oa(6,4,t.audit[t.auditIndex].ttl,"dd.MM HH:mm"))}}function jC(t,e){if(1&t){const t=zs();Ns(0,"button",80),Js("click",(function(){return ei(t),Xs(2).toggleDetail()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vcAudit.btn.more")))}function $C(t,e){if(1&t){const t=zs();Ns(0,"button",81),Js("click",(function(){return ei(t),Xs(2).toggleDetail()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vcAudit.btn.less")))}function NC(t,e){if(1&t){const t=zs();Ns(0,"div",52),Ns(1,"div",53),Ns(2,"div",54),Ns(3,"h5",55),mo(4),Ua(5,"translate"),Fs(),Ns(6,"button",56),Ns(7,"span",57),mo(8,"\xd7"),Fs(),Fs(),Fs(),Ns(9,"div",58),Ns(10,"div",5),Ns(11,"div",59),Ns(12,"h3",60),Js("click",(function(){return ei(t),Xs().pageAuditIndex(-1)})),Bs(13,"a",61),Fs(),Fs(),Ns(14,"div",62),Ns(15,"h3",63),Js("click",(function(){return ei(t),Xs().pageAuditIndex(1)})),Bs(16,"a",64),Fs(),Fs(),Fs(),Ns(17,"form",65),Ns(18,"label",66),mo(19),Ua(20,"translate"),Fs(),Ns(21,"label",67),mo(22),Ua(23,"date"),Fs(),Ns(24,"label",66),mo(25),Ua(26,"translate"),Fs(),Ns(27,"label",68),mo(28),Fs(),Ns(29,"label",66),mo(30),Ua(31,"translate"),Fs(),Ns(32,"label",69),mo(33),Fs(),Gs(34,SC,6,4,"div",0),Gs(35,IC,6,4,"div",0),Gs(36,xC,6,5,"div",0),Gs(37,TC,6,5,"div",0),Ns(38,"label",66),mo(39),Ua(40,"translate"),Fs(),Ns(41,"label",70),mo(42),Fs(),Gs(43,_C,6,4,"div",0),Gs(44,UC,6,4,"div",0),Gs(45,EC,6,4,"div",0),Gs(46,OC,6,4,"div",0),Gs(47,GC,6,4,"div",0),Gs(48,LC,6,4,"div",0),Gs(49,RC,7,7,"div",0),Fs(),Fs(),Ns(50,"div",71),Gs(51,jC,3,3,"button",72),Gs(52,$C,3,3,"button",73),Ns(53,"button",74),mo(54),Ua(55,"translate"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs();_n(4),fo(Ea(5,23,"vcAudit.titleDetail")),_n(15),vo("",Ea(20,25,"vcAudit.lbl.created"),":"),_n(3),vo("",Oa(23,27,t.audit[t.auditIndex].createdAt,"dd.MM.yyyy HH:mm:ss.SSS")," "),_n(3),vo("",Ea(26,30,"vcAudit.lbl.user"),":"),_n(3),vo("",t.audit[t.auditIndex].user.email," "),_n(2),vo("",Ea(31,32,"vcAudit.lbl.action"),":"),_n(3),vo("",t.audit[t.auditIndex].actionDescription," "),_n(1),js("ngIf",t.audit[t.auditIndex].actionInfo),_n(1),js("ngIf",t.audit[t.auditIndex].vc),_n(1),js("ngIf",t.audit[t.auditIndex].vp),_n(1),js("ngIf",t.audit[t.auditIndex].vpv),_n(2),vo("",Ea(40,34,"vcAudit.lbl.result"),":"),_n(3),vo("",t.helperResponseText(t.audit[t.auditIndex])," "),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore&&t.audit[t.auditIndex].ttl),_n(2),js("ngIf",!t.showMore),_n(1),js("ngIf",t.showMore),_n(2),fo(Ea(55,36,"vcAudit.btn.back"))}}function FC(t){let e;return t?(e=t.replace(/\t/g," "),"="!==e[0]&&"+"!==e[0]&&"-"!==e[0]||(e="'".concat(e)),e):t}let BC=(()=>{class t{constructor(t,e,i,n,r,s,o,a){this.visboauditService=t,this.visbocenterService=e,this.messageService=i,this.alertService=n,this.route=r,this.location=s,this.router=o,this.translate=a,this.auditTypeList=[{name:"All",action:""},{name:"Read",action:"GET"},{name:"Create",action:"POST"},{name:"Update",action:"PUT"},{name:"Delete",action:"DELETE"}],this.auditAreaList=[{name:"All",action:""},{name:"VC",action:"vc"},{name:"VP",action:"vp"}],this.deleted=!1}ngOnInit(){this.sysadmin=this.route.snapshot.queryParams.sysadmin,this.deleted=!0===this.route.snapshot.queryParams.deleted;const t=this.route.snapshot.paramMap.get("id");this.visbocenterService.getVisboCenter(t,this.sysadmin,this.deleted).subscribe(t=>{this.visbocenter=t,this.combinedPerm=t.perm,this.log(`VisboCenter initialised ${this.visbocenter._id} Perm ${JSON.stringify(this.combinedPerm)} `)},t=>{if(this.log(`Get VC failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vcAudit.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Lh(t))}),this.auditCount=50,this.auditType=this.auditTypeList[0].name,this.auditArea=this.auditAreaList[0].name,this.today=new Date,this.today.setHours(0,0,0,0),this.getVisboCenterAudits(),this.sortTable(void 0)}getVisboCenterAudits(){const t=this.route.snapshot.paramMap.get("id"),e=new lC;this.log(`Audit getVisboCenterAudits from ${this.auditFrom} to ${this.auditTo} Text ${this.auditText} AuditType ${this.auditType}`),this.alertService.clear(),e.to=this.auditTo?new Date(this.auditTo):new Date,this.auditFrom&&(e.from=new Date(this.auditFrom)),this.auditText&&(e.text=this.auditText.trim());for(let i=0;i<this.auditTypeList.length;i++)if(this.auditType===this.auditTypeList[i].name){e.actionType=this.auditTypeList[i].action;break}for(let i=0;i<this.auditAreaList.length;i++)if(this.auditArea===this.auditAreaList[i].name){e.area=this.auditAreaList[i].action;break}e.maxcount=this.auditCount,this.log(`Audit getVisboCenterAudits VC ${t} recalc Query ${JSON.stringify(e)}`),this.visboauditService.getVisboCenterAudits(t,this.sysadmin,this.deleted,e).subscribe(t=>{this.audit=t,this.sortTable(void 0);const e=this.translate.instant("vcAudit.msg.auditSuccess");this.alertService.success(e,!0),this.log("get Audit success")},t=>{this.log(`get Audit failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}downloadVisboAudit(){let t;this.log(`sysAudit Download ${this.audit.length} Items`),t="sep=\t\n",t+="date\ttime UTC\temail\tactiondDescription\taction\turl\tactionInfo\tresponseTime\tresponseStatus\tvcid\tvcname\tvpid\tvpname\tvpvid\tsize\tip\tuserId\tuserAgent\tttl\tVC Details\tVP Details\n";for(let r=0;r<this.audit.length;r++){const e=new Date(this.audit[r].createdAt).toISOString(),i=(this.audit[r].userAgent||"").replace(/,/g,";"),n=e.substr(0,10)+"\t"+e.substr(11,8)+"\t"+FC(this.audit[r].user.email)+"\t"+FC(this.audit[r].actionDescription)+"\t"+this.audit[r].action+"\t"+this.audit[r].url+"\t"+this.audit[r].actionInfo+"\t"+(this.audit[r].result?this.audit[r].result.time:"")+"\t"+(this.audit[r].result?this.audit[r].result.status:"")+"\t"+(this.audit[r].vc?this.audit[r].vc.vcid:"")+"\t"+(this.audit[r].vc?FC(this.audit[r].vc.name):"")+"\t"+(this.audit[r].vp?this.audit[r].vp.vpid:"")+"\t"+(this.audit[r].vp?FC(this.audit[r].vp.name):"")+"\t"+(this.audit[r].vpv?this.audit[r].vpv.vpvid:"")+"\t"+(this.audit[r].result?this.audit[r].result.size:"0")+"\t"+this.audit[r].ip+"\t"+this.audit[r].user.userId+"\t"+FC(i)+"\t"+(this.audit[r].ttl||"")+"\t"+(this.audit[r].vc&&FC(this.audit[r].vc.vcjson)||"")+"\t"+(this.audit[r].vp&&FC(this.audit[r].vp.vpjson)||"")+"\n";t=t.concat(n)}this.log(`VC Audit CSV Len ${t.length} `);const e=new Blob([t],{type:"text/plain"}),i=window.URL.createObjectURL(e);this.log("Open URL "+i);const n=document.createElement("a");document.body.appendChild(n),n.href=i,n.download="auditlog-VC.csv",this.log(`Open URL ${i} doc ${JSON.stringify(n)}`),n.click(),window.URL.revokeObjectURL(i)}helperAuditIndex(t){this.auditIndex=t}helperFormatBytes(t,e=2){if(0===t)return"0 B";const i=e||2,n=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,n)).toFixed(i))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}pageAuditIndex(t){let e=this.auditIndex+t;e<0&&(e=0),e>=this.audit.length&&(e=this.audit.length-1),this.auditIndex=e}helperResponseText(t){const e=t.result.status;switch(e){case"200":case"304":case"400":case"401":case"403":case"404":case"409":case"423":case"500":return this.translate.instant("vcAudit.result.HTTP"+e);default:return t.result.statusText?t.result.statusText:e.toString()}}helperShortenText(t,e){return Gh(t,e)}goBack(){this.location.back()}toggleDetail(){this.log("Toggle ShowMore"),this.showMore=!this.showMore}isToday(t){return new Date(t)>this.today}sortTable(t){this.audit&&(void 0!==t?t!==this.sortColumn?(this.sortColumn=t,this.sortAscending=void 0):void 0!==this.sortAscending&&(this.sortAscending=!this.sortAscending):(this.sortColumn=1,this.sortAscending=void 0),void 0===this.sortAscending&&(this.sortAscending=2===t||3===t||4===t),1===this.sortColumn?this.audit.sort((function(t,e){return Th(t.createdAt,e.createdAt)})):2===this.sortColumn?this.audit.sort((function(t,e){return xh(t.user.email.toLowerCase(),e.user.email.toLowerCase())})):3===this.sortColumn?this.audit.sort((function(t,e){return xh(t.actionDescription,e.actionDescription)})):4===this.sortColumn?this.audit.sort((function(t,e){return xh(t.url,e.url)})):5===this.sortColumn?this.audit.sort((function(t,e){return xh(t.result.status,e.result.status)})):6===this.sortColumn?this.audit.sort((function(t,e){return t.result.time-e.result.time})):7===this.sortColumn?this.audit.sort((function(t,e){return(t.result.size||0)-(e.result.size||0)})):8===this.sortColumn&&this.audit.sort((function(t,e){var i,n;return xh(null===(i=t.vp)||void 0===i?void 0:i.name,null===(n=e.vp)||void 0===n?void 0:n.name)})),this.sortAscending||this.audit.reverse())}log(t){this.messageService.add("VC Audit: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(dC),Rs(xv),Rs(Rh),Rs(Df),Rs(Fg),Rs(Xl),Rs(rf),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-visbocenter-audit"]],inputs:{visbocenter:"visbocenter"},decls:5,vars:4,consts:[[4,"ngIf"],["class","well",4,"ngIf"],["id","AuditDetail","tabindex","-1","role","dialog","aria-labelledby","Audit Detail","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-lg modal-dialog-centered","role","document",4,"ngIf"],[1,"well"],[1,"row"],[1,"panel-heading","ml-0"],[3,"click"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],["class","form-group row",4,"ngIf"],[1,"form-group","row"],["for","auditText",1,"col-1","col-form-label"],["id","auditText","type","text","name","auditText",1,"col-2","col-sm-3","form-control",3,"ngModel","ngModelChange"],["for","auditCount",1,"col-1","col-form-label"],["id","auditCount","name","auditCount",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],["id","auditArea","id","auditType","name","auditArea",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["id","auditType","id","auditType","name","auditType",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],[1,"btn-group"],["type","button",1,"btn","btn-sm","btn-primary","ml-auto","mx-1",3,"click"],["type","button",1,"btn","btn-sm","btn-secondary","ml-auto","mx-1",3,"click"],[1,"container-fluid"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],["id","AuditHead"],["id","SortDate",1,"d-none","d-md-table-cell",3,"click"],["id","SortUser",3,"click"],["id","SortAction",3,"click"],["id","SortVP",1,"d-none","d-lg-table-cell",3,"click"],["id","SortInfo",1,"d-none","d-md-table-cell",3,"click"],["id","SortResult",1,"d-none","d-lg-table-cell",3,"click"],["id","AuditList"],["data-toggle","modal","data-target","#AuditDetail",3,"click",4,"ngFor","ngForOf"],["for","auditFrom",1,"col-1","col-form-label"],["id","auditFrom","type","datetime-local","name","auditFrom",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],["for","auditTo",1,"col-1","col-form-label"],["id","auditTo","type","datetime-local","name","auditTo",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],["id","auditFrom","type","date","name","auditFrom",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],["id","auditTo","type","date","name","auditTo",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],[3,"value"],["data-toggle","modal","data-target","#AuditDetail",3,"click"],["id","ColCreated","class","d-none d-md-table-cell",4,"ngIf"],["id","ColUser",4,"ngIf"],["id","ColAction"],["id","ColVP",1,"d-none","d-lg-table-cell"],["id","ColInfo",1,"d-none","d-md-table-cell"],["id","ColResult",1,"d-none","d-lg-table-cell"],["id","ColDetail","data-toggle","modal","data-target","#AuditDetail",1,"Detail",3,"click"],["id","ColCreated",1,"d-none","d-md-table-cell"],["id","ColUser"],[1,"d-flex","justify-content-center"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","AuditDetailTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"col-11"],["id","ButtonPrev",3,"click"],[1,"px-3","col-1","fas","fa-caret-square-left"],[1,"col-1"],["id","ButtonNext",3,"click"],[1,"px-3","col-1","fas","fa-caret-square-right"],["id","auditEntry"],[1,"v_compact_t","col-4","form-control-static"],["id","auditCreated",1,"v_compact_t","col-7","form-control-static"],["id","auditUser",1,"v_compact_t","col-7","form-control-static"],["id","auditAction",1,"v_compact_t","col-7","form-control-static"],[1,"v_compact_t","col-7","form-control-static"],[1,"modal-footer","align-items-end"],["id","ButtonMore","type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["id","ButtonLess","type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-primary"],["id","auditInfo",1,"v_compact_t","col-7","form-control-static"],["id","auditVC",1,"v_compact_t","col-7","form-control-static"],["id","auditVP",1,"v_compact_t","col-7","form-control-static"],["id","auditVPV",1,"v_compact_t","col-7","form-control-static"],[1,"v_compact_t","col-7","form-control-static",2,"overflow-wrap","break-word"],["id","ButtonMore","type","button",1,"btn","btn-secondary",3,"click"],["id","ButtonLess","type","button",1,"btn","btn-secondary",3,"click"]],template:function(t,e){1&t&&(Gs(0,mC,2,0,"div",0),Gs(1,fC,2,0,"div",0),Gs(2,MC,67,44,"div",1),Ns(3,"div",2),Gs(4,NC,56,38,"div",3),Fs()),2&t&&(js("ngIf",!e.sysadmin),_n(1),js("ngIf",e.sysadmin),_n(1),js("ngIf",e.visbocenter),_n(2),js("ngIf",e.auditIndex>=0&&e.auditIndex<e.audit.length))},directives:[jc,bb,gC,Ou,Fd,Tu,Od,Nd,Eu,cu,du,gu,Lc],pipes:[av,qc],styles:[".v_compact_t[_ngcontent-%COMP%]{margin:0;padding-top:0}"]}),t})();function HC(t,e){1&t&&(Ns(0,"div"),Bs(1,"app-usernavbar"),Fs())}function KC(t,e){1&t&&(Ns(0,"div"),Bs(1,"app-sysnavbar"),Fs())}function qC(t,e){if(1&t){const t=zs();Ns(0,"div",11),Ns(1,"label",32),mo(2),Ua(3,"translate"),Fs(),Ns(4,"input",33),Js("ngModelChange",(function(e){return ei(t),Xs(2).auditFrom=e})),Fs(),Ns(5,"label",34),mo(6),Ua(7,"translate"),Fs(),Ns(8,"input",35),Js("ngModelChange",(function(e){return ei(t),Xs(2).auditTo=e})),Fs(),Fs()}if(2&t){const t=Xs(2);_n(2),vo("",Ea(3,4,"vpAudit.lbl.from"),":"),_n(2),js("ngModel",t.auditFrom),_n(2),vo("",Ea(7,6,"vpAudit.lbl.to"),":"),_n(2),js("ngModel",t.auditTo)}}function zC(t,e){if(1&t){const t=zs();Ns(0,"div",11),Ns(1,"label",32),mo(2),Ua(3,"translate"),Fs(),Ns(4,"input",36),Js("ngModelChange",(function(e){return ei(t),Xs(2).auditFrom=e})),Fs(),Ns(5,"label",34),mo(6),Ua(7,"translate"),Fs(),Ns(8,"input",37),Js("ngModelChange",(function(e){return ei(t),Xs(2).auditTo=e})),Fs(),Fs()}if(2&t){const t=Xs(2);_n(2),vo("",Ea(3,4,"vpAudit.lbl.from"),":"),_n(2),js("ngModel",t.auditFrom),_n(2),vo("",Ea(7,6,"vpAudit.lbl.to"),":"),_n(2),js("ngModel",t.auditTo)}}function QC(t,e){if(1&t&&(Ns(0,"option"),mo(1),Fs()),2&t){const t=e.$implicit;_n(1),fo(t.name)}}function WC(t,e){if(1&t&&(Ns(0,"td",45),mo(1),Ua(2,"date"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.createdAt,"HH:mm:ss"))}}function JC(t,e){if(1&t&&(Ns(0,"td",45),mo(1),Ua(2,"date"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.createdAt,"dd.MM HH:mm"))}}function YC(t,e){if(1&t&&(Ns(0,"td",46),mo(1),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(t.user.email)}}function ZC(t,e){1&t&&(Ns(0,"td",46),mo(1," Unknown "),Fs())}function XC(t,e){if(1&t){const t=zs();Ns(0,"tr",38),Js("click",(function(){ei(t);const i=e.index;return Xs(2).helperAuditIndex(i)})),Gs(1,WC,3,4,"td",39),Gs(2,JC,3,4,"td",39),Gs(3,YC,2,1,"td",40),Gs(4,ZC,2,0,"td",40),Ns(5,"td",41),mo(6),Fs(),Ns(7,"td",42),mo(8),Fs(),Ns(9,"td",43),mo(10),Fs(),Ns(11,"td"),Ns(12,"button",44),Js("click",(function(){ei(t);const i=e.index;return Xs(2).helperAuditIndex(i)})),mo(13,"i"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit,i=Xs(2);_n(1),js("ngIf",i.isToday(t.createdAt)),_n(1),js("ngIf",!i.isToday(t.createdAt)),_n(1),js("ngIf",t.user),_n(1),js("ngIf",!t.user),_n(2),fo(t.actionDescription),_n(2),fo(i.helperShortenText(t.actionInfo,30)),_n(2),fo(i.helperResponseText(t))}}function tV(t,e){1&t&&(Ns(0,"div"),Ns(1,"h3",47),mo(2),Ua(3,"translate"),Fs(),Fs()),2&t&&(_n(2),vo(" ",Ea(3,1,"vpAudit.msg.noAudit")," "))}function eV(t,e){if(1&t){const t=zs();Ns(0,"div",4),Ns(1,"div",5),Ns(2,"h2",6),mo(3),Ua(4,"translate"),Ns(5,"a",7),Js("click",(function(){return ei(t),Xs().goBack()})),mo(6),Fs(),Fs(),Fs(),Ns(7,"form",8,9),Js("ngSubmit",(function(){return ei(t),Xs().getVisboProjectAudits()})),Gs(9,qC,9,8,"div",10),Gs(10,zC,9,8,"div",10),Ns(11,"div",11),Ns(12,"label",12),mo(13),Ua(14,"translate"),Fs(),Ns(15,"input",13),Js("ngModelChange",(function(e){return ei(t),Xs().auditText=e})),Fs(),Ns(16,"label",14),mo(17),Ua(18,"translate"),Fs(),Ns(19,"select",15),Js("ngModelChange",(function(e){return ei(t),Xs().auditCount=e})),Ns(20,"option"),mo(21,"50"),Fs(),Ns(22,"option"),mo(23,"100"),Fs(),Ns(24,"option"),mo(25,"500"),Fs(),Ns(26,"option"),mo(27,"2000"),Fs(),Fs(),Ns(28,"select",16),Js("ngModelChange",(function(e){return ei(t),Xs().auditType=e})),Gs(29,QC,2,1,"option",17),Fs(),Ns(30,"div",18),Ns(31,"button",19),Js("click",(function(){return ei(t),Xs().getVisboProjectAudits()})),mo(32),Ua(33,"translate"),Fs(),Ns(34,"button",20),Js("click",(function(){return ei(t),Xs().downloadVisboAudit()})),mo(35),Ua(36,"translate"),Fs(),Fs(),Fs(),Fs(),Ns(37,"div",21),Ns(38,"div",22),Ns(39,"table",23),Ns(40,"thead",24),Ns(41,"tr"),Ns(42,"th",25),Js("click",(function(){return ei(t),Xs().sortTable(1)})),mo(43),Ua(44,"translate"),Fs(),Ns(45,"th",26),Js("click",(function(){return ei(t),Xs().sortTable(2)})),mo(46),Ua(47,"translate"),Fs(),Ns(48,"th",27),Js("click",(function(){return ei(t),Xs().sortTable(3)})),mo(49),Ua(50,"translate"),Fs(),Ns(51,"th",28),Js("click",(function(){return ei(t),Xs().sortTable(4)})),mo(52),Ua(53,"translate"),Fs(),Ns(54,"th",29),Js("click",(function(){return ei(t),Xs().sortTable(5)})),mo(55),Ua(56,"translate"),Fs(),Ns(57,"th"),mo(58,"Detail"),Fs(),Fs(),Fs(),Ns(59,"tbody",30),Gs(60,XC,14,7,"tr",31),Fs(),Fs(),Gs(61,tV,4,3,"div",0),Fs(),Fs(),Fs()}if(2&t){const t=Xs();_n(3),vo(" ",Ea(4,19,"vpAudit.title"),": "),_n(3),fo(t.visboproject.name),_n(3),js("ngIf",t.sysadmin),_n(1),js("ngIf",!t.sysadmin),_n(3),vo("",Ea(14,21,"vpAudit.lbl.filter"),":"),_n(2),js("ngModel",t.auditText),_n(2),vo("",Ea(18,23,"vpAudit.lbl.max"),":"),_n(2),js("ngModel",t.auditCount),_n(9),js("ngModel",t.auditType),_n(1),js("ngForOf",t.auditTypeList),_n(3),fo(Ea(33,25,"vpAudit.btn.filter")),_n(3),fo(Ea(36,27,"vpAudit.btn.download")),_n(8),fo(Ea(44,29,"vpAudit.lbl.created")),_n(3),fo(Ea(47,31,"vpAudit.lbl.user")),_n(3),fo(Ea(50,33,"vpAudit.lbl.action")),_n(3),fo(Ea(53,35,"vpAudit.lbl.info")),_n(3),fo(Ea(56,37,"vpAudit.lbl.result")),_n(5),js("ngForOf",t.audit),_n(1),js("ngIf",t.audit&&0==t.audit.length)}}function iV(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",62),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",71),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vpAudit.lbl.info"),":"),_n(3),vo("",t.audit[t.auditIndex].actionInfo," ")}}function nV(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",62),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",72),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vpAudit.lbl.vc"),":"),_n(3),vo("",t.audit[t.auditIndex].vc.name," ")}}function rV(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",62),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",73),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,3,"vpAudit.lbl.vp"),":"),_n(3),bo("",t.audit[t.auditIndex].vp.name," (",t.audit[t.auditIndex].vp.vpid,") ")}}function sV(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",62),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",74),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,3,"vpAudit.lbl.vpv"),":"),_n(3),bo("",t.audit[t.auditIndex].vpv.name," (",t.audit[t.auditIndex].vpv.vpvid,")")}}function oV(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",62),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",66),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vpAudit.lbl.techAction"),":"),_n(3),vo("",t.audit[t.auditIndex].action," ")}}function aV(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",62),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",75),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vpAudit.lbl.url"),":"),_n(3),vo("",t.audit[t.auditIndex].url," ")}}function lV(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",62),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",66),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vpAudit.lbl.responseTime"),":"),_n(3),vo("",t.audit[t.auditIndex].result.time," ms ")}}function cV(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",62),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",66),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vpAudit.lbl.responseSize"),":"),_n(3),vo("",t.helperFormatBytes(t.audit[t.auditIndex].result.size||0,2)," ")}}function dV(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",62),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",66),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vpAudit.lbl.userAgent"),":"),_n(3),fo(t.audit[t.auditIndex].userAgent)}}function uV(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",62),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",66),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vpAudit.lbl.ip"),":"),_n(3),fo(t.audit[t.auditIndex].ip)}}function hV(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",62),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",66),mo(5),Ua(6,"date"),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vpAudit.lbl.ttl"),":"),_n(3),fo(Oa(6,4,t.audit[t.auditIndex].ttl,"dd.MM HH:mm"))}}function pV(t,e){if(1&t){const t=zs();Ns(0,"button",76),Js("click",(function(){return ei(t),Xs(2).toggleDetail()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpAudit.btn.more")))}function gV(t,e){if(1&t){const t=zs();Ns(0,"button",77),Js("click",(function(){return ei(t),Xs(2).toggleDetail()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpAudit.btn.less")))}function mV(t,e){if(1&t){const t=zs();Ns(0,"div",48),Ns(1,"div",49),Ns(2,"div",50),Ns(3,"h5",51),mo(4),Ua(5,"translate"),Fs(),Ns(6,"button",52),Ns(7,"span",53),mo(8,"\xd7"),Fs(),Fs(),Fs(),Ns(9,"div",54),Ns(10,"div",5),Ns(11,"div",55),Ns(12,"h3",56),Js("click",(function(){return ei(t),Xs().pageAuditIndex(-1)})),Bs(13,"a",57),Fs(),Fs(),Ns(14,"div",58),Ns(15,"h3",59),Js("click",(function(){return ei(t),Xs().pageAuditIndex(1)})),Bs(16,"a",60),Fs(),Fs(),Fs(),Ns(17,"form",61),Ns(18,"label",62),mo(19),Ua(20,"translate"),Fs(),Ns(21,"label",63),mo(22),Ua(23,"date"),Fs(),Ns(24,"label",62),mo(25),Ua(26,"translate"),Fs(),Ns(27,"label",64),mo(28),Fs(),Ns(29,"label",62),mo(30),Ua(31,"translate"),Fs(),Ns(32,"label",65),mo(33),Fs(),Gs(34,iV,6,4,"div",0),Gs(35,nV,6,4,"div",0),Gs(36,rV,6,5,"div",0),Gs(37,sV,6,5,"div",0),Ns(38,"div"),Ns(39,"label",62),mo(40),Ua(41,"translate"),Fs(),Ns(42,"label",66),mo(43),Fs(),Fs(),Gs(44,oV,6,4,"div",0),Gs(45,aV,6,4,"div",0),Gs(46,lV,6,4,"div",0),Gs(47,cV,6,4,"div",0),Gs(48,dV,6,4,"div",0),Gs(49,uV,6,4,"div",0),Gs(50,hV,7,7,"div",0),Fs(),Fs(),Ns(51,"div",67),Gs(52,pV,3,3,"button",68),Gs(53,gV,3,3,"button",69),Ns(54,"button",70),mo(55),Ua(56,"translate"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs();_n(4),fo(Ea(5,23,"vpAudit.titleDetail")),_n(15),vo("",Ea(20,25,"vpAudit.lbl.created"),":"),_n(3),vo("",Oa(23,27,t.audit[t.auditIndex].createdAt,"dd.MM.yyyy HH:mm:ss.SSS")," "),_n(3),vo("",Ea(26,30,"vpAudit.lbl.user"),":"),_n(3),vo("",t.audit[t.auditIndex].user.email," "),_n(2),vo("",Ea(31,32,"vpAudit.lbl.action"),":"),_n(3),vo("",t.audit[t.auditIndex].actionDescription," "),_n(1),js("ngIf",t.audit[t.auditIndex].actionInfo),_n(1),js("ngIf",t.audit[t.auditIndex].vc),_n(1),js("ngIf",t.audit[t.auditIndex].vp),_n(1),js("ngIf",t.audit[t.auditIndex].vpv),_n(3),vo("",Ea(41,34,"vpAudit.lbl.result"),":"),_n(3),vo("",t.helperResponseText(t.audit[t.auditIndex])," "),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore&&t.audit[t.auditIndex].ttl),_n(2),js("ngIf",!t.showMore),_n(1),js("ngIf",t.showMore),_n(2),fo(Ea(56,36,"vpAudit.btn.back"))}}function fV(t){let e;return t?(e=t.replace(/\t/g," "),"="!==e[0]&&"+"!==e[0]&&"-"!==e[0]||(e="'".concat(e)),e):t}let vV=(()=>{class t{constructor(t,e,i,n,r,s,o,a){this.visboauditService=t,this.visboprojectService=e,this.messageService=i,this.alertService=n,this.location=r,this.route=s,this.router=o,this.translate=a,this.auditTypeList=[{name:"All",action:""},{name:"Read",action:"GET"},{name:"Create",action:"POST"},{name:"Update",action:"PUT"},{name:"Delete",action:"DELETE"}],this.deleted=!1}ngOnInit(){this.sysadmin=this.route.snapshot.queryParams.sysadmin,this.deleted=!!this.route.snapshot.queryParams.deleted,this.getVisboProject(),this.auditCount=50,this.auditType=this.auditTypeList[0].name,this.today=new Date,this.today.setHours(0,0,0,0),this.getVisboProjectAudits(),this.sortTable(void 0)}getVisboProject(){const t=this.route.snapshot.paramMap.get("id");this.log("VisboProject Detail of: "+t),this.visboprojectService.getVisboProject(t,this.sysadmin,this.deleted).subscribe(e=>{this.visboproject=e,this.combinedPerm=e.perm,this.log(`Get VisboProject ${t} ${this.visboproject.name} Perm ${JSON.stringify(this.combinedPerm)}`)},t=>{this.log(`get VPs failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}getVisboProjectAudits(){const t=this.route.snapshot.paramMap.get("id"),e=new lC;this.log(`Audit getVisboProjectAudits from ${this.auditFrom} to ${this.auditTo} Text ${this.auditText} AuditType ${this.auditType}`),this.alertService.clear(),e.to=this.auditTo?new Date(this.auditTo):new Date,this.auditFrom&&(e.from=new Date(this.auditFrom)),this.auditText&&(e.text=this.auditText.trim());for(let i=0;i<this.auditTypeList.length;i++)if(this.auditType===this.auditTypeList[i].name){e.actionType=this.auditTypeList[i].action;break}e.maxcount=this.auditCount,this.log(`Audit getVisboProjectAudits VP ${t} recalc Query ${JSON.stringify(e)}`),this.visboauditService.getVisboProjectAudits(t,this.sysadmin,this.deleted,e).subscribe(t=>{this.audit=t,this.sortTable(void 0);const e=this.translate.instant("vpAudit.msg.auditSuccess");this.alertService.success(e,!0),this.log(`get Audit success ${this.audit.length} for ${this.visboproject.name}`)},t=>{this.log(`get Audit failed: error: ${t.status} message: ${JSON.stringify(t)}`),this.alertService.error(Lh(t))})}downloadVisboAudit(){let t;this.log(`sysAudit Download ${this.audit.length} Items`),t="sep=\t\n",t+="date\ttime UTC\temail\tactiondDescription\taction\turl\tactionInfo\tresponseTime\tresponseStatus\tvcid\tvcname\tvpid\tvpname\tvpvid\tsize\tip\tuserId\tuserAgent\tttl\tVC Details\tVP Details\n";for(let r=0;r<this.audit.length;r++){const e=new Date(this.audit[r].createdAt).toISOString(),i=(this.audit[r].userAgent||"").replace(/,/g,";"),n=e.substr(0,10)+"\t"+e.substr(11,8)+"\t"+fV(this.audit[r].user.email)+"\t"+fV(this.audit[r].actionDescription)+"\t"+this.audit[r].action+"\t"+this.audit[r].url+"\t"+this.audit[r].actionInfo+"\t"+(this.audit[r].result?this.audit[r].result.time:"")+"\t"+(this.audit[r].result?this.audit[r].result.status:"")+"\t"+(this.audit[r].vc?this.audit[r].vc.vcid:"")+"\t"+(this.audit[r].vc?fV(this.audit[r].vc.name):"")+"\t"+(this.audit[r].vp?this.audit[r].vp.vpid:"")+"\t"+(this.audit[r].vp?fV(this.audit[r].vp.name):"")+"\t"+(this.audit[r].vpv?this.audit[r].vpv.vpvid:"")+"\t"+(this.audit[r].result?this.audit[r].result.size:"0")+"\t"+this.audit[r].ip+"\t"+this.audit[r].user.userId+"\t"+fV(i)+"\t"+(this.audit[r].ttl||"")+"\t"+(this.audit[r].vc&&fV(this.audit[r].vc.vcjson)||"")+"\t"+(this.audit[r].vp&&fV(this.audit[r].vp.vpjson)||"")+"\n";t=t.concat(n)}this.log(`sysAudit CSV Len ${t.length} `);const e=new Blob([t],{type:"text/plain"}),i=window.URL.createObjectURL(e);this.log("Open URL "+i);const n=document.createElement("a");document.body.appendChild(n),n.href=i,n.download="auditlog-VP.csv",this.log(`Open URL ${i} doc ${JSON.stringify(n)}`),n.click(),window.URL.revokeObjectURL(i)}goBack(){this.location.back()}helperAuditIndex(t){this.auditIndex=t}helperFormatBytes(t,e=2){if(0===t)return"0 B";const i=e||2,n=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,n)).toFixed(i))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}pageAuditIndex(t){let e;e=this.auditIndex+t,e<0&&(e=0),e>=this.audit.length&&(e=this.audit.length-1),this.auditIndex=e}helperResponseText(t){if(t.result.statusText)return t.result.statusText;const e=t.result.status;return"200"===e||"304"===e?"Success":"400"===e?"Bad Request":"401"===e?"Not Authenticated":"403"===e?"Permission Denied":"404"===e?"URL not found":"409"===e?"Conflict":"423"===e?"Locked":"500"===e?"Server Error":e.toString()}helperShortenText(t,e){return Gh(t,e)}toggleDetail(){this.log("Toggle ShowMore"),this.showMore=!this.showMore}isToday(t){return new Date(t)>this.today}sortTable(t){this.audit&&(this.log("Sort Table Column "+t),void 0!==t?t!==this.sortColumn?(this.sortColumn=t,this.sortAscending=void 0):void 0!==this.sortAscending&&(this.sortAscending=!this.sortAscending):(this.sortColumn=1,this.sortAscending=void 0),void 0===this.sortAscending&&(this.sortAscending=2===t||3===t||4===t),1===this.sortColumn?this.audit.sort((function(t,e){return Th(t.createdAt,e.createdAt)})):2===this.sortColumn?this.audit.sort((function(t,e){return xh(t.user.email.toLowerCase(),e.user.email.toLowerCase())})):3===this.sortColumn?this.audit.sort((function(t,e){return xh(t.actionDescription,e.actionDescription)})):4===this.sortColumn?this.audit.sort((function(t,e){return xh(t.url,e.url)})):5===this.sortColumn?this.audit.sort((function(t,e){return xh(t.result.status,e.result.status)})):6===this.sortColumn?this.audit.sort((function(t,e){return t.result.time-e.result.time})):7===this.sortColumn&&this.audit.sort((function(t,e){return(t.result.size||0)-(e.result.size||0)})),this.sortAscending||this.audit.reverse())}log(t){this.messageService.add("Audit: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(dC),Rs(fb),Rs(Rh),Rs(Df),Rs(Xl),Rs(Fg),Rs(rf),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-visboproject-audit"]],decls:5,vars:4,consts:[[4,"ngIf"],["class","well",4,"ngIf"],["id","AuditDetail","tabindex","-1","role","dialog","aria-labelledby","Audit Detail","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-lg modal-dialog-centered","role","document",4,"ngIf"],[1,"well"],[1,"row"],[1,"panel-heading","ml-0"],[3,"click"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],["class","form-group row",4,"ngIf"],[1,"form-group","row"],["for","auditText",1,"col-1","col-form-label"],["id","auditText","type","text","name","auditText",1,"col-2","col-sm-3","form-control",3,"ngModel","ngModelChange"],["for","auditCount",1,"col-1","col-form-label"],["name","auditCount",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],["id","auditType","id","auditType","name","auditType",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[1,"btn-group"],["type","button",1,"btn","btn-sm","btn-primary","ml-auto","mx-1",3,"click"],["type","button",1,"btn","btn-sm","btn-secondary","ml-auto","mx-1",3,"click"],[1,"container-fluid"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],["id","AuditHead"],["id","SortDate",1,"d-none","d-md-table-cell",3,"click"],["id","SortUser",3,"click"],["id","SortAction",3,"click"],["id","SortInfo",1,"d-none","d-md-table-cell",3,"click"],["id","SortResult",1,"d-none","d-lg-table-cell",3,"click"],["id","AuditList"],["data-toggle","modal","data-target","#AuditDetail",3,"click",4,"ngFor","ngForOf"],["for","auditFrom",1,"col-1","col-form-label"],["id","auditFrom","type","datetime-local","name","auditFrom",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],["for","auditTo",1,"col-1","col-form-label"],["id","auditTo","type","datetime-local","name","auditTo",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],["id","auditFrom","type","date","name","auditFrom",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],["id","auditTo","type","date","name","auditTo",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],["data-toggle","modal","data-target","#AuditDetail",3,"click"],["id","ColCreated","class","d-none d-md-table-cell",4,"ngIf"],["id","ColUser",4,"ngIf"],["id","ColAction"],["id","ColInfo",1,"d-none","d-md-table-cell"],["id","ColResult",1,"d-none","d-lg-table-cell"],["id","ColDetail","data-toggle","modal","data-target","#AuditDetail",1,"Detail",3,"click"],["id","ColCreated",1,"d-none","d-md-table-cell"],["id","ColUser"],[1,"d-flex","justify-content-center"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","AuditDetailTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"col-11"],["id","ButtonPrev",3,"click"],[1,"px-3","col-1","fas","fa-caret-square-left"],[1,"col-1"],["id","ButtonNext",3,"click"],[1,"px-3","col-1","fas","fa-caret-square-right"],["id","auditEntry"],[1,"v_compact_t","col-4","form-control-static"],["id","auditCreated",1,"v_compact_t","col-7","form-control-static"],["id","auditUser",1,"v_compact_t","col-7","form-control-static"],["id","auditAction",1,"v_compact_t","col-7","form-control-static"],[1,"v_compact_t","col-7","form-control-static"],[1,"modal-footer","align-items-end"],["id","ButtonMore","type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["id","ButtonLess","type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-primary"],["id","auditInfo",1,"v_compact_t","col-7","form-control-static"],["id","auditVC",1,"v_compact_t","col-7","form-control-static"],["id","auditVP",1,"v_compact_t","col-7","form-control-static"],["id","auditVPV",1,"v_compact_t","col-7","form-control-static"],[1,"v_compact_t","col-7","form-control-static",2,"overflow-wrap","break-word"],["id","ButtonMore","type","button",1,"btn","btn-secondary",3,"click"],["id","ButtonLess","type","button",1,"btn","btn-secondary",3,"click"]],template:function(t,e){1&t&&(Gs(0,HC,2,0,"div",0),Gs(1,KC,2,0,"div",0),Gs(2,eV,62,39,"div",1),Ns(3,"div",2),Gs(4,mV,57,38,"div",3),Fs()),2&t&&(js("ngIf",!e.sysadmin),_n(1),js("ngIf",e.sysadmin),_n(1),js("ngIf",e.visboproject),_n(2),js("ngIf",e.auditIndex>=0&&e.auditIndex<e.audit.length))},directives:[jc,bb,gC,Ou,Fd,Tu,Od,Nd,Eu,cu,du,gu,Lc],pipes:[av,qc],styles:[".v_compact_t[_ngcontent-%COMP%]{margin:0;padding-top:0}"]}),t})();class bV{}class yV{}class CV{}const VV={headers:new th({"Content-Type":"application/json"})};let wV=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.vpvUrl=this.env.restUrl.concat("/vpv"),this.vpfUrl=this.env.restUrl.concat("/vp")}getVisboProjectVersions(t,e,i,n){const r=""+this.vpvUrl,s=new th({"Content-Type":"application/json"});let o=new nh;return t&&(o=o.append("vpid",t)),e&&(o=o.append("deleted","1")),void 0!==i&&(o=o.append("variantID",i)),n&&(o=o.append("keyMetrics","1")),this.log(`Calling HTTP Request: ${r} Options: ${o}`),this.http.get(this.vpvUrl,{headers:s,params:o}).pipe(D(t=>t.vpv),Kh(t=>this.log(`fetched ${t.length} VisboProjectVersions `)),Nh(this.handleError("getVisboProjectVersions")))}getVisboProjectVersion(t,e=!1){const i=`${this.vpvUrl}/${t}`,n=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("deleted","1")),this.log(`Calling HTTP Request for a specific entry: ${i} Params ${r}`),this.http.get(i,{headers:n,params:r}).pipe(D(t=>(t.vpv[0].perm=t.perm,t.vpv[0])),Kh(()=>this.log("fetched Specific Version ")),Nh(this.handleError("getVisboProjectVersion id="+t)))}addVisboProjectVersion(t){return(new CV).name=t.name,this.http.post(this.vpvUrl,t,VV).pipe(D(t=>JSON.parse(JSON.stringify(t)).vpv),Kh(t=>this.log("added VisboProjectVersion w/ id="+t._id)),Nh(this.handleError("addVisboProjectVersion")))}deleteVisboProjectVersion(t,e=!1){const i=t._id,n=`${this.vpvUrl}/${i}`,r=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("deleted","1")),this.log(`Calling HTTP Request Delete: ${n} Params ${s}`),this.http.delete(n,{headers:r,params:s}).pipe(Kh(()=>this.log("deleted VisboProjectVersion id="+i)),Nh(this.handleError("deleteVisboProjectVersion")))}updateVisboProjectVersion(t,e=!1){const i=`${this.vpvUrl}/${t._id}`,n=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("deleted","1")),this.log(`Calling HTTP Request PUT: ${i} Params ${r}`),this.http.put(i,t,{headers:n,params:r}).pipe(D(t=>t.vpv[0]),Kh(()=>this.log(`updated VisboProjectVersion id=${t._id} url=${this.vpvUrl}`)),Nh(this.handleError("updateVisboProjectVersion")))}getVisboPortfolioVersions(t,e=!1){const i=`${this.vpfUrl}/${t}/portfolio`,n=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("deleted","1")),this.log(`Calling HTTP Request: ${i} Options: ${r}`),this.http.get(i,{headers:n,params:r}).pipe(D(t=>(t.vpf[0].perm=t.perm,t.vpf)),Kh(t=>this.log(`fetched ${t.length} VisboPortfolioVersion `)),Nh(this.handleError("getVisboPortfolioVersions")))}getVisboPortfolioKeyMetrics(t,e=new Date,i=!1){const n=""+this.vpvUrl,r=new th({"Content-Type":"application/json"});let s=new nh;return s=s.append("vpfid",t),s=s.append("refDate",e.toISOString()),s=s.append("keyMetrics","1"),i&&(s=s.append("deleted","1")),this.log(`Calling HTTP Request: ${n} Options: ${s}`),this.http.get(n,{headers:r,params:s}).pipe(D(t=>t.vpv),Kh(t=>this.log(`fetched ${t.length} VisboPortfolio Project Versions `)),Nh(this.handleError("getVisboPortfoliokeyMetrics")))}getVisboCenterProjectVersions(t,e=new Date,i=!1){const n=""+this.vpvUrl,r=new th({"Content-Type":"application/json"});let s=new nh;return s=s.append("vcid",t),s=s.append("refDate",e.toISOString()),s=s.append("keyMetrics","1"),s=s.append("variantID",""),i&&(s=s.append("deleted","1")),this.log(`Calling HTTP Request: ${n} Options: ${s}`),this.http.get(n,{headers:r,params:s}).pipe(D(t=>t.vpv),Kh(t=>this.log(`fetched ${t.length} VisboCenter Project Versions `)),Nh(this.handleError("getVisboCenterProjectkeyMetrics")))}getVisboPortfolioVersion(t,e=!1){const i=`${this.vpfUrl}/${t}/portfolio`,n=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("deleted","1")),this.log(`Calling HTTP Request for a specific entry: ${i} Params ${r}`),this.http.get(i,{headers:n,params:r}).pipe(D(t=>t.vpf[0]),Kh(()=>this.log("fetched Specific Portfolio Version ")),Nh(this.handleError("getVisboPortfolioVersion id="+t)))}getCapacity(t,e,i=!1,n=!1){const r=`${this.vpvUrl}/${t}/capacity`,s=new th({"Content-Type":"application/json"});let o=new nh;return i&&(o=o.append("hierarchy","1")),n&&(o=o.append("pfv","1")),e&&(this.log("Calling RoleID: "+e),o=o.append("roleID",e)),this.log(`Calling HTTP Request: ${r} Options: ${o}`),this.http.get(r,{headers:s,params:o}).pipe(D(t=>t.vpv),Kh(()=>this.log("fetched Capacity Calculation for "+t)),Nh(this.handleError("getVisboProjectVersions")))}getCost(t){const e=`${this.vpvUrl}/${t}/cost`,i=new th({"Content-Type":"application/json"}),n=new nh;return this.log(`Calling HTTP Request: ${e} Options: ${n}`),this.http.get(e,{headers:i,params:n}).pipe(D(t=>t.vpv),Kh(()=>this.log("fetched Cost Calc for "+t)),Nh(this.handleError("getVisboProjectVersions")))}getDelivery(t,e){const i=`${this.vpvUrl}/${t}/delivery`,n=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("ref",e)),this.log(`Calling HTTP Request: ${i} Options: ${r}`),this.http.get(i,{headers:n,params:r}).pipe(D(t=>t.vpv),Kh(()=>this.log("fetched Delivery Calc for "+t)),Nh(this.handleError("getVisboProjectVersions")))}getDeadline(t,e){const i=`${this.vpvUrl}/${t}/deadline`,n=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("ref",e)),this.log(`Calling HTTP Request: ${i} Options: ${r}`),this.http.get(i,{headers:n,params:r}).pipe(D(t=>t.vpv),Kh(()=>this.log("fetched Deadline Calc for "+t)),Nh(this.handleError("getVisboProjectVersions")))}handleError(t="operation"){return e=>(this.log(`HTTP Request ${t} failed: ${e.message} ${e.status}`),jh(e))}log(t){this.messageService.add("VisboProjectVersionService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(Rh),Kt(np))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class AV{}var PV=function(t){return t.SELECTED="SELECTED",t.NOT_SELECTED="NOT_SELECTED",t.PARENT_SELECTED="PARENT_SELECTED",t}({}),kV=i("h9Sk");class DV{constructor(t,e,i,n,r){this.element=t,this.newWidth=e,this.newHeight=i,this.oldWidth=n,this.oldHeight=r}}let MV=(()=>{class t{constructor(t){this.element=t,this.resized=new Ra}ngOnInit(){kV.ResizeSensor&&(this.resizeSensor=new kV.ResizeSensor(this.element.nativeElement,()=>this.onResized()))}ngOnDestroy(){this.resizeSensor&&this.resizeSensor.detach()}onResized(){const t=this.element.nativeElement.clientWidth,e=this.element.nativeElement.clientHeight;if(t===this.oldWidth&&e===this.oldHeight)return;const i=new DV(this.element,t,e,this.oldWidth,this.oldHeight);this.oldWidth=this.element.nativeElement.clientWidth,this.oldHeight=this.element.nativeElement.clientHeight,this.resized.emit(i)}}return t.\u0275fac=function(e){return new(e||t)(Rs(No))},t.\u0275dir=ge({type:t,selectors:[["","resized",""]],outputs:{resized:"resized"}}),t})(),SV=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[]]}),t})(),IV=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[Qc]]}),t})(),xV=(()=>{class t{constructor(){this.google=google}getGoogle(){return this.google}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:IV}),t})(),TV=(()=>{class t{constructor(t){this.gChartService=t}ngOnInit(){this.language||(this.language="de"),this.gLib=this.gChartService.getGoogle(),this.gLib.charts.load("current",{packages:["corechart","table"],language:this.language}),this.gLib.charts.setOnLoadCallback(this.drawChart.bind(this))}ngOnChanges(){this.initialised&&this.drawChart()}drawChart(){const t=new this.gLib.visualization.ComboChart(document.getElementById("divComboChart")),e=new this.gLib.visualization.arrayToDataTable(this.graphData),i=this.parentThis;this.gLib.visualization.events.addListener(t,"select",(function(){const n=t.getSelection();if(n&&0!==n.length){const t=n[0];if(void 0===i)console.log("Chart Combo: The user clicked and this is undefined");else if(t){const n=t.row,r=t.column;if(null!=n&&n>=0){const t=e.getValue(n,0);i.chartSelectRow(n,r,t)}}}else console.log("Chart Combo: chartGetSelection is undefined",n||n.length)})),t.draw(e,this.graphOptions||{title:"Combo Chart"}),this.initialised=!0}}return t.\u0275fac=function(e){return new(e||t)(Rs(xV))},t.\u0275cmp=le({type:t,selectors:[["app-combo-chart"]],inputs:{graphData:"graphData",language:"language",graphOptions:"graphOptions",parentThis:"parentThis"},features:[_e],decls:1,vars:0,consts:[["id","divComboChart"]],template:function(t,e){1&t&&Bs(0,"div",0)},styles:["#divComboChart[_ngcontent-%COMP%]{width:100%;height:500px}"]}),t})();function _V(t,e){1&t&&(Ns(0,"span",21),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"ViewCapacity.title2")))}function UV(t,e){if(1&t){const t=zs();Ns(0,"span",22),Ns(1,"a",23),mo(2),Fs(),Ns(3,"div",24),Ns(4,"a",25),Js("click",(function(){return ei(t),Xs().updateShowUnit("PD")})),mo(5),Ua(6,"translate"),Fs(),Ns(7,"a",25),Js("click",(function(){return ei(t),Xs().updateShowUnit("Euro")})),mo(8),Ua(9,"translate"),Fs(),Fs(),Fs()}if(2&t){const t=Xs();_n(2),vo(" ",t.showUnitText," "),_n(3),fo(Ea(6,3,"ViewCapacity.lbl.pd")),_n(3),fo(Ea(9,5,"ViewCapacity.lbl.euro"))}}const EV=function(){return{standalone:!0}};function OV(t,e){if(1&t){const t=zs();Ns(0,"div",26),Ns(1,"span"),Ns(2,"input",27),Js("change",(function(){return ei(t),Xs().updateRef()}))("ngModelChange",(function(e){return ei(t),Xs().refPFV=e})),Fs(),Ns(3,"label",28),mo(4),Ua(5,"translate"),Fs(),Fs(),Fs()}if(2&t){const t=Xs();_n(2),js("ngModel",t.refPFV)("ngModelOptions",Pa(5,EV)),_n(2),fo(Ea(5,3,"ViewCapacity.lbl.refPFV"))}}function GV(t,e){1&t&&qs(0)}function LV(t,e){1&t&&(Ns(0,"div"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),vo(" ",Ea(2,1,"ViewCapacity.lbl.totalCost")," "))}function RV(t,e){1&t&&(Ns(0,"div"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),vo(" ",Ea(2,1,"ViewCapacity.lbl.totalCostPT")," "))}function jV(t,e){1&t&&qs(0)}function $V(t,e){1&t&&(Ns(0,"span"),mo(1,"T\u20ac"),Fs())}function NV(t,e){1&t&&(Ns(0,"span"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"ViewCapacity.lbl.pd")))}function FV(t,e){1&t&&(Ns(0,"span"),mo(1,"T\u20ac"),Fs())}function BV(t,e){1&t&&(Ns(0,"span"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"ViewCapacity.lbl.pd")))}const HV=function(t){return{level:t}};function KV(t,e){if(1&t&&(Ns(0,"div",29),Ns(1,"h5",30),Ns(2,"strong",31),Gs(3,GV,1,0,"ng-container",32),Fs(),mo(4),Ua(5,"translate"),Fs(),Ns(6,"div",33),Ns(7,"div",15),Ns(8,"div",34),Gs(9,LV,3,3,"div",18),Gs(10,RV,3,3,"div",18),Fs(),Ns(11,"div",35),Ns(12,"strong",31),Gs(13,jV,1,0,"ng-container",32),Fs(),mo(14),Ua(15,"number"),Gs(16,$V,2,0,"span",18),Gs(17,NV,3,3,"span",18),Fs(),Fs(),Ns(18,"div",15),Ns(19,"div",36),Ua(20,"translate"),mo(21),Ua(22,"translate"),Fs(),Ns(23,"div",35),mo(24),Ua(25,"number"),Gs(26,FV,2,0,"span",18),Gs(27,BV,3,3,"span",18),Fs(),Fs(),Fs(),Fs()),2&t){const t=Xs(),e=Ls(35);_n(3),js("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(27,HV,t.getLevel(t.sumCost,t.sumBudget))),_n(1),vo(" ",Ea(5,15,"ViewCapacity.titleBox"),""),_n(5),js("ngIf","PD"!=t.showUnit),_n(1),js("ngIf","PD"==t.showUnit),_n(3),js("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(29,HV,t.getLevel(t.sumCost,t.sumBudget))),_n(1),vo(" ",Oa(15,17,t.sumCost,"1.0-0")," "),_n(2),js("ngIf","PD"!=t.showUnit),_n(1),js("ngIf","PD"==t.showUnit),_n(2),to("title",Ea(20,20,"keyMetrics.longBAC")),_n(2),vo(" ",Ea(22,22,"ViewCapacity.lbl.totalCapa")," "),_n(3),vo(" ",Oa(25,24,t.sumBudget,"1.0-0")," "),_n(2),js("ngIf","PD"!=t.showUnit),_n(1),js("ngIf","PD"==t.showUnit)}}function qV(t,e){1&t&&qs(0)}const zV=function(t){return{$implicit:t,level:0}};function QV(t,e){if(1&t&&(Ns(0,"div",37),Ns(1,"span",38),mo(2),Ua(3,"translate"),Fs(),Gs(4,qV,1,0,"ng-container",32),Fs()),2&t){const t=Xs(),e=Ls(33);_n(2),fo(Ea(3,3,"ViewCapacity.title1")),_n(2),js("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(5,zV,t.orgaTreeData.children))}}function WV(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-combo-chart",40),Fs()),2&t){const t=Xs(2);_n(1),js("graphData",t.graphDataComboChart)("graphOptions",t.graphOptionsComboChart)("parentThis",t.parentThis)("language",t.currentLang)}}function JV(t,e){1&t&&(Ns(0,"div"),Ns(1,"span",38),mo(2),Ua(3,"translate"),Fs(),Fs()),2&t&&(_n(2),fo(Ea(3,1,"ViewCapacity.msg.noCapacity")))}function YV(t,e){if(1&t&&(Ns(0,"div",39),Gs(1,WV,2,4,"div",18),Gs(2,JV,4,3,"div",18),Fs()),2&t){const t=Xs();_n(1),js("ngIf",t.graphDataComboChart.length>2),_n(1),js("ngIf",t.graphDataComboChart.length<2)}}function ZV(t,e){1&t&&(Ns(0,"div"),Ns(1,"span",38),mo(2),Ua(3,"translate"),Fs(),Fs()),2&t&&(_n(2),fo(Ea(3,1,"ViewCapacity.msg.noCapacity")))}function XV(t,e){1&t&&(Ns(0,"span",46),Bs(1,"strong",49),Fs())}function tw(t,e){1&t&&(Ns(0,"span",46),Bs(1,"strong",50),Fs())}function ew(t,e){1&t&&qs(0)}const iw=function(){return{"list-style-type":"none"}},nw=function(t,e){return{$implicit:t,level:e}};function rw(t,e){if(1&t&&(Ns(0,"div",51),Gs(1,ew,1,0,"ng-container",32),Fs()),2&t){const t=Xs().$implicit,e=Xs().level;Xs();const i=Ls(33);js("ngStyle",Pa(3,iw)),_n(1),js("ngTemplateOutlet",i)("ngTemplateOutletContext",Da(4,nw,t.children,e+1))}}const sw=function(t,e){return{"tree-item__selected":t,"tree-item__parent-selected":e}},ow=function(t,e){return{"fa-chevron-right":t,"fa-chevron-down":e}};function aw(t,e){if(1&t){const t=zs();Ns(0,"div",42),Ns(1,"div",43),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(2).selectLeaf(i)})),Ns(2,"span"),Ns(3,"a",44),Js("click",(function(i){ei(t);const n=e.$implicit,r=Xs(2);return i.stopPropagation(),r.switchLeaf(n)})),Bs(4,"i",45),Fs(),Ns(5,"span",46),mo(6),Fs(),Gs(7,XV,2,0,"span",47),Gs(8,tw,2,0,"span",47),Fs(),Fs(),Gs(9,rw,2,7,"div",48),Fs()}if(2&t){const t=e.$implicit,i=Xs().level,n=Xs();_n(1),js("ngClass",Da(8,sw,"SELECTED"===t.isSelected,"PARENT_SELECTED"===t.isSelected)),_n(1),ao("margin-left",20*i+"px"),_n(2),js("ngClass",Da(11,ow,!t.showChildren,t.showChildren)),_n(2),vo(" ",t.name," "),_n(1),js("ngIf",n.capaLoad[t.uid]&&n.capaLoad[t.uid].rankOver>0),_n(1),js("ngIf",n.capaLoad[t.uid]&&n.capaLoad[t.uid].rankUnder>0),_n(1),js("ngIf",(null==t.children?null:t.children.length)>0&&t.showChildren)}}function lw(t,e){1&t&&Gs(0,aw,10,14,"div",41),2&t&&js("ngForOf",e.$implicit)}const cw=function(t,e,i){return{"fa-check-circle text-success":t,"fa-exclamation-triangle text-warning":e,"fa-exclamation-circle text-danger":i}};function dw(t,e){if(1&t&&Bs(0,"i",45),2&t){const t=e.level;js("ngClass",Ma(1,cw,1==t,2==t,3==t))}}function uw(t,e){1&t&&(Ns(0,"div"),Bs(1,"div",52),Ns(2,"span"),mo(3),Ua(4,"translate"),Fs(),Fs()),2&t&&(_n(3),vo(" ",Ea(4,1,"ViewCapacity.msg.calculating"),""))}class hw{}let pw=(()=>{class t{constructor(t,e,i,n,r,s,o,a,l){this.visbocenterService=t,this.visboprojectService=e,this.visboprojectversionService=i,this.visbosettingService=n,this.messageService=r,this.alertService=s,this.route=o,this.router=a,this.translate=l,this.sumCost=0,this.sumBudget=0,this.refPFV=!1,this.parentThis=this,this.colors=["#F7941E","#BDBDBD","#458CCB"],this.graphDataComboChart=[],this.graphOptionsComboChart={chartArea:{left:100,top:100,width:"100%",height:"80%"},width:"100%",height:"600",title:"Monthly Capacity comparison",animation:{startup:!0,duration:200},legend:{position:"top"},explorer:{actions:["dragToZoom","rightClickToReset"],maxZoomIn:.01},colors:this.colors,seriesType:"bars",series:{0:{type:"line",lineWidth:4,pointSize:0},1:{type:"line",lineWidth:2,lineDashStyle:[4,4],pointSize:1}},isStacked:!0,tooltip:{isHtml:!0},vAxis:{title:"Monthly Capacity",format:"###,###.## T\u20ac",minorGridlines:{count:0,color:"none"}},hAxis:{format:"MMM yy",gridlines:{color:"#FFF",count:-1},minorGridlines:{count:0,color:"none"}}},this.permVC=Av,this.permVP=Pv}ngOnInit(){this.currentLang=this.translate.currentLang,this.initSetting(),this.refDate||(this.refDate=new Date),this.currentRefDate=this.refDate,this.showUnitText=this.translate.instant("PD"==this.showUnit?"ViewCapacity.lbl.pd":"ViewCapacity.lbl.euro"),this.log(`Capacity Init  RefDate ${this.refDate} Current RefDate ${this.currentRefDate}`),this.capaLoad=[],this.visboGetOrganisation()}ngOnChanges(t){this.log(`Capacity Changes  RefDate ${this.refDate} Current RefDate ${this.currentRefDate}, Changes: ${JSON.stringify(t)}`),void 0!==this.currentRefDate&&this.refDate.getTime()!==this.currentRefDate.getTime()&&(this.initSetting(),this.getCapacity())}onResized(t){t||this.log("No event in Resize");let e=0;this.chartActive&&(e=(new Date).getTime()-this.chartActive.getTime()),e<1e3||Math.abs(t.newWidth-t.oldWidth)<5||(this.log(`Capacity Resize ${e} ${Math.abs(t.newHeight-t.oldHeight)} ${Math.abs(t.newWidth-t.oldWidth)}`),this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(()=>{this.visboViewCapacityOverTime(),this.timeoutID=void 0},500))}initSetting(){this.chartActive=void 0,this.roleID=this.route.snapshot.queryParams.roleID;const t=this.route.snapshot.queryParams.pfv;this.refPFV=!(!t||!Number(t)),this.initShowUnit(this.route.snapshot.queryParams.unit);const e=this.route.snapshot.queryParams.from,i=this.route.snapshot.queryParams.to;e&&Uh(e,!1)?this.capacityFrom=new Date(Uh(e,!1)):(this.capacityFrom=new Date,this.capacityFrom.setMonth(this.capacityFrom.getMonth()-3)),this.capacityFrom.setDate(1),this.capacityFrom.setHours(0,0,0,0),i&&Uh(i,!1)?this.capacityTo=new Date(Uh(i,!1)):(this.capacityTo=new Date,this.capacityTo.setMonth(this.capacityFrom.getMonth()+9)),this.capacityTo.setDate(1),this.capacityTo.setHours(0,0,0,0),this.log(`Capacity From / To ${this.capacityFrom} / ${this.capacityTo}`)}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}hasVCPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vc&t)>0}visboGetOrganisation(){let t;this.vcActive?t=this.vcActive._id:this.vpActive&&(t=this.vpActive.vcid),t&&(this.log("Organisaions for CapacityCalc for Object  "+t),this.visbosettingService.getVCOrganisations(t,!1,(new Date).toISOString()).subscribe(t=>{0===t.length?(this.log("get VCOrganisations - result is empty "),this.vcorganisation=[]):(this.log("Store Organisation for Len "+t.length),this.vcorganisation=t,this.vcorganisation.sort((function(t,e){return Th(t.timestamp,e.timestamp)})),this.actOrga=this.vcorganisation[this.vcorganisation.length-1].value),this.visboViewOrganisationTree(),this.getCapacity()},t=>{if(this.log(`get VCOrganisations failed: error: ${t.status} message: ${t.error.message}`),403===t.status){let t;this.vpActive?t=this.vpActive.name:this.vcActive&&(t=this.vcActive.name);const e=this.translate.instant("ViewCapacity.msg.errorPermCapacity",{name:t});this.log("Alert: "+e),this.alertService.error(e,!0)}else this.alertService.error(Lh(t),!0)}))}getCapacity(){this.visboCapcity=void 0,this.vcActive?(this.log(`Capacity Calc for VC ${this.vcActive._id} role ${this.currentLeaf.name}`),this.visbocenterService.getCapacity(this.vcActive._id,this.refDate,this.currentLeaf.uid.toString(),!0,this.refPFV).subscribe(t=>{t.capacity&&0!==t.capacity.length?(this.log("Store Capacity for Len "+t.capacity.length),this.visboCapcity=t.capacity.filter(t=>t.roleID==this.currentLeaf.uid.toString()),this.visboCapcityChild=t.capacity.filter(t=>t.roleID!=this.currentLeaf.uid.toString())):(this.log("get VPV Calc: Reset Capacity to empty "),this.visboCapcity=[],this.visboCapcityChild=[]),this.topLevelNodes.findIndex(t=>t.uid==this.currentLeaf.uid)>=0&&this.calcLoad(this.visboCapcity,this.refPFV),this.calcLoad(this.visboCapcityChild,this.refPFV),this.visboViewCapacityOverTime()},t=>{if(this.log(`get VC Capacity failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("ViewCapacity.msg.errorPermCapacity",{name:this.vcActive.name});this.alertService.error(t,!0)}else if(409===t.status){const t=this.translate.instant("ViewCapacity.msg.errorPermOrganisation",{name:this.vcActive.name});this.alertService.error(t,!0)}else this.alertService.error(Lh(t),!0)})):this.vpActive&&this.vpfActive?(this.log(`Capacity Calc for VP ${this.vpActive._id} VPF ${this.vpfActive._id} role ${this.currentLeaf.name}`),this.visboprojectService.getCapacity(this.vpActive._id,this.vpfActive._id,this.refDate,this.currentLeaf.uid.toString(),!0,this.refPFV).subscribe(t=>{t.capacity&&0!==t.capacity.length?(this.log("Store Capacity for Len "+t.capacity.length),this.visboCapcity=t.capacity.filter(t=>t.roleID==this.currentLeaf.uid.toString()),this.visboCapcityChild=t.capacity.filter(t=>t.roleID!=this.currentLeaf.uid.toString())):(this.log("get VPF Calc: Reset Capacity to empty "),this.visboCapcity=[]),this.topLevelNodes.findIndex(t=>t.uid==this.currentLeaf.uid)>=0&&this.calcLoad(this.visboCapcity,this.refPFV),this.calcLoad(this.visboCapcityChild,this.refPFV),this.visboViewCapacityOverTime()},t=>{if(this.log(`get VPF Capacity failed: error: ${t.status} message: ${t.error&&t.error.message}`),403===t.status){const t=this.translate.instant("ViewCapacity.msg.errorPermCapacity",{name:this.vpActive.name});this.alertService.error(t,!0)}else this.alertService.error(Lh(t),!0)})):this.vpActive&&this.vpvActive&&(this.refPFV=!0,this.log(`Capacity Calc for VPV ${this.vpvActive.vpid} role ${this.currentLeaf.name}`),this.visboprojectversionService.getCapacity(this.vpvActive._id,this.currentLeaf.uid.toString(),!0,this.refPFV).subscribe(t=>{if(t&&1==t.length&&t[0].capacity&&0!==t[0].capacity.length){const e=t[0];this.log("Store Capacity for Len "+e.capacity.length),this.visboCapcity=e.capacity.filter(t=>t.roleID==this.currentLeaf.uid),this.visboCapcityChild=e.capacity.filter(t=>t.roleID!=this.currentLeaf.uid)}else this.log("get VPF Calc: Reset Capacity to empty "),this.visboCapcity=[];this.topLevelNodes.findIndex(t=>t.uid==this.currentLeaf.uid)>=0&&this.calcLoad(this.visboCapcity,this.refPFV),this.calcLoad(this.visboCapcityChild,this.refPFV),this.visboViewCapacityOverTime()},t=>{if(this.log(`get VPF Capacity failed: error: ${t.status} message: ${t.error&&t.error.message}`),403===t.status){const t=this.translate.instant("ViewCapacity.msg.errorPermCapacity",{name:this.vpActive.name});this.alertService.error(t,!0)}else this.alertService.error(Lh(t),!0)}))}checkCostAvailable(t){let e=!1;t&&t.length>0&&(e=null!=t[0].actualCost||null!=t[0].plannedCost||null!=t[0].baselineCost),this.hasCost=e}calcLoad(t,e=!1){if(!t||0==t.length)return;function i(t,e,i,n=!1){const r=new Date(t.month);if(r.getTime()<e.getTime()||r.getTime()>i.getTime())return 0;let s=0,o=0;return s=n?(null==t?void 0:t.baselineCost_PT)||0:((null==t?void 0:t.internCapa_PT)||0)+((null==t?void 0:t.externCapa_PT)||0),o=((null==t?void 0:t.actualCost_PT)||0)+((null==t?void 0:t.plannedCost_PT)||0),o>0&&0===s&&(s=1),o/s-1}this.checkCostAvailable(t);let n=[];for(let s=0;s<t.length;s++){const r=i(t[s],this.capacityFrom,this.capacityTo,e),o=t[s].roleID;if(!n[o]){const t=new hw;t.uid=o,t.percentOver=0,t.percentUnder=0,n[o]=t}r>0?n[o].percentOver+=r:r<0&&(n[o].percentUnder+=r)}n=n.filter(t=>t.uid>=0);let r=Math.round(n.length/4);r<3&&(r=Math.min(3,n.length)),n.sort((function(t,e){return e.percentOver-t.percentOver}));for(let s=0;s<r&&!(n[s].percentOver<=0);s++)n[s].rankOver=r-s;n.sort((function(t,e){return t.percentUnder-e.percentUnder}));for(let s=0;s<r&&!(n[s].percentUnder>=0);s++)n[s].rankOver>0||(n[s].rankUnder=r-s);for(let s=0;s<n.length;s++)this.capaLoad[n[s].uid]=n[s]}visboViewOrganisationTree(){this.log("Show the OrgaTree of the VC ");const t=this.actOrga,e=[],i=[];this.log("get all roles of the organisation, prepared for direct access");for(let n=0;t&&t.allRoles&&t.allRoles&&n<t.allRoles.length;n++)e[t.allRoles[n].uid]=t.allRoles[n],i[t.allRoles[n].name]=t.allRoles[n];this.log("get all roles of the organisation, prepared for the TreeView"),this.topLevelNodes=this.buildTopNodes(e),this.orgaTreeData=this.buildOrgaTree(this.topLevelNodes,e),this.log("initialize the orgaTreeData with one of the topLevel"),this.roleID>=0&&this.roleID<e.length&&(this.currentLeaf=this.getMappingLeaf(e[this.roleID].name)),this.currentLeaf||(this.currentLeaf=this.orgaTreeData.children[0]),this.expandParentTree(this.currentLeaf),this.setTreeLeafSelection(this.currentLeaf,PV.SELECTED)}initShowUnit(t){this.showUnit=t="PD"==t?"PD":void 0,this.updateUrlParam("unit","PD"==t?"1":"0"),this.showUnitText=this.translate.instant("PD"===t?"ViewCapacity.lbl.pd":"ViewCapacity.lbl.euro")}updateShowUnit(t){this.initShowUnit(t),this.visboViewCapacityOverTime()}updateDateRange(){this.updateUrlParam("from",void 0),this.visboViewCapacityOverTime()}updateRef(){this.log(`Show Ref change: ${status} to ${this.refPFV}`),this.updateUrlParam("pfv",this.refPFV?"1":"0"),this.capaLoad=[],this.getCapacity()}updateUrlParam(t,e){const i=this.route.snapshot.url.join("/");void 0===e&&(e=null);const n=new bV;"roleID"==t?n.roleID=Number(e):"from"==t||"to"==t?(n.from=this.capacityFrom.toISOString(),n.to=this.capacityTo.toISOString()):"unit"==t?n.unit=e:"pfv"==t&&(n.pfv=e),this.router.navigate([i],{queryParams:n,replaceUrl:!0,queryParamsHandling:"merge"})}visboViewCapacityOverTime(){let t="###,###.## T\u20ac";"PD"===this.showUnit&&(t="# "+this.translate.instant("ViewCapacity.lbl.pd")),this.graphOptionsComboChart.title=this.translate.instant("ViewCapacity.titleCapaOverTime"),this.graphOptionsComboChart.vAxis.title=this.translate.instant("ViewCapacity.yAxisCapaOverTime"),this.graphOptionsComboChart.vAxis.format=t,this.colors=this.refPFV?["#F7941E","#FDFDFD","#BDBDBD","#458CCB"]:["#F7941E","#F7941E","#BDBDBD","#458CCB"],this.graphOptionsComboChart.colors=this.colors,this.graphOptionsComboChart.series=this.refPFV?{0:{type:"line",lineWidth:4,pointSize:0},1:{type:"line",lineWidth:0,lineDashStyle:[4,4],pointSize:0}}:{0:{type:"line",lineWidth:4,pointSize:0},1:{type:"line",lineWidth:2,lineDashStyle:[4,4],pointSize:1}};const e=[];if(!this.visboCapcity||0===this.visboCapcity.length)return void(this.graphDataComboChart=[]);const i=this.visboCapcity;this.capacityTo||(this.capacityTo=new Date,this.capacityTo.setMonth(this.capacityTo.getMonth()+9),this.capacityTo.setDate(1)),this.capacityTo<this.capacityFrom&&this.capacityTo.setMonth(this.capacityFrom.getMonth()+12),this.log("ViewCapacityOverTime resource "+this.currentLeaf.name),this.sumCost=0,this.sumBudget=0;for(let r=0;r<i.length;r++){const t=new Date(i[r].month);if(t.setHours(2,0,0,0),t>=this.capacityFrom&&t<=this.capacityTo){const n=this.currentLeaf.uid;if(this.refPFV)if("PD"===this.showUnit){const s=Math.round(10*i[r].baselineCost_PT)/10||0,o=Math.round(10*i[r].actualCost_PT)/10||0,a=Math.round(10*i[r].plannedCost_PT)/10||0;this.sumCost+=o+a,this.sumBudget+=s,e.push([t,i[r].roleID==n?s:void 0,i[r].roleID==n?this.createCustomHTMLContent(i[r],!0,this.refPFV):void 0,i[r].roleID==n?0:void 0,i[r].roleID==n?0:void 0,o,this.createCustomHTMLContent(i[r],!0,this.refPFV),a,this.createCustomHTMLContent(i[r],!0,this.refPFV)])}else{const s=Math.round(10*i[r].baselineCost/10||0),o=Math.round(10*i[r].actualCost/10||0),a=Math.round(10*i[r].plannedCost/10||0);this.sumCost+=o+a,this.sumBudget+=s,e.push([t,i[r].roleID==n?s:void 0,i[r].roleID==n?this.createCustomHTMLContent(i[r],!1,this.refPFV):void 0,i[r].roleID==n?0:void 0,i[r].roleID==n?0:void 0,o,this.createCustomHTMLContent(i[r],!1,this.refPFV),a,this.createCustomHTMLContent(i[r],!1,this.refPFV)])}else if("PD"===this.showUnit){const s=Math.round(10*i[r].internCapa_PT)/10||0,o=Math.round(10*i[r].externCapa_PT)/10||0,a=Math.round(10*i[r].actualCost_PT)/10||0,l=Math.round(10*i[r].plannedCost_PT)/10||0;this.sumCost+=a+l,this.sumBudget+=s+o,e.push([t,i[r].roleID==n?s+o:void 0,i[r].roleID==n?this.createCustomHTMLContent(i[r],!0):void 0,i[r].roleID==n?s:void 0,i[r].roleID==n?this.createCustomHTMLContent(i[r],!0):void 0,a,this.createCustomHTMLContent(i[r],!0),l,this.createCustomHTMLContent(i[r],!0)])}else{const s=Math.round(10*i[r].internCapa/10||0),o=Math.round(10*i[r].externCapa/10||0),a=Math.round(10*i[r].actualCost/10||0),l=Math.round(10*i[r].plannedCost/10||0);this.sumCost+=a+l,this.sumBudget+=s+o,e.push([t,i[r].roleID==n?s+o:void 0,i[r].roleID==n?this.createCustomHTMLContent(i[r],!1):void 0,i[r].roleID==n?s:void 0,i[r].roleID==n?this.createCustomHTMLContent(i[r],!1):void 0,a,this.createCustomHTMLContent(i[r],!1),l,this.createCustomHTMLContent(i[r],!1)])}}}const n=e.length;if(n<1&&this.log("visboCapacity Empty"),1===n){const t=new Date(e[0][0]);t.setMonth(t.getMonth()+1),e.push([t,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0])}e.unshift(this.refPFV?["Month",this.translate.instant("ViewCapacity.budgetPT"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("ViewCapacity.budgetBase"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("ViewCapacity.actualCostPT"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("ViewCapacity.plannedCostPT"),{type:"string",role:"tooltip",p:{html:!0}}]:["Month",this.translate.instant("ViewCapacity.totalCapaPT"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("ViewCapacity.internCapaPT"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("ViewCapacity.actualCostPT"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("ViewCapacity.plannedCostPT"),{type:"string",role:"tooltip",p:{html:!0}}]),this.graphDataComboChart=e,this.chartActive=new Date}chartSelectRow(t,e,i){this.log(`chart Select Row ${t} ${e} ${i} `)}createCustomHTMLContent(t,e,i=!1){let n='<div style="padding:5px 5px 5px 5px;color:black;width:180px;"><div><b>'+_h(new Date(t.month),"shortDate",this.currentLang)+"</b></div><div><table>";const r=this.translate.instant("ViewCapacity.totalCapaPT"),s=this.translate.instant("ViewCapacity.internCapaPT"),o=this.translate.instant("ViewCapacity.actualCostPT"),a=this.translate.instant("ViewCapacity.plannedCostPT"),l=this.translate.instant("ViewCapacity.roleName"),c=this.translate.instant("ViewCapacity.budgetPT");let d,u,h,p,g,m;return i?(e?(m=" "+this.translate.instant("ViewCapacity.lbl.pd"),h=(t.actualCost_PT||0).toFixed(0),p=(t.plannedCost_PT||0).toFixed(0),d=(t.baselineCost_PT||0).toFixed(0),g=(t.baselineCost_PT||0).toFixed(0)):(m=" "+this.translate.instant("ViewCapacity.lbl.euro"),h=(t.actualCost||0).toFixed(1),p=(t.plannedCost||0).toFixed(1),d=(t.baselineCost||0).toFixed(1),g=(t.baselineCost||0).toFixed(1)),n=n+"<tr><td>"+l+":</td><td><b>"+t.roleName+"</b></td></tr>",n=n+"<tr><td>"+c+':</td><td align="right"><b>'+g+m+"</b></td></tr>",n=n+"<tr><td>"+o+':</td><td align="right"><b>'+h+m+"</b></td></tr>",n=n+"<tr><td>"+a+':</td><td align="right"><b>'+p+m+"</b></td></tr>",n+="</table></div></div>",n):(e?(m=" "+this.translate.instant("ViewCapacity.lbl.pd"),h=(t.actualCost_PT||0).toFixed(0),p=(t.plannedCost_PT||0).toFixed(0),d=(t.internCapa_PT||0).toFixed(0),u=((t.internCapa_PT||0)+(t.externCapa_PT||0)).toFixed(0)):(m=" "+this.translate.instant("ViewCapacity.lbl.euro"),h=(t.actualCost||0).toFixed(1),p=(t.plannedCost||0).toFixed(1),d=(t.internCapa||0).toFixed(1),u=((t.internCapa||0)+(t.externCapa||0)).toFixed(1)),n=n+"<tr><td>"+l+":</td><td><b>"+t.roleName+"</b></td></tr>",n=n+"<tr><td>"+r+':</td><td align="right"><b>'+u+m+"</b></td></tr>",n=n+"<tr><td>"+s+':</td><td align="right"><b>'+d+m+"</b></td></tr>",n=n+"<tr><td>"+o+':</td><td align="right"><b>'+h+m+"</b></td></tr>",n=n+"<tr><td>"+a+':</td><td align="right"><b>'+p+m+"</b></td></tr>",n+="</table></div></div>",n)}displayCapacity(){let t=-1;return this.actOrga&&this.visboCapcity&&(t=this.visboCapcity.length),t}getLevel(t,e){let i=1;return e&&(i=t/e),i<=1?1:i<=1.05?2:3}getSummaryRoles(t,e){this.log("get all summary roles of the organisation roleID "+{roleID:e});const i=[];if(void 0===e&&t){let e=0;for(e=0;t&&e<=t.length;e++){const n=t[e];n&&n.subRoleIDs.length>0&&(i[t[e].uid]=t[e])}return i}if(e&&t){const n=t[e];if(n.subRoleIDs&&n.subRoleIDs.length>0){const e=n.subRoleIDs;e.length>0&&(i[n.uid]=n,e.forEach((function e(n){const r=n.key,s=t[r];s.subRoleIDs.length>0&&(i[r]=s,s.subRoleIDs.forEach(e))})))}return i}}getParentOfRole(t,e,i){let n;if(e[t]){let e=!0;for(let r=0;i&&r<i.length;r++){const s=i[r];if(s)for(let i=0;e&&s&&s.subRoleIDs&&i<s.subRoleIDs.length;i++)s.subRoleIDs[i]&&1*s.subRoleIDs[i].key===t&&(n=s,e=!1)}return n}}buildTopNodes(t){const e=[],i=[];let n=1;this.log("get all TopNodes of the organisation");const r=this.getSummaryRoles(t,void 0);for(;n<=t.length;){const s=t[n];s&&(this.getParentOfRole(s.uid,t,r)||i[s.uid]||(i[s.uid]=s,e.push(s))),n++}return e}buildOrgaTree(t,e){this.log("build the OrgaTree used for the selectionTree of the organisation");const i=new AV;function n(t,i){const r=new AV,s=t.key,o=e[s],a=null==o?void 0:o.name;return r.children=[],r.uid=s,r.name=a,r.parent=i,o.subRoleIDs.forEach((function(t){r.children.push(n(t,r))})),r}i.uid=0,i.name="root",i.parent=null,i.children=[],i.showChildren=!0;for(let r=0;t&&r<t.length;r++){const e=new AV;e.parent=i,e.children=[],e.uid=t[r].uid,e.name=t[r].name,e.showChildren=!1,t&&t[r].subRoleIDs&&t[r].subRoleIDs.length>0&&t[r].subRoleIDs.forEach((function(t){e.children.push(n(t,e))})),i.children.push(e)}return i}setTreeLeafSelection(t,e){t.isSelected=e,t.children&&0!==t.children.length&&t.children.forEach(t=>{this.setTreeLeafSelection(t,e===PV.SELECTED?PV.PARENT_SELECTED:e)})}selectLeaf(t,e=!0){t.name!==this.currentLeaf.name&&(this.setTreeLeafSelection(this.currentLeaf,PV.NOT_SELECTED),this.currentLeaf=t,this.updateUrlParam("roleID",t.uid.toString()),this.getCapacity()),e&&(t.showChildren=!0),this.setTreeLeafSelection(t,PV.SELECTED)}switchLeaf(t){t.showChildren=!t.showChildren,this.selectLeaf(t,t.showChildren)}expandParentTree(t){null!==t.parent&&(t.parent.showChildren=!0,this.expandParentTree(t.parent))}getMappingLeaf(t){let e;const i=this.orgaTreeData;let n=!1;function r(i){const s=i;if(s.name===t)s&&s.children&&s.children.length>0&&(s.showChildren=!0),e=s,n=!0;else{const t=s.children;for(let e=0;!n&&t&&e<t.length;e++)r(t[e])}}for(let s=0;!n&&i&&i.children&&s<i.children.length;s++)r(i.children[s]);return e}parseDate(t){return t?new Date(t):null}log(t){this.messageService.add("CompVisboViewCapcity: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(xv),Rs(fb),Rs(wV),Rs(Ib),Rs(Rh),Rs(Df),Rs(Fg),Rs(rf),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-comp-viewcapacity"]],inputs:{vcActive:"vcActive",vpActive:"vpActive",vpfActive:"vpfActive",vpvActive:"vpvActive",vcOrganisation:"vcOrganisation",refDate:"refDate",combinedPerm:"combinedPerm"},features:[_e],decls:37,vars:25,consts:[[1,"well",3,"resized"],[1,"container-fluid","mb-2"],[1,"row","row-cols-1","row-cols-lg-2"],[1,"col","col-sm-12","col-lg-8"],[1,"text-dark"],[1,"row","ml-1"],[1,"pt-2","mr-2"],[1,"pt-2"],["id","capacityFrom","type","date","name","capacityFrom",1,"pt-2","ml-4","mr-2","border-0","font-weight-bold",2,"width","170px",3,"ngModel","input","change"],["id","capacityTo","type","date","name","capacityTo",1,"pt-2","ml-4","mr-2","border-0","font-weight-bold",2,"width","170px",3,"ngModel","input","change"],["class","pt-2 mr-auto",4,"ngIf"],["class","pt-2 mr-auto dropdown",4,"ngIf"],["class","row ml-1 pt-3 pb-2 form-check",4,"ngIf"],["class","col-sm-12 col-md-10 col-lg-4 card align-right px-0",4,"ngIf"],[1,""],[1,"row"],["class","pl-3 col-3 border-right scroll",4,"ngIf"],["class","col-9",4,"ngIf"],[4,"ngIf"],["recursiveList",""],["indicator",""],[1,"pt-2","mr-auto"],[1,"pt-2","mr-auto","dropdown"],["data-toggle","dropdown",1,"pt-2","pl-2","font-weight-bold","dropdown-toggle"],[1,"dropdown-menu"],[1,"dropdown-item",3,"click"],[1,"row","ml-1","pt-3","pb-2","form-check"],["type","checkbox","id","idRefPFV",1,"form-check-input",3,"ngModel","ngModelOptions","change","ngModelChange"],["for","idRefPFV",1,"form-check-label"],[1,"col-sm-12","col-md-10","col-lg-4","card","align-right","px-0"],[1,"card-header","p-2"],[1,"mr-1"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"card-body","p-2"],[1,"col","col-sm-6"],[1,"col","col-sm-6","text-right"],[1,"col","col-sm-6",3,"title"],[1,"pl-3","col-3","border-right","scroll"],[1,"pt-2","text-dark","font-weight-bold"],[1,"col-9"],[3,"graphData","graphOptions","parentThis","language"],["style","white-space: nowrap;",4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[1,"dropdown-item","tree-item",3,"ngClass","click"],[3,"click"],[1,"fa",3,"ngClass"],[1,"ml-sm-1"],["class","ml-sm-1",4,"ngIf"],[3,"ngStyle",4,"ngIf"],[1,"fas","fa-arrow-up",2,"color","red"],[1,"fas","fa-arrow-down",2,"color","green"],[3,"ngStyle"],["role","status",1,"spinner-border"]],template:function(t,e){1&t&&(Ns(0,"div",0),Js("resized",(function(t){return e.onResized(t)})),Ns(1,"div",1),Ns(2,"div",2),Ns(3,"div",3),Ns(4,"div",4),Ns(5,"div",5),Ns(6,"span"),Ns(7,"label",6),mo(8),Ua(9,"translate"),Fs(),Fs(),Ns(10,"span"),Ns(11,"label",7),mo(12),Ua(13,"translate"),Fs(),Ns(14,"input",8),Js("input",(function(t){return e.capacityFrom=e.parseDate(t.target.value)}))("change",(function(){return e.updateDateRange()})),Ua(15,"date"),Fs(),Fs(),Ns(16,"span"),Ns(17,"label",7),mo(18),Ua(19,"translate"),Fs(),Ns(20,"input",9),Js("input",(function(t){return e.capacityTo=e.parseDate(t.target.value)}))("change",(function(){return e.updateDateRange()})),Ua(21,"date"),Fs(),Fs(),Ns(22,"div",7),Gs(23,_V,3,3,"span",10),Gs(24,UV,10,7,"span",11),Fs(),Fs(),Gs(25,OV,6,6,"div",12),Fs(),Fs(),Gs(26,KV,28,31,"div",13),Fs(),Fs(),Ns(27,"div",14),Ns(28,"div",15),Gs(29,QV,5,7,"div",16),Gs(30,YV,3,2,"div",17),Gs(31,ZV,4,3,"div",18),Fs(),Fs(),Gs(32,lw,1,1,"ng-template",null,19,ja),Gs(34,dw,1,5,"ng-template",null,20,ja),Gs(36,uw,5,3,"div",18),Fs()),2&t&&(_n(8),fo(Ea(9,13,"ViewCapacity.titleCapacity")),_n(4),fo(Ea(13,15,"ViewCapacity.titleTimeFrom")),_n(2),js("ngModel",Oa(15,17,e.capacityFrom,"yyyy-MM-dd")),_n(4),fo(Ea(19,20,"ViewCapacity.titleTimeTo")),_n(2),js("ngModel",Oa(21,22,e.capacityTo,"yyyy-MM-dd")),_n(3),js("ngIf",e.hasCost),_n(1),js("ngIf",e.hasCost),_n(1),js("ngIf",!e.vpvActive),_n(1),js("ngIf",e.visboCapcity&&e.visboCapcity.length>0),_n(3),js("ngIf",e.orgaTreeData),_n(1),js("ngIf",e.displayCapacity()>0),_n(1),js("ngIf",0==e.displayCapacity()),_n(5),js("ngIf",e.displayCapacity()<0))},directives:[MV,Od,Nd,Eu,jc,_d,Bc,TV,Lc,Oc,Fc],pipes:[av,qc,zc],styles:[".dropdown-item.tree-item[_ngcontent-%COMP%]{opacity:.7;cursor:pointer}.dropdown-item.tree-item.tree-item__selected[_ngcontent-%COMP%]{background-color:#afb9c0}.dropdown-item.tree-item.tree-item__parent-selected[_ngcontent-%COMP%]{background-color:#d8dadb}.dropdown-item.tree-item[_ngcontent-%COMP%]:hover{opacity:1}.scroll[_ngcontent-%COMP%]{background:#fcfdfd;height:645px;overflow-y:scroll;padding:1px}"]}),t})(),gw=(()=>{class t{constructor(t){this.gChartService=t}ngOnInit(){this.language||(this.language="de"),this.gLib=this.gChartService.getGoogle(),this.gLib.charts.load("current",{packages:["corechart","table"],language:this.language}),this.gLib.charts.setOnLoadCallback(this.drawChart.bind(this))}ngOnChanges(){this.initialised&&this.drawChart()}drawChart(){const t=new this.gLib.visualization.BubbleChart(document.getElementById("divBubbleChart")),e=new this.gLib.visualization.arrayToDataTable(this.graphData),i=this.parentThis;this.gLib.visualization.events.addListener(t,"select",(function(){const n=t.getSelection()[0];if(void 0===i)console.log("Bubble: The user clicked and this is undefined");else if(n){const t=n.row,r=e.getValue(n.row,0);i.chartSelectRow(t,r)}})),this.gLib.visualization.events.addListener(t,"click",(function(t){void 0===i?console.log("Bubble: The user clicked and this is undefined"):t?console.log("Bubble: The user clicked "+JSON.stringify(t)):console.log("Bubble: The user clicked somewhere")})),t.draw(e,this.graphOptions||{title:"Bubble Chart"}),this.initialised=!0}}return t.\u0275fac=function(e){return new(e||t)(Rs(xV))},t.\u0275cmp=le({type:t,selectors:[["app-bubble-chart"]],inputs:{graphData:"graphData",language:"language",graphOptions:"graphOptions",parentThis:"parentThis"},features:[_e],decls:1,vars:0,consts:[["id","divBubbleChart"]],template:function(t,e){1&t&&Bs(0,"div",0)},styles:["#divBubbleChart[_ngcontent-%COMP%]{width:100%;height:400px}"]}),t})();function mw(t,e){if(1&t&&(Ns(0,"div",26),Ns(1,"div",33),Ns(2,"div",28),Ns(3,"span"),mo(4),Ua(5,"translate"),Fs(),Ns(6,"span",34),Ns(7,"a",35),mo(8),Fs(),Fs(),Ns(9,"span"),mo(10),Ua(11,"translate"),Fs(),Ns(12,"span",34),Ns(13,"a",35),mo(14),Fs(),Fs(),Ns(15,"span"),mo(16),Ua(17,"translate"),Fs(),Ns(18,"span",36),Ns(19,"a",35),Bs(20,"i",37),Fs(),Fs(),Fs(),Fs(),Fs()),2&t){const t=Xs(2);_n(4),vo("",Ea(5,5,"compViewBubble.lbl.show")," "),_n(4),fo(t.getMetric(t.metricX).name),_n(2),vo(" ",Ea(11,7,"compViewBubble.lbl.and")," "),_n(4),fo(t.getMetric(t.metricY).name),_n(2),vo(" ",Ea(17,9,"compViewBubble.lbl.planVsBase"),"")}}function fw(t,e){1&t&&qs(0)}function vw(t,e){1&t&&qs(0)}function bw(t,e){1&t&&qs(0)}const yw=function(t){return{level:t}};function Cw(t,e){if(1&t&&(Ns(0,"div",38),Ns(1,"h5",39),Ns(2,"strong",40),Gs(3,fw,1,0,"ng-container",41),Fs(),mo(4),Ua(5,"translate"),Fs(),Ns(6,"div",42),Ns(7,"div",43),Ns(8,"div",44),mo(9),Ua(10,"translate"),Fs(),Ns(11,"div",45),Ns(12,"strong",40),Gs(13,vw,1,0,"ng-container",41),Fs(),mo(14),Fs(),Fs(),Ns(15,"div",43),Ns(16,"div",46),Ua(17,"translate"),mo(18),Ua(19,"translate"),Ua(20,"translate"),Fs(),Ns(21,"div",45),Ns(22,"strong",40),Gs(23,bw,1,0,"ng-container",41),Fs(),mo(24),Ua(25,"number"),Fs(),Fs(),Ns(26,"div",43),Ns(27,"div",46),Ua(28,"translate"),mo(29),Ua(30,"translate"),Ua(31,"translate"),Fs(),Ns(32,"div",45),mo(33),Ua(34,"number"),Fs(),Fs(),Fs(),Fs()),2&t){const t=Xs(2),e=Ls(4);_n(3),js("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(40,yw,t.getLevel(t.estimateAtCompletion,t.budgetAtCompletion))),_n(1),vo(" ",Ea(5,18,"compViewBubble.metric.costName")," "),_n(5),vo(" ",Ea(10,20,"compViewBubble.lbl.nrProjects")," "),_n(4),js("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(42,yw,t.countKM<t.visbokeymetrics.length?2:1)),_n(1),bo(" ",t.countKM," / ",t.visbokeymetrics.length," "),_n(2),to("title",Ea(17,22,"keyMetrics.longEAC")),_n(2),bo(" ",Ea(19,24,"keyMetrics.shortEAC")," (",Ea(20,26,"keyMetrics.longEAC"),") "),_n(5),js("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(44,yw,t.getLevel(t.estimateAtCompletion,t.budgetAtCompletion))),_n(1),vo(" ",Oa(25,28,t.estimateAtCompletion,"1.0-0")," T\u20ac "),_n(3),to("title",Ea(28,31,"keyMetrics.longBAC")),_n(2),bo(" ",Ea(30,33,"keyMetrics.shortBAC")," (",Ea(31,35,"keyMetrics.longBAC"),") "),_n(4),vo(" ",Oa(34,37,t.budgetAtCompletion,"1.0-0")," T\u20ac ")}}function Vw(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-bubble-chart",47),Fs()),2&t){const t=Xs(3);_n(1),js("graphData",t.graphBubbleData)("graphOptions",t.graphBubbleOptions)("parentThis",t.parentThis)("language",t.currentLang)}}function ww(t,e){if(1&t&&(Ns(0,"div",26),Gs(1,Vw,2,4,"div",32),Fs()),2&t){const t=Xs(2);_n(1),js("ngIf",t.countKM>0&&t.graphBubbleData)}}function Aw(t,e){if(1&t){const t=zs();Ns(0,"th",58),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(12)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"compViewBubble.lbl.variant")))}function Pw(t,e){if(1&t){const t=zs();Ns(0,"th",59),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(3)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"compViewBubble.lbl.bac")))}function kw(t,e){if(1&t){const t=zs();Ns(0,"th",60),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(2)})),mo(1),Fs()}if(2&t){const t=Xs(3);_n(1),fo(t.getMetric("Cost").table)}}function Dw(t,e){if(1&t){const t=zs();Ns(0,"th",59),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(5)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"compViewBubble.lbl.endDate")))}function Mw(t,e){if(1&t){const t=zs();Ns(0,"th",60),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(4)})),mo(1),Fs()}if(2&t){const t=Xs(3);_n(1),fo(t.getMetric("EndDate").table)}}function Sw(t,e){if(1&t){const t=zs();Ns(0,"th",59),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(7)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"compViewBubble.lbl.deadlines")))}function Iw(t,e){if(1&t){const t=zs();Ns(0,"th",60),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(6)})),mo(1),Fs()}if(2&t){const t=Xs(3);_n(1),fo(t.getMetric("Deadline").table)}}function xw(t,e){if(1&t){const t=zs();Ns(0,"th",60),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(11)})),mo(1),Fs()}if(2&t){const t=Xs(3);_n(1),fo(t.getMetric("DeadlineUnFinishedDelay").table)}}function Tw(t,e){if(1&t){const t=zs();Ns(0,"th",60),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(10)})),mo(1),Fs()}if(2&t){const t=Xs(3);_n(1),fo(t.getMetric("DeadlineFinishedDelay").table)}}function _w(t,e){if(1&t){const t=zs();Ns(0,"th",59),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(9)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"compViewBubble.lbl.deliveries")))}function Uw(t,e){if(1&t){const t=zs();Ns(0,"th",60),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(8)})),mo(1),Fs()}if(2&t){const t=Xs(3);_n(1),fo(t.getMetric("Delivery").table)}}function Ew(t,e){if(1&t&&(Ns(0,"td",51),mo(1),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(t.variantName)}}function Ow(t,e){1&t&&qs(0)}function Gw(t,e){if(1&t&&(Ns(0,"td",68),mo(1),Ua(2,"number"),Fs()),2&t){const t=Xs().$implicit;_n(1),vo("",Oa(2,1,t.keyMetrics.costBaseLastTotal,"1.0-0")," k\u20ac")}}function Lw(t,e){1&t&&qs(0)}function Rw(t,e){if(1&t&&(Ns(0,"td",69),Ua(1,"number"),Gs(2,Lw,1,0,"ng-container",41),mo(3),Ua(4,"number"),Fs()),2&t){const t=Xs().$implicit,e=Xs(3),i=Ls(4);eo("title","",Oa(1,4,t.keyMetrics.costCurrentTotal,"1.0-0")," k\u20ac"),_n(2),js("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(10,yw,e.calcLevel(t.savingCostTotal,"percentOver"))),_n(1),vo(" ",Oa(4,7,100*t.savingCostTotal,"1.0-0")," % ")}}function jw(t,e){1&t&&Bs(0,"td",68)}function $w(t,e){1&t&&Bs(0,"td")}function Nw(t,e){if(1&t&&(Ns(0,"td",68),mo(1),Ua(2,"date"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.keyMetrics.endDateBaseLast,"dd.MM.yyyy"))}}function Fw(t,e){1&t&&qs(0)}function Bw(t,e){if(1&t&&(Ns(0,"td",69),Ua(1,"date"),Gs(2,Fw,1,0,"ng-container",41),mo(3),Ua(4,"number"),Fs()),2&t){const t=Xs().$implicit,e=Xs(3),i=Ls(4);to("title",Oa(1,4,t.keyMetrics.endDateCurrent,"dd.MM.yyyy")),_n(2),js("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(10,yw,e.calcLevel(t.savingEndDate,"delay"))),_n(1),vo(" ",Oa(4,7,t.savingEndDate,"1.0-0")," weeks ")}}function Hw(t,e){if(1&t&&(Ns(0,"td",68),mo(1),Ua(2,"date"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.endDate,"dd.MM.yyyy"))}}function Kw(t,e){1&t&&Bs(0,"td",70)}function qw(t,e){if(1&t&&(Ns(0,"td",68),mo(1),Ua(2,"number"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.keyMetrics.timeCompletionBaseLastActual,"1.0-0"))}}function zw(t,e){1&t&&qs(0)}function Qw(t,e){if(1&t&&(Ns(0,"td",69),Ua(1,"number"),Gs(2,zw,1,0,"ng-container",41),mo(3),Ua(4,"number"),Fs()),2&t){const t=Xs().$implicit,e=Xs(3),i=Ls(4);to("title",Oa(1,4,t.keyMetrics.timeCompletionCurrentActual,"1.0-0")),_n(2),js("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(10,yw,e.calcLevel(t.timeCompletionActual,"percentUnder"))),_n(1),vo(" ",Oa(4,7,100*t.timeCompletionActual,"1.0-0")," % ")}}function Ww(t,e){1&t&&Bs(0,"td",68)}function Jw(t,e){1&t&&Bs(0,"td",70)}function Yw(t,e){if(1&t&&(Ns(0,"td",70),mo(1),Ua(2,"number"),Ua(3,"translate"),Fs()),2&t){const t=Xs().$implicit;_n(1),bo("",Oa(2,2,t.keyMetrics.timeDelayUnFinished||0,"1.0-0")," ",Ea(3,5,"compViewBubble.lbl.days"),"")}}function Zw(t,e){if(1&t&&(Ns(0,"td",70),mo(1),Ua(2,"number"),Ua(3,"translate"),Fs()),2&t){const t=Xs().$implicit;_n(1),bo("",Oa(2,2,t.keyMetrics.timeDelayFinished||0,"1.0-0")," ",Ea(3,5,"compViewBubble.lbl.days"),"")}}function Xw(t,e){1&t&&Bs(0,"td",70)}function tA(t,e){1&t&&Bs(0,"td",70)}function eA(t,e){if(1&t&&(Ns(0,"td",68),mo(1),Ua(2,"number"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.keyMetrics.deliverableCompletionBaseLastActual,"1.0-0"))}}function iA(t,e){1&t&&qs(0)}function nA(t,e){if(1&t&&(Ns(0,"td",69),Ua(1,"number"),Gs(2,iA,1,0,"ng-container",41),mo(3),Ua(4,"number"),Fs()),2&t){const t=Xs().$implicit,e=Xs(3),i=Ls(4);to("title",Oa(1,4,t.keyMetrics.deliverableCompletionCurrentActual,"1.0-0")),_n(2),js("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(10,yw,e.calcLevel(t.deliveryCompletionActual,"percentUnder"))),_n(1),vo(" ",Oa(4,7,100*t.deliveryCompletionActual,"1.0-0")," % ")}}function rA(t,e){1&t&&Bs(0,"td",68)}function sA(t,e){1&t&&Bs(0,"td")}function oA(t,e){if(1&t){const t=zs();Ns(0,"tr",61),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(3).gotoClickedRow(i)})),Ns(1,"td",51),mo(2),Fs(),Ns(3,"td"),mo(4),Fs(),Gs(5,Ew,2,1,"td",62),Ns(6,"td",63),Ua(7,"date"),mo(8),Ua(9,"date"),Fs(),Ns(10,"td",64),Gs(11,Ow,1,0,"ng-container",41),Fs(),Gs(12,Gw,3,4,"td",65),Gs(13,Rw,5,12,"td",66),Gs(14,jw,1,0,"td",65),Gs(15,$w,1,0,"td",32),Gs(16,Nw,3,4,"td",65),Gs(17,Bw,5,12,"td",66),Gs(18,Hw,3,4,"td",65),Gs(19,Kw,1,0,"td",67),Gs(20,qw,3,4,"td",65),Gs(21,Qw,5,12,"td",66),Gs(22,Ww,1,0,"td",65),Gs(23,Jw,1,0,"td",67),Gs(24,Yw,4,7,"td",67),Gs(25,Zw,4,7,"td",67),Gs(26,Xw,1,0,"td",67),Gs(27,tA,1,0,"td",67),Gs(28,eA,3,4,"td",65),Gs(29,nA,5,12,"td",66),Gs(30,rA,1,0,"td",65),Gs(31,sA,1,0,"td",32),Fs()}if(2&t){const t=e.$implicit,i=e.index,n=Xs(3),r=Ls(6);_n(2),fo(i+1),_n(2),fo(t.name),_n(1),js("ngIf",n.hasVariant),_n(1),to("title",Oa(7,28,t.timestamp,"dd.MM.yy HH:MM")),_n(2),fo(Oa(9,31,t.timestamp,"dd.MM.yy")),_n(2),to("title",t.ampelErlaeuterung),_n(1),js("ngTemplateOutlet",r)("ngTemplateOutletContext",ka(34,yw,t.ampelStatus)),_n(1),js("ngIf",n.selectedMetric("Cost")&&t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("Cost")&&t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("Cost")&&!t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("Cost")&&!t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("EndDate")&&t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("EndDate")&&t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("EndDate")&&!t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("EndDate")&&!t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("Deadline")&&t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("Deadline")&&t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("Deadline")&&!t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("Deadline")&&!t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("DeadlineUnFinishedDelay")&&t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("DeadlineFinishedDelay")&&t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("DeadlineUnFinishedDelay")&&!t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("DeadlineFinishedDelay")&&!t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("Delivery")&&t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("Delivery")&&t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("Delivery")&&!t.keyMetrics),_n(1),js("ngIf",n.selectedMetric("Delivery")&&!t.keyMetrics)}}function aA(t,e){if(1&t){const t=zs();Ns(0,"div",48),Ns(1,"div",49),Ns(2,"table",50),Ns(3,"thead"),Ns(4,"tr"),Ns(5,"th",51),mo(6),Ua(7,"translate"),Fs(),Ns(8,"th",52),Js("click",(function(){return ei(t),Xs(2).sortKeyMetricsTable(1)})),mo(9),Ua(10,"translate"),Fs(),Gs(11,Aw,3,3,"th",53),Ns(12,"th",54),Js("click",(function(){return ei(t),Xs(2).sortKeyMetricsTable(13)})),mo(13),Ua(14,"translate"),Fs(),Ns(15,"th",52),Js("click",(function(){return ei(t),Xs(2).sortKeyMetricsTable(14)})),mo(16),Ua(17,"translate"),Fs(),Gs(18,Pw,3,3,"th",55),Gs(19,kw,2,1,"th",56),Gs(20,Dw,3,3,"th",55),Gs(21,Mw,2,1,"th",56),Gs(22,Sw,3,3,"th",55),Gs(23,Iw,2,1,"th",56),Gs(24,xw,2,1,"th",56),Gs(25,Tw,2,1,"th",56),Gs(26,_w,3,3,"th",55),Gs(27,Uw,2,1,"th",56),Fs(),Fs(),Ns(28,"tbody"),Gs(29,oA,32,36,"tr",57),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(6),fo(Ea(7,16,"compViewBubble.lbl.nr")),_n(3),fo(Ea(10,18,"compViewBubble.lbl.project")),_n(2),js("ngIf",t.hasVariant),_n(2),fo(Ea(14,20,"compViewBubble.lbl.timestamp")),_n(3),fo(Ea(17,22,"keyMetrics.lbl.trafficLight")),_n(2),js("ngIf",t.selectedMetric("Cost")),_n(1),js("ngIf",t.selectedMetric("Cost")),_n(1),js("ngIf",t.selectedMetric("EndDate")),_n(1),js("ngIf",t.selectedMetric("EndDate")),_n(1),js("ngIf",t.selectedMetric("Deadline")),_n(1),js("ngIf",t.selectedMetric("Deadline")),_n(1),js("ngIf",t.selectedMetric("DeadlineUnFinishedDelay")),_n(1),js("ngIf",t.selectedMetric("DeadlineFinishedDelay")),_n(1),js("ngIf",t.selectedMetric("Delivery")),_n(1),js("ngIf",t.selectedMetric("Delivery")),_n(2),js("ngForOf",t.visbokeymetrics)}}function lA(t,e){1&t&&(Ns(0,"div"),Ns(1,"h3",71),mo(2),Ua(3,"translate"),Fs(),Fs()),2&t&&(_n(2),vo(" ",Ea(3,1,"compViewBubble.msg.noVersions")," "))}function cA(t,e){if(1&t){const t=zs();Ns(0,"div",22),Js("resized",(function(e){return ei(t),Xs().onResized(e)})),Ns(1,"div",23),Ns(2,"div",24),Gs(3,mw,21,11,"div",25),Ns(4,"div",26),Ns(5,"div",27),Ns(6,"div",28),Ns(7,"span"),mo(8),Ua(9,"translate"),Fs(),Ns(10,"input",29),Js("keyup",(function(e){return ei(t),Xs().filterKeyBoardEvent(e)}))("ngModelChange",(function(e){return ei(t),Xs().filter=e})),Fs(),Fs(),Fs(),Fs(),Fs(),Gs(11,Cw,35,46,"div",30),Fs(),Ns(12,"div"),Gs(13,ww,2,1,"div",25),Gs(14,aA,30,24,"div",31),Fs(),Gs(15,lA,4,3,"div",32),Fs()}if(2&t){const t=Xs();_n(3),js("ngIf",t.metricListFiltered&&t.metricListFiltered.length>=2),_n(5),vo(" ",Ea(9,7,"compViewBubble.lbl.filter"),":"),_n(2),js("ngModel",t.filter),_n(1),js("ngIf",t.visbokeymetrics.length>0&&t.hasKMCost),_n(2),js("ngIf",t.chart),_n(1),js("ngIf",0==t.chart),_n(1),js("ngIf",0==t.visbokeymetrics.length)}}function dA(t,e){if(1&t&&(Ns(0,"div",43),Ns(1,"div",46),Ua(2,"translate"),mo(3),Ua(4,"translate"),Fs(),Ns(5,"div",45),mo(6),Fs(),Fs()),2&t){const t=e.label,i=e.title,n=e.value;_n(1),to("title",Ea(2,3,i)),_n(2),vo(" ",Ea(4,5,t)," "),_n(3),vo(" ",n," ")}}const uA=function(t,e,i){return{"fa-check-circle text-success":t,"fa-exclamation-triangle text-warning":e,"fa-exclamation-circle text-danger":i}};function hA(t,e){if(1&t&&Bs(0,"i",72),2&t){const t=e.level;js("ngClass",Ma(1,uA,1==t,2==t,3==t))}}const pA=function(t,e,i,n){return{"text-secondary":t,"text-success":e,"text-warning":i,"text-danger":n}};function gA(t,e){if(1&t&&Bs(0,"i",73),2&t){const t=e.level;js("ngClass",Sa(1,pA,0==t,1==t,2==t,3==t))}}function mA(t,e){if(1&t&&(Ns(0,"option",74),mo(1),Fs()),2&t){const t=e.$implicit;to("value",t.metric),_n(1),fo(t.name)}}function fA(t,e){if(1&t&&(Ns(0,"option",74),mo(1),Fs()),2&t){const t=e.$implicit;to("value",t.metric),_n(1),fo(t.name)}}let vA=(()=>{class t{constructor(t,e,i,n,r){this.messageService=t,this.alertService=e,this.route=i,this.router=n,this.translate=r,this.visbokeymetrics=[],this.colorMetric=[{name:"Critical",color:"red"},{name:"Warning",color:"yellow"},{name:"Good",color:"green"}],this.hasKMCost=!1,this.hasKMDelivery=!1,this.hasKMDeadline=!1,this.hasKMEndDate=!1,this.hasKMDeadlineDelay=!1,this.hasKMDeliveryDelay=!1,this.estimateAtCompletion=0,this.budgetAtCompletion=0,this.chart=!0,this.parentThis=this,this.graphBubbleData=[],this.graphBubbleOptions={width:"100%",vAxis:{baseline:0,minValue:20,maxValue:200,direction:-1,format:"",title:"Change in End Date (weeks)",baselineColor:"blue"},hAxis:{minValue:20,maxValue:200,baseline:1,direction:-1,format:"# '%'",title:"Total Cost",baselineColor:"blue"},sizeAxis:{minValue:20,maxValue:200},explorer:{actions:["dragToZoom","rightClickToReset"],maxZoomIn:.01},bubble:{textStyle:{auraColor:"none",fontSize:13}},tooltip:{showColorCode:!1},series:{Critical:{color:this.colorMetric[0].color},Warning:{color:this.colorMetric[1].color},Good:{color:this.colorMetric[2].color}}},this.sortColumn=6,this.permVC=Av,this.permVP=Pv}ngOnInit(){this.currentLang=this.translate.currentLang,this.log("Init KeyMetrics"),this.metricList=[{name:this.translate.instant("compViewBubble.metric.costName"),metric:"Cost",axis:this.translate.instant("compViewBubble.metric.costAxis"),bubble:this.translate.instant("compViewBubble.metric.costBubble"),table:this.translate.instant("compViewBubble.metric.costTable")},{name:this.translate.instant("compViewBubble.metric.endDateName"),metric:"EndDate",axis:this.translate.instant("compViewBubble.metric.endDateAxis"),bubble:this.translate.instant("compViewBubble.metric.endDateBubble"),table:this.translate.instant("compViewBubble.metric.endDateTable")},{name:this.translate.instant("compViewBubble.metric.costActualName"),metric:"ActualCost",axis:this.translate.instant("compViewBubble.metric.costActualAxis"),bubble:this.translate.instant("compViewBubble.metric.costActualBubble"),table:this.translate.instant("compViewBubble.metric.costActualTable")},{name:this.translate.instant("compViewBubble.metric.deadlineName"),metric:"Deadline",axis:this.translate.instant("compViewBubble.metric.deadlineAxis"),bubble:this.translate.instant("compViewBubble.metric.deadlineBubble"),table:this.translate.instant("compViewBubble.metric.deadlineTable")},{name:this.translate.instant("compViewBubble.metric.deadlineFinishedDelayName"),metric:"DeadlineFinishedDelay",axis:this.translate.instant("compViewBubble.metric.deadlineFinishedDelayAxis"),bubble:this.translate.instant("compViewBubble.metric.deadlineFinishedDelayBubble"),table:this.translate.instant("compViewBubble.metric.deadlineFinishedDelayTable")},{name:this.translate.instant("compViewBubble.metric.deadlineUnFinishedDelayName"),metric:"DeadlineUnFinishedDelay",axis:this.translate.instant("compViewBubble.metric.deadlineUnFinishedDelayAxis"),bubble:this.translate.instant("compViewBubble.metric.deadlineUnFinishedDelayBubble"),table:this.translate.instant("compViewBubble.metric.deadlineUnFinishedDelayTable")},{name:this.translate.instant("compViewBubble.metric.deliveryName"),metric:"Delivery",axis:this.translate.instant("compViewBubble.metric.deliveryAxis"),bubble:this.translate.instant("compViewBubble.metric.deliveryBubble"),table:this.translate.instant("compViewBubble.metric.deliveryTable")},{name:this.translate.instant("compViewBubble.metric.deliveryFinishedDelayName"),metric:"DeliveryFinishedDelay",axis:this.translate.instant("compViewBubble.metric.deliveryFinishedDelayAxis"),bubble:this.translate.instant("compViewBubble.metric.deliveryFinishedDelayBubble"),table:this.translate.instant("compViewBubble.metric.deliveryFinishedDelayTable")},{name:this.translate.instant("compViewBubble.metric.deliveryUnFinishedDelayName"),metric:"DeliveryUnFinishedDelay",axis:this.translate.instant("compViewBubble.metric.deliveryUnFinishedDelayAxis"),bubble:this.translate.instant("compViewBubble.metric.deliveryUnFinishedDelayBubble"),table:this.translate.instant("compViewBubble.metric.deliveryUnFinishedDelayTable")}],this.initSetting(),this.chart!=this.bubbleMode&&this.toggleVisboChart(),this.visboKeyMetricsCalc()}ngOnChanges(t){this.log(`Delivery on Changes  ${this.activeID}, Changes: ${JSON.stringify(t)}`),this.metricList&&(this.initSetting(),this.visboKeyMetricsCalc())}onResized(t){t||this.log("No event in Resize"),this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(()=>{this.visboKeyMetricsCalc(),this.timeoutID=void 0},500)}initSetting(){this.activeID=this.route.snapshot.paramMap.get("id");const t=this.route.snapshot.queryParams.refDate,e=this.route.snapshot.queryParams.filter||void 0,i=this.route.snapshot.queryParams.metricX||void 0;let n=this.route.snapshot.queryParams.metricY||void 0;i===n&&(n=void 0),this.metricX=this.getMetric(i,n,!1).metric,this.metricY=this.getMetric(n,this.metricX,!1).metric,this.refDate=t?new Date(t):new Date,this.filter=e}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}filterKeyBoardEvent(t){t||this.log("No Keyboard Event"),this.updateUrlParam("filter",this.filter),this.visboKeyMetricsCalc()}updateUrlParam(t,e){const i=this.route.snapshot.url.join("/");void 0===e&&(e=null);const n=new bV;"filter"==t?n.filter=e:"metricX"!=t&&"metricY"!=t||(n.metricX=this.metricX,n.metricY=this.metricY),this.router.navigate([i],{queryParams:n,replaceUrl:!0,queryParamsHandling:"merge"})}visboKeyMetricsCalc(){if(this.visbokeymetrics=[],this.countKM=0,this.budgetAtCompletion=0,this.estimateAtCompletion=0,this.hasKMCost=!1,this.hasKMDelivery=!1,this.hasKMDeadline=!1,this.hasKMDeadlineDelay=!1,this.hasKMDeliveryDelay=!1,this.hasKMEndDate=!1,this.hasVariant=!1,!this.visboprojectversions)return;const t=(this.filter||"").toLowerCase();for(let e=0;e<this.visboprojectversions.length;e++)if(!t||this.visboprojectversions[e].name.toLowerCase().indexOf(t)>=0||(this.visboprojectversions[e].VorlagenName||"").toLowerCase().indexOf(t)>=0||(this.visboprojectversions[e].businessUnit||"").toLowerCase().indexOf(t)>=0||(this.visboprojectversions[e].leadPerson||"").toLowerCase().indexOf(t)>=0||(this.visboprojectversions[e].description||"").toLowerCase().indexOf(t)>=0){const t=new yV;if(t.name=this.visboprojectversions[e].name,t.variantName=this.visboprojectversions[e].variantName,t.ampelStatus=this.visboprojectversions[e].ampelStatus,t.ampelErlaeuterung=this.visboprojectversions[e].ampelErlaeuterung,t._id=this.visboprojectversions[e]._id,t.vpid=this.visboprojectversions[e].vpid,t.timestamp=this.visboprojectversions[e].timestamp,this.visboprojectversions[e].keyMetrics){this.countKM+=1,t.keyMetrics=this.visboprojectversions[e].keyMetrics,this.hasKMCost=this.hasKMCost||t.keyMetrics.costBaseLastTotal>=0,this.hasKMDelivery=this.hasKMDelivery||t.keyMetrics.deliverableCompletionBaseLastTotal>0,this.hasKMDeadline=this.hasKMDeadline||t.keyMetrics.timeCompletionBaseLastTotal>0,this.hasKMDeadlineDelay=this.hasKMDeadlineDelay||null!=t.keyMetrics.timeDelayFinished||null!=t.keyMetrics.timeDelayUnFinished,this.hasKMDeliveryDelay=this.hasKMDeliveryDelay||null!=t.keyMetrics.deliverableDelayFinished||null!=t.keyMetrics.deliverableDelayUnFinished,this.hasKMEndDate=this.hasKMEndDate||t.keyMetrics.endDateBaseLast.toString().length>0,this.budgetAtCompletion+=t.keyMetrics.costBaseLastTotal||0,this.estimateAtCompletion+=t.keyMetrics.costCurrentTotal||0,t.savingCostTotal=t.keyMetrics.costBaseLastTotal>0?(t.keyMetrics.costCurrentTotal||0)/t.keyMetrics.costBaseLastTotal:1,t.savingCostActual=t.keyMetrics.costBaseLastActual>0?(t.keyMetrics.costCurrentActual||0)/t.keyMetrics.costBaseLastActual:1,t.keyMetrics.endDateCurrent&&t.keyMetrics.endDateBaseLast?(t.savingEndDate=this.helperDateDiff(new Date(t.keyMetrics.endDateCurrent).toISOString(),new Date(t.keyMetrics.endDateBaseLast).toISOString(),"d")||0,t.savingEndDate=Math.round(t.savingEndDate/7*10)/10):t.savingEndDate=0;const i=t.keyMetrics;t.timeCompletionTotal=this.calcPercent(i.timeCompletionCurrentTotal,t.keyMetrics.timeCompletionBaseLastTotal),t.timeCompletionActual=this.calcPercent(i.timeCompletionCurrentActual,t.keyMetrics.timeCompletionBaseLastActual),t.deliveryCompletionTotal=this.calcPercent(i.deliverableCompletionCurrentTotal,i.deliverableCompletionBaseLastTotal),t.deliveryCompletionActual=this.calcPercent(i.deliverableCompletionCurrentActual,i.deliverableCompletionBaseLastActual)}this.visbokeymetrics.push(t),this.visboprojectversions[e].variantName&&(this.hasVariant=!0)}this.sortKeyMetricsTable(void 0),this.thinDownMetricList(),this.visboKeyMetricsCalcBubble()}thinDownMetricList(){if(!this.metricListFiltered){if(this.metricListFiltered=[],this.hasKMCost){let t=this.metricList.find(t=>"Cost"===t.metric);this.metricListFiltered.push(t),t=this.metricList.find(t=>"ActualCost"===t.metric),this.metricListFiltered.push(t)}if(this.hasKMEndDate){const t=this.metricList.find(t=>"EndDate"===t.metric);this.metricListFiltered.push(t)}if(this.hasKMDelivery){const t=this.metricList.find(t=>"Delivery"===t.metric);this.metricListFiltered.push(t)}if(this.hasKMDeadline){const t=this.metricList.find(t=>"Deadline"===t.metric);this.metricListFiltered.push(t)}if(this.hasKMDeadlineDelay){let t=this.metricList&&this.metricList.find(t=>"DeadlineFinishedDelay"===t.metric);this.metricListFiltered.push(t),t=this.metricList&&this.metricList.find(t=>"DeadlineUnFinishedDelay"===t.metric),this.metricListFiltered.push(t)}if(this.hasKMDeliveryDelay){let t=this.metricList&&this.metricList.find(t=>"DeliveryFinishedDelay"===t.metric);this.metricListFiltered.push(t),t=this.metricList&&this.metricList.find(t=>"DeliveryUnFinishedDelay"===t.metric),this.metricListFiltered.push(t)}this.metricListFiltered.length<2&&(this.chart=!1),this.metricListSorted=[],this.metricListFiltered.forEach(t=>this.metricListSorted.push(t)),this.metricListSorted.sort((function(t,e){return xh(t.name,e.name)})),this.metricX=this.getMetric(this.metricX,this.metricY,!0).metric,this.metricY=this.getMetric(this.metricY,this.metricX,!0).metric}}getMetric(t,e,i=!1){const n=i?this.metricListFiltered:this.metricList;if(!n)return this.metricList[0];let r=n.find(i=>i.metric===t&&i.metric!==e);return r||(r=n.find(t=>t.metric!==e)),r||(r=n[0]),r}calcPercent(t,e){return void 0===e?void 0:0===e?1:(t||0)/e}toggleVisboChart(){this.chart=!this.chart}changeChart(){this.log(`Switch Chart to ${this.metricX} vs  ${this.metricY}`),this.metricY=this.getMetric(this.metricY,this.metricX,!1).metric,this.updateUrlParam("metricX",void 0),this.visboKeyMetricsCalc()}calcLevel(t,e){let i=0;return"percentOver"==e?i=t<=1?1:t>1.05?3:2:"percentUnder"==e?i=t>=1?1:t<.8?3:2:"delay"==e&&(i=t<=0?1:t>4?3:2),i}visboKeyMetricsCalcBubble(){this.graphBubbleAxis();const t=[];if(this.visbokeymetrics){this.visbokeymetrics.length>10&&(this.graphBubbleOptions.bubble.textStyle.fontSize=1),t.push(["ID",this.getMetric(this.metricX).bubble,this.getMetric(this.metricY).bubble,"Key Metrics Status","Total Cost (Base Line) in k\u20ac"]);for(let e=0;e<this.visbokeymetrics.length;e++){if(!this.visbokeymetrics[e].keyMetrics)continue;let i,n,r=0;switch(this.metricX){case"Cost":i=Math.round(100*this.visbokeymetrics[e].savingCostTotal),r+=i<=100?1:0;break;case"ActualCost":i=Math.round(100*this.visbokeymetrics[e].savingCostActual),r+=i<=100?1:0;break;case"EndDate":i=Math.round(this.visbokeymetrics[e].savingEndDate/7*10)/10,r+=i<=0?1:0;break;case"Deadline":i=Math.round(100*this.visbokeymetrics[e].timeCompletionActual),r+=i>=100?1:0;break;case"DeadlineFinishedDelay":i=Math.round((this.visbokeymetrics[e].keyMetrics.timeDelayFinished||0)/7*10)/10,r+=i<=0?1:0;break;case"DeadlineUnFinishedDelay":i=Math.round((this.visbokeymetrics[e].keyMetrics.timeDelayUnFinished||0)/7*10)/10,r+=i<=0?1:0;break;case"Delivery":i=Math.round(100*this.visbokeymetrics[e].deliveryCompletionActual),r+=i>=100?1:0}switch(this.metricY){case"Cost":n=Math.round(100*this.visbokeymetrics[e].savingCostTotal),r+=n<=100?1:0;break;case"ActualCost":n=Math.round(100*this.visbokeymetrics[e].savingCostActual),r+=n<=100?1:0;break;case"EndDate":n=Math.round(this.visbokeymetrics[e].savingEndDate/7*10)/10,r+=n<=0?1:0;break;case"Deadline":n=Math.round(100*this.visbokeymetrics[e].timeCompletionActual),r+=n>=100?1:0;break;case"DeadlineFinishedDelay":n=Math.round((this.visbokeymetrics[e].keyMetrics.timeDelayFinished||0)/7*10)/10,r+=n<=0?1:0;break;case"DeadlineUnFinishedDelay":n=Math.round((this.visbokeymetrics[e].keyMetrics.timeDelayUnFinished||0)/7*10)/10,r+=n<=0?1:0;break;case"Delivery":n=Math.round(100*this.visbokeymetrics[e].deliveryCompletionActual),r+=n>=100?1:0}t.push([this.combineName(this.visbokeymetrics[e].name,this.visbokeymetrics[e].variantName),i,n,this.colorMetric[r].name,Math.round(this.visbokeymetrics[e].keyMetrics.costBaseLastTotal||1)])}this.calcRangeAxis(),this.graphBubbleData=t}}calcRangeAxis(){let t=0,e=1/0,i=0;for(let n=0;n<this.visbokeymetrics.length;n++)if(this.visbokeymetrics[n].keyMetrics)switch(e=Math.min(e,this.visbokeymetrics[n].keyMetrics.costBaseLastTotal),i=Math.max(i,this.visbokeymetrics[n].keyMetrics.costBaseLastTotal),this.metricX){case"Cost":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].savingCostTotal-1)));break;case"ActualCost":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].savingCostActual-1)));break;case"EndDate":t=Math.max(t,Math.abs(this.visbokeymetrics[n].savingEndDate)/7);break;case"Deadline":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].timeCompletionActual-1)));break;case"DeadlineFinishedDelay":t=Math.max(t,Math.abs((this.visbokeymetrics[n].keyMetrics.timeDelayFinished||0)/7));break;case"DeadlineUnFinishedDelay":t=Math.max(t,Math.abs((this.visbokeymetrics[n].keyMetrics.timeDelayUnFinished||0)/7));break;case"Delivery":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].deliveryCompletionActual-1)))}e*=.8,i*=1.2,this.graphBubbleOptions.sizeAxis.minValue=e,this.graphBubbleOptions.sizeAxis.maxValue=i,"EndDate"===this.metricX||"DeadlineFinishedDelay"===this.metricX||"DeadlineUnFinishedDelay"===this.metricX?(t*=1.1,this.graphBubbleOptions.hAxis.minValue=-t,this.graphBubbleOptions.hAxis.maxValue=t):(t*=1.1,this.graphBubbleOptions.hAxis.minValue=100-t,this.graphBubbleOptions.hAxis.maxValue=100+t),t=0;for(let n=0;n<this.visbokeymetrics.length;n++)if(this.visbokeymetrics[n].keyMetrics)switch(this.metricY){case"Cost":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].savingCostTotal-1)));break;case"ActualCost":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].savingCostActual-1)));break;case"EndDate":t=Math.max(t,Math.abs(this.visbokeymetrics[n].savingEndDate)/7);break;case"Deadline":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].timeCompletionActual-1)));break;case"DeadlineFinishedDelay":t=Math.max(t,Math.abs((this.visbokeymetrics[n].keyMetrics.timeDelayFinished||0)/7));break;case"DeadlineUnFinishedDelay":t=Math.max(t,Math.abs((this.visbokeymetrics[n].keyMetrics.timeDelayUnFinished||0)/7));break;case"Delivery":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].deliveryCompletionActual-1)))}"EndDate"===this.metricY||"DeadlineFinishedDelay"===this.metricY||"DeadlineUnFinishedDelay"===this.metricY?(t*=1.1,this.graphBubbleOptions.vAxis.minValue=-t,this.graphBubbleOptions.vAxis.maxValue=t):(t*=1.1,this.graphBubbleOptions.vAxis.minValue=100-t,this.graphBubbleOptions.vAxis.maxValue=100+t)}graphBubbleAxis(){if(!this.chart)return;const t="# "+this.translate.instant("compViewBubble.lbl.weeks");switch(this.graphBubbleOptions.hAxis.title=this.getMetric(this.metricX).axis,this.metricX){case"Cost":case"ActualCost":this.graphBubbleOptions.hAxis.baseline=100,this.graphBubbleOptions.hAxis.direction=-1,this.graphBubbleOptions.hAxis.format="# '%'";break;case"EndDate":this.graphBubbleOptions.hAxis.baseline=0,this.graphBubbleOptions.hAxis.direction=-1,this.graphBubbleOptions.hAxis.format=t;break;case"Deadline":this.graphBubbleOptions.hAxis.baseline=100,this.graphBubbleOptions.hAxis.direction=1,this.graphBubbleOptions.hAxis.format="# '%'";break;case"DeadlineFinishedDelay":case"DeadlineUnFinishedDelay":this.graphBubbleOptions.hAxis.baseline=0,this.graphBubbleOptions.hAxis.direction=-1,this.graphBubbleOptions.hAxis.format=t;break;case"Delivery":this.graphBubbleOptions.hAxis.baseline=100,this.graphBubbleOptions.hAxis.direction=1,this.graphBubbleOptions.hAxis.format="# '%'"}switch(this.graphBubbleOptions.vAxis.title=this.getMetric(this.metricY).axis,this.metricY){case"Cost":case"ActualCost":this.graphBubbleOptions.vAxis.baseline=100,this.graphBubbleOptions.vAxis.direction=-1,this.graphBubbleOptions.vAxis.format="# '%'";break;case"EndDate":this.graphBubbleOptions.vAxis.baseline=0,this.graphBubbleOptions.vAxis.direction=-1,this.graphBubbleOptions.vAxis.format=t;break;case"Deadline":this.graphBubbleOptions.vAxis.baseline=100,this.graphBubbleOptions.vAxis.direction=1,this.graphBubbleOptions.vAxis.format="# '%'";break;case"DeadlineFinishedDelay":case"DeadlineUnFinishedDelay":this.graphBubbleOptions.vAxis.baseline=0,this.graphBubbleOptions.vAxis.direction=-1,this.graphBubbleOptions.vAxis.format=t;break;case"Delivery":this.graphBubbleOptions.vAxis.baseline=100,this.graphBubbleOptions.vAxis.direction=1,this.graphBubbleOptions.vAxis.format="# '%'"}}gotoClickedRow(t){this.log(`goto VP ${t.name} (${t.vpid}) Deleted? ${this.deleted}`);const e=new gb;this.deleted&&(e.deleted="1"),t.variantName&&(e.variantName=t.variantName),this.refDate&&!Eh(this.refDate)&&(e.refDate=this.refDate.toISOString()),this.router.navigate(["vpKeyMetrics/".concat(t.vpid)],{queryParams:e})}chartSelectRow(t,e){this.log(`Bubble Chart: ${t} ${e} ${this.visbokeymetrics[t].name}`);let i=this.visbokeymetrics.find(t=>t.name===e);if(!i){const t=e.lastIndexOf(" ( ");if(t){const n=e.substr(0,t);i=this.visbokeymetrics.find(t=>t.name===n)}}i?this.gotoClickedRow(i):this.log("VP not found "+e)}selectedMetric(t){let e=!1;return this.metricX!==t&&this.metricY!==t||(e=!0),e}getLevel(t,e){let i=1;return e&&(i=t/e),i<=1?1:i<=1.05?2:3}combineName(t,e){let i=t||"";return e&&(i=i.concat(" ( ",e," ) ")),i}helperDateDiff(t,e,i){const n=new Date(t),r=new Date(e);let s=n.getTime()-r.getTime();return"w"===i?s=s/1e3/60/60/24/7:"d"===i?s=s/1e3/60/60/24:s/=1e3,s}sortKeyMetricsTable(t){this.visbokeymetrics&&(void 0!==t?(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t:!this.sortAscending):(this.sortColumn=1,this.sortAscending=!0),1===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return xh(t.name,e.name)})):2===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.savingCostTotal-e.savingCostTotal})):3===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.keyMetrics.costBaseLastTotal-e.keyMetrics.costBaseLastTotal})):4===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.savingEndDate-e.savingEndDate})):5===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return Th(t.keyMetrics.endDateBaseLast,e.keyMetrics.endDateBaseLast)})):6===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.timeCompletionActual-e.timeCompletionActual})):7===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.keyMetrics.timeCompletionBaseLastActual-e.keyMetrics.timeCompletionBaseLastActual})):8===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.deliveryCompletionActual-e.deliveryCompletionActual})):9===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.keyMetrics.deliverableCompletionBaseLastActual-e.keyMetrics.deliverableCompletionBaseLastActual})):10===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return(t.keyMetrics.timeDelayFinished||0)-(e.keyMetrics.timeDelayFinished||0)})):11===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return(t.keyMetrics.timeDelayUnFinished||0)-(e.keyMetrics.timeDelayUnFinished||0)})):12===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return xh(t.variantName,e.variantName)})):13===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return Th(t.timestamp,e.timestamp)})):14===this.sortColumn&&this.visbokeymetrics.sort((function(t,e){return(t.ampelStatus||0)-(e.ampelStatus||0)})),this.sortAscending||this.visbokeymetrics.reverse())}log(t){this.messageService.add("CompViewKeyMetrics: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(Df),Rs(Fg),Rs(rf),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-comp-viewbubble"]],inputs:{visboprojectversions:"visboprojectversions",bubbleMode:"bubbleMode",combinedPerm:"combinedPerm"},features:[_e],decls:36,vars:17,consts:[["class","well",3,"resized",4,"ngIf"],["cardRow",""],["indicator",""],["trafficLight",""],["id","VpfMetricSelector","tabindex","-1","role","dialog","aria-labelledby","VpfMetricSelectorTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VpfMetricSelectorTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],["novalidate",""],["f","ngForm"],[1,"form-group"],["for","XLabel",1,"col-form-label"],["id","XLabel","name","metricX",1,"form-control",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","YLabel",1,"col-form-label"],["id","YLabel","name","metricY",1,"form-control",3,"ngModel","ngModelChange"],[1,"modal-footer","align-items-end"],["type","submit","data-dismiss","modal",1,"btn","btn-primary",3,"click"],[1,"well",3,"resized"],[1,"row","row-cols-1","row-cols-lg-2"],[1,"col","col-sm-12","col-lg-8"],["class","container-fluid",4,"ngIf"],[1,"container-fluid"],[1,"row","text-dark"],[1,"my-1","pl-0","col-11"],["type","text","placeholder","Filter",1,"ml-2",3,"ngModel","keyup","ngModelChange"],["class","col-sm-12 col-md-10 col-lg-4 card align-right px-0",4,"ngIf"],["class","mt-3 container-fluid",4,"ngIf"],[4,"ngIf"],[1,"row","text-dark","hidden-print"],[1,"font-weight-bold"],["data-toggle","modal","data-target","#VpfMetricSelector"],[1,"ml-2"],["aria-hidden","true",1,"fa","fa-cog"],[1,"col-sm-12","col-md-10","col-lg-4","card","align-right","px-0"],[1,"card-header","p-2"],[1,"mr-1"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"card-body","p-2"],[1,"row"],[1,"col","col-sm-8"],[1,"col","col-sm-4","text-right"],[1,"col","col-sm-8",3,"title"],[3,"graphData","graphOptions","parentThis","language"],[1,"mt-3","container-fluid"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[1,"d-none","d-lg-table-cell"],[3,"click"],["class","d-none d-lg-table-cell",3,"click",4,"ngIf"],[1,"d-none","d-xl-table-cell",3,"click"],["class","text-right d-none d-md-table-cell",3,"click",4,"ngIf"],["class","text-right",3,"click",4,"ngIf"],["data-toggle","modal","data-target","#ProjectDetail",3,"click",4,"ngFor","ngForOf"],[1,"d-none","d-lg-table-cell",3,"click"],[1,"text-right","d-none","d-md-table-cell",3,"click"],[1,"text-right",3,"click"],["data-toggle","modal","data-target","#ProjectDetail",3,"click"],["class","d-none d-lg-table-cell",4,"ngIf"],[1,"d-none","d-xl-table-cell",3,"title"],[3,"title"],["class","text-right d-none d-md-table-cell",4,"ngIf"],["class","text-right",3,"title",4,"ngIf"],["class","text-right",4,"ngIf"],[1,"text-right","d-none","d-md-table-cell"],[1,"text-right",3,"title"],[1,"text-right"],[1,"d-flex","justify-content-center"],[1,"fa",3,"ngClass"],[1,"fas","fa-lightbulb",3,"ngClass"],[3,"value"]],template:function(t,e){1&t&&(Gs(0,cA,16,9,"div",0),Gs(1,dA,7,7,"ng-template",null,1,ja),Gs(3,hA,1,5,"ng-template",null,2,ja),Gs(5,gA,1,6,"ng-template",null,3,ja),Ns(7,"div",4),Ns(8,"div",5),Ns(9,"div",6),Ns(10,"div",7),Ns(11,"h5",8),mo(12),Ua(13,"translate"),Fs(),Ns(14,"button",9),Js("click",(function(){return e.changeChart()})),Ns(15,"span",10),mo(16,"\xd7"),Fs(),Fs(),Fs(),Ns(17,"div",11),Ns(18,"form",12,13),Ns(20,"div",14),Ns(21,"label",15),mo(22),Ua(23,"translate"),Fs(),Ns(24,"select",16),Js("ngModelChange",(function(t){return e.metricX=t})),Gs(25,mA,2,2,"option",17),Fs(),Fs(),Ns(26,"div",14),Ns(27,"label",18),mo(28),Ua(29,"translate"),Fs(),Ns(30,"select",19),Js("ngModelChange",(function(t){return e.metricY=t})),Gs(31,fA,2,2,"option",17),Fs(),Fs(),Ns(32,"div",20),Ns(33,"button",21),Js("click",(function(){return e.changeChart()})),mo(34),Ua(35,"translate"),Fs(),Fs(),Fs(),Fs(),Fs(),Fs(),Fs()),2&t&&(js("ngIf",e.visbokeymetrics),_n(12),fo(Ea(13,9,"compViewBubble.titleChange")),_n(10),vo("",Ea(23,11,"compViewBubble.lbl.xAxis"),":"),_n(2),js("ngModel",e.metricX),_n(1),js("ngForOf",e.metricListSorted),_n(3),vo("",Ea(29,13,"compViewBubble.lbl.yAxis"),":"),_n(2),js("ngModel",e.metricY),_n(1),js("ngForOf",e.metricListSorted),_n(3),fo(Ea(35,15,"compViewBubble.btn.change")))},directives:[jc,Ou,Fd,Tu,cu,Nd,Eu,Lc,MV,Od,Bc,gw,Oc,du,gu],pipes:[av,zc,qc],encapsulation:2}),t})(),bA=(()=>{class t{constructor(t){this.gChartService=t}ngOnInit(){this.language||(this.language="de"),this.gLib=this.gChartService.getGoogle(),this.gLib.charts.load("current",{packages:["timeline"],language:this.language}),this.gLib.charts.setOnLoadCallback(this.drawChart.bind(this))}ngOnChanges(){this.initialised&&this.drawChart()}drawChart(){const t=new this.gLib.visualization.Timeline(document.getElementById("divTimelineChart")),e=new this.gLib.visualization.arrayToDataTable(this.graphData),i=this.parentThis;this.gLib.visualization.events.addListener(t,"select",(function(){const e=t.getSelection();if(e&&0!==e.length){const t=e[0];if(void 0===i)console.log("Chart Timeline: The user clicked and this is undefined");else if(t){const e=t.row;e>=0&&i.timelineSelectRow(e)}}else console.log("Chart Timeline: chartGetSelection is undefined",e||e.length)})),t.draw(e,this.graphOptions||{title:"Timeline Chart",height:400}),this.initialised=!0}}return t.\u0275fac=function(e){return new(e||t)(Rs(xV))},t.\u0275cmp=le({type:t,selectors:[["app-timeline-chart"]],inputs:{graphData:"graphData",language:"language",graphOptions:"graphOptions",parentThis:"parentThis"},features:[_e],decls:1,vars:0,consts:[["id","divTimelineChart"]],template:function(t,e){1&t&&Bs(0,"div",0)},styles:["#divTimelineChart[_ngcontent-%COMP%]{width:100%}"]}),t})();function yA(t,e){if(1&t){const t=zs();Ns(0,"div",3),Ns(1,"div",4),Ns(2,"div",5),Ns(3,"span"),mo(4),Ua(5,"translate"),Fs(),Ns(6,"span"),mo(7),Ua(8,"translate"),Fs(),Ns(9,"input",6),Js("keyup",(function(e){return ei(t),Xs().filterKeyBoardEvent(e)}))("ngModelChange",(function(e){return ei(t),Xs().filter=e})),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs();_n(4),vo("",Ea(5,3,"compViewBoard.lbl.timeline"),", "),_n(3),vo(" ",Ea(8,5,"compViewBoard.lbl.filter"),":"),_n(2),js("ngModel",t.filter)}}function CA(t,e){if(1&t&&(Ns(0,"div",7),Bs(1,"app-timeline-chart",8),Fs()),2&t){const t=Xs();_n(1),js("graphData",t.graphDataTimeline)("graphOptions",t.graphOptionsTimeline)("parentThis",t.parentThis)("language",t.currentLang)}}function VA(t,e){1&t&&(Ns(0,"h5",7),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),vo(" ",Ea(2,1,"compViewBoard.msg.errorNoMatchingProjects")," "))}let wA=(()=>{class t{constructor(t,e,i,n,r){this.messageService=t,this.alertService=e,this.route=i,this.router=n,this.translate=r,this.parentThis=this,this.graphDataTimeline=[],this.graphOptionsTimeline={width:"100%",height:500,timeline:{showBarLabels:!0},tooltip:{isHtml:!0},animation:{startup:!0,duration:200}}}ngOnInit(){this.currentLang=this.translate.currentLang,this.log(`ProjectBoard Init  ${this.refDate.toISOString()} `),this.initSetting(),this.visboViewBoardOverTime()}ngOnChanges(t){var e;this.log(`ProjectBoard Changes  ${null===(e=this.refDate)||void 0===e?void 0:e.toISOString()}, Changes ${JSON.stringify(t)}`),this.initSetting(),this.visboViewBoardOverTime()}onResized(t){t||this.log("No event in Resize"),this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(()=>{this.visboViewBoardOverTime(),this.timeoutID=void 0},500)}initSetting(){this.activeID=this.route.snapshot.paramMap.get("id");const t=this.route.snapshot.queryParams.refDate,e=this.route.snapshot.queryParams.filter||void 0;this.refDate=t?new Date(t):new Date,this.filter=e}filterKeyBoardEvent(t){t||this.log("No Keyboard Event"),this.updateUrlParam("filter",this.filter),this.visboViewBoardOverTime()}updateUrlParam(t,e){const i=this.route.snapshot.url.join("/");void 0===e&&(e=null);const n=new bV;"filter"==t&&(n.filter=e),this.router.navigate([i],{queryParams:n,replaceUrl:!0,queryParamsHandling:"merge"})}visboViewBoardOverTime(){var t,e,i;const n=[];if(!this.vps||0===this.vps.length)return void(this.graphDataTimeline=[]);this.vps.sort((function(t,e){return xh(e.name.toLowerCase(),t.name.toLowerCase())}));const r=this.filter?this.filter.toLowerCase():void 0;for(let l=0;l<this.vps.length;l++){if(r&&!(this.vps[l].name.toLowerCase().indexOf(r)>=0||(null===(t=this.vps[l].businessUnit)||void 0===t?void 0:t.toLowerCase().indexOf(r))>=0||(null===(e=this.vps[l].leadPerson)||void 0===e?void 0:e.toLowerCase().indexOf(r))>=0||(null===(i=this.vps[l].VorlagenName)||void 0===i?void 0:i.toLowerCase().indexOf(r))>=0))continue;const s=this.vps[l].startDate,o=this.vps[l].endDate;s&&o&&s<=o&&n.push([(this.vps.length-l).toString(),this.combineName(this.vps[l].name,this.vps[l].variantName),this.createCustomHTMLContent(this.vps[l]),new Date(this.vps[l].startDate),new Date(this.vps[l].endDate)])}this.graphOptionsTimeline.height=50+41*n.length;const s=this.translate.instant("compViewBoard.lbl.project"),o=this.translate.instant("compViewBoard.lbl.startDate"),a=this.translate.instant("compViewBoard.lbl.endDate");n.push(["ID",s,{type:"string",role:"tooltip",p:{html:!0}},o,a]),n.reverse(),this.graphDataTimeline=n}createCustomHTMLContent(t){const e=_h(new Date(t.startDate),"fullDate",this.currentLang),i=_h(new Date(t.endDate),"fullDate",this.currentLang);let n='<div style="padding:5px 5px 5px 5px;"><div><b>'+this.combineName(t.name,t.variantName)+"</b></div><div><table>";const r=this.translate.instant("compViewBoard.lbl.bu"),s=this.translate.instant("compViewBoard.lbl.lead"),o=this.translate.instant("compViewBoard.lbl.template"),a=this.translate.instant("compViewBoard.lbl.startDate"),l=this.translate.instant("compViewBoard.lbl.endDate");return t.businessUnit&&(n=n+"<tr><td>"+r+":</td><td><b>"+t.businessUnit+"</b></td></tr>"),t.leadPerson&&(n=n+"<tr><td>"+s+":</td><td><b>"+t.leadPerson+"</b></td></tr>"),t.VorlagenName&&(n=n+"<tr><td>"+o+":</td><td><b>"+t.VorlagenName+"</b></td></tr>"),n=n+"<tr><td>"+a+":</td><td><b>"+e+"</b></td></tr>",n=n+"<tr><td>"+l+":</td><td><b>"+i+"</b></td></tr>",n+="</table></div></div>",n}timelineSelectRow(t){this.log(`timeline Select Row ${t} ${JSON.stringify(this.graphDataTimeline[t+1])} `);const e=this.graphDataTimeline[t+1][1],i=this.findProject(e);if(i){this.log(`Navigate to: ${i.vpid} ${i.name} ${i.variantName}`);const t=new gb;t.variantName=i.variantName||null,this.refDate&&!Eh(this.refDate)&&(t.refDate=this.refDate.toISOString()),this.router.navigate(["vpKeyMetrics/".concat(i.vpid)],{queryParams:t})}else this.log("VP not found: "+e)}getvps(){return JSON.stringify(this.vps)}combineName(t,e){let i=t||"";return e&&(i=i.concat(" ( ",e," ) ")),i}findProject(t){let e=this.vps.find(e=>e.name===t);if(!e&&t.lastIndexOf(" ) ")===t.length-3){const i=t.lastIndexOf(" ( "),n=t.substring(0,i),r=t.substring(i+3,t.length-3);e=this.vps.find(t=>t.name===n&&t.variantName===r)}return e}log(t){this.messageService.add("CompVisboViewBoard: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(Df),Rs(Fg),Rs(rf),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-comp-viewboard"]],inputs:{vps:"vps"},features:[_e],decls:4,vars:3,consts:[[1,"well",3,"resized"],["class","container-fluid",4,"ngIf"],["class","mt-2",4,"ngIf"],[1,"container-fluid"],[1,"row","text-dark"],[1,"my-1","pl-0","col-11"],["type","text","placeholder","Filter",1,"ml-2",3,"ngModel","keyup","ngModelChange"],[1,"mt-2"],[3,"graphData","graphOptions","parentThis","language"]],template:function(t,e){1&t&&(Ns(0,"div",0),Js("resized",(function(t){return e.onResized(t)})),Gs(1,yA,10,7,"div",1),Gs(2,CA,2,4,"div",2),Gs(3,VA,3,3,"h5",2),Fs()),2&t&&(_n(1),js("ngIf",e.graphDataTimeline.length>0),_n(1),js("ngIf",e.graphDataTimeline.length>1),_n(1),js("ngIf",1==e.graphDataTimeline.length))},directives:[MV,jc,Od,Nd,Eu,bA],pipes:[av],encapsulation:2}),t})();function AA(t,e){1&t&&(Ns(0,"h2",28),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),vo(" ",Ea(2,1,"vp.title")," "))}function PA(t,e){if(1&t){const t=zs();Ns(0,"h2",28),mo(1),Ua(2,"translate"),Ns(3,"a",29),Js("click",(function(){ei(t);const e=Xs(2);return e.gotoVCDetail(e.vcActive)})),mo(4),Fs(),Fs()}if(2&t){const t=Xs(2);_n(1),vo(" ",Ea(2,2,"vp.titleVC"),": "),_n(3),fo(t.vcActive.name)}}function kA(t,e){if(1&t){const t=zs();Ns(0,"i",32),Js("click",(function(){return ei(t),Xs(3).toggleVisboChart()})),Fs()}}function DA(t,e){if(1&t){const t=zs();Ns(0,"i",33),Js("click",(function(){return ei(t),Xs(3).toggleVisboChart()})),Fs()}}function MA(t,e){if(1&t&&(Ns(0,"div"),Gs(1,kA,1,0,"i",30),Gs(2,DA,1,0,"i",31),Fs()),2&t){const t=Xs(2);_n(1),js("ngIf",!t.chart),_n(1),js("ngIf",t.chart)}}function SA(t,e){if(1&t){const t=zs();Ns(0,"button",36),Js("click",(function(){return ei(t),Xs(3).toggleVisboProjects()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vp.btn.showDeleted")))}function IA(t,e){if(1&t){const t=zs();Ns(0,"button",37),Js("click",(function(){return ei(t),Xs(3).toggleVisboProjects()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vp.btn.showExisting")))}function xA(t,e){if(1&t&&(Ns(0,"div"),Gs(1,SA,3,3,"button",34),Gs(2,IA,3,3,"button",35),Fs()),2&t){const t=Xs(2);_n(1),js("ngIf",!t.deleted),_n(1),js("ngIf",t.deleted)}}function TA(t,e){1&t&&(Ns(0,"div"),Ns(1,"button",38),mo(2),Ua(3,"translate"),Fs(),Fs()),2&t&&(_n(2),fo(Ea(3,1,"vp.btn.create")))}function _A(t,e){if(1&t){const t=zs();Ns(0,"button",42),Js("click",(function(){return ei(t),Xs(3).changeView("Capacity")})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vp.btn.viewCapacity")))}function UA(t,e){if(1&t){const t=zs();Ns(0,"div",39),Ns(1,"button",40),Js("click",(function(){return ei(t),Xs(2).changeView("KeyMetric")})),mo(2),Ua(3,"translate"),Fs(),Ns(4,"button",40),Js("click",(function(){return ei(t),Xs(2).changeView("List")})),mo(5),Ua(6,"translate"),Fs(),Gs(7,_A,3,3,"button",41),Ns(8,"button",40),Js("click",(function(){return ei(t),Xs(2).changeView("ProjectBoard")})),mo(9),Ua(10,"translate"),Fs(),Fs()}if(2&t){const t=Xs(2);_n(2),fo(Ea(3,4,"vp.btn.viewKeyMetrics")),_n(3),fo(Ea(6,6,"vp.btn.viewList")),_n(2),js("ngIf",t.hasVCPerm(t.permVC.ViewAudit+t.permVC.Modify)&&t.hasOrga),_n(2),fo(Ea(10,8,"vp.btn.viewProjectBoard"))}}function EA(t,e){if(1&t&&(Ns(0,"td",63),mo(1),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(t.vc.name)}}function OA(t,e){1&t&&Bs(0,"td",63)}function GA(t,e){if(1&t){const t=zs();Ns(0,"tr",29),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(4).gotoClickedRow(i)})),Ns(1,"td",46),mo(2),Fs(),Ns(3,"td",55),Ns(4,"a"),mo(5),Fs(),Fs(),Ns(6,"td",56),mo(7),Fs(),Ns(8,"td",57),mo(9),Ua(10,"date"),Fs(),Ns(11,"td",58),mo(12),Ua(13,"date"),Fs(),Ns(14,"td",59),mo(15),Fs(),Gs(16,EA,2,1,"td",60),Gs(17,OA,1,0,"td",60),Ns(18,"td",61),Ns(19,"button",62),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(4).gotoDetail(i)})),mo(20,"i"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit,i=e.index,n=Xs(4);_n(2),fo(i+1),_n(3),fo(t.name),_n(2),fo(n.getVPType(t.vpType)),_n(2),fo(Oa(10,8,t.updatedAt,"dd.MM.yyyy HH:mm")),_n(3),fo(Oa(13,11,t.updatedAt,"dd.MM.yy")),_n(3),fo(t.vpfCount||t.vpvCount),_n(1),js("ngIf",t.vc),_n(1),js("ngIf",!t.vc)}}function LA(t,e){if(1&t&&(Ns(0,"tbody",53),Gs(1,GA,21,14,"tr",54),Fs()),2&t){const t=Xs(3);_n(1),js("ngForOf",t.visboprojects)}}function RA(t,e){1&t&&(Ns(0,"div"),Ns(1,"h3",64),mo(2),Ua(3,"translate"),Fs(),Fs()),2&t&&(_n(2),vo(" ",Ea(3,1,"vp.msg.noVP")," "))}function jA(t,e){if(1&t){const t=zs();Ns(0,"div",43),Ns(1,"table",44),Ns(2,"thead",45),Ns(3,"tr"),Ns(4,"th",46),mo(5),Ua(6,"translate"),Fs(),Ns(7,"th",47),Js("click",(function(){return ei(t),Xs(2).sortVPTable(1)})),mo(8),Ua(9,"translate"),Fs(),Ns(10,"th",48),Js("click",(function(){return ei(t),Xs(2).sortVPTable(5)})),mo(11),Ua(12,"translate"),Fs(),Ns(13,"th",49),Js("click",(function(){return ei(t),Xs(2).sortVPTable(2)})),mo(14),Ua(15,"translate"),Fs(),Ns(16,"th",50),Js("click",(function(){return ei(t),Xs(2).sortVPTable(4)})),mo(17),Ua(18,"translate"),Fs(),Ns(19,"th",51),Js("click",(function(){return ei(t),Xs(2).sortVPTable(3)})),mo(20),Ua(21,"translate"),Fs(),Ns(22,"th"),mo(23,"Info"),Fs(),Fs(),Fs(),Gs(24,LA,2,1,"tbody",52),Fs(),Gs(25,RA,4,3,"div",24),Fs()}if(2&t){const t=Xs(2);_n(5),fo(Ea(6,8,"vp.lbl.nr")),_n(3),fo(Ea(9,10,"vp.lbl.name")),_n(3),fo(Ea(12,12,"vp.lbl.type")),_n(3),fo(Ea(15,14,"vp.lbl.modified")),_n(3),fo(Ea(18,16,"vp.lbl.versions")),_n(3),fo(Ea(21,18,"vp.lbl.vc")),_n(4),js("ngIf",t.visboprojects.length>0),_n(1),js("ngIf",0==t.visboprojects.length)}}function $A(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-comp-viewcapacity",65),Fs()),2&t){const t=Xs(3);_n(1),js("vcActive",t.vcActive)("combinedPerm",t.combinedPerm)}}function NA(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-comp-viewbubble",66),Fs()),2&t){const t=Xs(3);_n(1),js("bubbleMode",!0)("visboprojectversions",t.visboprojectversions)("combinedPerm",t.combinedPerm)}}function FA(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-comp-viewbubble",66),Fs()),2&t){const t=Xs(3);_n(1),js("bubbleMode",!1)("visboprojectversions",t.visboprojectversions)("combinedPerm",t.combinedPerm)}}function BA(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-comp-viewboard",67),Fs()),2&t){const t=Xs(3);_n(1),js("vps",t.visboprojectversions)}}function HA(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"hr"),Gs(2,$A,2,2,"div",24),Gs(3,NA,2,3,"div",24),Gs(4,FA,2,3,"div",24),Gs(5,BA,2,1,"div",24),Fs()),2&t){const t=Xs(2);_n(2),js("ngIf","Capacity"==t.currentView&&t.vcActive),_n(1),js("ngIf","KeyMetrics"==t.currentView&&t.visboprojectversions&&t.vcActive),_n(1),js("ngIf","List"==t.currentView&&t.visboprojectversions),_n(1),js("ngIf","ProjectBoard"==t.currentView&&t.visboprojectversions)}}function KA(t,e){if(1&t&&(Ns(0,"div",19),Ns(1,"div",20),Ns(2,"div",21),Gs(3,AA,3,3,"h2",22),Gs(4,PA,5,4,"h2",22),Fs(),Ns(5,"div",23),Gs(6,MA,3,2,"div",24),Gs(7,xA,3,2,"div",24),Gs(8,TA,4,3,"div",24),Fs(),Bs(9,"div",25),Gs(10,UA,11,10,"div",26),Fs(),Gs(11,jA,26,20,"div",27),Gs(12,HA,6,4,"div",24),Fs()),2&t){const t=Xs();_n(3),js("ngIf",!t.vcActive),_n(1),js("ngIf",t.vcActive),_n(2),js("ngIf",t.vcActive&&t.visboprojects.length>0),_n(1),js("ngIf",t.hasVPPerm(t.permVP.DeleteVP)),_n(1),js("ngIf",t.vcActive&&t.hasVCPerm(t.permVC.CreateVP)),_n(2),js("ngIf",t.chart),_n(1),js("ngIf",!t.chart),_n(1),js("ngIf",t.chart)}}let qA=(()=>{class t{constructor(t,e,i,n,r,s,o,a,l,c){this.messageService=t,this.alertService=e,this.visbocenterService=i,this.visbosettingService=n,this.visboprojectService=r,this.visboprojectversionService=s,this.route=o,this.router=a,this.translate=l,this.titleService=c,this.vpvRefDate=new Date,this.hasOrga=!1,this.chart=!1,this.modalChart=!0,this.deleted=!1,this.combinedPerm=void 0,this.permVC=Av,this.permVP=Pv}ngOnInit(){this.currentLang=this.translate.currentLang,this.titleService.setTitle(this.translate.instant("vp.title")),this.log("Init GetVisboProjects "+JSON.stringify(this.route.snapshot.queryParams)),this.deleted=!!this.route.snapshot.queryParams.deleted;const t=this.route.snapshot.queryParams.view;t&&(this.chart=!0),this.currentView=t||"KeyMetrics",this.log(`Init VP View: ${this.currentView} Deleted: ${this.deleted}`),this.getVisboProjects(this.deleted)}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}hasVCPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vc&t)>0}getVPType(t){return this.translate.instant("vp.type.vpType"+t)}changeView(t,e){this.currentView="Capacity"===t||"KeyMetrics"===t||"ProjectBoard"===t||"List"===t?t:"KeyMetrics",this.updateUrlParam("view",this.currentView),e&&this.updateUrlParam("filter",e.trim())}toggleVisboChart(){this.chart=!this.chart,this.chart&&!this.visboprojectversions&&this.getVisboProjectKeyMetrics()}updateUrlParam(t,e){const i=this.route.snapshot.url.join("/");void 0===e&&(e=null);const n=new bV;"filter"==t?n.filter=e:"refDate"==t?n.refDate=e:"view"==t&&(n.view=e),this.router.navigate([i],{queryParams:n,replaceUrl:!0,queryParamsHandling:"merge"})}toggleVisboProjects(){this.chart=!1,this.deleted=!this.deleted;const t=this.route.snapshot.url.join("/");this.log(`VP toggleVisboProjects ${this.deleted} URL ${t}`),this.getVisboProjects(this.deleted),this.router.navigate([t],this.deleted?{queryParams:{deleted:this.deleted}}:{})}getVisboProjects(t){const e=this.route.snapshot.paramMap.get("id");this.vcSelected=e,e?this.visbocenterService.getVisboCenter(e).subscribe(i=>{this.vcActive=i,this.combinedPerm=i.perm,this.titleService.setTitle(this.translate.instant("vp.titleName",{name:this.vcActive.name})),this.getVisboCenterOrga(),this.visboprojectService.getVisboProjects(e,!1,t).subscribe(t=>{this.visboprojects=t,this.sortVPTable(1),this.chart&&this.getVisboProjectKeyMetrics()},t=>{this.log(`get VPs failed: error:  ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})},t=>{this.log(`get VC failed: error:  ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))}):(this.vcSelected=null,this.vcActive=null,this.visboprojectService.getVisboProjects(null,!1,t).subscribe(t=>{this.visboprojects=t,this.sortVPTable(1)},t=>{this.log(`get VPs all failed: error:  ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))}))}addproject(t,e,i){t=t.trim(),this.log(`call create VP ${t} with VCID ${e} Desc ${i} `),t&&this.visboprojectService.addVisboProject({name:t,description:i,vcid:e}).subscribe(t=>{this.visboprojects.push(t),this.sortVPTable(void 0);const e=this.translate.instant("vp.msg.createSuccess",{name:t.name});this.alertService.success(e)},e=>{if(this.log(`add VP failed: error: ${e.status} messages: ${e.error.message}`),403===e.status){const e=this.translate.instant("vp.msg.errorPerm",{name:t});this.alertService.error(e)}else if(409===e.status){const e=this.translate.instant("vp.msg.errorConflict",{name:t});this.alertService.error(e)}else this.alertService.error(Lh(e))})}getVisboProjectKeyMetrics(){this.log(`get VC keyMetrics ${this.vcActive.name} ${this.vcActive._id}`),this.visboprojectversionService.getVisboCenterProjectVersions(this.vcActive._id,this.vpvRefDate).subscribe(t=>{this.visboprojectversions=t,this.calcVPVList(),this.log(`get VC Key metrics: Get ${t.length} Project Versions`),0===this.visboprojectversions.length&&(this.chart=!1)},t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vp.msg.errorPermVC");this.alertService.error(t)}else this.alertService.error(Lh(t))})}calcVPVList(){var t,e;if(null===(t=this.visboprojectversions)||void 0===t?void 0:t.length){this.vpvWithKM=0;for(let t=0;t<this.visboprojectversions.length;t++){const i=this.visboprojectversions[t];i.endDate=(null===(e=i.keyMetrics)||void 0===e?void 0:e.endDateCurrent)||i.endDate,this.vpvWithKM+=this.visboprojectversions[t].keyMetrics?1:0}}}getVisboCenterOrga(){this.vcActive&&(this.log("get VC Orga "+this.vcActive._id),this.visbosettingService.getVCOrganisations(this.vcActive._id,!1,void 0,!0).subscribe(t=>{this.hasOrga=t.length>0},t=>{if(403===t.status){const t=this.translate.instant("vp.msg.errorPermVC");this.alertService.error(t)}else this.alertService.error(Lh(t))}))}gotoClickedRow(t){const e=!!t.deletedAt;1===t.vpType?(this.log(`goto VPF for VP ${t._id} Deleted ${e}`),this.router.navigate(["vpf/".concat(t._id)],e?{queryParams:{deleted:e}}:{})):(this.log(`goto VPV for VP ${t._id} Deleted ${e}`),this.router.navigate(["vpKeyMetrics/".concat(t._id)],e?{queryParams:{deleted:e}}:{}))}gotoDetail(t){const e=!!t.deletedAt;this.log("goto Detail for VP "+t._id),this.router.navigate(["vpDetail/".concat(t._id)],e?{queryParams:{deleted:e}}:{})}gotoVCDetail(t){this.router.navigate(["vcDetail/".concat(t._id)])}sortVPTable(t){if(void 0!==t){if(!this.visboprojects)return;t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t||3===t:!this.sortAscending}1===this.sortColumn?this.visboprojects.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortColumn?this.visboprojects.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})):3===this.sortColumn?this.visboprojects.sort((function(t,e){return xh(t.vc.name.toLowerCase(),e.vc.name.toLowerCase())})):4===this.sortColumn?this.visboprojects.sort((function(t,e){return t.vpvCount-e.vpvCount})):5===this.sortColumn&&this.visboprojects.sort((function(t,e){return t.vpType-e.vpType})),this.sortAscending||this.visboprojects.reverse()}log(t){this.messageService.add("VisboProject: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(Df),Rs(xv),Rs(Ib),Rs(fb),Rs(wV),Rs(Fg),Rs(rf),Rs(ov),Rs(Md))},t.\u0275cmp=le({type:t,selectors:[["app-visboprojects"]],decls:33,vars:16,consts:[["class","well",4,"ngIf"],["id","VpModalCreate","tabindex","-1","role","dialog","aria-labelledby","VpModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VpModalCenterTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group"],["for","vpName",1,"col-form-label"],["id","CreateVPName","type","text",1,"form-control"],["vpName",""],[1,"col-form-label"],["id","CreateVPDesc",1,"form-control"],["vpDescription",""],[1,"modal-footer","align-items-end"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-secondary"],["id","CreateVPConfirm","type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"],[1,"well"],[1,"row"],[1,"col"],["class","panel-heading ml-0",4,"ngIf"],[1,"btn-group"],[4,"ngIf"],[1,"container-fluid"],["class","btn-toolbar",4,"ngIf"],["class","panel-body",4,"ngIf"],[1,"panel-heading","ml-0"],[3,"click"],["class","mt-3 fa fa-signal","aria-hidden","true",3,"click",4,"ngIf"],["class","mt-3 fa fa-list","aria-hidden","true",3,"click",4,"ngIf"],["aria-hidden","true",1,"mt-3","fa","fa-signal",3,"click"],["aria-hidden","true",1,"mt-3","fa","fa-list",3,"click"],["id","DeletedVP","type","button","class","m-2 btn btn-secondary",3,"click",4,"ngIf"],["id","UnDeletedVP","type","button","class","m-2 btn btn-secondary",3,"click",4,"ngIf"],["id","DeletedVP","type","button",1,"m-2","btn","btn-secondary",3,"click"],["id","UnDeletedVP","type","button",1,"m-2","btn","btn-secondary",3,"click"],["id","CreateVP","type","button","data-toggle","modal","data-target","#VpModalCreate",1,"m-2","btn","btn-primary"],[1,"btn-toolbar"],["type","button",1,"ml-2","btn","btn-md","btn-light",3,"click"],["type","button","class","btn btn-md btn-light ml-2",3,"click",4,"ngIf"],["type","button",1,"btn","btn-md","btn-light","ml-2",3,"click"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],["id","VPHead"],[1,"d-none","d-md-table-cell"],["id","SortName",3,"click"],["id","SortType",1,"d-none","d-md-table-cell",3,"click"],["id","SortDate",1,"d-none","d-md-table-cell",3,"click"],["id","SortVersions",1,"d-none","d-md-table-cell",3,"click"],["id","SortVC",1,"d-none","d-lg-table-cell",3,"click"],["id","VPList",4,"ngIf"],["id","VPList"],[3,"click",4,"ngFor","ngForOf"],["id","ColName"],["id","ColType",1,"d-none","d-md-table-cell"],["id","ColDate",1,"d-none","d-lg-table-cell"],["id","ColDate",1,"d-none","d-md-table-cell","d-lg-none"],["id","ColVersions",1,"d-none","d-md-table-cell"],["id","ColVC","class","d-none d-lg-table-cell",4,"ngIf"],["id","ColDetail"],["title","Detail of Visbo Project",1,"Detail",3,"click"],["id","ColVC",1,"d-none","d-lg-table-cell"],[1,"d-flex","justify-content-center"],[3,"vcActive","combinedPerm"],[3,"bubbleMode","visboprojectversions","combinedPerm"],[3,"vps"]],template:function(t,e){if(1&t){const t=zs();Bs(0,"app-usernavbar"),Gs(1,KA,13,8,"div",0),Ns(2,"div",1),Ns(3,"div",2),Ns(4,"div",3),Ns(5,"div",4),Ns(6,"h5",5),mo(7),Ua(8,"translate"),Fs(),Ns(9,"button",6),Ns(10,"span",7),mo(11,"\xd7"),Fs(),Fs(),Fs(),Ns(12,"div",8),Ns(13,"form"),Ns(14,"div",9),Ns(15,"label",10),mo(16),Ua(17,"translate"),Fs(),Bs(18,"input",11,12),Fs(),Ns(20,"div",9),Ns(21,"label",13),mo(22),Ua(23,"translate"),Fs(),Bs(24,"textarea",14,15),Fs(),Fs(),Fs(),Ns(26,"div",16),Ns(27,"button",17),mo(28),Ua(29,"translate"),Fs(),Ns(30,"button",18),Js("click",(function(){ei(t);const i=Ls(19),n=Ls(25);return e.addproject(i.value,e.vcActive._id,n.value),i.value="",n.value=""})),mo(31),Ua(32,"translate"),Fs(),Fs(),Fs(),Fs(),Fs()}2&t&&(_n(1),js("ngIf",e.visboprojects),_n(6),fo(Ea(8,6,"vp.titleCreate")),_n(9),vo("",Ea(17,8,"vp.lbl.name"),":"),_n(6),vo("",Ea(23,10,"vp.lbl.description"),":"),_n(6),fo(Ea(29,12,"vp.btn.cancel")),_n(3),vo(" ",Ea(32,14,"vp.btn.save")," "))},directives:[bb,jc,Ou,Fd,Tu,Lc,pw,vA,wA],pipes:[av,qc],encapsulation:2}),t})();function zA(t,e){if(1&t){const t=zs();Ns(0,"a",1),Js("click",(function(){ei(t);const e=Xs(2);return e.gotoVCDetail(e.visboproject)})),mo(1),Fs()}if(2&t){const t=Xs(2);_n(1),fo(t.visboproject.vc.name)}}function QA(t,e){if(1&t&&(Ns(0,"span"),mo(1),Fs()),2&t){const t=Xs(2);_n(1),fo(t.visboproject.vc.name)}}function WA(t,e){if(1&t){const t=zs();Ns(0,"input",73),Js("ngModelChange",(function(e){return ei(t),Xs(2).visboproject.name=e})),Fs()}2&t&&js("ngModel",Xs(2).visboproject.name)}function JA(t,e){if(1&t&&(Ns(0,"label",74),mo(1),Fs()),2&t){const t=Xs(2);_n(1),vo("",t.visboproject.name," ")}}function YA(t,e){if(1&t){const t=zs();Ns(0,"textarea",78),Js("ngModelChange",(function(e){return ei(t),Xs(3).visboproject.description=e})),Fs()}2&t&&js("ngModel",Xs(3).visboproject.description)}function ZA(t,e){if(1&t&&(Ns(0,"label",79),mo(1),Fs()),2&t){const t=Xs(3);_n(1),vo("",t.visboproject.description," ")}}function XA(t,e){if(1&t&&(Ns(0,"div",3),Ns(1,"label",75),mo(2),Ua(3,"translate"),Fs(),Gs(4,YA,1,1,"textarea",76),Gs(5,ZA,2,1,"label",77),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,3,"vpDetail.lbl.description"),":"),_n(2),js("ngIf",t.hasVPPerm(t.permVP.Modify)),_n(1),js("ngIf",!t.hasVPPerm(t.permVP.Modify))}}function tP(t,e){if(1&t){const t=zs();Ns(0,"div",3),Ns(1,"label",80),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",81),Ns(5,"a",1),Js("click",(function(){ei(t);const e=Xs(2);return e.gotoVPView(e.visboproject)})),mo(6),Ua(7,"translate"),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(2),vo("",Ea(3,4,"vpDetail.lbl.versions"),":"),_n(4),yo("",t.visboproject.vpvCount," ",Ea(7,6,"vpDetail.lbl.ofTotal")," ",t.getVPVersionsTotal(),"")}}function eP(t,e){if(1&t){const t=zs();Ns(0,"button",90),Js("click",(function(){ei(t);const e=Xs(3);return e.gotoVPAudit(e.visboproject)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpDetail.btn.viewAudit")))}function iP(t,e){if(1&t){const t=zs();Ns(0,"button",91),Js("click",(function(){return ei(t),Xs(3).toggleView("Group")})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpDetail.btn.viewGroups")))}function nP(t,e){if(1&t){const t=zs();Ns(0,"button",92),Js("click",(function(){return ei(t),Xs(3).toggleView("User")})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpDetail.btn.viewUsers")))}function rP(t,e){if(1&t){const t=zs();Ns(0,"button",93),Js("click",(function(){ei(t);const e=Xs(3);return e.gotoVPRestriction(e.visboproject)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpDetail.btn.viewRestriction")))}function sP(t,e){if(1&t){const t=zs();Ns(0,"button",94),Js("click",(function(){return ei(t),Xs(3).toggleView("Variant")})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpDetail.btn.viewVariant")))}function oP(t,e){if(1&t){const t=zs();Ns(0,"button",95),Js("click",(function(){return ei(t),Xs(3).toggleView("Lock")})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpDetail.btn.viewLock")))}function aP(t,e){1&t&&(Ns(0,"div",97),Ns(1,"button",105),mo(2),Ua(3,"translate"),Fs(),Fs()),2&t&&(_n(2),vo(" ",Ea(3,1,"vpDetail.btn.addUser")," "))}function lP(t,e){1&t&&(Ns(0,"th"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.lbl.delete")))}function cP(t,e){if(1&t){const t=zs();Ns(0,"td"),Ns(1,"button",108),Js("click",(function(){ei(t);const e=Xs().index;return Xs(4).helperRemoveUser(e)})),Ua(2,"translate"),mo(3,"\xd7"),Fs(),Fs()}2&t&&(_n(1),to("title",Ea(2,1,"vpDetail.lbl.deleteUser")))}function dP(t,e){1&t&&Bs(0,"td")}function uP(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td"),mo(2),Fs(),Ns(3,"td",106),Js("click",(function(){ei(t);const i=e.index;return Xs(4).calcCombinedPerm(i)})),Ns(4,"a"),mo(5),Fs(),Fs(),Ns(6,"td",107),Js("click",(function(){return ei(t),Xs(4).toggleView("Group")})),Ns(7,"a"),mo(8),Fs(),Fs(),Ns(9,"td",103),mo(10),Fs(),Gs(11,cP,4,3,"td",0),Gs(12,dP,1,0,"td",0),Fs()}if(2&t){const t=e.$implicit,i=e.index,n=Xs(4);_n(2),fo(i+1),_n(3),fo(t.email),_n(3),fo(t.groupName),_n(2),fo("VP"==t.groupType?"":"Global"),_n(1),js("ngIf",!n.deleted&&n.hasVPPerm(n.permVP.ManagePerm)&&"VP"==t.groupType),_n(1),js("ngIf",!(!n.deleted&&n.hasVPPerm(n.permVP.ManagePerm)&&"VP"==t.groupType))}}function hP(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div"),Ns(2,"div",96),Ns(3,"div",97),Ns(4,"h5",98),mo(5),Ua(6,"translate"),Fs(),Fs(),Gs(7,aP,4,3,"div",99),Fs(),Ns(8,"div",100),Ns(9,"table",101),Ns(10,"thead",102),Ns(11,"tr"),Ns(12,"th"),mo(13),Ua(14,"translate"),Fs(),Ns(15,"th",1),Js("click",(function(){return ei(t),Xs(3).sortUserTable(1)})),mo(16),Ua(17,"translate"),Fs(),Ns(18,"th",1),Js("click",(function(){return ei(t),Xs(3).sortUserTable(2)})),mo(19),Ua(20,"translate"),Fs(),Ns(21,"th",103),mo(22),Ua(23,"translate"),Fs(),Gs(24,lP,3,3,"th",0),Fs(),Fs(),Ns(25,"tbody",104),Gs(26,uP,13,6,"tr",37),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(3);_n(5),vo(" ",Ea(6,8,"vpDetail.titleUsers")," "),_n(2),js("ngIf",t.hasVPPerm(t.permVP.ManagePerm)),_n(6),fo(Ea(14,10,"vpDetail.lbl.nr")),_n(3),fo(Ea(17,12,"vpDetail.lbl.email")),_n(3),fo(Ea(20,14,"vpDetail.lbl.group")),_n(3),fo(Ea(23,16,"vpDetail.lbl.type")),_n(2),js("ngIf",!t.deleted&&t.hasVPPerm(t.permVP.ManagePerm)),_n(2),js("ngForOf",t.vgUsers)}}function pP(t,e){if(1&t){const t=zs();Ns(0,"div",97),Ns(1,"button",111),Js("click",(function(){return ei(t),Xs(4).initGroup(null)})),mo(2),Ua(3,"translate"),Fs(),Fs()}2&t&&(_n(2),vo(" ",Ea(3,1,"vpDetail.btn.addGroup")," "))}function gP(t,e){1&t&&(Ns(0,"th"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.lbl.delete")))}function mP(t,e){1&t&&(Ns(0,"td",116),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.lbl.global")))}function fP(t,e){1&t&&Bs(0,"td",116)}function vP(t,e){if(1&t){const t=zs();Ns(0,"td"),Ns(1,"button",117),Js("click",(function(){ei(t);const e=Xs().index;return Xs(4).helperRemoveGroup(e)})),Ua(2,"translate"),mo(3,"\xd7"),Fs(),Fs()}2&t&&(_n(1),to("title",Ea(2,1,"vpDetail.msg.removeGroup")))}function bP(t,e){1&t&&Bs(0,"td")}function yP(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td"),mo(2),Fs(),Ns(3,"td",112),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(4).initGroup(i)})),Ns(4,"a"),mo(5),Fs(),Fs(),Ns(6,"td",113),Js("click",(function(){return ei(t),Xs(4).toggleView("User")})),Ns(7,"a"),mo(8),Fs(),Fs(),Gs(9,mP,3,3,"td",114),Gs(10,fP,1,0,"td",114),Gs(11,vP,4,3,"td",0),Gs(12,bP,1,0,"td",0),Ns(13,"td"),Ns(14,"button",115),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(4).initGroup(i)})),Ua(15,"translate"),mo(16,"i"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit,i=e.index,n=Xs(4);_n(2),fo(i+1),_n(3),fo(t.name),_n(3),fo(t.users.length),_n(1),js("ngIf",t.global),_n(1),js("ngIf",!t.global),_n(1),js("ngIf",!n.deleted&&n.hasVPPerm(n.permVP.ManagePerm)&&"VP"==t.groupType),_n(1),js("ngIf",!(!n.deleted&&n.hasVPPerm(n.permVP.ManagePerm)&&"VP"==t.groupType)),_n(2),to("title",Ea(15,8,"vpDetail.msg.detailGroup"))}}function CP(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div"),Ns(2,"div",96),Ns(3,"div",97),Ns(4,"h5",98),mo(5),Ua(6,"translate"),Fs(),Fs(),Gs(7,pP,4,3,"div",99),Fs(),Ns(8,"div",100),Ns(9,"table",101),Ns(10,"thead",109),Ns(11,"tr"),Ns(12,"th"),mo(13),Ua(14,"translate"),Fs(),Ns(15,"th",1),Js("click",(function(){return ei(t),Xs(3).sortGroupTable(1)})),mo(16),Ua(17,"translate"),Fs(),Ns(18,"th",1),Js("click",(function(){return ei(t),Xs(3).sortGroupTable(2)})),mo(19),Ua(20,"translate"),Fs(),Ns(21,"th",103),mo(22),Ua(23,"translate"),Fs(),Gs(24,gP,3,3,"th",0),Ns(25,"th"),mo(26),Ua(27,"translate"),Fs(),Fs(),Fs(),Ns(28,"tbody",110),Gs(29,yP,17,10,"tr",37),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(3);_n(5),vo(" ",Ea(6,9,"vpDetail.titleGroups")," "),_n(2),js("ngIf",t.hasVPPerm(t.permVP.ManagePerm)),_n(6),fo(Ea(14,11,"vpDetail.lbl.nr")),_n(3),fo(Ea(17,13,"vpDetail.lbl.group")),_n(3),fo(Ea(20,15,"vpDetail.lbl.members")),_n(3),fo(Ea(23,17,"vpDetail.lbl.type")),_n(2),js("ngIf",!t.deleted&&t.hasVPPerm(t.permVP.ManagePerm)),_n(2),fo(Ea(27,19,"vpDetail.lbl.info")),_n(3),js("ngForOf",t.vgGroups)}}function VP(t,e){1&t&&(Ns(0,"div",97),Ns(1,"button",121),mo(2),Ua(3,"translate"),Fs(),Fs()),2&t&&(_n(2),vo(" ",Ea(3,1,"vpDetail.btn.addVariant")," "))}function wP(t,e){1&t&&(Ns(0,"th"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.lbl.delete")))}function AP(t,e){1&t&&qs(0)}function PP(t,e){if(1&t){const t=zs();Ns(0,"button",127),Js("click",(function(){ei(t);const e=Xs().index;return Xs(4).helperRemoveVariant(e)})),Ua(1,"translate"),mo(2,"\xd7 "),Fs()}2&t&&to("title",Ea(1,1,"vpDetail.lbl.deleteVariant"))}function kP(t,e){if(1&t){const t=zs();Ns(0,"button",127),Js("click",(function(){ei(t);const e=Xs().index;return Xs(4).helperRemoveVariant(e)})),Ua(1,"translate"),mo(2,"\xd7 "),Fs()}2&t&&to("title",Ea(1,1,"vpDetail.lbl.deleteVariant"))}const DP=function(t){return{level:t}};function MP(t,e){if(1&t&&(Ns(0,"tr"),Ns(1,"td"),mo(2),Fs(),Ns(3,"td",122),mo(4),Fs(),Ns(5,"td",123),mo(6),Fs(),Ns(7,"td",124),Ua(8,"date"),mo(9),Ua(10,"date"),Fs(),Ns(11,"td",103),mo(12),Fs(),Ns(13,"td",103),Gs(14,AP,1,0,"ng-container",125),Fs(),Ns(15,"td"),Gs(16,PP,3,3,"button",126),Gs(17,kP,3,3,"button",126),Fs(),Fs()),2&t){const t=e.$implicit,i=e.index;Xs(2);const n=Ls(12),r=Xs(2);_n(2),fo(i+1),_n(2),fo(t.variantName),_n(2),fo(t.email),_n(1),to("title",Oa(8,10,t.createdAt,"dd.MM.yyyy HH:mm:ss")),_n(2),fo(Oa(10,13,t.createdAt,"dd.MM.yy")),_n(3),fo(t.vpvCount),_n(2),js("ngTemplateOutlet",n)("ngTemplateOutletContext",ka(16,DP,r.getLockStatus(i))),_n(2),js("ngIf",!t.vpvCount&&r.hasVPPerm(r.permVP.Modify)&&r.getLockStatus(i)<=1),_n(1),js("ngIf",!t.vpvCount&&!r.hasVPPerm(r.permVP.Modify)&&r.hasVPPerm(r.permVP.CreateVariant)&&r.getLockStatus(i)<=1&&t.email==r.currentUser.email)}}function SP(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div"),Ns(2,"div",96),Ns(3,"div",97),Ns(4,"h5",98),mo(5),Ua(6,"translate"),Fs(),Fs(),Gs(7,VP,4,3,"div",99),Fs(),Ns(8,"div",100),Ns(9,"table",101),Ns(10,"thead",118),Ns(11,"tr"),Ns(12,"th"),mo(13),Ua(14,"translate"),Fs(),Ns(15,"th",1),Js("click",(function(){return ei(t),Xs(3).sortVariantTable(1)})),mo(16),Ua(17,"translate"),Fs(),Ns(18,"th",1),Js("click",(function(){return ei(t),Xs(3).sortVariantTable(2)})),mo(19),Ua(20,"translate"),Fs(),Ns(21,"th",119),Js("click",(function(){return ei(t),Xs(3).sortVariantTable(3)})),mo(22),Ua(23,"translate"),Fs(),Ns(24,"th",119),Js("click",(function(){return ei(t),Xs(3).sortVariantTable(4)})),mo(25),Ua(26,"translate"),Fs(),Ns(27,"th",103),mo(28),Ua(29,"translate"),Fs(),Gs(30,wP,3,3,"th",0),Fs(),Fs(),Ns(31,"tbody",120),Gs(32,MP,18,18,"tr",37),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(3);_n(5),vo(" ",Ea(6,10,"vpDetail.titleVariants")," "),_n(2),js("ngIf",t.hasVPPerm(t.permVP.Modify+t.permVP.CreateVariant)),_n(6),fo(Ea(14,12,"vpDetail.lbl.nr")),_n(3),fo(Ea(17,14,"vpDetail.lbl.variant")),_n(3),fo(Ea(20,16,"vpDetail.lbl.email")),_n(3),fo(Ea(23,18,"vpDetail.lbl.createdAt")),_n(3),fo(Ea(26,20,"vpDetail.lbl.versions")),_n(3),fo(Ea(29,22,"vpDetail.lbl.lock")),_n(2),js("ngIf",t.hasVPPerm(t.permVP.Modify+t.permVP.CreateVariant)),_n(2),js("ngForOf",t.visboproject.variant)}}const IP=function(t,e){return{"fa-check-circle text-success":t,"fa-ban text-danger":e}};function xP(t,e){if(1&t&&Bs(0,"i",128),2&t){const t=e.level;js("ngClass",Da(1,IP,1==t,2==t))}}function TP(t,e){if(1&t){const t=zs();Ns(0,"td"),Ns(1,"button",131),Js("click",(function(){ei(t);const e=Xs().index;return Xs(4).unlockVP(e)})),Ua(2,"translate"),mo(3,"\xd7"),Fs(),Fs()}2&t&&(_n(1),to("title",Ea(2,1,"vpDetail.lbl.unlock")))}function _P(t,e){if(1&t&&(Ns(0,"tr"),Ns(1,"td"),mo(2),Fs(),Ns(3,"td"),mo(4),Ua(5,"date"),Fs(),Ns(6,"td"),mo(7),Fs(),Gs(8,TP,4,3,"td",0),Fs()),2&t){const t=e.index,i=Xs(4);_n(2),fo(i.visboproject.lock[t].email),_n(2),fo(Oa(5,4,i.visboproject.lock[t].expiresAt,"dd.MM HH:mm")),_n(3),fo(i.visboproject.lock[t].variantName),_n(1),js("ngIf",!i.deleted&&i.hasVPPerm(i.permVP.Modify))}}function UP(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"div",129),Ns(2,"div",97),Ns(3,"h5",130),mo(4),Ua(5,"translate"),Fs(),Fs(),Fs(),Ns(6,"div",100),Ns(7,"table",101),Ns(8,"thead"),Ns(9,"tr"),Ns(10,"th"),mo(11),Ua(12,"translate"),Fs(),Ns(13,"th"),mo(14),Ua(15,"translate"),Fs(),Ns(16,"th"),mo(17),Ua(18,"translate"),Fs(),Ns(19,"th"),mo(20),Ua(21,"translate"),Fs(),Fs(),Fs(),Ns(22,"tbody"),Gs(23,_P,9,7,"tr",37),Fs(),Fs(),Fs(),Fs()),2&t){const t=Xs(3);_n(4),vo(" ",Ea(5,6,"vpDetail.titleProjectLocks")," "),_n(7),fo(Ea(12,8,"vpDetail.lbl.email")),_n(3),fo(Ea(15,10,"vpDetail.lbl.expires")),_n(3),fo(Ea(18,12,"vpDetail.lbl.variant")),_n(3),fo(Ea(21,14,"vpDetail.lbl.delete")),_n(3),js("ngForOf",t.visboproject.lock)}}function EP(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"div",82),Gs(2,eP,3,3,"button",83),Gs(3,iP,3,3,"button",84),Gs(4,nP,3,3,"button",85),Gs(5,rP,3,3,"button",86),Gs(6,sP,3,3,"button",87),Gs(7,oP,3,3,"button",88),Fs(),Gs(8,hP,27,18,"div",0),Gs(9,CP,30,21,"div",0),Gs(10,SP,33,24,"div",0),Gs(11,xP,1,4,"ng-template",null,89,ja),Gs(13,UP,24,16,"div",0),Fs()),2&t){const t=Xs(2);_n(2),js("ngIf",t.hasVPPerm(t.permVP.ViewAudit)),_n(1),js("ngIf","Group"!=t.actView),_n(1),js("ngIf","User"!=t.actView),_n(1),js("ngIf",t.viewRestriction()),_n(1),js("ngIf","Variant"!=t.actView&&t.hasVPPerm(t.permVP.Modify+t.permVP.CreateVariant)),_n(1),js("ngIf","Lock"!=t.actView&&t.visboproject.lock.length&&t.hasVPPerm(t.permVP.Modify+t.permVP.CreateVariant)),_n(1),js("ngIf","User"==t.actView),_n(1),js("ngIf","Group"==t.actView),_n(1),js("ngIf","Variant"==t.actView),_n(3),js("ngIf","Lock"==t.actView)}}function OP(t,e){if(1&t){const t=zs();Ns(0,"button",132),Js("click",(function(){return ei(t),Xs(2).save()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpDetail.btn.save")))}function GP(t,e){if(1&t){const t=zs();Ns(0,"button",133),Js("click",(function(){return ei(t),Xs(2).save()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpDetail.btn.restore")))}function LP(t,e){1&t&&(Ns(0,"button",134),Ua(1,"translate"),mo(2),Ua(3,"translate"),Fs()),2&t&&(to("title",Ea(1,2,"vpDetail.titleDeleteProject")),_n(2),fo(Ea(3,4,"vpDetail.btn.delete")))}function RP(t,e){1&t&&(Ns(0,"button",135),Ua(1,"translate"),mo(2),Ua(3,"translate"),Fs()),2&t&&(to("title",Ea(1,2,"vpDetail.titleDeleteProject")),_n(2),fo(Ea(3,4,"vpDetail.btn.destroy")))}function jP(t,e){1&t&&(Ns(0,"div",136),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.msg.emailRequired")))}function $P(t,e){if(1&t&&(Ns(0,"option"),mo(1),Fs()),2&t){const t=e.$implicit;_n(1),fo(t.name)}}function NP(t,e){1&t&&(Ns(0,"div",136),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.msg.groupRequired")))}function FP(t,e){1&t&&(Ns(0,"div",136),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.msg.invalidMessage")))}function BP(t,e){1&t&&(Ns(0,"button",137),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.btn.invite")))}function HP(t,e){if(1&t){const t=zs();Ns(0,"button",138),Js("click",(function(){return ei(t),Xs(2).addNewVPUser()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpDetail.btn.invite")))}function KP(t,e){if(1&t){const t=zs();Ns(0,"div",20),Ns(1,"div",21),Ns(2,"div",22),Ns(3,"h5",139),mo(4),Ua(5,"translate"),Fs(),Ns(6,"button",24),Ns(7,"span",25),mo(8,"\xd7"),Fs(),Fs(),Fs(),Ns(9,"div",26),Ns(10,"div"),Ns(11,"label",140),mo(12),Ua(13,"translate"),Fs(),Fs(),Ns(14,"form"),Ns(15,"div",54),Ns(16,"label",141),mo(17),Ua(18,"translate"),Fs(),Ns(19,"label",56),mo(20),Fs(),Fs(),Ns(21,"div",54),Ns(22,"label",141),mo(23),Ua(24,"translate"),Fs(),Ns(25,"label",56),mo(26),Fs(),Fs(),Ns(27,"div",54),Ns(28,"label",141),mo(29),Ua(30,"translate"),Fs(),Ns(31,"label",56),mo(32),Fs(),Fs(),Fs(),Fs(),Ns(33,"div",41),Ns(34,"button",59),mo(35),Ua(36,"translate"),Fs(),Ns(37,"button",142),Js("click",(function(){ei(t);const e=Xs(2);return e.removeVPUser(e.vgUsers[e.userIndex],e.visboproject._id)})),mo(38),Ua(39,"translate"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(4),fo(Ea(5,10,"vpDetail.titleRemoveUser")),_n(8),fo(Ea(13,12,"vpDetail.msg.removeUserConfirm")),_n(5),vo("",Ea(18,14,"vpDetail.lbl.vp"),":"),_n(3),vo("",t.visboproject.name," "),_n(3),vo("",Ea(24,16,"vpDetail.lbl.user"),":"),_n(3),fo(t.vgUsers[t.userIndex].email),_n(3),vo("",Ea(30,18,"vpDetail.lbl.group"),":"),_n(3),fo(t.vgUsers[t.userIndex].groupName),_n(3),fo(Ea(36,20,"vpDetail.btn.back")),_n(3),fo(Ea(39,22,"vpDetail.btn.delete"))}}function qP(t,e){1&t&&(Ns(0,"h5",172),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.titleModifyGroup")))}function zP(t,e){1&t&&(Ns(0,"h5",172),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.titleViewGroup")))}function QP(t,e){1&t&&(Ns(0,"h5",172),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.titleAddGroup")))}function WP(t,e){if(1&t&&(Ns(0,"div",54),Ns(1,"label",173),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",141),mo(5),Fs(),Fs()),2&t){const t=Xs(3);_n(2),vo("",Ea(3,2,"vpDetail.lbl.name"),":"),_n(3),fo(t.actGroup.name)}}function JP(t,e){1&t&&(Ns(0,"div",136),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.msg.groupNameRequired")))}const YP=function(t){return{"has-error":t}};function ZP(t,e){if(1&t){const t=zs();Ns(0,"div",29),Ns(1,"label",174),mo(2),Ua(3,"translate"),Fs(),Ns(4,"input",175,176),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.name=e})),Fs(),Gs(6,JP,3,3,"div",33),Fs()}if(2&t){const t=Ls(5);Xs();const e=Ls(10),i=Xs(2);js("ngClass",ka(6,YP,e.submitted&&!t.valid)),_n(2),vo("",Ea(3,4,"vpDetail.lbl.name"),":"),_n(2),js("ngModel",i.actGroup.name),_n(2),js("ngIf",e.submitted&&!i.actGroup.name.trim())}}function XP(t,e){if(1&t){const t=zs();Ns(0,"div",181),Ns(1,"a",182),Js("click",(function(){return ei(t),Xs(5).toggleView("User")})),mo(2),Fs(),Fs()}if(2&t){const t=Xs().$implicit;_n(2),fo(t.email)}}function tk(t,e){if(1&t&&(Hs(0,96),Gs(1,XP,3,1,"div",180),Ks()),2&t){const t=e.$implicit,i=Xs(4);_n(1),js("ngIf",t.groupId==i.actGroup._id)}}function ek(t,e){if(1&t&&(Ns(0,"div",177),Ns(1,"label",178),mo(2),Ua(3,"translate"),Fs(),Gs(4,tk,2,1,"ng-container",179),Fs()),2&t){const t=Xs(3);_n(2),fo(Ea(3,2,"perm.lblGroupMembers")),_n(2),js("ngForOf",t.vgUsers)}}function ik(t,e){1&t&&(Ns(0,"div",177),Ns(1,"label",178),mo(2),Ua(3,"translate"),Fs(),Fs()),2&t&&(_n(2),fo(Ea(3,1,"perm.lblNoGroupMembers")))}function nk(t,e){if(1&t&&(Ns(0,"button",185),mo(1),Fs()),2&t){const t=Xs(4);_n(1),fo(t.confirm)}}function rk(t,e){if(1&t){const t=zs();Ns(0,"button",186),Js("click",(function(){return ei(t),Xs(4).addModifyVPGroup()})),mo(1),Fs()}if(2&t){const t=Xs(4);_n(1),fo(t.confirm)}}function sk(t,e){if(1&t&&(Ns(0,"div"),Gs(1,nk,2,1,"button",183),Gs(2,rk,2,1,"button",184),Fs()),2&t){Xs();const t=Ls(10);_n(1),js("ngIf",!t.form.valid),_n(1),js("ngIf",t.form.valid)}}function ok(t,e){if(1&t){const t=zs();Ns(0,"div",21),Ns(1,"div",22),Gs(2,qP,3,3,"h5",143),Gs(3,zP,3,3,"h5",143),Gs(4,QP,3,3,"h5",143),Ns(5,"button",24),Ns(6,"span",25),mo(7,"\xd7"),Fs(),Fs(),Fs(),Ns(8,"div",26),Ns(9,"form",144,145),Gs(11,WP,6,4,"div",146),Gs(12,ZP,7,8,"div",147),Ns(13,"div"),mo(14),Ua(15,"translate"),Fs(),Ns(16,"div",148),Ns(17,"input",149,150),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedVPViewRestricted=e})),Fs(),Ns(19,"label",151),mo(20),Ua(21,"translate"),Fs(),Fs(),Ns(22,"div",148),Ns(23,"input",152,153),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedVPView=e})),Fs(),Ns(25,"label",154),mo(26),Ua(27,"translate"),Fs(),Fs(),Ns(28,"div",148),Ns(29,"input",155,156),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedVPViewAudit=e})),Fs(),Ns(31,"label",157),mo(32),Ua(33,"translate"),Fs(),Fs(),Ns(34,"div",148),Ns(35,"input",158,159),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedVPModify=e})),Fs(),Ns(37,"label",160),mo(38),Ua(39,"translate"),Fs(),Fs(),Ns(40,"div",148),Ns(41,"input",161,162),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedCreateVariant=e})),Fs(),Ns(43,"label",163),mo(44),Ua(45,"translate"),Fs(),Fs(),Ns(46,"div",148),Ns(47,"input",164,165),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedVPManagePerm=e})),Fs(),Ns(49,"label",166),mo(50),Ua(51,"translate"),Fs(),Fs(),Ns(52,"div",148),Ns(53,"input",167,168),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedVPDelete=e})),Fs(),Ns(55,"label",169),mo(56),Ua(57,"translate"),Fs(),Fs(),Gs(58,ek,5,4,"div",170),Gs(59,ik,4,3,"div",170),Ns(60,"div",41),Ns(61,"button",171),mo(62),Ua(63,"translate"),Fs(),Gs(64,sk,3,2,"div",0),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(2),js("ngIf","Modify"==t.confirm),_n(1),js("ngIf","View"==t.confirm),_n(1),js("ngIf",!t.actGroup._id),_n(7),js("ngIf",t.actGroup.internal),_n(1),js("ngIf",!t.actGroup.internal),_n(2),fo(Ea(15,24,"perm.titleVPPerm")),_n(3),js("ngModel",t.actGroup.checkedVPViewRestricted),_n(3),fo(Ea(21,26,"perm.vpViewRestricted")),_n(3),js("ngModel",t.actGroup.checkedVPView),_n(3),fo(Ea(27,28,"perm.vpView")),_n(3),js("ngModel",t.actGroup.checkedVPViewAudit),_n(3),fo(Ea(33,30,"perm.vpViewAudit")),_n(3),js("ngModel",t.actGroup.checkedVPModify),_n(3),fo(Ea(39,32,"perm.vpModify")),_n(3),js("ngModel",t.actGroup.checkedCreateVariant),_n(3),fo(Ea(45,34,"perm.vpCreateVariant")),_n(3),js("ngModel",t.actGroup.checkedVPManagePerm),_n(3),fo(Ea(51,36,"perm.vpManagePerm")),_n(3),js("ngModel",t.actGroup.checkedVPDelete),_n(3),fo(Ea(57,38,"perm.vpDelete")),_n(2),js("ngIf",t.helperUsersPerGroup(t.actGroup._id)),_n(1),js("ngIf",!t.helperUsersPerGroup(t.actGroup._id)),_n(3),fo(Ea(63,40,"vpDetail.btn.back")),_n(2),js("ngIf",t.hasVPPerm(t.permVP.ManagePerm)&&!t.actGroup.global&&!t.deleted)}}function ak(t,e){if(1&t){const t=zs();Ns(0,"div",20),Ns(1,"div",21),Ns(2,"div",22),Ns(3,"h5",139),mo(4),Ua(5,"translate"),Fs(),Ns(6,"button",24),Ns(7,"span",25),mo(8,"\xd7"),Fs(),Fs(),Fs(),Ns(9,"div",26),Ns(10,"div"),Ns(11,"label",140),mo(12),Ua(13,"translate"),Fs(),Fs(),Ns(14,"form"),Ns(15,"div",54),Ns(16,"label",187),mo(17),Ua(18,"translate"),Fs(),Ns(19,"label",56),mo(20),Fs(),Fs(),Ns(21,"div",54),Ns(22,"label",141),mo(23),Ua(24,"translate"),Fs(),Ns(25,"label",56),mo(26),Fs(),Fs(),Ns(27,"div",54),Ns(28,"label",141),mo(29),Ua(30,"translate"),Fs(),Ns(31,"label",56),mo(32),Fs(),Fs(),Fs(),Fs(),Ns(33,"div",41),Ns(34,"button",59),mo(35),Ua(36,"translate"),Fs(),Ns(37,"button",188),Js("click",(function(){ei(t);const e=Xs(2);return e.removeVPGroup(e.vgGroups[e.groupIndex],e.visboproject._id)})),mo(38),Ua(39,"translate"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(4),fo(Ea(5,10,"vpDetail.titleDeleteGroup")),_n(8),fo(Ea(13,12,"vpDetail.msg.removeGroupConfirm")),_n(5),vo("",Ea(18,14,"vpDetail.lbl.vp"),":"),_n(3),vo("",t.visboproject.name," "),_n(3),vo("",Ea(24,16,"vpDetail.lbl.group"),":"),_n(3),fo(t.vgGroups[t.groupIndex].name),_n(3),vo("",Ea(30,18,"vpDetail.lbl.members"),":"),_n(3),fo(t.vgGroups[t.groupIndex].users.length),_n(3),fo(Ea(36,20,"vpDetail.btn.back")),_n(3),fo(Ea(39,22,"vpDetail.btn.delete"))}}function lk(t,e){1&t&&(Ns(0,"label",140),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.msg.removeProjectConfirm")))}function ck(t,e){1&t&&(Ns(0,"label",189),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.msg.destroyProjectConfirm")))}function dk(t,e){if(1&t){const t=zs();Ns(0,"button",190),Js("click",(function(){ei(t);const e=Xs(2);return e.delete(e.visboproject)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpDetail.btn.delete")))}function uk(t,e){if(1&t){const t=zs();Ns(0,"button",191),Js("click",(function(){ei(t);const e=Xs(2);return e.delete(e.visboproject)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpDetail.btn.destroy")))}function hk(t,e){1&t&&Bs(0,"input",211)}function pk(t,e){1&t&&Bs(0,"input",212)}function gk(t,e){1&t&&Bs(0,"input",213)}function mk(t,e){1&t&&Bs(0,"input",214)}function fk(t,e){1&t&&Bs(0,"input",215)}function vk(t,e){1&t&&Bs(0,"input",216)}function bk(t,e){1&t&&Bs(0,"input",217)}function yk(t,e){1&t&&Bs(0,"input",218)}function Ck(t,e){1&t&&Bs(0,"input",219)}function Vk(t,e){1&t&&Bs(0,"input",220)}function wk(t,e){1&t&&Bs(0,"input",221)}function Ak(t,e){1&t&&Bs(0,"input",222)}function Pk(t,e){1&t&&Bs(0,"input",223)}function kk(t,e){1&t&&Bs(0,"input",224)}function Dk(t,e){if(1&t){const t=zs();Ns(0,"div",181),Ns(1,"a",182),Js("click",(function(){return ei(t),Xs(4).toggleView("Group")})),mo(2),Fs(),Fs()}if(2&t){const t=Xs().$implicit;_n(2),fo(t.groupName)}}function Mk(t,e){if(1&t&&(Hs(0,96),Gs(1,Dk,3,1,"div",180),Ks()),2&t){const t=e.$implicit,i=Xs(3);_n(1),js("ngIf",t.email==i.vgUsers[i.userIndex].email)}}const Sk=function(t){return{name:t}};function Ik(t,e){if(1&t&&(Ns(0,"div",192),Ns(1,"div",193),Ns(2,"div",21),Ns(3,"div",22),Ns(4,"h5",194),mo(5),Ua(6,"translate"),Fs(),Ns(7,"button",24),Ns(8,"span",25),mo(9,"\xd7"),Fs(),Fs(),Fs(),Ns(10,"div",26),Ns(11,"div"),mo(12),Ua(13,"translate"),Fs(),Ns(14,"div",148),Gs(15,hk,1,0,"input",195),Gs(16,pk,1,0,"input",196),Ns(17,"label",154),mo(18),Ua(19,"translate"),Fs(),Fs(),Ns(20,"div",148),Gs(21,gk,1,0,"input",197),Gs(22,mk,1,0,"input",198),Ns(23,"label",154),mo(24),Ua(25,"translate"),Fs(),Fs(),Ns(26,"div",148),Gs(27,fk,1,0,"input",199),Gs(28,vk,1,0,"input",200),Ns(29,"label",157),mo(30),Ua(31,"translate"),Fs(),Fs(),Ns(32,"div",148),Gs(33,bk,1,0,"input",201),Gs(34,yk,1,0,"input",202),Ns(35,"label",160),mo(36),Ua(37,"translate"),Fs(),Fs(),Ns(38,"div",148),Gs(39,Ck,1,0,"input",203),Gs(40,Vk,1,0,"input",204),Ns(41,"label",163),mo(42),Ua(43,"translate"),Fs(),Fs(),Ns(44,"div",148),Gs(45,wk,1,0,"input",205),Gs(46,Ak,1,0,"input",206),Ns(47,"label",166),mo(48),Ua(49,"translate"),Fs(),Fs(),Ns(50,"div",148),Gs(51,Pk,1,0,"input",207),Gs(52,kk,1,0,"input",208),Ns(53,"label",169),mo(54),Ua(55,"translate"),Fs(),Fs(),Ns(56,"label",209),mo(57),Ua(58,"translate"),Fs(),Gs(59,Mk,2,1,"ng-container",179),Ns(60,"div",41),Ns(61,"button",210),mo(62),Ua(63,"translate"),Fs(),Fs(),Fs(),Fs(),Fs(),Fs()),2&t){const t=Xs(2);_n(5),fo(Oa(6,26,"vpDetail.titlePermUser",ka(49,Sk,t.vgUsers[t.userIndex].email))),_n(7),fo(Ea(13,29,"perm.titleVPPerm")),_n(3),js("ngIf",t.hasUserVPPerm(t.permVP.ViewRestricted)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.ViewRestricted)),_n(2),fo(Ea(19,31,"perm.vpViewRestricted")),_n(3),js("ngIf",t.hasUserVPPerm(t.permVP.View)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.View)),_n(2),fo(Ea(25,33,"perm.vpView")),_n(3),js("ngIf",t.hasUserVPPerm(t.permVP.ViewAudit)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.ViewAudit)),_n(2),fo(Ea(31,35,"perm.vpViewAudit")),_n(3),js("ngIf",t.hasUserVPPerm(t.permVP.Modify)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.Modify)),_n(2),fo(Ea(37,37,"perm.vpModify")),_n(3),js("ngIf",t.hasUserVPPerm(t.permVP.CreateVariant)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.CreateVariant)),_n(2),fo(Ea(43,39,"perm.vpCreateVariant")),_n(3),js("ngIf",t.hasUserVPPerm(t.permVP.ManagePerm)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.ManagePerm)),_n(2),fo(Ea(49,41,"perm.vpManagePerm")),_n(3),js("ngIf",t.hasUserVPPerm(t.permVP.DeleteVP)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.DeleteVP)),_n(2),fo(Ea(55,43,"perm.vpDelete")),_n(3),fo(Ea(58,45,"perm.lblGroupMembership")),_n(2),js("ngForOf",t.vgUsers),_n(3),fo(Ea(63,47,"vpDetail.btn.back"))}}function xk(t,e){1&t&&(Ns(0,"div",136),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.msg.variantRequired")))}function Tk(t,e){1&t&&(Ns(0,"button",225),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpDetail.btn.createVariant")))}function _k(t,e){if(1&t){const t=zs();Ns(0,"button",226),Js("click",(function(){return ei(t),Xs(2).addNewVPVariant()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpDetail.btn.createVariant")))}function Uk(t,e){if(1&t){const t=zs();Ns(0,"div",20),Ns(1,"div",21),Ns(2,"div",22),Ns(3,"h5",227),mo(4),Ua(5,"translate"),Fs(),Ns(6,"button",24),Ns(7,"span",25),mo(8,"\xd7"),Fs(),Fs(),Fs(),Ns(9,"div",26),Ns(10,"div"),Ns(11,"label",140),mo(12),Ua(13,"translate"),Fs(),Fs(),Ns(14,"form"),Ns(15,"div",54),Ns(16,"label",228),mo(17),Ua(18,"translate"),Fs(),Ns(19,"label",229),mo(20),Fs(),Fs(),Ns(21,"div",54),Ns(22,"label",228),mo(23),Ua(24,"translate"),Fs(),Ns(25,"label",229),mo(26),Fs(),Fs(),Ns(27,"div",54),Ns(28,"label",228),mo(29),Ua(30,"translate"),Fs(),Ns(31,"label",229),mo(32),Fs(),Fs(),Fs(),Fs(),Ns(33,"div",41),Ns(34,"button",59),mo(35),Ua(36,"translate"),Fs(),Ns(37,"button",230),Js("click",(function(){ei(t);const e=Xs(2);return e.removeVariant(e.variantIndex,e.visboproject)})),mo(38),Ua(39,"translate"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(4),fo(Ea(5,10,"vpDetail.titleRemoveVariant")),_n(8),fo(Ea(13,12,"vpDetail.msg.removeVariantConfirm")),_n(5),vo("",Ea(18,14,"vpDetail.lbl.vp"),":"),_n(3),vo("",t.visboproject.name," "),_n(3),vo("",Ea(24,16,"vpDetail.lbl.variant"),":"),_n(3),fo(t.visboproject.variant[t.variantIndex].variantName),_n(3),vo("",Ea(30,18,"vpDetail.lbl.user"),":"),_n(3),fo(t.visboproject.variant[t.variantIndex].email),_n(3),fo(Ea(36,20,"vpDetail.btn.back")),_n(3),fo(Ea(39,22,"vpDetail.btn.delete"))}}function Ek(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"h3"),mo(2),Ua(3,"translate"),Ns(4,"a",1),Js("click",(function(){ei(t);const e=Xs();return e.gotoVP(e.visboproject)})),mo(5),Ua(6,"uppercase"),Fs(),Fs(),Ns(7,"h5"),mo(8),Ua(9,"translate"),Gs(10,zA,2,1,"a",2),Gs(11,QA,2,1,"span",0),Fs(),Ns(12,"form"),Ns(13,"div",3),Ns(14,"label",4),mo(15),Ua(16,"translate"),Fs(),Gs(17,WA,1,1,"input",5),Gs(18,JA,2,1,"label",6),Fs(),Gs(19,XA,6,5,"div",7),Ns(20,"div",3),Ns(21,"label",8),mo(22),Ua(23,"translate"),Fs(),Ns(24,"label",9),mo(25),Fs(),Fs(),Gs(26,tP,8,8,"div",7),Ns(27,"div",10),Ns(28,"label",11),mo(29),Ua(30,"translate"),Fs(),Ns(31,"label",12),mo(32),Ua(33,"date"),Fs(),Ns(34,"label",13),mo(35),Ua(36,"date"),Fs(),Fs(),Fs(),Gs(37,EP,14,10,"div",0),Ns(38,"div",14),Gs(39,OP,3,3,"button",15),Gs(40,GP,3,3,"button",16),Ns(41,"button",1),Js("click",(function(){return ei(t),Xs().goBack()})),mo(42),Ua(43,"translate"),Fs(),Gs(44,LP,4,6,"button",17),Gs(45,RP,4,6,"button",18),Fs(),Ns(46,"div",19),Ns(47,"div",20),Ns(48,"div",21),Ns(49,"div",22),Ns(50,"h5",23),mo(51),Ua(52,"translate"),Fs(),Ns(53,"button",24),Ns(54,"span",25),mo(55,"\xd7"),Fs(),Fs(),Fs(),Ns(56,"div",26),Ns(57,"form",27,28),Ns(59,"div",29),Ns(60,"label",30),mo(61),Ua(62,"translate"),Fs(),Ns(63,"input",31,32),Js("ngModelChange",(function(e){return ei(t),Xs().newUserInvite.email=e})),Fs(),Gs(65,jP,3,3,"div",33),Fs(),Ns(66,"div",29),Ns(67,"label",34),mo(68),Ua(69,"translate"),Fs(),Ns(70,"select",35,36),Js("ngModelChange",(function(e){return ei(t),Xs().newUserInvite.groupName=e})),Bs(72,"option"),Gs(73,$P,2,1,"option",37),Fs(),Gs(74,NP,3,3,"div",33),Fs(),Ns(75,"div",29),Ns(76,"label",38),mo(77),Ua(78,"translate"),Fs(),Ns(79,"textarea",39,40),Js("ngModelChange",(function(e){return ei(t),Xs().newUserInvite.inviteMessage=e})),mo(81," "),Fs(),Fs(),Gs(82,FP,3,3,"div",33),Ns(83,"div",41),Ns(84,"button",42),mo(85),Ua(86,"translate"),Fs(),Gs(87,BP,3,3,"button",43),Gs(88,HP,3,3,"button",44),Fs(),Fs(),Fs(),Fs(),Fs(),Fs(),Ns(89,"div",45),Gs(90,KP,40,24,"div",46),Fs(),Ns(91,"div",47),Ns(92,"div",20),Gs(93,ok,65,42,"div",48),Fs(),Fs(),Ns(94,"div",49),Gs(95,ak,40,24,"div",46),Fs(),Ns(96,"div",50),Ns(97,"div",20),Ns(98,"div",21),Ns(99,"div",22),Ns(100,"h5",51),mo(101),Ua(102,"translate"),Fs(),Ns(103,"button",24),Ns(104,"span",25),mo(105,"\xd7"),Fs(),Fs(),Fs(),Ns(106,"div",26),Ns(107,"div"),Gs(108,lk,3,3,"label",52),Gs(109,ck,3,3,"label",53),Fs(),Ns(110,"form"),Ns(111,"div",54),Ns(112,"label",55),mo(113),Ua(114,"translate"),Fs(),Ns(115,"label",56),mo(116),Fs(),Fs(),Ns(117,"div",54),Ns(118,"label",57),mo(119),Ua(120,"translate"),Fs(),Ns(121,"label",56),mo(122),Fs(),Fs(),Ns(123,"div",54),Ns(124,"label",58),mo(125),Ua(126,"translate"),Fs(),Ns(127,"label",56),mo(128),Fs(),Fs(),Fs(),Fs(),Ns(129,"div",41),Ns(130,"button",59),mo(131),Ua(132,"translate"),Fs(),Gs(133,dk,3,3,"button",60),Gs(134,uk,3,3,"button",61),Fs(),Fs(),Fs(),Fs(),Gs(135,Ik,64,51,"div",62),Ns(136,"div",63),Ns(137,"div",20),Ns(138,"div",21),Ns(139,"div",22),Ns(140,"h5",64),mo(141),Ua(142,"translate"),Fs(),Ns(143,"button",24),Ns(144,"span",25),mo(145,"\xd7"),Fs(),Fs(),Fs(),Ns(146,"div",26),Ns(147,"form",65,66),Ns(149,"div",29),Ns(150,"label",67),mo(151),Ua(152,"translate"),Fs(),Ns(153,"input",68,69),Js("ngModelChange",(function(e){return ei(t),Xs().newVariant=e})),Fs(),Gs(155,xk,3,3,"div",33),Fs(),Ns(156,"div",41),Ns(157,"button",42),mo(158),Ua(159,"translate"),Fs(),Gs(160,Tk,3,3,"button",70),Gs(161,_k,3,3,"button",71),Fs(),Fs(),Fs(),Fs(),Fs(),Fs(),Ns(162,"div",72),Gs(163,Uk,40,24,"div",46),Fs(),Fs()}if(2&t){const t=Ls(58),e=Ls(64),i=Ls(71),n=Ls(80),r=Ls(148),s=Ls(154),o=Xs();_n(2),vo("",Ea(3,63,"vpDetail.title"),": "),_n(3),fo(Ea(6,65,o.visboproject.name)),_n(3),vo("",Ea(9,67,"vpDetail.titleVC"),": "),_n(2),js("ngIf",o.hasVCPerm(o.permVC.View)),_n(1),js("ngIf",!o.hasVCPerm(o.permVC.View)),_n(4),vo("",Ea(16,69,"vpDetail.lbl.name"),":"),_n(2),js("ngIf",o.hasVPPerm(o.permVP.Modify)),_n(1),js("ngIf",!o.hasVPPerm(o.permVP.Modify)),_n(1),js("ngIf",o.hasVPPerm(o.permVP.Modify)||o.visboproject.description),_n(3),vo("",Ea(23,71,"vpDetail.lbl.type"),":"),_n(3),vo("",o.getVPType(o.visboproject.vpType)," "),_n(1),js("ngIf",o.hasVPPerm(o.permVP.Modify+o.permVP.CreateVariant)),_n(3),vo("",Ea(30,73,"vpDetail.lbl.createdUpdated"),":"),_n(3),vo("",Oa(33,75,o.visboproject.createdAt,"dd.MM.yyyy HH:mm:ss")," "),_n(3),vo("",Oa(36,78,o.visboproject.updatedAt,"dd.MM.yyyy HH:mm:ss")," "),_n(2),js("ngIf",o.getVPPerm()!=o.permVP.View),_n(2),js("ngIf",!o.deleted&&o.hasVPPerm(o.permVP.Modify)),_n(1),js("ngIf",o.deleted&&o.hasVPPerm(o.permVP.DeleteVP)),_n(2),fo(Ea(43,81,"vpDetail.btn.back")),_n(2),js("ngIf",!o.deleted&&o.hasVPPerm(o.permVP.DeleteVP)),_n(1),js("ngIf",o.deleted&&o.hasVPPerm(o.permVP.DeleteVP)),_n(6),fo(Ea(52,83,"vpDetail.titleAddUser")),_n(8),js("ngClass",ka(109,YP,t.submitted&&!e.valid)),_n(2),vo("",Ea(62,85,"vpDetail.lbl.email"),":"),_n(2),js("ngModel",o.newUserInvite.email),_n(2),js("ngIf",t.submitted&&!e.valid),_n(1),js("ngClass",ka(111,YP,t.submitted&&!i.valid)),_n(2),vo("",Ea(69,87,"vpDetail.lbl.group"),":"),_n(2),js("ngModel",o.newUserInvite.groupName),_n(3),js("ngForOf",o.vgGroupsInvite),_n(1),js("ngIf",t.submitted&&!i.valid),_n(1),js("ngClass",ka(113,YP,t.submitted&&!n.valid)),_n(2),vo("",Ea(78,89,"vpDetail.lbl.message"),":"),_n(2),js("ngModel",o.newUserInvite.inviteMessage),_n(3),js("ngIf",t.submitted&&!n.valid),_n(3),fo(Ea(86,91,"vpDetail.btn.cancel")),_n(2),js("ngIf",!(e.valid&&i.valid)),_n(1),js("ngIf",e.valid&&i.valid),_n(2),js("ngIf",o.userIndex>=0&&o.userIndex<o.vgUsers.length),_n(3),js("ngIf",o.actGroup),_n(2),js("ngIf",o.groupIndex>=0&&o.groupIndex<o.vgGroups.length),_n(6),fo(Ea(102,93,"vpDetail.titleDeleteProject")),_n(7),js("ngIf",!o.deleted),_n(1),js("ngIf",o.deleted),_n(4),vo("",Ea(114,95,"vpDetail.lbl.vp"),":"),_n(3),vo("",o.visboproject.name," "),_n(3),vo("",Ea(120,97,"vpDetail.lbl.description"),":"),_n(3),vo("",o.visboproject.description," "),_n(3),vo("",Ea(126,99,"vpDetail.lbl.versions"),":"),_n(3),vo("",o.visboproject.vpvCount," "),_n(3),fo(Ea(132,101,"vpDetail.btn.back")),_n(2),js("ngIf",!o.deleted),_n(1),js("ngIf",o.deleted),_n(1),js("ngIf",o.vgUsers&&o.userIndex>=0),_n(6),fo(Ea(142,103,"vpDetail.titleAddVariant")),_n(8),js("ngClass",ka(115,YP,r.submitted&&!s.valid)),_n(2),vo("",Ea(152,105,"vpDetail.lbl.variant"),":"),_n(2),js("ngModel",o.newVariant),_n(2),js("ngIf",r.submitted&&!s.valid),_n(3),fo(Ea(159,107,"vpDetail.btn.cancel")),_n(2),js("ngIf",!s.valid),_n(1),js("ngIf",s.valid),_n(2),js("ngIf",o.variantIndex>=0&&o.variantIndex<o.visboproject.variant.length)}}let Ok=(()=>{class t{constructor(t,e,i,n,r,s,o,a){this.messageService=t,this.route=e,this.visboprojectService=i,this.location=n,this.router=r,this.alertService=s,this.translate=o,this.titleService=a,this.newUserInvite=new Yh,this.actGroup=new Dv,this.actView="User",this.combinedPerm=void 0,this.combinedUserPerm=void 0,this.permVC=Av,this.permVP=Pv,this.deleted=!1,this.sortUserColumn=1,this.sortUserAscending=!0,this.sortGroupColumn=1,this.sortGroupAscending=!0,this.sortVariantColumn=1,this.sortVariantAscending=!0}ngOnInit(){this.deleted=!!this.route.snapshot.queryParams.deleted,this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.getVisboProject(),this.getVisboProjectUsers()}getVisboProject(){const t=this.route.snapshot.paramMap.get("id");this.log("VisboProject Detail of: "+t),this.visboprojectService.getVisboProject(t,!1,this.deleted).subscribe(e=>{this.visboproject=e,this.combinedPerm=e.perm,this.titleService.setTitle(this.translate.instant("vpDetail.titleName",{name:e.name})),this.log(`Get VisboProject for VP ${t} Perm ${JSON.stringify(this.combinedPerm)} `)},t=>{if(this.log(`get VPs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpDetail.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Lh(t))})}hasVCPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vc&t)>0}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}hasUserVPPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vp&t)>0}getVPPerm(){return void 0===this.combinedPerm?0:this.combinedPerm.vp}viewRestriction(){if(!this.visboproject.restrict||!this.visboproject.restrict.length)return!1;let t=this.combinedPerm.vp||0;return t&=this.permVP.Modify+this.permVP.ManagePerm+this.permVP.DeleteVP,t>0}getVPType(t){return this.translate.instant("vp.type.vpType"+t)}toggleView(t){this.actView=t}getVisboProjectUsers(){const t=this.route.snapshot.paramMap.get("id");this.log(`VisboProject UserList of: ${t} Deleted ${this.deleted}`),this.visboprojectService.getVPUsers(t,!1,this.deleted).subscribe(t=>{this.vgUsers=t.users,this.vgGroups=t.groups,this.vgGroupsInvite=this.vgGroups.filter(t=>"VP"===t.groupType),this.log(`fetched Users ${this.vgUsers.length}, Groups ${this.vgGroups.length}, Invite Groups ${this.vgGroupsInvite.length}`),this.sortUserTable(),this.sortGroupTable()},t=>{if(this.log(`Get VP Users failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpDetail.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Lh(t))})}goBack(){this.location.back()}delete(t){this.visboprojectService.deleteVisboProject(t,this.deleted).subscribe(()=>{const e=this.translate.instant("vpDetail.msg.removeProjectSuccess",{name:this.visboproject.name});this.alertService.success(e,!0),this.log("delete VP success"),this.router.navigate(["vp/".concat(t.vcid)],this.deleted?{queryParams:{deleted:this.deleted}}:{})},e=>{if(this.log(`delete VP failed: error: ${e.status} message: ${e.error.message}`),403===e.status){const e=this.translate.instant("vpDetail.msg.errorPermVP",{name:t.name});this.alertService.error(e)}else this.alertService.error(Lh(e))})}gotoVPRestriction(t){this.log(`goto VP Restriction: ${t._id} Deleted ${this.deleted}`),this.router.navigate(["vpRestrict/".concat(t._id)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}gotoVPAudit(t){this.log(`goto VP Audit: ${t._id} Deleted ${this.deleted}`),this.router.navigate(["vpAudit/".concat(t._id)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}gotoVCDetail(t){this.router.navigate(["vcDetail/".concat(t.vcid)])}gotoVPList(t){this.log(`goto VP List: ${t._id} Deleted ${this.deleted}`),this.router.navigate(["vp/".concat(t.vcid)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}gotoVP(t){this.log(`goto VP: ${t._id} Deleted ${this.deleted}`);let e="vpKeyMetrics/";t.vpType===hb.Portfolio&&(e="vpf/"),this.router.navigate([e.concat(t._id)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}gotoVPView(t){this.log(`goto VP List: ${t._id} Deleted ${this.deleted}`),this.router.navigate(["vpv/".concat(t._id)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}save(){this.visboprojectService.updateVisboProject(this.visboproject,this.deleted).subscribe(()=>{const t=this.translate.instant("vpDetail.msg.updateProjectSuccess",{name:this.visboproject.name});this.alertService.success(t,!0),this.goBack()},t=>{if(this.log(`save VP failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpDetail.msg.errorPermVP",{name:this.visboproject.name});this.alertService.error(t)}else if(409===t.status){const t=this.translate.instant("vpDetail.msg.errorVPConflict",{name:this.visboproject.name});this.alertService.error(t)}else this.alertService.error(Lh(t))})}addNewVPUser(){const t=this.newUserInvite.email.trim(),e=this.newUserInvite.groupName.trim(),i=this.vgGroups.filter(t=>t.name===e)[0],n=i._id;let r="";this.newUserInvite.inviteMessage&&(r=this.newUserInvite.inviteMessage.trim());const s=this.visboproject._id;this.log(`Add VisboProject User: ${t} Group: ${e}/${n} VP: ${s}`),t&&n&&this.visboprojectService.addVPUser(t,n,r,s).subscribe(e=>{const n=new Mv;n.userId=e.users.filter(e=>e.email===t)[0].userId,n.email=t,n.groupId=e._id,n.groupName=e.name,n.groupType=i.groupType,n.internal=i.internal,this.log("Add VisboCenter User Push: "+JSON.stringify(n)),this.vgUsers.push(n),this.sortUserTable();for(let t=0;t<this.vgGroups.length;t++)if(this.vgGroups[t]._id===e._id){this.vgGroups[t]=e;break}const r=this.translate.instant("vpDetail.msg.addUserSuccess",{name:t});this.alertService.success(r)},t=>{if(this.log("Add VisboProject User error: "+t.error.message),403===t.status){const t=this.translate.instant("vpDetail.msg.errorAddUserPerm");this.alertService.error(t)}else this.log("Error during add VP user "+t.error.message),this.alertService.error(Lh(t))})}addNewVPVariant(){this.newVariant&&this.newVariant.trim()&&(this.newVariant=this.newVariant.trim(),this.visboprojectService.createVariant(this.newVariant,this.visboproject._id).subscribe(t=>{this.visboproject.variant.push(t);const e=this.translate.instant("vpDetail.msg.createVariantSuccess",{name:t.variantName});this.alertService.success(e)},t=>{if(this.log("Create Variant error: "+t.error.message),403===t.status){const t=this.translate.instant("vpDetail.msg.errorCreateVariantPerm");this.alertService.error(t)}else if(409===t.status){const t=this.translate.instant("vpDetail.msg.errorVariantConflict",{name:this.newVariant});this.alertService.error(t)}else this.log("Error during creating Variant "+t.error.message),this.alertService.error(Lh(t))}))}calcCombinedPerm(t){this.userIndex=t,this.combinedUserPerm={system:0,vc:0,vp:0},this.vgUsers.forEach(this.addUserPerm,this),this.log(`Combined Permission for ${this.vgUsers[t].email}  ${JSON.stringify(this.combinedUserPerm)}`)}addUserPerm(t){if(t.email!==this.vgUsers[this.userIndex].email)return;this.log("Add User Permission for "+t.groupName);const e=this.vgGroups.findIndex(e=>e.name===t.groupName);e>=0?this.vgGroups[e].permission?this.combinedUserPerm.vp=this.combinedUserPerm.vp|(this.vgGroups[e].permission.vp||0):this.log("Permission for Group not set "+t.groupName):this.log("Group not found "+t.groupName)}helperRemoveUser(t){this.userIndex=t}helperRemoveGroup(t){this.groupIndex=t}helperRemoveVariant(t){this.variantIndex=t}helperUsersPerGroup(t){const e=this.vgGroups&&this.vgGroups.find(e=>e._id===t);return e?e.users.length:0}removeVPUser(t,e){this.log(`Remove VisboProject User: ${t.email}/${t.userId} Group: ${t.groupName} VP: ${e}`),this.visboprojectService.deleteVPUser(t,e).subscribe(()=>{this.vgUsers=this.vgUsers.filter(e=>e!==t);for(let i=0;i<this.vgGroups.length;i++)if(this.vgGroups[i]._id===t.groupId){for(let e=0;e<this.vgGroups[i].users.length;e++)if(this.vgGroups[i].users[e].userId===t.userId){this.vgGroups[i].users.splice(e,1);break}break}const e=this.translate.instant("vpDetail.msg.removeUserSuccess",{name:t.email});this.alertService.success(e)},t=>{if(this.log("Remove VisboProject User error: "+t.error.message),403===t.status){const t=this.translate.instant("vpDetail.msg.errorRemoveUserPerm");this.alertService.error(t)}else this.log("Error during remove User from VP user "+t.error.message),this.alertService.error(Lh(t))})}removeVariant(t,e){this.log(`Remove VisboProject Variant: ${e.variant[t].variantName} VP: ${e._id}`),this.visboprojectService.deleteVariant(e.variant[t]._id,e._id).subscribe(()=>{const i=this.translate.instant("vpDetail.msg.removeVariantSuccess",{name:e.variant[t].variantName});this.visboproject.variant.splice(t,1),this.alertService.success(i)},i=>{if(this.log("Remove VisboProject Variant error: "+i.error.message),403===i.status){const i=this.translate.instant("vpDetail.msg.errorRemoveVariantPerm",{name:e.variant[t].variantName});this.alertService.error(i)}else if(409===i.status){const i=this.translate.instant("vpDetail.msg.errorRemoveVariantConflict",{name:e.variant[t].variantName});this.alertService.error(i)}else this.log("Error during remove Variant from VP "+i.error.message),this.alertService.error(Lh(i))})}helperVPPerm(t){let e=0;return t.checkedVPViewRestricted&&(e+=this.permVP.ViewRestricted),t.checkedVPView&&(e+=this.permVP.View),t.checkedVPViewAudit&&(e+=this.permVP.ViewAudit),t.checkedVPModify&&(e+=this.permVP.Modify),t.checkedCreateVariant&&(e+=this.permVP.CreateVariant),t.checkedVPManagePerm&&(e+=this.permVP.ManagePerm),t.checkedVPDelete&&(e+=this.permVP.DeleteVP),e}initGroup(t){this.actGroup=new Dv,t?(this.confirm="VP"===t.groupType?"Modify":"View",this.actGroup._id=t._id,this.log(`Init Group Set GroupID : ${this.actGroup._id} ID ${t._id}`),this.actGroup.name=t.name,this.actGroup.groupType=t.groupType,this.actGroup.internal=t.internal,this.actGroup.global=t.global,this.actGroup.checkedView=(t.permission.vc&this.permVC.View)>0,this.actGroup.checkedViewAudit=(t.permission.vc&this.permVC.ViewAudit)>0,this.actGroup.checkedModify=(t.permission.vc&this.permVC.Modify)>0,this.actGroup.checkedCreateVP=(t.permission.vc&this.permVC.CreateVP)>0,this.actGroup.checkedManagePerm=(t.permission.vc&this.permVC.ManagePerm)>0,this.actGroup.checkedVPViewRestricted=(t.permission.vp&this.permVP.ViewRestricted)>0,this.actGroup.checkedVPView=(t.permission.vp&this.permVP.View)>0,this.actGroup.checkedVPViewAudit=(t.permission.vp&this.permVP.ViewAudit)>0,this.actGroup.checkedVPModify=(t.permission.vp&this.permVP.Modify)>0,this.actGroup.checkedCreateVariant=(t.permission.vp&this.permVP.CreateVariant)>0,this.actGroup.checkedVPManagePerm=(t.permission.vp&this.permVP.ManagePerm)>0,this.actGroup.checkedVPDelete=(t.permission.vp&this.permVP.DeleteVP)>0):(this.confirm="Add",this.actGroup._id=void 0,this.actGroup.name="",this.actGroup.groupType="VP",this.actGroup.internal=!1,this.actGroup.global=!1,this.actGroup.checkedView=!0),this.log(`Init Group for Creation / Modification: ${this.actGroup.name} ID ${this.actGroup._id} Action ${this.confirm} `)}addModifyVPGroup(){const t=new kv;!this.actGroup.global&&this.hasVPPerm(this.permVP.ManagePerm)&&(this.log(`Modify VisboProject Group: Group: ${this.actGroup.name} VC: ${this.visboproject.vcid} VP: ${this.visboproject._id} }`),t.name=this.actGroup.name.trim(),t.global=!1,t.vcid=this.visboproject.vcid,t.vpids=[],t.vpids.push(this.visboproject._id),t.permission=new Vv,t.permission.vp=this.helperVPPerm(this.actGroup),this.actGroup._id?(this.log(`Modify VisboProject Group: Group: ${t.name} VC: ${t.vcid} Perm: ${JSON.stringify(t.permission)}`),t._id=this.actGroup._id,this.visboprojectService.modifyVPGroup(t).subscribe(e=>{this.log("Modify VisboProject Group Push: "+JSON.stringify(e)),this.vgGroups=this.vgGroups.filter(e=>e._id!==t._id),this.vgGroups.push(e),this.vgGroupsInvite=this.vgGroups.filter(t=>"VP"===t.groupType);for(let n=0;n<this.vgUsers.length;n++)this.vgUsers[n].groupId===t._id&&(this.vgUsers[n].groupName=e.name);this.sortUserTable(),this.sortGroupTable();const i=this.translate.instant("vpDetail.msg.changeGroupSuccess",{name:e.name});this.alertService.success(i)},t=>{if(this.log("Modify VisboProject Group error: "+t.error.message),403===t.status){const t=this.translate.instant("vpDetail.msg.errorChangeGroupPerm");this.alertService.error(t)}else this.log("Error during modify VP Group "+t.error.message),this.alertService.error(Lh(t))})):(this.log(`Add VisboProject Group: Group: ${t.name} VP: ${t.vpids[0]} Perm: ${JSON.stringify(t.permission)}`),this.visboprojectService.addVPGroup(t).subscribe(t=>{this.vgGroups.push(t),this.vgGroupsInvite=this.vgGroups.filter(t=>"VP"===t.groupType);const e=this.translate.instant("vpDetail.msg.createGroupSuccess",{name:t.name});this.alertService.success(e)},t=>{if(this.log("Add VisboProject Group error: "+t.error.message),403===t.status){const t=this.translate.instant("vpDetail.msg.errorCreateGroupPerm");this.alertService.error(t)}else this.log("Error during add VP Group "+t.error.message),this.alertService.error(Lh(t))})))}removeVPGroup(t,e){this.log(`Remove VisboProject Group: ${t.name}/${t._id} VP: ${e}`),this.visboprojectService.deleteVPGroup(t,e).subscribe(e=>{this.log("Remove VisboProject Group result: "+JSON.stringify(e)),this.vgGroups=this.vgGroups.filter(e=>e!==t),this.vgUsers=this.vgUsers.filter(e=>e.groupId!==t._id),this.vgGroupsInvite=this.vgGroups.filter(t=>"VP"===t.groupType);const i=this.translate.instant("vpDetail.msg.removeGroupSuccess",{name:t.name});this.alertService.success(i)},t=>{if(this.log("Remove VisboProject Group error: "+t.error.message),403===t.status){const t=this.translate.instant("vpDetail.msg.errorRemoveGroupPerm");this.alertService.error(t)}else this.log("Error during remove Group from VP user "+t.error.message),this.alertService.error(Lh(t))})}getLockStatus(t){let e=0;const i=this.visboproject.variant[t].variantName,n=this.visboproject.lock.find(t=>t.variantName==i);return n&&(e=n.email==this.currentUser.email?1:2),e}unlockVP(t){const e=this.visboproject._id,i=this.visboproject.lock[t].variantName,n=this.visboproject.variant.find(t=>t.variantName==i),r=n?n._id.toString():"";this.log(`Remove VisboProject Lock: ${this.visboproject.name} Variant ${i} ${this.visboproject.lock[t].expiresAt} VPID: ${e}`),this.visboprojectService.unlockVP(r,e).subscribe(t=>{this.log("Remove VisboProject Lock result: "+JSON.stringify(t));for(let n=0;n<this.visboproject.lock.length;n++)if(this.visboproject.lock[n].variantName===i){this.visboproject.lock.splice(n,1);break}const e=this.translate.instant("vpDetail.msg.removeLockSuccess");this.alertService.success(e)},t=>{if(this.log("Remove VisboProject Lock error: "+t.error.message),403===t.status){const t=this.translate.instant("vpDetail.msg.errorRemoveLockPerm");this.alertService.error(t)}else this.log("Error during remove Lock from VP  "+t.error.message),this.alertService.error(Lh(t))})}getVPVersionsTotal(){let t=this.visboproject.vpvCount||0;return this.visboproject.variant&&this.visboproject.variant.forEach(e=>t+=e.vpvCount||0),t}sortUserTable(t){this.vgUsers&&(void 0===t&&void 0!==this.sortUserColumn||(t!==this.sortUserColumn&&(this.sortUserColumn=t,this.sortUserAscending=void 0),this.sortUserAscending=void 0===this.sortUserAscending?1===t||2===t:!this.sortUserAscending),1===this.sortUserColumn?this.vgUsers.sort((function(t,e){return xh(t.email,e.email)})):2===this.sortUserColumn&&this.vgUsers.sort((function(t,e){return xh(t.groupName.toLowerCase(),e.groupName.toLowerCase())})),this.sortUserAscending||this.vgUsers.reverse())}sortGroupTable(t){this.vgGroups&&(void 0===t&&void 0!==this.sortGroupColumn||(t!==this.sortGroupColumn&&(this.sortGroupColumn=t,this.sortGroupAscending=void 0),this.sortGroupAscending=void 0===this.sortGroupAscending?1===t:!this.sortGroupAscending),1===this.sortGroupColumn?this.vgGroups.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortGroupColumn&&this.vgGroups.sort((function(t,e){return e.users.length-t.users.length})),this.sortGroupAscending||this.vgGroups.reverse())}sortVariantTable(t){if(!this.visboproject.variant)return;const e=this.visboproject.variant;void 0===t&&void 0!==this.sortVariantColumn||(t!==this.sortVariantColumn&&(this.sortVariantColumn=t,this.sortVariantAscending=void 0),this.sortVariantAscending=void 0===this.sortVariantAscending?1===t||2===t:!this.sortVariantAscending),1===this.sortVariantColumn?e.sort((function(t,e){return xh(t.variantName.toLowerCase(),e.variantName.toLowerCase())})):2===this.sortVariantColumn?e.sort((function(t,e){return xh(t.email.toLowerCase(),e.email.toLowerCase())})):3===this.sortVariantColumn?e.sort((function(t,e){return Th(t.createdAt,e.createdAt)})):4===this.sortVariantColumn&&e.sort((function(t,e){return e.vpvCount-t.vpvCount})),this.sortVariantAscending||e.reverse()}log(t){this.messageService.add("VisboProjectDetail: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(Fg),Rs(fb),Rs(Xl),Rs(rf),Rs(Df),Rs(ov),Rs(Md))},t.\u0275cmp=le({type:t,selectors:[["app-visboproject-detail"]],inputs:{visboproject:"visboproject"},decls:2,vars:1,consts:[[4,"ngIf"],[3,"click"],[3,"click",4,"ngIf"],[1,"form-group","row"],["for","vpName",1,"col-3","col-md-2","col-form-label"],["id","VPName","type","text","name","vpName","class","col-sm-8 form-control","placeholder","Name",3,"ngModel","ngModelChange",4,"ngIf"],["id","VPName","class","col-8 form-control-static",4,"ngIf"],["class","form-group row",4,"ngIf"],["for","vpType",1,"col-3","col-md-2","col-form-label"],["name","vpType",1,"col","form-control-static","col-form-label"],[1,"form-group","row","d-none","d-md-block"],["for","Created",1,"col-3","col-md-2","col-form-label"],["id","VPCreated",1,"col-4","form-control-static","col-form-label"],["id","VPUpdated",1,"col-4","form-control-static","col-form-label"],[1,"mb-3"],["id","Save","class","btn btn-primary mr-1",3,"click",4,"ngIf"],["id","Save","class","btn btn-primary mx-1",3,"click",4,"ngIf"],["id","DeleteVP","class","btn bg-warning mx-1","style","float: right","data-toggle","modal","data-target","#VpDelete",3,"title",4,"ngIf"],["id","DestroyVP","class","btn bg-danger text-white mx-1","style","float: right","data-toggle","modal","data-target","#VpDelete",3,"title",4,"ngIf"],["id","VpUserModalCreate","tabindex","-1","role","dialog","aria-labelledby","VpUserModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VpUserModalCenterTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["name","newUserInvite","novalidate",""],["f1","ngForm"],[1,"form-group",3,"ngClass"],["for","email",1,"col-form-label"],["id","AddUserName","type","email","name","email","required","","pattern","[^@\\s]+@[^@\\s]+\\.[^@\\s]+","autocomplete","email",1,"form-control",3,"ngModel","ngModelChange"],["email","ngModel"],["class","help-block",4,"ngIf"],["for","group",1,"col-form-label"],["id","AddUserGroupName","name","group","required","",1,"form-control",3,"ngModel","ngModelChange"],["group","ngModel"],[4,"ngFor","ngForOf"],["for","inviteMessage",1,"col-form-label"],["id","AddUserMessage","name","inviteMessage",1,"form-control",3,"ngModel","ngModelChange"],["inviteMessage","ngModel"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary","mx-1"],["id","AddUserConfirm","type","submit","class","btn btn-primary mx-1",4,"ngIf"],["id","AddUserConfirm","type","submit","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","VpUserRemove","tabindex","-1","role","dialog","aria-labelledby","Remove User","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-dialog-centered","role","document",4,"ngIf"],["id","VpGroupModalCreate","tabindex","-1","role","dialog","aria-labelledby","VpGroupModalCreateTitle","aria-hidden","true",1,"modal","fade"],["class","modal-content",4,"ngIf"],["id","VpGroupRemove","tabindex","-1","role","dialog","aria-labelledby","VpGroupModalRemoveTitle","aria-hidden","true",1,"modal","fade"],["id","VpDelete","tabindex","-1","role","dialog","aria-labelledby","Delete Project","aria-hidden","true",1,"modal","fade"],["id","VpDeleteTitle",1,"modal-title"],["class","bg-warning",4,"ngIf"],["class","bg-danger text-white",4,"ngIf"],[1,"form-group"],["for","VpName",1,"col-form-label"],[1,"col-8","form-control-static"],["for","VpDescription",1,"col-form-label"],["for","VpVersions",1,"col-form-label"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["id","DeleteVPConfirm","type","button","class","btn btn-warning text-white","data-dismiss","modal",3,"click",4,"ngIf"],["id","DeleteVPConfirm","type","button","class","btn btn-danger text-white","data-dismiss","modal",3,"click",4,"ngIf"],["class","modal fade","id","VPUserDetail","tabindex","-1","role","dialog","aria-labelledby","VPUserDetailTitle","aria-hidden","true",4,"ngIf"],["id","VpVariantModalCreate","tabindex","-1","role","dialog","aria-labelledby","VpVariantModalCreateTitle","aria-hidden","true",1,"modal","fade"],["id","VpVariantModalCreateTitle",1,"modal-title"],["name","newVariant","novalidate",""],["f3","ngForm"],["for","variant",1,"col-form-label"],["id","AddVariant","type","text","name","variant","required","",1,"form-control",3,"ngModel","ngModelChange"],["variant","ngModel"],["id","AddVariantConfirm","type","submit","class","btn btn-primary mx-1",4,"ngIf"],["id","AddVariantConfirm","type","submit","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","VpVariantRemove","tabindex","-1","role","dialog","aria-labelledby","Remove Variant","aria-hidden","true",1,"modal","fade"],["id","VPName","type","text","name","vpName","placeholder","Name",1,"col-sm-8","form-control",3,"ngModel","ngModelChange"],["id","VPName",1,"col-8","form-control-static"],["for","vpDescription",1,"col-3","col-md-2","col-form-label"],["id","VPDesc","name","vpDescription","class","col-8 form-control","placeholder","Type in your description",3,"ngModel","ngModelChange",4,"ngIf"],["id","VPDesc","class","col-8 form-control-static",4,"ngIf"],["id","VPDesc","name","vpDescription","placeholder","Type in your description",1,"col-8","form-control",3,"ngModel","ngModelChange"],["id","VPDesc",1,"col-8","form-control-static"],["for","vpVersion",1,"col-3","col-md-2","col-form-label"],["name","vpVersion",1,"col","form-control-static","col-form-label"],[1,"btn-toolbar"],["id","ViewAudit","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["id","ViewGroup","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["id","ViewUser","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["id","ViewRestrictUser","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["id","ViewVariant","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["id","ViewLock","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["lockIndicator",""],["id","ViewAudit","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["id","ViewGroup","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["id","ViewUser","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["id","ViewRestrictUser","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["id","ViewVariant","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["id","ViewLock","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],[1,"row"],[1,"col"],[1,"panel-heading","mt-3"],["class","col",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover"],["id","UserHead"],[1,"d-none","d-md-table-cell"],["id","UserList"],["id","AddUser","type","button","data-toggle","modal","data-target","#VpUserModalCreate",1,"my-1","btn","btn-primary","float-right"],["id","ColUser","data-toggle","modal","data-target","#VPUserDetail",3,"click"],["id","ColGroup",3,"click"],["id","ColDeleteUser","data-toggle","modal","data-target","#VpUserRemove",1,"Detail",3,"title","click"],["id","GroupHead"],["id","GroupList"],["id","AddGroup","type","button","data-toggle","modal","data-target","#VpGroupModalCreate",1,"btn","btn-primary","float-right",3,"click"],["id","ColGroup","data-toggle","modal","data-target","#VpGroupModalCreate",3,"click"],["id","ColMembers",3,"click"],["id","ColGlobal","class","d-none d-md-table-cell",4,"ngIf"],["id","ColDetail","data-toggle","modal","data-target","#VpGroupModalCreate",1,"Detail",3,"title","click"],["id","ColGlobal",1,"d-none","d-md-table-cell"],["id","ColDeleteGroup","data-toggle","modal","data-target","#VpGroupRemove",1,"Detail",3,"title","click"],["id","VariantHead"],[1,"d-none","d-md-table-cell",3,"click"],["id","VariantList"],["id","AddVariant","type","button","data-toggle","modal","data-target","#VpVariantModalCreate",1,"my-1","btn","btn-primary","float-right"],["id","ColName"],["id","ColEmail"],[1,"d-none","d-md-table-cell",3,"title"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["id","ColDeleteVariant","class","Detail","data-toggle","modal","data-target","#VpVariantRemove",3,"title","click",4,"ngIf"],["id","ColDeleteVariant","data-toggle","modal","data-target","#VpVariantRemove",1,"Detail",3,"title","click"],[1,"fa",3,"ngClass"],[1,"row","mt-2"],[1,"panel-heading"],["data-toggle","modal","data-target","#VpUnlock",1,"btn","btn-md",3,"title","click"],["id","Save",1,"btn","btn-primary","mr-1",3,"click"],["id","Save",1,"btn","btn-primary","mx-1",3,"click"],["id","DeleteVP","data-toggle","modal","data-target","#VpDelete",1,"btn","bg-warning","mx-1",2,"float","right",3,"title"],["id","DestroyVP","data-toggle","modal","data-target","#VpDelete",1,"btn","bg-danger","text-white","mx-1",2,"float","right",3,"title"],[1,"help-block"],["id","AddUserConfirm","type","submit",1,"btn","btn-primary","mx-1"],["id","AddUserConfirm","type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["id","VpUserRemoveTitle",1,"modal-title"],[1,"bg-warning"],[1,"col-form-label"],["id","DeleteUserConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning",3,"click"],["class","modal-title","id","VpGroupModalCenterTitle",4,"ngIf"],["name","actGroup","novalidate",""],["f2","ngForm"],["class","form-group",4,"ngIf"],["class","form-group",3,"ngClass",4,"ngIf"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","permVP0","name","checkedVPViewRestricted",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPViewRestricted","ngModel"],["for","permVP0",1,"custom-control-label"],["type","checkbox","id","permVP1","name","checkedVPView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPView","ngModel"],["for","permVP1",1,"custom-control-label"],["type","checkbox","id","permVP2","name","checkedVPViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPViewAudit","ngModel"],["for","permVP2",1,"custom-control-label"],["type","checkbox","id","permVP3","name","checkedVPModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPModify","ngModel"],["for","permVP3",1,"custom-control-label"],["type","checkbox","id","permVP4","name","checkedCreateVariant",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVariant","ngModel"],["for","permVP4",1,"custom-control-label"],["type","checkbox","id","permVP5","name","checkedVPManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPManagePerm","ngModel"],["for","permVP5",1,"custom-control-label"],["type","checkbox","id","permVP6","name","checkedVPDelete",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPDelete","ngModel"],["for","permVP6",1,"custom-control-label"],["class","mt-2",4,"ngIf"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-secondary","mx-1"],["id","VpGroupModalCenterTitle",1,"modal-title"],["for","name",1,"col-form-label"],["for","groupName",1,"col-form-label"],["id","AddGroupName","type","text","name","groupName","required","",1,"form-control",3,"ngModel","ngModelChange"],["groupName","ngModel"],[1,"mt-2"],[1,"form-control-static"],["class","row",4,"ngFor","ngForOf"],["class","col-8 ml-3",4,"ngIf"],[1,"col-8","ml-3"],["data-dismiss","modal",3,"click"],["id","AddGroupConfirm","type","submit","class","btn btn-primary disabled mx-1",4,"ngIf"],["id","AddGroupConfirm","type","submit","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","AddGroupConfirm","type","submit",1,"btn","btn-primary","disabled","mx-1"],["id","AddGroupConfirm","type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["for","VcName",1,"col-form-label"],["id","DeleteGroupConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning",3,"click"],[1,"bg-danger","text-white"],["id","DeleteVPConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning","text-white",3,"click"],["id","DeleteVPConfirm","type","button","data-dismiss","modal",1,"btn","btn-danger","text-white",3,"click"],["id","VPUserDetail","tabindex","-1","role","dialog","aria-labelledby","VPUserDetailTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],["id","VPUserDetailTitle",1,"modal-title"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP0","name","checkedViewRestricted",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP0","name","checkedViewRestricted",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],[1,"form-control-static","mt-2"],["data-dismiss","modal",1,"btn","btn-primary"],["type","checkbox","checked","","disabled","","id","permVP0","name","checkedViewRestricted",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP0","name","checkedViewRestricted",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["id","AddVariantConfirm","type","submit",1,"btn","btn-primary","mx-1"],["id","AddVariantConfirm","type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["id","VpVariantRemoveTitle",1,"modal-title"],[1,"col-sm-4","col-form-label"],[1,"col-sm-8","form-control-static"],["id","DeleteVariantConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning",3,"click"]],template:function(t,e){1&t&&(Bs(0,"app-usernavbar"),Gs(1,Ek,164,117,"div",0)),2&t&&(_n(1),js("ngIf",e.visboproject))},directives:[bb,jc,Ou,Fd,Tu,Oc,Od,Ru,Hu,Nd,Eu,cu,du,gu,Lc,Bc,_d],pipes:[av,Kc,qc],styles:[""]}),t})();function Gk(t,e){1&t&&(Ns(0,"h2"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),vo(" ",Ea(2,1,"vpv.title")," "))}function Lk(t,e){if(1&t){const t=zs();Ns(0,"h2"),mo(1),Ua(2,"translate"),Ns(3,"button",18),Js("click",(function(){ei(t);const e=Xs();return e.gotoVPDetail(e.vpActive)})),mo(4),Fs(),Fs()}if(2&t){const t=Xs();_n(1),vo(" ",Ea(2,2,"vpv.titleVP"),": "),_n(3),vo(" ",t.vpActive.name," ")}}function Rk(t,e){if(1&t){const t=zs();Ns(0,"button",21),Js("click",(function(){return ei(t),Xs(2).toggleVisboProjectVersions()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpv.btn.deleted")))}function jk(t,e){if(1&t){const t=zs();Ns(0,"button",21),Js("click",(function(){return ei(t),Xs(2).toggleVisboProjectVersions()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpv.btn.undeleted")))}function $k(t,e){if(1&t&&(Ns(0,"div",19),Gs(1,Rk,3,3,"button",20),Gs(2,jk,3,3,"button",20),Fs()),2&t){const t=Xs();_n(1),js("ngIf",!t.deleted),_n(1),js("ngIf",t.deleted)}}function Nk(t,e){if(1&t){const t=zs();Ns(0,"th",9),Js("click",(function(){return ei(t),Xs().sortVPVTable(3)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpv.lbl.trafficlight")))}function Fk(t,e){1&t&&(Ns(0,"th"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpv.lbl.delete")))}function Bk(t,e){1&t&&qs(0)}const Hk=function(t){return{level:t}};function Kk(t,e){if(1&t&&(Ns(0,"td"),Gs(1,Bk,1,0,"ng-container",26),Fs()),2&t){const t=Xs().$implicit;Xs();const e=Ls(35);_n(1),js("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(2,Hk,t.ampelStatus))}}function qk(t,e){if(1&t){const t=zs();Ns(0,"button",27),Js("click",(function(){ei(t);const e=Xs().index;return Xs().helperSetVPV(e)})),Ua(1,"translate"),mo(2,"\xd7"),Fs()}2&t&&to("title",Ea(1,1,"vpv.lbl.deleteVersion"))}function zk(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td",8),mo(2),Fs(),Ns(3,"td",22),Js("click",(function(){ei(t);const i=e.index;return Xs().helperSetVPV(i)})),Ua(4,"date"),mo(5),Ua(6,"date"),Fs(),Ns(7,"td",23),Js("click",(function(){ei(t);const i=e.index;return Xs().helperSetVPV(i)})),mo(8),Fs(),Ns(9,"td",23),Js("click",(function(){ei(t);const i=e.index;return Xs().helperSetVPV(i)})),mo(10),Ua(11,"date"),Fs(),Gs(12,Kk,2,4,"td",4),Ns(13,"td",24),Js("click",(function(){ei(t);const i=e.index;return Xs().helperSetVPV(i)})),mo(14),Fs(),Ns(15,"td",23),Js("click",(function(){ei(t);const i=e.index;return Xs().helperSetVPV(i)})),Ns(16,"span"),mo(17),Fs(),Fs(),Ns(18,"td"),Gs(19,qk,3,3,"button",25),Fs(),Fs()}if(2&t){const t=e.$implicit,i=e.index,n=Xs();_n(2),fo(i+1),_n(1),to("title",Oa(4,9,t.timestamp,"dd.MM.yyyy HH:mm")),_n(2),fo(Oa(6,12,t.timestamp,"dd.MM.yy")),_n(3),fo(t.status),_n(2),fo(Oa(11,15,t.endDate,"dd.MM.yy")),_n(2),js("ngIf",n.hasVPPerm(n.permVP.ViewAudit)),_n(2),fo(t.variantName),_n(3),fo(n.checkLocked(t)),_n(2),js("ngIf",n.hasVPPerm(n.permVP.DeleteVP)&&!n.checkLocked(t,!0))}}const Qk=function(t,e,i,n,r){return{"fas fa-lightbulb":t,"text-secondary":e,"text-success":i,"text-warning":n,"text-danger":r}};function Wk(t,e){if(1&t&&Bs(0,"i",28),2&t){const t=e.level;js("ngClass",function(t,e,i,n,r,s,o,a){const l=li()+1,c=Xe(),d=Ts(c,l,i,n,r,s);return Ss(c,l+4,o)||d?Ds(c,l+5,e(i,n,r,s,o)):Ms(c,l+5)}(0,Qk,t>=0,0==t,1==t,2==t,3==t))}}function Jk(t,e){if(1&t&&(Ns(0,"div",37),Ns(1,"label",46),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",39),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vpv.lbl.variantName"),":"),_n(3),vo("",t.visboprojectversion.variantName," ")}}function Yk(t,e){if(1&t){const t=zs();Ns(0,"button",47),Js("click",(function(){return ei(t),Xs(2).restore()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpv.btn.restore")))}function Zk(t,e){if(1&t&&(Ns(0,"div",29),Ns(1,"div",30),Ns(2,"div",31),Ns(3,"div",32),Ns(4,"h5",33),mo(5),Ua(6,"translate"),Fs(),Ns(7,"button",34),Ns(8,"span",35),mo(9,"\xd7"),Fs(),Fs(),Fs(),Ns(10,"div",36),Ns(11,"form"),Ns(12,"div",37),Ns(13,"label",38),mo(14),Ua(15,"translate"),Fs(),Ns(16,"label",39),mo(17),Fs(),Fs(),Ns(18,"div",37),Ns(19,"label",40),mo(20),Ua(21,"translate"),Fs(),Ns(22,"label",39),mo(23),Ua(24,"date"),Fs(),Fs(),Ns(25,"div",37),Ns(26,"label",41),mo(27),Ua(28,"translate"),Fs(),Ns(29,"label",39),mo(30),Ua(31,"date"),Fs(),Fs(),Gs(32,Jk,6,4,"div",42),Fs(),Fs(),Ns(33,"div",43),Ns(34,"button",44),mo(35),Ua(36,"translate"),Fs(),Gs(37,Yk,3,3,"button",45),Fs(),Fs(),Fs(),Fs()),2&t){const t=Xs();_n(5),fo(Ea(6,10,"vpv.titleDetailVPV")),_n(9),vo("",Ea(15,12,"vpv.lbl.name"),":"),_n(3),vo("",t.visboprojectversion.name," "),_n(3),vo("",Ea(21,14,"vpv.lbl.timestamp"),":"),_n(3),vo("",Oa(24,16,t.visboprojectversion.timestamp,"dd.MM.yyyy HH:mm:ss")," "),_n(4),vo("",Ea(28,19,"vpv.lbl.updatedAt"),":"),_n(3),vo("",Oa(31,21,t.visboprojectversion.updatedAt,"dd.MM.yyyy HH:mm:ss")," "),_n(2),js("ngIf",t.visboprojectversion.variantName),_n(3),fo(Ea(36,24,"vpv.btn.back")),_n(2),js("ngIf",t.deleted&&t.hasVPPerm(t.permVP.DeleteVP))}}function Xk(t,e){1&t&&(Ns(0,"label",53),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpv.msg.confirmDelete")))}function tD(t,e){1&t&&(Ns(0,"label",54),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpv.msg.confirmDestroy")))}function eD(t,e){if(1&t){const t=zs();Ns(0,"button",55),Js("click",(function(){ei(t);const e=Xs(2);return e.delete(e.visboprojectversion)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpv.btn.delete")))}function iD(t,e){if(1&t){const t=zs();Ns(0,"button",56),Js("click",(function(){ei(t);const e=Xs(2);return e.delete(e.visboprojectversion)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpv.btn.destroy")))}function nD(t,e){if(1&t&&(Ns(0,"div",48),Ns(1,"div",30),Ns(2,"div",31),Ns(3,"div",32),Ns(4,"h5",33),mo(5),Ua(6,"translate"),Fs(),Ns(7,"button",34),Ns(8,"span",35),mo(9,"\xd7"),Fs(),Fs(),Fs(),Ns(10,"div",36),Ns(11,"div"),Gs(12,Xk,3,3,"label",49),Gs(13,tD,3,3,"label",50),Fs(),Ns(14,"form"),Ns(15,"div",37),Ns(16,"label",38),mo(17),Ua(18,"translate"),Fs(),Ns(19,"label",39),mo(20),Fs(),Fs(),Ns(21,"div",37),Ns(22,"label",40),mo(23),Ua(24,"translate"),Fs(),Ns(25,"label",39),mo(26),Ua(27,"date"),Fs(),Fs(),Ns(28,"div",37),Ns(29,"label",40),mo(30),Ua(31,"translate"),Fs(),Ns(32,"label",39),mo(33),Ua(34,"date"),Fs(),Fs(),Fs(),Fs(),Ns(35,"div",43),Ns(36,"button",44),mo(37),Ua(38,"translate"),Fs(),Gs(39,eD,3,3,"button",51),Gs(40,iD,3,3,"button",52),Fs(),Fs(),Fs(),Fs()),2&t){const t=Xs();_n(5),fo(Ea(6,12,"vpv.titleDeleteVPV")),_n(7),js("ngIf",!t.deleted),_n(1),js("ngIf",t.deleted),_n(4),vo("",Ea(18,14,"vpv.lbl.name"),":"),_n(3),vo("",t.visboprojectversion.name," "),_n(3),vo("",Ea(24,16,"vpv.lbl.timestamp"),":"),_n(3),vo("",Oa(27,18,t.visboprojectversion.timestamp,"dd.MM.yyyy HH:mm:ss")," "),_n(4),vo("",Ea(31,21,"vpv.lbl.updatedAt"),":"),_n(3),vo("",Oa(34,23,t.visboprojectversion.updatedAt,"dd.MM.yyyy HH:mm:ss")," "),_n(4),fo(Ea(38,26,"vpv.btn.cancel")),_n(2),js("ngIf",!t.deleted),_n(1),js("ngIf",t.deleted)}}let rD=(()=>{class t{constructor(t,e,i,n,r,s,o){this.visboprojectversionService=t,this.visboprojectService=e,this.messageService=i,this.alertService=n,this.route=r,this.router=s,this.translate=o,this.deleted=!1,this.combinedPerm=void 0,this.permVC=Av,this.permVP=Pv}ngOnInit(){this.getVisboProjectVersions()}hasVPPerm(t){return void 0!==this.combinedPerm&&0!=(this.combinedPerm.vp&t)}getVisboProjectVersions(){const t=this.route.snapshot.paramMap.get("id");this.vpSelected=t,this.log("get VP name if ID is used "+t),t?this.visboprojectService.getVisboProject(t).subscribe(e=>{this.vpActive=e,this.combinedPerm=e.perm,this.log(`get VP name if ID is used ${this.vpActive.name} Perm ${JSON.stringify(this.combinedPerm)}`),this.visboprojectversionService.getVisboProjectVersions(t,this.deleted).subscribe(t=>this.visboprojectversions=t,t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpv.msg.errorPermVersion",{name:this.vpActive.name});this.alertService.error(t)}else this.alertService.error(Lh(t))})},t=>{if(this.log(`get VPV VP failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpv.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Lh(t))}):(this.vpSelected=null,this.vpActive=null,this.visboprojectversionService.getVisboProjectVersions(null).subscribe(t=>this.visboprojectversions=t,t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpv.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Lh(t))}))}toggleVisboProjectVersions(){this.deleted=!this.deleted;const t=this.route.snapshot.url.join("/");this.log(`VP toggleVisboProjectVersions ${this.deleted} URL ${t}`),this.getVisboProjectVersions(),this.router.navigate([t],this.deleted?{queryParams:{deleted:this.deleted}}:{})}checkLocked(t,e=!1){const i=t.variantName||"",n=this.vpActive.lock.find(t=>t.variantName===i);let r=void 0;return n&&(r=e?JSON.parse(localStorage.getItem("currentUser")).email!=n.email?n.email:void 0:n.email),r}helperSetVPV(t){this.visboprojectversion=this.visboprojectversions[t]}delete(t){this.log("delete VPV "+t._id),this.visboprojectversionService.deleteVisboProjectVersion(t,this.deleted).subscribe(()=>{this.alertService.success(`Visbo Project Version ${t._id} deleted successfully`,!0),this.log("delete VPV success");const e=this.visboprojectversions.findIndex(e=>e._id===t._id);e>=0&&this.visboprojectversions.splice(e,1)},e=>{if(this.log(`delete VPV failed: error: ${e.status} message: ${e.error.message}`),403===e.status){const e=this.translate.instant("vpv.msg.errorPermDelete",{name:t.name});this.alertService.error(e)}else if(423===e.status){const e=this.translate.instant("vpv.msg.errorLocked",{name:t.name});this.alertService.error(e)}else this.alertService.error(Lh(e))})}restore(){this.log("update VPV "+this.visboprojectversion._id),this.visboprojectversionService.updateVisboProjectVersion(this.visboprojectversion,this.deleted).subscribe(t=>{this.alertService.success(`Visbo Project Version ${t.name} updated successfully`,!0);const e=this.visboprojectversions.findIndex(e=>e._id===t._id);e>=0&&this.visboprojectversions.splice(e,1)},t=>{if(this.log(`save VPV failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpv.msg.errorPermVersion",{name:this.visboprojectversion.name});this.alertService.error(t)}else if(409===t.status){const t=this.translate.instant("vpv.msg.errorConflict",{name:this.visboprojectversion._id});this.alertService.error(t)}else this.alertService.error(t.error.message)})}gotoVPDetail(t){this.router.navigate(["vpDetail/".concat(t._id)])}sortVPVTable(t){this.visboprojectversions&&(void 0!==t&&(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?5===t:!this.sortAscending),1===this.sortColumn?this.visboprojectversions.sort((function(t,e){return Th(t.timestamp,e.timestamp)})):2===this.sortColumn?this.visboprojectversions.sort((function(t,e){return Th(t.endDate,e.endDate)})):3===this.sortColumn?this.visboprojectversions.sort((function(t,e){return t.ampelStatus-e.ampelStatus})):4===this.sortColumn?this.visboprojectversions.sort((function(t,e){return t.Erloes-e.Erloes})):5===this.sortColumn&&this.visboprojectversions.sort((function(t,e){return xh(t.variantName.toLowerCase(),e.variantName.toLowerCase())})),this.sortAscending||this.visboprojectversions.reverse())}log(t){this.messageService.add("VisboProjectVersion: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(wV),Rs(fb),Rs(Rh),Rs(Df),Rs(Fg),Rs(rf),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-visboprojectversions"]],decls:38,vars:26,consts:[[1,"well"],[1,"container"],[1,"row"],[1,"col"],[4,"ngIf"],["class","btn-group ",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[1,"d-none","d-md-table-cell"],[3,"click"],[1,"d-none","d-lg-table-cell"],[1,"d-none","d-lg-table-cell",3,"click"],[3,"click",4,"ngIf"],[1,"d-none","d-md-table-cell",3,"click"],[4,"ngFor","ngForOf"],["trafficLight",""],["class","modal fade","id","VpvDetails","tabindex","-1","role","dialog","aria-labelledby","Details Project Version","aria-hidden","true",4,"ngIf"],["class","modal fade","id","VpvDelete","tabindex","-1","role","dialog","aria-labelledby","Delete Project Version","aria-hidden","true",4,"ngIf"],[1,"panel-heading","bg-white","btn-white",3,"click"],[1,"btn-group"],["class","btn btn-sm btn-secondary m-2",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-secondary","m-2",3,"click"],["data-toggle","modal","data-target","#VpvDetails",3,"title","click"],["data-toggle","modal","data-target","#VpvDetails",1,"d-none","d-lg-table-cell",3,"click"],["data-toggle","modal","data-target","#VpvDetails",1,"d-none","d-md-table-cell",3,"click"],["id","ColDeleteVPV","class","Detail","data-toggle","modal","data-target","#VpvDelete",3,"title","click",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["id","ColDeleteVPV","data-toggle","modal","data-target","#VpvDelete",1,"Detail",3,"title","click"],[3,"ngClass"],["id","VpvDetails","tabindex","-1","role","dialog","aria-labelledby","Details Project Version","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VpvDeleteTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group","row"],["for","VpvName",1,"col-sm-4","col-form-label"],[1,"col-sm-8","form-control-static"],["for","VpvVersions",1,"col-sm-4","col-form-label"],["for","VpvUpdated",1,"col-sm-4","col-form-label"],["class","form-group row",4,"ngIf"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["class","btn btn-primary","data-dismiss","modal",3,"click",4,"ngIf"],["for","VpvVariant",1,"col-sm-4","col-form-label"],["data-dismiss","modal",1,"btn","btn-primary",3,"click"],["id","VpvDelete","tabindex","-1","role","dialog","aria-labelledby","Delete Project Version","aria-hidden","true",1,"modal","fade"],["class","bg-warning",4,"ngIf"],["class","bg-danger text-white",4,"ngIf"],["type","button","class","btn btn-warning text-white","data-dismiss","modal",3,"click",4,"ngIf"],["type","button","class","btn btn-danger text-white","data-dismiss","modal",3,"click",4,"ngIf"],[1,"bg-warning"],[1,"bg-danger","text-white"],["type","button","data-dismiss","modal",1,"btn","btn-warning","text-white",3,"click"],["type","button","data-dismiss","modal",1,"btn","btn-danger","text-white",3,"click"]],template:function(t,e){1&t&&(Bs(0,"app-usernavbar"),Ns(1,"div",0),Ns(2,"div",1),Ns(3,"div",2),Ns(4,"div",3),Gs(5,Gk,3,3,"h2",4),Gs(6,Lk,5,4,"h2",4),Fs(),Gs(7,$k,3,2,"div",5),Fs(),Fs(),Ns(8,"div",6),Ns(9,"table",7),Ns(10,"thead"),Ns(11,"tr"),Ns(12,"th",8),mo(13),Ua(14,"translate"),Fs(),Ns(15,"th",9),Js("click",(function(){return e.sortVPVTable(1)})),mo(16),Ua(17,"translate"),Fs(),Ns(18,"th",10),mo(19),Ua(20,"translate"),Fs(),Ns(21,"th",11),Js("click",(function(){return e.sortVPVTable(2)})),mo(22),Ua(23,"translate"),Fs(),Gs(24,Nk,3,3,"th",12),Ns(25,"th",13),Js("click",(function(){return e.sortVPVTable(5)})),mo(26),Ua(27,"translate"),Fs(),Ns(28,"th",10),mo(29),Ua(30,"translate"),Fs(),Gs(31,Fk,3,3,"th",4),Fs(),Fs(),Ns(32,"tbody"),Gs(33,zk,20,18,"tr",14),Fs(),Fs(),Fs(),Fs(),Gs(34,Wk,1,7,"ng-template",null,15,ja),Gs(36,Zk,38,26,"div",16),Gs(37,nD,41,28,"div",17)),2&t&&(_n(5),js("ngIf",!e.vpActive),_n(1),js("ngIf",e.vpActive),_n(1),js("ngIf",e.hasVPPerm(e.permVP.DeleteVP)),_n(6),fo(Ea(14,14,"vpv.lbl.nr")),_n(3),fo(Ea(17,16,"vpv.lbl.timestamp")),_n(3),fo(Ea(20,18,"vpv.lbl.status")),_n(3),fo(Ea(23,20,"vpv.lbl.endDate")),_n(2),js("ngIf",e.hasVPPerm(e.permVP.ViewAudit)),_n(2),fo(Ea(27,22,"vpv.lbl.variant")),_n(3),fo(Ea(30,24,"vpv.lbl.locked")),_n(2),js("ngIf",e.hasVPPerm(e.permVP.DeleteVP)),_n(2),js("ngForOf",e.visboprojectversions),_n(3),js("ngIf",e.visboprojectversion),_n(1),js("ngIf",e.visboprojectversion))},directives:[bb,jc,Lc,Bc,Oc,Ou,Fd,Tu],pipes:[av,qc],encapsulation:2}),t})();function sD(t,e){if(1&t&&(Ns(0,"span",21),mo(1),Fs()),2&t){const t=Xs(2);_n(1),vo(" (",t.vpfActive.variantName,")")}}function oD(t,e){if(1&t){const t=zs();Ns(0,"a",26),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(3).switchPFVersion(i.version)})),mo(1),Fs()}if(2&t){const t=e.$implicit;_n(1),fo(t.name)}}function aD(t,e){if(1&t&&(Ns(0,"span",22),Bs(1,"a",23),Ns(2,"div",24),Gs(3,oD,2,1,"a",25),Fs(),Fs()),2&t){const t=Xs(2);_n(3),js("ngForOf",t.dropDown)}}function lD(t,e){if(1&t){const t=zs();Ns(0,"a",18),Js("click",(function(){ei(t);const e=Xs(3);return e.gotoVC(e.vpActive)})),mo(1),Fs()}if(2&t){const t=Xs(3);_n(1),fo(t.vpActive.vc.name)}}function cD(t,e){if(1&t&&(Ns(0,"span"),mo(1),Fs()),2&t){const t=Xs(3);_n(1),fo(t.vpActive.vc.name)}}function dD(t,e){if(1&t&&(Ns(0,"h5"),mo(1),Ua(2,"translate"),Gs(3,lD,2,1,"a",27),Gs(4,cD,2,1,"span",16),Fs()),2&t){const t=Xs(2);_n(1),vo("",Ea(2,3,"vpfVersion.titleVC"),": "),_n(2),js("ngIf",t.hasVCPerm(t.permVC.View)),_n(1),js("ngIf",!t.hasVCPerm(t.permVC.View))}}function uD(t,e){if(1&t){const t=zs();Ns(0,"div",3),Ns(1,"div",17),Ns(2,"h2"),mo(3),Ua(4,"translate"),Ns(5,"a",18),Js("click",(function(){ei(t);const e=Xs();return e.gotoVPDetail(e.vpActive)})),mo(6),Fs(),Gs(7,sD,2,1,"span",19),Gs(8,aD,4,1,"span",20),Fs(),Gs(9,dD,5,5,"h5",16),Fs(),Fs()}if(2&t){const t=Xs();_n(3),vo(" ",Ea(4,5,"vpfVersion.title"),": "),_n(3),vo(" ",t.vpActive.name,""),_n(1),js("ngIf",t.vpfActive.variantName),_n(1),js("ngIf",t.dropDown.length>1),_n(1),js("ngIf",t.vpActive)}}const hD=function(t){return{refDate:t}};function pD(t,e){if(1&t){const t=zs();Ns(0,"span",28),Js("click",(function(){return ei(t),Xs().getNextVersion(-1)})),Ua(1,"translate"),Ua(2,"date"),Fs()}if(2&t){const t=Xs();to("title",Oa(1,1,"vpfVersion.lbl.previousPeriod",ka(7,hD,Oa(2,4,t.vpvRefDate,"dd.MM."))))}}function gD(t,e){if(1&t){const t=zs();Ns(0,"select",29),Js("ngModelChange",(function(e){return ei(t),Xs().refDateInterval=e})),Ns(1,"option",30),mo(2),Ua(3,"translate"),Fs(),Ns(4,"option",31),mo(5),Ua(6,"translate"),Fs(),Ns(7,"option",32),mo(8),Ua(9,"translate"),Fs(),Ns(10,"option",33),mo(11),Ua(12,"translate"),Fs(),Fs()}2&t&&(js("ngModel",Xs().refDateInterval),_n(2),fo(Ea(3,5,"vpfVersion.lbl.day")),_n(3),fo(Ea(6,7,"vpfVersion.lbl.week")),_n(3),fo(Ea(9,9,"vpfVersion.lbl.month")),_n(3),fo(Ea(12,11,"vpfVersion.lbl.quarter")))}function mD(t,e){if(1&t){const t=zs();Ns(0,"span",34),Js("click",(function(){return ei(t),Xs().getNextVersion(1)})),Ua(1,"translate"),Ua(2,"date"),Fs()}if(2&t){const t=Xs();to("title",Oa(1,1,"vpfVersion.lbl.nextPeriod",ka(7,hD,Oa(2,4,t.vpvRefDate,"dd.MM."))))}}function fD(t,e){if(1&t){const t=zs();Ns(0,"button",13),Js("click",(function(){return ei(t),Xs().changeView("Capacity")})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpfVersion.btn.viewCapacity")))}const vD=function(t,e){return{count:t,total:e}};function bD(t,e){if(1&t&&(Ns(0,"div",35),mo(1),Ua(2,"translate"),Fs()),2&t){const t=Xs();_n(1),vo(" ",Oa(2,1,"vpfVersion.msg.warningVersionMismatch",Da(4,vD,t.vpvCount,t.vpList.length))," ")}}function yD(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"hr"),Bs(2,"app-comp-viewcapacity",36),Fs()),2&t){const t=Xs();_n(2),js("vpActive",t.vpActive)("vpfActive",t.vpfActive)("refDate",t.vpvRefDate)("combinedPerm",t.combinedPerm)}}function CD(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"hr"),Bs(2,"app-comp-viewbubble",37),Fs()),2&t){const t=Xs();_n(2),js("bubbleMode",!0)("visboprojectversions",t.visboprojectversions)("combinedPerm",t.combinedPerm)}}function VD(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"hr"),Bs(2,"app-comp-viewbubble",37),Fs()),2&t){const t=Xs();_n(2),js("bubbleMode",!1)("visboprojectversions",t.visboprojectversions)("combinedPerm",t.combinedPerm)}}function wD(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"hr"),Bs(2,"app-comp-viewboard",38),Fs()),2&t){const t=Xs();_n(2),js("vps",t.vpList)}}let AD=(()=>{class t{constructor(t,e,i,n,r,s,o,a,l){this.visboprojectversionService=t,this.visboprojectService=e,this.visbosettingService=i,this.messageService=n,this.alertService=r,this.route=s,this.router=o,this.translate=a,this.titleService=l,this.dropDown=[],this.views=["KeyMetrics","Capacity","ProjectBoard","List"],this.vpvRefDate=new Date,this.refDateInterval="month",this.deleted=!1,this.hasOrga=!1,this.pageParams=new bV,this.combinedPerm=void 0,this.permVC=Av,this.permVP=Pv}ngOnInit(){this.currentLang=this.translate.currentLang,this.titleService.setTitle(this.translate.instant("vpfVersion.title")),this.log("Init VPF with Transaltion: "+this.translate.instant("vpfVersion.title"));const t=this.route.snapshot.queryParams.refDate,e=this.route.snapshot.queryParams.view||"KeyMetrics",i=this.route.snapshot.queryParams.vpfid||void 0;this.vpfid=i,this.vpvRefDate=Date.parse(t)>0?new Date(t):new Date,this.changeView(e,t?this.vpvRefDate:void 0,void 0,i),this.getVisboProject()}ngOnChanges(t){this.log("Portfolio Changes "+JSON.stringify(t))}hasVPPerm(t){var e;return((null===(e=this.combinedPerm)||void 0===e?void 0:e.vp)&t)>0}hasVCPerm(t){var e;let i=!1;return((null===(e=this.combinedPerm)||void 0===e?void 0:e.vc)&t)>0&&(i=!0),i}getVisboProject(){const t=this.route.snapshot.paramMap.get("id");this.vpSelected=t,this.log("get VP name if ID is used "+t),this.visboprojectService.getVisboProject(t).subscribe(t=>{this.vpActive=t,this.deleted=!!t.deletedAt,this.combinedPerm=t.perm,this.titleService.setTitle(this.translate.instant("vpfVersion.titleName",{name:t.name})),this.getVisboPortfolioVersions(),this.getVisboCenterOrga()},t=>{if(this.log(`get Portfolio VP failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpfVersion.msg.errorPermVP");this.alertService.error(t)}else this.alertService.error(Lh(t))})}getVisboCenterOrga(){this.vpActive&&this.combinedPerm&&(this.combinedPerm.vc&this.permVC.View)>0&&(this.log("get VC Orga "+this.vpActive.vcid),this.visbosettingService.getVCOrganisations(this.vpActive.vcid,!1,void 0,!0).subscribe(t=>{this.hasOrga=t.length>0},t=>{if(403===t.status){const t=this.translate.instant("vpfVersion.msg.errorPermVP");this.alertService.error(t)}else this.alertService.error(Lh(t))}))}getVisboPortfolioVersions(){this.log(`get Portfolio Versions ${this.vpActive.name} Perm ${JSON.stringify(this.combinedPerm)}`),this.visboprojectversionService.getVisboPortfolioVersions(this.vpActive._id,this.deleted).subscribe(t=>{this.visboportfolioversions=t;let e=0;this.vpfid&&(e=t.findIndex(t=>t._id.toString()===this.vpfid),e<0&&(e=0)),t.length>0&&(this.vpfActive=t[e],this.dropDownInit(),this.getVisboPortfolioKeyMetrics(),this.log("get VPF Length "+this.visboportfolioversions.length))},t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpfVersion.msg.errorPermVersion",{name:this.vpActive.name});this.alertService.error(t)}else this.alertService.error(Lh(t))})}getVisboPortfolioKeyMetrics(){this.log(`get VPF keyMetrics ${this.vpfActive.name} ${this.vpfActive._id}`),this.visboprojectversionService.getVisboPortfolioKeyMetrics(this.vpfActive._id,this.vpvRefDate).subscribe(t=>{var e;this.visboprojectversions=t,this.calcVPList(),this.log(`get VPF Key metrics: Get ${t.length} Project Versions`),t.length>0&&this.log(`First VPV: ${t[0]._id} ${t[0].timestamp} ${null===(e=t[0].keyMetrics)||void 0===e?void 0:e.endDateCurrent} `),this.evaluateDirection()},t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpfVersion.msg.errorPermVP");this.alertService.error(t)}else this.alertService.error(Lh(t))})}getRefDateVersions(t){this.log(`get getRefDateVersions ${this.vpvRefDate.toISOString()} ${this.refDateInterval} ${t}`);let e=new Date(this.vpvRefDate.getTime()),i=0;switch(this.refDateInterval){case"day":e.setHours(0,0,0,0),(t>0||e.getTime()===this.vpvRefDate.getTime())&&e.setDate(e.getDate()+t);break;case"week":e.setHours(0,0,0,0),e.setDate(e.getDate()+7*t);break;case"month":e.setHours(0,0,0,0),e.setDate(1),(t>0||e.getTime()===this.vpvRefDate.getTime())&&e.setMonth(e.getMonth()+t);break;case"quarter":i=Math.trunc(e.getMonth()/3),t>0&&(i+=t),e.setMonth(3*i),e.setDate(1),e.setHours(0,0,0,0),e.getTime()===this.vpvRefDate.getTime()&&e.setMonth(e.getMonth()+3*t)}const n=new Date;e>n&&(e=n),this.log("get getRefDateVersions "+e.toISOString()),this.vpvRefDate=new Date(e.toISOString()),this.changeView(void 0,this.vpvRefDate,void 0),this.getVisboPortfolioKeyMetrics()}evaluateDirection(){this.statusDirection=0===this.visboprojectversions.length?Oh(this.vpvRefDate,new Date)?void 0:-1:Oh(this.vpvRefDate,new Date)?1:0}changeView(t,e,i,n){t&&(this.views.findIndex(e=>e===t)<0&&(t=this.views[0]),this.pageParams.view=t),i&&(this.pageParams.filter=i.trim()),e&&(this.pageParams.refDate=Eh(e)?void 0:e.toISOString()),n&&(this.pageParams.vpfid=n),this.updateUrlParam()}updateUrlParam(){const t=this.route.snapshot.url.join("/"),e=new bV;e.filter=this.pageParams.filter||null,e.vpfid=this.pageParams.vpfid||null,e.vpfid=this.pageParams.vpfid||null,e.refDate=this.pageParams.refDate||null,e.view=this.pageParams.view||null,this.router.navigate([t],{queryParams:e,replaceUrl:!0,queryParamsHandling:"merge"})}isVersionMismatch(){let t=!1;return this.vpList&&this.vpfActive&&this.vpfActive.allItems?(this.vpfActive.allItems.length!==this.vpvCount&&(t=!0),t):t}calcVPList(){var t;if(this.vpfActive||this.vpfActive.allItems){this.vpList=[],this.vpvCount=0;for(let e=0;e<this.vpfActive.allItems.length;e++){const i=new CV,n=this.vpfActive.allItems[e];i.vpid=n.vpid,i.name=n.name,i.variantName=n.variantName;const r=this.visboprojectversions.findIndex(t=>t.vpid===i.vpid);r>=0&&(i.timestamp=new Date(this.visboprojectversions[r].timestamp),i.startDate=this.visboprojectversions[r].startDate,i.endDate=(null===(t=this.visboprojectversions[r].keyMetrics)||void 0===t?void 0:t.endDateCurrent)||this.visboprojectversions[r].endDate,i.leadPerson=this.visboprojectversions[r].leadPerson,i.VorlagenName=this.visboprojectversions[r].VorlagenName,i.businessUnit=this.visboprojectversions[r].businessUnit,i.status=this.visboprojectversions[r].status,i.ampelStatus=this.visboprojectversions[r].ampelStatus,i.ampelErlaeuterung=this.visboprojectversions[r].ampelErlaeuterung,i.keyMetrics=this.visboprojectversions[r].keyMetrics,this.vpvCount+=1),this.vpList.push(i)}}}getNextVersion(t){this.getRefDateVersions(t),this.changeView(void 0,this.vpvRefDate)}gotoVPDetail(t){const e=!!t.deletedAt;this.log("goto Detail for VP "+t._id),this.router.navigate(["vpDetail/".concat(t._id)],e?{queryParams:{deleted:e}}:{})}gotoVC(t){this.router.navigate(["vp/".concat(t.vcid)])}dropDownInit(){this.log("Init Drop Down List "+this.visboportfolioversions.length),this.dropDown=[];const t=this.visboportfolioversions.length;for(let e=0;e<t;e++){const t=new Date(this.visboportfolioversions[e].timestamp);let i="Version ".concat("from ",_h(new Date(t),"fullDate",this.currentLang));this.visboportfolioversions[e].variantName&&(i=i.concat(" ( ",this.visboportfolioversions[e].variantName," )")),this.dropDown.push({name:i,version:e,timestamp:t})}this.dropDown.sort((function(t,e){return e.timestamp.getTime()-t.timestamp.getTime()})),t>0&&(this.dropDownSelected=this.dropDown[0].name)}switchPFVersion(t){this.log(`Change Drop Down ${t} `),this.vpfActive=this.visboportfolioversions[t],this.getVisboPortfolioKeyMetrics(),this.changeView(void 0,void 0,void 0,this.vpfActive._id)}log(t){this.messageService.add("VisboPortfolioVersion: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(wV),Rs(fb),Rs(Ib),Rs(Rh),Rs(Df),Rs(Fg),Rs(rf),Rs(ov),Rs(Md))},t.\u0275cmp=le({type:t,selectors:[["app-visboportfolio-versions"]],features:[_e],decls:36,vars:33,consts:[[1,"well"],["class","row",4,"ngIf"],[1,"container-fluid"],[1,"row"],[1,"col-6","px-0"],[1,"d-none","d-lg-block"],[1,"d-block","d-lg-none"],[1,"col-4","d-print-none"],["style","font-size: 2.2em","class","mx-1 fas fa-caret-square-left",3,"title","click",4,"ngIf"],["class","col-4 form-control","name","refDateInterval",3,"ngModel","ngModelChange",4,"ngIf"],["style","font-size: 2.2em","class","mx-1 fas fa-caret-square-right",3,"title","click",4,"ngIf"],[1,"row","d-print-none"],[1,"col-9","btn-toolbar",2,"padding","unset"],["type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["class","col-3 mt-2 text-warning text-right",4,"ngIf"],[4,"ngIf"],[1,"col"],[3,"click"],["class","ml-1",4,"ngIf"],["class","dropdown","class","ml-2",4,"ngIf"],[1,"ml-1"],[1,"ml-2"],["data-toggle","dropdown",1,"dropdown-toggle"],[1,"dropdown-menu"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],[1,"dropdown-item",3,"click"],[3,"click",4,"ngIf"],[1,"mx-1","fas","fa-caret-square-left",2,"font-size","2.2em",3,"title","click"],["name","refDateInterval",1,"col-4","form-control",3,"ngModel","ngModelChange"],["value","day"],["value","week"],["value","month"],["value","quarter"],[1,"mx-1","fas","fa-caret-square-right",2,"font-size","2.2em",3,"title","click"],[1,"col-3","mt-2","text-warning","text-right"],[3,"vpActive","vpfActive","refDate","combinedPerm"],[3,"bubbleMode","visboprojectversions","combinedPerm"],[3,"vps"]],template:function(t,e){1&t&&(Bs(0,"app-usernavbar"),Ns(1,"div",0),Gs(2,uD,10,7,"div",1),Ns(3,"div",2),Ns(4,"div",3),Ns(5,"h3",4),Ns(6,"div",5),mo(7),Ua(8,"translate"),Ua(9,"date"),Fs(),Ns(10,"div",6),mo(11),Ua(12,"translate"),Ua(13,"date"),Fs(),Fs(),Ns(14,"div",7),Ns(15,"div",3),Gs(16,pD,3,9,"span",8),Gs(17,gD,13,13,"select",9),Gs(18,mD,3,9,"span",10),Fs(),Fs(),Fs(),Ns(19,"div",11),Ns(20,"div",12),Ns(21,"button",13),Js("click",(function(){return e.changeView("KeyMetrics")})),mo(22),Ua(23,"translate"),Fs(),Ns(24,"button",13),Js("click",(function(){return e.changeView("List")})),mo(25),Ua(26,"translate"),Fs(),Gs(27,fD,3,3,"button",14),Ns(28,"button",13),Js("click",(function(){return e.changeView("ProjectBoard")})),mo(29),Ua(30,"translate"),Fs(),Fs(),Gs(31,bD,3,7,"div",15),Fs(),Fs(),Gs(32,yD,3,4,"div",16),Gs(33,CD,3,3,"div",16),Gs(34,VD,3,3,"div",16),Gs(35,wD,3,1,"div",16),Fs()),2&t&&(_n(2),js("ngIf",e.vpActive&&e.vpfActive),_n(5),bo("",Ea(8,17,"vpfVersion.titleKM")," ",Oa(9,19,e.vpvRefDate,"dd.MM.yyyy"),""),_n(4),bo("",Ea(12,22,"vpfVersion.titleKMShort"),": ",Oa(13,24,e.vpvRefDate,"dd.MM."),""),_n(5),js("ngIf",e.statusDirection>=0),_n(1),js("ngIf",null!=e.statusDirection),_n(1),js("ngIf",e.statusDirection<=0),_n(4),fo(Ea(23,27,"vpfVersion.btn.viewKeyMetrics")),_n(3),fo(Ea(26,29,"vpfVersion.btn.viewList")),_n(2),js("ngIf",e.hasVPPerm(e.permVP.Modify+e.permVP.ViewAudit)&&e.hasOrga),_n(2),fo(Ea(30,31,"vpfVersion.btn.viewProjectBoard")),_n(2),js("ngIf",e.isVersionMismatch()),_n(1),js("ngIf","Capacity"==e.pageParams.view&&e.vpActive&&e.vpfActive),_n(1),js("ngIf","KeyMetrics"==e.pageParams.view&&e.visboprojectversions),_n(1),js("ngIf","List"==e.pageParams.view&&e.vpList),_n(1),js("ngIf","ProjectBoard"==e.pageParams.view&&e.vpList))},directives:[bb,jc,Lc,cu,Nd,Eu,du,gu,pw,vA,wA],pipes:[av,qc],encapsulation:2}),t})(),PD=(()=>{class t{constructor(t){this.gChartService=t}ngOnInit(){this.language||(this.language="de"),this.gLib=this.gChartService.getGoogle(),this.gLib.charts.load("current",{packages:["corechart","table"],language:this.language}),this.gLib.charts.setOnLoadCallback(this.drawChart.bind(this))}ngOnChanges(){this.initialised&&this.drawChart()}drawChart(){const t=new this.gLib.visualization.LineChart(document.getElementById("divLineChart")),e=new this.gLib.visualization.arrayToDataTable(this.graphData),i=this.parentThis;this.gLib.visualization.events.addListener(t,"select",(function(){const n=t.getSelection();if(n&&0!==n.length){const t=n[0];if(console.log("Chart Line: The user selected "+JSON.stringify(t)),void 0===i)console.log("Chart Line: The user clicked and this is undefined");else if(t){const n=t.row,r=t.column;if(null!=n&&n>=0){const t=e.getValue(n,0);i.chartSelectRow(n,r,t)}}}else console.log("Chart Line: chartGetSelection is undefined",n||n.length)})),t.draw(e,this.graphOptions||{title:"Line Chart"}),this.initialised=!0}}return t.\u0275fac=function(e){return new(e||t)(Rs(xV))},t.\u0275cmp=le({type:t,selectors:[["app-line-chart"]],inputs:{graphData:"graphData",language:"language",graphOptions:"graphOptions",parentThis:"parentThis"},features:[_e],decls:1,vars:0,consts:[["id","divLineChart"]],template:function(t,e){1&t&&Bs(0,"div",0)},styles:["#divLineChart[_ngcontent-%COMP%]{width:100%;height:500px}"]}),t})();function kD(t,e){1&t&&qs(0)}function DD(t,e){1&t&&qs(0)}function MD(t,e){1&t&&qs(0)}const SD=function(t,e){return{selected:t,text:e}},ID=function(t){return{level:t}};function xD(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td",15),Js("click",(function(){return ei(t),Xs(2).switchView("Cost",!0)})),Ns(2,"a"),Gs(3,kD,1,0,"ng-container",16),Ua(4,"translate"),Fs(),Fs(),Ns(5,"td",17),Js("click",(function(){return ei(t),Xs(2).switchView("Cost",!0)})),Ua(6,"translate"),Ua(7,"number"),Ua(8,"number"),Ns(9,"a"),Gs(10,DD,1,0,"ng-container",16),Ns(11,"span"),mo(12),Ua(13,"number"),Ua(14,"number"),Fs(),Fs(),Fs(),Ns(15,"td",17),Js("click",(function(){return ei(t),Xs(2).switchView("Cost",!0)})),Ua(16,"translate"),Ua(17,"number"),Ua(18,"number"),Ns(19,"a"),Gs(20,MD,1,0,"ng-container",16),Ns(21,"span"),mo(22),Ua(23,"number"),Ua(24,"number"),Fs(),Fs(),Fs(),Ns(25,"td"),Ns(26,"a"),Ns(27,"button",18),Js("click",(function(){return ei(t),Xs(2).switchTo("Cost")})),mo(28,"i"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2),e=Ls(10),i=Ls(6);_n(3),js("ngTemplateOutlet",e)("ngTemplateOutletContext",Da(47,SD,"Cost"==t.typeMetricChart,Ea(4,17,"vpKeyMetric.lbl.metricCost"))),_n(2),no("title","",Ea(6,19,"vpKeyMetric.lbl.actualCost"),": ",Oa(7,21,t.vpvKeyMetricActive.keyMetrics.costCurrentActual,"1.0-0")," T\u20ac / ",Oa(8,24,t.vpvKeyMetricActive.keyMetrics.costBaseLastActual,"1.0-0")," T\u20ac"),_n(5),js("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(50,ID,t.qualityCost)),_n(2),bo(" ",Oa(13,27,t.vpvKeyMetricActive.keyMetrics.costCurrentActual,"1.0-0")," T\u20ac (",Oa(14,30,100-t.vpvKeyMetricActive.savingCostActual,"1.0-0")," %) "),_n(3),no("title","",Ea(16,33,"vpKeyMetric.lbl.totalCost"),": ",Oa(17,35,t.vpvKeyMetricActive.keyMetrics.costCurrentTotal,"1.0-0")," T\u20ac / ",Oa(18,38,t.vpvKeyMetricActive.keyMetrics.costBaseLastTotal,"1.0-0")," T\u20ac"),_n(5),js("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(52,ID,t.qualityTotalCost)),_n(2),bo(" ",Oa(23,41,t.vpvKeyMetricActive.keyMetrics.costCurrentTotal,"1.0-0")," T\u20ac (",Oa(24,44,100-t.vpvKeyMetricActive.savingCostTotal,"1.0-0")," %) "),_n(5),to("title",t.historyButton)}}function TD(t,e){1&t&&qs(0)}function _D(t,e){1&t&&qs(0)}function UD(t,e){if(1&t&&(Ns(0,"span",20),mo(1),Ua(2,"number"),Fs()),2&t){const t=Xs(3);_n(1),vo("(",Oa(2,1,t.qualityEndDiffWeeks,"1.1-1")," W)")}}function ED(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td",15),Js("click",(function(){return ei(t),Xs(2).switchTo("EndDate")})),Ns(2,"a"),Gs(3,TD,1,0,"ng-container",16),Ua(4,"translate"),Fs(),Fs(),Bs(5,"td"),Ns(6,"td",19),Ua(7,"translate"),Ua(8,"date"),Ns(9,"a",15),Js("click",(function(){return ei(t),Xs(2).switchTo("EndDate")})),Gs(10,_D,1,0,"ng-container",16),Ns(11,"span",20),mo(12),Ua(13,"date"),Fs(),Gs(14,UD,3,4,"span",21),Fs(),Fs(),Ns(15,"td"),Ns(16,"button",18),Js("click",(function(){return ei(t),Xs(2).switchTo("EndDate")})),mo(17,"i"),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2),e=Ls(10),i=Ls(6);_n(3),js("ngTemplateOutlet",e)("ngTemplateOutletContext",Da(19,SD,"EndDate"==t.typeMetricChart,Ea(4,9,"vpKeyMetric.lbl.metricEndDate"))),_n(3),io("title","",Ea(7,11,"vpKeyMetric.lbl.baselineEndDate"),": ",Oa(8,13,t.vpvKeyMetricActive.keyMetrics.endDateBaseLast,"dd.MM.yy"),""),_n(4),js("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(22,ID,t.qualityEndDate)),_n(2),vo("",Oa(13,16,t.vpvKeyMetricActive.keyMetrics.endDateCurrent,"dd.MM.yy")," "),_n(2),js("ngIf",t.qualityEndDiffWeeks),_n(2),to("title",t.historyButton)}}function OD(t,e){1&t&&qs(0)}function GD(t,e){1&t&&qs(0)}function LD(t,e){if(1&t&&(Ns(0,"span",23),mo(1),Ua(2,"number"),Ua(3,"translate"),Fs()),2&t){const t=Xs(3);_n(1),bo(" (",Oa(2,2,t.vpvKeyMetricActive.keyMetrics.timeCompletionBaseLastTotal-t.vpvKeyMetricActive.keyMetrics.timeCompletionCurrentTotal,"1.0-0")," ",Ea(3,5,"vpKeyMetric.lbl.missing"),") ")}}function RD(t,e){1&t&&(Ns(0,"span"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),vo(" (",Ea(2,1,"vpKeyMetric.lbl.inPlan"),") "))}function jD(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td",15),Js("click",(function(){return ei(t),Xs(2).switchView("Deadline",!0)})),Ns(2,"a"),Gs(3,OD,1,0,"ng-container",16),Ua(4,"translate"),Fs(),Fs(),Ns(5,"td",15),Js("click",(function(){return ei(t),Xs(2).switchView("Deadline",!0)})),Ns(6,"a",19),Ua(7,"translate"),Gs(8,GD,1,0,"ng-container",16),Ns(9,"span"),mo(10),Ua(11,"number"),Ua(12,"translate"),Ua(13,"number"),Ua(14,"number"),Fs(),Fs(),Fs(),Ns(15,"td",15),Js("click",(function(){return ei(t),Xs(2).switchView("Deadline",!0)})),Ns(16,"a"),Ns(17,"span"),mo(18),Ua(19,"number"),Fs(),Gs(20,LD,4,7,"span",22),Gs(21,RD,3,3,"span",2),Fs(),Fs(),Ns(22,"td"),Ns(23,"button",18),Js("click",(function(){return ei(t),Xs(2).switchTo("Deadline")})),mo(24,"i"),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2),e=Ls(10),i=Ls(6);_n(3),js("ngTemplateOutlet",e)("ngTemplateOutletContext",Da(31,SD,"Deadline"==t.typeMetricChart,Ea(4,13,"vpKeyMetric.lbl.metricDeadline"))),_n(3),to("title",Ea(7,15,"vpKeyMetric.lbl.actualDeadline")),_n(2),js("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(34,ID,t.qualityDeadline)),_n(2),Co(" ",Oa(11,17,t.vpvKeyMetricActive.keyMetrics.timeCompletionCurrentActual,"1.0-0")," ",Ea(12,20,"vpKeyMetric.lbl.of")," ",Oa(13,22,t.vpvKeyMetricActive.keyMetrics.timeCompletionBaseLastActual,"1.0-0")," (",Oa(14,25,t.vpvKeyMetricActive.timeCompletionActual,"1.0-0")," %) "),_n(8),vo(" ",Oa(19,28,t.vpvKeyMetricActive.keyMetrics.timeCompletionCurrentTotal,"1.0-0")," "),_n(2),js("ngIf",t.vpvKeyMetricActive.keyMetrics.timeCompletionCurrentTotal<t.vpvKeyMetricActive.keyMetrics.timeCompletionBaseLastTotal),_n(1),js("ngIf",t.vpvKeyMetricActive.keyMetrics.timeCompletionCurrentTotal==t.vpvKeyMetricActive.keyMetrics.timeCompletionBaseLastTotal),_n(2),to("title",t.historyButton)}}function $D(t,e){1&t&&qs(0)}function ND(t,e){1&t&&qs(0)}function FD(t,e){if(1&t&&(Ns(0,"span",23),mo(1),Ua(2,"number"),Fs()),2&t){const t=Xs(3);_n(1),vo("(",Oa(2,1,t.vpvKeyMetricActive.keyMetrics.deliverableCompletionBaseLastTotal-t.vpvKeyMetricActive.keyMetrics.deliverableCompletionCurrentTotal,"1.0-2")," Missing)")}}function BD(t,e){1&t&&(Ns(0,"span"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),vo("(",Ea(2,1,"vpKeyMetric.lbl.inPlan"),")"))}function HD(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td",15),Js("click",(function(){return ei(t),Xs(2).switchView("Delivery",!0)})),Ns(2,"a"),Gs(3,$D,1,0,"ng-container",16),Ua(4,"translate"),Fs(),Fs(),Ns(5,"td",17),Js("click",(function(){return ei(t),Xs(2).switchView("Delivery",!0)})),Ua(6,"translate"),Ns(7,"a"),Gs(8,ND,1,0,"ng-container",16),Ns(9,"span"),mo(10),Ua(11,"number"),Ua(12,"translate"),Ua(13,"number"),Ua(14,"number"),Fs(),Fs(),Fs(),Ns(15,"td",15),Js("click",(function(){return ei(t),Xs(2).switchView("Delivery",!0)})),Ns(16,"a"),Ns(17,"span"),mo(18),Ua(19,"number"),Fs(),Gs(20,FD,3,4,"span",22),Gs(21,BD,3,3,"span",2),Fs(),Fs(),Ns(22,"td"),Ns(23,"button",18),Js("click",(function(){return ei(t),Xs(2).switchTo("Delivery")})),mo(24,"i"),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2),e=Ls(10),i=Ls(6);_n(3),js("ngTemplateOutlet",e)("ngTemplateOutletContext",Da(31,SD,"Delivery"==t.typeMetricChart,Ea(4,13,"vpKeyMetric.lbl.metricDelivery"))),_n(2),to("title",Ea(6,15,"vpKeyMetric.lbl.actualDelivery")),_n(3),js("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(34,ID,t.qualityDelivery)),_n(2),Co(" ",Oa(11,17,t.vpvKeyMetricActive.keyMetrics.deliverableCompletionCurrentActual,"1.0-0")," ",Ea(12,20,"vpKeyMetric.lbl.of")," ",Oa(13,22,t.vpvKeyMetricActive.keyMetrics.deliverableCompletionBaseLastActual,"1.0-0")," (",Oa(14,25,t.vpvKeyMetricActive.deliveryCompletionActual,"1.0-0")," %) "),_n(8),vo("",Oa(19,28,t.vpvKeyMetricActive.keyMetrics.deliverableCompletionCurrentTotal,"1.0-0")," "),_n(2),js("ngIf",t.vpvKeyMetricActive.keyMetrics.deliverableCompletionCurrentTotal<t.vpvKeyMetricActive.keyMetrics.deliverableCompletionBaseLastTotal),_n(1),js("ngIf",t.vpvKeyMetricActive.keyMetrics.deliverableCompletionCurrentTotal==t.vpvKeyMetricActive.keyMetrics.deliverableCompletionBaseLastTotal),_n(2),to("title",t.historyButton)}}function KD(t,e){1&t&&(Ns(0,"tr"),Bs(1,"th"),Ns(2,"th"),mo(3),Ua(4,"translate"),Fs(),Ns(5,"th"),mo(6),Ua(7,"translate"),Fs(),Bs(8,"th"),Fs()),2&t&&(_n(3),fo(Ea(4,2,"vpKeyMetric.lbl.finished")),_n(3),fo(Ea(7,4,"vpKeyMetric.lbl.unfinished")))}function qD(t,e){1&t&&qs(0)}function zD(t,e){1&t&&qs(0)}function QD(t,e){if(1&t&&(Ns(0,"div"),Gs(1,zD,1,0,"ng-container",16),Ns(2,"span"),mo(3),Ua(4,"number"),Ua(5,"translate"),Fs(),Fs()),2&t){const t=Xs(3),e=Ls(6);_n(1),js("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(9,ID,t.delayActualDeadline)),_n(2),bo(" ",Oa(4,4,t.vpvKeyMetricActive.keyMetrics.timeDelayFinished,"1.0-0")," ",Ea(5,7,"vpKeyMetric.lbl.unitsDelay"),"")}}function WD(t,e){1&t&&qs(0)}function JD(t,e){if(1&t&&(Ns(0,"div"),Gs(1,WD,1,0,"ng-container",16),Ns(2,"span"),mo(3),Ua(4,"number"),Ua(5,"translate"),Fs(),Fs()),2&t){const t=Xs(3),e=Ls(6);_n(1),js("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(9,ID,t.delayTotalDeadline)),_n(2),bo(" ",Oa(4,4,t.vpvKeyMetricActive.keyMetrics.timeDelayUnFinished,"1.0-0")," ",Ea(5,7,"vpKeyMetric.lbl.unitsDelay"),"")}}function YD(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td",15),Js("click",(function(){return ei(t),Xs(2).switchView("Deadline",!0)})),Ns(2,"a"),Gs(3,qD,1,0,"ng-container",16),Ua(4,"translate"),Fs(),Fs(),Ns(5,"td",17),Js("click",(function(){return ei(t),Xs(2).switchView("Deadline",!0)})),Ua(6,"translate"),Ns(7,"a"),Gs(8,QD,6,11,"div",2),Fs(),Fs(),Ns(9,"td",17),Js("click",(function(){return ei(t),Xs(2).switchView("Deadline",!0)})),Ua(10,"translate"),Ns(11,"a"),Gs(12,JD,6,11,"div",2),Fs(),Fs(),Ns(13,"td"),Ns(14,"button",18),Js("click",(function(){return ei(t),Xs(2).switchTo("DeadlineDelay")})),mo(15,"i"),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2),e=Ls(10);_n(3),js("ngTemplateOutlet",e)("ngTemplateOutletContext",Da(13,SD,"DeadlineDelay"==t.typeMetricChart,Ea(4,7,"vpKeyMetric.lbl.metricDeadlineDelay"))),_n(2),to("title",Ea(6,9,"vpKeyMetric.lbl.finishedDeadlineDelay")),_n(3),js("ngIf",null!=t.vpvKeyMetricActive.keyMetrics.timeDelayFinished),_n(1),to("title",Ea(10,11,"vpKeyMetric.lbl.unfinishedDeadlineDelay")),_n(3),js("ngIf",null!=t.vpvKeyMetricActive.keyMetrics.timeDelayUnFinished),_n(2),to("title",t.historyButton)}}function ZD(t,e){1&t&&qs(0)}function XD(t,e){1&t&&qs(0)}function tM(t,e){if(1&t&&(Ns(0,"div"),Gs(1,XD,1,0,"ng-container",16),Ns(2,"span"),mo(3),Ua(4,"number"),Ua(5,"translate"),Fs(),Fs()),2&t){const t=Xs(3),e=Ls(6);_n(1),js("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(9,ID,t.delayActualDelivery)),_n(2),bo(" ",Oa(4,4,t.vpvKeyMetricActive.keyMetrics.deliverableDelayFinished,"1.0-0")," ",Ea(5,7,"vpKeyMetric.lbl.unitsDelay"),"")}}function eM(t,e){1&t&&qs(0)}function iM(t,e){if(1&t&&(Ns(0,"div"),Gs(1,eM,1,0,"ng-container",16),Ns(2,"span"),mo(3),Ua(4,"number"),Ua(5,"translate"),Fs(),Fs()),2&t){const t=Xs(3),e=Ls(6);_n(1),js("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(9,ID,t.delayTotalDelivery)),_n(2),bo(" ",Oa(4,4,t.vpvKeyMetricActive.keyMetrics.deliverableDelayUnFinished,"1.0-0")," ",Ea(5,7,"vpKeyMetric.lbl.unitsDelay"),"")}}function nM(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td",15),Js("click",(function(){return ei(t),Xs(2).switchView("Delivery",!0)})),Ns(2,"a"),Gs(3,ZD,1,0,"ng-container",16),Ua(4,"translate"),Fs(),Fs(),Ns(5,"td",17),Js("click",(function(){return ei(t),Xs(2).switchView("Delivery",!0)})),Ua(6,"translate"),Ns(7,"a"),Gs(8,tM,6,11,"div",2),Fs(),Fs(),Ns(9,"td",17),Js("click",(function(){return ei(t),Xs(2).switchView("Deadline",!0)})),Ua(10,"translate"),Ns(11,"a"),Gs(12,iM,6,11,"div",2),Fs(),Fs(),Ns(13,"td"),Ns(14,"button",18),Js("click",(function(){return ei(t),Xs(2).switchTo("DeliveryDelay")})),mo(15,"i"),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2),e=Ls(10);_n(3),js("ngTemplateOutlet",e)("ngTemplateOutletContext",Da(13,SD,"DeliveryDelay"==t.typeMetricChart,Ea(4,7,"vpKeyMetric.lbl.metricDeliveryDelay"))),_n(2),to("title",Ea(6,9,"vpKeyMetric.lbl.finishedDeliveryDelay")),_n(3),js("ngIf",null!=t.vpvKeyMetricActive.keyMetrics.timeDelayFinished),_n(1),to("title",Ea(10,11,"vpKeyMetric.lbl.unfinishedDeliveryDelay")),_n(3),js("ngIf",null!=t.vpvKeyMetricActive.keyMetrics.timeDelayUnFinished),_n(2),to("title",t.historyButton)}}function rM(t,e){if(1&t&&(Ns(0,"table",13),Ns(1,"thead"),Ns(2,"tr"),Ns(3,"th"),mo(4),Ua(5,"translate"),Fs(),Ns(6,"th"),mo(7),Ua(8,"translate"),Fs(),Ns(9,"th"),mo(10),Ua(11,"translate"),Fs(),Ns(12,"th",14),mo(13),Ua(14,"translate"),Fs(),Fs(),Fs(),Ns(15,"tbody"),Gs(16,xD,29,54,"tr",2),Gs(17,ED,18,24,"tr",2),Gs(18,jD,25,36,"tr",2),Gs(19,HD,25,36,"tr",2),Gs(20,KD,9,6,"tr",2),Gs(21,YD,16,16,"tr",2),Gs(22,nM,16,16,"tr",2),Fs(),Fs()),2&t){const t=Xs();_n(4),fo(Ea(5,11,"vpKeyMetric.lbl.keyMetric")),_n(3),fo(Ea(8,13,"vpKeyMetric.lbl.planToDate")),_n(3),fo(Ea(11,15,"vpKeyMetric.lbl.total")),_n(3),fo(Ea(14,17,"vpKeyMetric.lbl.trend")),_n(3),js("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"Cost")),_n(1),js("ngIf",null!=t.vpvKeyMetricActive.keyMetrics.endDateBaseLast),_n(1),js("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"Deadline")),_n(1),js("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"Delivery")),_n(1),js("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"DeadlineDelay")||t.hasKM(t.vpvKeyMetricActive.keyMetrics,"DeliveryDelay")),_n(1),js("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"DeadlineDelay")),_n(1),js("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"DeliveryDelay"))}}function sM(t,e){1&t&&(Ns(0,"h3"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),vo(" ",Ea(2,1,"vpKeyMetric.msg.noKeyMetric")," "))}const oM=function(t,e,i){return{"fa-check-circle text-success":t,"fa-exclamation-triangle text-warning":e,"fa-exclamation-circle text-danger":i}};function aM(t,e){if(1&t&&Bs(0,"i",24),2&t){const t=e.level;js("ngClass",Ma(1,oM,1==t,2==t,3==t))}}const lM=function(t,e,i,n){return{"text-secondary":t,"text-success":e,"text-warning":i,"text-danger":n}};function cM(t,e){if(1&t&&Bs(0,"i",25),2&t){const t=e.level;js("ngClass",Sa(1,lM,0==t,1==t,2==t,3==t))}}const dM=function(t,e){return{"font-weight-bold":t,"font-weight-normal":e}};function uM(t,e){if(1&t&&(Ns(0,"span",26),mo(1),Fs()),2&t){const t=e.selected,i=e.text;js("ngClass",Da(2,dM,1==t,0==t)),_n(1),fo(i)}}function hM(t,e){if(1&t){const t=zs();Ns(0,"button",32),Js("click",(function(){return ei(t),Xs(2).gotoVisboProjectVersions()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpKeyMetric.btn.allVersions")))}function pM(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-line-chart",34),Fs()),2&t){const t=Xs(3);_n(1),js("graphData",t.graphDataLineChart)("graphOptions",t.graphOptionsLineChart)("parentThis",t.parentThis)("language",t.currentLang)}}function gM(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-line-chart",34),Fs()),2&t){const t=Xs(3);_n(1),js("graphData",t.graphDataLineChart)("graphOptions",t.graphOptionsLineChartEndDate)("parentThis",t.parentThis)("language",t.currentLang)}}function mM(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-line-chart",34),Fs()),2&t){const t=Xs(3);_n(1),js("graphData",t.graphDataLineChart)("graphOptions",t.graphOptionsLineChart)("parentThis",t.parentThis)("language",t.currentLang)}}function fM(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-line-chart",34),Fs()),2&t){const t=Xs(3);_n(1),js("graphData",t.graphDataLineChart)("graphOptions",t.graphOptionsLineChart)("parentThis",t.parentThis)("language",t.currentLang)}}function vM(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-line-chart",34),Fs()),2&t){const t=Xs(3);_n(1),js("graphData",t.graphDataLineChart)("graphOptions",t.graphOptionsLineChart)("parentThis",t.parentThis)("language",t.currentLang)}}function bM(t,e){if(1&t&&(Ns(0,"div",33),Gs(1,pM,2,4,"div",2),Gs(2,gM,2,4,"div",2),Gs(3,mM,2,4,"div",2),Gs(4,fM,2,4,"div",2),Gs(5,vM,2,4,"div",2),Fs()),2&t){const t=Xs(2);_n(1),js("ngIf","Cost"==t.typeMetricChart),_n(1),js("ngIf","EndDate"==t.typeMetricChart),_n(1),js("ngIf","Deadline"==t.typeMetricChart),_n(1),js("ngIf","DeadlineDelay"==t.typeMetricChart),_n(1),js("ngIf","Delivery"==t.typeMetricChart)}}function yM(t,e){1&t&&qs(0)}function CM(t,e){1&t&&qs(0)}function VM(t,e){if(1&t){const t=zs();Ns(0,"tr",39),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(4).listSelectRow(i)})),Ns(1,"td"),Ns(2,"a"),Gs(3,yM,1,0,"ng-container",16),Ua(4,"date"),Fs(),Fs(),Ns(5,"td",40),mo(6),Ua(7,"number"),Fs(),Ns(8,"td",41),Ua(9,"translate"),Ua(10,"number"),mo(11),Ua(12,"number"),Fs(),Ns(13,"td",40),mo(14),Ua(15,"number"),Fs(),Ns(16,"td",41),Ua(17,"translate"),Ua(18,"number"),mo(19),Ua(20,"number"),Fs(),Ns(21,"td",41),Gs(22,CM,1,0,"ng-container",16),Fs(),Fs()}if(2&t){const t=e.$implicit,i=Xs(4),n=Ls(10),r=Ls(8);_n(3),js("ngTemplateOutlet",n)("ngTemplateOutletContext",Da(38,SD,t.timestamp==i.vpvKeyMetricActive.timestamp,Oa(4,13,t.timestamp,"dd.MM.yyyy HH:mm"))),_n(3),vo("",Oa(7,16,t.keyMetrics.costCurrentActual,"1.0-0")," k\u20ac"),_n(2),io("title","",Ea(9,19,"keyMetrics.shortPV"),": ",Oa(10,21,t.keyMetrics.costBaseLastActual,"1.0-0")," k\u20ac"),_n(3),vo("",Oa(12,24,100-t.savingCostActual,"1.0-0")," %"),_n(3),vo("",Oa(15,27,t.keyMetrics.costCurrentTotal,"1.0-0")," k\u20ac"),_n(2),io("title","",Ea(17,30,"keyMetrics.shortBAC"),": ",Oa(18,32,t.keyMetrics.costBaseLastTotal,"1.0-0")," k\u20ac"),_n(3),vo("",Oa(20,35,100-t.savingCostTotal,"1.0-0")," %"),_n(2),to("title",t.ampelErlaeuterung),_n(1),js("ngTemplateOutlet",r)("ngTemplateOutletContext",ka(41,ID,t.ampelStatus))}}function wM(t,e){if(1&t){const t=zs();Ns(0,"table",13),Ns(1,"thead"),Ns(2,"tr"),Ns(3,"th",15),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(1)})),mo(4),Ua(5,"translate"),Fs(),Ns(6,"th",35),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(7)})),Ua(7,"translate"),mo(8),Ua(9,"translate"),Fs(),Ns(10,"th",36),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(2)})),Ua(11,"translate"),mo(12),Ua(13,"translate"),Fs(),Ns(14,"th",35),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(8)})),Ua(15,"translate"),mo(16),Ua(17,"translate"),Fs(),Ns(18,"th",36),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(5)})),Ua(19,"translate"),mo(20),Ua(21,"translate"),Fs(),Ns(22,"th",37),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(6)})),mo(23),Ua(24,"translate"),Fs(),Fs(),Fs(),Ns(25,"tbody"),Gs(26,VM,23,43,"tr",38),Fs(),Fs()}if(2&t){const t=Xs(3);_n(4),fo(Ea(5,11,"keyMetrics.lbl.timeStamp")),_n(2),to("title",Ea(7,13,"keyMetrics.longAC")),_n(2),fo(Ea(9,15,"keyMetrics.shortAC")),_n(2),to("title",Ea(11,17,"keyMetrics.longPV")),_n(2),fo(Ea(13,19,"keyMetrics.relativPV")),_n(2),to("title",Ea(15,21,"keyMetrics.longEAC")),_n(2),fo(Ea(17,23,"keyMetrics.shortEAC")),_n(2),to("title",Ea(19,25,"keyMetrics.longBAC")),_n(2),fo(Ea(21,27,"keyMetrics.baselineBAC")),_n(3),fo(Ea(24,29,"keyMetrics.lbl.trafficLight")),_n(3),js("ngForOf",t.visbokeymetrics)}}function AM(t,e){1&t&&qs(0)}function PM(t,e){1&t&&qs(0)}function kM(t,e){if(1&t){const t=zs();Ns(0,"tr",39),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(4).listSelectRow(i)})),Ns(1,"td"),Ns(2,"a"),Gs(3,AM,1,0,"ng-container",16),Ua(4,"date"),Fs(),Fs(),Ns(5,"td",40),mo(6),Ua(7,"date"),Fs(),Ns(8,"td",40),mo(9),Ua(10,"date"),Fs(),Ns(11,"td",40),mo(12),Ua(13,"number"),Fs(),Ns(14,"td",41),Gs(15,PM,1,0,"ng-container",16),Fs(),Fs()}if(2&t){const t=e.$implicit,i=Xs(4),n=Ls(10),r=Ls(8);_n(3),js("ngTemplateOutlet",n)("ngTemplateOutletContext",Da(20,SD,t.timestamp==i.vpvKeyMetricActive.timestamp,Oa(4,8,t.timestamp,"dd.MM.yyyy HH:mm"))),_n(3),fo(Oa(7,11,t.keyMetrics.endDateCurrent,"dd.MM.yyyy")),_n(3),fo(Oa(10,14,t.keyMetrics.endDateBaseLast,"dd.MM.yyyy")),_n(3),vo("",Oa(13,17,t.savingEndDate,"1.0-1")," W"),_n(2),to("title",t.ampelErlaeuterung),_n(1),js("ngTemplateOutlet",r)("ngTemplateOutletContext",ka(23,ID,t.ampelStatus))}}function DM(t,e){if(1&t){const t=zs();Ns(0,"table",13),Ns(1,"thead"),Ns(2,"tr"),Ns(3,"th",15),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(1)})),mo(4),Ua(5,"translate"),Fs(),Ns(6,"th",35),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(31)})),Ua(7,"translate"),mo(8),Ua(9,"translate"),Fs(),Ns(10,"th",35),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(32)})),Ua(11,"translate"),mo(12),Ua(13,"translate"),Fs(),Ns(14,"th",42),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(33)})),mo(15),Ua(16,"translate"),Fs(),Ns(17,"th",37),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(6)})),mo(18),Ua(19,"translate"),Fs(),Fs(),Fs(),Ns(20,"tbody"),Gs(21,kM,16,25,"tr",38),Fs(),Fs()}if(2&t){const t=Xs(3);_n(4),fo(Ea(5,8,"keyMetrics.lbl.timeStamp")),_n(2),to("title",Ea(7,10,"keyMetrics.longEED")),_n(2),fo(Ea(9,12,"keyMetrics.shortEED")),_n(2),to("title",Ea(11,14,"keyMetrics.longBED")),_n(2),fo(Ea(13,16,"keyMetrics.shortBED")),_n(3),fo(Ea(16,18,"vpKeyMetric.lbl.savingED")),_n(3),fo(Ea(19,20,"keyMetrics.lbl.trafficLight")),_n(3),js("ngForOf",t.visbokeymetrics)}}function MM(t,e){if(1&t){const t=zs();Ns(0,"th",37),Js("click",(function(){return ei(t),Xs(4).sortKeyMetricsTable(13)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"keyMetrics.lbl.actualDelay")))}function SM(t,e){if(1&t){const t=zs();Ns(0,"th",37),Js("click",(function(){return ei(t),Xs(4).sortKeyMetricsTable(14)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"keyMetrics.lbl.totalDelay")))}function IM(t,e){1&t&&qs(0)}function xM(t,e){if(1&t&&(Ns(0,"td",40),mo(1),Ua(2,"number"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.keyMetrics.timeDelayFinished,"1.0-0"))}}function TM(t,e){if(1&t&&(Ns(0,"td",40),mo(1),Ua(2,"number"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.keyMetrics.timeDelayUnFinished,"1.0-0"))}}function _M(t,e){1&t&&qs(0)}function UM(t,e){if(1&t){const t=zs();Ns(0,"tr",39),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(4).listSelectRow(i)})),Ns(1,"td"),Ns(2,"a"),Gs(3,IM,1,0,"ng-container",16),Ua(4,"date"),Fs(),Fs(),Ns(5,"td",40),mo(6),Ua(7,"number"),Fs(),Ns(8,"td",41),Ua(9,"translate"),Ua(10,"number"),mo(11),Ua(12,"number"),Fs(),Ns(13,"td",40),mo(14),Ua(15,"number"),Fs(),Ns(16,"td",41),Ua(17,"translate"),Ua(18,"number"),mo(19),Ua(20,"number"),Fs(),Gs(21,xM,3,4,"td",44),Gs(22,TM,3,4,"td",44),Ns(23,"td",41),Gs(24,_M,1,0,"ng-container",16),Fs(),Fs()}if(2&t){const t=e.$implicit,i=Xs(4),n=Ls(10),r=Ls(8);_n(3),js("ngTemplateOutlet",n)("ngTemplateOutletContext",Da(40,SD,t.timestamp==i.vpvKeyMetricActive.timestamp,Oa(4,15,t.timestamp,"dd.MM.yyyy HH:mm"))),_n(3),fo(Oa(7,18,t.keyMetrics.timeCompletionCurrentActual,"1.0-1")),_n(2),io("title","",Ea(9,21,"keyMetrics.shortPD"),": ",Oa(10,23,t.keyMetrics.timeCompletionBaseLastActual,"1.0-0"),""),_n(3),vo("",Oa(12,26,t.timeCompletionActual,"1.0-0")," %"),_n(3),fo(Oa(15,29,t.keyMetrics.timeCompletionCurrentTotal,"1.0-1")),_n(2),io("title","",Ea(17,32,"keyMetrics.shortDAC"),": ",Oa(18,34,t.keyMetrics.timeCompletionBaseLastTotal,"1.0-0"),""),_n(3),vo("",Oa(20,37,t.timeCompletionTotal,"1.0-0")," %"),_n(2),js("ngIf",i.hasKM(i.vpvKeyMetricActive.keyMetrics,"DeadlineDelay")),_n(1),js("ngIf",i.hasKM(i.vpvKeyMetricActive.keyMetrics,"DeadlineDelay")),_n(1),to("title",t.ampelErlaeuterung),_n(1),js("ngTemplateOutlet",r)("ngTemplateOutletContext",ka(43,ID,t.ampelStatus))}}function EM(t,e){if(1&t){const t=zs();Ns(0,"table",13),Ns(1,"thead"),Ns(2,"tr"),Ns(3,"th",15),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(1)})),mo(4),Ua(5,"translate"),Fs(),Ns(6,"th",35),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(10)})),Ua(7,"translate"),mo(8),Ua(9,"translate"),Fs(),Ns(10,"th",35),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(11)})),Ua(11,"translate"),mo(12),Ua(13,"translate"),Fs(),Ns(14,"th",36),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(12)})),Ua(15,"translate"),mo(16),Ua(17,"translate"),Fs(),Ns(18,"th",36),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(12)})),Ua(19,"translate"),mo(20),Ua(21,"translate"),Fs(),Gs(22,MM,3,3,"th",43),Gs(23,SM,3,3,"th",43),Ns(24,"th",37),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(6)})),mo(25),Ua(26,"translate"),Fs(),Fs(),Fs(),Ns(27,"tbody"),Gs(28,UM,25,45,"tr",38),Fs(),Fs()}if(2&t){const t=Xs(3);_n(4),fo(Ea(5,13,"keyMetrics.lbl.timeStamp")),_n(2),to("title",Ea(7,15,"keyMetrics.longAD")),_n(2),fo(Ea(9,17,"keyMetrics.shortAD")),_n(2),to("title",Ea(11,19,"keyMetrics.longPD")),_n(2),fo(Ea(13,21,"keyMetrics.shortPD")),_n(2),to("title",Ea(15,23,"keyMetrics.longEDC")),_n(2),fo(Ea(17,25,"keyMetrics.shortEDC")),_n(2),to("title",Ea(19,27,"keyMetrics.longDAC")),_n(2),fo(Ea(21,29,"keyMetrics.shortDAC")),_n(2),js("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"DeadlineDelay")),_n(1),js("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"DeadlineDelay")),_n(2),fo(Ea(26,31,"keyMetrics.lbl.trafficLight")),_n(3),js("ngForOf",t.visbokeymetrics)}}function OM(t,e){1&t&&qs(0)}function GM(t,e){1&t&&qs(0)}function LM(t,e){if(1&t){const t=zs();Ns(0,"tr",39),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(4).listSelectRow(i)})),Ns(1,"td"),Ns(2,"a"),Gs(3,OM,1,0,"ng-container",16),Ua(4,"date"),Fs(),Fs(),Ns(5,"td",40),mo(6),Ua(7,"number"),Fs(),Ns(8,"td",41),Ua(9,"translate"),Ua(10,"number"),mo(11),Ua(12,"number"),Fs(),Ns(13,"td",40),mo(14),Ua(15,"number"),Fs(),Ns(16,"td",41),Ua(17,"translate"),Ua(18,"number"),mo(19),Ua(20,"number"),Fs(),Ns(21,"td",41),Gs(22,GM,1,0,"ng-container",16),Fs(),Fs()}if(2&t){const t=e.$implicit,i=Xs(4),n=Ls(10),r=Ls(8);_n(3),js("ngTemplateOutlet",n)("ngTemplateOutletContext",Da(38,SD,t.timestamp==i.vpvKeyMetricActive.timestamp,Oa(4,13,t.timestamp,"dd.MM.yyyy HH:mm"))),_n(3),fo(Oa(7,16,t.keyMetrics.deliverableCompletionCurrentActual,"1.0-1")),_n(2),io("title","",Ea(9,19,"keyMetrics.shortPDV"),": ",Oa(10,21,t.keyMetrics.deliverableCompletionBaseLastActual,"1.0-0"),""),_n(3),vo("",Oa(12,24,t.deliveryCompletionActual,"1.0-0")," %"),_n(3),fo(Oa(15,27,t.keyMetrics.deliverableCompletionCurrentTotal,"1.0-1")),_n(2),io("title","",Ea(17,30,"keyMetrics.shortDVAC"),": ",Oa(18,32,t.keyMetrics.deliverableCompletionBaseLastTotal,"1.0-0"),""),_n(3),vo("",Oa(20,35,t.deliveryCompletionTotal,"1.0-0")," %"),_n(2),to("title",t.ampelErlaeuterung),_n(1),js("ngTemplateOutlet",r)("ngTemplateOutletContext",ka(41,ID,t.ampelStatus))}}function RM(t,e){if(1&t){const t=zs();Ns(0,"table",13),Ns(1,"thead"),Ns(2,"tr"),Ns(3,"th",15),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(1)})),mo(4),Ua(5,"translate"),Fs(),Ns(6,"th",35),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(21)})),Ua(7,"translate"),mo(8),Ua(9,"translate"),Fs(),Ns(10,"th",35),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(20)})),Ua(11,"translate"),mo(12),Ua(13,"translate"),Fs(),Ns(14,"th",36),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(26)})),Ua(15,"translate"),mo(16),Ua(17,"translate"),Fs(),Ns(18,"th",36),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(22)})),Ua(19,"translate"),mo(20),Ua(21,"translate"),Fs(),Ns(22,"th",37),Js("click",(function(){return ei(t),Xs(3).sortKeyMetricsTable(6)})),mo(23),Ua(24,"translate"),Fs(),Fs(),Fs(),Ns(25,"tbody"),Gs(26,LM,23,43,"tr",38),Fs(),Fs()}if(2&t){const t=Xs(3);_n(4),fo(Ea(5,11,"keyMetrics.lbl.timeStamp")),_n(2),to("title",Ea(7,13,"keyMetrics.longADV")),_n(2),fo(Ea(9,15,"keyMetrics.shortADV")),_n(2),to("title",Ea(11,17,"keyMetrics.longPDV")),_n(2),fo(Ea(13,19,"keyMetrics.shortPDV")),_n(2),to("title",Ea(15,21,"keyMetrics.longEDVC")),_n(2),fo(Ea(17,23,"keyMetrics.shortEDVC")),_n(2),to("title",Ea(19,25,"keyMetrics.longDVAC")),_n(2),fo(Ea(21,27,"keyMetrics.shortDVAC")),_n(3),fo(Ea(24,29,"keyMetrics.lbl.trafficLight")),_n(3),js("ngForOf",t.visbokeymetrics)}}function jM(t,e){if(1&t&&(Ns(0,"div"),Gs(1,wM,27,31,"table",1),Gs(2,DM,22,22,"table",1),Gs(3,EM,29,33,"table",1),Gs(4,RM,27,31,"table",1),Fs()),2&t){const t=Xs(2);_n(1),js("ngIf","Cost"==t.typeMetricChart),_n(1),js("ngIf","EndDate"==t.typeMetricChart),_n(1),js("ngIf","Deadline"==t.typeMetricChart||"DeadlineDelay"==t.typeMetricChart),_n(1),js("ngIf","Delivery"==t.typeMetricChart)}}function $M(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div",27),Ns(2,"button",28),Js("click",(function(){return ei(t),Xs().switchChart()})),mo(3),Fs(),Gs(4,hM,3,3,"button",29),Bs(5,"h3",30),Ua(6,"translate"),Fs(),Gs(7,bM,6,5,"div",31),Gs(8,jM,5,4,"div",2),Fs()}if(2&t){const t=Xs();_n(3),fo(t.chartButton),_n(1),js("ngIf",!t.chart),_n(1),to("title",Ea(6,5,"keyMetrics.lbl.showLegend")),_n(2),js("ngIf",t.chart&&t.graphDataLineChart.length>0),_n(1),js("ngIf",!t.chart&&t.graphDataLineChart.length>0)}}function NM(t,e){1&t&&(Ns(0,"tbody"),Ns(1,"tr"),Ns(2,"td"),mo(3),Ua(4,"translate"),Fs(),Ns(5,"td"),mo(6),Ua(7,"translate"),Fs(),Fs(),Ns(8,"tr"),Ns(9,"td"),mo(10),Ua(11,"translate"),Fs(),Ns(12,"td"),mo(13),Ua(14,"translate"),Fs(),Fs(),Ns(15,"tr"),Ns(16,"td"),mo(17),Ua(18,"translate"),Fs(),Ns(19,"td"),mo(20),Ua(21,"translate"),Fs(),Fs(),Ns(22,"tr"),Ns(23,"td"),mo(24),Ua(25,"translate"),Fs(),Ns(26,"td"),mo(27),Ua(28,"translate"),Fs(),Fs(),Fs()),2&t&&(_n(3),fo(Ea(4,8,"keyMetrics.shortAC")),_n(3),fo(Ea(7,10,"keyMetrics.longAC")),_n(4),fo(Ea(11,12,"keyMetrics.shortPV")),_n(3),fo(Ea(14,14,"keyMetrics.longPV")),_n(4),fo(Ea(18,16,"keyMetrics.shortEAC")),_n(3),fo(Ea(21,18,"keyMetrics.longEAC")),_n(4),fo(Ea(25,20,"keyMetrics.shortBAC")),_n(3),fo(Ea(28,22,"keyMetrics.longBAC")))}function FM(t,e){1&t&&(Ns(0,"tbody"),Ns(1,"tr"),Ns(2,"td"),mo(3),Ua(4,"translate"),Fs(),Ns(5,"td"),mo(6),Ua(7,"translate"),Fs(),Fs(),Ns(8,"tr"),Ns(9,"td"),mo(10),Ua(11,"translate"),Fs(),Ns(12,"td"),mo(13),Ua(14,"translate"),Fs(),Fs(),Ns(15,"tr"),Ns(16,"td"),mo(17),Ua(18,"translate"),Fs(),Ns(19,"td"),mo(20),Ua(21,"translate"),Fs(),Fs(),Ns(22,"tr"),Ns(23,"td"),mo(24),Ua(25,"translate"),Fs(),Ns(26,"td"),mo(27),Ua(28,"translate"),Fs(),Fs(),Fs()),2&t&&(_n(3),fo(Ea(4,8,"keyMetrics.shortAD")),_n(3),fo(Ea(7,10,"keyMetrics.longAD")),_n(4),fo(Ea(11,12,"keyMetrics.shortPD")),_n(3),fo(Ea(14,14,"keyMetrics.longPD")),_n(4),fo(Ea(18,16,"keyMetrics.shortEDC")),_n(3),fo(Ea(21,18,"keyMetrics.longEDC")),_n(4),fo(Ea(25,20,"keyMetrics.shortDAC")),_n(3),fo(Ea(28,22,"keyMetrics.longDAC")))}function BM(t,e){1&t&&(Ns(0,"tbody"),Ns(1,"tr"),Ns(2,"td"),mo(3),Ua(4,"translate"),Fs(),Ns(5,"td"),mo(6),Ua(7,"translate"),Fs(),Fs(),Ns(8,"tr"),Ns(9,"td"),mo(10),Ua(11,"translate"),Fs(),Ns(12,"td"),mo(13),Ua(14,"translate"),Fs(),Fs(),Fs()),2&t&&(_n(3),fo(Ea(4,4,"keyMetrics.finishedDeadline")),_n(3),fo(Ea(7,6,"keyMetrics.longFinishedDeadline")),_n(4),fo(Ea(11,8,"keyMetrics.unfinishedDeadline")),_n(3),fo(Ea(14,10,"keyMetrics.longUnfinishedDeadline")))}function HM(t,e){1&t&&(Ns(0,"tbody"),Ns(1,"tr"),Ns(2,"td"),mo(3),Ua(4,"translate"),Fs(),Ns(5,"td"),mo(6),Ua(7,"translate"),Fs(),Fs(),Ns(8,"tr"),Ns(9,"td"),mo(10),Ua(11,"translate"),Fs(),Ns(12,"td"),mo(13),Ua(14,"translate"),Fs(),Fs(),Ns(15,"tr"),Ns(16,"td"),mo(17),Ua(18,"translate"),Fs(),Ns(19,"td"),mo(20),Ua(21,"translate"),Fs(),Fs(),Ns(22,"tr"),Ns(23,"td"),mo(24),Ua(25,"translate"),Fs(),Ns(26,"td"),mo(27),Ua(28,"translate"),Fs(),Fs(),Fs()),2&t&&(_n(3),fo(Ea(4,8,"keyMetrics.shortADV")),_n(3),fo(Ea(7,10,"keyMetrics.longADV")),_n(4),fo(Ea(11,12,"keyMetrics.shortPDV")),_n(3),fo(Ea(14,14,"keyMetrics.longPDV")),_n(4),fo(Ea(18,16,"keyMetrics.shortEDVC")),_n(3),fo(Ea(21,18,"keyMetrics.longEDVC")),_n(4),fo(Ea(25,20,"keyMetrics.shortDVAC")),_n(3),fo(Ea(28,22,"keyMetrics.longDVAC")))}let KM=(()=>{class t{constructor(t,e,i,n,r,s){this.visboprojectversionService=t,this.messageService=e,this.alertService=i,this.route=n,this.router=r,this.translate=s,this.switchViewChild=new Ra,this.visbokeymetrics=[],this.allViews=["KeyMetrics","Capacity","Cost","Deadline","Delivery","All"],this.currentView="KeyMetrics",this.currentViewKM=!1,this.refDate=new Date,this.chart=!0,this.history=!1,this.parentThis=this,this.typeMetricList=[{name:"Total & Actual Cost",metric:"Cost"},{name:"Delivery Completion",metric:"Delivery"},{name:"Reached Deadlines",metric:"Deadline"},{name:"Ahead/Delay Deadlines",metric:"DeadlineDelay"},{name:"Ahead/Delay Deliveries",metric:"DeliveryDelay"},{name:"Project End Date",metric:"EndDate"}],this.typeMetric=this.typeMetricList[0].name,this.colors=[],this.colorsDefault=["#458CCB","#F7941E","#458CCB","#F7941E","#996600","#996600"],this.colorsDelay=["#BDBDBD","#458CCB"],this.colorsEndDate=["#458CCB","#F7941E"],this.seriesDefault={0:{lineWidth:4,pointShape:"star",lineDashStyle:void 0,pointSize:void 0},1:{lineWidth:4,pointShape:"triangle",lineDashStyle:void 0,pointSize:void 0},2:{lineWidth:4,pointShape:"star",lineDashStyle:[4,8,8,4],pointSize:void 0},3:{lineWidth:4,pointShape:"triangle",lineDashStyle:[8,4,4,8],pointSize:void 0},4:{lineWidth:1,pointShape:"circle",lineDashStyle:void 0,pointSize:4},5:{lineWidth:1,pointShape:"circle",lineDashStyle:[8,4,4,8],pointSize:4}},this.seriesEndDate={0:{lineWidth:4,pointShape:"star",lineDashStyle:[4,8,8,4],pointSize:void 0},1:{lineWidth:4,pointShape:"triangle",lineDashStyle:[8,4,4,8],pointSize:void 0}},this.graphDataLineChart=[],this.graphOptionsLineChart={width:"100%",title:"Comparison: plan-to-date vs. baseline",animation:{startup:!0,duration:200},legend:{position:"top"},explorer:{actions:["dragToZoom","rightClickToReset"],maxZoomIn:.01},tooltip:{isHtml:!0},vAxis:{minValue:void 0,maxValue:void 0,direction:1,title:"KeyMetrics",minorGridlines:{count:0,color:"none"},ticks:void 0},hAxis:{format:"MMM yy",gridlines:{count:-1},minorGridlines:{count:0,color:"none"}},pointSize:14,curveType:"function",series:this.seriesDefault,colors:this.colorsDefault},this.graphOptionsLineChartEndDate={width:"100%",title:"Comparison: plan-to-date vs. baseline",animation:{startup:!0,duration:200},legend:{position:"top"},explorer:{actions:["dragToZoom","rightClickToReset"],maxZoomIn:.01},tooltip:{isHtml:!0},vAxis:{minValue:void 0,maxValue:void 0,direction:1,title:"KeyMetrics",minorGridlines:{count:0,color:"none"},ticks:void 0},hAxis:{format:"MMM yy",gridlines:{count:-1},minorGridlines:{count:0,color:"none"}},pointSize:14,curveType:"function",series:this.seriesEndDate,colors:this.colorsEndDate},this.sortAscending=!1,this.sortColumn=1,this.permVC=Av,this.permVP=Pv}ngOnInit(){this.currentLang=this.translate.currentLang,this.chartButton=this.translate.instant("vpKeyMetric.lbl.viewList"),this.historyButton=this.translate.instant("vpKeyMetric.lbl.showTrend"),this.initSettings(),this.visboKeyMetricsCalc()}ngOnChanges(){this.log("KeyMetrics Changes  "+this.vpvid),this.initSettings(),this.visboKeyMetricsCalc()}initSettings(){this.route.snapshot.queryParams.refDate&&(this.refDate=new Date(this.route.snapshot.queryParams.refDate))}hasKM(t,e){let i=!1;return!!t&&("Cost"==e?i=t.costCurrentTotal>0||t.costBaseLastTotal>0:"Deadline"==e?i=t.timeCompletionCurrentTotal>0||t.timeCompletionBaseLastTotal>0:"EndDate"==e?i=null!=t.endDateCurrent||null!=t.endDateBaseLast:"DeadlineDelay"===e?i=void 0!==t.timeDelayFinished||void 0!==t.timeDelayUnFinished:"Delivery"==e?i=t.deliverableCompletionCurrentTotal>0||t.deliverableCompletionBaseLastTotal>0:"DeliveryDelay"===e&&(i=void 0!==t.deliverableDelayFinished||void 0!==t.deliverableDelayUnFinished),i)}visboKeyMetricsCalc(){if(this.visbokeymetrics=[],this.visboprojectversions){this.log("calc keyMetrics LEN "+this.visboprojectversions.length);for(let t=0;t<this.visboprojectversions.length;t++)if(this.visboprojectversions[t].keyMetrics){const e=new yV;e.name=this.visboprojectversions[t].name,e._id=this.visboprojectversions[t]._id,e.timestamp=this.visboprojectversions[t].timestamp,e.vpid=this.visboprojectversions[t].vpid,e.variantName=this.visboprojectversions[t].variantName,e.startDate=this.visboprojectversions[t].startDate,e.Risiko=this.visboprojectversions[t].Risiko,e.StrategicFit=this.visboprojectversions[t].StrategicFit,e.leadPerson=this.visboprojectversions[t].leadPerson,e.status=this.visboprojectversions[t].status,e.ampelStatus=this.visboprojectversions[t].ampelStatus,e.ampelErlaeuterung=this.visboprojectversions[t].ampelErlaeuterung,e.VorlagenName=this.visboprojectversions[t].VorlagenName,e.complexity=this.visboprojectversions[t].complexity,e.description=this.visboprojectversions[t].description,e.businessUnit=this.visboprojectversions[t].businessUnit,e.keyMetrics=this.visboprojectversions[t].keyMetrics,e.savingCostTotal=Math.round(100*(1-(e.keyMetrics.costCurrentTotal||0)/(e.keyMetrics.costBaseLastTotal||1)))||0,e.savingCostTotal>100&&(e.savingCostTotal=100),e.savingCostTotal<-100&&(e.savingCostTotal=-100),e.savingCostTotal=Math.round(e.savingCostTotal),e.savingCostActual=100*(1-(e.keyMetrics.costCurrentActual||0)/(e.keyMetrics.costBaseLastActual||1))||0,e.keyMetrics.endDateBaseLast&&e.keyMetrics.endDateCurrent&&(e.savingEndDate=this.helperDateDiff(new Date(e.keyMetrics.endDateBaseLast).toISOString(),new Date(e.keyMetrics.endDateCurrent).toISOString(),"w")||0,e.savingEndDate=Math.round(10*e.savingEndDate)/10),e.deliveryCompletionTotal=e.keyMetrics.deliverableCompletionBaseLastTotal?Math.round((e.keyMetrics.deliverableCompletionCurrentTotal||0)/e.keyMetrics.deliverableCompletionBaseLastTotal*100):100,e.deliveryCompletionActual=e.keyMetrics.deliverableCompletionBaseLastActual?Math.round((e.keyMetrics.deliverableCompletionCurrentActual||0)/e.keyMetrics.deliverableCompletionBaseLastActual*100):100,e.timeCompletionTotal=e.keyMetrics.timeCompletionBaseLastTotal?Math.round((e.keyMetrics.timeCompletionCurrentTotal||0)/e.keyMetrics.timeCompletionBaseLastTotal*100):100,e.timeCompletionActual=e.keyMetrics.timeCompletionBaseLastActual?Math.round((e.keyMetrics.timeCompletionCurrentActual||0)/e.keyMetrics.timeCompletionBaseLastActual*100):100,this.visbokeymetrics.push(e)}if(this.log("calc keyMetrics Result LEN "+this.visbokeymetrics.length),this.visbokeymetrics.length>0){this.sortKeyMetricsTable(void 0);let t=0;if(this.refDate){for(;t<this.visbokeymetrics.length&&!(Th(this.refDate,this.visbokeymetrics[t].timestamp)>=0);t++);t>=this.visbokeymetrics.length&&(t=this.visbokeymetrics.length-1)}this.setVpvActive(this.visbokeymetrics[t])}else this.switchView("All")}}sameDay(t,e){const i=new Date(t),n=new Date(e);return i.setHours(0,0,0,0),n.setHours(0,0,0,0),i.getTime()===n.getTime()}visboKeyMetricsCostOverTime(){this.graphOptionsLineChart.title=this.translate.instant("keyMetrics.chart.titleCostTrend"),this.graphOptionsLineChart.vAxis.title=this.translate.instant("keyMetrics.chart.yAxisCostTrend"),this.graphOptionsLineChart.colors=this.colorsDefault;const t=[];if(this.visboprojectversions){for(let e=0;e<this.visboprojectversions.length;e++)this.visboprojectversions[e].keyMetrics&&(e<this.visboprojectversions.length-1&&this.sameDay(this.visboprojectversions[e].timestamp,this.visboprojectversions[e+1].timestamp)?this.log(`visboKeyMetrics Skip Same Day ${this.visboprojectversions[e].timestamp}  ${this.visboprojectversions[e+1].timestamp}`):t.push([new Date(this.visboprojectversions[e].timestamp),Math.round(this.visboprojectversions[e].keyMetrics.costCurrentActual||0),Math.round(this.visboprojectversions[e].keyMetrics.costBaseLastActual||0),Math.round(this.visboprojectversions[e].keyMetrics.costCurrentTotal||0),Math.round(this.visboprojectversions[e].keyMetrics.costBaseLastTotal||0)]));if(0===t.length&&(this.log("keyMetricsCost empty"),t.push([new Date,0,0,0,0])),t.sort((function(t,e){return t[0]-e[0]})),1===t.length){const e=new Date(t[0][0]);e.setMonth(e.getMonth()+1),t.push([e,void 0,void 0,void 0,void 0])}t.push(["Timestamp",this.translate.instant("keyMetrics.shortAC"),this.translate.instant("keyMetrics.shortPV"),this.translate.instant("keyMetrics.shortEAC"),this.translate.instant("keyMetrics.shortBAC")]),t.reverse(),this.graphDataLineChart=t}}visboKeyMetricsEndDateOverTime(){this.graphOptionsLineChartEndDate.title=this.translate.instant("keyMetrics.chart.titleEndDateTrend"),this.graphOptionsLineChartEndDate.vAxis.title=this.translate.instant("keyMetrics.chart.yAxisEndDateTrend"),this.graphOptionsLineChartEndDate.colors=this.colorsEndDate;const t=[];if(!this.visboprojectversions)return;let e=Number.MAX_VALUE,i=Number.MIN_VALUE;for(let s=0;s<this.visboprojectversions.length;s++){if(!this.visboprojectversions[s].keyMetrics)continue;if(s<this.visboprojectversions.length-1&&this.sameDay(this.visboprojectversions[s].timestamp,this.visboprojectversions[s+1].timestamp)){this.log(`visboKeyMetrics Skip Same Day ${this.visboprojectversions[s].timestamp}  ${this.visboprojectversions[s+1].timestamp}`);continue}const n=new Date(this.visboprojectversions[s].keyMetrics.endDateCurrent).getTime()||0,r=new Date(this.visboprojectversions[s].keyMetrics.endDateBaseLast).getTime()||0;e=Math.min(e,n),e=Math.min(e,r),i=Math.max(i,n),i=Math.max(i,r);const o=_h(new Date(this.visboprojectversions[s].timestamp),"fullDateTime",this.currentLang),a=_h(new Date(this.visboprojectversions[s].keyMetrics.endDateCurrent),"fullDate",this.currentLang),l=_h(new Date(this.visboprojectversions[s].keyMetrics.endDateBaseLast),"fullDate",this.currentLang);t.push([new Date(this.visboprojectversions[s].timestamp),n,this.createCustomHTMLContent(o,a,l),r,this.createCustomHTMLContent(o,a,l)])}if(0===t.length&&(this.log("keyMetricsEndDate empty"),t.push([new Date,void 0,void 0,void 0,void 0])),t.sort((function(t,e){return t[0]-e[0]})),1===t.length){const e=new Date(t[0][0]);e.setMonth(e.getMonth()+1),t.push([e,void 0,void 0,void 0,void 0])}const n=new Date(e);n.setDate(1),n.setHours(0,0,0,0),n.setMonth(n.getMonth()-1);const r=new Date(i);for(r.setDate(1),r.setHours(0,0,0,0),r.setMonth(r.getMonth()+2),e=n.getTime(),i=r.getTime(),this.graphOptionsLineChartEndDate.vAxis.ticks=[];n.getTime()<=r.getTime();)this.graphOptionsLineChartEndDate.vAxis.ticks.push({v:n.getTime(),f:_h(n,"shortDate",this.currentLang)}),n.setMonth(n.getMonth()+1);t.unshift(["Timestamp",this.translate.instant("keyMetrics.shortEED"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("keyMetrics.shortBED"),{type:"string",role:"tooltip",p:{html:!0}}]),this.graphDataLineChart=t}createCustomHTMLContent(t,e,i){let n='<div style="padding:5px 5px 5px 5px;color:black;width:180px;"><div><b>'+t+"</b></div><div><table>";return n=n+"<tr><td>"+this.translate.instant("keyMetrics.longEED")+':</td><td align="right"><b>'+e+"</b></td></tr>",n=n+"<tr><td>"+this.translate.instant("keyMetrics.longBED")+':</td><td align="right"><b>'+i+"</b></td></tr>",n+="</table></div></div>",n}visboKeyMetricsDeliveryOverTime(){this.graphOptionsLineChart.title=this.translate.instant("keyMetrics.chart.titleDeliveryTrend"),this.graphOptionsLineChart.vAxis.title=this.translate.instant("keyMetrics.chart.yAxisDeliveryTrend"),this.graphOptionsLineChart.colors=this.colorsDefault;const t=[];if(!this.visboprojectversions)return;for(let i=0;i<this.visboprojectversions.length;i++)this.visboprojectversions[i].keyMetrics&&(i<this.visboprojectversions.length-1&&this.sameDay(this.visboprojectversions[i].timestamp,this.visboprojectversions[i+1].timestamp)||t.push([new Date(this.visboprojectversions[i].timestamp),Math.round(100*(this.visboprojectversions[i].keyMetrics.deliverableCompletionCurrentActual||0))/100,Math.round(100*(this.visboprojectversions[i].keyMetrics.deliverableCompletionBaseLastActual||0))/100,Math.round(100*(this.visboprojectversions[i].keyMetrics.deliverableCompletionCurrentTotal||0))/100,Math.round(100*(this.visboprojectversions[i].keyMetrics.deliverableCompletionBaseLastTotal||0))/100]));if(0===t.length&&(this.log("visboKeyMetrics empty"),t.push([new Date,0,0,0,0])),t.sort((function(t,e){return t[0]-e[0]})),1===t.length){const e=new Date(t[0][0]);e.setMonth(e.getMonth()+1),t.push([e,void 0,void 0,void 0,void 0])}const e=this.calcRangeAxis(t,"Delivery");this.graphOptionsLineChart.vAxis.maxValue=e,this.graphOptionsLineChart.vAxis.minValue=-e,t.push(["Timestamp",this.translate.instant("keyMetrics.shortADV"),this.translate.instant("keyMetrics.shortPDV"),this.translate.instant("keyMetrics.shortEDVC"),this.translate.instant("keyMetrics.shortDVAC")]),t.reverse(),this.log("visboKeyMetrics VP Delivery Completion  "+JSON.stringify(this.graphOptionsLineChart)),this.graphDataLineChart=t}visboKeyMetricsDeadlineOverTime(){this.graphOptionsLineChart.title=this.translate.instant("keyMetrics.chart.titleDeadlineTrend"),this.graphOptionsLineChart.vAxis.title=this.translate.instant("keyMetrics.chart.yAxisDeadlineTrend"),this.graphOptionsLineChart.colors=this.colorsDefault;const t=[];if(!this.visboprojectversions)return;for(let n=0;n<this.visboprojectversions.length;n++)this.visboprojectversions[n].keyMetrics&&(n<this.visboprojectversions.length-1&&this.sameDay(this.visboprojectversions[n].timestamp,this.visboprojectversions[n+1].timestamp)?this.log(`visboKeyMetrics Skip Same Day  ${this.visboprojectversions[n].timestamp} ${this.visboprojectversions[n+1].timestamp}`):t.push([new Date(this.visboprojectversions[n].timestamp),Math.round(100*(this.visboprojectversions[n].keyMetrics.timeCompletionCurrentActual||0))/100,Math.round(100*(this.visboprojectversions[n].keyMetrics.timeCompletionBaseLastActual||0))/100,Math.round(100*(this.visboprojectversions[n].keyMetrics.timeCompletionCurrentTotal||0))/100,Math.round(100*(this.visboprojectversions[n].keyMetrics.timeCompletionBaseLastTotal||0))/100]));0===t.length&&(this.log("visboKeyMetrics empty"),t.push([new Date,0,0,0,0])),t.sort((function(t,e){return t[0]-e[0]}));const e=t.length;if(this.log(`visboKeyMetrics duplicate ${e-1} ${JSON.stringify(this.visboprojectversions[e-1])}`),1===e){const e=new Date(t[0][0]);e.setMonth(e.getMonth()+1),t.push([e,void 0,void 0,void 0,void 0])}const i=this.calcRangeAxis(t,"Deadline");this.graphOptionsLineChart.vAxis.maxValue=i,this.graphOptionsLineChart.vAxis.minValue=-i,t.push(["Timestamp",this.translate.instant("keyMetrics.shortAD"),this.translate.instant("keyMetrics.shortPD"),this.translate.instant("keyMetrics.shortEDC"),this.translate.instant("keyMetrics.shortDAC")]),t.reverse(),this.graphDataLineChart=t}visboKeyMetricsDeadlineDelayOverTime(){this.graphOptionsLineChart.title=this.translate.instant("keyMetrics.chart.titleDeadlineDelayTrend"),this.graphOptionsLineChart.vAxis.title=this.translate.instant("keyMetrics.chart.yAxisDeadlineDelayTrend"),this.graphOptionsLineChart.vAxis.direction=-1,this.graphOptionsLineChart.colors=this.colorsDelay;const t=[];if(!this.visboprojectversions)return;for(let n=0;n<this.visboprojectversions.length;n++)this.visboprojectversions[n].keyMetrics&&(n<this.visboprojectversions.length-1&&this.sameDay(this.visboprojectversions[n].timestamp,this.visboprojectversions[n+1].timestamp)?this.log(`visboKeyMetrics Skip Same Day  ${this.visboprojectversions[n].timestamp} ${this.visboprojectversions[n+1].timestamp}`):t.push([new Date(this.visboprojectversions[n].timestamp),this.visboprojectversions[n].keyMetrics.timeDelayFinished,this.visboprojectversions[n].keyMetrics.timeDelayUnFinished]));0===t.length&&(this.log("visboKeyMetrics empty"),t.push([new Date,0,0])),t.sort((function(t,e){return t[0]-e[0]}));const e=t.length;if(this.log(`visboKeyMetrics duplicate ${e-1} ${JSON.stringify(this.visboprojectversions[e-1])}`),1===e){const e=new Date(t[0][0]);e.setMonth(e.getMonth()+1),t.push([e,void 0,void 0])}const i=this.calcRangeAxis(t,"Delay");this.graphOptionsLineChart.vAxis.maxValue=i,this.graphOptionsLineChart.vAxis.minValue=-i,t.push(["Timestamp",this.translate.instant("keyMetrics.finishedDeadlineDelay"),this.translate.instant("keyMetrics.unfinishedDeadlineDelay")]),t.reverse(),this.graphDataLineChart=t}visboKeyMetricsDeliveryDelayOverTime(){this.graphOptionsLineChart.title=this.translate.instant("keyMetrics.chart.titleDeliveryDelayTrend"),this.graphOptionsLineChart.vAxis.title=this.translate.instant("keyMetrics.chart.yAxisDeliveryDelayTrend"),this.graphOptionsLineChart.vAxis.direction=-1,this.graphOptionsLineChart.colors=this.colorsDelay;const t=[];if(!this.visboprojectversions)return;for(let n=0;n<this.visboprojectversions.length;n++)this.visboprojectversions[n].keyMetrics&&(n<this.visboprojectversions.length-1&&this.sameDay(this.visboprojectversions[n].timestamp,this.visboprojectversions[n+1].timestamp)?this.log(`visboKeyMetrics Skip Same Day  ${this.visboprojectversions[n].timestamp} ${this.visboprojectversions[n+1].timestamp}`):t.push([new Date(this.visboprojectversions[n].timestamp),this.visboprojectversions[n].keyMetrics.deliverableDelayFinished,this.visboprojectversions[n].keyMetrics.deliverableDelayUnFinished]));0===t.length&&(this.log("visboKeyMetrics empty"),t.push([new Date,0,0])),t.sort((function(t,e){return t[0]-e[0]}));const e=t.length;if(this.log(`visboKeyMetrics duplicate ${e-1} ${JSON.stringify(this.visboprojectversions[e-1])}`),1===e){const e=new Date(t[0][0]);e.setMonth(e.getMonth()+1),t.push([e,void 0,void 0])}const i=this.calcRangeAxis(t,"Delay");this.graphOptionsLineChart.vAxis.maxValue=i,this.graphOptionsLineChart.vAxis.minValue=-i,t.push(["Timestamp",this.translate.instant("keyMetrics.finishedDeliveryDelay"),this.translate.instant("keyMetrics.unfinishedDeliveryDelay")]),t.reverse(),this.graphDataLineChart=t}calcRangeAxis(t,e){let i=0;i=0;for(let n=0;n<t.length;n++)switch(e){case"Delivery":case"Deadline":i=Math.max(i,Math.abs(t[n][1]))}return i*=1.1,this.log(`RangeAxis for ${e}: ${i}`),i}switchChart(){this.chart=!this.chart,this.chartButton=this.translate.instant(this.chart?"vpKeyMetric.lbl.viewList":"vpKeyMetric.lbl.viewChart")}showHistory(t){this.history=t,this.historyButton=this.translate.instant(this.history?"vpKeyMetric.lbl.hideTrend":"vpKeyMetric.lbl.showTrend")}switchView(t,e=!1){(t=this.allViews.find(e=>e===t))?this.typeMetricChart=t:t=this.allViews[0],this.currentView=t,this.currentViewKM=e,this.showHistory(!1),this.updateUrlParam("view",t)}switchTo(t){if(this.log(`Switch Chart from ${this.typeMetricChart} to ${t} `),this.currentView="KeyMetrics",this.updateUrlParam("view",this.currentView),this.typeMetricChart===t)return void this.showHistory(!this.history);const e=this.typeMetricList.find(e=>e.metric===t).name;if(e)switch(this.typeMetricChart=t,this.typeMetric=e,this.showHistory(!0),t){case"Cost":this.visboKeyMetricsCostOverTime();break;case"EndDate":this.visboKeyMetricsEndDateOverTime();break;case"Deadline":this.visboKeyMetricsDeadlineOverTime();break;case"DeadlineDelay":this.visboKeyMetricsDeadlineDelayOverTime();break;case"DeliveryDelay":this.visboKeyMetricsDeliveryDelayOverTime();break;case"Delivery":this.visboKeyMetricsDeliveryOverTime()}}gotoVisboProjectVersions(){let t;this.log("goto VPV All Versions"),this.vpvKeyMetricActive&&(t=this.vpvKeyMetricActive.vpid),t&&this.router.navigate(["vpv/".concat(t)],{})}updateUrlParam(t,e){void 0===e&&(e=null);const i=new gb;"view"==t?i.view=e:"refDate"==t&&(i.refDate=e),this.switchViewChild.emit(i)}chartSelectRow(t,e,i){this.log(`Line Chart: User selected row ${t} col ${e} Label ${i} Len ${this.graphDataLineChart.length}`);const n=new Date(i);let r=this.visbokeymetrics.findIndex(t=>t.timestamp.toString()===n.toISOString());r<0&&(r=0),this.setVpvActive(this.visbokeymetrics[r],!0),this.log(`Line Chart: User selected ${t} ${e} ${this.vpvKeyMetricActive._id} ${this.vpvKeyMetricActive.timestamp}`)}listSelectRow(t){this.log(`List: User selected ${t._id} ${t.name}`),this.setVpvActive(t,!0)}setVpvActive(t,e=!1){if(!t)return;this.refDate=new Date(t.timestamp);const i=t.keyMetrics;let n;if(this.vpvKeyMetricActive=t,this.log(`VPV Active: vpv: ${t._id} ${this.vpvKeyMetricActive._id} ${this.vpvKeyMetricActive.timestamp}`),e&&this.updateUrlParam("refDate",t.timestamp.toString()),n=i.costCurrentActual/(i.costBaseLastActual||1),this.qualityCost=n<1.001?1:n<1.05?2:3,n=i.costCurrentTotal/(i.costBaseLastTotal||1),this.qualityTotalCost=n<1.001?1:n<1.05?2:3,i.endDateBaseLast){const t=i.endDateCurrent?new Date(i.endDateCurrent):new Date,e=new Date(i.endDateBaseLast);n=(t.getTime()-e.getTime())/1e3/3600/24/7,this.qualityEndDiffWeeks=n}else n=void 0;this.qualityEndDate=n<=0?1:n<=4?2:n>4?3:void 0,n=i.timeCompletionBaseLastActual?i.timeCompletionCurrentActual/i.timeCompletionBaseLastActual:1,this.qualityDeadline=n>.999?1:n>.95?2:3,n=i.deliverableCompletionBaseLastActual?i.deliverableCompletionCurrentActual/i.deliverableCompletionBaseLastActual:1,this.qualityDelivery=n>.999?1:n>.95?2:3,n=i.deliverableDelayFinished||0,this.delayActualDelivery=n<=0?1:n>7?2:3,n=i.deliverableDelayUnFinished||0,this.delayTotalDelivery=n<=0?1:n>7?2:3,n=i.timeDelayFinished||0,this.delayActualDeadline=n<=0?1:n<=7?2:3,n=i.timeDelayUnFinished||0,this.delayTotalDeadline=n<=0?1:n<=7?2:3,n=new Date(i.endDateCurrent).getTime()-new Date(i.endDateBaseLast).getTime(),this.delayEndDate=Math.round(n/1e3/60/60/24)/7,this.log(`Quality End Date ${i.endDateCurrent} Cost ${this.qualityCost} Del. ${this.qualityDelivery} Dead. ${this.qualityDeadline} EndDate ${this.delayEndDate}, Delay Deadline ${this.delayActualDeadline} / ${this.delayTotalDeadline} Delay Delivery ${this.delayActualDelivery} / ${this.delayTotalDelivery} `)}helperDateDiff(t,e,i){const n=new Date(t),r=new Date(e);let s=n.getTime()-r.getTime();return"w"===i?s=s/1e3/60/60/24/7:"d"===i?s=s/1e3/60/60/24:s/=1e3,s}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}sortKeyMetricsTable(t){this.visbokeymetrics&&(void 0!==t?(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t:!this.sortAscending):(this.sortColumn=1,this.sortAscending=!1),this.log(`Sort Key Metrics: Col ${t} Asc ${this.sortAscending}`),1===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return Th(t.timestamp,e.timestamp)})):2===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.savingCostActual-e.savingCostActual})):3===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.savingCostTotal-e.savingCostTotal})):4===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return(null===(i=t.keyMetrics)||void 0===i?void 0:i.costBaseLastActual)-(null===(n=e.keyMetrics)||void 0===n?void 0:n.costBaseLastActual)})):5===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return(null===(i=t.keyMetrics)||void 0===i?void 0:i.costBaseLastTotal)-(null===(n=e.keyMetrics)||void 0===n?void 0:n.costBaseLastTotal)})):6===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.ampelStatus-e.ampelStatus})):7===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return(null===(i=t.keyMetrics)||void 0===i?void 0:i.costCurrentActual)-(null===(n=e.keyMetrics)||void 0===n?void 0:n.costCurrentActual)})):8===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return(null===(i=t.keyMetrics)||void 0===i?void 0:i.costCurrentTotal)-(null===(n=e.keyMetrics)||void 0===n?void 0:n.costCurrentTotal)})):10===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return(null===(i=t.keyMetrics)||void 0===i?void 0:i.timeCompletionCurrentActual)-(null===(n=e.keyMetrics)||void 0===n?void 0:n.timeCompletionCurrentActual)})):11===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.timeCompletionActual-e.timeCompletionActual})):12===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return(null===(i=t.keyMetrics)||void 0===i?void 0:i.timeCompletionBaseLastTotal)-(null===(n=e.keyMetrics)||void 0===n?void 0:n.timeCompletionBaseLastTotal)})):13===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return(null===(i=t.keyMetrics)||void 0===i?void 0:i.timeDelayFinished)-(null===(n=e.keyMetrics)||void 0===n?void 0:n.timeDelayFinished)})):14===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return(null===(i=t.keyMetrics)||void 0===i?void 0:i.timeDelayUnFinished)-(null===(n=e.keyMetrics)||void 0===n?void 0:n.timeDelayUnFinished)})):20===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.deliveryCompletionActual-e.deliveryCompletionActual})):21===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return(null===(i=t.keyMetrics)||void 0===i?void 0:i.deliverableCompletionCurrentActual)-(null===(n=e.keyMetrics)||void 0===n?void 0:n.deliverableCompletionCurrentActual)})):22===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return(null===(i=t.keyMetrics)||void 0===i?void 0:i.deliverableCompletionCurrentTotal)-(null===(n=e.keyMetrics)||void 0===n?void 0:n.deliverableCompletionCurrentTotal)})):23===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return(null===(i=t.keyMetrics)||void 0===i?void 0:i.deliverableDelayFinished)-(null===(n=e.keyMetrics)||void 0===n?void 0:n.deliverableDelayFinished)})):24===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return(null===(i=t.keyMetrics)||void 0===i?void 0:i.deliverableDelayUnFinished)-(null===(n=e.keyMetrics)||void 0===n?void 0:n.deliverableDelayUnFinished)})):25===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return(null===(i=t.keyMetrics)||void 0===i?void 0:i.deliverableCompletionBaseLastTotal)-(null===(n=e.keyMetrics)||void 0===n?void 0:n.deliverableCompletionBaseLastTotal)})):26===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return(null===(i=t.keyMetrics)||void 0===i?void 0:i.deliverableCompletionBaseLastActual)-(null===(n=e.keyMetrics)||void 0===n?void 0:n.deliverableCompletionBaseLastActual)})):31===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return Th(null===(i=t.keyMetrics)||void 0===i?void 0:i.endDateCurrent,null===(n=e.keyMetrics)||void 0===n?void 0:n.endDateCurrent)})):32===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return Th(null===(i=t.keyMetrics)||void 0===i?void 0:i.endDateBaseLast,null===(n=e.keyMetrics)||void 0===n?void 0:n.endDateBaseLast)})):33===this.sortColumn&&this.visbokeymetrics.sort((function(t,e){return t.savingEndDate-e.savingEndDate})),this.sortAscending||this.visbokeymetrics.reverse())}log(t){this.messageService.add("CompVisboViewCost: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(wV),Rs(Rh),Rs(Df),Rs(Fg),Rs(rf),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-comp-viewkeymetrics"]],inputs:{vpvid:"vpvid",visboprojectversions:"visboprojectversions",combinedPerm:"combinedPerm"},outputs:{switchViewChild:"switchViewChild"},features:[_e],decls:33,vars:16,consts:[[1,"container"],["class","table table-hover table-sortable",4,"ngIf"],[4,"ngIf"],["indicator",""],["trafficLight",""],["highlight",""],["id","VpvLegend","tabindex","-1","role","dialog","aria-labelledby","VpvDetailsTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-body"],[1,"table"],[1,"modal-footer","align-items-end"],["data-dismiss","modal",1,"btn","btn-primary"],[1,"table","table-hover","table-sortable"],[1,"d-none","d-md-table-cell"],[3,"click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"title","click"],["type","button",1,"btn",3,"title","click"],[3,"title"],[1,"ml-1"],["class","ml-1",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[1,"fa",3,"ngClass"],[1,"fas","fa-lightbulb",3,"ngClass"],[3,"ngClass"],[1,"btn-group","row"],[1,"mx-1",3,"click"],["type","button","class","mx-1",3,"click",4,"ngIf"],["data-toggle","modal","data-target","#VpvLegend",1,"fas","fa-info-circle","mx-2","mt-2","text-secondary",3,"title"],["class","mt-1",4,"ngIf"],["type","button",1,"mx-1",3,"click"],[1,"mt-1"],[3,"graphData","graphOptions","parentThis","language"],[1,"text-right",3,"title","click"],[1,"text-right","d-none","d-md-table-cell",3,"title","click"],[1,"text-right","d-none","d-md-table-cell",3,"click"],["data-toggle","modal","data-target","#ProjectDetail",3,"click",4,"ngFor","ngForOf"],["data-toggle","modal","data-target","#ProjectDetail",3,"click"],[1,"text-right"],[1,"text-right",3,"title"],[1,"text-right",3,"click"],["class","text-right d-none d-md-table-cell",3,"click",4,"ngIf"],["class","text-right",4,"ngIf"]],template:function(t,e){1&t&&(Ns(0,"form"),Ns(1,"div",0),Gs(2,rM,23,19,"table",1),Gs(3,sM,3,3,"h3",2),Fs(),Fs(),Bs(4,"hr"),Gs(5,aM,1,5,"ng-template",null,3,ja),Gs(7,cM,1,6,"ng-template",null,4,ja),Gs(9,uM,2,5,"ng-template",null,5,ja),Gs(11,$M,9,7,"div",2),Ns(12,"div",6),Ns(13,"div",7),Ns(14,"div",8),Ns(15,"div",9),Ns(16,"table",10),Ns(17,"thead"),Ns(18,"tr"),Ns(19,"th"),mo(20),Ua(21,"translate"),Fs(),Ns(22,"th"),mo(23),Ua(24,"translate"),Fs(),Fs(),Fs(),Gs(25,NM,29,24,"tbody",2),Gs(26,FM,29,24,"tbody",2),Gs(27,BM,15,12,"tbody",2),Gs(28,HM,29,24,"tbody",2),Fs(),Ns(29,"div",11),Ns(30,"button",12),mo(31),Ua(32,"translate"),Fs(),Fs(),Fs(),Fs(),Fs(),Fs()),2&t&&(_n(2),js("ngIf",e.vpvKeyMetricActive),_n(1),js("ngIf",!e.vpvKeyMetricActive),_n(8),js("ngIf",e.history&&"KeyMetrics"==e.currentView),_n(9),fo(Ea(21,10,"keyMetrics.lbl.shortcut")),_n(3),fo(Ea(24,12,"keyMetrics.lbl.explanation")),_n(2),js("ngIf","Cost"==e.typeMetricChart),_n(1),js("ngIf","Deadline"==e.typeMetricChart),_n(1),js("ngIf","DeadlineDelay"==e.typeMetricChart),_n(1),js("ngIf","Delivery"==e.typeMetricChart),_n(3),fo(Ea(32,14,"vpKeyMetric.btn.back")))},directives:[Ou,Fd,Tu,jc,Bc,Oc,PD,Lc],pipes:[av,zc,qc],encapsulation:2}),t})();function qM(t,e){1&t&&qs(0)}function zM(t,e){1&t&&qs(0)}const QM=function(t){return{level:t}};function WM(t,e){if(1&t&&(Ns(0,"div",16),Ns(1,"h5",17),Ns(2,"strong",18),Gs(3,qM,1,0,"ng-container",19),Fs(),mo(4),Ua(5,"translate"),Fs(),Ns(6,"div",20),Ns(7,"div",21),Ns(8,"div",22),mo(9),Ua(10,"translate"),Ua(11,"translate"),Fs(),Ns(12,"div",23),Ns(13,"strong",18),Gs(14,zM,1,0,"ng-container",19),Fs(),mo(15),Ua(16,"number"),Fs(),Fs(),Ns(17,"div",21),Ns(18,"div",22),mo(19),Ua(20,"translate"),Ua(21,"translate"),Fs(),Ns(22,"div",23),mo(23),Ua(24,"number"),Fs(),Fs(),Fs(),Fs()),2&t){const t=Xs(2),e=Ls(2);_n(3),js("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(27,QM,t.getLevel(t.vpvTotalCostCurrent,t.vpvTotalCostBaseLine))),_n(1),vo(" ",Ea(5,11,"compViewCost.titleBox"),""),_n(5),bo(" ",Ea(10,13,"keyMetrics.shortEAC")," (",Ea(11,15,"keyMetrics.longEAC"),") "),_n(5),js("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(29,QM,t.getLevel(t.vpvTotalCostCurrent,t.vpvTotalCostBaseLine))),_n(1),vo(" ",Oa(16,17,t.vpvTotalCostCurrent,"1.0-0")," T\u20ac "),_n(4),bo(" ",Ea(20,20,"keyMetrics.shortBAC")," (",Ea(21,22,"keyMetrics.longBAC"),") "),_n(4),vo(" ",Oa(24,24,t.vpvTotalCostBaseLine,"1.0-0")," T\u20ac ")}}function JM(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-combo-chart",24),Fs()),2&t){const t=Xs(2);_n(1),js("graphData",t.graphDataComboChart)("graphOptions",t.graphOptionsComboChart)("parentThis",t.parentThis)("language",t.currentLang)}}function YM(t,e){1&t&&(Ns(0,"div"),Ns(1,"h3",25),mo(2),Ua(3,"translate"),Fs(),Fs()),2&t&&(_n(2),vo(" ",Ea(3,1,"compViewCost.msg.noCost")," "))}function ZM(t,e){if(1&t){const t=zs();Ns(0,"div",9),Js("resized",(function(e){return ei(t),Xs().onResized(e)})),Ns(1,"div",10),Ns(2,"div",11),Bs(3,"div",12),Fs(),Gs(4,WM,25,31,"div",13),Fs(),Gs(5,JM,2,4,"div",14),Gs(6,YM,4,3,"div",14),Bs(7,"i",15),Ua(8,"translate"),Fs()}if(2&t){const t=Xs();_n(4),js("ngIf",t.vpHasCost("")),_n(1),js("ngIf",t.graphDataComboChart.length>0),_n(1),js("ngIf",!t.vpHasCost("cost")),_n(1),to("title",Ea(8,4,"keyMetrics.lbl.showLegend"))}}const XM=function(t,e,i){return{"fa-check-circle text-success":t,"fa-exclamation-triangle text-warning":e,"fa-exclamation-circle text-danger":i}};function tS(t,e){if(1&t&&(Ns(0,"strong"),Bs(1,"i",26),Fs()),2&t){const t=e.level;_n(1),js("ngClass",Ma(1,XM,1==t,2==t,3==t))}}let eS=(()=>{class t{constructor(t,e,i,n,r,s){this.visboprojectversionService=t,this.messageService=e,this.alertService=i,this.route=n,this.router=r,this.translate=s,this.parentThis=this,this.colors=["#F7941E","#BDBDBD","#458CCB"],this.graphDataComboChart=[],this.graphOptionsComboChart={width:"100%",title:"Monthly Cost comparison: plan-to-date vs. baseline",animation:{startup:!0,duration:200},legend:{position:"top"},explorer:{actions:["dragToZoom","rightClickToReset"],maxZoomIn:.01},colors:this.colors,seriesType:"bars",series:{0:{type:"line",lineWidth:4,pointSize:0}},isStacked:!0,tooltip:{isHtml:!0},vAxis:{title:"Monthly Cost",format:"# T\u20ac",minorGridlines:{count:0,color:"none"}},hAxis:{format:"MMM yy",gridlines:{color:"#FFF",count:-1}},minorGridlines:{count:0,color:"none"}},this.permVC=Av,this.permVP=Pv}ngOnInit(){this.currentLang=this.translate.currentLang,this.visboCostCalc()}ngOnChanges(){this.log(`Cost Changes  ${this.vpvActive._id} ${this.vpvActive.timestamp}`),this.chartActive=void 0,void 0!==this.currentVpvId&&this.vpvActive._id!==this.currentVpvId&&this.visboCostCalc()}onResized(t){t||this.log("No event in Resize");let e=0;this.chartActive&&(e=(new Date).getTime()-this.chartActive.getTime()),e<1e3||(this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(()=>{this.visboCostCalc(),this.timeoutID=void 0},500))}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}visboCostCalc(){this.vpvActive&&(this.currentVpvId=this.vpvActive._id,this.log(`Cost Calc for Version  ${this.vpvActive._id} ${this.vpvActive.timestamp}`),this.visboprojectversionService.getCost(this.vpvActive._id).subscribe(t=>{this.log(`get VPV Calc: Get ${t.length} vpvs with ${t[0].cost.length} cost entries`),1===t.length&&t[0].cost?(this.log(`Store Cost for ${t[0]._id} Len ${t[0].cost.length} Actual ${t[0].actualDataUntil}`),this.vpvCost=t[0].cost,this.vpvActualDataUntil=new Date(t[0].actualDataUntil)):(this.log("get VPV Calc: Reset Cost to empty "),this.vpvCost=[]),this.visboViewCostOverTime()},t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("compViewCost.msg.errorPermVersion",{name:this.vpvActive.name});this.alertService.error(t)}else this.alertService.error(Lh(t))}))}visboViewCostOverTime(){this.graphOptionsComboChart.title=this.translate.instant("keyMetrics.chart.titleCostOverTime"),this.graphOptionsComboChart.vAxis.title=this.translate.instant("keyMetrics.chart.yAxisCostOverTime");const t=[];if(!this.vpvCost)return;const e=this.vpvCost,i=this.vpvActualDataUntil.getTime();if(this.log("ViewCostOverTime Actual Until "+this.vpvActualDataUntil),0===e.length)return;this.vpvTotalCostBaseLine=0,this.vpvTotalCostCurrent=0;for(let r=0;r<e.length;r++)new Date(e[r].currentDate).getTime()<i?t.push([new Date(e[r].currentDate),Math.round(10*e[r].baseLineCost)/10||0,this.createCustomHTMLContent(e[r],!0),Math.round(10*e[r].currentCost)/10||0,this.createCustomHTMLContent(e[r],!0),0,""]):t.push([new Date(e[r].currentDate),Math.round(10*e[r].baseLineCost)/10||0,this.createCustomHTMLContent(e[r],!1),0,"",Math.round(10*e[r].currentCost)/10||0,this.createCustomHTMLContent(e[r],!1)]),this.vpvTotalCostBaseLine+=e[r].baseLineCost||0,this.vpvTotalCostCurrent+=e[r].currentCost||0;0===t.length&&(this.log("ViewCostOverTime Result empty"),t.push([new Date,0,"",0,0]));const n=t.length;if(n<1&&this.log("ViewCostOverTime Empty"),1===n){const e=new Date(t[0][0]);e.setMonth(e.getMonth()+1),t.push([e,void 0,void 0,void 0,void 0,void 0,void 0,void 0])}t.unshift(["Timestamp",this.translate.instant("keyMetrics.baselinePV"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("keyMetrics.planAC"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("keyMetrics.planETC"),{type:"string",role:"tooltip",p:{html:!0}}]),this.graphDataComboChart=t,this.chartActive=new Date}chartSelectRow(t,e,i){this.log(`chart Select Row ${t} ${e} ${i} `)}createCustomHTMLContent(t,e){let i='<div style="padding:5px 5px 5px 5px;color:black;width:180px;"><div><b>'+_h(new Date(t.currentDate),"shortDate",this.currentLang)+"</b></div><div><table>";const n=this.translate.instant("keyMetrics.baselinePV"),r=this.translate.instant("keyMetrics.planAC"),s=this.translate.instant("keyMetrics.planETC");return i=i+"<tr><td>"+n+':</td><td align="right"><b>'+Math.round(10*t.baseLineCost)/10+" T\u20ac</b></td></tr>",i=i+"<tr><td>"+(e?r:s)+':</td align="right"><td><b>'+Math.round(10*t.currentCost)/10+" T\u20ac</b></td></tr>",i+="</table></div></div>",i}getLevel(t,e){let i=1;return e&&(i=t/e),i<=1?1:i<=1.05?2:3}vpHasCost(t){let e=!1;return this.vpvActive?("keyMetric"==t?e=this.vpvActive.keyMetrics&&(this.vpvActive.keyMetrics.costBaseLastTotal>0||this.vpvActive.keyMetrics.costCurrentTotal>0):this.vpvCost&&this.vpvCost.length>0&&(e=!0),e):e}log(t){this.messageService.add("CompVisboViewCost: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(wV),Rs(Rh),Rs(Df),Rs(Fg),Rs(rf),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-comp-viewcost"]],inputs:{vpvActive:"vpvActive",combinedPerm:"combinedPerm"},features:[_e],decls:42,vars:28,consts:[["class","well",3,"resized",4,"ngIf"],["indicator",""],["id","VpvLegend","tabindex","-1","role","dialog","aria-labelledby","VpvDetailsTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-body"],[1,"table","table-hover"],[1,"modal-footer","align-items-end"],["data-dismiss","modal",1,"btn","btn-primary"],[1,"well",3,"resized"],[1,"row","row-cols-1","row-cols-lg-2"],[1,"col","col-sm-12","col-lg-8"],[1,"row","text-dark"],["class","col-sm-12 col-md-10 col-lg-4 card align-right px-0",4,"ngIf"],[4,"ngIf"],["data-toggle","modal","data-target","#VpvLegend",1,"fas","fa-info-circle","fa-lg","mx-2","mt-2","text-secondary",3,"title"],[1,"col-sm-12","col-md-10","col-lg-4","card","align-right","px-0"],[1,"card-header","p-2"],[1,"mr-1"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"card-body","p-2"],[1,"row"],[1,"col","col-sm-8"],[1,"col","col-sm-4","text-right"],[3,"graphData","graphOptions","parentThis","language"],[1,"d-flex","justify-content-center"],[1,"fa",3,"ngClass"]],template:function(t,e){1&t&&(Gs(0,ZM,9,6,"div",0),Gs(1,tS,2,5,"ng-template",null,1,ja),Ns(3,"div",2),Ns(4,"div",3),Ns(5,"div",4),Ns(6,"div",5),Ns(7,"table",6),Ns(8,"thead"),Ns(9,"tr"),Ns(10,"th"),mo(11),Ua(12,"translate"),Fs(),Ns(13,"th"),mo(14),Ua(15,"translate"),Fs(),Fs(),Fs(),Ns(16,"tbody"),Ns(17,"tr"),Ns(18,"td"),mo(19),Ua(20,"translate"),Fs(),Ns(21,"td"),mo(22),Ua(23,"translate"),Fs(),Fs(),Ns(24,"tr"),Ns(25,"td"),mo(26),Ua(27,"translate"),Fs(),Ns(28,"td"),mo(29),Ua(30,"translate"),Fs(),Fs(),Ns(31,"tr"),Ns(32,"td"),mo(33),Ua(34,"translate"),Fs(),Ns(35,"td"),mo(36),Ua(37,"translate"),Fs(),Fs(),Fs(),Fs(),Ns(38,"div",7),Ns(39,"button",8),mo(40),Ua(41,"translate"),Fs(),Fs(),Fs(),Fs(),Fs(),Fs()),2&t&&(js("ngIf",e.hasVPPerm(e.permVP.ViewAudit)),_n(11),fo(Ea(12,10,"keyMetrics.lbl.shortcut")),_n(3),fo(Ea(15,12,"keyMetrics.lbl.explanation")),_n(5),fo(Ea(20,14,"keyMetrics.shortPV")),_n(3),fo(Ea(23,16,"keyMetrics.longPV")),_n(4),fo(Ea(27,18,"keyMetrics.shortAC")),_n(3),fo(Ea(30,20,"keyMetrics.longAC")),_n(4),fo(Ea(34,22,"keyMetrics.shortETC")),_n(3),fo(Ea(37,24,"keyMetrics.longETC")),_n(4),fo(Ea(41,26,"compViewCost.btn.back")))},directives:[jc,MV,Bc,TV,Oc],pipes:[av,zc],encapsulation:2}),t})(),iS=(()=>{class t{constructor(t){this.gChartService=t}ngOnInit(){this.language||(this.language="de"),this.gLib=this.gChartService.getGoogle(),this.gLib.charts.load("current",{packages:["corechart","table"],language:this.language}),this.gLib.charts.setOnLoadCallback(this.drawChart.bind(this)),this.elementID&&""!==this.elementID||(this.elementID="divPieChart")}ngOnChanges(){this.initialised&&this.drawChart()}drawChart(){console.log("Google Chart Pie Chart Draw "+this.graphData.length);const t=new this.gLib.visualization.PieChart(document.getElementById(this.elementID)),e=new this.gLib.visualization.DataTable,i=new this.gLib.visualization.DataTable,n=this.parentThis;for(let o=0;o<this.graphLegend.length;o++)e.addColumn(this.graphLegend[o][0],this.graphLegend[o][1]);if(e.addRows(this.graphData),this.graphDataBefore&&this.graphDataBefore.length>0){for(let t=0;t<this.graphLegend.length;t++)i.addColumn(this.graphLegend[t][0],this.graphLegend[t][1]);i.addRows(this.graphDataBefore)}const r={title:"Pie Chart Title",sliceVisibilityThreshold:0};function s(){const i=t.getSelection()[0];if(n)if(i){const t=e.getValue(i.row,0),r=e.getValue(i.row,1);n.chartSelectRow&&n.chartSelectRow(i.row,t,r)}else n.chartSelectRow(void 0,void 0,void 0);else console.log("The user clicked and this is undefined")}if(this.graphDataBefore&&0!==this.graphDataBefore.length){const n=t.computeDiff(i,e);this.gLib.visualization.events.addListener(t,"select",s),t.draw(n,this.graphOptions||r)}else this.gLib.visualization.events.addListener(t,"select",s),t.draw(e,this.graphOptions||r);this.initialised=!0}}return t.\u0275fac=function(e){return new(e||t)(Rs(xV))},t.\u0275cmp=le({type:t,selectors:[["app-pie-chart"]],inputs:{elementID:"elementID",graphData:"graphData",graphDataBefore:"graphDataBefore",language:"language",graphLegend:"graphLegend",graphOptions:"graphOptions",parentThis:"parentThis"},features:[_e],decls:1,vars:1,consts:[[3,"id"]],template:function(t,e){1&t&&Bs(0,"div",0),2&t&&to("id",e.elementID)},styles:["#divPieChart[_ngcontent-%COMP%]{width:100%;height:300px}"]}),t})();function nS(t,e){if(1&t&&(Ns(0,"option",31),mo(1),Fs()),2&t){const t=e.$implicit;to("value",t.name),_n(1),fo(t.localName)}}function rS(t,e){if(1&t){const t=zs();Ns(0,"div",26),Ns(1,"div",27),Ns(2,"button",28),Js("click",(function(){return ei(t),Xs(2).toggleGantt()})),mo(3),Fs(),Ns(4,"select",29),Js("ngModelChange",(function(e){return ei(t),Xs(2).type=e}))("change",(function(){return ei(t),Xs(2).switchView()})),Gs(5,nS,2,2,"option",30),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(3),fo(t.buttonGantt),_n(1),js("ngModel",t.type),_n(1),js("ngForOf",t.listType)}}function sS(t,e){if(1&t&&(Ns(0,"div",33),Ns(1,"div",34),Bs(2,"app-pie-chart",35),Fs(),Fs()),2&t){const t=Xs(3);_n(2),js("elementID",t.divAllPieChart)("graphData",t.graphAllDataPieChart)("graphDataBefore",t.graphBeforeAllDataPieChart)("graphLegend",t.graphAllPieLegend)("graphOptions",t.graphAllOptionsPieChart)("parentThis",t.parentThis)("language",t.currentLang)}}function oS(t,e){if(1&t&&(Ns(0,"div",26),Gs(1,sS,3,7,"div",32),Fs()),2&t){const t=Xs(2);_n(1),js("ngIf",t.graphAllDataPieChart.length>1)}}function aS(t,e){if(1&t){const t=zs();Ns(0,"span"),Ns(1,"a",40),Js("click",(function(){ei(t);const i=e.$implicit,n=e.index;return Xs(4).ganttSelectPath(i,n)})),mo(2),Fs(),mo(3," / "),Fs()}if(2&t){const t=e.$implicit;_n(2),fo(t)}}function lS(t,e){if(1&t&&(Ns(0,"div",38),Gs(1,aS,4,1,"span",39),Fs()),2&t){const t=Xs(3);_n(1),js("ngForOf",t.getBreadCrumb())}}function cS(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"div"),Bs(2,"app-timeline-chart",41),Fs(),Fs()),2&t){const t=Xs(3);_n(2),js("graphData",t.graphDataDeadlinesGantt)("graphOptions",t.graphOptionsDeadlinesGantt)("parentThis",t.parentThis)}}function dS(t,e){if(1&t&&(Ns(0,"div",26),Gs(1,lS,2,1,"div",36),Gs(2,cS,3,3,"div",37),Fs()),2&t){const t=Xs(2);_n(1),js("ngIf",t.showBreadCrumb()),_n(1),js("ngIf",t.graphDataDeadlinesGantt&&t.graphDataDeadlinesGantt.length>1)}}function uS(t,e){if(1&t){const t=zs();Ns(0,"th",42),Js("click",(function(){return ei(t),Xs(2).sortDeadlineTable(7)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"compViewDeadline.lbl.endDatePFV")))}function hS(t,e){if(1&t){const t=zs();Ns(0,"th",43),Js("click",(function(){return ei(t),Xs(2).sortDeadlineTable(5)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"compViewDeadline.lbl.change")))}function pS(t,e){1&t&&qs(0)}function gS(t,e){if(1&t&&(Ns(0,"td",54),mo(1),Ua(2,"date"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.endDatePFV,"dd.MM.yy"))}}function mS(t,e){if(1&t&&(Ns(0,"td",55),Ua(1,"date"),mo(2),Ua(3,"number"),Fs()),2&t){const t=Xs().$implicit;eo("title","",Oa(1,2,t.endDatePFV,"dd.MM.yy")," (baseline)"),_n(2),fo(Oa(3,5,t.changeDays/7,"1.0-1"))}}function fS(t,e){if(1&t&&(Ns(0,"td",49),mo(1),Ua(2,"number"),Fs()),2&t){const t=Xs().$implicit;_n(1),vo("",Oa(2,1,100*t.percentDone,"1.0-0")," %")}}function vS(t,e){if(1&t&&(Ns(0,"td",56),mo(1),Ua(2,"number"),Fs()),2&t){const t=Xs().$implicit;_n(1),vo("",Oa(2,1,100*t.percentDone,"1.0-0")," %")}}function bS(t,e){1&t&&qs(0)}const yS=function(t,e){return{level:t,text:e}},CS=function(t){return{level:t}};function VS(t,e){if(1&t){const t=zs();Ns(0,"tr",44),Js("click",(function(){ei(t);const i=e.index;return Xs(2).helperDeadline(i)})),Ns(1,"td",45),Gs(2,pS,1,0,"ng-container",46),Fs(),Ns(3,"td",47),mo(4),Fs(),Gs(5,gS,3,4,"td",48),Ns(6,"td",49),mo(7),Ua(8,"date"),Fs(),Gs(9,mS,4,8,"td",50),Gs(10,fS,3,4,"td",51),Gs(11,vS,3,4,"td",52),Ns(12,"td",53),Gs(13,bS,1,0,"ng-container",46),Fs(),Fs()}if(2&t){const t=e.$implicit;Xs();const i=Ls(27),n=Ls(29),r=Xs();_n(1),to("title",r.getFullName(t)),_n(1),js("ngTemplateOutlet",i)("ngTemplateOutletContext",Da(15,yS,r.getStatus(t),r.getShortText(r.getFullName(t),100,"right"))),_n(2),fo(t.type),_n(1),js("ngIf",r.switchType),_n(2),fo(Oa(8,12,t.endDateVPV,"dd.MM.yy")),_n(2),js("ngIf",r.switchType),_n(1),js("ngIf",r.inFuture(t.endDateVPV)||1==t.percentDone),_n(1),js("ngIf",!(r.inFuture(t.endDateVPV)||1==t.percentDone)),_n(1),to("title",t.trafficlightDesc),_n(1),js("ngTemplateOutlet",n)("ngTemplateOutletContext",ka(18,CS,t.trafficlight))}}const wS=function(t,e,i,n,r,s){return{"font-weight-normal":t,"font-weight-bold":e,my_darkgreen:i,my_green:n,my_orange:r,my_red:s}};function AS(t,e){if(1&t&&(Ns(0,"i",57),mo(1),Fs()),2&t){const t=e.level,i=e.text;js("ngClass",Ia(2,wS,-1==t,t>=0,0==t,1==t,2==t,3==t)),_n(1),vo(" ",i," ")}}const PS=function(t,e,i,n){return{"d-none":t,"text-success":e,"text-warning":i,"text-danger":n}};function kS(t,e){if(1&t&&Bs(0,"i",58),2&t){const t=e.level;js("ngClass",Sa(1,PS,0==t,1==t,2==t,3==t))}}function DS(t,e){if(1&t&&(Ns(0,"div",60),Ns(1,"label",61),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",62),mo(5),Ua(6,"date"),Fs(),Fs()),2&t){const t=Xs(3);_n(2),vo("",Ea(3,2,"compViewDeadline.lbl.endDatePFV"),":"),_n(3),fo(Oa(6,4,t.filteredDeadline[t.deadlineIndex].endDatePFV,"dd.MM.yy"))}}function MS(t,e){if(1&t&&(Ns(0,"div",60),Ns(1,"label",61),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",62),mo(5),Ua(6,"date"),Fs(),Fs()),2&t){const t=Xs(3);_n(2),vo("",Ea(3,2,"compViewDeadline.lbl.endDateVPV"),":"),_n(3),fo(Oa(6,4,t.filteredDeadline[t.deadlineIndex].endDateVPV,"dd.MM.yy"))}}function SS(t,e){if(1&t&&(Ns(0,"div",60),Ns(1,"label",61),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",62),mo(5),Ua(6,"number"),Fs(),Fs()),2&t){const t=Xs(3);_n(2),vo("",Ea(3,2,"compViewDeadline.lbl.done"),":"),_n(3),vo("",Oa(6,4,100*t.filteredDeadline[t.deadlineIndex].percentDone,"1.0-0")," %")}}function IS(t,e){1&t&&qs(0)}function xS(t,e){if(1&t&&(Ns(0,"div",60),Ns(1,"label",61),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",62),Ns(5,"span",64),Gs(6,IS,1,0,"ng-container",46),Fs(),Ns(7,"span",65),mo(8),Fs(),Fs(),Fs()),2&t){Xs(2);const t=Ls(29),e=Xs();_n(2),vo("",Ea(3,5,"compViewDeadline.lbl.trafficlight"),":"),_n(3),to("title",e.filteredDeadline[e.deadlineIndex].trafficlightDesc),_n(1),js("ngTemplateOutlet",t)("ngTemplateOutletContext",ka(7,CS,e.filteredDeadline[e.deadlineIndex].trafficlight)),_n(2),vo(" ",e.filteredDeadline[e.deadlineIndex].trafficlightDesc," ")}}function TS(t,e){if(1&t&&(Ns(0,"div",60),Ns(1,"label",61),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",62),mo(5),Fs(),Fs()),2&t){const t=Xs(3);_n(2),vo("",Ea(3,2,"compViewDeadline.lbl.responsible"),":"),_n(3),fo(t.filteredDeadline[t.deadlineIndex].responsible)}}function _S(t,e){if(1&t&&(Ns(0,"div",59),Ns(1,"form"),Ns(2,"div",60),Ns(3,"label",61),mo(4),Ua(5,"translate"),Fs(),Ns(6,"label",62),mo(7),Fs(),Fs(),Ns(8,"div",60),Ns(9,"label",61),mo(10),Ua(11,"translate"),Fs(),Ns(12,"label",62),mo(13),Fs(),Fs(),Ns(14,"div",60),Ns(15,"label",61),mo(16),Ua(17,"translate"),Fs(),Ns(18,"label",62),mo(19),Fs(),Fs(),Gs(20,DS,7,7,"div",63),Gs(21,MS,7,7,"div",63),Gs(22,SS,7,7,"div",63),Gs(23,xS,9,9,"div",63),Gs(24,TS,6,4,"div",63),Fs(),Fs()),2&t){const t=Xs(2);_n(4),vo("",Ea(5,11,"compViewDeadline.lbl.vp"),":"),_n(3),vo("",t.vpvActive.name," "),_n(3),vo("",Ea(11,13,"compViewDeadline.lbl.planElement"),":"),_n(3),fo(t.getElementPath(t.deadlineIndex)),_n(3),vo("",Ea(17,15,"compViewDeadline.lbl.type"),":"),_n(3),fo(t.filteredDeadline[t.deadlineIndex].type),_n(1),js("ngIf",t.filteredDeadline[t.deadlineIndex].endDatePFV),_n(1),js("ngIf",t.filteredDeadline[t.deadlineIndex].endDateVPV),_n(1),js("ngIf",t.filteredDeadline[t.deadlineIndex].percentDone),_n(1),js("ngIf",t.filteredDeadline[t.deadlineIndex].trafficlight||t.filteredDeadline[t.deadlineIndex].trafficlightDesc),_n(1),js("ngIf",t.filteredDeadline[t.deadlineIndex].percentDone)}}function US(t,e){if(1&t){const t=zs();Ns(0,"button",66),Js("click",(function(){ei(t);const e=Xs(2);return e.gotoVPRestrict(e.deadlineIndex)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"compViewDeadline.btn.detail")))}function ES(t,e){if(1&t){const t=zs();Ns(0,"div",1),Js("resized",(function(e){return ei(t),Xs().onResized(e)})),Gs(1,rS,6,3,"div",2),Gs(2,oS,2,1,"div",2),Gs(3,dS,3,2,"div",2),Ns(4,"div",3),Ns(5,"table",4),Ns(6,"thead"),Ns(7,"tr"),Ns(8,"th",5),Js("click",(function(){return ei(t),Xs().sortDeadlineTable(2)})),mo(9),Ua(10,"translate"),Fs(),Ns(11,"th",6),Js("click",(function(){return ei(t),Xs().sortDeadlineTable(3)})),mo(12),Ua(13,"translate"),Fs(),Gs(14,uS,3,3,"th",7),Ns(15,"th",8),Js("click",(function(){return ei(t),Xs().sortDeadlineTable(4)})),mo(16),Ua(17,"translate"),Fs(),Gs(18,hS,3,3,"th",9),Ns(19,"th",8),Js("click",(function(){return ei(t),Xs().sortDeadlineTable(6)})),mo(20),Ua(21,"translate"),Fs(),Ns(22,"th",10),Bs(23,"i",11),Fs(),Fs(),Fs(),Ns(24,"tbody"),Gs(25,VS,14,20,"tr",12),Fs(),Fs(),Fs(),Gs(26,AS,2,9,"ng-template",null,13,ja),Gs(28,kS,1,6,"ng-template",null,14,ja),Ns(30,"div",15),Ns(31,"div",16),Ns(32,"div",17),Ns(33,"div",18),Ns(34,"h5",19),mo(35),Ua(36,"translate"),Fs(),Ns(37,"button",20),Ns(38,"span",21),mo(39,"\xd7"),Fs(),Fs(),Fs(),Gs(40,_S,25,17,"div",22),Ns(41,"div",23),Ns(42,"button",24),mo(43),Ua(44,"translate"),Fs(),Gs(45,US,3,3,"button",25),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs();_n(1),js("ngIf",t.displaySwitch()),_n(1),js("ngIf",t.fullList&&"vpv"!=t.refType),_n(1),js("ngIf",t.viewGantt),_n(6),fo(Ea(10,14,"compViewDeadline.lbl.planElement")),_n(3),fo(Ea(13,16,"compViewDeadline.lbl.type")),_n(2),js("ngIf",t.switchType),_n(2),fo(Ea(17,18,"compViewDeadline.lbl.endDateVPV")),_n(2),js("ngIf",t.switchType),_n(2),fo(Ea(21,20,"compViewDeadline.lbl.done")),_n(5),js("ngForOf",t.filteredDeadline),_n(10),fo(Ea(36,22,"compViewDeadline.titleDetailDeadline")),_n(5),js("ngIf",t.deadlineIndex>=0&&t.deadlineIndex<t.filteredDeadline.length),_n(3),fo(Ea(44,24,"compViewDeadline.btn.back")),_n(2),js("ngIf",t.canSeeRestriction())}}let OS=(()=>{class t{constructor(t,e,i,n,r,s){this.visboprojectversionService=t,this.messageService=e,this.alertService=i,this.route=n,this.router=r,this.translate=s,this.listType=[{name:"PFV",ref:"pfv",localName:""},{name:"VPV",ref:"vpv",localName:""},{name:"All",ref:void 0,localName:""}],this.type=this.listType[0].name,this.refType=this.listType[0].ref,this.switchType=!0,this.parentThis=this,this.colors=["#005600","green","orange","red"],this.graphAllDataPieChart=[],this.graphBeforeAllDataPieChart=[],this.graphAllPieLegend=[["string",this.translate.instant("compViewDeadline.lbl.status")],["number",this.translate.instant("compViewDeadline.lbl.count")]],this.graphAllOptionsPieChart={title:"View Deadlines",titleTextStyle:{color:"black",fontSize:"16"},tooltip:{trigger:"none"},colors:this.colors},this.divAllPieChart="divAllDeadLinePieChart",this.graphOptionsDeadlinesGantt={width:"100%",timeline:{showRowLabels:!1,showBarLabels:!0},tooltip:{isHtml:!0},animation:{startup:!0,duration:200}},this.graphDataDeadlinesGantt=[],this.permVC=Av,this.permVP=Pv,this.sortAscending=!1,this.sortColumn=1,this.sortAscendingDeadline=!1,this.sortColumnDeadline=1}ngOnInit(){this.currentLang=this.translate.currentLang,this.statusList=[this.translate.instant("keyMetrics.chart.statusDeadlineAhead"),this.translate.instant("keyMetrics.chart.statusDeadlineInTime"),this.translate.instant("keyMetrics.chart.statusDeadlineDelay"),this.translate.instant("keyMetrics.chart.statusDeadlineNotCompleted"),"Unknown"],this.buttonGantt=this.translate.instant("compViewDelivery.btn.buttonGanttOn"),this.listType.forEach(t=>t.localName=this.translate.instant("compViewDelivery.lbl.".concat(t.name))),this.currentVpvId=this.vpvActive._id,this.visboDeadlineCalc(!1)}ngOnChanges(t){this.log(`Deadlines on Changes  ${this.vpvActive._id} ${this.vpvActive.timestamp}, Changes: ${JSON.stringify(t)}`),void 0!==this.currentVpvId&&this.vpvActive._id!==this.currentVpvId&&this.visboDeadlineCalc(!1)}onResized(t){t||this.log("No event in Resize"),this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(()=>{this.visboViewAllDeadlinePie(!1),this.visboViewDeadlineTimeline(),this.timeoutID=void 0},500)}visboDeadlineCalc(t=!1){this.vpvActive&&(this.fullList=this.hasVPPerm(this.permVP.View),this.fullList||(this.refType=void 0),this.currentVpvId=this.vpvActive._id,this.log(`Deadline Calc for Version  ${this.vpvActive._id} ${this.vpvActive.timestamp} Reference ${this.refType}`),this.visboprojectversionService.getDeadline(this.vpvActive._id,this.refType).subscribe(e=>{this.log(`get VPV Calc: Get ${e.length} vpvs with ${e[0].deadline.length} entries`),1===e.length&&e[0].deadline?(this.log(`Get Deadlines for ${e[0]._id} Len ${e[0].deadline.length} Actual ${e[0].actualDataUntil}`),this.allDeadline=e[0].deadline,"vpv"!=this.refType&&this.allDeadline&&!this.allDeadline[0].fullPathPFV&&(this.refType="vpv",this.switchType=!1)):(this.log("get VPV Calc: Reset Deadlines to empty "),this.allDeadline=void 0),this.initDeadlines(t),this.visboViewAllDeadlinePie(t)},t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("compViewDeadline.msg.errorPermVersion",{name:this.vpvActive.name});this.alertService.error(t)}else this.alertService.error(Lh(t))}))}initDeadlines(t){if(void 0!==this.allDeadline){this.filterPath=this.getFullPath(this.allDeadline[0]);for(let t=0;t<this.allDeadline.length;t++)this.allDeadline[t].fullName=this.getFullName(this.allDeadline[t]),this.allDeadline[t].status=this.statusList[this.getStatus(this.allDeadline[t])],this.allDeadline[t].statusID=this.getStatus(this.allDeadline[t]);this.filterDeadlines(t)}else this.hierarchyDeadline=[]}filterDeadlines(t){if(void 0===this.allDeadline||0===this.allDeadline.length)return;const e=this.filterPath.join(" / ");let i=!1;e!==this.filterOldPath&&(i=!0,this.filterStatus=void 0,this.filterOldPath=e),this.hierarchyDeadline=[],this.filteredDeadline=[];for(let n=0;n<this.allDeadline.length;n++)0===this.getFullPath(this.allDeadline[n]).join(" / ").indexOf(e)&&this.hierarchyDeadline.push(this.allDeadline[n]);for(let n=0;n<this.hierarchyDeadline.length;n++)void 0!==this.filterStatus&&this.filterStatus!==this.hierarchyDeadline[n].statusID||this.filteredDeadline.push(this.hierarchyDeadline[n]);this.sortDeadlineTable(),i&&this.visboViewAllDeadlinePie(t),this.visboViewDeadlineTimeline()}helperDeadline(t){this.deadlineIndex=t}getElementPath(t,e){let i=[];"vpv"!==this.refType&&void 0!==this.refType||(i=this.filteredDeadline[t].fullPathVPV),"pfv"===this.refType&&(i=this.filteredDeadline[t].fullPathPFV);let n="";return n=i.length<=1?this.vpvActive.name:i.slice(1).join(" / "),e>0&&(n=Gh(n,e,"right")),n}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}canSeeRestriction(){let t=this.combinedPerm.vp||0;return t&=this.permVP.Modify+this.permVP.ManagePerm,t>0}getStatus(t){const e=this.vpvActive.timestamp;let i=0;return t.endDatePFV?t.endDatePFV<=e&&t.percentDone<1?i=3:t.endDatePFV>e&&1===t.percentDone?i=0:t.endDatePFV<=e&&1===t.percentDone||t.endDatePFV>e&&t.percentDone<1?(t.changeDays<0&&(i=0),0===t.changeDays&&(i=1),t.changeDays>0&&(i=2)):i=4:i=-1,i}visboViewAllDeadlinePie(t){this.graphAllOptionsPieChart.title=this.translate.instant("compViewDeadline.titleAllDeadlines");const e=[],i=[];let n;for(let s=0;s<this.statusList.length;s++)e[s]=0;let r=!1;for(let s=0;s<this.filteredDeadline.length;s++)n=this.getStatus(this.filteredDeadline[s]),e[n]+=1,r=!0;for(let s=0;s<e.length;s++)i.push([this.statusList[s],e[s]]);this.log("PIE Chart change "+t),this.graphAllDataPieChart=r?i:[]}getPhaseName(t){if(!t)return;let e=t.phasePFV||t.name;return"."===e&&(e=this.vpvActive.name),e}visboViewDeadlineTimeline(){const t=[];for(let e=0;e<this.hierarchyDeadline.length;e++){const i=this.hierarchyDeadline[e];if("Phase"===i.type){const n=i.startDateVPV?new Date(i.startDateVPV):new Date,r=new Date(i.endDateVPV),s=this.getPhaseName(i),o=this.getFullPath(i);0===o.join(" / ").indexOf(this.filterPath.join(" / "))&&o.length<=this.filterPath.length+1&&t.push([0===e?"Root":"Children",s,this.createCustomHTMLContent(i),n.getTime(),r.getTime()])}}t.reverse(),t.push(["Task ID","Task Name",{type:"string",role:"tooltip",p:{html:!0}},"Start Date","End Date"]),t.reverse(),this.graphDataDeadlinesGantt=t}createCustomHTMLContent(t){const e=_h(new Date(t.startDateVPV),"fullDate",this.currentLang),i=_h(new Date(t.endDateVPV),"fullDate",this.currentLang);let n=t.fullName;"."===n&&(n=this.vpvActive.name);let r='<div style="padding:5px 5px 5px 5px"><div><b>'+n+"</b></div><div><table>";const s=this.translate.instant("compViewDeadline.lbl.startDateVPV"),o=this.translate.instant("compViewDeadline.lbl.endDateVPV"),a=this.translate.instant("compViewDeadline.lbl.percentDone"),l=this.translate.instant("compViewDeadline.lbl.trafficlight"),c=this.translate.instant("compViewDeadline.lbl.trafficlightDesc");return r=r+'<tr><td width="40%">'+s+":</td><td><b>"+e+"</b></td></tr>",r=r+'<tr><td width="40%">'+o+":</td><td><b>"+i+"</b></td></tr>",r=r+'<tr><td width="40%">'+a+":</td><td><b>"+Math.round(100*t.percentDone)+"%</b></td></tr>",t.trafficlight&&(r=r+'<tr><td width="40%">'+l+":</td><td><b>"+t.trafficlight+"</b></td></tr>"),t.trafficlightDesc&&(r=r+"<tr><td>"+c+":</td><td><b>"+t.trafficlightDesc+"</b></td></tr>"),r+="</table></div></div>",r}chartSelectRow(t,e,i){if(this.log(`chart Select Row ${t} ${e} ${i} for Filter`),void 0===t)this.filterStatus=void 0;else{const t=this.statusList.findIndex(t=>t===e);this.filterStatus=t<0||this.filterStatus===t?void 0:t}this.filterDeadlines(!1)}timelineSelectRow(t){const e=this.graphDataDeadlinesGantt[t+1][1];this.log(`timeline Select Row ${t} Phase ${e}`);let i=this.hierarchyDeadline.findIndex(t=>t.name===e);i<0&&(i=0),this.filterPath=this.getFullPath(this.hierarchyDeadline[i]),this.filterDeadlines(!1)}ganttSelectPath(t,e){this.log(`gantt Select Item ${e} ${t} `);const i=this.getFullPath(this.hierarchyDeadline[0]);e>=0&&e<i.length&&(this.filterPath=i.slice(0,e+1)),this.log(`gantt Select ${t} Full Path ${this.filterPath.join(" / ")}`),this.filterDeadlines(!1)}getFullName(t){let e;return t.fullName&&(e=t.fullName),"vpv"===this.refType||void 0===this.refType?(t.fullPathVPV&&t.fullPathVPV.length>1?e=t.fullPathVPV.slice(1).join(" / "):t.fullPathVPV?e=this.vpvActive.name:t.fullPathPFV&&t.fullPathPFV.length>1&&(e=t.fullPathPFV.slice(1).join(" / ")),e):"pfv"===this.refType?(e=t.fullPathPFV&&t.fullPathPFV.length>1?t.fullPathPFV.slice(1).join(" / "):this.vpvActive.name,e):void 0}getFullPath(t){if(t)return"pfv"===this.refType&&t.fullPathPFV||t.fullPathVPV}getBreadCrumb(){const t=this.getFullPath(this.hierarchyDeadline[0]),e=t.slice(0,t.length);return e.length>=0&&(e[0]=this.vpvActive.name),e}showBreadCrumb(){return this.getFullPath(this.hierarchyDeadline[0]).length>0}inFuture(t){return t>this.vpvActive.timestamp.toString()}getShortText(t,e,i){return Gh(t,e,i)}switchView(){this.log("Switchinig to "+this.type),this.refType=this.listType.find(t=>t.name===this.type).ref,this.visboDeadlineCalc(!1)}toggleGantt(){this.viewGantt=!this.viewGantt,this.buttonGantt=this.translate.instant(this.viewGantt?"compViewDelivery.btn.buttonGanttOff":"compViewDelivery.btn.buttonGanttOn"),this.viewGantt||(this.filterPath=this.getFullPath(this.allDeadline[0]),this.filterDeadlines(!1))}hasDeadlines(){let t=!1;return this.vpvActive&&this.allDeadline&&this.allDeadline.length>0&&(t=!0),t}displaySwitch(){let t=!1;return this.switchType&&this.hasVPPerm(this.permVP.View)&&(t=!0),t}gotoVPRestrict(t){const e=this.getFullPath(this.filteredDeadline[t]),i=this.filteredDeadline[t].nameID;localStorage.setItem("restrict",JSON.stringify({id:i,path:e})),this.log(`goto VP Restrict: ${this.vpvActive.vpid} ID ${i} Path ${e.join(" / ")}`),this.router.navigate(["vpRestrict/".concat(this.vpvActive.vpid)],{queryParams:{id:i}})}sortDeadlineTable(t){this.filteredDeadline&&(void 0!==t?(t!==this.sortColumnDeadline&&(this.sortColumnDeadline=t,this.sortAscendingDeadline=void 0),this.sortAscendingDeadline=void 0===this.sortAscendingDeadline?2===t||3===t||4===t||7===t:!this.sortAscendingDeadline):(this.sortColumnDeadline=2,this.sortAscendingDeadline=!0),2===this.sortColumnDeadline?this.filteredDeadline.sort("pfv"===this.refType?function(t,e){return xh(t.fullPathPFV.join(" / "),e.fullPathPFV.join(" / "))}:function(t,e){return xh(t.fullPathVPV.join(" / "),e.fullPathVPV.join(" / "))}):3===this.sortColumnDeadline?this.filteredDeadline.sort((function(t,e){return xh(t.type.toLowerCase(),e.type.toLowerCase())})):4===this.sortColumnDeadline?this.filteredDeadline.sort((function(t,e){return Th(t.endDateVPV,e.endDateVPV)})):5===this.sortColumnDeadline?this.filteredDeadline.sort((function(t,e){return t.changeDays-e.changeDays})):6===this.sortColumnDeadline?this.filteredDeadline.sort((function(t,e){return t.percentDone-e.percentDone})):7===this.sortColumnDeadline&&this.filteredDeadline.sort((function(t,e){return Th(t.endDatePFV,e.endDatePFV)})),this.sortAscendingDeadline||this.filteredDeadline.reverse())}log(t){this.messageService.add("CompViewDeadline: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(wV),Rs(Rh),Rs(Df),Rs(Fg),Rs(rf),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-comp-viewdeadline"]],inputs:{vpvActive:"vpvActive",combinedPerm:"combinedPerm"},features:[_e],decls:1,vars:1,consts:[["class","well",3,"resized",4,"ngIf"],[1,"well",3,"resized"],["class","container",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[1,"text-left",3,"click"],[1,"d-none","d-lg-table-cell",3,"click"],["class","d-none d-xl-table-cell text-right",3,"click",4,"ngIf"],[1,"d-none","d-md-table-cell","text-right",3,"click"],["class","text-right",3,"click",4,"ngIf"],[1,"d-none","d-md-table-cell"],[1,"fas","fa-lightbulb","text-grey"],["data-toggle","modal","data-target","#detailDeadline",3,"click",4,"ngFor","ngForOf"],["fontStyle",""],["trafficLight",""],["id","detailDeadline","tabindex","-1","role","dialog","aria-labelledby","Detail Deadline","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","detailDeadlineTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],["class","modal-body",4,"ngIf"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button","class","btn btn-primary","data-dismiss","modal",3,"click",4,"ngIf"],[1,"container"],[1,"d-flex","justify-content-center","my-1"],["type","button",1,"btn","btn-md","btn-light","mx-2",3,"click"],["name","type",1,"col-3","form-control","mx-2",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","d-flex justify-content-center",4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"align-center"],[3,"elementID","graphData","graphDataBefore","graphLegend","graphOptions","parentThis","language"],["class","mb-2",4,"ngIf"],[4,"ngIf"],[1,"mb-2"],[4,"ngFor","ngForOf"],[3,"click"],[3,"graphData","graphOptions","parentThis"],[1,"d-none","d-xl-table-cell","text-right",3,"click"],[1,"text-right",3,"click"],["data-toggle","modal","data-target","#detailDeadline",3,"click"],[3,"title"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"d-none","d-lg-table-cell"],["class","d-none d-xl-table-cell text-right",4,"ngIf"],[1,"d-none","d-md-table-cell","text-right"],["class","text-right",3,"title",4,"ngIf"],["class","d-none d-md-table-cell text-right",4,"ngIf"],["class","d-none d-md-table-cell text-right my_bg_red",4,"ngIf"],[1,"d-none","d-md-table-cell",3,"title"],[1,"d-none","d-xl-table-cell","text-right"],[1,"text-right",3,"title"],[1,"d-none","d-md-table-cell","text-right","my_bg_red"],[3,"ngClass"],[1,"fas","fa-lightbulb",3,"ngClass"],[1,"modal-body"],[1,"v_compact_t","form-group"],[1,"col-4","col-form-label"],[1,"col-8","form-control-static"],["class","v_compact_t form-group",4,"ngIf"],[1,"mx-2",3,"title"],[1,"mx-1"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&Gs(0,ES,46,26,"div",0),2&t&&js("ngIf",e.hasDeadlines())},directives:[jc,MV,Lc,cu,Nd,Eu,du,gu,iS,bA,Bc,Oc,Ou,Fd,Tu],pipes:[av,qc,zc],styles:[".my_darkgreen[_ngcontent-%COMP%]{color:#005600}.my_green[_ngcontent-%COMP%]{color:green}.my_orange[_ngcontent-%COMP%]{color:orange}.my_red[_ngcontent-%COMP%]{color:red}.my_bg_red[_ngcontent-%COMP%]{background-color:red}.v_compact_t[_ngcontent-%COMP%]{margin:0;padding-top:0}"]}),t})();function GS(t,e){if(1&t&&(Ns(0,"option",29),mo(1),Fs()),2&t){const t=e.$implicit;to("value",t.name),_n(1),fo(t.localName)}}function LS(t,e){if(1&t){const t=zs();Ns(0,"div",25),Ns(1,"div",26),Ns(2,"select",27),Js("ngModelChange",(function(e){return ei(t),Xs(2).type=e}))("change",(function(){return ei(t),Xs(2).switchView()})),Gs(3,GS,2,2,"option",28),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(2),js("ngModel",t.type),_n(1),js("ngForOf",t.listType)}}function RS(t,e){if(1&t&&(Ns(0,"div",31),Ns(1,"div",32),Bs(2,"app-pie-chart",33),Fs(),Fs()),2&t){const t=Xs(3);_n(2),js("elementID",t.divAllPieChart)("graphData",t.graphAllDataPieChart)("graphLegend",t.graphAllPieLegend)("graphOptions",t.graphAllOptionsPieChart)("parentThis",t.parentThis)("language",t.currentLang)}}function jS(t,e){if(1&t&&(Ns(0,"div",25),Gs(1,RS,3,6,"div",30),Fs()),2&t){const t=Xs(2);_n(1),js("ngIf",t.graphAllDataPieChart.length>1)}}function $S(t,e){if(1&t){const t=zs();Ns(0,"th",8),Js("click",(function(){return ei(t),Xs(2).sortDeliveryTable(4)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"compViewDelivery.lbl.endDatePFV")))}function NS(t,e){if(1&t){const t=zs();Ns(0,"th",34),Js("click",(function(){return ei(t),Xs(2).sortDeliveryTable(5)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"compViewDelivery.lbl.change")))}function FS(t,e){1&t&&qs(0)}function BS(t,e){if(1&t&&(Ns(0,"td",40),mo(1),Ua(2,"date"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.endDatePFV,"dd.MM.yy"))}}function HS(t,e){if(1&t&&(Ns(0,"td",44),Ua(1,"date"),mo(2),Ua(3,"number"),Fs()),2&t){const t=Xs().$implicit;eo("title","",Oa(1,2,t.endDatePFV,"dd.MM.yy")," (baseline)"),_n(2),fo(Oa(3,5,t.changeDays/7,"1.0-1"))}}function KS(t,e){if(1&t&&(Ns(0,"td",45),mo(1),Ua(2,"number"),Fs()),2&t){const t=Xs().$implicit;_n(1),vo("",Oa(2,1,100*t.percentDone,"1.0-0")," %")}}function qS(t,e){if(1&t&&(Ns(0,"td",46),mo(1),Ua(2,"number"),Fs()),2&t){const t=Xs().$implicit;_n(1),vo("",Oa(2,1,100*t.percentDone,"1.0-0")," %")}}const zS=function(t,e){return{level:t,text:e}};function QS(t,e){if(1&t){const t=zs();Ns(0,"tr",35),Js("click",(function(){ei(t);const i=e.index;return Xs(2).helperDelivery(i)})),Ns(1,"td",36),Gs(2,FS,1,0,"ng-container",37),Fs(),Ns(3,"td",38),mo(4),Fs(),Gs(5,BS,3,4,"td",39),Ns(6,"td",40),mo(7),Ua(8,"date"),Fs(),Gs(9,HS,4,8,"td",41),Gs(10,KS,3,4,"td",42),Gs(11,qS,3,4,"td",43),Fs()}if(2&t){const t=e.$implicit;Xs();const i=Ls(24),n=Xs();_n(1),to("title",t.description),_n(1),js("ngTemplateOutlet",i)("ngTemplateOutletContext",Da(13,zS,n.getStatus(t),n.getShortText(t.description,100))),_n(1),to("title",n.getFullName(t)),_n(1),fo(n.getShortText(n.getFullName(t),50,"right")),_n(1),js("ngIf",!n.reducedList),_n(2),fo(Oa(8,10,t.endDateVPV,"dd.MM.yy")),_n(2),js("ngIf",!n.reducedList),_n(1),js("ngIf",n.inFuture(t.endDateVPV)||1==t.percentDone),_n(1),js("ngIf",!(n.inFuture(t.endDateVPV)||1==t.percentDone))}}const WS=function(t,e,i,n,r,s){return{"font-weight-normal":t,"font-weight-bold":e,my_darkgreen:i,my_green:n,my_orange:r,my_red:s}};function JS(t,e){if(1&t&&(Ns(0,"i",47),mo(1),Fs()),2&t){const t=e.level,i=e.text;js("ngClass",Ia(2,WS,-1==t,t>=0,0==t,1==t,2==t,3==t)),_n(1),vo(" ",i," ")}}const YS=function(t,e,i,n){return{"d-none":t,"text-success":e,"text-warning":i,"text-danger":n}};function ZS(t,e){if(1&t&&Bs(0,"i",48),2&t){const t=e.level;js("ngClass",Sa(1,YS,0==t,1==t,2==t,3==t))}}function XS(t,e){if(1&t&&(Ns(0,"div",50),Ns(1,"label",51),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",52),mo(5),Ua(6,"date"),Fs(),Fs()),2&t){const t=Xs(3);_n(2),vo("",Ea(3,2,"compViewDelivery.lbl.endDatePFV"),":"),_n(3),fo(Oa(6,4,t.filteredDelivery[t.deliveryIndex].endDatePFV,"dd.MM.yy"))}}function tI(t,e){if(1&t&&(Ns(0,"div",50),Ns(1,"label",51),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",52),mo(5),Ua(6,"date"),Fs(),Fs()),2&t){const t=Xs(3);_n(2),vo("",Ea(3,2,"compViewDelivery.lbl.endDateVPV"),":"),_n(3),fo(Oa(6,4,t.filteredDelivery[t.deliveryIndex].endDateVPV,"dd.MM.yy"))}}function eI(t,e){if(1&t&&(Ns(0,"div",50),Ns(1,"label",51),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",52),mo(5),Ua(6,"number"),Fs(),Fs()),2&t){const t=Xs(3);_n(2),vo("",Ea(3,2,"compViewDelivery.lbl.done"),":"),_n(3),vo("",Oa(6,4,100*t.filteredDelivery[t.deliveryIndex].percentDone,"1.0-0")," %")}}function iI(t,e){if(1&t&&(Ns(0,"div",49),Ns(1,"form"),Ns(2,"div",50),Ns(3,"label",51),mo(4),Ua(5,"translate"),Fs(),Ns(6,"label",52),mo(7),Fs(),Fs(),Ns(8,"div",50),Ns(9,"label",51),mo(10),Ua(11,"translate"),Fs(),Ns(12,"label",52),mo(13),Fs(),Fs(),Ns(14,"div",50),Ns(15,"label",51),mo(16),Ua(17,"translate"),Fs(),Ns(18,"label",52),mo(19),Fs(),Fs(),Gs(20,XS,7,7,"div",53),Gs(21,tI,7,7,"div",53),Gs(22,eI,7,7,"div",53),Fs(),Fs()),2&t){const t=Xs(2);_n(4),vo("",Ea(5,9,"compViewDelivery.lbl.vp"),":"),_n(3),vo("",t.vpvActive.name," "),_n(3),vo("",Ea(11,11,"compViewDelivery.lbl.planElement"),":"),_n(3),fo(t.getElementPath(t.deliveryIndex)),_n(3),vo("",Ea(17,13,"compViewDelivery.lbl.description"),":"),_n(3),fo(t.filteredDelivery[t.deliveryIndex].description),_n(1),js("ngIf",t.filteredDelivery[t.deliveryIndex].endDatePFV),_n(1),js("ngIf",t.filteredDelivery[t.deliveryIndex].endDateVPV),_n(1),js("ngIf",t.filteredDelivery[t.deliveryIndex].percentDone)}}function nI(t,e){if(1&t){const t=zs();Ns(0,"button",54),Js("click",(function(){ei(t);const e=Xs(2);return e.gotoVPRestrict(e.deliveryIndex)})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"compViewDelivery.btn.detail")))}function rI(t,e){if(1&t){const t=zs();Ns(0,"div",1),Js("resized",(function(e){return ei(t),Xs().onResized(e)})),Gs(1,LS,4,2,"div",2),Gs(2,jS,2,1,"div",2),Ns(3,"div",3),Ns(4,"table",4),Ns(5,"thead"),Ns(6,"tr"),Ns(7,"th",5),Js("click",(function(){return ei(t),Xs().sortDeliveryTable(3)})),mo(8),Ua(9,"translate"),Fs(),Ns(10,"th",6),Js("click",(function(){return ei(t),Xs().sortDeliveryTable(2)})),mo(11),Ua(12,"translate"),Fs(),Gs(13,$S,3,3,"th",7),Ns(14,"th",8),Js("click",(function(){return ei(t),Xs().sortDeliveryTable(4)})),mo(15),Ua(16,"translate"),Fs(),Gs(17,NS,3,3,"th",9),Ns(18,"th",10),Js("click",(function(){return ei(t),Xs().sortDeliveryTable(6)})),mo(19),Ua(20,"translate"),Fs(),Fs(),Fs(),Ns(21,"tbody"),Gs(22,QS,12,16,"tr",11),Fs(),Fs(),Fs(),Gs(23,JS,2,9,"ng-template",null,12,ja),Gs(25,ZS,1,6,"ng-template",null,13,ja),Ns(27,"div",14),Ns(28,"div",15),Ns(29,"div",16),Ns(30,"div",17),Ns(31,"h5",18),mo(32),Ua(33,"translate"),Fs(),Ns(34,"button",19),Ns(35,"span",20),mo(36,"\xd7"),Fs(),Fs(),Fs(),Gs(37,iI,23,15,"div",21),Ns(38,"div",22),Ns(39,"button",23),mo(40),Ua(41,"translate"),Fs(),Gs(42,nI,3,3,"button",24),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs();_n(1),js("ngIf",t.displaySwitch()),_n(1),js("ngIf",!t.reducedList),_n(6),fo(Ea(9,13,"compViewDelivery.lbl.description")),_n(3),fo(Ea(12,15,"compViewDelivery.lbl.planElement")),_n(2),js("ngIf",!t.reducedList),_n(2),fo(Ea(16,17,"compViewDelivery.lbl.endDateVPV")),_n(2),js("ngIf",!t.reducedList),_n(2),fo(Ea(20,19,"compViewDelivery.lbl.done")),_n(3),js("ngForOf",t.filteredDelivery),_n(10),fo(Ea(33,21,"compViewDelivery.titleDetailDelivery")),_n(5),js("ngIf",t.deliveryIndex>=0&&t.deliveryIndex<t.filteredDelivery.length),_n(3),fo(Ea(41,23,"compViewDelivery.btn.back")),_n(2),js("ngIf",t.canSeeRestriction())}}let sI=(()=>{class t{constructor(t,e,i,n,r,s){this.visboprojectversionService=t,this.messageService=e,this.alertService=i,this.route=n,this.router=r,this.translate=s,this.listType=[{name:"PFV",ref:"pfv",localName:""},{name:"VPV",ref:"vpv",localName:""},{name:"All",ref:void 0,localName:""}],this.type=this.listType[0].name,this.refType=this.listType[0].ref,this.switchType=!0,this.parentThis=this,this.colors=["#005600","green","orange","red"],this.graphAllDataPieChart=[],this.graphAllPieLegend=[["string",this.translate.instant("compViewDelivery.lbl.status")],["number",this.translate.instant("compViewDelivery.lbl.count")]],this.graphAllOptionsPieChart={title:"View Delivery Status",titleTextStyle:{color:"black",fontSize:"16"},pieSliceText:"percentage",tooltip:{trigger:"none"},colors:this.colors},this.divAllPieChart="divAllDeliveryPieChart",this.permVC=Av,this.permVP=Pv}ngOnInit(){this.currentLang=this.translate.currentLang,this.statusList=[this.translate.instant("keyMetrics.chart.statusDeliveryAhead"),this.translate.instant("keyMetrics.chart.statusDeliveryInTime"),this.translate.instant("keyMetrics.chart.statusDeliveryDelay"),this.translate.instant("keyMetrics.chart.statusDeliveryNotCompleted"),"Unknown"],this.listType.forEach(t=>t.localName=this.translate.instant("compViewDelivery.lbl.".concat(t.name))),this.visboDeliveryCalc()}ngOnChanges(t){this.log(`Delivery on Changes  ${this.vpvActive._id} ${this.vpvActive.timestamp}, Changes: ${JSON.stringify(t)}`),void 0!==this.currentVpvId&&this.vpvActive._id!==this.currentVpvId&&this.visboDeliveryCalc()}onResized(t){t||this.log("No event in Resize"),this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(()=>{this.visboViewAllDeliveryPie(),this.timeoutID=void 0},500)}visboDeliveryCalc(){this.vpvActive&&(this.currentVpvId=this.vpvActive._id,this.log(`Delivery Calc for Version  ${this.vpvActive._id} ${this.vpvActive.timestamp} Reference ${this.refType}`),this.visboprojectversionService.getDelivery(this.vpvActive._id,this.refType).subscribe(t=>{this.log(`get VPV Calc: Get ${t.length} vpvs with ${t[0].delivery.length} Delivery entries`),1===t.length&&t[0].delivery?(this.log(`Store Delivery for ${t[0]._id} Len ${t[0].delivery.length} Timestamp ${t[0].timestamp}`),this.allDelivery=t[0].delivery,"vpv"!=this.refType&&this.allDelivery&&!this.allDelivery[0].fullPathPFV&&(this.refType="vpv",this.switchType=!1)):(this.log("get VPV Calc: Reset Delivery to empty "),this.allDelivery=void 0),this.initDeliveries(),this.visboViewAllDeliveryPie()},t=>{if(this.log(`get VPV Deliveries failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("compViewDelivery.msg.errorPermVersion",{name:this.vpvActive.name});this.alertService.error(t)}else this.alertService.error(Lh(t))}))}initDeliveries(){if(void 0!==this.allDelivery){for(let t=0;t<this.allDelivery.length;t++){this.allDelivery[t].fullName=this.getFullName(this.allDelivery[t]);const e=this.getStatus(this.allDelivery[t]);this.allDelivery[t].statusID=e,this.allDelivery[t].status=this.statusList[e]}this.filterDeliveries()}}filterDeliveries(){if(this.filteredDelivery=[],this.reducedList=!0,void 0!==this.allDelivery){for(let t=0;t<this.allDelivery.length;t++)this.allDelivery[t].phasePFV&&(this.reducedList=!1),void 0!==this.filterStatus&&this.filterStatus!==this.allDelivery[t].statusID||this.filteredDelivery.push(this.allDelivery[t]);this.sortDeliveryTable(void 0)}}helperDelivery(t){this.deliveryIndex=t}getElementPath(t,e){const i=this.filteredDelivery[t].fullPathVPV;let n="";return n=i.length<=1?this.vpvActive.name:i.slice(1).join(" / "),e>0&&(n=Gh(n,e,"right")),n}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}canSeeRestriction(){let t=this.combinedPerm.vp||0;return t&=this.permVP.Modify+this.permVP.ManagePerm,t>0}getStatus(t){let e=0;return e=t.endDatePFV?t.endDatePFV<=this.vpvActive.timestamp&&t.percentDone<1?3:t.changeDays<0?0:0===t.changeDays?1:2:-1,e}visboViewAllDeliveryPie(){this.graphAllOptionsPieChart.title=this.translate.instant("compViewDelivery.titleAllDelivery");const t=[],e=[];let i;for(let r=0;r<this.statusList.length;r++)t[r]=0;let n=!1;for(let r=0;r<this.filteredDelivery.length;r++)i=this.getStatus(this.filteredDelivery[r]),t[i]+=1,n=!0;for(let r=0;r<t.length;r++)e.push([this.statusList[r],t[r]]);this.graphAllDataPieChart=n?e:[]}chartSelectRow(t,e,i){if(this.log(`chart Select Row ${t} ${e} ${i} for Filter`),void 0===t)this.filterStatus=void 0;else{const t=this.statusList.findIndex(t=>t===e);this.filterStatus=t<0||this.filterStatus===t?void 0:t}this.filterDeliveries()}getFullName(t){let e;return t.fullName&&(e=t.fullName),"vpv"===this.refType||void 0===this.refType?(t.fullPathVPV&&t.fullPathVPV.length>1?e=t.fullPathVPV.slice(1).join(" / "):t.fullPathVPV?e=this.vpvActive.name:t.fullPathPFV&&t.fullPathPFV.length>1&&(e=t.fullPathPFV.slice(1).join(" / ")),e):"pfv"===this.refType?(e=t.fullPathPFV&&t.fullPathPFV.length>1?t.fullPathPFV.slice(1).join(" / "):this.vpvActive.name,e):void 0}inFuture(t){return t>this.vpvActive.timestamp.toString()}getShortText(t,e,i){return Gh(t,e,i)}switchView(){this.log("Switchinig to "+this.type),this.refType=this.listType.find(t=>t.name===this.type).ref,this.visboDeliveryCalc()}displayDelivery(){let t=!1;return this.vpvActive&&this.allDelivery&&this.allDelivery.length>0&&(t=!0),t}displaySwitch(){let t=!1;return this.switchType&&this.hasVPPerm(this.permVP.View)&&(t=!0),t}gotoVPRestrict(t){const e=this.filteredDelivery[t].fullPathVPV,i=this.filteredDelivery[t].nameID;localStorage.setItem("restrict",JSON.stringify({id:i,path:e})),this.log(`goto VP Restrict: ${this.vpvActive.vpid} ID ${i} Path ${e.join(" / ")}`),this.router.navigate(["vpRestrict/".concat(this.vpvActive.vpid)],{queryParams:{id:i}})}sortDeliveryTable(t){this.filteredDelivery&&(void 0!==t?(t!==this.sortColumnDelivery&&(this.sortColumnDelivery=t,this.sortAscendingDelivery=void 0),this.sortAscendingDelivery=void 0===this.sortAscendingDelivery?2===t||3===t:!this.sortAscendingDelivery):(this.sortColumnDelivery=2,this.sortAscendingDelivery=!0),2===this.sortColumnDelivery?(void 0===this.refType&&this.filteredDelivery.sort((function(t,e){return!t.fullPathVPV&&t.fullPathPFV?xh(t.fullPathPFV.join(" / "),e.fullPathVPV.join(" / ")):!e.fullPathVPV&&e.fullPathPFV?xh(t.fullPathVPV.join(" / "),e.fullPathPFV.join(" / ")):!t.fullPathVPV&&!e.fullPathVPV&&t.fullPathPFV&&e.fullPathPFV?xh(t.fullPathPFV.join(" / "),e.fullPathPFV.join(" / ")):xh(t.fullPathVPV.join(" / "),e.fullPathVPV.join(" / "))})),"vpv"===this.refType&&this.filteredDelivery.sort((function(t,e){return xh(t.fullPathVPV.join(" / "),e.fullPathVPV.join(" / "))})),"pfv"===this.refType&&this.filteredDelivery.sort((function(t,e){return xh(t.fullPathPFV.join(" / "),e.fullPathPFV.join(" / "))}))):3===this.sortColumnDelivery?this.filteredDelivery.sort((function(t,e){return xh(t.description.toLowerCase(),e.description.toLowerCase())})):4===this.sortColumnDelivery?this.filteredDelivery.sort((function(t,e){return Th(t.endDateVPV,e.endDateVPV)})):5===this.sortColumnDelivery?this.filteredDelivery.sort((function(t,e){return t.changeDays-e.changeDays})):6===this.sortColumnDelivery&&this.filteredDelivery.sort((function(t,e){return t.percentDone-e.percentDone})),this.sortAscendingDelivery||this.filteredDelivery.reverse())}log(t){this.messageService.add("CompViewDelivery: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(wV),Rs(Rh),Rs(Df),Rs(Fg),Rs(rf),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-comp-viewdelivery"]],inputs:{vpvActive:"vpvActive",combinedPerm:"combinedPerm"},features:[_e],decls:1,vars:1,consts:[["class","well",3,"resized",4,"ngIf"],[1,"well",3,"resized"],["class","container",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[3,"click"],[1,"d-none","d-md-table-cell",3,"click"],["class","d-none d-lg-table-cell text-right",3,"click",4,"ngIf"],[1,"d-none","d-lg-table-cell","text-right",3,"click"],["class"," text-right",3,"click",4,"ngIf"],[1,"d-none","d-md-table-cell","text-right",3,"click"],["data-toggle","modal","data-target","#detailDelivery",3,"click",4,"ngFor","ngForOf"],["fontStyle",""],["trafficLight",""],["id","detailDelivery","tabindex","-1","role","dialog","aria-labelledby","Detail Delivery","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","detailDeliveryTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],["class","modal-body",4,"ngIf"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button","class","btn btn-primary","data-dismiss","modal",3,"click",4,"ngIf"],[1,"container"],[1,"d-flex","justify-content-left"],["name","type",1,"col-3","form-control","mx-1",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","d-flex justify-content-center",4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"align-center"],[3,"elementID","graphData","graphLegend","graphOptions","parentThis","language"],[1,"text-right",3,"click"],["data-toggle","modal","data-target","#detailDelivery",3,"click"],[3,"title"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"d-none","d-md-table-cell",3,"title"],["class","d-none d-lg-table-cell text-right",4,"ngIf"],[1,"d-none","d-lg-table-cell","text-right"],["class","text-right",3,"title",4,"ngIf"],["class","d-none d-md-table-cell text-right",4,"ngIf"],["class","d-none d-md-table-cell text-right my_bg_red",4,"ngIf"],[1,"text-right",3,"title"],[1,"d-none","d-md-table-cell","text-right"],[1,"d-none","d-md-table-cell","text-right","my_bg_red"],[3,"ngClass"],[1,"fas","fa-lightbulb",3,"ngClass"],[1,"modal-body"],[1,"v_compact_t","form-group"],[1,"col-4","col-form-label"],[1,"col-8","form-control-static"],["class","v_compact_t form-group",4,"ngIf"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&Gs(0,rI,43,25,"div",0),2&t&&js("ngIf",e.displayDelivery())},directives:[jc,MV,Lc,cu,Nd,Eu,du,gu,iS,Bc,Oc,Ou,Fd,Tu],pipes:[av,qc,zc],styles:[".my_darkgreen[_ngcontent-%COMP%]{color:#005600}.my_green[_ngcontent-%COMP%]{color:green}.my_orange[_ngcontent-%COMP%]{color:orange}.my_red[_ngcontent-%COMP%]{color:red}.my_bg_red[_ngcontent-%COMP%]{background-color:red}.v_compact_t[_ngcontent-%COMP%]{margin:0;padding-top:0}"]}),t})();function oI(t,e){if(1&t&&(Ns(0,"span",15),mo(1),Fs()),2&t){const t=Xs(3);_n(1),vo(" (",t.dropDown[t.dropDownIndex],")")}}function aI(t,e){if(1&t){const t=zs();Ns(0,"a",21),Js("click",(function(){ei(t);const e=Xs().$implicit;return Xs(4).switchVariant(e)})),mo(1),Fs()}if(2&t){const t=Xs().$implicit;_n(1),fo(t)}}function lI(t,e){if(1&t&&(Ns(0,"div"),Gs(1,aI,2,1,"a",20),Fs()),2&t){const t=e.$implicit,i=Xs(4);_n(1),js("ngIf",!i.isActiveVariant(t))}}function cI(t,e){if(1&t&&(Ns(0,"span",16),Bs(1,"a",17),Ns(2,"div",18),Gs(3,lI,2,1,"div",19),Fs(),Fs()),2&t){const t=Xs(3);_n(3),js("ngForOf",t.dropDown)}}function dI(t,e){1&t&&qs(0)}const uI=function(t){return{level:t}};function hI(t,e){if(1&t&&(Ns(0,"small",22),Gs(1,dI,1,0,"ng-container",23),Fs()),2&t){const t=Xs(3),e=Ls(8);to("title",t.vpvActive.ampelErlaeuterung),_n(1),js("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(3,uI,t.vpvActive.ampelStatus))}}function pI(t,e){if(1&t){const t=zs();Ns(0,"h2"),mo(1),Ua(2,"translate"),Ns(3,"a",11),Js("click",(function(){ei(t);const e=Xs(2);return e.gotoVPDetail(e.vpActive)})),mo(4),Fs(),Gs(5,oI,2,1,"span",12),Gs(6,cI,4,1,"span",13),Gs(7,hI,2,5,"small",14),Fs()}if(2&t){const t=Xs(2);_n(1),vo(" ",Ea(2,5,"vpKeyMetric.title"),": "),_n(3),fo(t.vpActive.name),_n(1),js("ngIf",t.dropDownIndex>0),_n(1),js("ngIf",t.dropDown.length>1),_n(1),js("ngIf",t.vpvActive)}}function gI(t,e){if(1&t){const t=zs();Ns(0,"a",11),Js("click",(function(){ei(t);const e=Xs(2);return e.gotoVC(e.vpActive)})),mo(1),Fs()}if(2&t){const t=Xs(2);_n(1),fo(t.vpActive.vc.name)}}function mI(t,e){if(1&t&&(Ns(0,"span"),mo(1),Fs()),2&t){const t=Xs(2);_n(1),fo(t.vpActive.vc.name)}}function fI(t,e){if(1&t&&(Ns(0,"div",8),Ns(1,"div",9),Gs(2,pI,8,7,"h2",2),Ns(3,"h5"),mo(4),Ua(5,"translate"),Gs(6,gI,2,1,"a",10),Gs(7,mI,2,1,"span",2),Fs(),Fs(),Fs()),2&t){const t=Xs();_n(2),js("ngIf",t.vpActive),_n(2),vo("",Ea(5,4,"vpKeyMetric.lbl.vc"),": "),_n(2),js("ngIf",t.hasVCPerm(t.permVC.View)),_n(1),js("ngIf",!t.hasVCPerm(t.permVC.View))}}function vI(t,e){if(1&t){const t=zs();Ns(0,"span",31),Js("click",(function(){return ei(t),Xs(2).getNextVersion(-1)})),Ua(1,"date"),Fs()}2&t&&eo("title","Previous Period before ",Oa(1,1,Xs(2).refDate,"dd.MM."),"")}function bI(t,e){if(1&t){const t=zs();Ns(0,"select",32),Js("ngModelChange",(function(e){return ei(t),Xs(2).refDateInterval=e})),Ns(1,"option",33),mo(2),Ua(3,"translate"),Fs(),Ns(4,"option",34),mo(5),Ua(6,"translate"),Fs(),Ns(7,"option",35),mo(8),Ua(9,"translate"),Fs(),Ns(10,"option",36),mo(11),Ua(12,"translate"),Fs(),Fs()}2&t&&(js("ngModel",Xs(2).refDateInterval),_n(2),fo(Ea(3,5,"vpKeyMetric.lbl.day")),_n(3),fo(Ea(6,7,"vpKeyMetric.lbl.week")),_n(3),fo(Ea(9,9,"vpKeyMetric.lbl.month")),_n(3),fo(Ea(12,11,"vpKeyMetric.lbl.quarter")))}function yI(t,e){if(1&t){const t=zs();Ns(0,"span",37),Js("click",(function(){return ei(t),Xs(2).getNextVersion(1)})),Ua(1,"date"),Fs()}2&t&&eo("title","Next Period after ",Oa(1,1,Xs(2).refDate,"dd.MM."),"")}function CI(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"div",8),Ns(2,"h4",24),Ns(3,"div",25),Ua(4,"date"),mo(5),Ua(6,"translate"),Ua(7,"date"),Fs(),Ns(8,"div",26),mo(9),Ua(10,"date"),Fs(),Fs(),Ns(11,"div",27),Ns(12,"div",8),Gs(13,vI,2,4,"span",28),Gs(14,bI,13,13,"select",29),Gs(15,yI,2,4,"span",30),Fs(),Fs(),Fs(),Fs()),2&t){const t=Xs();_n(3),to("title",Oa(4,7,t.vpvActive.timestamp,"dd.MM.yyyy HH:mm")),_n(2),bo("",Ea(6,10,"vpKeyMetric.titleVersion"),": ",Oa(7,12,t.vpvActive.timestamp,"dd.MM.yyyy"),""),_n(4),vo("V.: ",Oa(10,15,t.vpvActive.timestamp,"dd.MM."),""),_n(4),js("ngIf",t.statusDirection>=0),_n(1),js("ngIf",null!=t.statusDirection),_n(1),js("ngIf",t.statusDirection<=0)}}function VI(t,e){if(1&t){const t=zs();Ns(0,"button",44),Js("click",(function(){return ei(t),Xs(2).switchView("KeyMetrics")})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpKeyMetric.btn.vpKeyMetric")))}function wI(t,e){if(1&t){const t=zs();Ns(0,"button",44),Js("click",(function(){return ei(t),Xs(2).switchView("Capacity")})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpKeyMetric.btn.vpCapacity")))}function AI(t,e){if(1&t){const t=zs();Ns(0,"a",21),Js("click",(function(){return ei(t),Xs(2).switchView("Cost")})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpKeyMetric.lbl.metricCost")))}function PI(t,e){if(1&t){const t=zs();Ns(0,"a",21),Js("click",(function(){return ei(t),Xs(2).switchView("Deadline")})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpKeyMetric.lbl.metricDeadline")))}function kI(t,e){if(1&t){const t=zs();Ns(0,"a",21),Js("click",(function(){return ei(t),Xs(2).switchView("Delivery")})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpKeyMetric.lbl.metricDelivery")))}function DI(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"app-comp-viewkeymetrics",45),Js("switchViewChild",(function(e){return ei(t),Xs(2).switchViewParent(e)})),Fs(),Fs()}if(2&t){const t=Xs(2);_n(1),js("visboprojectversions",t.visboprojectversions)("vpvid",t.vpvActive._id)("combinedPerm",t.combinedPerm)}}function MI(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-comp-viewcapacity",46),Fs()),2&t){const t=Xs(2);_n(1),js("vpActive",t.vpActive)("vpvActive",t.vpvActive)("combinedPerm",t.combinedPerm)}}function SI(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-comp-viewcost",47),Fs()),2&t){const t=Xs(2);_n(1),js("vpvActive",t.vpvActive)("combinedPerm",t.combinedPerm)}}function II(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-comp-viewdeadline",47),Fs()),2&t){const t=Xs(2);_n(1),js("vpvActive",t.vpvActive)("combinedPerm",t.combinedPerm)}}function xI(t,e){if(1&t&&(Ns(0,"div"),Bs(1,"app-comp-viewdelivery",47),Fs()),2&t){const t=Xs(2);_n(1),js("vpvActive",t.vpvActive)("combinedPerm",t.combinedPerm)}}function TI(t,e){if(1&t&&(Ns(0,"div",49),Ns(1,"div",50),Ns(2,"h5",51),Ns(3,"button",52),mo(4),Ua(5,"translate"),Fs(),Fs(),Fs(),Ns(6,"div",53),Ns(7,"div",54),Bs(8,"app-comp-viewcost",47),Fs(),Fs(),Fs()),2&t){const t=Xs(3);_n(4),vo(" ",Ea(5,3,"vpKeyMetric.lbl.metricCost")," "),_n(4),js("vpvActive",t.vpvActive)("combinedPerm",t.combinedPerm)}}function _I(t,e){if(1&t&&(Ns(0,"div",49),Ns(1,"div",50),Ns(2,"h5",51),Ns(3,"button",55),mo(4),Ua(5,"translate"),Fs(),Fs(),Fs(),Ns(6,"div",56),Ns(7,"div",54),Bs(8,"app-comp-viewdeadline",47),Fs(),Fs(),Fs()),2&t){const t=Xs(3);_n(4),vo(" ",Ea(5,3,"vpKeyMetric.lbl.metricDeadline")," "),_n(4),js("vpvActive",t.vpvActive)("combinedPerm",t.combinedPerm)}}function UI(t,e){if(1&t&&(Ns(0,"div",49),Ns(1,"div",57),Ns(2,"h5",51),Ns(3,"button",58),mo(4),Ua(5,"translate"),Fs(),Fs(),Fs(),Ns(6,"div",59),Ns(7,"div",54),Bs(8,"app-comp-viewdelivery",47),Fs(),Fs(),Fs()),2&t){const t=Xs(3);_n(4),vo(" ",Ea(5,3,"vpKeyMetric.lbl.metricDelivery")," "),_n(4),js("vpvActive",t.vpvActive)("combinedPerm",t.combinedPerm)}}function EI(t,e){if(1&t&&(Ns(0,"div"),Gs(1,TI,9,5,"div",48),Gs(2,_I,9,5,"div",48),Gs(3,UI,9,5,"div",48),Fs()),2&t){const t=Xs(2);_n(1),js("ngIf",t.hasVPPerm(t.permVP.ViewAudit)&&t.hasKM(t.vpvActive.keyMetrics,"Cost")&&t.hasOrga),_n(1),js("ngIf",t.hasKM(t.vpvActive.keyMetrics,"Deadline")),_n(1),js("ngIf",t.hasKM(t.vpvActive.keyMetrics,"Delivery"))}}function OI(t,e){if(1&t){const t=zs();Ns(0,"div",38),Ns(1,"div",8),Ns(2,"div",39),Gs(3,VI,3,3,"button",40),Gs(4,wI,3,3,"button",40),Ns(5,"div",41),Ns(6,"button",42),mo(7),Ua(8,"translate"),Bs(9,"span",43),Fs(),Ns(10,"div",18),Gs(11,AI,3,3,"a",20),Gs(12,PI,3,3,"a",20),Gs(13,kI,3,3,"a",20),Ns(14,"a",21),Js("click",(function(){return ei(t),Xs().switchView("All")})),mo(15),Ua(16,"translate"),Fs(),Fs(),Fs(),Fs(),Fs(),Bs(17,"hr"),Gs(18,DI,2,3,"div",2),Gs(19,MI,2,3,"div",2),Gs(20,SI,2,2,"div",2),Gs(21,II,2,2,"div",2),Gs(22,xI,2,2,"div",2),Gs(23,EI,4,3,"div",2),Fs()}if(2&t){const t=Xs();_n(3),js("ngIf",t.hasVPPerm(t.permVP.View)),_n(1),js("ngIf",t.hasVPPerm(t.permVP.Modify+t.permVP.ViewAudit)&&t.hasOrga),_n(3),vo(" ",Ea(8,13,"vpKeyMetric.btn.vpView")," "),_n(4),js("ngIf",t.hasKM(t.vpvActive.keyMetrics,"Cost")&&t.hasOrga),_n(1),js("ngIf",t.hasKM(t.vpvActive.keyMetrics,"Deadline")),_n(1),js("ngIf",t.hasKM(t.vpvActive.keyMetrics,"Delivery")),_n(2),fo(Ea(16,15,"vpKeyMetric.btn.vpViewAll")),_n(3),js("ngIf","KeyMetrics"==t.currentView||t.currentViewKM),_n(1),js("ngIf","Capacity"==t.currentView),_n(1),js("ngIf","Cost"==t.currentView),_n(1),js("ngIf","Deadline"==t.currentView),_n(1),js("ngIf","Delivery"==t.currentView),_n(1),js("ngIf","All"==t.currentView)}}const GI=function(t,e,i){return{"fa-check-circle text-success":t,"fa-exclamation-triangle text-warning":e,"fa-exclamation-circle text-danger":i}};function LI(t,e){if(1&t&&Bs(0,"i",60),2&t){const t=e.level;js("ngClass",Ma(1,GI,1==t,2==t,3==t))}}const RI=function(t,e,i,n){return{"text-secondary":t,"text-success":e,"text-warning":i,"text-danger":n}};function jI(t,e){if(1&t&&Bs(0,"i",61),2&t){const t=e.level;js("ngClass",Sa(1,RI,0==t,1==t,2==t,3==t))}}const $I=function(t,e){return{"font-weight-bold":t,"font-weight-normal":e}};function NI(t,e){if(1&t&&(Ns(0,"span",62),mo(1),Fs()),2&t){const t=e.selected,i=e.text;js("ngClass",Da(2,$I,1==t,0==t)),_n(1),fo(i)}}function FI(t,e){if(1&t&&(Ns(0,"tr"),Ns(1,"td"),mo(2),Ua(3,"translate"),Fs(),Ns(4,"td"),mo(5),Ua(6,"date"),Fs(),Bs(7,"td",78),Fs()),2&t){const t=Xs(3);_n(2),fo(Ea(3,2,"vpKeyMetric.lbl.startDate")),_n(3),fo(Oa(6,4,t.vpvActive.startDate,"dd.MM.yyyy"))}}function BI(t,e){1&t&&Bs(0,"span",83)}function HI(t,e){1&t&&Bs(0,"span",84)}function KI(t,e){if(1&t&&(Ns(0,"span",85),mo(1),Ua(2,"number"),Ua(3,"translate"),Fs()),2&t){const t=Xs(3);_n(1),bo(" ",Oa(2,2,t.delayEndDate,"1.1-1")," ",Ea(3,5,"vpKeyMetric.lbl.weeksDelay"),"")}}function qI(t,e){if(1&t&&(Ns(0,"span",86),mo(1),Ua(2,"number"),Ua(3,"translate"),Fs()),2&t){const t=Xs(3);_n(1),bo(" ",Oa(2,2,-t.delayEndDate,"1.1-1")," ",Ea(3,5,"vpKeyMetric.lbl.weeksAhead"),"")}}function zI(t,e){1&t&&(Ns(0,"span"),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),vo(" ",Ea(2,1,"vpKeyMetric.lbl.inTime"),""))}function QI(t,e){1&t&&qs(0)}function WI(t,e){if(1&t&&(Ns(0,"tr"),Ns(1,"td"),mo(2),Ua(3,"translate"),Fs(),Ns(4,"td",81),mo(5),Fs(),Bs(6,"td"),Fs()),2&t){const t=Xs(3);_n(2),fo(Ea(3,3,"vpKeyMetric.lbl.leadPerson")),_n(2),to("title",t.vpvActive.leadPerson),_n(1),vo(" ",t.getShortText(t.vpvActive.leadPerson,20)," ")}}function JI(t,e){if(1&t&&(Ns(0,"tr"),Ns(1,"td"),mo(2),Ua(3,"translate"),Fs(),Ns(4,"td",81),mo(5),Fs(),Bs(6,"td"),Fs()),2&t){const t=Xs(3);_n(2),fo(Ea(3,3,"vpKeyMetric.lbl.description")),_n(2),to("title",t.vpvActive.description),_n(1),vo(" ",t.getShortText(t.vpvActive.description,20)," ")}}function YI(t,e){if(1&t&&(Ns(0,"tr"),Ns(1,"td"),mo(2),Ua(3,"translate"),Fs(),Ns(4,"td",81),mo(5),Fs(),Bs(6,"td"),Fs()),2&t){const t=Xs(3);_n(2),fo(Ea(3,3,"vpKeyMetric.lbl.template")),_n(2),to("title",t.vpvActive.VorlagenName),_n(1),vo(" ",t.getShortText(t.vpvActive.VorlagenName,20)," ")}}function ZI(t,e){if(1&t&&(Ns(0,"tr"),Ns(1,"td"),mo(2),Ua(3,"translate"),Fs(),Ns(4,"td",81),mo(5),Fs(),Bs(6,"td"),Fs()),2&t){const t=Xs(3);_n(2),fo(Ea(3,3,"vpKeyMetric.lbl.bu")),_n(2),to("title",t.vpvActive.businessUnit),_n(1),vo(" ",t.getShortText(t.vpvActive.businessUnit,20)," ")}}function XI(t,e){if(1&t&&(Ns(0,"table",75),Ns(1,"thead"),Ns(2,"tr"),Ns(3,"th"),mo(4),Ua(5,"translate"),Fs(),Ns(6,"th"),mo(7),Ua(8,"translate"),Fs(),Ns(9,"th"),mo(10),Ua(11,"translate"),Fs(),Fs(),Fs(),Ns(12,"tbody"),Gs(13,FI,8,7,"tr",2),Ns(14,"tr"),Ns(15,"td"),mo(16),Ua(17,"translate"),Fs(),Ns(18,"td"),Gs(19,BI,1,0,"span",76),Gs(20,HI,1,0,"span",77),Ns(21,"span"),mo(22),Ua(23,"date"),Fs(),Fs(),Ns(24,"td",78),Gs(25,KI,4,7,"span",79),Gs(26,qI,4,7,"span",80),Gs(27,zI,3,3,"span",2),Fs(),Fs(),Ns(28,"tr"),Ns(29,"td"),mo(30),Ua(31,"translate"),Fs(),Ns(32,"td",81),Gs(33,QI,1,0,"ng-container",23),Fs(),Ns(34,"td",82),mo(35),Fs(),Fs(),Gs(36,WI,7,5,"tr",2),Gs(37,JI,7,5,"tr",2),Gs(38,YI,7,5,"tr",2),Gs(39,ZI,7,5,"tr",2),Fs(),Fs()),2&t){const t=Xs(2),e=Ls(8);_n(4),fo(Ea(5,21,"vpKeyMetric.lbl.name")),_n(3),fo(Ea(8,23,"vpKeyMetric.lbl.value")),_n(3),fo(Ea(11,25,"vpKeyMetric.lbl.info")),_n(3),js("ngIf",t.vpvActive.startDate),_n(3),fo(Ea(17,27,"vpKeyMetric.lbl.endDate")),_n(3),js("ngIf",t.delayEndDate>0),_n(1),js("ngIf",t.delayEndDate<=0),_n(2),vo(" ",Oa(23,29,t.vpvActive.keyMetrics.endDateCurrent,"dd.MM.yyyy"),""),_n(3),js("ngIf",t.delayEndDate>0),_n(1),js("ngIf",t.delayEndDate<0),_n(1),js("ngIf",0==t.delayEndDate),_n(3),fo(Ea(31,32,"keyMetrics.lbl.trafficLight")),_n(2),to("title",t.vpvActive.ampelErlaeuterung),_n(1),js("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(34,uI,t.vpvActive.ampelStatus)),_n(1),to("title",t.vpvActive.ampelErlaeuterung),_n(1),vo(" ",t.getShortText(t.vpvActive.ampelErlaeuterung,40)," "),_n(1),js("ngIf",t.vpvActive.leadPerson),_n(1),js("ngIf",t.vpvActive.description),_n(1),js("ngIf",t.vpvActive.VorlagenName),_n(1),js("ngIf",t.vpvActive.businessUnit)}}function tx(t,e){if(1&t&&(Ns(0,"div",63),Ns(1,"div",64),Ns(2,"div",65),Ns(3,"div",66),Ns(4,"h5",67),mo(5),Ua(6,"translate"),Ua(7,"date"),Fs(),Ns(8,"button",68),Ns(9,"span",69),mo(10,"\xd7"),Fs(),Fs(),Fs(),Ns(11,"div",70),Ns(12,"form",71),Gs(13,XI,40,36,"table",72),Ns(14,"div",73),Ns(15,"button",74),mo(16),Ua(17,"translate"),Fs(),Fs(),Fs(),Fs(),Fs(),Fs(),Fs()),2&t){const t=Xs();_n(5),bo("",Ea(6,4,"vpKeyMetric.titleDetailVersion"),": ",Oa(7,6,t.vpvActive.timestamp,"dd.MM.yy HH:mm")," "),_n(8),js("ngIf",t.vpvActive),_n(3),fo(Ea(17,9,"vpKeyMetric.btn.back"))}}let ex=(()=>{class t{constructor(t,e,i,n,r,s,o,a,l){this.visboprojectversionService=t,this.visboprojectService=e,this.visbosettingService=i,this.messageService=n,this.alertService=r,this.route=s,this.router=o,this.translate=a,this.titleService=l,this.dropDown=[],this.deleted=!1,this.currentView="KeyMetrics",this.currentViewKM=!1,this.refDate=new Date,this.refDateInterval="month",this.allViews=["KeyMetrics","Capacity","Cost","Deadline","Delivery","All"],this.hasOrga=!1,this.sortAscending=!1,this.sortColumn=1,this.permVC=Av,this.permVP=Pv}ngOnInit(){this.currentLang=this.translate.currentLang,this.variantID=this.route.snapshot.queryParams.variantID,this.variantName=this.route.snapshot.queryParams.variantName;let t=this.route.snapshot.queryParams.view;if(!t)switch(this.route.snapshot.url[0].toString()){case"vpViewCost":t="Cost";break;case"vpViewDeadlines":t="Deadline";break;case"vpViewDeliveries":t="Delivery";break;case"vpView":t="All"}this.allViews.find(e=>e===t)&&(this.currentView=t),this.route.snapshot.queryParams.refDate&&(this.refDate=new Date(this.route.snapshot.queryParams.refDate)),this.getVisboProjectVersions()}ngOnChanges(t){this.log("VP KeyMetrics Changes "+JSON.stringify(t))}hasVCPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vc&t)>0}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}dropDownInit(){if(this.variantID){const t=this.vpActive.variant.findIndex(t=>t._id.toString()===this.variantID);t>=0?this.variantName=this.vpActive.variant[t].variantName:this.variantID=void 0}else if(this.variantName){const t=this.vpActive.variant.findIndex(t=>t.variantName===this.variantName);t>=0?(this.variantName=this.vpActive.variant[t].variantName,this.variantID=this.vpActive.variant[t]._id):this.variantName=void 0}this.log(`Init Drop Down List ${this.vpActive.variant.length+1} Variant ${this.variantID}/${this.variantName}`),this.dropDown=[],this.dropDownIndex=void 0;const t=this.vpActive.variant.length;for(let e=0;e<t;e++)"pfv"!==this.vpActive.variant[e].variantName&&this.vpActive.variant[e].vpvCount>0&&this.dropDown.push(this.vpActive.variant[e].variantName);this.dropDown.length>0&&(this.dropDown.splice(0,0,"DEFAULT"),this.dropDownIndex=0),this.variantName&&(this.dropDownIndex=this.dropDown.findIndex(t=>t===this.variantName))}switchViewParent(t){t&&(t.view?this.switchView(t.view,!0):t.refDate&&this.findVPV(new Date(t.refDate)))}findVPV(t){if(this.visboprojectversions.length>0){let e=0;if(t){for(;e<this.visboprojectversions.length&&!(t.toISOString()>=new Date(this.visboprojectversions[e].timestamp).toISOString());e++);e>=this.visboprojectversions.length&&(e=this.visboprojectversions.length-1)}this.vpvActive=this.visboprojectversions[e],this.evaluateDirection(e)}}evaluateDirection(t){this.statusDirection=1===this.visboprojectversions.length?void 0:t<=0?1:t>=this.visboprojectversions.length-1?-1:0}switchView(t,e=!1){(t=this.allViews.find(e=>e===t))||(t=this.allViews[0]),this.currentView=t,this.currentViewKM=e,this.updateUrlParam("view",t)}switchVariant(t){const e=this.dropDown.findIndex(e=>e===t);if(this.dropDownIndex=e<=0?void 0:e,this.log(`switch Variant ${t} index ${this.dropDownIndex}`),this.dropDownIndex>=0){const e=this.vpActive.variant.find(e=>e.variantName==t);e?(this.variantName=e.variantName,this.variantID=e._id):(this.variantName=void 0,this.variantID=void 0),this.updateUrlParam("variantID",e&&e._id)}else this.variantName=void 0,this.variantID=void 0,this.updateUrlParam("variantID",null);this.getVisboProjectVersions()}isActiveVariant(t){let e=!1;return null==this.variantName&&"DEFAULT"==t&&(e=!0),this.variantName===t&&(e=!0),e}updateUrlParam(t,e){const i=this.route.snapshot.url.join("/");void 0===e&&(e=null);const n=new gb;"variantID"==t?(n.variantID=e,n.variantName=null):"refDate"==t?n.refDate=e:"view"==t&&(n.view=e),this.router.navigate([i],{queryParams:n,replaceUrl:!0,queryParamsHandling:"merge"})}hasKM(t,e){let i=!1;return!t||("Cost"==e?i=t.costCurrentTotal>0||t.costBaseLastTotal>0:"Deadline"==e?i=t.timeCompletionCurrentTotal>0||t.timeCompletionBaseLastTotal>0:"EndDate"==e?i=null!=t.endDateCurrent||null!=t.endDateBaseLast:"DeadlineDelay"===e?i=void 0!==t.timeDelayFinished&&void 0!==t.timeDelayUnFinished:"Delivery"==e?i=t.deliverableCompletionCurrentTotal>0||t.deliverableCompletionBaseLastTotal>0:"DeliveryDelay"===e&&(i=void 0!==t.timeDelayFinished&&void 0!==t.timeDelayUnFinished),i)}getVisboProjectVersions(){const t=this.route.snapshot.paramMap.get("id");this.vpSelected=t,this.log("get VP name if ID is used "+t),t?this.visboprojectService.getVisboProject(t).subscribe(e=>{this.vpActive&&this.vpActive._id===e._id||(this.vpActive=e,this.combinedPerm=e.perm,this.titleService.setTitle(this.translate.instant("vpKeyMetric.titleName",{name:e.name})),this.dropDownInit(),this.getVisboCenterOrga());const i=this.dropDownIndex>0?this.dropDown[this.dropDownIndex]:"";let n="";if(i){const t=this.vpActive.variant.find(t=>t.variantName===i);n=t?t._id.toString():""}this.log(`get VP name if ID is used ${this.vpActive.name} Variant: ${i}/${n} Perm ${JSON.stringify(this.combinedPerm)}`),this.visboprojectversionService.getVisboProjectVersions(t,this.deleted,n,!0).subscribe(t=>{this.visboprojectversions=t,this.visboprojectversions.sort((function(t,e){return Th(e.timestamp,t.timestamp)})),this.log(`get VPV Key metrics: Get ${t.length} Project Versions`),this.findVPV(this.refDate)},t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpKeyMetric.msg.errorPermVersion",{name:this.vpActive.name});this.alertService.error(t)}else this.alertService.error(Lh(t))})},t=>{if(this.log(`get VPV VP failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpKeyMetric.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Lh(t))}):this.gotoRoot()}sameDay(t,e){const i=new Date(t),n=new Date(e);return i.setHours(0,0,0,0),n.setHours(0,0,0,0),i.getTime()===n.getTime()}getRefDateVersions(t){this.log(`get getRefDateVersions current ${this.refDate} ${t} ${this.refDateInterval}`);const e=new Date(this.refDate);let i,n=0,r=0;switch(this.refDateInterval){case"day":e.setHours(0,0,0,0),(t>0||e.getTime()===this.refDate.getTime())&&e.setDate(e.getDate()+t);break;case"week":e.setHours(0,0,0,0),e.setDate(e.getDate()+7*t);break;case"month":e.setHours(0,0,0,0),e.setDate(1),(t>0||e.getTime()===this.refDate.getTime())&&e.setMonth(e.getMonth()+t);break;case"quarter":r=Math.trunc(e.getMonth()/3),t>0&&(r+=t),e.setMonth(3*r),e.setDate(1),e.setHours(0,0,0,0),e.getTime()===this.refDate.getTime()&&e.setMonth(e.getMonth()+3*t)}if(this.log(`get getRefDateVersions new ${e.toISOString()} ${this.refDate.toISOString()}`),this.refDate=e,t>0){const t=new Date(this.visboprojectversions[0].timestamp);e.getTime()>=t.getTime()&&(i=0,this.refDate=new Date)}else{const t=new Date(this.visboprojectversions[this.visboprojectversions.length-1].timestamp);e.getTime()<=t.getTime()&&(i=this.visboprojectversions.length-1,this.refDate.setTime(t.getTime()))}if(void 0===i){for(this.log("get getRefDateVersions normalised "+new Date(e).toISOString()),n=0;n<this.visboprojectversions.length&&!(new Date(this.visboprojectversions[n].timestamp).getTime()<=e.getTime());n++);i=n}this.log("get getRefDateVersions vpv timestamp "+this.visboprojectversions[i].timestamp),this.setVpvActive(this.visboprojectversions[i]),this.evaluateDirection(i)}getNextVersion(t){this.getRefDateVersions(t),Eh(this.refDate)?this.updateUrlParam("refDate",void 0):this.updateUrlParam("refDate",this.refDate.toISOString())}gotoRoot(){this.log("goto Root as no id is specified"),this.router.navigate(["/"],{})}getVisboCenterOrga(){this.vpActive&&this.combinedPerm&&(this.combinedPerm.vc&this.permVC.View)>0&&(this.log("get VC Orga "+this.vpActive.vcid),this.visbosettingService.getVCOrganisations(this.vpActive.vcid,!1,void 0,!0).subscribe(t=>{this.hasOrga=t.length>0},t=>{if(403===t.status){const t=this.translate.instant("vpKeyMetric.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Lh(t))}))}setVpvActive(t){const e=t.keyMetrics,i=new Date(e.endDateCurrent).getTime()-new Date(e.endDateBaseLast).getTime();this.vpvActive=t,this.delayEndDate=Math.round(i/1e3/60/60/24)/7,this.log(`VPV Active: vpv: ${t._id} ${t.timestamp}`)}gotoVPDetail(t){this.router.navigate(["vpDetail/".concat(t._id)])}gotoVC(t){this.router.navigate(["vp/".concat(t.vcid)])}helperDateDiff(t,e,i){const n=new Date(t),r=new Date(e);let s=n.getTime()-r.getTime();return"w"===i?s=s/1e3/60/60/24/7:"d"===i?s=s/1e3/60/60/24:s/=1e3,s}getShortText(t,e){return Gh(t,e)}sortVPVTable(t){this.visboprojectversions&&(void 0!==t?(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?5===t:!this.sortAscending):(this.sortColumn=1,this.sortAscending=!1),1===this.sortColumn?this.visboprojectversions.sort((function(t,e){return Th(t.timestamp,e.timestamp)})):2===this.sortColumn?this.visboprojectversions.sort((function(t,e){return Th(t.endDate,e.endDate)})):3===this.sortColumn?this.visboprojectversions.sort((function(t,e){return t.ampelStatus-e.ampelStatus})):4===this.sortColumn?this.visboprojectversions.sort((function(t,e){return t.Erloes-e.Erloes})):5===this.sortColumn&&this.visboprojectversions.sort((function(t,e){return xh(t.variantName.toLowerCase(),e.variantName.toLowerCase())})),this.sortAscending||this.visboprojectversions.reverse())}log(t){this.messageService.add("VisboProjectKeyMetrics: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(wV),Rs(fb),Rs(Ib),Rs(Rh),Rs(Df),Rs(Fg),Rs(rf),Rs(ov),Rs(Md))},t.\u0275cmp=le({type:t,selectors:[["app-visboproject-keymetrics"]],features:[_e],decls:12,vars:4,consts:[[1,"well"],["class","row",4,"ngIf"],[4,"ngIf"],["class","container-fluid",4,"ngIf"],["indicator",""],["trafficLight",""],["highlight",""],["class","modal fade","id","VpvDetails","tabindex","-1","role","dialog","aria-labelledby","VpvDetailsTitle","aria-hidden","true",4,"ngIf"],[1,"row"],[1,"col"],[3,"click",4,"ngIf"],[3,"click"],["class","ml-1",4,"ngIf"],["class","dropdown","class","ml-2",4,"ngIf"],["data-toggle","modal","data-target","#VpvDetails","class","mx-2",3,"title",4,"ngIf"],[1,"ml-1"],[1,"ml-2"],["data-toggle","dropdown",1,"dropdown-toggle"],[1,"dropdown-menu"],[4,"ngFor","ngForOf"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"dropdown-item",3,"click"],["data-toggle","modal","data-target","#VpvDetails",1,"mx-2",3,"title"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"col-6","text-dark"],[1,"d-none","d-lg-block",3,"title"],[1,"d-block","d-lg-none"],[1,"col-6"],["style","font-size: 2.2em","class","mx-1 fas fa-caret-square-left",3,"title","click",4,"ngIf"],["class","col-4 form-control d-none d-md-block","name","refDateInterval",3,"ngModel","ngModelChange",4,"ngIf"],["style","font-size: 2.2em","class","mx-1 fas fa-caret-square-right",3,"title","click",4,"ngIf"],[1,"mx-1","fas","fa-caret-square-left",2,"font-size","2.2em",3,"title","click"],["name","refDateInterval",1,"col-4","form-control","d-none","d-md-block",3,"ngModel","ngModelChange"],["value","day"],["value","week"],["value","month"],["value","quarter"],[1,"mx-1","fas","fa-caret-square-right",2,"font-size","2.2em",3,"title","click"],[1,"container-fluid"],[1,"col-9","btn-toolbar",2,"padding","unset"],["type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],[1,"btn-group"],["data-toggle","dropdown",1,"btn","btn-md","btn-light","dropdown-toggle"],[1,"caret"],["type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],[3,"visboprojectversions","vpvid","combinedPerm","switchViewChild"],[3,"vpActive","vpvActive","combinedPerm"],[3,"vpvActive","combinedPerm"],["class","card",4,"ngIf"],[1,"card"],["id","headingOne",1,"card-header"],[1,"mb-0"],["type","button","data-toggle","collapse","data-target","#collapseThree","aria-expanded","true","aria-controls","collapseThree",1,"btn","btn-primary"],["id","collapseThree","aria-labelledby","headingThree",1,"collapse","show"],[1,"card-body"],["type","button","data-toggle","collapse","data-target","#collapseOne","aria-expanded","true","aria-controls","collapseOne",1,"btn","btn-primary"],["id","collapseOne","aria-labelledby","headingOne",1,"collapse","show"],["id","headingTwo",1,"card-header"],["type","button","data-toggle","collapse","data-target","#collapseTwo","aria-expanded","true","aria-controls","collapseTwo",1,"btn","btn-primary"],["id","collapseTwo","aria-labelledby","headingTwo",1,"collapse","show"],[1,"fa",3,"ngClass"],[1,"fas","fa-lightbulb",3,"ngClass"],[3,"ngClass"],["id","VpvDetails","tabindex","-1","role","dialog","aria-labelledby","VpvDetailsTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VpvDetailsTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["name","VpvDetailsForm"],["class","table table-hover",4,"ngIf"],[1,"modal-footer","align-items-end"],["data-dismiss","modal",1,"btn","btn-primary"],[1,"table","table-hover"],["class","fas fa-exclamation-circle","style","color:red",4,"ngIf"],["class","fas fa-check-circle","style","color:green",4,"ngIf"],[1,"d-none","d-md-table-cell"],["class","text-danger",4,"ngIf"],["class","text-success",4,"ngIf"],[3,"title"],[1,"d-none","d-md-table-cell",3,"title"],[1,"fas","fa-exclamation-circle",2,"color","red"],[1,"fas","fa-check-circle",2,"color","green"],[1,"text-danger"],[1,"text-success"]],template:function(t,e){1&t&&(Bs(0,"app-usernavbar"),Ns(1,"div",0),Gs(2,fI,8,6,"div",1),Gs(3,CI,16,18,"div",2),Gs(4,OI,24,17,"div",3),Fs(),Gs(5,LI,1,5,"ng-template",null,4,ja),Gs(7,jI,1,6,"ng-template",null,5,ja),Gs(9,NI,2,5,"ng-template",null,6,ja),Gs(11,tx,18,11,"div",7)),2&t&&(_n(2),js("ngIf",e.vpActive),_n(1),js("ngIf",e.vpvActive),_n(1),js("ngIf",e.vpvActive),_n(7),js("ngIf",e.vpvActive))},directives:[bb,jc,Lc,Bc,cu,Nd,Eu,du,gu,KM,pw,eS,OS,sI,Oc,Ou,Fd,Tu],pipes:[av,qc,zc],encapsulation:2}),t})();function ix(t,e){if(1&t){const t=zs();Ns(0,"a",1),Js("click",(function(){ei(t);const e=Xs(2);return e.gotoVCDetail(e.visboproject)})),mo(1),Fs()}if(2&t){const t=Xs(2);_n(1),fo(t.visboproject.name)}}function nx(t,e){if(1&t&&(Ns(0,"span"),mo(1),Fs()),2&t){const t=Xs(2);_n(1),fo(t.visboproject.name)}}function rx(t,e){if(1&t&&(Ns(0,"div",3),Ns(1,"label",44),mo(2),Ua(3,"translate"),Fs(),Ns(4,"label",5),mo(5),Fs(),Fs()),2&t){const t=Xs(2);_n(2),vo("",Ea(3,2,"vpRestrict.lbl.description"),":"),_n(3),vo("",t.visboproject.description," ")}}function sx(t,e){1&t&&Bs(0,"i",59)}function ox(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td",55),mo(2),Fs(),Ns(3,"td",52),mo(4),Fs(),Ns(5,"td",52),Gs(6,sx,1,0,"i",56),Fs(),Ns(7,"td",57),mo(8),Fs(),Ns(9,"td",57),mo(10),Ua(11,"date"),Fs(),Ns(12,"td"),Ns(13,"button",58),Js("click",(function(){ei(t);const i=e.index;return Xs(4).helperRemoveRestriction(i)})),Ua(14,"translate"),mo(15,"\xd7"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit,i=e.index,n=Xs(4);_n(1),to("title",n.getRestrictPath(i)),_n(1),fo(n.getRestrictPath(i,30)),_n(2),fo(n.getGroupName(t.groupid)),_n(2),js("ngIf",t.inclChildren),_n(2),fo(t.user.email),_n(2),fo(Oa(11,7,t.createdAt,"dd.MM HH:mm")),_n(3),to("title",Ea(14,10,"vpRestrict.lbl.rmRestrict"))}}function ax(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div",46),Ns(2,"div",47),Ns(3,"h5",48),mo(4),Ua(5,"translate"),Fs(),Fs(),Fs(),Ns(6,"div",49),Ns(7,"table",50),Ns(8,"thead"),Ns(9,"tr"),Ns(10,"th",1),Js("click",(function(){return ei(t),Xs(3).sortRestrictTable(1)})),mo(11),Ua(12,"translate"),Fs(),Ns(13,"th",51),Js("click",(function(){return ei(t),Xs(3).sortRestrictTable(2)})),mo(14),Ua(15,"translate"),Fs(),Ns(16,"th",52),mo(17),Ua(18,"translate"),Fs(),Ns(19,"th",53),Js("click",(function(){return ei(t),Xs(3).sortRestrictTable(4)})),mo(20),Ua(21,"translate"),Fs(),Ns(22,"th",53),Js("click",(function(){return ei(t),Xs(3).sortRestrictTable(5)})),mo(23),Ua(24,"translate"),Fs(),Ns(25,"th"),mo(26),Ua(27,"translate"),Fs(),Fs(),Fs(),Ns(28,"tbody"),Gs(29,ox,16,12,"tr",54),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(3);_n(4),vo(" ",Ea(5,8,"vpRestrict.titleProjectRestrict")," "),_n(7),fo(Ea(12,10,"vpRestrict.lbl.restrictpath")),_n(3),fo(Ea(15,12,"vpRestrict.lbl.restrictgroup")),_n(3),fo(Ea(18,14,"vpRestrict.lbl.inclChildren")),_n(3),fo(Ea(21,16,"vpRestrict.lbl.createdBy")),_n(3),fo(Ea(24,18,"vpRestrict.lbl.createdAt")),_n(3),fo(Ea(27,20,"vpRestrict.lbl.delete")),_n(3),js("ngForOf",t.visboproject.restrict)}}function lx(t,e){if(1&t&&(Ns(0,"div",46),Ns(1,"label",60),mo(2),Fs(),Ns(3,"button",61),mo(4),Ua(5,"translate"),Fs(),Fs()),2&t){const t=Xs(3);_n(1),to("title",t.getRestrictPath(-1)),_n(1),fo(t.getRestrictPath(-1,30)),_n(2),fo(Ea(5,3,"vpRestrict.btn.add"))}}function cx(t,e){if(1&t&&(Ns(0,"div"),Gs(1,ax,30,22,"div",0),Gs(2,lx,6,5,"div",45),Fs()),2&t){const t=Xs(2);_n(1),js("ngIf",t.visboproject.restrict.length>0&&t.hasVPPerm(t.permVP.Modify+t.permVP.ManagePerm)),_n(1),js("ngIf",t.newItemPath&&t.hasVPPerm(t.permVP.ManagePerm))}}function dx(t,e){if(1&t&&(Ns(0,"option",62),mo(1),Fs()),2&t){const t=e.$implicit;to("value",t._id),_n(1),fo(t.name)}}function ux(t,e){1&t&&(Ns(0,"div",63),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpRestrict.msg.groupRequired")))}function hx(t,e){1&t&&(Ns(0,"button",64),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"vpRestrict.btn.add")))}function px(t,e){if(1&t){const t=zs();Ns(0,"button",65),Js("click",(function(){return ei(t),Xs(2).addRestriction()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"vpRestrict.btn.add")))}function gx(t,e){if(1&t&&(Ns(0,"div",20),Ns(1,"div"),Ns(2,"label",66),mo(3),Ua(4,"translate"),Fs(),Fs(),Ns(5,"form"),Ns(6,"div",23),Ns(7,"label",67),mo(8),Ua(9,"translate"),Fs(),Ns(10,"label",5),mo(11),Fs(),Fs(),Ns(12,"div",23),Ns(13,"label",67),mo(14),Ua(15,"translate"),Fs(),Ns(16,"label",5),mo(17),Fs(),Fs(),Ns(18,"div",23),Ns(19,"label",67),mo(20),Ua(21,"translate"),Fs(),Ns(22,"label",5),mo(23),Fs(),Fs(),Ns(24,"div",23),Ns(25,"label",67),mo(26),Ua(27,"translate"),Fs(),Ns(28,"label",5),mo(29),Fs(),Fs(),Ns(30,"div",23),Ns(31,"label",67),mo(32),Ua(33,"translate"),Fs(),Ns(34,"label",5),mo(35),Fs(),Fs(),Ns(36,"div",23),Ns(37,"label",67),mo(38),Ua(39,"translate"),Fs(),Ns(40,"label",5),mo(41),Ua(42,"date"),Fs(),Fs(),Fs(),Fs()),2&t){const t=Xs(2);_n(3),fo(Ea(4,13,"vpRestrict.msg.removeRestrictionConfirm")),_n(5),vo("",Ea(9,15,"vpRestrict.lbl.vp"),":"),_n(3),vo("",t.visboproject.name," "),_n(3),vo("",Ea(15,17,"vpRestrict.lbl.restrictpath"),":"),_n(3),fo(t.getRestrictPath(t.restrictIndex)),_n(3),vo("",Ea(21,19,"vpRestrict.lbl.group"),":"),_n(3),fo(t.getGroupName(t.visboproject.restrict[t.restrictIndex].groupid)),_n(3),vo("",Ea(27,21,"vpRestrict.lbl.inclChildrenDesc"),":"),_n(3),fo(t.visboproject.restrict[t.restrictIndex].inclChildren),_n(3),vo("",Ea(33,23,"vpRestrict.lbl.createdBy"),":"),_n(3),fo(t.visboproject.restrict[t.restrictIndex].user.email),_n(3),vo("",Ea(39,25,"vpRestrict.lbl.createdAt"),":"),_n(3),fo(Oa(42,27,t.visboproject.restrict[t.restrictIndex].createdAt,"dd.MM HH:mm"))}}const mx=function(t){return{"has-error":t}};function fx(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"h3"),mo(2),Ua(3,"translate"),Ns(4,"a",1),Js("click",(function(){ei(t);const e=Xs();return e.gotoVP(e.visboproject)})),mo(5),Ua(6,"uppercase"),Fs(),Fs(),Ns(7,"h5"),mo(8),Ua(9,"translate"),Gs(10,ix,2,1,"a",2),Gs(11,nx,2,1,"span",0),Fs(),Ns(12,"form"),Ns(13,"div",3),Ns(14,"label",4),mo(15),Ua(16,"translate"),Fs(),Ns(17,"label",5),mo(18),Fs(),Fs(),Gs(19,rx,6,4,"div",6),Ns(20,"div",3),Ns(21,"label",7),mo(22),Ua(23,"translate"),Fs(),Ns(24,"label",8),mo(25),Fs(),Fs(),Ns(26,"div",9),Ns(27,"label",10),mo(28),Ua(29,"translate"),Fs(),Ns(30,"label",11),mo(31),Ua(32,"date"),Fs(),Ns(33,"label",11),mo(34),Ua(35,"date"),Fs(),Fs(),Fs(),Gs(36,cx,3,2,"div",0),Ns(37,"div",12),Ns(38,"button",1),Js("click",(function(){return ei(t),Xs().goBack()})),mo(39),Ua(40,"translate"),Fs(),Fs(),Ns(41,"div",13),Ns(42,"div",14),Ns(43,"div",15),Ns(44,"div",16),Ns(45,"h5",17),mo(46),Ua(47,"translate"),Fs(),Ns(48,"button",18),Ns(49,"span",19),mo(50,"\xd7"),Fs(),Fs(),Fs(),Ns(51,"div",20),Ns(52,"form",21,22),Ns(54,"div",23),Ns(55,"label",24),mo(56),Ua(57,"translate"),Fs(),Ns(58,"label"),mo(59),Fs(),Fs(),Ns(60,"div",25),Ns(61,"label",26),mo(62),Ua(63,"translate"),Fs(),Ns(64,"select",27,28),Js("ngModelChange",(function(e){return ei(t),Xs().newItemGroup=e})),Bs(66,"option"),Gs(67,dx,2,2,"option",29),Fs(),Gs(68,ux,3,3,"div",30),Fs(),Ns(69,"div",31),Ns(70,"input",32,33),Js("ngModelChange",(function(e){return ei(t),Xs().newItemInclChildren=e})),Fs(),Ns(72,"label",34),mo(73),Ua(74,"translate"),Fs(),Fs(),Bs(75,"br"),Ns(76,"div",35),Ns(77,"button",36),mo(78),Ua(79,"translate"),Fs(),Gs(80,hx,3,3,"button",37),Gs(81,px,3,3,"button",38),Fs(),Fs(),Fs(),Fs(),Fs(),Fs(),Ns(82,"div",39),Ns(83,"div",14),Ns(84,"div",15),Ns(85,"div",16),Ns(86,"h5",40),mo(87),Ua(88,"translate"),Fs(),Ns(89,"button",18),Ns(90,"span",19),mo(91,"\xd7"),Fs(),Fs(),Fs(),Gs(92,gx,43,30,"div",41),Ns(93,"div",35),Ns(94,"button",42),mo(95),Ua(96,"translate"),Fs(),Ns(97,"button",43),Js("click",(function(){ei(t);const e=Xs();return e.removeRestriction(e.restrictIndex)})),mo(98),Ua(99,"translate"),Fs(),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Ls(53),e=Ls(65),i=Xs();_n(2),vo("",Ea(3,32,"vpRestrict.title"),": "),_n(3),fo(Ea(6,34,i.visboproject.name)),_n(3),vo("",Ea(9,36,"vpRestrict.titleVC"),": "),_n(2),js("ngIf",i.hasVCPerm(i.permVC.View)),_n(1),js("ngIf",!i.hasVCPerm(i.permVC.View)),_n(4),vo("",Ea(16,38,"vpRestrict.lbl.name"),":"),_n(3),vo("",i.visboproject.name," "),_n(1),js("ngIf",i.visboproject.description),_n(3),vo("",Ea(23,40,"vpRestrict.lbl.type"),":"),_n(3),vo("",i.getVPType(i.visboproject.vpType)," "),_n(3),vo("",Ea(29,42,"vpRestrict.lbl.createdUpdated"),":"),_n(3),vo("",Oa(32,44,i.visboproject.createdAt,"dd.MM.yyyy HH:mm:ss")," "),_n(3),vo("",Oa(35,47,i.visboproject.updatedAt,"dd.MM.yyyy HH:mm:ss")," "),_n(2),js("ngIf",i.getVPPerm()!=i.permVP.View),_n(3),fo(Ea(40,50,"vpRestrict.btn.back")),_n(7),fo(Ea(47,52,"vpRestrict.titleAddRestriction")),_n(10),vo("",Ea(57,54,"vpRestrict.lbl.restrictpath"),":"),_n(3),fo(i.getRestrictPath(-1)),_n(1),js("ngClass",ka(68,mx,t.submitted&&!e.valid)),_n(2),vo("",Ea(63,56,"vpRestrict.lbl.group"),":"),_n(2),js("ngModel",i.newItemGroup),_n(3),js("ngForOf",i.vgGroups),_n(1),js("ngIf",t.submitted&&!e.valid),_n(2),js("ngModel",i.newItemInclChildren),_n(3),fo(Ea(74,58,"vpRestrict.lbl.inclChildrenDesc")),_n(5),fo(Ea(79,60,"vpRestrict.btn.cancel")),_n(2),js("ngIf",!e.valid),_n(1),js("ngIf",e.valid),_n(6),fo(Ea(88,62,"vpRestrict.titleRemoveRestriction")),_n(5),js("ngIf",i.restrictIndex>=0&&i.restrictIndex<i.visboproject.restrict.length),_n(3),fo(Ea(96,64,"vpRestrict.btn.back")),_n(3),fo(Ea(99,66,"vpRestrict.btn.delete"))}}let vx=(()=>{class t{constructor(t,e,i,n,r,s,o){this.messageService=t,this.route=e,this.visboprojectService=i,this.location=n,this.router=r,this.alertService=s,this.translate=o,this.combinedPerm=void 0,this.combinedUserPerm=void 0,this.permVC=Av,this.permVP=Pv,this.deleted=!1,this.sortRestrictColumn=1,this.sortRestrictAscending=!0}ngOnInit(){const t=this.route.snapshot.queryParams.id;if(t){const e=JSON.parse(localStorage.getItem("restrict"));e&&e.id===t&&(this.newItemPath=e.path)}this.log("VisboProject Restrict Active Path: "+this.newItemPath),this.getVisboProject(),this.getVisboProjectUsers()}getVisboProject(){const t=this.route.snapshot.paramMap.get("id");this.log("VisboProject Restrict of: "+t),this.visboprojectService.getVisboProject(t,!1,this.deleted).subscribe(e=>{this.visboproject=e,this.combinedPerm=e.perm,this.log(`Get VisboProject for VP ${t} Perm ${JSON.stringify(this.combinedPerm)} `)},t=>{if(this.log(`get VPs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpRestrict.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Lh(t))})}hasVCPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vc&t)>0}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}hasUserVPPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vp&t)>0}getVPPerm(){return void 0===this.combinedPerm?0:this.combinedPerm.vp}getVPType(t){return this.translate.instant("vp.type.vpType"+t)}getRestrictPath(t,e){const i=t>=0?this.visboproject.restrict[t].elementPath:this.newItemPath||[""];let n="";return n=i.length<=1?this.visboproject.name:i.slice(1).join(" / "),e>0&&(n=Gh(n,e,"right")),n}addRestriction(){this.log(`VisboProject Restrict Add Restriction : ${this.newItemPath.join(" / ")} ${this.newItemGroup} ${this.newItemInclChildren}`);const t=new pb;t.name=this.newItemName||(new Date).toISOString(),t.elementPath=this.newItemPath,t.groupid=this.newItemGroup,this.newItemInclChildren&&(t.inclChildren=this.newItemInclChildren),this.visboprojectService.addRestriction(this.visboproject._id,t).subscribe(t=>{this.log("Add VisboProject Restriction result: "+JSON.stringify(t)),this.visboproject.restrict.push(t);const e=this.translate.instant("vpRestrict.msg.addRestrictionSuccess");localStorage.removeItem("restrict"),this.newItemPath=void 0,this.alertService.success(e)},t=>{if(this.log("Add VisboProject Restriction error: "+t.error.message),403===t.status){const t=this.translate.instant("vpRestrict.msg.errorAddRestrictionPerm");this.alertService.error(t)}else this.log("Error during add Restriction from VP  "+t.error.message),this.alertService.error(Lh(t))})}removeRestriction(t){const e=this.visboproject.restrict[t];this.log(`VisboProject Restrict Remove Restriction : ${t} ${e._id}`),this.visboprojectService.deleteRestriction(this.visboproject._id,e._id).subscribe(t=>{this.log("Remove VisboProject Restriction result: "+JSON.stringify(t));for(let n=0;n<this.visboproject.restrict.length;n++)if(this.visboproject.restrict[n]._id===e._id){this.visboproject.restrict.splice(n,1);break}const i=this.translate.instant("vpRestrict.msg.removeRestrictionSuccess");this.alertService.success(i)},t=>{if(this.log("Remove VisboProject Restriction error: "+t.error.message),403===t.status){const t=this.translate.instant("vpRestrict.msg.errorRemoveRestrictionPerm");this.alertService.error(t)}else this.log("Error during remove Restriction from VP  "+t.error.message),this.alertService.error(Lh(t))})}helperRemoveRestriction(t){this.restrictIndex=t}getGroupName(t){const e=this.vgGroups?this.vgGroups.find(e=>e._id===t):void 0;return e?e.name:"Unknown"}getVisboProjectUsers(){const t=this.route.snapshot.paramMap.get("id");this.log(`VisboProject UserList of: ${t} Deleted ${this.deleted}`),this.visboprojectService.getVPUsers(t,!1,this.deleted).subscribe(t=>{this.filterGroups(t.groups),this.log("fetched Groups "+this.vgGroups.length)},t=>{if(this.log(`Get VP Users failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpRestrict.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Lh(t))})}filterGroups(t){this.vgGroups=[],t.forEach(t=>{"VP"===t.groupType&&this.vgGroups.push(t)})}goBack(){this.location.back()}gotoVPAudit(t){this.log(`goto VP Audit: ${t._id} Deleted ${this.deleted}`),this.router.navigate(["vpAudit/".concat(t._id)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}gotoVCDetail(t){this.router.navigate(["vcDetail/".concat(t.vcid)])}gotoVPList(t){this.log(`goto VP List: ${t._id} Deleted ${this.deleted}`),this.router.navigate(["vp/".concat(t.vcid)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}gotoVP(t){this.log(`goto VP: ${t._id} Deleted ${this.deleted}`);let e="vpKeyMetrics/";t.vpType===hb.Portfolio&&(e="vpf/"),this.router.navigate([e.concat(t._id)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}gotoVPView(t){this.log(`goto VP List: ${t._id} Deleted ${this.deleted}`),this.router.navigate(["vpv/".concat(t._id)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}sortRestrictTable(t){if(this.visboproject||this.visboproject.restrict){if(void 0===t&&void 0!==this.sortRestrictColumn||(t!==this.sortRestrictColumn&&(this.sortRestrictColumn=t,this.sortRestrictAscending=void 0),this.sortRestrictAscending=void 0===this.sortRestrictAscending?5!==t:!this.sortRestrictAscending),1===this.sortRestrictColumn)this.visboproject.restrict.sort((function(t,e){return xh(t.elementPath.join(" / ").toLowerCase(),e.elementPath.join(" / ").toLowerCase())}));else if(2===this.sortRestrictColumn){const t=[];this.vgGroups.forEach(e=>t[e._id]=e.name),this.visboproject.restrict.sort((function(e,i){return xh(t[e.groupid],t[i.groupid])}))}else 4===this.sortRestrictColumn?this.visboproject.restrict.sort((function(t,e){return xh(t.user.email,e.user.email)})):5===this.sortRestrictColumn&&this.visboproject.restrict.sort((function(t,e){return Th(t.createdAt,e.createdAt)}));this.sortRestrictAscending||this.visboproject.restrict.reverse()}}log(t){this.messageService.add("VisboProjectRestrict: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(Fg),Rs(fb),Rs(Xl),Rs(rf),Rs(Df),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-visboproject-restrict"]],decls:2,vars:1,consts:[[4,"ngIf"],[3,"click"],[3,"click",4,"ngIf"],[1,"form-group","row"],["for","vpName",1,"col-3","col-md-2","col-form-label"],[1,"col-8","form-control-static"],["class","form-group row",4,"ngIf"],["for","vpType",1,"col-3","col-md-2","col-form-label"],["name","vpType",1,"col","form-control-static","col-form-label"],[1,"form-group","row","d-none","d-md-block"],["for","Created",1,"col-3","col-md-2","col-form-label"],[1,"col-4","form-control-static","col-form-label"],[1,"mb-3"],["id","VpRestrictionAdd","tabindex","-1","role","dialog","aria-labelledby","VpRestrictModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["novalidate",""],["f1","ngForm"],[1,"form-group"],["for","path",1,"col-form-label"],[1,"form-group",3,"ngClass"],["for","group",1,"col-form-label"],["name","group","required","",1,"form-control",3,"ngModel","ngModelChange"],["group","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","help-block",4,"ngIf"],[1,"custom-control","custom-checkbox"],["type","checkbox","name","inclChildren","id","inclChildrenID",1,"custom-control-input",3,"ngModel","ngModelChange"],["inclChildren","ngModel"],["for","inclChildrenID",1,"custom-control-label"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary","mx-1"],["type","submit","class","btn btn-primary mx-1",4,"ngIf"],["type","submit","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","VpRestrictionRemove","tabindex","-1","role","dialog","aria-labelledby","Remove Restriction","aria-hidden","true",1,"modal","fade"],["id","VpUserRemoveTitle",1,"modal-title"],["class","modal-body",4,"ngIf"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button","data-dismiss","modal",1,"btn","btn-warning",3,"click"],["for","vpDescription",1,"col-3","col-md-2","col-form-label"],["class","row",4,"ngIf"],[1,"row"],[1,"col"],[1,"panel-heading"],[1,"panel-body"],[1,"table","table-hover"],[1,"d-none","d-md-table-cell",3,"click"],[1,"d-none","d-md-table-cell"],[1,"d-none","d-lg-table-cell",3,"click"],[4,"ngFor","ngForOf"],[3,"title"],["class","fa fa-check","aria-hidden","true",4,"ngIf"],[1,"d-none","d-lg-table-cell"],["data-toggle","modal","data-target","#VpRestrictionRemove",1,"btn","btn-md",3,"title","click"],["aria-hidden","true",1,"fa","fa-check"],[1,"col",3,"title"],["type","button","data-toggle","modal","data-target","#VpRestrictionAdd",1,"col-2","btn","btn-primary"],[3,"value"],[1,"help-block"],["type","submit",1,"btn","btn-primary","mx-1"],["type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],[1,"bg-warning"],[1,"col-form-label"]],template:function(t,e){1&t&&(Bs(0,"app-usernavbar"),Gs(1,fx,100,70,"div",0)),2&t&&(_n(1),js("ngIf",e.visboproject))},directives:[bb,jc,Ou,Fd,Tu,Oc,cu,Ru,Nd,Eu,du,gu,Lc,_d],pipes:[av,Kc,qc],styles:[""]}),t})(),bx=(()=>{class t{constructor(t,e,i){this.visbocenterService=t,this.messageService=e,this.alertService=i}ngOnInit(){this.activateMessage=this.messageService.getstatus(),this.combinedPerm=this.visbocenterService.getSysAdminRole()}toggleMessages(){this.activateMessage=this.messageService.toggle()}}return t.\u0275fac=function(e){return new(e||t)(Rs(xv),Rs(Rh),Rs(Df))},t.\u0275cmp=le({type:t,selectors:[["app-settings"]],decls:6,vars:1,consts:[["type","button",1,"btn","btn-sm","btn-primary","align-self-start",3,"click"]],template:function(t,e){1&t&&(Bs(0,"app-usernavbar"),Ns(1,"div"),Ns(2,"a"),mo(3),Fs(),Ns(4,"button",0),Js("click",(function(){return e.toggleMessages()})),mo(5," Toggle Messages "),Fs(),Fs()),2&t&&(_n(3),vo("Display Debug Messages: ",e.activateMessage," "))},directives:[bb],encapsulation:2}),t})();const yx={headers:new th({"Content-Type":"application/json"})};let Cx=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.profileUrl=this.env.restUrl.concat("/user/profile"),this.pwchangeUrl=this.env.restUrl.concat("/user/passwordchange")}getUserProfile(){return this.log("Calling HTTP Get Request: "+this.profileUrl),this.http.get(this.profileUrl,yx).pipe(D(t=>t.user),Kh(t=>this.log(`fetched ${t.email} User Profile `)),Nh(this.handleError("getUserProfile")))}updateUserProfile(t){return this.log("Calling HTTP Put Request: "+this.profileUrl),this.http.put(this.profileUrl,t,yx).pipe(D(t=>t.user),Kh(t=>this.log(`updated User Profile ${t.email} `)),Nh(this.handleError("updateUserProfile")))}passwordChange(t,e){return this.log("Calling HTTP Put Request: "+this.pwchangeUrl),this.http.put(this.pwchangeUrl,{oldpassword:t,password:e},yx).pipe(D(t=>t.user),Kh(t=>this.log(`Changed User Password ${t.email} `)),Nh(this.handleError("ChangedPassword")))}handleError(t="operation",e){return i=>(this.log(`HTTP Request ${t} failed: ${i.error.message} status:${i.status}, Result ${JSON.stringify(e)}`),jh(i))}log(t){this.messageService.add("VisboUserService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(Rh),Kt(np))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function Vx(t,e){1&t&&(Ns(0,"div",25),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"profile.msg.firstNameRequired")))}function wx(t,e){1&t&&(Ns(0,"div",25),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"profile.msg.lastNameRequired")))}function Ax(t,e){1&t&&(Ns(0,"div",25),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"profile.msg.companyRequired")))}function Px(t,e){1&t&&Bs(0,"img",26)}const kx=function(t){return{"has-error":t}},Dx=function(){return["/"]};function Mx(t,e){if(1&t){const t=zs();Ns(0,"div",2),Ns(1,"h3",3),mo(2),Ua(3,"translate"),Fs(),Ns(4,"div"),Ns(5,"form",4,5),Js("ngSubmit",(function(){ei(t);const e=Ls(6),i=Xs();return e.form.valid&&i.saveUserProfile()})),Ns(7,"div",6),Ns(8,"label",7),mo(9),Ua(10,"translate"),Fs(),Ns(11,"input",8,9),Js("ngModelChange",(function(e){return ei(t),Xs().user.profile.firstName=e})),Fs(),Gs(13,Vx,3,3,"div",10),Fs(),Ns(14,"div",6),Ns(15,"label",11),mo(16),Ua(17,"translate"),Fs(),Ns(18,"input",12,13),Js("ngModelChange",(function(e){return ei(t),Xs().user.profile.lastName=e})),Fs(),Gs(20,wx,3,3,"div",10),Fs(),Ns(21,"div",6),Ns(22,"label",14),mo(23),Ua(24,"translate"),Fs(),Ns(25,"input",15,16),Js("ngModelChange",(function(e){return ei(t),Xs().user.profile.company=e})),Fs(),Gs(27,Ax,3,3,"div",10),Fs(),Ns(28,"div",17),Ns(29,"label",18),mo(30),Ua(31,"translate"),Fs(),Ns(32,"input",19,20),Js("ngModelChange",(function(e){return ei(t),Xs().user.profile.phone=e})),Fs(),Fs(),Ns(34,"div",17),Ns(35,"button",21),mo(36),Ua(37,"translate"),Fs(),Gs(38,Px,1,0,"img",22),Ns(39,"a",23),mo(40),Ua(41,"translate"),Fs(),Ns(42,"button",24),Js("click",(function(){return ei(t),Xs().passwordInit()})),mo(43),Ua(44,"translate"),Fs(),Fs(),Fs(),Ns(45,"div"),mo(46),Ua(47,"translate"),Ua(48,"date"),Bs(49,"br"),mo(50),Ua(51,"translate"),Ua(52,"date"),Fs(),Fs(),Fs()}if(2&t){const t=Ls(6),e=Ls(12),i=Ls(19),n=Ls(26),r=Xs();_n(2),bo("",Ea(3,25,"profile.title")," ",r.user.email,""),_n(5),js("ngClass",ka(51,kx,t.submitted&&!e.valid)),_n(2),fo(Ea(10,27,"profile.lbl.firstName")),_n(2),js("ngModel",r.user.profile.firstName),_n(2),js("ngIf",t.submitted&&!e.valid),_n(1),js("ngClass",ka(53,kx,t.submitted&&!i.valid)),_n(2),fo(Ea(17,29,"profile.lbl.lastName")),_n(2),js("ngModel",r.user.profile.lastName),_n(2),js("ngIf",t.submitted&&!i.valid),_n(1),js("ngClass",ka(55,kx,t.submitted&&!n.valid)),_n(2),fo(Ea(24,31,"profile.lbl.company")),_n(2),js("ngModel",r.user.profile.company),_n(2),js("ngIf",t.submitted&&!n.valid),_n(3),fo(Ea(31,33,"profile.lbl.phone")),_n(2),js("ngModel",r.user.profile.phone),_n(4),fo(Ea(37,35,"profile.btn.save")),_n(2),js("ngIf",r.loading),_n(1),js("routerLink",Pa(57,Dx)),_n(1),fo(Ea(41,37,"profile.btn.cancel")),_n(3),vo(" ",Ea(44,39,"profile.btn.changePW")," "),_n(3),bo(" ",Ea(47,41,"profile.msg.lastLogin")," ",Oa(48,43,r.user.status.lastLoginAt,"dd.MM.yyyy HH:mm:ss")," "),_n(4),bo(" ",Ea(51,46,"profile.msg.lastFailedLogin")," ",Oa(52,48,r.user.status.lastLoginFailedAt,"dd.MM.yyyy HH:mm:ss")," ")}}function Sx(t,e){1&t&&(Ns(0,"div",25),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"profile.msg.oldPWRequired")))}function Ix(t,e){1&t&&(Ns(0,"div",48),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"profile.msg.followPolicy")))}function xx(t,e){if(1&t&&(Ns(0,"div",48),mo(1),Fs()),2&t){const t=Xs(2);_n(1),fo(t.PWPolicyDescription)}}function Tx(t,e){1&t&&(Ns(0,"button",49),mo(1),Ua(2,"translate"),Fs()),2&t&&(_n(1),fo(Ea(2,1,"profile.btn.change")))}function _x(t,e){if(1&t){const t=zs();Ns(0,"button",50),Js("click",(function(){return ei(t),Xs(2).passwordChange()})),mo(1),Ua(2,"translate"),Fs()}2&t&&(_n(1),fo(Ea(2,1,"profile.btn.change")))}function Ux(t,e){if(1&t){const t=zs();Ns(0,"div",27),Ns(1,"div",28),Ns(2,"div",29),Ns(3,"div",30),Ns(4,"h5",31),mo(5),Ua(6,"translate"),Fs(),Ns(7,"button",32),Ns(8,"span",33),mo(9,"\xd7"),Fs(),Fs(),Fs(),Ns(10,"div",34),Ns(11,"form",35,36),Ns(13,"div",6),Ns(14,"label",37),mo(15),Ua(16,"translate"),Fs(),Ns(17,"input",38,39),Js("ngModelChange",(function(e){return ei(t),Xs().oldpw=e})),Fs(),Gs(19,Sx,3,3,"div",10),Fs(),Ns(20,"div",6),Ns(21,"label",40),Ua(22,"translate"),mo(23),Ua(24,"translate"),Fs(),Ns(25,"input",41,42),Js("ngModelChange",(function(e){return ei(t),Xs().newpw=e})),Fs(),Gs(27,Ix,3,3,"div",43),Gs(28,xx,2,1,"div",43),Fs(),Ns(29,"div",44),Ns(30,"button",45),mo(31),Ua(32,"translate"),Fs(),Gs(33,Tx,3,3,"button",46),Gs(34,_x,3,3,"button",47),Fs(),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Ls(12),e=Ls(18),i=Ls(26),n=Xs();_n(5),fo(Ea(6,16,"profile.titleChangePW")),_n(8),js("ngClass",ka(26,kx,t.submitted&&!e.valid)),_n(2),vo("",Ea(16,18,"profile.lbl.oldPassword"),"(*):"),_n(2),js("ngModel",n.oldpw),_n(2),js("ngIf",t.submitted&&!e.valid),_n(1),js("ngClass",ka(28,kx,t.submitted&&!i.valid)),_n(1),io("title","",Ea(22,20,"profile.lbl.PWRule"),": ",n.PWPolicyDescription,""),_n(2),vo(" ",Ea(24,22,"profile.lbl.newPassword"),"(*): "),_n(2),to("pattern",n.PWPolicy),js("ngModel",n.newpw),_n(2),js("ngIf",!i.valid),_n(1),js("ngIf",!i.valid),_n(3),fo(Ea(32,24,"profile.btn.cancel")),_n(2),js("ngIf",!t.form.valid),_n(1),js("ngIf",t.form.valid)}}let Ex=(()=>{class t{constructor(t,e,i,n,r,s,o,a){this.userService=t,this.messageService=e,this.alertService=i,this.route=n,this.authenticationService=r,this.router=s,this.translate=o,this.titleService=a,this.loading=!1}ngOnInit(){this.currentLang=this.translate.currentLang,this.titleService.setTitle(this.translate.instant("profile.titleShort")),this.getPWPolicy(),this.log("Start init User Get Profile"),this.getUserProfile()}getUserProfile(){this.log("User Get Profile"),this.userService.getUserProfile().subscribe(t=>{this.user=t,this.user.profile||(this.user.profile=new Wh),this.log("get User Profile success "+t.email)},t=>{this.log(`get User profile failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}saveUserProfile(){this.loading=!0,this.log("Save profile info now "+this.user.email),this.userService.updateUserProfile(this.user).subscribe(t=>{this.log("Save profile success updatedAt "+t.updatedAt),this.user=t;const e=this.translate.instant("profile.msg.updateSuccess");this.alertService.success(e,!0),this.loading=!1},t=>{if(this.log(`update User profile failed: error: ${t.status} message: ${t.error.message} `),403===t.status){const t=this.translate.instant("profile.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Lh(t));this.loading=!1})}passwordInit(){this.changePW=!0,this.oldpw="",this.newpw=""}passwordChange(){this.log(`Password Change ${this.user.email} Len Old ${this.oldpw.length} New ${this.newpw.length}`),this.changePW=!1,this.userService.passwordChange(this.oldpw,this.newpw).subscribe(t=>{this.log("Change Password success updatedAt "+t.updatedAt),this.user=t;const e=this.translate.instant("profile.msg.changePWSuccess");this.alertService.success(e,!0)},t=>{if(this.log(`change password failed: error: ${t.status} message: ${t.error.message} `),403===t.status){const t=this.translate.instant("profile.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Lh(t))})}userReset(){this.getUserProfile()}getPWPolicy(){this.authenticationService.initPWPolicy().subscribe(t=>{this.log("Init PW Policy success "+JSON.stringify(t)),this.PWPolicy=t.PWPolicy,this.PWPolicyDescription=t.Description},t=>{this.log(`Init PW Policy Failed: ${t.status} ${t.error.message} `),this.alertService.error(Lh(t))})}log(t){this.messageService.add("UserProfile: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Cx),Rs(Rh),Rs(Df),Rs(Fg),Rs(sp),Rs(rf),Rs(ov),Rs(Md))},t.\u0275cmp=le({type:t,selectors:[["app-userprofile"]],decls:3,vars:2,consts:[["class","col-md-8 col-md-offset-2",4,"ngIf"],["class","modal fade","id","UserModalChangePassword","tabindex","-1","role","dialog","aria-labelledby","UserPasswordChangeModalTitle","aria-hidden","true",4,"ngIf"],[1,"col-md-8","col-md-offset-2"],["id","profileTitle"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group",3,"ngClass"],["for","firstName"],["id","profileFirstName","type","text","name","firstName","required","",1,"form-control",3,"ngModel","ngModelChange"],["firstName","ngModel"],["class","help-block",4,"ngIf"],["for","lastName"],["id","profileLastName","type","text","name","lastName","required","",1,"form-control",3,"ngModel","ngModelChange"],["lastName","ngModel"],["for","company"],["id","profileCompany","type","text","name","company","required","",1,"form-control",3,"ngModel","ngModelChange"],["company","ngModel"],[1,"form-group"],["for","phone"],["id","profilePhone","type","text","name","phone",1,"form-control",3,"ngModel","ngModelChange"],["phone","ngModel"],["id","ButtonSave",1,"btn","btn-primary"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==",4,"ngIf"],["id","ButtonBack",1,"btn","btn-link",3,"routerLink"],["id","ButtonChangePW","type","button","data-toggle","modal","data-target","#UserModalChangePassword",1,"btn","btn-secondary",2,"float","right",3,"click"],[1,"help-block"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="],["id","UserModalChangePassword","tabindex","-1","role","dialog","aria-labelledby","UserPasswordChangeModalTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","UserPasswordChangeModalTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["name","passwordChange","novalidate",""],["fpw","ngForm"],["for","oldpassword",1,"col-form-label"],["id","passwordOld","type","password","name","oldpassword","required","","autocomplete","password",1,"form-control",3,"ngModel","ngModelChange"],["oldpassword","ngModel"],["for","newpassword","data-toggle","tooltip","data-placement","top","data-delay","50",1,"col-form-label",3,"title"],["id","passwordNew","type","password","name","newpassword","required","","autocomplete","off",1,"form-control",3,"ngModel","pattern","ngModelChange"],["newpassword","ngModel"],["id","passwordPolicy","class","help-block",4,"ngIf"],[1,"modal-footer","align-items-end"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-secondary"],["id","ButtonChange","type","submit","class","btn btn-primary",4,"ngIf"],["id","ButtonChange","type","submit","class","btn btn-primary","data-dismiss","modal",3,"click",4,"ngIf"],["id","passwordPolicy",1,"help-block"],["id","ButtonChange","type","submit",1,"btn","btn-primary"],["id","ButtonChange","type","submit","data-dismiss","modal",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(Bs(0,"app-usernavbar"),Gs(1,Mx,53,58,"div",0),Gs(2,Ux,35,30,"div",1)),2&t&&(_n(1),js("ngIf",e.user),_n(1),js("ngIf",1==e.changePW))},directives:[bb,jc,Ou,Fd,Tu,Oc,Od,Ru,Nd,Eu,sf,Hu],pipes:[av,qc],encapsulation:2}),t})();function Ox(t,e){if(1&t){const t=zs();Ns(0,"button",36),Js("click",(function(){return ei(t),Xs(2).toggleUserGroup()})),mo(1,"Show Groups"),Fs()}}function Gx(t,e){if(1&t){const t=zs();Ns(0,"button",37),Js("click",(function(){return ei(t),Xs(2).toggleUserGroup()})),mo(1,"Show Users"),Fs()}}function Lx(t,e){1&t&&(Ns(0,"div",39),Ns(1,"button",48),mo(2,"Add User"),Fs(),Fs())}function Rx(t,e){1&t&&(Ns(0,"th"),mo(1,"Delete"),Fs())}function jx(t,e){if(1&t){const t=zs();Ns(0,"td"),Ns(1,"button",51),Js("click",(function(){ei(t);const e=Xs().index;return Xs(3).helperUserIndex(e)})),mo(2,"\xd7"),Fs(),Fs()}}function $x(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td"),mo(2),Fs(),Ns(3,"td",49),Js("click",(function(){ei(t);const i=e.index;return Xs(3).calcCombinedPerm(i)})),Ns(4,"a"),mo(5),Fs(),Fs(),Ns(6,"td",50),Js("click",(function(){return ei(t),Xs(3).toggleUserGroup()})),Ns(7,"a"),mo(8),Fs(),Fs(),Gs(9,jx,3,0,"td",0),Fs()}if(2&t){const t=e.$implicit,i=e.index,n=Xs(3);_n(2),fo(i+1),_n(3),fo(t.email),_n(3),fo(t.groupName),_n(1),js("ngIf",n.hasSystemPerm(n.permSystem.ManagePerm))}}function Nx(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div"),Ns(2,"div",38),Ns(3,"div",39),Ns(4,"h5",40),mo(5," Visbo System Users "),Fs(),Fs(),Gs(6,Lx,3,0,"div",41),Fs(),Ns(7,"div",42),Ns(8,"table",43),Ns(9,"thead",44),Ns(10,"tr"),Ns(11,"th"),mo(12,"Nr."),Fs(),Ns(13,"th",45),Js("click",(function(){return ei(t),Xs(2).sortUserTable(1)})),mo(14,"e-mail"),Fs(),Ns(15,"th",46),Js("click",(function(){return ei(t),Xs(2).sortUserTable(2)})),mo(16,"Group"),Fs(),Gs(17,Rx,2,0,"th",0),Fs(),Fs(),Ns(18,"tbody",47),Gs(19,$x,10,4,"tr",22),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(6),js("ngIf",t.hasSystemPerm(t.permSystem.ManagePerm)),_n(11),js("ngIf",t.hasSystemPerm(t.permSystem.ManagePerm)),_n(2),js("ngForOf",t.vgUsers)}}function Fx(t,e){if(1&t){const t=zs();Ns(0,"div",39),Ns(1,"button",55),Js("click",(function(){return ei(t),Xs(3).initGroup(null)})),mo(2,"Add Group"),Fs(),Fs()}}function Bx(t,e){1&t&&(Ns(0,"th"),mo(1,"Delete"),Fs())}function Hx(t,e){1&t&&(Ns(0,"td",60),mo(1,"Global"),Fs())}function Kx(t,e){1&t&&Bs(0,"td",60)}function qx(t,e){if(1&t){const t=zs();Ns(0,"td"),Ns(1,"button",61),Js("click",(function(){ei(t);const e=Xs().index;return Xs(3).helperRemoveGroup(e)})),mo(2,"\xd7"),Fs(),Fs()}}function zx(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td"),mo(2),Fs(),Ns(3,"td",56),Js("click",(function(){ei(t);const i=e.index,n=e.$implicit,r=Xs(3);return r.groupIndex=i,r.initGroup(n)})),Ns(4,"a"),mo(5),Fs(),Fs(),Ns(6,"td",57),Js("click",(function(){return ei(t),Xs(3).toggleUserGroup()})),Ns(7,"a"),mo(8),Fs(),Fs(),Gs(9,Hx,2,0,"td",58),Gs(10,Kx,1,0,"td",58),Gs(11,qx,3,0,"td",0),Ns(12,"td"),Ns(13,"button",59),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(3).initGroup(i)})),mo(14,"i"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit,i=e.index,n=Xs(3);_n(2),fo(i+1),_n(3),fo(t.name),_n(3),fo(t.users.length),_n(1),js("ngIf",t.global),_n(1),js("ngIf",!t.global),_n(1),js("ngIf",n.hasSystemPerm(n.permSystem.ManagePerm))}}function Qx(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div"),Ns(2,"div",38),Ns(3,"div",39),Ns(4,"h5",40),mo(5," Visbo System Groups "),Fs(),Fs(),Gs(6,Fx,3,0,"div",41),Fs(),Ns(7,"div",42),Ns(8,"table",43),Ns(9,"thead",52),Ns(10,"tr"),Ns(11,"th"),mo(12,"Nr."),Fs(),Ns(13,"th",53),Js("click",(function(){return ei(t),Xs(2).sortGroupTable(1)})),mo(14,"Group"),Fs(),Ns(15,"th",53),Js("click",(function(){return ei(t),Xs(2).sortGroupTable(2)})),mo(16,"Members"),Fs(),Ns(17,"th"),mo(18,"Flag"),Fs(),Gs(19,Bx,2,0,"th",0),Ns(20,"th"),mo(21,"Info"),Fs(),Fs(),Fs(),Ns(22,"tbody",54),Gs(23,zx,15,6,"tr",22),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(6),js("ngIf",t.hasSystemPerm(t.permSystem.ManagePerm)),_n(13),js("ngIf",t.hasSystemPerm(t.permSystem.ManagePerm)),_n(4),js("ngForOf",t.vgGroups)}}function Wx(t,e){1&t&&(Ns(0,"div",62),mo(1,"E-mail address is required"),Fs())}function Jx(t,e){if(1&t&&(Ns(0,"option"),mo(1),Fs()),2&t){const t=e.$implicit;_n(1),fo(t.name)}}function Yx(t,e){1&t&&(Ns(0,"div",62),mo(1,"Group must be defined"),Fs())}function Zx(t,e){1&t&&(Ns(0,"div",62),mo(1,"Error in Message"),Fs())}function Xx(t,e){1&t&&(Ns(0,"button",63),mo(1,"Invite"),Fs())}function tT(t,e){if(1&t){const t=zs();Ns(0,"button",64),Js("click",(function(){return ei(t),Xs(2).addNewVCUser()})),mo(1,"Invite"),Fs()}}function eT(t,e){if(1&t){const t=zs();Ns(0,"div",5),Ns(1,"div",6),Ns(2,"div",7),Ns(3,"h5",65),mo(4,"Remove User from Visbo System"),Fs(),Ns(5,"button",9),Ns(6,"span",10),mo(7,"\xd7"),Fs(),Fs(),Fs(),Ns(8,"div",11),Ns(9,"div"),Ns(10,"label",66),mo(11,"Do you really want to remove this User from Visbo System? "),Fs(),Fs(),Ns(12,"form"),Ns(13,"div",67),Ns(14,"label",68),mo(15,"Visbo Center:"),Fs(),Ns(16,"label",69),mo(17),Fs(),Fs(),Ns(18,"div",67),Ns(19,"label",70),mo(20,"User:"),Fs(),Ns(21,"label",69),mo(22),Fs(),Fs(),Ns(23,"div",67),Ns(24,"label",70),mo(25,"Group:"),Fs(),Ns(26,"label",69),mo(27),Fs(),Fs(),Fs(),Fs(),Ns(28,"div",26),Ns(29,"button",71),mo(30,"Close"),Fs(),Ns(31,"button",72),Js("click",(function(){ei(t);const e=Xs(2);return e.removeVCUser(e.vgUsers[e.userIndex],e.visbocenter._id)})),mo(32,"Remove"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(17),vo("",t.visbocenter.name," "),_n(5),fo(t.vgUsers[t.userIndex].email),_n(5),fo(t.vgUsers[t.userIndex].groupName)}}function iT(t,e){1&t&&(Ns(0,"h5",108),mo(1,"Modify a Group in the Visbo System"),Fs())}function nT(t,e){1&t&&(Ns(0,"h5",108),mo(1,"Add a new Group to the Visbo System"),Fs())}function rT(t,e){1&t&&(Ns(0,"div",62),mo(1,"Group Name is required (Minimum 3)"),Fs())}function sT(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div"),mo(2,"Define Visbo Center Permission"),Fs(),Ns(3,"div",79),Ns(4,"input",109,110),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedView=e})),Fs(),Ns(6,"label",111),mo(7,"View Visbo Center"),Fs(),Fs(),Ns(8,"div",79),Ns(9,"input",112,113),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedViewAudit=e})),Fs(),Ns(11,"label",114),mo(12,"View Audit"),Fs(),Fs(),Ns(13,"div",79),Ns(14,"input",115,116),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedModify=e})),Fs(),Ns(16,"label",117),mo(17,"Modify Visbo Center"),Fs(),Fs(),Ns(18,"div",79),Ns(19,"input",118,119),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedCreateVP=e})),Fs(),Ns(21,"label",120),mo(22,"Create Visbo Project"),Fs(),Fs(),Ns(23,"div",79),Ns(24,"input",121,122),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedManagePerm=e})),Fs(),Ns(26,"label",123),mo(27,"Manage Permissions, Users and Groups"),Fs(),Fs(),Ns(28,"div"),mo(29,"Define Visbo Project Permission"),Fs(),Ns(30,"div",79),Ns(31,"input",124,125),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedVPView=e})),Fs(),Ns(33,"label",126),mo(34,"View Visbo Project"),Fs(),Fs(),Ns(35,"div",79),Ns(36,"input",127,128),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedVPViewAudit=e})),Fs(),Ns(38,"label",129),mo(39,"View Project Audit"),Fs(),Fs(),Ns(40,"div",79),Ns(41,"input",130,131),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedVPModify=e})),Fs(),Ns(43,"label",132),mo(44,"Modify Visbo Project"),Fs(),Fs(),Ns(45,"div",79),Ns(46,"input",133,134),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedCreateVariant=e})),Fs(),Ns(48,"label",135),mo(49,"Create Visbo Project Variant"),Fs(),Fs(),Ns(50,"div",79),Ns(51,"input",136,137),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedVPManagePerm=e})),Fs(),Ns(53,"label",138),mo(54,"Manage Permissions, Users and Groups"),Fs(),Fs(),Ns(55,"div",79),Ns(56,"input",139,140),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedVPDelete=e})),Fs(),Ns(58,"label",141),mo(59,"Delete Visbo Project"),Fs(),Fs(),Fs()}if(2&t){const t=Xs(3);_n(4),js("ngModel",t.actGroup.checkedView),_n(5),js("ngModel",t.actGroup.checkedViewAudit),_n(5),js("ngModel",t.actGroup.checkedModify),_n(5),js("ngModel",t.actGroup.checkedCreateVP),_n(5),js("ngModel",t.actGroup.checkedManagePerm),_n(7),js("ngModel",t.actGroup.checkedVPView),_n(5),js("ngModel",t.actGroup.checkedVPViewAudit),_n(5),js("ngModel",t.actGroup.checkedVPModify),_n(5),js("ngModel",t.actGroup.checkedCreateVariant),_n(5),js("ngModel",t.actGroup.checkedVPManagePerm),_n(5),js("ngModel",t.actGroup.checkedVPDelete)}}function oT(t,e){if(1&t){const t=zs();Ns(0,"div",146),Ns(1,"a",147),Js("click",(function(){return ei(t),Xs(5).toggleUserGroup()})),mo(2),Fs(),Fs()}if(2&t){const t=Xs().$implicit;_n(2),fo(t.email)}}function aT(t,e){if(1&t&&(Hs(0,38),Gs(1,oT,3,1,"div",145),Ks()),2&t){const t=e.$implicit,i=Xs(4);_n(1),js("ngIf",t.groupName==i.actGroup.name)}}function lT(t,e){if(1&t&&(Ns(0,"div",142),Ns(1,"label",143),mo(2,"Group Members"),Fs(),Gs(3,aT,2,1,"ng-container",144),Fs()),2&t){const t=Xs(3);_n(3),js("ngForOf",t.vgUsers)}}function cT(t,e){1&t&&(Ns(0,"div",142),Ns(1,"label",143),mo(2,"No Group Members"),Fs(),Fs())}function dT(t,e){if(1&t&&(Ns(0,"button",148),mo(1),Fs()),2&t){const t=Xs(3);_n(1),fo(t.confirm)}}function uT(t,e){if(1&t){const t=zs();Ns(0,"button",149),Js("click",(function(){return ei(t),Xs(3).addModifyVCGroup()})),mo(1),Fs()}if(2&t){const t=Xs(3);_n(1),fo(t.confirm)}}const hT=function(t){return{"has-error":t}};function pT(t,e){if(1&t){const t=zs();Ns(0,"div",6),Ns(1,"div",7),Gs(2,iT,2,0,"h5",73),Gs(3,nT,2,0,"h5",73),Ns(4,"button",9),Ns(5,"span",10),mo(6,"\xd7"),Fs(),Fs(),Fs(),Ns(7,"div",11),Ns(8,"form",74,75),Ns(10,"div",14),Ns(11,"label",76),mo(12,"Name:"),Fs(),Ns(13,"input",77,78),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.name=e})),Fs(),Gs(15,rT,2,0,"div",18),Fs(),Ns(16,"div"),mo(17,"Define System Permission"),Fs(),Ns(18,"div",79),Ns(19,"input",80,81),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedSystemView=e})),Fs(),Ns(21,"label",82),mo(22,"View Visbo Center"),Fs(),Fs(),Ns(23,"div",79),Ns(24,"input",83,84),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedSystemViewAudit=e})),Fs(),Ns(26,"label",85),mo(27,"View Audit"),Fs(),Fs(),Ns(28,"div",79),Ns(29,"input",86,87),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedSystemViewLog=e})),Fs(),Ns(31,"label",88),mo(32,"View Log Files"),Fs(),Fs(),Ns(33,"div",79),Ns(34,"input",89,90),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedSystemModify=e})),Fs(),Ns(36,"label",91),mo(37,"Modify System"),Fs(),Fs(),Ns(38,"div",79),Ns(39,"input",92,93),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedSystemCreateVC=e})),Fs(),Ns(41,"label",94),mo(42,"Create Visbo Center"),Fs(),Fs(),Ns(43,"div",79),Ns(44,"input",95,96),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedSystemDeleteVC=e})),Fs(),Ns(46,"label",97),mo(47,"Delete Visbo Center"),Fs(),Fs(),Ns(48,"div",79),Ns(49,"input",98,99),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedSystemManagePerm=e})),Fs(),Ns(51,"label",100),mo(52,"Manage Permissions, Users and Groups"),Fs(),Fs(),Bs(53,"br"),Ns(54,"div",79),Ns(55,"input",101,102),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.global=e})),Fs(),Ns(57,"label",103),mo(58,"Group has Access to all Visbo Centers / Projects"),Fs(),Fs(),Gs(59,sT,60,11,"div",0),Gs(60,lT,4,1,"div",104),Gs(61,cT,3,0,"div",104),Ns(62,"div",105),Gs(63,dT,2,1,"button",106),Gs(64,uT,2,1,"button",107),Ns(65,"button",27),mo(66,"Cancel"),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Ls(9),e=Ls(14),i=Xs(2);_n(2),js("ngIf",i.actGroup._id),_n(1),js("ngIf",!i.actGroup._id),_n(7),js("ngClass",ka(18,hT,t.submitted)),_n(3),js("ngModel",i.actGroup.name),_n(2),js("ngIf",e.errors&&(e.dirty||e.touched)),_n(4),js("ngModel",i.actGroup.checkedSystemView),_n(5),js("ngModel",i.actGroup.checkedSystemViewAudit),_n(5),js("ngModel",i.actGroup.checkedSystemViewLog),_n(5),js("ngModel",i.actGroup.checkedSystemModify),_n(5),js("ngModel",i.actGroup.checkedSystemCreateVC),_n(5),js("ngModel",i.actGroup.checkedSystemDeleteVC),_n(5),js("ngModel",i.actGroup.checkedSystemManagePerm),_n(6),js("ngModel",i.actGroup.global),_n(4),js("ngIf",i.actGroup.global),_n(1),js("ngIf",i.helperUsersPerGroup(i.actGroup.name)),_n(1),js("ngIf",!i.helperUsersPerGroup(i.actGroup.name)),_n(2),js("ngIf",!(t.form.valid&&i.hasSystemPerm(i.permSystem.ManagePerm))),_n(1),js("ngIf",t.form.valid&&i.hasSystemPerm(i.permSystem.ManagePerm))}}function gT(t,e){if(1&t){const t=zs();Ns(0,"div",5),Ns(1,"div",6),Ns(2,"div",7),Ns(3,"h5",65),mo(4,"Remove Group from Visbo System"),Fs(),Ns(5,"button",9),Ns(6,"span",10),mo(7,"\xd7"),Fs(),Fs(),Fs(),Ns(8,"div",11),Ns(9,"div"),Ns(10,"label",66),mo(11,"Do you really want to remove this Group from Visbo System? "),Fs(),Fs(),Ns(12,"form"),Ns(13,"div",67),Ns(14,"label",68),mo(15,"Visbo Center:"),Fs(),Ns(16,"label",69),mo(17),Fs(),Fs(),Ns(18,"div",67),Ns(19,"label",70),mo(20,"Group:"),Fs(),Ns(21,"label",69),mo(22),Fs(),Fs(),Ns(23,"div",67),Ns(24,"label",70),mo(25,"Members:"),Fs(),Ns(26,"label",69),mo(27),Fs(),Fs(),Fs(),Fs(),Ns(28,"div",26),Ns(29,"button",27),mo(30,"Close"),Fs(),Ns(31,"button",150),Js("click",(function(){ei(t);const e=Xs(2);return e.removeVCGroup(e.vgGroups[e.groupIndex])})),mo(32,"Remove"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(17),vo("",t.visbocenter.name," "),_n(5),fo(t.vgGroups[t.groupIndex].name),_n(5),fo(t.vgGroups[t.groupIndex].users.length)}}function mT(t,e){1&t&&Bs(0,"input",182)}function fT(t,e){1&t&&Bs(0,"input",183)}function vT(t,e){1&t&&Bs(0,"input",182)}function bT(t,e){1&t&&Bs(0,"input",183)}function yT(t,e){1&t&&Bs(0,"input",182)}function CT(t,e){1&t&&Bs(0,"input",183)}function VT(t,e){1&t&&Bs(0,"input",182)}function wT(t,e){1&t&&Bs(0,"input",183)}function AT(t,e){1&t&&Bs(0,"input",182)}function PT(t,e){1&t&&Bs(0,"input",183)}function kT(t,e){1&t&&Bs(0,"input",182)}function DT(t,e){1&t&&Bs(0,"input",183)}function MT(t,e){1&t&&Bs(0,"input",182)}function ST(t,e){1&t&&Bs(0,"input",183)}function IT(t,e){1&t&&Bs(0,"input",184)}function xT(t,e){1&t&&Bs(0,"input",185)}function TT(t,e){1&t&&Bs(0,"input",186)}function _T(t,e){1&t&&Bs(0,"input",187)}function UT(t,e){1&t&&Bs(0,"input",188)}function ET(t,e){1&t&&Bs(0,"input",189)}function OT(t,e){1&t&&Bs(0,"input",190)}function GT(t,e){1&t&&Bs(0,"input",191)}function LT(t,e){1&t&&Bs(0,"input",192)}function RT(t,e){1&t&&Bs(0,"input",193)}function jT(t,e){1&t&&Bs(0,"input",194)}function $T(t,e){1&t&&Bs(0,"input",195)}function NT(t,e){1&t&&Bs(0,"input",196)}function FT(t,e){1&t&&Bs(0,"input",197)}function BT(t,e){1&t&&Bs(0,"input",198)}function HT(t,e){1&t&&Bs(0,"input",199)}function KT(t,e){1&t&&Bs(0,"input",200)}function qT(t,e){1&t&&Bs(0,"input",201)}function zT(t,e){1&t&&Bs(0,"input",202)}function QT(t,e){1&t&&Bs(0,"input",203)}function WT(t,e){1&t&&Bs(0,"input",204)}function JT(t,e){1&t&&Bs(0,"input",205)}function YT(t,e){if(1&t){const t=zs();Ns(0,"div",146),Ns(1,"a",147),Js("click",(function(){return ei(t),Xs(4).toggleUserGroup()})),mo(2),Fs(),Fs()}if(2&t){const t=Xs().$implicit;_n(2),fo(t.groupName)}}function ZT(t,e){if(1&t&&(Hs(0,38),Gs(1,YT,3,1,"div",145),Ks()),2&t){const t=e.$implicit,i=Xs(3);_n(1),js("ngIf",t.email==i.vgUsers[i.userIndex].email)}}function XT(t,e){if(1&t&&(Ns(0,"div",151),Ns(1,"div",152),Ns(2,"div",6),Ns(3,"div",7),Ns(4,"h5",153),mo(5),Fs(),Ns(6,"button",9),Ns(7,"span",10),mo(8,"\xd7"),Fs(),Fs(),Fs(),Ns(9,"div",11),Ns(10,"div"),mo(11,"Define System Permission"),Fs(),Ns(12,"div",79),Gs(13,mT,1,0,"input",154),Gs(14,fT,1,0,"input",155),Ns(15,"label",156),mo(16,"View Visbo Center"),Fs(),Fs(),Ns(17,"div",79),Gs(18,vT,1,0,"input",154),Gs(19,bT,1,0,"input",155),Ns(20,"label",156),mo(21,"View Audit"),Fs(),Fs(),Ns(22,"div",79),Gs(23,yT,1,0,"input",154),Gs(24,CT,1,0,"input",155),Ns(25,"label",156),mo(26,"View Log Files"),Fs(),Fs(),Ns(27,"div",79),Gs(28,VT,1,0,"input",154),Gs(29,wT,1,0,"input",155),Ns(30,"label",156),mo(31,"Modify System"),Fs(),Fs(),Ns(32,"div",79),Gs(33,AT,1,0,"input",154),Gs(34,PT,1,0,"input",155),Ns(35,"label",156),mo(36,"Create Visbo Center"),Fs(),Fs(),Ns(37,"div",79),Gs(38,kT,1,0,"input",154),Gs(39,DT,1,0,"input",155),Ns(40,"label",156),mo(41,"Delete Visbo Center"),Fs(),Fs(),Ns(42,"div",79),Gs(43,MT,1,0,"input",154),Gs(44,ST,1,0,"input",155),Ns(45,"label",156),mo(46,"Manage Permissions, Users and Groups"),Fs(),Fs(),Bs(47,"br"),Ns(48,"div",142),mo(49,"Visbo Center Permission for User"),Fs(),Ns(50,"div",79),Gs(51,IT,1,0,"input",157),Gs(52,xT,1,0,"input",158),Ns(53,"label",111),mo(54,"View Visbo Center"),Fs(),Fs(),Ns(55,"div",79),Gs(56,TT,1,0,"input",159),Gs(57,_T,1,0,"input",160),Ns(58,"label",114),mo(59,"View Audit"),Fs(),Fs(),Ns(60,"div",79),Gs(61,UT,1,0,"input",161),Gs(62,ET,1,0,"input",162),Ns(63,"label",117),mo(64,"Modify Visbo Center"),Fs(),Fs(),Ns(65,"div",79),Gs(66,OT,1,0,"input",163),Gs(67,GT,1,0,"input",164),Ns(68,"label",120),mo(69,"Create Visbo Project"),Fs(),Fs(),Ns(70,"div",79),Gs(71,LT,1,0,"input",165),Gs(72,RT,1,0,"input",166),Ns(73,"label",123),mo(74,"Manage Permissions, Users and Groups"),Fs(),Fs(),Bs(75,"br"),Ns(76,"div"),mo(77,"Visbo Project Permission for User"),Fs(),Ns(78,"div",79),Gs(79,jT,1,0,"input",167),Gs(80,$T,1,0,"input",168),Ns(81,"label",126),mo(82,"View Visbo Project"),Fs(),Fs(),Ns(83,"div",79),Gs(84,NT,1,0,"input",169),Gs(85,FT,1,0,"input",170),Ns(86,"label",129),mo(87,"View Project Audit"),Fs(),Fs(),Ns(88,"div",79),Gs(89,BT,1,0,"input",171),Gs(90,HT,1,0,"input",172),Ns(91,"label",132),mo(92,"Modify Visbo Project"),Fs(),Fs(),Ns(93,"div",79),Gs(94,KT,1,0,"input",173),Gs(95,qT,1,0,"input",174),Ns(96,"label",135),mo(97,"Create Visbo Project Variant"),Fs(),Fs(),Ns(98,"div",79),Gs(99,zT,1,0,"input",175),Gs(100,QT,1,0,"input",176),Ns(101,"label",138),mo(102,"Manage Permissions, Users and Groups"),Fs(),Fs(),Ns(103,"div",79),Gs(104,WT,1,0,"input",177),Gs(105,JT,1,0,"input",178),Ns(106,"label",141),mo(107,"Delete Visbo Project"),Fs(),Fs(),Ns(108,"label",179),mo(109,"Group Member Ship"),Fs(),Gs(110,ZT,2,1,"ng-container",144),Ns(111,"div",180),Ns(112,"button",181),mo(113,"Close"),Fs(),Fs(),Fs(),Fs(),Fs(),Fs()),2&t){const t=Xs(2);_n(5),vo("Permission for ",t.vgUsers[t.userIndex].email,""),_n(8),js("ngIf",t.hasUserSystemPerm(t.permSystem.View)),_n(1),js("ngIf",!t.hasUserSystemPerm(t.permSystem.View)),_n(4),js("ngIf",t.hasUserSystemPerm(t.permSystem.ViewAudit)),_n(1),js("ngIf",!t.hasUserSystemPerm(t.permSystem.ViewAudit)),_n(4),js("ngIf",t.hasUserSystemPerm(t.permSystem.ViewLog)),_n(1),js("ngIf",!t.hasUserSystemPerm(t.permSystem.ViewLog)),_n(4),js("ngIf",t.hasUserSystemPerm(t.permSystem.Modify)),_n(1),js("ngIf",!t.hasUserSystemPerm(t.permSystem.Modify)),_n(4),js("ngIf",t.hasUserSystemPerm(t.permSystem.CreateVC)),_n(1),js("ngIf",!t.hasUserSystemPerm(t.permSystem.CreateVC)),_n(4),js("ngIf",t.hasUserSystemPerm(t.permSystem.DeleteVC)),_n(1),js("ngIf",!t.hasUserSystemPerm(t.permSystem.DeleteVC)),_n(4),js("ngIf",t.hasUserSystemPerm(t.permSystem.ManagePerm)),_n(1),js("ngIf",!t.hasUserSystemPerm(t.permSystem.ManagePerm)),_n(7),js("ngIf",t.hasUserVCPerm(t.permVC.View)),_n(1),js("ngIf",!t.hasUserVCPerm(t.permVC.View)),_n(4),js("ngIf",t.hasUserVCPerm(t.permVC.ViewAudit)),_n(1),js("ngIf",!t.hasUserVCPerm(t.permVC.ViewAudit)),_n(4),js("ngIf",t.hasUserVCPerm(t.permVC.Modify)),_n(1),js("ngIf",!t.hasUserVCPerm(t.permVC.Modify)),_n(4),js("ngIf",t.hasUserVCPerm(t.permVC.CreateVP)),_n(1),js("ngIf",!t.hasUserVCPerm(t.permVC.CreateVP)),_n(4),js("ngIf",t.hasUserVCPerm(t.permVC.ManagePerm)),_n(1),js("ngIf",!t.hasUserVCPerm(t.permVC.ManagePerm)),_n(7),js("ngIf",t.hasUserVPPerm(t.permVP.View)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.View)),_n(4),js("ngIf",t.hasUserVPPerm(t.permVP.ViewAudit)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.ViewAudit)),_n(4),js("ngIf",t.hasUserVPPerm(t.permVP.Modify)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.Modify)),_n(4),js("ngIf",t.hasUserVPPerm(t.permVP.CreateVariant)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.CreateVariant)),_n(4),js("ngIf",t.hasUserVPPerm(t.permVP.ManagePerm)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.ManagePerm)),_n(4),js("ngIf",t.hasUserVPPerm(t.permVP.DeleteVP)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.DeleteVP)),_n(5),js("ngForOf",t.vgUsers)}}function t_(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"h3"),mo(2),Ua(3,"uppercase"),Fs(),Ns(4,"div",1),Gs(5,Ox,2,0,"button",2),Gs(6,Gx,2,0,"button",3),Fs(),Gs(7,Nx,20,3,"div",0),Gs(8,Qx,24,3,"div",0),Ns(9,"div",4),Ns(10,"div",5),Ns(11,"div",6),Ns(12,"div",7),Ns(13,"h5",8),mo(14,"Add a new User to the Visbo System"),Fs(),Ns(15,"button",9),Ns(16,"span",10),mo(17,"\xd7"),Fs(),Fs(),Fs(),Ns(18,"div",11),Ns(19,"form",12,13),Ns(21,"div",14),Ns(22,"label",15),mo(23,"Name:"),Fs(),Ns(24,"input",16,17),Js("ngModelChange",(function(e){return ei(t),Xs().newUserInvite.email=e})),Fs(),Gs(26,Wx,2,0,"div",18),Fs(),Ns(27,"div",14),Ns(28,"label",19),mo(29,"Group:"),Fs(),Ns(30,"select",20,21),Js("ngModelChange",(function(e){return ei(t),Xs().newUserInvite.groupName=e})),Bs(32,"option"),Gs(33,Jx,2,1,"option",22),Fs(),Gs(34,Yx,2,0,"div",18),Fs(),Ns(35,"div",14),Ns(36,"label",23),mo(37,"Message:"),Fs(),Ns(38,"textarea",24,25),Js("ngModelChange",(function(e){return ei(t),Xs().newUserInvite.inviteMessage=e})),mo(40," "),Fs(),Fs(),Gs(41,Zx,2,0,"div",18),Ns(42,"div",26),Ns(43,"button",27),mo(44,"Cancel"),Fs(),Gs(45,Xx,2,0,"button",28),Gs(46,tT,2,0,"button",29),Fs(),Fs(),Fs(),Fs(),Fs(),Fs(),Ns(47,"div",30),Gs(48,eT,33,3,"div",31),Fs(),Ns(49,"div",32),Ns(50,"div",5),Gs(51,pT,67,20,"div",33),Fs(),Fs(),Ns(52,"div",34),Gs(53,gT,33,3,"div",31),Fs(),Gs(54,XT,114,38,"div",35),Fs()}if(2&t){const t=Ls(20),e=Ls(25),i=Ls(31),n=Ls(39),r=Xs();_n(2),vo("System: ",Ea(3,21,r.visbocenter.name),""),_n(3),js("ngIf",!r.showGroups),_n(1),js("ngIf",r.showGroups),_n(1),js("ngIf",!r.showGroups),_n(1),js("ngIf",r.showGroups),_n(13),js("ngClass",ka(23,hT,t.submitted&&!e.valid)),_n(3),js("ngModel",r.newUserInvite.email),_n(2),js("ngIf",t.submitted&&!e.valid),_n(1),js("ngClass",ka(25,hT,t.submitted&&!i.valid)),_n(3),js("ngModel",r.newUserInvite.groupName),_n(3),js("ngForOf",r.vgGroups),_n(1),js("ngIf",t.submitted&&!i.valid),_n(1),js("ngClass",ka(27,hT,t.submitted&&!n.valid)),_n(3),js("ngModel",r.newUserInvite.inviteMessage),_n(3),js("ngIf",t.submitted&&!n.valid),_n(4),js("ngIf",!(e.valid&&i.valid)),_n(1),js("ngIf",e.valid&&i.valid),_n(2),js("ngIf",r.userIndex>=0&&r.userIndex<r.vgUsers.length),_n(3),js("ngIf",r.actGroup),_n(2),js("ngIf",r.groupIndex>=0&&r.groupIndex<r.vgGroups.length),_n(1),js("ngIf",r.vgUsers&&r.userIndex>=0)}}let e_=(()=>{class t{constructor(t,e,i,n,r,s){this.messageService=t,this.visbocenterService=e,this.route=i,this.location=n,this.router=r,this.alertService=s,this.newUserInvite=new Yh,this.permSystem=wv,this.permVC=Av,this.permVP=Pv,this.sortUserColumn=1,this.sortUserAscending=!0,this.sortGroupColumn=1,this.sortGroupAscending=!0}ngOnInit(){this.getSysVisboCenter(),this.combinedPerm=this.visbocenterService.getSysAdminRole()}getSysVisboCenter(){this.visbocenterService.getSysVisboCenter().subscribe(t=>{this.visbocenter=t[0],this.getVisboCenterUsers(),this.log(`System VisboCenter initialised ${this.visbocenter._id} Perm Sys ${JSON.stringify(this.combinedPerm)} `)},t=>{this.log(`get VC failed: error: ${t.status} message: ${t.error.message} `),this.alertService.error(403===t.status?"Permission Denied: Visbo Center "+this.visbocenter.name:Lh(t))})}hasSystemPerm(t){return(this.combinedPerm.system&t)>0}hasVCPerm(t){return(this.combinedPerm.vc&t)>0}hasVPPerm(t){return(this.combinedPerm.vp&t)>0}hasUserSystemPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.system&t)>0}hasUserVCPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vc&t)>0}hasUserVPPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vp&t)>0}getVisboCenterUsers(){const t=this.visbocenter._id;this.log("VisboCenter UserList of: "+t),this.visbocenterService.getVCUsers(t,!0).subscribe(t=>{this.vgUsers=t.users,this.vgGroups=t.groups,this.log(`fetched Users ${this.vgUsers.length}, Groups ${this.vgGroups.length}`),this.sortUserTable(),this.sortGroupTable()},t=>{this.log(`Get VC Users failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(403===t.status?"Permission Denied":Lh(t))})}gotoVPList(t){this.router.navigate(["sysvp/".concat(t._id)])}goBack(){this.location.back()}save(){this.visbocenterService.updateVisboCenter(this.visbocenter).subscribe(t=>{this.alertService.success(`Visbo Center ${t.name} updated successfully`,!0)},t=>{this.log(`save VC failed: error: ${t.status} message: ${t.error.message} `),this.alertService.error(403===t.status?"Permission Denied: Visbo Center "+this.visbocenter.name:409===t.status?`Visbo Center ${this.visbocenter.name} exists already`:Lh(t))})}toggleUserGroup(){this.showGroups=!this.showGroups}addNewVCUser(){const t=this.newUserInvite.email.trim(),e=this.newUserInvite.groupName.trim(),i=this.vgGroups.filter(t=>t.name===e)[0]._id,n=this.visbocenter._id;let r="";this.newUserInvite.inviteMessage&&(r=this.newUserInvite.inviteMessage.trim()),this.log(`Add VisboCenter User: ${t} Group: ${e}/${i} VC: ${n}`),t&&i&&this.visbocenterService.addVCUser(t,i,r,n,!0).subscribe(e=>{const i=new Mv;i.userId=e.users.filter(e=>e.email===t)[0].userId,i.email=t,i.groupId=e._id,i.groupName=e.name,this.log("Add VisboCenter User Push: "+JSON.stringify(i)),this.vgUsers.push(i),this.sortUserTable();for(let t=0;t<this.vgGroups.length;t++)if(this.vgGroups[t]._id===e._id){this.vgGroups[t]=e;break}this.alertService.success(`User ${t} added successfully`)},t=>{this.log("Add VisboCenter User error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Add User to Visbo Center"):(this.log("Error during add VC user "+t.error.message),this.alertService.error(Lh(t)))})}helperUserIndex(t){this.userIndex=t}calcCombinedPerm(t){this.userIndex=t,this.combinedUserPerm={system:0,vc:0,vp:0},this.vgUsers.forEach(this.addUserPerm,this),this.log(`Combined Permission for ${this.vgUsers[t].email}  ${JSON.stringify(this.combinedUserPerm)}`)}addUserPerm(t){if(t.email!==this.vgUsers[this.userIndex].email)return;this.log("Add User Permission for "+t.groupName);const e=this.vgGroups.findIndex(e=>e.name===t.groupName);e>=0?this.vgGroups[e].permission?(this.combinedUserPerm.system=this.combinedUserPerm.system|(this.vgGroups[e].permission.system||0),this.combinedUserPerm.vc=this.combinedUserPerm.vc|(this.vgGroups[e].permission.vc||0),this.combinedUserPerm.vp=this.combinedUserPerm.vp|(this.vgGroups[e].permission.vp||0)):this.log("Permission for Group not set "+t.groupName):this.log("Group not found "+t.groupName)}helperRemoveGroup(t){this.groupIndex=t}helperUsersPerGroup(t){const e=this.vgGroups&&this.vgGroups.find(e=>e.name===t);return e?e.users.length:0}removeVCUser(t,e){this.log(`Remove VisboCenter User: ${t.email}/${t.userId} Group: ${t.groupName} VC: ${e}`),this.visbocenterService.deleteVCUser(t,e,!0).subscribe(()=>{this.vgUsers=this.vgUsers.filter(e=>e!==t);for(let e=0;e<this.vgGroups.length;e++)if(this.vgGroups[e]._id===t.groupId){for(let i=0;i<this.vgGroups[e].users.length;i++)if(this.vgGroups[e].users[i].userId===t.userId){this.vgGroups[e].users.splice(i,1);break}break}this.alertService.success(`User ${t.email} removed successfully`)},t=>{this.log("Remove VisboCenter User error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Remove User from Visbo Center"):(this.log("Error during remove VC user "+t.error.message),this.alertService.error(Lh(t)))})}helperSystemPerm(t){let e=0;return t.checkedSystemView&&(e+=this.permSystem.View),t.checkedSystemViewAudit&&(e+=this.permSystem.ViewAudit),t.checkedSystemViewLog&&(e+=this.permSystem.ViewLog),t.checkedSystemModify&&(e+=this.permSystem.Modify),t.checkedSystemCreateVC&&(e+=this.permSystem.CreateVC),t.checkedSystemDeleteVC&&(e+=this.permSystem.DeleteVC),t.checkedSystemManagePerm&&(e+=this.permSystem.ManagePerm),e}helperVCPerm(t){let e=0;return t.checkedView&&(e+=this.permVC.View),t.checkedViewAudit&&(e+=this.permVC.ViewAudit),t.checkedModify&&(e+=this.permVC.Modify),t.checkedCreateVP&&(e+=this.permVC.CreateVP),t.checkedManagePerm&&(e+=this.permVC.ManagePerm),e}helperVPPerm(t){let e=0;return t.checkedVPView&&(e+=this.permVP.View),t.checkedVPViewAudit&&(e+=this.permVP.ViewAudit),t.checkedVPModify&&(e+=this.permVP.Modify),t.checkedCreateVariant&&(e+=this.permVP.CreateVariant),t.checkedVPManagePerm&&(e+=this.permVP.ManagePerm),t.checkedVPDelete&&(e+=this.permVP.DeleteVP),e}initGroup(t){this.actGroup=new Dv,t?(this.confirm="Modify",this.actGroup._id=t._id,this.log(`Init Group Set GroupID : ${this.actGroup._id} ID ${t._id}`),this.actGroup.name=t.name,this.actGroup.checkedSystemView=(t.permission.system&this.permSystem.View)>0,this.actGroup.checkedSystemViewAudit=(t.permission.system&this.permSystem.ViewAudit)>0,this.actGroup.checkedSystemViewLog=(t.permission.system&this.permSystem.ViewLog)>0,this.actGroup.checkedSystemModify=(t.permission.system&this.permSystem.Modify)>0,this.actGroup.checkedSystemCreateVC=(t.permission.system&this.permSystem.CreateVC)>0,this.actGroup.checkedSystemDeleteVC=(t.permission.system&this.permSystem.DeleteVC)>0,this.actGroup.checkedSystemManagePerm=(t.permission.system&this.permSystem.ManagePerm)>0,this.actGroup.global=t.global,this.actGroup.checkedView=(t.permission.vc&this.permVC.View)>0,this.actGroup.checkedViewAudit=(t.permission.vc&this.permVC.ViewAudit)>0,this.actGroup.checkedModify=(t.permission.vc&this.permVC.Modify)>0,this.actGroup.checkedCreateVP=(t.permission.vc&this.permVC.CreateVP)>0,this.actGroup.checkedManagePerm=(t.permission.vc&this.permVC.ManagePerm)>0,this.actGroup.checkedVPView=(t.permission.vp&this.permVP.View)>0,this.actGroup.checkedVPViewAudit=(t.permission.vp&this.permVP.ViewAudit)>0,this.actGroup.checkedVPModify=(t.permission.vp&this.permVP.Modify)>0,this.actGroup.checkedCreateVariant=(t.permission.vp&this.permVP.CreateVariant)>0,this.actGroup.checkedVPManagePerm=(t.permission.vp&this.permVP.ManagePerm)>0,this.actGroup.checkedVPDelete=(t.permission.vp&this.permVP.DeleteVP)>0):(this.actGroup._id=void 0,this.confirm="Create",this.actGroup.name="",this.actGroup.global=!1,this.actGroup.checkedView=!0),this.log(`Init Group for Creation / Modification: ${this.actGroup.name} ID ${this.actGroup._id}`)}addModifyVCGroup(){const t=new kv;t.name=this.actGroup.name.trim(),t.global=this.actGroup.global,t.vcid=this.visbocenter._id,t.permission=new Vv,t.permission.system=this.helperSystemPerm(this.actGroup),t.global&&(t.permission.vc=this.helperVCPerm(this.actGroup),t.permission.vp=this.helperVPPerm(this.actGroup)),this.log(`Add/Modify VisboCenter Group: Group: ${t.name} New/Modify ${this.actGroup._id} Perm: ${JSON.stringify(t.permission)}`),this.actGroup._id?(this.log(`Modify VisboCenter Group: Group: ${t.name} VC: ${t.vcid} Perm: ${JSON.stringify(t.permission)}`),t._id=this.actGroup._id,this.visbocenterService.modifyVCGroup(t,!0).subscribe(e=>{this.vgGroups=this.vgGroups.filter(e=>e._id!==t._id),this.vgGroups.push(e);for(let i=0;i<this.vgUsers.length;i++)this.vgUsers[i].groupId===t._id&&(this.vgUsers[i].groupName=e.name);this.sortUserTable(),this.sortGroupTable(),this.alertService.success(`Group ${e.name} changed successfully`)},t=>{this.log("Modify VisboCenter Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Modify Group to Visbo Center"):(this.log("Error during add VC Group "+t.error.message),this.alertService.error(Lh(t)))})):(this.log(`Add VisboCenter Group: Group: ${t.name} VC: ${t.vcid} Perm: vc ${JSON.stringify(t.permission)}`),this.visbocenterService.addVCGroup(t,!0).subscribe(t=>{this.vgGroups.push(t),this.alertService.success(`Group ${t.name} added successfully`)},t=>{this.log("Add VisboCenter Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Add Group to Visbo Center"):(this.log("Error during add VC Group "+t.error.message),this.alertService.error(Lh(t)))}))}removeVCGroup(t){this.log(`Remove VisboCenter Group: ${t.name}/${t._id} VC: ${t.vcid}`),this.visbocenterService.deleteVCGroup(t,!0).subscribe(e=>{this.log("Remove VisboCenter Group result: "+JSON.stringify(e)),this.vgGroups=this.vgGroups.filter(e=>e!==t),this.vgUsers=this.vgUsers.filter(e=>e.groupId!==t._id),this.alertService.success(`Group ${t.name} removed successfully`)},t=>{this.log("Remove VisboCenter Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Remove Group from Visbo Center"):(this.log("Error during remove VC user "+t.error.message),this.alertService.error(Lh(t)))})}sortUserTable(t){this.vgUsers&&(void 0===t&&void 0!==this.sortUserColumn||(t!==this.sortUserColumn&&(this.sortUserColumn=t,this.sortUserAscending=void 0),this.sortUserAscending=void 0===this.sortUserAscending?1===t||2===t:!this.sortUserAscending),1===this.sortUserColumn?this.vgUsers.sort((function(t,e){return xh(t.email,e.email)})):2===this.sortUserColumn&&this.vgUsers.sort((function(t,e){return xh(t.groupName.toLowerCase(),e.groupName.toLowerCase())})),this.sortUserAscending||this.vgUsers.reverse())}sortGroupTable(t){this.vgGroups&&(void 0===t&&void 0!==this.sortGroupColumn||(t!==this.sortGroupColumn&&(this.sortGroupColumn=t,this.sortGroupAscending=void 0),this.sortGroupAscending=void 0===this.sortGroupAscending?1===t:!this.sortGroupAscending),1===this.sortGroupColumn?this.vgGroups.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortGroupColumn&&this.vgGroups.sort((function(t,e){return e.users.length-t.users.length})),this.sortGroupAscending||this.vgGroups.reverse())}log(t){this.messageService.add("Sys VisboCenter: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(xv),Rs(Fg),Rs(Xl),Rs(rf),Rs(Df))},t.\u0275cmp=le({type:t,selectors:[["app-sysvisbosystem"]],decls:2,vars:1,consts:[[4,"ngIf"],[1,"btn-toolbar"],["id","ViewGroup","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewUser","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","VcUserModalCreate","tabindex","-1","role","dialog","aria-labelledby","VcUserModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VcUserModalCenterTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["name","newUserInvite","novalidate",""],["f1","ngForm"],[1,"form-group",3,"ngClass"],["for","email",1,"col-form-label"],["id","AddUserName","type","email","name","email","required","","pattern","[^@\\s]+@[^@\\s]+\\.[^@\\s]+","autocomplete","email",1,"form-control",3,"ngModel","ngModelChange"],["email","ngModel"],["class","help-block",4,"ngIf"],["for","group",1,"col-form-label"],["id","AddUserGroupName","name","group","required","",1,"form-control",3,"ngModel","ngModelChange"],["group","ngModel"],[4,"ngFor","ngForOf"],["for","inviteMessage",1,"col-form-label"],["id","AddUserMessage","name","inviteMessage",1,"form-control",3,"ngModel","ngModelChange"],["inviteMessage","ngModel"],[1,"modal-footer","align-items-end"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-secondary"],["id","AddUserConfirm","type","button","class","btn btn-primary",4,"ngIf"],["id","AddUserConfirm","type","button","class","btn btn-primary","data-dismiss","modal",3,"click",4,"ngIf"],["id","VcUserRemove","tabindex","-1","role","dialog","aria-labelledby","VcUserModalRemoveTitle","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-dialog-centered","role","document",4,"ngIf"],["id","SystemGroupModalCreate","tabindex","-1","role","dialog","aria-labelledby","VcGroupModalCreateTitle","aria-hidden","true",1,"modal","fade"],["class","modal-content",4,"ngIf"],["id","VcGroupRemove","tabindex","-1","role","dialog","aria-labelledby","VcGroupModalRemoveTitle","aria-hidden","true",1,"modal","fade"],["class","modal fade","id","SystemUserDetail","tabindex","-1","role","dialog","aria-labelledby","SystemUserDetailTitle","aria-hidden","true",4,"ngIf"],["id","ViewGroup","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],["id","ViewUser","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],[1,"row"],[1,"col"],[1,"panel-heading"],["class","col",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover"],["id","UserHead"],["id","SortUser",3,"click"],["id","SortGroup",3,"click"],["id","UserList"],["id","AddUser","type","button","data-toggle","modal","data-target","#VcUserModalCreate",1,"btn","btn-primary","float-right","my-1"],["id","ColUser","data-toggle","modal","data-target","#SystemUserDetail",3,"click"],["id","ColGroup",3,"click"],["id","ColDeleteUser","title","Remove User","data-toggle","modal","data-target","#VcUserRemove",1,"Detail",3,"click"],["id","GroupHead"],[3,"click"],["id","GroupList"],["id","AddGroup","type","button","data-toggle","modal","data-target","#SystemGroupModalCreate",1,"btn","btn-primary","float-right","my-1",3,"click"],["id","ColGroup","data-toggle","modal","data-target","#SystemGroupModalCreate",3,"click"],["id","ColMembers",3,"click"],["id","ColGlobal",4,"ngIf"],["id","ColDetail","title","Detail of Group","data-toggle","modal","data-target","#SystemGroupModalCreate",1,"Detail",3,"click"],["id","ColGlobal"],["id","ColDeleteGroup","title","Remove Group","data-toggle","modal","data-target","#VcGroupRemove",1,"Detail",3,"click"],[1,"help-block"],["id","AddUserConfirm","type","button",1,"btn","btn-primary"],["id","AddUserConfirm","type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"],["id","VcUserRemoveTitle",1,"modal-title"],[1,"bg-warning"],[1,"form-group"],["for","VcName",1,"col-form-label"],[1,"col-8","form-control-static"],[1,"col-form-label"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["id","DeleteUserConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning",3,"click"],["class","modal-title","id","VcGroupModalCenterTitle",4,"ngIf"],["name","actGroup","novalidate",""],["f2","ngForm"],["for","groupName",1,"col-form-label"],["id","AddGroupName","type","text","name","groupName","required","","minlength","3",1,"form-control",3,"ngModel","ngModelChange"],["groupName","ngModel"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","sysperm1","name","checkedSystemView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedSystemView","ngModel"],["for","sysperm1",1,"custom-control-label"],["type","checkbox","id","sysperm2","name","checkedSystemViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedSystemViewAudit","ngModel"],["for","sysperm2",1,"custom-control-label"],["type","checkbox","id","sysperm3","name","checkedSystemViewLog",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedSystemViewLog","ngModel"],["for","sysperm3",1,"custom-control-label"],["type","checkbox","id","sysperm3a","name","checkedSystemModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedSystemModify","ngModel"],["for","sysperm3a",1,"custom-control-label"],["type","checkbox","id","sysperm4","name","checkedSystemCreateVC",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedSystemCreateVC","ngModel"],["for","sysperm4",1,"custom-control-label"],["type","checkbox","id","sysperm5","name","checkedSystemDeleteVC",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedSystemDeleteVC","ngModel"],["for","sysperm5",1,"custom-control-label"],["type","checkbox","id","sysperm6","name","checkedSystemManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedSystemManagePerm","ngModel"],["for","sysperm6",1,"custom-control-label"],["type","checkbox","id","global","name","global",1,"custom-control-input",3,"ngModel","ngModelChange"],["global","ngModel"],["for","global",1,"custom-control-label"],["class","mt-2",4,"ngIf"],[1,"modal-footer","align-items-end","mt-3"],["id","AddGroupConfirm","type","button","class","btn btn-primary disabled",4,"ngIf"],["id","AddGroupConfirm","type","button","class","btn btn-primary","data-dismiss","modal",3,"click",4,"ngIf"],["id","VcGroupModalCenterTitle",1,"modal-title"],["type","checkbox","id","perm1","name","checkedView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedView","ngModel"],["for","perm1",1,"custom-control-label"],["type","checkbox","id","perm2","name","checkedViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedViewAudit","ngModel"],["for","perm2",1,"custom-control-label"],["type","checkbox","id","perm3","name","checkedModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedModify","ngModel"],["for","perm3",1,"custom-control-label"],["type","checkbox","id","perm4","name","checkedCreateVP",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVP","ngModel"],["for","perm4",1,"custom-control-label"],["type","checkbox","id","perm5","name","checkedManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedManagePerm","ngModel"],["for","perm5",1,"custom-control-label"],["type","checkbox","id","permVP1","name","checkedVPView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPView","ngModel"],["for","permVP1",1,"custom-control-label"],["type","checkbox","id","permVP2","name","checkedVPViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPViewAudit","ngModel"],["for","permVP2",1,"custom-control-label"],["type","checkbox","id","permVP3","name","checkedVPModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPModify","ngModel"],["for","permVP3",1,"custom-control-label"],["type","checkbox","id","permVP4","name","checkedCreateVariant",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVariant","ngModel"],["for","permVP4",1,"custom-control-label"],["type","checkbox","id","permVP5","name","checkedVPManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPManagePerm","ngModel"],["for","permVP5",1,"custom-control-label"],["type","checkbox","id","permVP6","name","checkedVPDelete",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPDelete","ngModel"],["for","permVP6",1,"custom-control-label"],[1,"mt-2"],[1,"form-control-static"],["class","row",4,"ngFor","ngForOf"],["class","col-8 ml-3",4,"ngIf"],[1,"col-8","ml-3"],["data-dismiss","modal",3,"click"],["id","AddGroupConfirm","type","button",1,"btn","btn-primary","disabled"],["id","AddGroupConfirm","type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"],["id","DeleteGroupConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning",3,"click"],["id","SystemUserDetail","tabindex","-1","role","dialog","aria-labelledby","SystemUserDetailTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],["id","SystemUserDetailTitle",1,"modal-title"],["type","checkbox","checked","","disabled","","class","custom-control-input",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input",4,"ngIf"],[1,"custom-control-label"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],[1,"form-control-static","mt-2"],[1,"form-group","mt-2"],["id","ButtonBack","data-dismiss","modal",1,"btn","btn-primary"],["type","checkbox","checked","","disabled","",1,"custom-control-input"],["type","checkbox","disabled","",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"]],template:function(t,e){1&t&&(Bs(0,"app-sysnavbar"),Gs(1,t_,55,29,"div",0)),2&t&&(_n(1),js("ngIf",e.visbocenter))},directives:[gC,jc,Ou,Fd,Tu,Oc,Od,Ru,Hu,Nd,Eu,cu,du,gu,Lc,Fu,_d],pipes:[Kc],styles:[""]}),t})();function i_(t,e){if(1&t){const t=zs();Ns(0,"button",36),Js("click",(function(){return ei(t),Xs(2).toggleVisboCenters()})),mo(1,"Show Deleted"),Fs()}}function n_(t,e){if(1&t){const t=zs();Ns(0,"button",37),Js("click",(function(){return ei(t),Xs(2).toggleVisboCenters()})),mo(1,"Show Existing"),Fs()}}function r_(t,e){1&t&&(Ns(0,"button",38),mo(1,"Create New"),Fs())}function s_(t,e){if(1&t&&(Ns(0,"div",32),Gs(1,i_,2,0,"button",33),Gs(2,n_,2,0,"button",34),Gs(3,r_,2,0,"button",35),Fs()),2&t){const t=Xs();_n(1),js("ngIf",!t.deleted),_n(1),js("ngIf",t.deleted),_n(1),js("ngIf",t.hasSystemPerm(t.permSystem.CreateVC))}}function o_(t,e){if(1&t){const t=zs();Ns(0,"tr",39),Js("click",(function(){ei(t);const i=e.$implicit;return Xs().gotoClickedRow(i)})),Ns(1,"td",8),mo(2),Fs(),Ns(3,"td",40),Ns(4,"a"),mo(5),Fs(),Fs(),Ns(6,"td",41),mo(7),Ua(8,"date"),Fs(),Ns(9,"td",42),mo(10),Ua(11,"date"),Fs(),Ns(12,"td",43),mo(13),Fs(),Ns(14,"td",44),Ns(15,"button",45),Js("click",(function(){ei(t);const i=e.$implicit;return Xs().gotoDetail(i)})),mo(16,"i"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit,i=e.index;_n(2),fo(i+1),_n(3),fo(t.name),_n(2),fo(Oa(8,5,t.updatedAt,"dd.MM.yyyy HH:mm")),_n(3),fo(Oa(11,8,t.updatedAt,"dd.MM.yy")),_n(3),fo(t.vpCount)}}let a_=(()=>{class t{constructor(t,e,i,n,r){this.visbocenterService=t,this.messageService=e,this.alertService=i,this.route=n,this.router=r,this.combinedPerm=void 0,this.deleted=!1,this.permSystem=wv,this.permVC=Av,this.permVP=Pv}ngOnInit(){this.log("Init SysVC Deleted: "+this.deleted),this.log("Init GetVisboCenters "+JSON.stringify(this.route.snapshot.queryParams)),this.deleted=!!this.route.snapshot.queryParams.deleted,this.getVisboCenters(this.deleted),this.combinedPerm=this.visbocenterService.getSysAdminRole()}toggleVisboCenters(){this.deleted=!this.deleted,this.log("VC toggleVisboCenters "+this.deleted),this.getVisboCenters(this.deleted),this.router.navigate(["sysvc"],this.deleted?{queryParams:{deleted:this.deleted}}:{})}getVisboCenters(t){this.log(`VC getVisboCenters ${JSON.stringify(this.combinedPerm)} deleted ${this.deleted}`),this.visbocenterService.getVisboCenters(!0,t).subscribe(t=>{this.visbocenters=t,this.sortVCTable(1),this.log("get VCs success")},t=>{this.log(`get VCs failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}getSysVisboCenter(){this.visbocenterService.getSysVisboCenter().subscribe(t=>{t.length>0&&(this.sysvisbocenter=t[0])})}add(t,e){t=t.trim(),e=e.trim(),this.log("VC: Add VC: "+t),t&&this.visbocenterService.addVisboCenter({name:t,description:e}).subscribe(t=>{this.visbocenters.push(t),this.sortVCTable(void 0),this.alertService.success(`Visbo Center ${t.name} created successfully`)},e=>{this.log(`add VC failed: error: ${e.status} message: ${e.error.message}`),this.alertService.error(403===e.status?"Permission Denied for Visbo Center "+t:409===e.status?`Visbo Center Name ${t} already exists or not allowed`:Lh(e))})}delete(t){this.messageService.add(`VC: Delete VC: ${t.name} ID: ${t._id}`),this.visbocenters=this.visbocenters.filter(e=>e!==t),this.visbocenterService.deleteVisboCenter(t).subscribe(()=>{this.alertService.success("Deleted Visbo Center: "+t.name,!0)},t=>{this.log("delete VC failed: error: "+JSON.stringify(t)),this.alertService.error(403===t.status?"Permission Denied: Visbo Center "+name:Lh(t))})}gotoDetail(t){const e=!!t.deletedAt;this.log(`navigate to VC Detail ${t._id} Deleted ${e}`),this.router.navigate(["sysvcDetail/"+t._id],e?{queryParams:{deleted:e}}:{})}gotoClickedRow(t){this.log("clicked row "+t.name),this.hasSystemPerm(this.permVC.View)&&this.router.navigate(["sysvp/"+t._id])}hasSystemPerm(t){return(this.combinedPerm.system&t)>0}hasVCPerm(t){return(this.combinedPerm.vc&t)>0}hasVPPerm(t){return(this.combinedPerm.vp&t)>0}sortVCTable(t){this.visbocenters&&(void 0===t&&void 0!==this.sortColumn||(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t:!this.sortAscending),1===this.sortColumn?this.visbocenters.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortColumn?this.visbocenters.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})):3===this.sortColumn&&this.visbocenters.sort((function(t,e){return t.vpCount-e.vpCount})),this.sortAscending||this.visbocenters.reverse())}log(t){this.messageService.add("Sys VisboCenter: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(xv),Rs(Rh),Rs(Df),Rs(Fg),Rs(rf))},t.\u0275cmp=le({type:t,selectors:[["app-sysvisbocenters"]],decls:49,vars:2,consts:[[1,"well"],[1,"row"],[1,"col"],[1,"panel-heading","ml-0"],["class","btn-group",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],["id","VCHead"],[1,"d-none","d-md-table-cell"],["id","SortName",3,"click"],["id","SortDate",1,"d-none","d-sm-table-cell",3,"click"],["id","SortProjects",1,"d-none","d-md-table-cell",3,"click"],["id","VCList"],[3,"click",4,"ngFor","ngForOf"],["id","VcModalCreate","tabindex","-1","role","dialog","aria-labelledby","VcModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VcModalCenterTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group"],["for","vcName",1,"col-form-label"],["id","CreateVCName","type","text",1,"form-control"],["vcName",""],["for","vcDescription",1,"col-form-label"],["id","CreateVCDesc",1,"form-control"],["vcDescription",""],[1,"modal-footer","align-items-end"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-secondary"],["id","CreateVCConfirm","type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"],[1,"btn-group"],["id","DeletedVC","type","button","class","m-1 btn btn-secondary",3,"click",4,"ngIf"],["id","UnDeletedVC","type","button","class","m-1 btn btn-secondary",3,"click",4,"ngIf"],["id","CreateVC","type","button","class","m-1 btn btn-primary","data-toggle","modal","data-target","#VcModalCreate",4,"ngIf"],["id","DeletedVC","type","button",1,"m-1","btn","btn-secondary",3,"click"],["id","UnDeletedVC","type","button",1,"m-1","btn","btn-secondary",3,"click"],["id","CreateVC","type","button","data-toggle","modal","data-target","#VcModalCreate",1,"m-1","btn","btn-primary"],[3,"click"],["id","ColName"],["id","ColDate",1,"d-none","d-md-table-cell"],["id","ColDate",1,"d-none","d-sm-table-cell","d-md-none"],["id","ColProjects",1,"d-none","d-md-table-cell"],["id","ColDetail"],["title","Detail of Visbo Center",1,"Detail",3,"click"]],template:function(t,e){if(1&t){const t=zs();Bs(0,"app-sysnavbar"),Ns(1,"div",0),Ns(2,"div",1),Ns(3,"div",2),Ns(4,"h2",3),mo(5," Visbo Centers "),Fs(),Fs(),Gs(6,s_,4,3,"div",4),Fs(),Ns(7,"div",5),Ns(8,"table",6),Ns(9,"thead",7),Ns(10,"tr"),Ns(11,"th",8),mo(12,"Nr."),Fs(),Ns(13,"th",9),Js("click",(function(){return e.sortVCTable(1)})),mo(14,"Name"),Fs(),Ns(15,"th",10),Js("click",(function(){return e.sortVCTable(2)})),mo(16,"Modified"),Fs(),Ns(17,"th",11),Js("click",(function(){return e.sortVCTable(3)})),mo(18,"# Projects"),Fs(),Ns(19,"th"),mo(20,"Detail"),Fs(),Fs(),Fs(),Ns(21,"tbody",12),Gs(22,o_,17,11,"tr",13),Fs(),Fs(),Fs(),Fs(),Ns(23,"div",14),Ns(24,"div",15),Ns(25,"div",16),Ns(26,"div",17),Ns(27,"h5",18),mo(28,"Create a new Visbo Center"),Fs(),Ns(29,"button",19),Ns(30,"span",20),mo(31,"\xd7"),Fs(),Fs(),Fs(),Ns(32,"div",21),Ns(33,"form"),Ns(34,"div",22),Ns(35,"label",23),mo(36,"Name:"),Fs(),Bs(37,"input",24,25),Fs(),Ns(39,"div",22),Ns(40,"label",26),mo(41,"Description:"),Fs(),Bs(42,"textarea",27,28),Fs(),Fs(),Fs(),Ns(44,"div",29),Ns(45,"button",30),mo(46,"Close"),Fs(),Ns(47,"button",31),Js("click",(function(){ei(t);const i=Ls(38),n=Ls(43);return e.add(i.value,n.value),i.value="",n.value=""})),mo(48,"Save"),Fs(),Fs(),Fs(),Fs(),Fs()}2&t&&(_n(6),js("ngIf",e.hasSystemPerm(e.permSystem.DeleteVC)),_n(16),js("ngForOf",e.visbocenters))},directives:[gC,jc,Lc,Ou,Fd,Tu],pipes:[qc],encapsulation:2}),t})();function l_(t,e){if(1&t){const t=zs();Ns(0,"input",63),Js("ngModelChange",(function(e){return ei(t),Xs(2).visbocenter.name=e})),Fs()}2&t&&js("ngModel",Xs(2).visbocenter.name)}function c_(t,e){if(1&t&&(Ns(0,"label",64),mo(1),Fs()),2&t){const t=Xs(2);_n(1),vo("",t.visbocenter.name," ")}}function d_(t,e){if(1&t){const t=zs();Ns(0,"textarea",65),Js("ngModelChange",(function(e){return ei(t),Xs(2).visbocenter.description=e})),Fs()}2&t&&js("ngModel",Xs(2).visbocenter.description)}function u_(t,e){if(1&t&&(Ns(0,"label",66),mo(1),Fs()),2&t){const t=Xs(2);_n(1),vo("",t.visbocenter.description," ")}}function h_(t,e){if(1&t){const t=zs();Ns(0,"button",67),Js("click",(function(){ei(t);const e=Xs(2);return e.gotoVCAudit(e.visbocenter)})),mo(1,"View Audit"),Fs()}}function p_(t,e){if(1&t){const t=zs();Ns(0,"button",68),Js("click",(function(){return ei(t),Xs(2).toggleUserGroup()})),mo(1,"Show Groups"),Fs()}}function g_(t,e){if(1&t){const t=zs();Ns(0,"button",69),Js("click",(function(){return ei(t),Xs(2).toggleUserGroup()})),mo(1,"Show Users"),Fs()}}function m_(t,e){1&t&&(Ns(0,"div",71),Ns(1,"button",78),mo(2,"Add User"),Fs(),Fs())}function f_(t,e){1&t&&(Ns(0,"th"),mo(1,"Delete"),Fs())}function v_(t,e){if(1&t){const t=zs();Ns(0,"td"),Ns(1,"button",81),Js("click",(function(){ei(t);const e=Xs().index;return Xs(3).helperUserIndex(e)})),mo(2,"\xd7"),Fs(),Fs()}}function b_(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td"),mo(2),Fs(),Ns(3,"td",79),Js("click",(function(){ei(t);const i=e.index;return Xs(3).calcCombinedPerm(i)})),mo(4),Fs(),Ns(5,"td",80),mo(6),Fs(),Gs(7,v_,3,0,"td",0),Fs()}if(2&t){const t=e.$implicit,i=e.index,n=Xs(3);_n(2),fo(i+1),_n(2),fo(t.email),_n(2),fo(t.groupName),_n(1),js("ngIf",!n.deleted&&n.hasVCPerm(n.permVC.ManagePerm))}}function y_(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div"),Ns(2,"div",70),Ns(3,"div",71),Ns(4,"h5",72),mo(5," Visbo Center Users "),Fs(),Fs(),Gs(6,m_,3,0,"div",73),Fs(),Ns(7,"div",74),Ns(8,"table",75),Ns(9,"thead",76),Ns(10,"tr"),Ns(11,"th"),mo(12,"Nr."),Fs(),Ns(13,"th",1),Js("click",(function(){return ei(t),Xs(2).sortUserTable(1)})),mo(14,"e-mail"),Fs(),Ns(15,"th",1),Js("click",(function(){return ei(t),Xs(2).sortUserTable(2)})),mo(16,"Group"),Fs(),Gs(17,f_,2,0,"th",0),Fs(),Fs(),Ns(18,"tbody",77),Gs(19,b_,8,4,"tr",38),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(6),js("ngIf",t.hasVCPerm(t.permVC.ManagePerm)),_n(11),js("ngIf",!t.deleted&&t.hasVCPerm(t.permVC.ManagePerm)),_n(2),js("ngForOf",t.vgUsers)}}function C_(t,e){1&t&&(Ns(0,"th"),mo(1,"Delete"),Fs())}function V_(t,e){1&t&&(Ns(0,"td",88),mo(1,"Global"),Fs())}function w_(t,e){1&t&&Bs(0,"td",88)}function A_(t,e){if(1&t){const t=zs();Ns(0,"td"),Ns(1,"button",89),Js("click",(function(){ei(t);const e=Xs().index;return Xs(3).helperRemoveGroup(e)})),mo(2,"\xd7"),Fs(),Fs()}}function P_(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td"),mo(2),Fs(),Ns(3,"td",84),Js("click",(function(){ei(t);const i=e.index,n=e.$implicit,r=Xs(3);return r.groupIndex=i,r.initGroup(n)})),mo(4),Fs(),Ns(5,"td",85),mo(6),Fs(),Gs(7,V_,2,0,"td",86),Gs(8,w_,1,0,"td",86),Gs(9,A_,3,0,"td",0),Ns(10,"td"),Ns(11,"button",87),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(3).initGroup(i)})),mo(12,"i"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit,i=e.index,n=Xs(3);_n(2),fo(i+1),_n(2),fo(t.name),_n(2),fo(t.users.length),_n(1),js("ngIf",t.global),_n(1),js("ngIf",!t.global),_n(1),js("ngIf",!n.deleted&&n.hasVCPerm(n.permVC.ManagePerm))}}function k_(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div"),Ns(2,"div",70),Ns(3,"div",71),Ns(4,"h5",72),mo(5," Visbo Center Groups "),Fs(),Fs(),Fs(),Ns(6,"div",74),Ns(7,"table",75),Ns(8,"thead",82),Ns(9,"tr"),Ns(10,"th"),mo(11,"Nr."),Fs(),Ns(12,"th",1),Js("click",(function(){return ei(t),Xs(2).sortGroupTable(1)})),mo(13,"Group"),Fs(),Ns(14,"th",1),Js("click",(function(){return ei(t),Xs(2).sortGroupTable(2)})),mo(15,"Members"),Fs(),Ns(16,"th"),mo(17,"Flag"),Fs(),Gs(18,C_,2,0,"th",0),Ns(19,"th"),mo(20,"Info"),Fs(),Fs(),Fs(),Ns(21,"tbody",83),Gs(22,P_,13,6,"tr",38),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(18),js("ngIf",!t.deleted&&t.hasVCPerm(t.permVC.ManagePerm)),_n(4),js("ngForOf",t.vgGroups)}}function D_(t,e){if(1&t){const t=zs();Ns(0,"button",90),Js("click",(function(){return ei(t),Xs(2).save()})),mo(1,"save"),Fs()}}function M_(t,e){if(1&t){const t=zs();Ns(0,"button",90),Js("click",(function(){return ei(t),Xs(2).save()})),mo(1,"Restore"),Fs()}}function S_(t,e){1&t&&(Ns(0,"button",91),mo(1,"Delete!"),Fs())}function I_(t,e){1&t&&(Ns(0,"button",92),mo(1,"Destroy!"),Fs())}function x_(t,e){1&t&&(Ns(0,"div",93),mo(1,"E-mail address is required"),Fs())}function T_(t,e){if(1&t&&(Ns(0,"option"),mo(1),Fs()),2&t){const t=e.$implicit;_n(1),fo(t.name)}}function __(t,e){1&t&&(Ns(0,"div",93),mo(1,"Group must be defined"),Fs())}function U_(t,e){1&t&&(Ns(0,"div",93),mo(1,"Error in Message"),Fs())}function E_(t,e){1&t&&(Ns(0,"button",94),mo(1,"Invite"),Fs())}function O_(t,e){if(1&t){const t=zs();Ns(0,"button",95),Js("click",(function(){return ei(t),Xs(2).addNewVCUser()})),mo(1,"Invite"),Fs()}}function G_(t,e){if(1&t){const t=zs();Ns(0,"div",21),Ns(1,"div",22),Ns(2,"div",23),Ns(3,"h5",96),mo(4,"Remove User from Visbo Center"),Fs(),Ns(5,"button",25),Ns(6,"span",26),mo(7,"\xd7"),Fs(),Fs(),Fs(),Ns(8,"div",27),Ns(9,"div"),Ns(10,"label",97),mo(11,"Do you really want to remove this User from Visbo Center? "),Fs(),Fs(),Ns(12,"form"),Ns(13,"div",42),Ns(14,"label",54),mo(15,"Visbo Center:"),Fs(),Ns(16,"label",55),mo(17),Fs(),Fs(),Ns(18,"div",42),Ns(19,"label",54),mo(20,"User:"),Fs(),Ns(21,"label",55),mo(22),Fs(),Fs(),Ns(23,"div",42),Ns(24,"label",54),mo(25,"Group:"),Fs(),Ns(26,"label",55),mo(27),Fs(),Fs(),Fs(),Fs(),Ns(28,"div",58),Ns(29,"button",59),mo(30,"Close"),Fs(),Ns(31,"button",98),Js("click",(function(){ei(t);const e=Xs(2);return e.removeVCUser(e.vgUsers[e.userIndex],e.visbocenter._id)})),mo(32,"Remove"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(17),vo("",t.visbocenter.name," "),_n(5),fo(t.vgUsers[t.userIndex].email),_n(5),fo(t.vgUsers[t.userIndex].groupName)}}function L_(t,e){1&t&&(Ns(0,"h5",127),mo(1,"Modify a Group in the Visbo Center"),Fs())}function R_(t,e){1&t&&(Ns(0,"h5",127),mo(1,"Add a new Group to the Visbo Center"),Fs())}function j_(t,e){1&t&&(Ns(0,"div",93),mo(1,"Group Name is required"),Fs())}function $_(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div"),mo(2,"Define Visbo Project Permission"),Fs(),Ns(3,"div",104),Ns(4,"input",128,129),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedVPView=e})),Fs(),Ns(6,"label",130),mo(7,"View Visbo Project"),Fs(),Fs(),Ns(8,"div",104),Ns(9,"input",131,132),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedVPViewAudit=e})),Fs(),Ns(11,"label",133),mo(12,"View Project Audit"),Fs(),Fs(),Ns(13,"div",104),Ns(14,"input",134,135),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedVPModify=e})),Fs(),Ns(16,"label",136),mo(17,"Modify Visbo Project"),Fs(),Fs(),Ns(18,"div",104),Ns(19,"input",137,138),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedCreateVariant=e})),Fs(),Ns(21,"label",139),mo(22,"Create Visbo Project Variant"),Fs(),Fs(),Ns(23,"div",104),Ns(24,"input",140,141),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedVPManagePerm=e})),Fs(),Ns(26,"label",142),mo(27,"Manage Permissions, Users and Groups"),Fs(),Fs(),Ns(28,"div",104),Ns(29,"input",143,144),Js("ngModelChange",(function(e){return ei(t),Xs(3).actGroup.checkedVPDelete=e})),Fs(),Ns(31,"label",145),mo(32,"Delete Visbo Project"),Fs(),Fs(),Fs()}if(2&t){const t=Xs(3);_n(4),js("ngModel",t.actGroup.checkedVPView),_n(5),js("ngModel",t.actGroup.checkedVPViewAudit),_n(5),js("ngModel",t.actGroup.checkedVPModify),_n(5),js("ngModel",t.actGroup.checkedCreateVariant),_n(5),js("ngModel",t.actGroup.checkedVPManagePerm),_n(5),js("ngModel",t.actGroup.checkedVPDelete)}}function N_(t,e){if(1&t){const t=zs();Ns(0,"div",150),Ns(1,"a",151),Js("click",(function(){return ei(t),Xs(5).toggleUserGroup()})),mo(2),Fs(),Fs()}if(2&t){const t=Xs().$implicit;_n(2),fo(t.email)}}function F_(t,e){if(1&t&&(Hs(0,70),Gs(1,N_,3,1,"div",149),Ks()),2&t){const t=e.$implicit,i=Xs(4);_n(1),js("ngIf",t.groupName==i.actGroup.name)}}function B_(t,e){if(1&t&&(Ns(0,"div",146),Ns(1,"label",147),mo(2,"Group Members"),Fs(),Gs(3,F_,2,1,"ng-container",148),Fs()),2&t){const t=Xs(3);_n(3),js("ngForOf",t.vgUsers)}}function H_(t,e){1&t&&(Ns(0,"div",146),Ns(1,"label",147),mo(2,"No Group Members"),Fs(),Fs())}function K_(t,e){if(1&t&&(Ns(0,"button",152),mo(1),Fs()),2&t){const t=Xs(3);_n(1),fo(t.confirm)}}function q_(t,e){if(1&t){const t=zs();Ns(0,"button",153),Js("click",(function(){return ei(t),Xs(3).addModifyVCGroup()})),mo(1),Fs()}if(2&t){const t=Xs(3);_n(1),fo(t.confirm)}}const z_=function(t){return{"has-error":t}};function Q_(t,e){if(1&t){const t=zs();Ns(0,"div",21),Ns(1,"div",22),Ns(2,"div",23),Gs(3,L_,2,0,"h5",99),Gs(4,R_,2,0,"h5",99),Ns(5,"button",25),Ns(6,"span",26),mo(7,"\xd7"),Fs(),Fs(),Fs(),Ns(8,"div",27),Ns(9,"form",100,29),Ns(11,"div",30),Ns(12,"label",101),mo(13,"Name:"),Fs(),Ns(14,"input",102,103),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.name=e})),Fs(),Gs(16,j_,2,0,"div",34),Fs(),Ns(17,"div"),mo(18,"Define Visbo Center Permission"),Fs(),Ns(19,"div",104),Ns(20,"input",105,106),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedView=e})),Fs(),Ns(22,"label",107),mo(23,"View Visbo Center"),Fs(),Fs(),Ns(24,"div",104),Ns(25,"input",108,109),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedViewAudit=e})),Fs(),Ns(27,"label",110),mo(28,"View Audit"),Fs(),Fs(),Ns(29,"div",104),Ns(30,"input",111,112),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedModify=e})),Fs(),Ns(32,"label",113),mo(33,"Modify Visbo Center"),Fs(),Fs(),Ns(34,"div",104),Ns(35,"input",114,115),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedCreateVP=e})),Fs(),Ns(37,"label",116),mo(38,"Create Visbo Project"),Fs(),Fs(),Ns(39,"div",104),Ns(40,"input",117,118),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedManagePerm=e})),Fs(),Ns(42,"label",119),mo(43,"Manage Permissions, Users and Groups"),Fs(),Fs(),Bs(44,"br"),Ns(45,"div",104),Ns(46,"input",120,121),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.global=e})),Fs(),Ns(48,"label",122),mo(49,"Group has Access to all Visbo Projects"),Fs(),Fs(),Gs(50,$_,33,6,"div",0),Gs(51,B_,4,1,"div",123),Gs(52,H_,3,0,"div",123),Ns(53,"div",124),Gs(54,K_,2,1,"button",125),Gs(55,q_,2,1,"button",126),Ns(56,"button",45),mo(57,"Cancel"),Fs(),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Ls(10),e=Ls(15);Xs();const i=Ls(54),n=Xs();_n(3),js("ngIf",n.actGroup._id),_n(1),js("ngIf",!n.actGroup._id),_n(7),js("ngClass",ka(16,z_,t.submitted&&!i.valid)),_n(3),js("ngModel",n.actGroup.name),_n(2),js("ngIf",t.submitted&&!e.valid),_n(4),js("ngModel",n.actGroup.checkedView),_n(5),js("ngModel",n.actGroup.checkedViewAudit),_n(5),js("ngModel",n.actGroup.checkedModify),_n(5),js("ngModel",n.actGroup.checkedCreateVP),_n(5),js("ngModel",n.actGroup.checkedManagePerm),_n(6),js("ngModel",n.actGroup.global),_n(4),js("ngIf",n.actGroup.global),_n(1),js("ngIf",n.helperUsersPerGroup(n.actGroup.name)),_n(1),js("ngIf",!n.helperUsersPerGroup(n.actGroup.name)),_n(2),js("ngIf",!(t.form.valid&&!n.deleted&&n.hasVCPerm(n.permVC.ManagePerm))),_n(1),js("ngIf",t.form.valid&&!n.deleted&&n.hasVCPerm(n.permVC.ManagePerm))}}function W_(t,e){if(1&t){const t=zs();Ns(0,"div",21),Ns(1,"div",22),Ns(2,"div",23),Ns(3,"h5",96),mo(4,"Remove Group from Visbo Center"),Fs(),Ns(5,"button",25),Ns(6,"span",26),mo(7,"\xd7"),Fs(),Fs(),Fs(),Ns(8,"div",27),Ns(9,"div"),Ns(10,"label",97),mo(11,"Do you really want to remove this Group from Visbo Center? "),Fs(),Fs(),Ns(12,"form"),Ns(13,"div",42),Ns(14,"label",54),mo(15,"Visbo Center:"),Fs(),Ns(16,"label",55),mo(17),Fs(),Fs(),Ns(18,"div",42),Ns(19,"label",54),mo(20,"Group:"),Fs(),Ns(21,"label",55),mo(22),Fs(),Fs(),Ns(23,"div",42),Ns(24,"label",54),mo(25,"Members:"),Fs(),Ns(26,"label",55),mo(27),Fs(),Fs(),Fs(),Fs(),Ns(28,"div",58),Ns(29,"button",45),mo(30,"Close"),Fs(),Ns(31,"button",154),Js("click",(function(){ei(t);const e=Xs(2);return e.removeVCGroup(e.vgGroups[e.groupIndex])})),mo(32,"Remove"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(17),vo("",t.visbocenter.name," "),_n(5),fo(t.vgGroups[t.groupIndex].name),_n(5),fo(t.vgGroups[t.groupIndex].users.length)}}function J_(t,e){1&t&&(Ns(0,"label",97),mo(1,"Do you really want to delete this Visbo Center? "),Fs())}function Y_(t,e){1&t&&(Ns(0,"label",155),mo(1,"Do you really want to destroy this Visbo Center? "),Fs())}function Z_(t,e){if(1&t){const t=zs();Ns(0,"button",156),Js("click",(function(){ei(t);const e=Xs(2);return e.delete(e.visbocenter)})),mo(1,"Delete"),Fs()}}function X_(t,e){if(1&t){const t=zs();Ns(0,"button",157),Js("click",(function(){ei(t);const e=Xs(2);return e.delete(e.visbocenter)})),mo(1,"Destroy"),Fs()}}function tU(t,e){1&t&&Bs(0,"input",185)}function eU(t,e){1&t&&Bs(0,"input",186)}function iU(t,e){1&t&&Bs(0,"input",187)}function nU(t,e){1&t&&Bs(0,"input",188)}function rU(t,e){1&t&&Bs(0,"input",189)}function sU(t,e){1&t&&Bs(0,"input",190)}function oU(t,e){1&t&&Bs(0,"input",191)}function aU(t,e){1&t&&Bs(0,"input",192)}function lU(t,e){1&t&&Bs(0,"input",193)}function cU(t,e){1&t&&Bs(0,"input",194)}function dU(t,e){1&t&&Bs(0,"input",195)}function uU(t,e){1&t&&Bs(0,"input",196)}function hU(t,e){1&t&&Bs(0,"input",197)}function pU(t,e){1&t&&Bs(0,"input",198)}function gU(t,e){1&t&&Bs(0,"input",199)}function mU(t,e){1&t&&Bs(0,"input",200)}function fU(t,e){1&t&&Bs(0,"input",201)}function vU(t,e){1&t&&Bs(0,"input",202)}function bU(t,e){1&t&&Bs(0,"input",203)}function yU(t,e){1&t&&Bs(0,"input",204)}function CU(t,e){1&t&&Bs(0,"input",205)}function VU(t,e){1&t&&Bs(0,"input",206)}function wU(t,e){if(1&t){const t=zs();Ns(0,"div",150),Ns(1,"a",151),Js("click",(function(){return ei(t),Xs(4).toggleUserGroup()})),mo(2),Fs(),Fs()}if(2&t){const t=Xs().$implicit;_n(2),fo(t.groupName)}}function AU(t,e){if(1&t&&(Hs(0,70),Gs(1,wU,3,1,"div",149),Ks()),2&t){const t=e.$implicit,i=Xs(3);_n(1),js("ngIf",t.email==i.vgUsers[i.userIndex].email)}}function PU(t,e){if(1&t&&(Ns(0,"div",158),Ns(1,"div",159),Ns(2,"div",22),Ns(3,"div",23),Ns(4,"h5",160),mo(5),Fs(),Ns(6,"button",25),Ns(7,"span",26),mo(8,"\xd7"),Fs(),Fs(),Fs(),Ns(9,"div",27),Ns(10,"div",146),mo(11,"Visbo Center Permission for User"),Fs(),Ns(12,"div",104),Gs(13,tU,1,0,"input",161),Gs(14,eU,1,0,"input",162),Ns(15,"label",107),mo(16,"View Visbo Center"),Fs(),Fs(),Ns(17,"div",104),Gs(18,iU,1,0,"input",163),Gs(19,nU,1,0,"input",164),Ns(20,"label",110),mo(21,"View Audit"),Fs(),Fs(),Ns(22,"div",104),Gs(23,rU,1,0,"input",165),Gs(24,sU,1,0,"input",166),Ns(25,"label",113),mo(26,"Modify Visbo Center"),Fs(),Fs(),Ns(27,"div",104),Gs(28,oU,1,0,"input",167),Gs(29,aU,1,0,"input",168),Ns(30,"label",116),mo(31,"Create Visbo Project"),Fs(),Fs(),Ns(32,"div",104),Gs(33,lU,1,0,"input",169),Gs(34,cU,1,0,"input",170),Ns(35,"label",119),mo(36,"Manage Permissions, Users and Groups"),Fs(),Fs(),Bs(37,"br"),Ns(38,"div"),mo(39,"Visbo Project Permission for User"),Fs(),Ns(40,"div",104),Gs(41,dU,1,0,"input",171),Gs(42,uU,1,0,"input",172),Ns(43,"label",130),mo(44,"View Visbo Project"),Fs(),Fs(),Ns(45,"div",104),Gs(46,hU,1,0,"input",173),Gs(47,pU,1,0,"input",174),Ns(48,"label",133),mo(49,"View Project Audit"),Fs(),Fs(),Ns(50,"div",104),Gs(51,gU,1,0,"input",175),Gs(52,mU,1,0,"input",176),Ns(53,"label",136),mo(54,"Modify Visbo Project"),Fs(),Fs(),Ns(55,"div",104),Gs(56,fU,1,0,"input",177),Gs(57,vU,1,0,"input",178),Ns(58,"label",139),mo(59,"Create Visbo Project Variant"),Fs(),Fs(),Ns(60,"div",104),Gs(61,bU,1,0,"input",179),Gs(62,yU,1,0,"input",180),Ns(63,"label",142),mo(64,"Manage Permissions, Users and Groups"),Fs(),Fs(),Ns(65,"div",104),Gs(66,CU,1,0,"input",181),Gs(67,VU,1,0,"input",182),Ns(68,"label",145),mo(69,"Delete Visbo Project"),Fs(),Fs(),Ns(70,"label",183),mo(71,"Group Member Ship"),Fs(),Gs(72,AU,2,1,"ng-container",148),Ns(73,"div",124),Ns(74,"button",184),mo(75,"Close"),Fs(),Fs(),Fs(),Fs(),Fs(),Fs()),2&t){const t=Xs(2);_n(5),vo("Permission for ",t.vgUsers[t.userIndex].email,""),_n(8),js("ngIf",t.hasUserVCPerm(t.permVC.View)),_n(1),js("ngIf",!t.hasUserVCPerm(t.permVC.View)),_n(4),js("ngIf",t.hasUserVCPerm(t.permVC.ViewAudit)),_n(1),js("ngIf",!t.hasUserVCPerm(t.permVC.ViewAudit)),_n(4),js("ngIf",t.hasUserVCPerm(t.permVC.Modify)),_n(1),js("ngIf",!t.hasUserVCPerm(t.permVC.Modify)),_n(4),js("ngIf",t.hasUserVCPerm(t.permVC.CreateVP)),_n(1),js("ngIf",!t.hasUserVCPerm(t.permVC.CreateVP)),_n(4),js("ngIf",t.hasUserVCPerm(t.permVC.ManagePerm)),_n(1),js("ngIf",!t.hasUserVCPerm(t.permVC.ManagePerm)),_n(7),js("ngIf",t.hasUserVPPerm(t.permVP.View)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.View)),_n(4),js("ngIf",t.hasUserVPPerm(t.permVP.ViewAudit)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.ViewAudit)),_n(4),js("ngIf",t.hasUserVPPerm(t.permVP.Modify)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.Modify)),_n(4),js("ngIf",t.hasUserVPPerm(t.permVP.CreateVariant)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.CreateVariant)),_n(4),js("ngIf",t.hasUserVPPerm(t.permVP.ManagePerm)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.ManagePerm)),_n(4),js("ngIf",t.hasUserVPPerm(t.permVP.DeleteVP)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.DeleteVP)),_n(5),js("ngForOf",t.vgUsers)}}function kU(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"h3"),mo(2,"Visbo Center: "),Ns(3,"a",1),Js("click",(function(){ei(t);const e=Xs();return e.gotoVPList(e.visbocenter)})),mo(4),Ua(5,"uppercase"),Fs(),Fs(),Ns(6,"form"),Ns(7,"div",2),Ns(8,"label",3),mo(9,"Name:"),Fs(),Gs(10,l_,1,1,"input",4),Gs(11,c_,2,1,"label",5),Fs(),Ns(12,"div",2),Ns(13,"label",6),mo(14,"Description:"),Fs(),Gs(15,d_,1,1,"textarea",7),Gs(16,u_,2,1,"label",8),Fs(),Ns(17,"div",2),Ns(18,"label",9),mo(19,"Created / Updated at:"),Fs(),Ns(20,"label",10),mo(21),Ua(22,"date"),Fs(),Ns(23,"label",11),mo(24),Ua(25,"date"),Fs(),Fs(),Fs(),Ns(26,"div",12),Gs(27,h_,2,0,"button",13),Gs(28,p_,2,0,"button",14),Gs(29,g_,2,0,"button",15),Fs(),Gs(30,y_,20,3,"div",0),Gs(31,k_,23,2,"div",0),Gs(32,D_,2,0,"button",16),Gs(33,M_,2,0,"button",16),Ns(34,"button",17),Js("click",(function(){return ei(t),Xs().goBack()})),mo(35,"go back"),Fs(),Gs(36,S_,2,0,"button",18),Gs(37,I_,2,0,"button",19),Ns(38,"div",20),Ns(39,"div",21),Ns(40,"div",22),Ns(41,"div",23),Ns(42,"h5",24),mo(43,"Add a new User to the Visbo Center"),Fs(),Ns(44,"button",25),Ns(45,"span",26),mo(46,"\xd7"),Fs(),Fs(),Fs(),Ns(47,"div",27),Ns(48,"form",28,29),Ns(50,"div",30),Ns(51,"label",31),mo(52,"Name:"),Fs(),Ns(53,"input",32,33),Js("ngModelChange",(function(e){return ei(t),Xs().newUserInvite.email=e})),Fs(),Gs(55,x_,2,0,"div",34),Fs(),Ns(56,"div",30),Ns(57,"label",35),mo(58,"Group:"),Fs(),Ns(59,"select",36,37),Js("ngModelChange",(function(e){return ei(t),Xs().newUserInvite.groupName=e})),Bs(61,"option"),Gs(62,T_,2,1,"option",38),Fs(),Gs(63,__,2,0,"div",34),Fs(),Ns(64,"div",30),Ns(65,"label",39),mo(66,"Message:"),Fs(),Ns(67,"textarea",40,41),Js("ngModelChange",(function(e){return ei(t),Xs().newUserInvite.inviteMessage=e})),mo(69," "),Fs(),Fs(),Gs(70,U_,2,0,"div",34),Ns(71,"div",42),Gs(72,E_,2,0,"button",43),Gs(73,O_,2,0,"button",44),Ns(74,"button",45),mo(75,"Cancel"),Fs(),Fs(),Fs(),Fs(),Fs(),Fs(),Fs(),Ns(76,"div",46),Gs(77,G_,33,3,"div",47),Fs(),Ns(78,"div",48),Gs(79,Q_,58,18,"div",47),Fs(),Ns(80,"div",49),Gs(81,W_,33,3,"div",47),Fs(),Ns(82,"div",50),Ns(83,"div",21),Ns(84,"div",22),Ns(85,"div",23),Ns(86,"h5",51),mo(87,"Delete this Visbo Center"),Fs(),Ns(88,"button",25),Ns(89,"span",26),mo(90,"\xd7"),Fs(),Fs(),Fs(),Ns(91,"div",27),Ns(92,"div"),Gs(93,J_,2,0,"label",52),Gs(94,Y_,2,0,"label",53),Fs(),Ns(95,"form"),Ns(96,"div",42),Ns(97,"label",54),mo(98,"Name:"),Fs(),Ns(99,"label",55),mo(100),Fs(),Fs(),Ns(101,"div",42),Ns(102,"label",56),mo(103,"Description:"),Fs(),Ns(104,"label",55),mo(105),Fs(),Fs(),Ns(106,"div",42),Ns(107,"label",57),mo(108,"Projects:"),Fs(),Ns(109,"label",55),mo(110),Fs(),Fs(),Fs(),Fs(),Ns(111,"div",58),Ns(112,"button",59),mo(113,"Close"),Fs(),Gs(114,Z_,2,0,"button",60),Gs(115,X_,2,0,"button",61),Fs(),Fs(),Fs(),Fs(),Gs(116,PU,76,24,"div",62),Fs()}if(2&t){const t=Ls(49),e=Ls(54),i=Ls(60),n=Ls(68),r=Xs();_n(4),fo(Ea(5,39,r.visbocenter.name)),_n(6),js("ngIf",r.hasVCPerm(r.permVC.Modify)),_n(1),js("ngIf",!r.hasVCPerm(r.permVC.Modify)),_n(4),js("ngIf",r.hasVCPerm(r.permVC.Modify)),_n(1),js("ngIf",!r.hasVCPerm(r.permVC.Modify)),_n(5),vo("",Oa(22,41,r.visbocenter.createdAt,"dd.MM.yyyy HH:mm:ss")," "),_n(3),vo("",Oa(25,44,r.visbocenter.updatedAt,"dd.MM.yyyy HH:mm:ss")," "),_n(3),js("ngIf",r.hasVCPerm(r.permVC.ViewAudit)),_n(1),js("ngIf",!r.showGroups),_n(1),js("ngIf",r.showGroups),_n(1),js("ngIf",!r.showGroups),_n(1),js("ngIf",r.showGroups),_n(1),js("ngIf",!r.deleted&&r.hasVCPerm(r.permVC.Modify)),_n(1),js("ngIf",r.deleted&&r.hasSystemPerm(r.permSystem.DeleteVC)),_n(3),js("ngIf",!r.deleted&&r.hasSystemPerm(r.permSystem.DeleteVC)),_n(1),js("ngIf",r.deleted&&r.hasSystemPerm(r.permSystem.DeleteVC)),_n(13),js("ngClass",ka(47,z_,t.submitted&&!e.valid)),_n(3),js("ngModel",r.newUserInvite.email),_n(2),js("ngIf",t.submitted&&!e.valid),_n(1),js("ngClass",ka(49,z_,t.submitted&&!i.valid)),_n(3),js("ngModel",r.newUserInvite.groupName),_n(3),js("ngForOf",r.vgGroups),_n(1),js("ngIf",t.submitted&&!i.valid),_n(1),js("ngClass",ka(51,z_,t.submitted&&!n.valid)),_n(3),js("ngModel",r.newUserInvite.inviteMessage),_n(3),js("ngIf",t.submitted&&!n.valid),_n(2),js("ngIf",!(e.valid&&i.valid)),_n(1),js("ngIf",e.valid&&i.valid),_n(4),js("ngIf",r.userIndex>=0&&r.userIndex<r.vgUsers.length),_n(2),js("ngIf",r.actGroup),_n(2),js("ngIf",r.groupIndex>=0&&r.groupIndex<r.vgGroups.length),_n(12),js("ngIf",!r.deleted),_n(1),js("ngIf",r.deleted),_n(6),vo("",r.visbocenter.name," "),_n(5),vo("",r.visbocenter.description," "),_n(5),vo("",r.visbocenter.vpCount," "),_n(4),js("ngIf",!r.deleted),_n(1),js("ngIf",r.deleted),_n(1),js("ngIf",r.vgUsers&&r.userIndex>=0)}}let DU=(()=>{class t{constructor(t,e,i,n,r,s){this.messageService=t,this.visbocenterService=e,this.route=i,this.location=n,this.router=r,this.alertService=s,this.newUserInvite=new Yh,this.permSystem=wv,this.permVC=Av,this.permVP=Pv,this.deleted=!1,this.sortUserColumn=1,this.sortUserAscending=!0,this.sortGroupColumn=1,this.sortGroupAscending=!0}ngOnInit(){this.log("SysVisboCenter Init: "+JSON.stringify(this.visbocenter)),this.deleted=!!this.route.snapshot.queryParams.deleted,this.getVisboCenter(),this.getVisboCenterUsers(),this.combinedPerm=this.visbocenterService.getSysAdminRole()}getVisboCenter(){const t=this.route.snapshot.paramMap.get("id");this.log(`VisboCenter Detail of: ${t} Deleted ${this.deleted}`),this.visbocenterService.getVisboCenter(t,!0,this.deleted).subscribe(t=>{this.visbocenter=t,this.combinedPerm=t.perm},t=>{this.log(`Get VC failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(403===t.status?"Permission Denied":Lh(t))})}hasSystemPerm(t){return(this.combinedPerm.system&t)>0}hasVCPerm(t){return(this.combinedPerm.vc&t)>0}hasVPPerm(t){return(this.combinedPerm.vp&t)>0}hasUserVCPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vc&t)>0}hasUserVPPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vp&t)>0}getVisboCenterUsers(){const t=this.route.snapshot.paramMap.get("id");this.log(`VisboCenter UserList of ${t} Deleted ${this.deleted}`),this.visbocenterService.getVCUsers(t,!0,this.deleted).subscribe(t=>{this.vgUsers=t.users,this.vgGroups=t.groups,this.log(`fetched Users ${this.vgUsers.length}, Groups ${this.vgGroups.length}`),this.sortUserTable(),this.sortGroupTable()},t=>{this.log(`Get VC Users failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(403===t.status?"Permission Denied":Lh(t))})}gotoVCAudit(t){this.log(`GoTo VC Audit ${t.name} ${this.visbocenter.name}`);const e=this.deleted?{sysadmin:1,deleted:1}:{sysadmin:1};this.log(`GoTo VC Audit ${t.name} ${this.visbocenter.name} ${JSON.stringify(e)}`),this.router.navigate(["vcAudit/".concat(t._id)],{queryParams:e})}gotoVPList(t){this.log("GoTo VP List "+JSON.stringify(this.combinedPerm)),this.hasVPPerm(this.permVP.View)&&this.router.navigate(["sysvp/".concat(t._id)])}goBack(){this.location.back()}save(){this.log(`PUT VC: ${this.visbocenter.name} ID: ${this.visbocenter._id} Deleted: ${this.deleted}`),this.visbocenterService.updateVisboCenter(this.visbocenter,!0,this.deleted).subscribe(t=>{this.alertService.success(`Visbo Center ${t.name} updated successfully`,!0),this.goBack()},t=>{this.log(`save VC failed: error: ${t.status} message: ${t.error.message} `),this.alertService.error(403===t.status?"Permission Denied: Visbo Center "+this.visbocenter.name:409===t.status?`Visbo Center ${this.visbocenter.name} exists already`:Lh(t))})}delete(t){this.log(`Delete VC: ${t.name} ID: ${t._id} Deleted: ${this.deleted}`),this.visbocenterService.deleteVisboCenter(t,!0,this.deleted).subscribe(()=>{this.alertService.success(`Visbo Center ${t.name} deleted successfully`,!0),this.deleted?this.router.navigate(["sysvc"]):this.goBack()},e=>{this.log(`delete VC failed: error: ${e.status} message: ${e.error.message}`),this.alertService.error(403===e.status?"Permission Denied: Visbo Center "+t.name:Lh(e))})}toggleUserGroup(){this.showGroups=!this.showGroups}addNewVCUser(){const t=this.newUserInvite.email.trim(),e=this.newUserInvite.groupName.trim(),i=this.vgGroups.filter(t=>t.name===e)[0]._id,n=this.visbocenter._id;let r="";this.newUserInvite.inviteMessage&&(r=this.newUserInvite.inviteMessage.trim()),this.log(`Add VisboCenter User: ${t} Group: ${e}/${i} VC: ${n}`),t&&i&&this.visbocenterService.addVCUser(t,i,r,n,!0).subscribe(e=>{const i=new Mv;i.userId=e.users.filter(e=>e.email===t)[0].userId,i.email=t,i.groupId=e._id,i.groupName=e.name,this.log("Add VisboCenter User Push: "+JSON.stringify(i)),this.vgUsers.push(i),this.sortUserTable();for(let t=0;t<this.vgGroups.length;t++)if(this.vgGroups[t]._id===e._id){this.vgGroups[t]=e;break}this.alertService.success(`User ${t} added successfully`)},t=>{this.log("Add VisboCenter User error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Add User to Visbo Center"):(this.log("Error during add VC user "+t.error.message),this.alertService.error(Lh(t)))})}helperUserIndex(t){this.userIndex=t}calcCombinedPerm(t){this.userIndex=t,this.combinedUserPerm={system:0,vc:0,vp:0},this.vgUsers.forEach(this.addUserPerm,this),this.log(`Combined Permission for ${this.vgUsers[t].email}  ${JSON.stringify(this.combinedUserPerm)}`)}addUserPerm(t){if(t.email!==this.vgUsers[this.userIndex].email)return;this.log("Add User Permission for "+t.groupName);const e=this.vgGroups.findIndex(e=>e.name===t.groupName);e>=0?this.vgGroups[e].permission?(this.combinedUserPerm.system=this.combinedUserPerm.system|(this.vgGroups[e].permission.system||0),this.combinedUserPerm.vc=this.combinedUserPerm.vc|(this.vgGroups[e].permission.vc||0),this.combinedUserPerm.vp=this.combinedUserPerm.vp|(this.vgGroups[e].permission.vp||0)):this.log("Permission for Group not set "+t.groupName):this.log("Group not found "+t.groupName)}helperRemoveGroup(t){this.groupIndex=t}helperUsersPerGroup(t){const e=this.vgGroups&&this.vgGroups.find(e=>e.name===t);return e?e.users.length:0}removeVCUser(t,e){this.log(`Remove VisboCenter User: ${t.email}/${t.userId} Group: ${t.groupName} VC: ${e}`),this.visbocenterService.deleteVCUser(t,e,!0).subscribe(()=>{this.vgUsers=this.vgUsers.filter(e=>e!==t);for(let e=0;e<this.vgGroups.length;e++)if(this.vgGroups[e]._id===t.groupId){for(let i=0;i<this.vgGroups[e].users.length;i++)if(this.vgGroups[e].users[i].userId===t.userId){this.vgGroups[e].users.splice(i,1);break}break}this.alertService.success(`User ${t.email} removed successfully`)},t=>{this.log("Remove VisboCenter User error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Remove User from Visbo Center"):(this.log("Error during remove VC user "+t.error.message),this.alertService.error(Lh(t)))})}helperVCPerm(t){let e=0;return t.checkedView&&(e+=this.permVC.View),t.checkedViewAudit&&(e+=this.permVC.ViewAudit),t.checkedModify&&(e+=this.permVC.Modify),t.checkedCreateVP&&(e+=this.permVC.CreateVP),t.checkedManagePerm&&(e+=this.permVC.ManagePerm),e}helperVPPerm(t){let e=0;return t.checkedVPView&&(e+=this.permVP.View),t.checkedVPViewAudit&&(e+=this.permVP.ViewAudit),t.checkedVPModify&&(e+=this.permVP.Modify),t.checkedCreateVariant&&(e+=this.permVP.CreateVariant),t.checkedVPManagePerm&&(e+=this.permVP.ManagePerm),t.checkedVPDelete&&(e+=this.permVP.DeleteVP),e}initGroup(t){this.actGroup=new Dv,t?(this.confirm="Modify",this.actGroup._id=t._id,this.log(`Init Group Set GroupID : ${this.actGroup._id} ID ${t._id}`),this.actGroup.name=t.name,this.actGroup.global=t.global,this.actGroup.checkedView=(t.permission.vc&this.permVC.View)>0,this.actGroup.checkedViewAudit=(t.permission.vc&this.permVC.ViewAudit)>0,this.actGroup.checkedModify=(t.permission.vc&this.permVC.Modify)>0,this.actGroup.checkedCreateVP=(t.permission.vc&this.permVC.CreateVP)>0,this.actGroup.checkedManagePerm=(t.permission.vc&this.permVC.ManagePerm)>0,this.actGroup.checkedVPView=(t.permission.vp&this.permVP.View)>0,this.actGroup.checkedVPViewAudit=(t.permission.vp&this.permVP.ViewAudit)>0,this.actGroup.checkedVPModify=(t.permission.vp&this.permVP.Modify)>0,this.actGroup.checkedCreateVariant=(t.permission.vp&this.permVP.CreateVariant)>0,this.actGroup.checkedVPManagePerm=(t.permission.vp&this.permVP.ManagePerm)>0,this.actGroup.checkedVPDelete=(t.permission.vp&this.permVP.DeleteVP)>0):(this.confirm="Add",this.actGroup._id=void 0,this.actGroup.name="",this.actGroup.global=!1,this.actGroup.checkedView=!0),this.log(`Init Group for Creation / Modification: ${this.actGroup.name} ID ${this.actGroup._id}`)}addModifyVCGroup(){const t=new kv;t.name=this.actGroup.name.trim(),t.global=this.actGroup.global,t.vcid=this.visbocenter._id,t.permission=new Vv,t.permission.vc=this.helperVCPerm(this.actGroup),t.permission.vp=this.helperVPPerm(this.actGroup),this.log(`Add/Modify VisboCenter Group: Group: ${t.name} New/Modify ${this.actGroup._id}`),this.actGroup._id?(this.log(`Modify VisboCenter Group: Group: ${t.name} VC: ${t.vcid} Perm: vc ${t.permission.vc} vp ${t.permission.vp}`),t._id=this.actGroup._id,this.visbocenterService.modifyVCGroup(t,!0).subscribe(e=>{this.vgGroups=this.vgGroups.filter(e=>e._id!==t._id),this.vgGroups.push(e);for(let i=0;i<this.vgUsers.length;i++)this.vgUsers[i].groupId===t._id&&(this.vgUsers[i].groupName=e.name);this.sortUserTable(),this.sortGroupTable(),this.alertService.success(`Group ${e.name} changed successfully`)},t=>{this.log("Modify VisboCenter Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Modify Group to Visbo Center"):(this.log("Error during add VC Group "+t.error.message),this.alertService.error(Lh(t)))})):(this.log(`Add VisboCenter Group: Group: ${t.name} VC: ${t.vcid} Perm: vc ${t.permission.vc} vp ${t.permission.vp}`),this.visbocenterService.addVCGroup(t,!0).subscribe(t=>{this.vgGroups.push(t),this.alertService.success(`Group ${t.name} added successfully`)},t=>{this.log("Add VisboCenter Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Add Group to Visbo Center"):(this.log("Error during add VC Group "+t.error.message),this.alertService.error(Lh(t)))}))}removeVCGroup(t){this.log(`Remove VisboCenter Group: ${t.name}/${t._id} VC: ${t.vcid}`),this.visbocenterService.deleteVCGroup(t,!0).subscribe(e=>{this.log("Remove VisboCenter Group result: "+JSON.stringify(e)),this.vgGroups=this.vgGroups.filter(e=>e!==t),this.vgUsers=this.vgUsers.filter(e=>e.groupId!==t._id),this.alertService.success(`Group ${t.name} removed successfully`)},t=>{this.log("Remove VisboCenter Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Remove Group from Visbo Center"):(this.log("Error during remove VC user "+t.error.message),this.alertService.error(Lh(t)))})}sortUserTable(t){this.vgUsers&&(void 0===t&&void 0!==this.sortUserColumn||(t!==this.sortUserColumn&&(this.sortUserColumn=t,this.sortUserAscending=void 0),this.sortUserAscending=void 0===this.sortUserAscending?1===t||2===t:!this.sortUserAscending),1===this.sortUserColumn?this.vgUsers.sort((function(t,e){return xh(t.email,e.email)})):2===this.sortUserColumn&&this.vgUsers.sort((function(t,e){return xh(t.groupName.toLowerCase(),e.groupName.toLowerCase())})),this.sortUserAscending||this.vgUsers.reverse())}sortGroupTable(t){this.vgGroups&&(void 0===t&&void 0!==this.sortGroupColumn||(t!==this.sortGroupColumn&&(this.sortGroupColumn=t,this.sortGroupAscending=void 0),this.sortGroupAscending=void 0===this.sortGroupAscending?1===t:!this.sortGroupAscending),1===this.sortGroupColumn?this.vgGroups.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortGroupColumn&&this.vgGroups.sort((function(t,e){return e.users.length-t.users.length})),this.sortGroupAscending||this.vgGroups.reverse())}log(t){this.messageService.add("Sys VisboCenter Details: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(xv),Rs(Fg),Rs(Xl),Rs(rf),Rs(Df))},t.\u0275cmp=le({type:t,selectors:[["app-sysvisbocenter-detail"]],inputs:{visbocenter:"visbocenter"},decls:2,vars:1,consts:[[4,"ngIf"],[3,"click"],[1,"form-group","row"],["for","vcName",1,"col-4","col-md-3","col-form-label"],["id","VCName","type","text","name","vcName","class","col-sm-8 form-control","placeholder","Name",3,"ngModel","ngModelChange",4,"ngIf"],["id","VCName","class","col-8 form-control-static",4,"ngIf"],["for","vcDescription",1,"col-4","col-md-3","col-form-label"],["id","VCDesc","name","vcDescription","class","col-8 form-control","placeholder","Type in your description",3,"ngModel","ngModelChange",4,"ngIf"],["id","VCDesc","class","col-8 form-control-static",4,"ngIf"],["for","Created",1,"col-4","col-md-3","col-form-label"],["id","VCCreated",1,"col","form-control-static","col-form-label"],["id","VCUpdated",1,"col","form-control-static","col-form-label"],[1,"btn-toolbar"],["id","ViewAudit","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewGroup","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewUser","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","Save","class","btn btn-primary mx-1",3,"click",4,"ngIf"],["id","Save",1,"btn","btn-secondary","mx-1",3,"click"],["id","DeleteVC","class","btn btn-md mx-1 bg-warning","style","float: right","title","Delete Visbo Center","data-toggle","modal","data-target","#VcDelete",4,"ngIf"],["id","DestroyVC","class","btn btn-md mx-1 bg-danger text-white","style","float: right","title","Destroy Visbo Center","data-toggle","modal","data-target","#VcDelete",4,"ngIf"],["id","VcUserModalCreate","tabindex","-1","role","dialog","aria-labelledby","VcUserModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VcUserModalCenterTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["name","newUserInvite","novalidate",""],["f","ngForm"],[1,"form-group",3,"ngClass"],["for","email",1,"col-form-label"],["id","AddUserName","type","email","name","email","required","","pattern","[^@\\s]+@[^@\\s]+\\.[^@\\s]+","autocomplete","email",1,"form-control",3,"ngModel","ngModelChange"],["email","ngModel"],["class","help-block",4,"ngIf"],["for","group",1,"col-form-label"],["id","AddUserGroupName","name","group","required","",1,"form-control",3,"ngModel","ngModelChange"],["group","ngModel"],[4,"ngFor","ngForOf"],["for","inviteMessage",1,"col-form-label"],["id","AddUserMessage","name","inviteMessage",1,"form-control",3,"ngModel","ngModelChange"],["inviteMessage","ngModel"],[1,"form-group"],["id","AddUserConfirm","type","submit","class","btn btn-primary mx-1",4,"ngIf"],["id","AddUserConfirm","type","submit","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-secondary","mx-1"],["id","VcUserRemove","tabindex","-1","role","dialog","aria-labelledby","VcUserModalRemoveTitle","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-dialog-centered","role","document",4,"ngIf"],["id","VcGroupModalCreate","tabindex","-1","role","dialog","aria-labelledby","VcGroupModalCreateTitle","aria-hidden","true",1,"modal","fade"],["id","VcGroupRemove","tabindex","-1","role","dialog","aria-labelledby","VcGroupModalRemoveTitle","aria-hidden","true",1,"modal","fade"],["id","VcDelete","tabindex","-1","role","dialog","aria-labelledby","Delete Visbo Center","aria-hidden","true",1,"modal","fade"],["id","VcDeleteTitle",1,"modal-title"],["class","bg-warning",4,"ngIf"],["class","bg-danger text-white",4,"ngIf"],[1,"col-form-label"],[1,"col-8","form-control-static"],["for","VcDescription",1,"col-form-label"],["for","VcProjects",1,"col-form-label"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary","mx-1"],["id","DeleteVCConfirm","type","button","class","btn btn-warning text-white mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","DeleteVCConfirm","type","button","class","btn btn-danger text-white mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["class","modal fade","id","VCUserDetail","tabindex","-1","role","dialog","aria-labelledby","VCUserDetailTitle","aria-hidden","true",4,"ngIf"],["id","VCName","type","text","name","vcName","placeholder","Name",1,"col-sm-8","form-control",3,"ngModel","ngModelChange"],["id","VCName",1,"col-8","form-control-static"],["id","VCDesc","name","vcDescription","placeholder","Type in your description",1,"col-8","form-control",3,"ngModel","ngModelChange"],["id","VCDesc",1,"col-8","form-control-static"],["id","ViewAudit","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],["id","ViewGroup","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],["id","ViewUser","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],[1,"row"],[1,"col"],[1,"panel-heading"],["class","col",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover"],["id","UserHead"],["id","UserList"],["id","AddUser","type","button","data-toggle","modal","data-target","#VcUserModalCreate",1,"btn","btn-primary","float-right","my-1"],["id","ColUser","data-toggle","modal","data-target","#VCUserDetail",3,"click"],["id","ColGroup"],["id","ColDeleteUser","title","Remove User","data-toggle","modal","data-target","#VcUserRemove",1,"Detail",3,"click"],["id","GroupHead"],["id","GroupList"],["id","ColGroup","data-toggle","modal","data-target","#VcGroupModalCreate",3,"click"],["id","ColMembers"],["id","ColGlobal",4,"ngIf"],["id","ColDetail","title","Detail of Group","data-toggle","modal","data-target","#VcGroupModalCreate",1,"Detail",3,"click"],["id","ColGlobal"],["id","ColDeleteGroup","title","Remove Group","data-toggle","modal","data-target","#VcGroupRemove",1,"Detail",3,"click"],["id","Save",1,"btn","btn-primary","mx-1",3,"click"],["id","DeleteVC","title","Delete Visbo Center","data-toggle","modal","data-target","#VcDelete",1,"btn","btn-md","mx-1","bg-warning",2,"float","right"],["id","DestroyVC","title","Destroy Visbo Center","data-toggle","modal","data-target","#VcDelete",1,"btn","btn-md","mx-1","bg-danger","text-white",2,"float","right"],[1,"help-block"],["id","AddUserConfirm","type","submit",1,"btn","btn-primary","mx-1"],["id","AddUserConfirm","type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["id","VcUserRemoveTitle",1,"modal-title"],[1,"bg-warning"],["id","DeleteUserConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning","mx-1",3,"click"],["class","modal-title","id","VcGroupModalCenterTitle",4,"ngIf"],["name","actGroup","novalidate",""],["for","name",1,"col-form-label"],["id","AddGroupName","type","text","name","name","required","",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","perm1","name","checkedView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedView","ngModel"],["for","perm1",1,"custom-control-label"],["type","checkbox","id","perm2","name","checkedViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedViewAudit","ngModel"],["for","perm2",1,"custom-control-label"],["type","checkbox","id","perm3","name","checkedModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedModify","ngModel"],["for","perm3",1,"custom-control-label"],["type","checkbox","id","perm4","name","checkedCreateVP",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVP","ngModel"],["for","perm4",1,"custom-control-label"],["type","checkbox","id","perm5","name","checkedManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedManagePerm","ngModel"],["for","perm5",1,"custom-control-label"],["type","checkbox","id","global","name","global",1,"custom-control-input",3,"ngModel","ngModelChange"],["global","ngModel"],["for","global",1,"custom-control-label"],["class","mt-2",4,"ngIf"],[1,"form-group","mt-2"],["id","AddGroupConfirm","type","submit","class","btn btn-primary disabled mx-1",4,"ngIf"],["id","AddGroupConfirm","type","submit","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","VcGroupModalCenterTitle",1,"modal-title"],["type","checkbox","id","permVP1","name","checkedVPView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPView","ngModel"],["for","permVP1",1,"custom-control-label"],["type","checkbox","id","permVP2","name","checkedVPViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPViewAudit","ngModel"],["for","permVP2",1,"custom-control-label"],["type","checkbox","id","permVP3","name","checkedVPModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPModify","ngModel"],["for","permVP3",1,"custom-control-label"],["type","checkbox","id","permVP4","name","checkedCreateVariant",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVariant","ngModel"],["for","permVP4",1,"custom-control-label"],["type","checkbox","id","permVP5","name","checkedVPManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPManagePerm","ngModel"],["for","permVP5",1,"custom-control-label"],["type","checkbox","id","permVP6","name","checkedVPDelete",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPDelete","ngModel"],["for","permVP6",1,"custom-control-label"],[1,"mt-2"],[1,"form-control-static"],["class","row",4,"ngFor","ngForOf"],["class","col-8 ml-3",4,"ngIf"],[1,"col-8","ml-3"],["data-dismiss","modal",3,"click"],["id","AddGroupConfirm","type","submit",1,"btn","btn-primary","disabled","mx-1"],["id","AddGroupConfirm","type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["id","DeleteGroupConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning","mx-1",3,"click"],[1,"bg-danger","text-white"],["id","DeleteVCConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning","text-white","mx-1",3,"click"],["id","DeleteVCConfirm","type","button","data-dismiss","modal",1,"btn","btn-danger","text-white","mx-1",3,"click"],["id","VCUserDetail","tabindex","-1","role","dialog","aria-labelledby","VCUserDetailTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],["id","VCUserDetailTitle",1,"modal-title"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],[1,"form-control-static","mt-2"],["id","ButtonBack","data-dismiss","modal",1,"btn","btn-primary"],["type","checkbox","checked","","disabled","","id","perm1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"]],template:function(t,e){1&t&&(Bs(0,"app-sysnavbar"),Gs(1,kU,117,53,"div",0)),2&t&&(_n(1),js("ngIf",e.visbocenter))},directives:[gC,jc,Ou,Fd,Tu,Oc,Od,Ru,Hu,Nd,Eu,cu,du,gu,Lc,_d],pipes:[Kc,qc],styles:[""]}),t})();function MU(t,e){1&t&&(Ns(0,"h2"),mo(1," Projects "),Fs())}function SU(t,e){if(1&t){const t=zs();Ns(0,"h2"),mo(1," Projects in: "),Ns(2,"a",15),Js("click",(function(){ei(t);const e=Xs();return e.gotoVCDetail(e.vcActive)})),mo(3),Fs(),Fs()}if(2&t){const t=Xs();_n(3),fo(t.vcActive.name)}}function IU(t,e){if(1&t&&(Ns(0,"td",24),mo(1),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(t.vc.name)}}function xU(t,e){1&t&&Bs(0,"td",24)}function TU(t,e){if(1&t){const t=zs();Ns(0,"tr",15),Js("click",(function(){ei(t);const i=e.$implicit;return Xs().gotoClickedRow(i)})),Ns(1,"td",7),mo(2),Fs(),Ns(3,"td",16),Js("click",(function(){ei(t);const i=e.$implicit;return Xs().gotoDetail(i)})),Ns(4,"a"),mo(5),Fs(),Fs(),Ns(6,"td",17),mo(7),Fs(),Ns(8,"td",18),mo(9),Ua(10,"date"),Fs(),Ns(11,"td",19),mo(12),Ua(13,"date"),Fs(),Ns(14,"td",20),mo(15),Fs(),Gs(16,IU,2,1,"td",21),Gs(17,xU,1,0,"td",21),Ns(18,"td",22),Ns(19,"button",23),Js("click",(function(){ei(t);const i=e.$implicit;return Xs().gotoDetail(i)})),mo(20,"i"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit,i=e.index,n=Xs();_n(2),fo(i+1),_n(3),fo(t.name),_n(2),fo(n.getVPType(t.vpType)),_n(2),fo(Oa(10,8,t.updatedAt,"dd.MM.yyyy HH:mm")),_n(3),fo(Oa(13,11,t.updatedAt,"dd.MM.yy")),_n(3),fo(t.vpvCount),_n(1),js("ngIf",t.vc),_n(1),js("ngIf",!t.vc)}}let _U=(()=>{class t{constructor(t,e,i,n,r,s,o){this.messageService=t,this.alertService=e,this.visboprojectService=i,this.visbocenterService=n,this.route=r,this.router=s,this.translate=o,this.combinedPerm=void 0,this.permVC=Av,this.permVP=Pv}ngOnInit(){this.getVisboProjects(),this.combinedPerm=this.visbocenterService.getSysAdminRole()}getVisboProjects(){this.log("VP getSysVisboProjects SysAdminRole "+JSON.stringify(this.combinedPerm));const t=this.route.snapshot.paramMap.get("id");this.vcSelected=t,t?this.visbocenterService.getVisboCenter(t,!0).subscribe(e=>{this.vcActive=e,this.combinedPerm=e.perm,this.log(`Get VisboProject for VC ${t} Perm ${JSON.stringify(this.combinedPerm)}`),this.combinedPerm.vp&this.permVP.View?this.visboprojectService.getVisboProjects(t,!0).subscribe(t=>{this.visboprojects=t,this.sortVPTable(1)},t=>{this.log(`get VPs failed: error:  ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))}):this.visboprojects=[]},t=>{this.log(`get VC failed: error:  ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))}):(this.vcSelected=null,this.vcActive=null,this.visboprojectService.getVisboProjects(null,!0).subscribe(t=>{this.visboprojects=t,this.sortVPTable(1)},t=>{this.log(`get VPs all failed: error:  ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))}))}getVPType(t){return this.translate.instant("vp.type.vpType"+t)}gotoClickedRow(t){this.log("clicked row "+t.name)}gotoDetail(t){this.router.navigate(["sysvpDetail/".concat(t._id)])}gotoVCDetail(t){this.router.navigate(["sysvcDetail/".concat(t._id)])}sortVPTable(t){this.visboprojects&&(void 0!==t&&(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t||3===t:!this.sortAscending),1===this.sortColumn?this.visboprojects.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortColumn?this.visboprojects.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})):3===this.sortColumn?this.visboprojects.sort((function(t,e){return xh(t.vc.name.toLowerCase(),e.vc.name.toLowerCase())})):4===this.sortColumn&&this.visboprojects.sort((function(t,e){return t.vpvCount-e.vpvCount})),this.sortAscending||this.visboprojects.reverse())}log(t){this.messageService.add("VisboProject: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(Df),Rs(fb),Rs(xv),Rs(Fg),Rs(rf),Rs(ov))},t.\u0275cmp=le({type:t,selectors:[["app-sysvisboprojects"]],decls:26,vars:3,consts:[[1,"well"],[1,"row"],[1,"col"],[4,"ngIf"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],["id","VPHead"],[1,"d-none","d-md-table-cell"],["id","SortName",3,"click"],["id","SortType"],["id","SortDate",1,"d-none","d-sm-table-cell",3,"click"],["id","SortVersions",1,"d-none","d-md-table-cell",3,"click"],["id","SortVC",1,"d-none","d-lg-table-cell",3,"click"],["id","VPList"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["id","ColName",3,"click"],["id","ColType",1,"d-none","d-md-table-cell"],["id","ColDate",1,"d-none","d-lg-table-cell"],["id","ColDate",1,"d-none","d-md-table-cell","d-lg-none"],["id","ColVersions",1,"d-none","d-md-table-cell"],["id","ColVC","class","d-none d-lg-table-cell",4,"ngIf"],["id","ColDetail"],["title","Detail of Visbo Project",1,"Detail",3,"click"],["id","ColVC",1,"d-none","d-lg-table-cell"]],template:function(t,e){1&t&&(Bs(0,"app-sysnavbar"),Ns(1,"div",0),Ns(2,"div",1),Ns(3,"div",2),Gs(4,MU,2,0,"h2",3),Gs(5,SU,4,1,"h2",3),Fs(),Fs(),Ns(6,"div",4),Ns(7,"table",5),Ns(8,"thead",6),Ns(9,"tr"),Ns(10,"th",7),mo(11,"Nr."),Fs(),Ns(12,"th",8),Js("click",(function(){return e.sortVPTable(1)})),mo(13,"Name"),Fs(),Ns(14,"th",9),mo(15,"Type"),Fs(),Ns(16,"th",10),Js("click",(function(){return e.sortVPTable(2)})),mo(17,"Modified"),Fs(),Ns(18,"th",11),Js("click",(function(){return e.sortVPTable(4)})),mo(19,"# Versions"),Fs(),Ns(20,"th",12),Js("click",(function(){return e.sortVPTable(3)})),mo(21,"Visbo Center"),Fs(),Ns(22,"th"),mo(23,"Info"),Fs(),Fs(),Fs(),Ns(24,"tbody",13),Gs(25,TU,21,14,"tr",14),Fs(),Fs(),Fs(),Fs()),2&t&&(_n(4),js("ngIf",!e.vcActive),_n(1),js("ngIf",e.vcActive),_n(20),js("ngForOf",e.visboprojects))},directives:[gC,jc,Lc],pipes:[qc],encapsulation:2}),t})();function UU(t,e){if(1&t){const t=zs();Ns(0,"button",17),Js("click",(function(){ei(t);const e=Xs(2);return e.gotoVPAudit(e.visboproject)})),mo(1,"View Audit"),Fs()}}function EU(t,e){if(1&t){const t=zs();Ns(0,"button",18),Js("click",(function(){return ei(t),Xs(2).toggleUserGroup()})),mo(1,"Show Groups"),Fs()}}function OU(t,e){if(1&t){const t=zs();Ns(0,"button",19),Js("click",(function(){return ei(t),Xs(2).toggleUserGroup()})),mo(1,"Show Users"),Fs()}}function GU(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td"),mo(2),Fs(),Ns(3,"td",28),Js("click",(function(){ei(t);const i=e.index;return Xs(3).calcCombinedPerm(i)})),mo(4),Fs(),Ns(5,"td",29),mo(6),Fs(),Fs()}if(2&t){const t=e.$implicit,i=e.index;_n(2),fo(i+1),_n(2),fo(t.email),_n(2),fo(t.groupName)}}function LU(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div"),Ns(2,"div",20),Ns(3,"div",21),Ns(4,"h5",22),mo(5," Visbo Project Users "),Fs(),Fs(),Fs(),Ns(6,"div",23),Ns(7,"table",24),Ns(8,"thead",25),Ns(9,"tr"),Ns(10,"th"),mo(11,"Nr."),Fs(),Ns(12,"th",2),Js("click",(function(){return ei(t),Xs(2).sortUserTable(1)})),mo(13,"e-mail"),Fs(),Ns(14,"th",2),Js("click",(function(){return ei(t),Xs(2).sortUserTable(2)})),mo(15,"Group"),Fs(),Fs(),Fs(),Ns(16,"tbody",26),Gs(17,GU,7,3,"tr",27),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(17),js("ngForOf",t.vgUsers)}}function RU(t,e){1&t&&(Ns(0,"td",35),mo(1,"Global"),Fs())}function jU(t,e){1&t&&Bs(0,"td",35)}function $U(t,e){if(1&t){const t=zs();Ns(0,"tr"),Ns(1,"td"),mo(2),Fs(),Ns(3,"td",29),mo(4),Fs(),Ns(5,"td",32),mo(6),Fs(),Gs(7,RU,2,0,"td",33),Gs(8,jU,1,0,"td",33),Ns(9,"td"),Ns(10,"button",34),Js("click",(function(){ei(t);const i=e.$implicit;return Xs(3).initGroup(i)})),mo(11,"i"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit,i=e.index;_n(2),fo(i+1),_n(2),fo(t.name),_n(2),fo(t.users.length),_n(1),js("ngIf",t.global),_n(1),js("ngIf",!t.global)}}function NU(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div"),Ns(2,"div",20),Ns(3,"div",21),Ns(4,"h5",22),mo(5," Visbo Project Groups "),Fs(),Fs(),Fs(),Ns(6,"div",23),Ns(7,"table",24),Ns(8,"thead",30),Ns(9,"tr"),Ns(10,"th"),mo(11,"Nr."),Fs(),Ns(12,"th",2),Js("click",(function(){return ei(t),Xs(2).sortGroupTable(1)})),mo(13,"Group"),Fs(),Ns(14,"th",2),Js("click",(function(){return ei(t),Xs(2).sortGroupTable(2)})),mo(15,"Members"),Fs(),Ns(16,"th"),mo(17,"Flag"),Fs(),Ns(18,"th"),mo(19,"Info"),Fs(),Fs(),Fs(),Ns(20,"tbody",31),Gs(21,$U,12,5,"tr",27),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(21),js("ngForOf",t.vgGroups)}}function FU(t,e){1&t&&(Ns(0,"h5",73),mo(1,"Modify a Group in the Visbo Center"),Fs())}function BU(t,e){1&t&&(Ns(0,"h5",73),mo(1,"Add a new Group to the Visbo Center"),Fs())}function HU(t,e){1&t&&(Ns(0,"div",74),mo(1,"Group Name is required"),Fs())}function KU(t,e){if(1&t){const t=zs();Ns(0,"div",79),Ns(1,"a",80),Js("click",(function(){return ei(t),Xs(5).toggleUserGroup()})),mo(2),Fs(),Fs()}if(2&t){const t=Xs().$implicit;_n(2),fo(t.email)}}function qU(t,e){if(1&t&&(Hs(0,20),Gs(1,KU,3,1,"div",78),Ks()),2&t){const t=e.$implicit,i=Xs(4);_n(1),js("ngIf",t.groupName==i.actGroup.name)}}function zU(t,e){if(1&t&&(Ns(0,"div",75),Ns(1,"label",76),mo(2,"Group Members"),Fs(),Gs(3,qU,2,1,"ng-container",77),Fs()),2&t){const t=Xs(3);_n(3),js("ngForOf",t.vgUsers)}}function QU(t,e){1&t&&(Ns(0,"div",75),Ns(1,"label",76),mo(2,"No Group Members"),Fs(),Fs())}const WU=function(t){return{"has-error":t}};function JU(t,e){if(1&t){const t=zs();Ns(0,"div",36),Ns(1,"div",37),Ns(2,"div",38),Ns(3,"div",39),Gs(4,FU,2,0,"h5",40),Gs(5,BU,2,0,"h5",40),Ns(6,"button",41),Ns(7,"span",42),mo(8,"\xd7"),Fs(),Fs(),Fs(),Ns(9,"div",43),Ns(10,"form",44,45),Ns(12,"div",46),Ns(13,"label",47),mo(14,"Name:"),Fs(),Ns(15,"input",48,49),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.name=e})),Fs(),Gs(17,HU,2,0,"div",50),Fs(),Ns(18,"div"),Ns(19,"div"),mo(20,"Define Visbo Project Permission"),Fs(),Ns(21,"div",51),Ns(22,"input",52,53),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedVPView=e})),Fs(),Ns(24,"label",54),mo(25,"View Visbo Project"),Fs(),Fs(),Ns(26,"div",51),Ns(27,"input",55,56),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedVPViewAudit=e})),Fs(),Ns(29,"label",57),mo(30,"View Project Audit"),Fs(),Fs(),Ns(31,"div",51),Ns(32,"input",58,59),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedVPModify=e})),Fs(),Ns(34,"label",60),mo(35,"Modify Visbo Project"),Fs(),Fs(),Ns(36,"div",51),Ns(37,"input",61,62),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedCreateVariant=e})),Fs(),Ns(39,"label",63),mo(40,"Create Visbo Project Variant"),Fs(),Fs(),Ns(41,"div",51),Ns(42,"input",64,65),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedVPManagePerm=e})),Fs(),Ns(44,"label",66),mo(45,"Manage Permissions, Users and Groups"),Fs(),Fs(),Ns(46,"div",51),Ns(47,"input",67,68),Js("ngModelChange",(function(e){return ei(t),Xs(2).actGroup.checkedVPDelete=e})),Fs(),Ns(49,"label",69),mo(50,"Delete Visbo Project"),Fs(),Fs(),Fs(),Gs(51,zU,4,1,"div",70),Gs(52,QU,3,0,"div",70),Ns(53,"div",71),Ns(54,"button",72),mo(55,"Cancel"),Fs(),Fs(),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Ls(11),e=Ls(16),i=Xs(2);_n(4),js("ngIf",i.actGroup._id),_n(1),js("ngIf",!i.actGroup._id),_n(7),js("ngClass",ka(13,WU,t.submitted&&!e.valid)),_n(3),js("ngModel",i.actGroup.name),_n(2),js("ngIf",t.submitted&&!e.valid),_n(5),js("ngModel",i.actGroup.checkedVPView),_n(5),js("ngModel",i.actGroup.checkedVPViewAudit),_n(5),js("ngModel",i.actGroup.checkedVPModify),_n(5),js("ngModel",i.actGroup.checkedCreateVariant),_n(5),js("ngModel",i.actGroup.checkedVPManagePerm),_n(5),js("ngModel",i.actGroup.checkedVPDelete),_n(4),js("ngIf",i.helperUsersPerGroup(i.actGroup.name)),_n(1),js("ngIf",!i.helperUsersPerGroup(i.actGroup.name))}}function YU(t,e){1&t&&Bs(0,"input",99)}function ZU(t,e){1&t&&Bs(0,"input",100)}function XU(t,e){1&t&&Bs(0,"input",101)}function tE(t,e){1&t&&Bs(0,"input",102)}function eE(t,e){1&t&&Bs(0,"input",103)}function iE(t,e){1&t&&Bs(0,"input",104)}function nE(t,e){1&t&&Bs(0,"input",105)}function rE(t,e){1&t&&Bs(0,"input",106)}function sE(t,e){1&t&&Bs(0,"input",107)}function oE(t,e){1&t&&Bs(0,"input",108)}function aE(t,e){1&t&&Bs(0,"input",109)}function lE(t,e){1&t&&Bs(0,"input",110)}function cE(t,e){if(1&t){const t=zs();Ns(0,"div",79),Ns(1,"a",80),Js("click",(function(){return ei(t),Xs(4).toggleUserGroup()})),mo(2),Fs(),Fs()}if(2&t){const t=Xs().$implicit;_n(2),fo(t.groupName)}}function dE(t,e){if(1&t&&(Hs(0,20),Gs(1,cE,3,1,"div",78),Ks()),2&t){const t=e.$implicit,i=Xs(3);_n(1),js("ngIf",t.email==i.vgUsers[i.userIndex].email)}}function uE(t,e){if(1&t&&(Ns(0,"div",81),Ns(1,"div",82),Ns(2,"div",38),Ns(3,"div",39),Ns(4,"h5",83),mo(5),Fs(),Ns(6,"button",41),Ns(7,"span",42),mo(8,"\xd7"),Fs(),Fs(),Fs(),Ns(9,"div",43),Ns(10,"div"),mo(11,"Visbo Project Permission for User"),Fs(),Ns(12,"div",51),Gs(13,YU,1,0,"input",84),Gs(14,ZU,1,0,"input",85),Ns(15,"label",54),mo(16,"View Visbo Project"),Fs(),Fs(),Ns(17,"div",51),Gs(18,XU,1,0,"input",86),Gs(19,tE,1,0,"input",87),Ns(20,"label",57),mo(21,"View Project Audit"),Fs(),Fs(),Ns(22,"div",51),Gs(23,eE,1,0,"input",88),Gs(24,iE,1,0,"input",89),Ns(25,"label",60),mo(26,"Modify Visbo Project"),Fs(),Fs(),Ns(27,"div",51),Gs(28,nE,1,0,"input",90),Gs(29,rE,1,0,"input",91),Ns(30,"label",63),mo(31,"Create Visbo Project Variant"),Fs(),Fs(),Ns(32,"div",51),Gs(33,sE,1,0,"input",92),Gs(34,oE,1,0,"input",93),Ns(35,"label",66),mo(36,"Manage Permissions, Users and Groups"),Fs(),Fs(),Ns(37,"div",51),Gs(38,aE,1,0,"input",94),Gs(39,lE,1,0,"input",95),Ns(40,"label",69),mo(41,"Delete Visbo Project"),Fs(),Fs(),Ns(42,"label",96),mo(43,"Group Member Ship"),Fs(),Gs(44,dE,2,1,"ng-container",77),Ns(45,"div",97),Ns(46,"button",98),mo(47,"Close"),Fs(),Fs(),Fs(),Fs(),Fs(),Fs()),2&t){const t=Xs(2);_n(5),vo("Permission for ",t.vgUsers[t.userIndex].email,""),_n(8),js("ngIf",t.hasUserVPPerm(t.permVP.View)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.View)),_n(4),js("ngIf",t.hasUserVPPerm(t.permVP.ViewAudit)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.ViewAudit)),_n(4),js("ngIf",t.hasUserVPPerm(t.permVP.Modify)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.Modify)),_n(4),js("ngIf",t.hasUserVPPerm(t.permVP.CreateVariant)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.CreateVariant)),_n(4),js("ngIf",t.hasUserVPPerm(t.permVP.ManagePerm)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.ManagePerm)),_n(4),js("ngIf",t.hasUserVPPerm(t.permVP.DeleteVP)),_n(1),js("ngIf",!t.hasUserVPPerm(t.permVP.DeleteVP)),_n(5),js("ngForOf",t.vgUsers)}}function hE(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div",1),Ns(2,"h3"),mo(3,"Project: "),Ns(4,"a",2),Js("click",(function(){ei(t);const e=Xs();return e.gotoVPList(e.visboproject)})),mo(5),Ua(6,"uppercase"),Fs(),Fs(),Ns(7,"h5"),mo(8,"Visbo Center: "),Ns(9,"a",2),Js("click",(function(){ei(t);const e=Xs();return e.gotoVCDetail(e.visboproject)})),mo(10),Fs(),Fs(),Ns(11,"form"),Ns(12,"div",3),Ns(13,"label",4),mo(14,"Name:"),Fs(),Ns(15,"label",5),mo(16),Fs(),Fs(),Ns(17,"div",3),Ns(18,"label",6),mo(19,"Description:"),Fs(),Ns(20,"label",7),mo(21),Fs(),Fs(),Ns(22,"div",3),Ns(23,"label",8),mo(24,"Created / Updated at:"),Fs(),Ns(25,"label",9),mo(26),Ua(27,"date"),Fs(),Ns(28,"label",10),mo(29),Ua(30,"date"),Fs(),Fs(),Fs(),Ns(31,"div",11),Gs(32,UU,2,0,"button",12),Gs(33,EU,2,0,"button",13),Gs(34,OU,2,0,"button",14),Fs(),Gs(35,LU,18,1,"div",0),Gs(36,NU,22,1,"div",0),Fs(),Gs(37,JU,56,15,"div",15),Gs(38,uE,48,14,"div",16),Fs()}if(2&t){const t=Xs();_n(5),fo(Ea(6,13,t.visboproject.name)),_n(5),fo(t.visboproject.vc.name),_n(6),vo("",t.visboproject.name," "),_n(5),vo("",t.visboproject.description," "),_n(5),vo("",Oa(27,15,t.visboproject.createdAt,"dd.MM.yyyy HH:mm:ss")," "),_n(3),vo("",Oa(30,18,t.visboproject.updatedAt,"dd.MM.yyyy HH:mm:ss")," "),_n(3),js("ngIf",t.hasVPPerm(t.permVP.ViewAudit)),_n(1),js("ngIf",!t.showGroups),_n(1),js("ngIf",t.showGroups),_n(1),js("ngIf",!t.showGroups),_n(1),js("ngIf",t.showGroups),_n(1),js("ngIf",t.actGroup),_n(1),js("ngIf",t.vgUsers&&t.userIndex>=0)}}let pE=(()=>{class t{constructor(t,e,i,n,r,s,o){this.messageService=t,this.visbocenterService=e,this.route=i,this.visboprojectService=n,this.location=r,this.alertService=s,this.router=o,this.newUserInvite=new Yh,this.permSystem=wv,this.permVC=Av,this.permVP=Pv,this.deleted=!1,this.sortUserColumn=1,this.sortUserAscending=!0,this.sortGroupColumn=1,this.sortGroupAscending=!0}ngOnInit(){this.combinedPerm=this.visbocenterService.getSysAdminRole(),this.getVisboProject(),this.getVisboProjectUsers(),this.log("SysAdmin Role: "+JSON.stringify(this.combinedPerm))}getVisboProject(){const t=this.route.snapshot.paramMap.get("id");this.log("VisboProject Detail of: "+t),this.visboprojectService.getVisboProject(t,!0).subscribe(e=>{this.visboproject=e,this.combinedPerm=e.perm,this.log(`Get VisboProject ${t} Perm ${JSON.stringify(this.combinedPerm)}`)},t=>{this.log(`get VPs failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}gotoVPAudit(t){this.log(`GoTo VP Audit ${t.name} ${this.visboproject.name}`),this.router.navigate(["vpAudit/".concat(t._id)],{queryParams:{sysadmin:1}})}hasSystemPerm(t){return(this.combinedPerm.system&t)>0}hasVCPerm(t){return(this.combinedPerm.vc&t)>0}hasVPPerm(t){return(this.combinedPerm.vp&t)>0}hasUserVPPerm(t){return void 0!==this.combinedUserPerm&&(this.log(`Has User VP Permission ${t}? ${(this.combinedUserPerm.vp&t)>0} `),(this.combinedUserPerm.vp&t)>0)}toggleUserGroup(){this.showGroups=!this.showGroups}getVisboProjectUsers(){const t=this.route.snapshot.paramMap.get("id");this.log("VisboProject UserList of: "+t),this.visboprojectService.getVPUsers(t,!0).subscribe(t=>{this.vgUsers=t.users,this.vgGroups=t.groups,this.log(`fetched Users ${this.vgUsers.length}, Groups ${this.vgGroups.length}`),this.sortUserTable(),this.sortGroupTable()},t=>{this.log(`Get VP Users failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(403===t.status?"Permission Denied":Lh(t))})}goBack(){this.location.back()}delete(t){this.visboprojectService.deleteVisboProject(t).subscribe(()=>{this.goBack()},e=>{this.log(`delete VP failed: error: ${e.status} message: ${e.error.message}`),this.alertService.error(403===e.status?"Permission Denied: Visbo Project "+t.name:Lh(e))})}gotoVCDetail(t){this.router.navigate(["sysvcDetail/".concat(t.vcid)])}gotoVPList(t){this.router.navigate(["sysvp/".concat(t.vcid)])}save(){this.visboprojectService.updateVisboProject(this.visboproject).subscribe(t=>{this.alertService.success(`Visbo Project ${t.name} updated successfully`,!0),this.goBack()},t=>{this.log(`save VP failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(403===t.status?"Permission Denied: Visbo Project "+this.visboproject.name:409===t.status?`Visbo Project ${this.visboproject.name} exists already`:Lh(t))})}addNewVPUser(){const t=this.newUserInvite.email.trim(),e=this.newUserInvite.groupName.trim(),i=this.vgGroups.filter(t=>t.name===e)[0],n=i._id,r=this.visboproject._id;let s="";this.newUserInvite.inviteMessage&&(s=this.newUserInvite.inviteMessage.trim()),this.log(`Add VisboProject User: ${t} Group: ${e}/${n} VP: ${r}`),t&&n&&this.visboprojectService.addVPUser(t,n,s,r,!0).subscribe(e=>{const n=new Mv;n.userId=e.users.filter(e=>e.email===t)[0].userId,n.email=t,n.groupId=e._id,n.groupName=e.name,n.groupType=i.groupType,n.internal=i.internal,this.log("Add VisboCenter User Push: "+JSON.stringify(n)),this.vgUsers.push(n),this.sortUserTable();for(let t=0;t<this.vgGroups.length;t++)if(this.vgGroups[t]._id===e._id){this.vgGroups[t]=e;break}this.alertService.success(`User ${t} added successfully`)},t=>{this.log("Add VisboProject User error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Add User to Visbo Project"):(this.log("Error during add VP user "+t.error.message),this.alertService.error(Lh(t)))})}calcCombinedPerm(t){this.userIndex=t,this.combinedUserPerm={system:0,vc:0,vp:0},this.vgUsers.forEach(this.addUserPerm,this),this.log(`Combined Permission for ${this.vgUsers[t].email}  ${JSON.stringify(this.combinedUserPerm)}`)}addUserPerm(t){if(t.email!==this.vgUsers[this.userIndex].email)return;this.log("Add User Permission for "+t.groupName);const e=this.vgGroups.findIndex(e=>e.name===t.groupName);e>=0?this.vgGroups[e].permission?this.combinedUserPerm.vp=this.combinedUserPerm.vp|(this.vgGroups[e].permission.vp||0):this.log("Permission for Group not set "+t.groupName):this.log("Group not found "+t.groupName)}helperRemoveUser(t){this.userIndex=t}helperRemoveGroup(t){this.groupIndex=t}helperUsersPerGroup(t){const e=this.vgGroups&&this.vgGroups.find(e=>e.name===t);return e?e.users.length:0}removeVPUser(t,e){this.log(`Remove VisboProject User: ${t.email}/${t.userId} Group: ${t.groupName} VP: ${e}`),this.visboprojectService.deleteVPUser(t,e,!0).subscribe(()=>{this.vgUsers=this.vgUsers.filter(e=>e!==t);for(let e=0;e<this.vgGroups.length;e++)if(this.vgGroups[e]._id===t.groupId){for(let i=0;i<this.vgGroups[e].users.length;i++)if(this.vgGroups[e].users[i].userId===t.userId){this.vgGroups[e].users.splice(i,1);break}break}this.alertService.success(`User ${t.email} removed successfully`)},t=>{this.log("Remove VisboProject User error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Remove User from Visbo Project"):(this.log("Error during remove User from VP user "+t.error.message),this.alertService.error(Lh(t)))})}helperVPPerm(t){let e=0;return t.checkedVPView&&(e+=this.permVP.View),t.checkedVPViewAudit&&(e+=this.permVP.ViewAudit),t.checkedVPModify&&(e+=this.permVP.Modify),t.checkedCreateVariant&&(e+=this.permVP.CreateVariant),t.checkedVPManagePerm&&(e+=this.permVP.ManagePerm),t.checkedVPDelete&&(e+=this.permVP.DeleteVP),e}initGroup(t){this.actGroup=new Dv,t?(this.confirm="VP"===t.groupType?"Modify":"View",this.actGroup._id=t._id,this.log(`Init Group Set GroupID : ${this.actGroup._id} ID ${t._id}`),this.actGroup.name=t.name,this.actGroup.groupType=t.groupType,this.actGroup.internal=t.internal,this.actGroup.global=t.global,this.actGroup.checkedView=(t.permission.vc&this.permVC.View)>0,this.actGroup.checkedViewAudit=(t.permission.vc&this.permVC.ViewAudit)>0,this.actGroup.checkedModify=(t.permission.vc&this.permVC.Modify)>0,this.actGroup.checkedCreateVP=(t.permission.vc&this.permVC.CreateVP)>0,this.actGroup.checkedManagePerm=(t.permission.vc&this.permVC.ManagePerm)>0,this.actGroup.checkedVPView=(t.permission.vp&this.permVP.View)>0,this.actGroup.checkedVPViewAudit=(t.permission.vp&this.permVP.ViewAudit)>0,this.actGroup.checkedVPModify=(t.permission.vp&this.permVP.Modify)>0,this.actGroup.checkedCreateVariant=(t.permission.vp&this.permVP.CreateVariant)>0,this.actGroup.checkedVPManagePerm=(t.permission.vp&this.permVP.ManagePerm)>0,this.actGroup.checkedVPDelete=(t.permission.vp&this.permVP.DeleteVP)>0):(this.confirm="Add",this.actGroup._id=void 0,this.actGroup.name="",this.actGroup.groupType="VP",this.actGroup.internal=!1,this.actGroup.global=!1,this.actGroup.checkedView=!0),this.log(`Init Group for Creation / Modification: ${this.actGroup.name} ID ${this.actGroup._id} Action ${this.confirm} `)}addModifyVPGroup(){const t=new kv;this.log(`Modify VisboProject Group: Group: ${this.actGroup.name} VC: ${this.visboproject.vcid} VP: ${this.visboproject._id} }`),t.name=this.actGroup.name.trim(),t.global=!1,t.vcid=this.visboproject.vcid,t.vpids=[],t.vpids.push(this.visboproject._id),t.permission=new Vv,t.permission.vp=this.helperVPPerm(this.actGroup),this.actGroup._id?(this.log(`Modify VisboProject Group: Group: ${t.name} VC: ${t.vcid} Perm: ${JSON.stringify(t.permission)}`),t._id=this.actGroup._id,this.visboprojectService.modifyVPGroup(t).subscribe(e=>{this.log("Modify VisboProject Group Push: "+JSON.stringify(e)),this.vgGroups=this.vgGroups.filter(e=>e._id!==t._id),this.vgGroups.push(e);for(let i=0;i<this.vgUsers.length;i++)this.vgUsers[i].groupId===t._id&&(this.vgUsers[i].groupName=e.name);this.sortUserTable(),this.sortGroupTable(),this.alertService.success(`Group ${e.name} changed successfully`)},t=>{this.log("Modify VisboProject Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Modify Group to Visbo Project"):(this.log("Error during modify VP Group "+t.error.message),this.alertService.error(Lh(t)))})):(this.log(`Add VisboCenter Group: Group: ${t.name} VP: ${t.vpids[0]} Perm: ${JSON.stringify(t.permission)}`),this.visboprojectService.addVPGroup(t).subscribe(t=>{this.vgGroups.push(t),this.alertService.success(`Group ${t.name} added successfully`)},t=>{this.log("Add VisboCenter Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Add Group to Visbo Center"):(this.log("Error during add VC Group "+t.error.message),this.alertService.error(Lh(t)))}))}sortUserTable(t){this.vgUsers&&(void 0===t&&void 0!==this.sortUserColumn||(t!==this.sortUserColumn&&(this.sortUserColumn=t,this.sortUserAscending=void 0),this.sortUserAscending=void 0===this.sortUserAscending?1===t||2===t:!this.sortUserAscending),1===this.sortUserColumn?this.vgUsers.sort((function(t,e){return xh(t.email,e.email)})):2===this.sortUserColumn&&this.vgUsers.sort((function(t,e){return xh(t.groupName.toLowerCase(),e.groupName.toLowerCase())})),this.sortUserAscending||this.vgUsers.reverse())}sortGroupTable(t){this.vgGroups&&(void 0===t&&void 0!==this.sortGroupColumn||(t!==this.sortGroupColumn&&(this.sortGroupColumn=t,this.sortGroupAscending=void 0),this.sortGroupAscending=void 0===this.sortGroupAscending?1===t:!this.sortGroupAscending),1===this.sortGroupColumn?this.vgGroups.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortGroupColumn&&this.vgGroups.sort((function(t,e){return e.users.length-t.users.length})),this.sortGroupAscending||this.vgGroups.reverse())}log(t){this.messageService.add("VisboProjectDetail: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(Rh),Rs(xv),Rs(Fg),Rs(fb),Rs(Xl),Rs(Df),Rs(rf))},t.\u0275cmp=le({type:t,selectors:[["app-sysvisboproject-detail"]],inputs:{visboproject:"visboproject"},decls:2,vars:1,consts:[[4,"ngIf"],[1,"container"],[3,"click"],[1,"form-group","row"],["for","vpName",1,"col-4","col-md-3","col-form-label"],["id","VPName",1,"col-8","form-control-static"],["for","vpDescription",1,"col-4","col-md-3","col-form-label"],["id","VPDesc",1,"col-8","form-control-static"],["for","Created",1,"col-4","col-md-3","col-form-label"],["id","VPCreated",1,"col","form-control-static","col-form-label"],["id","VPUpdated",1,"col","form-control-static","col-form-label"],[1,"btn-toolbar"],["id","ViewAudit","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["id","ViewGroup","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewUser","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["class","modal fade","id","VpGroupModalCreate","tabindex","-1","role","dialog","aria-labelledby","VpGroupModalCreateTitle","aria-hidden","true",4,"ngIf"],["class","modal fade","id","VPUserDetail","tabindex","-1","role","dialog","aria-labelledby","VPUserDetailTitle","aria-hidden","true",4,"ngIf"],["id","ViewAudit","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["id","ViewGroup","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],["id","ViewUser","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],[1,"row"],[1,"col"],[1,"panel-heading"],[1,"panel-body"],[1,"table","table-hover"],["id","UserHead"],["id","UserList"],[4,"ngFor","ngForOf"],["id","ColUser","data-toggle","modal","data-target","#VPUserDetail",3,"click"],["id","ColGroup"],["id","GroupHead"],["id","GroupList"],["id","ColMembers"],["id","ColGlobal",4,"ngIf"],["id","ColDetail","title","Detail of Group","data-toggle","modal","data-target","#VpGroupModalCreate",1,"Detail",3,"click"],["id","ColGlobal"],["id","VpGroupModalCreate","tabindex","-1","role","dialog","aria-labelledby","VpGroupModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["class","modal-title","id","VpGroupModalCenterTitle",4,"ngIf"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["name","actGroup","novalidate",""],["f","ngForm"],[1,"form-group",3,"ngClass"],["for","name",1,"col-form-label"],["type","text","name","name","required","",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],["class","help-block",4,"ngIf"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","permVP1","name","checkedVPView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPView","ngModel"],["for","permVP1",1,"custom-control-label"],["type","checkbox","id","permVP2","name","checkedVPViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPViewAudit","ngModel"],["for","permVP2",1,"custom-control-label"],["type","checkbox","id","permVP3","name","checkedVPModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPModify","ngModel"],["for","permVP3",1,"custom-control-label"],["type","checkbox","id","permVP4","name","checkedCreateVariant",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVariant","ngModel"],["for","permVP4",1,"custom-control-label"],["type","checkbox","id","permVP5","name","checkedVPManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPManagePerm","ngModel"],["for","permVP5",1,"custom-control-label"],["type","checkbox","id","permVP6","name","checkedVPDelete",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPDelete","ngModel"],["for","permVP6",1,"custom-control-label"],["class","mt-2",4,"ngIf"],[1,"form-group"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["id","VpGroupModalCenterTitle",1,"modal-title"],[1,"help-block"],[1,"mt-2"],[1,"form-control-static"],["class","row",4,"ngFor","ngForOf"],["class","col-8 ml-3",4,"ngIf"],[1,"col-8","ml-3"],["data-dismiss","modal",3,"click"],["id","VPUserDetail","tabindex","-1","role","dialog","aria-labelledby","VPUserDetailTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],["id","VPUserDetailTitle",1,"modal-title"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],[1,"form-control-static","mt-2"],[1,"form-group","mt-2"],["data-dismiss","modal",1,"btn","btn-primary"],["type","checkbox","checked","","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"]],template:function(t,e){1&t&&(Bs(0,"app-sysnavbar"),Gs(1,hE,39,21,"div",0)),2&t&&(_n(1),js("ngIf",e.visboproject))},directives:[gC,jc,Ou,Fd,Tu,Lc,Oc,Od,Ru,Nd,Eu,_d],pipes:[Kc,qc],styles:[""]}),t})(),gE=(()=>{class t{constructor(t){this.gChartService=t}ngOnInit(){this.language||(this.language="de"),this.gLib=this.gChartService.getGoogle(),this.gLib.charts.load("current",{packages:["corechart","table"],language:this.language}),this.gLib.charts.setOnLoadCallback(this.drawChart.bind(this))}ngOnChanges(){this.initialised&&this.drawChart()}drawChart(){const t=new this.gLib.visualization.ColumnChart(document.getElementById("divColumnChart")),e=new this.gLib.visualization.arrayToDataTable(this.graphData);t.draw(e,this.graphOptions||{title:"Column Chart"}),this.initialised=!0}}return t.\u0275fac=function(e){return new(e||t)(Rs(xV))},t.\u0275cmp=le({type:t,selectors:[["app-column-chart"]],inputs:{graphData:"graphData",language:"language",graphOptions:"graphOptions",parentThis:"parentThis"},features:[_e],decls:1,vars:0,consts:[["id","divColumnChart"]],template:function(t,e){1&t&&Bs(0,"div",0)},styles:["#divColumnChart[_ngcontent-%COMP%]{width:100%;height:700px}"]}),t})();function mE(t,e){if(1&t&&(Ns(0,"option"),mo(1),Fs()),2&t){const t=e.$implicit;_n(1),fo(t.name)}}function fE(t,e){if(1&t&&(Ns(0,"option"),mo(1),Fs()),2&t){const t=e.$implicit;_n(1),fo(t.name)}}function vE(t,e){if(1&t&&(Ns(0,"div",1),Ns(1,"h3",4),mo(2," Visbo Chart "),Ns(3,"div",3),Bs(4,"app-pie-chart",25),Fs(),Ns(5,"div",3),Bs(6,"app-line-chart",26),Fs(),Ns(7,"div",3),Bs(8,"app-column-chart",26),Fs(),Fs(),Fs()),2&t){const t=Xs();_n(4),js("graphData",t.graphData)("graphLegend",t.graphLegend)("graphOptions",t.graphOptions)("parentThis",t.parentThis),_n(2),js("graphData",t.graphDataLineChart)("graphOptions",t.graphOptionsLineChart),_n(2),js("graphData",t.graphDataColumnChart)("graphOptions",t.graphOptionsColumnChart)}}function bE(t,e){if(1&t&&(Ns(0,"td",48),mo(1),Ua(2,"date"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.createdAt,"HH:mm:ss"))}}function yE(t,e){if(1&t&&(Ns(0,"td",48),mo(1),Ua(2,"date"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.createdAt,"dd.MM HH:mm"))}}function CE(t,e){if(1&t&&(Ns(0,"td",49),mo(1),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(t.user.email)}}function VE(t,e){1&t&&(Ns(0,"td",49),mo(1," Unknown "),Fs())}function wE(t,e){if(1&t){const t=zs();Ns(0,"tr",40),Js("click",(function(){ei(t);const i=e.index;return Xs(2).helperAuditIndex(i)})),Gs(1,bE,3,4,"td",41),Gs(2,yE,3,4,"td",41),Gs(3,CE,2,1,"td",42),Gs(4,VE,2,0,"td",42),Ns(5,"td",43),mo(6),Fs(),Ns(7,"td",44),mo(8),Fs(),Ns(9,"td",45),mo(10),Fs(),Ns(11,"td",46),mo(12),Fs(),Ns(13,"td",45),mo(14),Fs(),Ns(15,"td"),Ns(16,"button",47),Js("click",(function(){ei(t);const i=e.index;return Xs(2).helperAuditIndex(i)})),mo(17,"i"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit,i=e.index,n=Xs(2);_n(1),js("ngIf",n.isToday(t.createdAt)),_n(1),js("ngIf",!n.isToday(t.createdAt)),_n(1),js("ngIf",t.user),_n(1),js("ngIf",!t.user),_n(2),fo(t.actionDescription),_n(2),fo(n.helperShortenText(t.actionInfo,30)),_n(2),fo(n.helperResponseText(t)),_n(2),vo("",t.result.time," ms"),_n(2),fo(n.helperFormatBytes(n.audit[i].result.size||0,2))}}function AE(t,e){1&t&&(Ns(0,"div"),Ns(1,"h3",50),mo(2," No Audit Entry for the time frame or the filter condition "),Fs(),Fs())}function PE(t,e){if(1&t){const t=zs();Ns(0,"div",1),Ns(1,"div",27),Ns(2,"table",28),Ns(3,"thead",29),Ns(4,"tr"),Ns(5,"th",30),Js("click",(function(){return ei(t),Xs().sortTable(1)})),mo(6,"Created"),Fs(),Ns(7,"th",31),Js("click",(function(){return ei(t),Xs().sortTable(2)})),mo(8,"User"),Fs(),Ns(9,"th",32),Js("click",(function(){return ei(t),Xs().sortTable(3)})),mo(10," Action"),Fs(),Ns(11,"th",33),Js("click",(function(){return ei(t),Xs().sortTable(4)})),mo(12," Info"),Fs(),Ns(13,"th",34),Js("click",(function(){return ei(t),Xs().sortTable(5)})),mo(14," Result"),Fs(),Ns(15,"th",35),Js("click",(function(){return ei(t),Xs().sortTable(6)})),mo(16," Duration"),Fs(),Ns(17,"th",36),Js("click",(function(){return ei(t),Xs().sortTable(7)})),mo(18," Size"),Fs(),Ns(19,"th"),mo(20,"Detail"),Fs(),Fs(),Fs(),Ns(21,"tbody",37),Gs(22,wE,18,9,"tr",38),Fs(),Fs(),Gs(23,AE,3,0,"div",39),Fs(),Fs()}if(2&t){const t=Xs();_n(22),js("ngForOf",t.audit),_n(1),js("ngIf",t.audit&&0==t.audit.length)}}function kE(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2,"Info:"),Fs(),Ns(3,"label",70),mo(4),Fs(),Fs()),2&t){const t=Xs(2);_n(4),vo("",t.audit[t.auditIndex].actionInfo," ")}}function DE(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2,"Visbo Center:"),Fs(),Ns(3,"label",75),mo(4),Fs(),Fs()),2&t){const t=Xs(2);_n(4),vo("",t.audit[t.auditIndex].vc.name," ")}}function ME(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2,"Visbo Project:"),Fs(),Ns(3,"label",76),mo(4),Fs(),Fs()),2&t){const t=Xs(2);_n(4),bo("",t.audit[t.auditIndex].vp.name," (",t.audit[t.auditIndex].vp.vpid,") ")}}function SE(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2,"Project Version:"),Fs(),Ns(3,"label",77),mo(4),Fs(),Fs()),2&t){const t=Xs(2);_n(4),bo("",t.audit[t.auditIndex].vpv.name," (",t.audit[t.auditIndex].vpv.vpvid,")")}}function IE(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2,"tech. Action:"),Fs(),Ns(3,"label",70),mo(4),Fs(),Fs()),2&t){const t=Xs(2);_n(4),vo("",t.audit[t.auditIndex].action," ")}}function xE(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2,"URL:"),Fs(),Ns(3,"label",78),mo(4),Fs(),Fs()),2&t){const t=Xs(2);_n(4),vo("",t.audit[t.auditIndex].url," ")}}function TE(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2,"Response Time:"),Fs(),Ns(3,"label",70),mo(4),Fs(),Fs()),2&t){const t=Xs(2);_n(4),vo("",t.audit[t.auditIndex].result.time," ms ")}}function _E(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2,"Response Size:"),Fs(),Ns(3,"label",70),mo(4),Fs(),Fs()),2&t){const t=Xs(2);_n(4),vo("",t.helperFormatBytes(t.audit[t.auditIndex].result.size||0,2)," ")}}function UE(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2,"User Agent:"),Fs(),Ns(3,"label",70),mo(4),Fs(),Fs()),2&t){const t=Xs(2);_n(4),fo(t.audit[t.auditIndex].userAgent)}}function EE(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2,"IP:"),Fs(),Ns(3,"label",70),mo(4),Fs(),Fs()),2&t){const t=Xs(2);_n(4),fo(t.audit[t.auditIndex].ip)}}function OE(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2,"TTL:"),Fs(),Ns(3,"label",70),mo(4),Ua(5,"date"),Fs(),Fs()),2&t){const t=Xs(2);_n(4),fo(Oa(5,1,t.audit[t.auditIndex].ttl,"dd.MM HH:mm"))}}function GE(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"label",66),mo(2,"Host:"),Fs(),Ns(3,"label",70),mo(4),Fs(),Fs()),2&t){const t=Xs(2);_n(4),fo(t.audit[t.auditIndex].host)}}function LE(t,e){if(1&t){const t=zs();Ns(0,"button",79),Js("click",(function(){return ei(t),Xs(2).toggleDetail()})),mo(1,"More"),Fs()}}function RE(t,e){if(1&t){const t=zs();Ns(0,"button",80),Js("click",(function(){return ei(t),Xs(2).toggleDetail()})),mo(1,"Less"),Fs()}}function jE(t,e){if(1&t){const t=zs();Ns(0,"div",51),Ns(1,"div",52),Ns(2,"div",53),Ns(3,"h5",54),mo(4,"Detail of Audit Entry"),Fs(),Ns(5,"button",55),Ns(6,"span",56),mo(7,"\xd7"),Fs(),Fs(),Fs(),Ns(8,"div",57),Ns(9,"div",2),Ns(10,"div",58),Ns(11,"h3",59),Js("click",(function(){return ei(t),Xs().pageAuditIndex(-1)})),Bs(12,"a",60),Fs(),Fs(),Ns(13,"div",61),Ns(14,"h3",62),Js("click",(function(){return ei(t),Xs().pageAuditIndex(1)})),Bs(15,"a",63),Fs(),Fs(),Fs(),Ns(16,"form",64),Ns(17,"div",65),Ns(18,"label",66),mo(19,"Created:"),Fs(),Ns(20,"label",67),mo(21),Ua(22,"date"),Fs(),Ns(23,"label",66),mo(24,"User:"),Fs(),Ns(25,"label",68),mo(26),Fs(),Ns(27,"label",66),mo(28,"Action:"),Fs(),Ns(29,"label",69),mo(30),Fs(),Fs(),Gs(31,kE,5,1,"div",39),Gs(32,DE,5,1,"div",39),Gs(33,ME,5,2,"div",39),Gs(34,SE,5,2,"div",39),Ns(35,"div"),Ns(36,"label",66),mo(37,"Result:"),Fs(),Ns(38,"label",70),mo(39),Fs(),Fs(),Gs(40,IE,5,1,"div",39),Gs(41,xE,5,1,"div",39),Gs(42,TE,5,1,"div",39),Gs(43,_E,5,1,"div",39),Gs(44,UE,5,1,"div",39),Gs(45,EE,5,1,"div",39),Gs(46,OE,6,4,"div",39),Gs(47,GE,5,1,"div",39),Fs(),Fs(),Ns(48,"div",71),Gs(49,LE,2,0,"button",72),Gs(50,RE,2,0,"button",73),Ns(51,"button",74),mo(52,"Close"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs();_n(21),vo("",Oa(22,18,t.audit[t.auditIndex].createdAt,"dd.MM.yyyy HH:mm:ss.SSS")," "),_n(5),vo("",t.audit[t.auditIndex].user.email," "),_n(4),vo("",t.helperFormatActionDescription(t.audit[t.auditIndex])," "),_n(1),js("ngIf",t.audit[t.auditIndex].actionInfo),_n(1),js("ngIf",t.audit[t.auditIndex].vc),_n(1),js("ngIf",t.audit[t.auditIndex].vp),_n(1),js("ngIf",t.audit[t.auditIndex].vpv),_n(5),vo("",t.helperResponseText(t.audit[t.auditIndex])," "),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore&&t.audit[t.auditIndex].ip),_n(1),js("ngIf",t.showMore&&t.audit[t.auditIndex].ttl),_n(1),js("ngIf",t.showMore&&t.audit[t.auditIndex].host),_n(2),js("ngIf",!t.showMore),_n(1),js("ngIf",t.showMore)}}function $E(t){let e;return t?(e=t.replace(/\t/g," "),"="!==e[0]&&"+"!==e[0]&&"-"!==e[0]||(e="'".concat(e)),e):t}let NE=(()=>{class t{constructor(t,e,i,n,r,s){this.visboauditService=t,this.visbocenterService=e,this.messageService=i,this.alertService=n,this.route=r,this.router=s,this.auditTypeList=[{name:"All",action:""},{name:"Read",action:"GET"},{name:"Create",action:"POST"},{name:"Update",action:"PUT"},{name:"Delete",action:"DELETE"}],this.auditAreaList=[{name:"Overview",action:"other"},{name:"System",action:"sys"},{name:"Visbo Center",action:"vc"},{name:"Visbo Project",action:"vp"},{name:"All",action:""}],this.sysVCId="",this.chart=!1,this.parentThis=this,this.chartButton="Chart",this.graphData=[],this.graphLegend=[["string","Action Type"],["number","Count"]],this.graphOptions={title:"Audit Activity by Action",sliceVisibilityThreshold:.025},this.graphDataLineChart=[],this.graphOptionsLineChart={title:"Audit Activity by Time",explorer:{actions:["dragToZoom","rightClickToReset"],maxZoomIn:.01},vAxis:{title:"Number of Activities",minorGridlines:{count:0}},hAxis:{format:"dd.MM.yy",gridlines:{count:-1},minorGridlines:{count:0}},pointSize:6,curveType:"function",colors:["blue","red","green","yellow"]},this.graphDataColumnChart=[],this.graphOptionsColumnChart={title:"Audit Activity by User",isStacked:!0,hAxis:{direction:-1,slantedText:!0,slantedTextAngle:45}}}ngOnInit(){this.auditCount=50,this.auditType=this.auditTypeList[0].name,this.auditArea=this.auditAreaList[0].name,this.today=new Date,this.today.setHours(0,0,0,0),this.sysVCId=this.visbocenterService.getSysVCId(),this.getVisboAudits()}getVisboAudits(){const t=new lC;t.to=this.auditTo?new Date(this.auditTo):new Date,this.auditFrom&&(t.from=new Date(this.auditFrom)),this.auditText&&(t.text=this.auditText.trim());for(let e=0;e<this.auditTypeList.length;e++)if(this.auditType===this.auditTypeList[e].name){t.actionType=this.auditTypeList[e].action;break}for(let e=0;e<this.auditAreaList.length;e++)if(this.auditArea===this.auditAreaList[e].name){t.area=this.auditAreaList[e].action;break}t.maxcount=this.auditCount,this.visboauditService.getVisboAudits(!0,t).subscribe(t=>{this.audit=t,this.alertService.success("Successfully accessed Audit",!0),this.sortTable(void 0),this.groupGraphData(),this.groupgraphDataLineChart(),this.groupgraphDataColumnChart()},t=>{this.log(`get Audit failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}gotoDetail(t){this.router.navigate(["sysaudit/"+t._id])}downloadVisboAudit(){let t;this.log(`sysAudit Download ${this.audit.length} Items`),t="sep=\t\n",t+="date\ttime UTC\temail\tactionDescription\taction\turl\tactionInfo\tresponseTime\tresponseStatus\tvcid\tvcname\tvpid\tvpname\tvpvid\tsize\tip\tuserId\tuserAgent\tttl\tVC Details\tVP Details\n";for(let r=0;r<this.audit.length;r++){const e=new Date(this.audit[r].createdAt).toISOString(),i=(this.audit[r].userAgent||"").replace(/,/g,";"),n=e.substr(0,10)+"\t"+e.substr(11,12)+"\t"+$E(this.audit[r].user.email)+"\t"+$E(this.audit[r].actionDescription)+"\t"+this.audit[r].action+"\t"+this.audit[r].url+"\t"+this.audit[r].actionInfo+"\t"+(this.audit[r].result?this.audit[r].result.time:"")+"\t"+(this.audit[r].result?this.audit[r].result.status:"")+"\t"+(this.audit[r].vc?this.audit[r].vc.vcid:"")+"\t"+(this.audit[r].vc?$E(this.audit[r].vc.name):"")+"\t"+(this.audit[r].vp?this.audit[r].vp.vpid:"")+"\t"+(this.audit[r].vp?$E(this.audit[r].vp.name):"")+"\t"+(this.audit[r].vpv?this.audit[r].vpv.vpvid:"")+"\t"+(this.audit[r].result?this.audit[r].result.size:"0")+"\t"+this.audit[r].ip+"\t"+this.audit[r].user.userId+"\t"+$E(i)+"\t"+(this.audit[r].ttl||"")+"\t"+(this.audit[r].vc&&$E(this.audit[r].vc.vcjson)||"")+"\t"+(this.audit[r].vp&&$E(this.audit[r].vp.vpjson)||"")+"\n";t=t.concat(n)}this.log(`sysAudit CSV Len ${t.length} `);const e=new Blob([t],{type:"text/plain"}),i=window.URL.createObjectURL(e),n=document.createElement("a");document.body.appendChild(n),n.href=i,n.download="auditlog.csv",this.log(`Open URL ${i} doc ${JSON.stringify(n)}`),n.click(),window.URL.revokeObjectURL(i)}switchChart(){this.chart=!this.chart,this.chartButton=this.chart?"List":"Chart"}groupGraphData(){const t=[],e=[];for(const i in this.audit)this.audit[i].actionDescription&&(t[this.audit[i].actionDescription]=(t[this.audit[i].actionDescription]||0)+1);for(const i in t)e.push([i,t[i]]);e.sort((function(t,e){let i=0;return t[1]>e[1]?i=-1:t[1]<e[1]&&(i=1),i})),this.graphData=e}groupgraphDataLineChart(){const t=[],e=[];for(const i in this.audit)if(this.audit[i].createdAt){const e=new Date(this.audit[i].createdAt);e.setHours(0,0,0,0);const n=Math.trunc(e.getTime()/1e3/60/60/24);void 0===t[n]&&(t[n]=[new Date(e),0,0,0,0]),t[n][1]=t[n][1]+1,this.audit[i].vpv?t[n][4]=t[n][4]+1:this.audit[i].vp?t[n][3]=t[n][3]+1:this.audit[i].vc&&this.audit[i].vc.vcid.toString()!==this.sysVCId&&(t[n][2]=t[n][2]+1)}for(const i in t)e.push(t[i]);if(1===e.length){const t=new Date(e[0][0].toISOString());t.setMinutes(t.getMinutes()-1),e.push([t,0,0,0,0])}e.sort((function(t,e){return e[0]-t[0]})),e.push(["Date","All","VC","VP","VPV"]),e.reverse(),this.graphOptionsLineChart.hAxis.gridlines.count=e.length-1,this.log(`Group Graph Time Chart Gridlines ${e.length-1} `),this.graphDataLineChart=e}groupgraphDataColumnChart(){const t=[],e=[];for(const i in this.audit)if(this.audit[i].user&&this.audit[i].user.email){const e=this.audit[i].user.email;void 0===t[e]&&(t[e]=[e,0,0,0,0,0,0,""]),this.audit[i].vpv||this.auditGroup(this.audit[i],"/vpv")?t[e][3]=t[e][3]+1:this.audit[i].vp||this.auditGroup(this.audit[i],"/vp")?t[e][2]=t[e][2]+1:this.audit[i].vc&&this.audit[i].vc.vcid.toString()!==this.sysVCId||this.auditGroup(this.audit[i],"/vc")?t[e][1]=t[e][1]+1:this.audit[i].vc&&this.audit[i].vc.vcid.toString()===this.sysVCId||this.auditGroup(this.audit[i],"/audit")?t[e][4]=t[e][4]+1:this.auditGroup(this.audit[i],"/token")||this.auditGroup(this.audit[i],"/user")?t[e][5]=t[e][5]+1:t[e][6]=t[e][6]+1}for(const i in t)e.push(t[i]);e.sort((function(t,e){return t[1]+t[2]+t[3]+t[4]+t[5]+t[6]-(e[1]+e[2]+e[3]+e[4]+e[5]+e[6])})),e.push(["User","VC","VP","VPV","System","User","Other",{role:"annotation"}]),e.reverse(),this.log("Group Graph Column Chart Element "+JSON.stringify(e[0])),this.log("Group Graph Column Chart Element "+JSON.stringify(e[1])),this.graphDataColumnChart=e}auditGroup(t,e){let i=!1;return 0===t.url.indexOf(e)&&(i=!0),i}helperAuditIndex(t){this.auditIndex=t}helperFormatActionDescription(t){if(this.log(`AuditDescription  ${t.actionDescription} `),"GET"===t.actionDescription||"POST"===t.actionDescription||"PUT"===t.actionDescription||"DELETE"===t.actionDescription){let e=t.actionDescription.concat(" ",t.url);return e.length>20&&(e=e.substring(0,17)+"..."),e}return t.actionDescription}helperFormatBytes(t,e=2){if(0===t)return"0 B";const i=e||2,n=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,n)).toFixed(i))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}pageAuditIndex(t){let e=this.auditIndex+t;e<0&&(e=0),e>=this.audit.length&&(e=this.audit.length-1),this.auditIndex=e}helperResponseText(t){if(t.result.statusText)return t.result.statusText;const e=t.result.status;return"200"===e||"304"===e?"Success":"400"===e?"Bad Request":"401"===e?"Not Authenticated":"403"===e?"Permission Denied":"404"===e?"URL not found":"409"===e?"Conflict":"423"===e?"Locked":"500"===e?"Server Error":e.toString()}helperShortenText(t,e){return Gh(t,e)}toggleDetail(){this.log("Toggle ShowMore"),this.showMore=!this.showMore}isToday(t){return new Date(t)>this.today}sortTable(t){this.audit&&(void 0!==t?t!==this.sortColumn?(this.sortColumn=t,this.sortAscending=void 0):void 0!==this.sortAscending&&(this.sortAscending=!this.sortAscending):(this.sortColumn=1,this.sortAscending=void 0),void 0===this.sortAscending&&(this.sortAscending=2===t||3===t||4===t),1===this.sortColumn?this.audit.sort((function(t,e){return Th(t.createdAt,e.createdAt)})):2===this.sortColumn?this.audit.sort((function(t,e){return xh(t.user.email.toLowerCase(),e.user.email.toLowerCase())})):3===this.sortColumn?this.audit.sort((function(t,e){return xh(t.actionDescription,e.actionDescription)})):4===this.sortColumn?this.audit.sort((function(t,e){return xh(t.url,e.url)})):5===this.sortColumn?this.audit.sort((function(t,e){return xh(t.result.status,e.result.status)})):6===this.sortColumn?this.audit.sort((function(t,e){return t.result.time-e.result.time})):7===this.sortColumn&&this.audit.sort((function(t,e){return(t.result.size||0)-(e.result.size||0)})),this.sortAscending||this.audit.reverse())}log(t){this.messageService.add("Sys Audit: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(dC),Rs(xv),Rs(Rh),Rs(Df),Rs(Fg),Rs(rf))},t.\u0275cmp=le({type:t,selectors:[["app-sysaudit"]],decls:46,vars:12,consts:[[1,"well"],[1,"container-fluid"],[1,"row"],[1,"col"],[1,"panel-heading"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group","row"],["for","auditFrom",1,"col-1","col-form-label"],["id","auditFrom","type","date","name","auditFrom",1,"col-4","col-md-2","form-control",3,"ngModel","ngModelChange"],["for","auditTo",1,"col-1","col-form-label"],["id","auditTo","type","date","name","auditTo",1,"col-4","col-md-2","form-control",3,"ngModel","ngModelChange"],["for","auditText",1,"col-1","col-form-label"],["id","auditText","type","text","name","auditText",1,"col-3","col-md-2","form-control",3,"ngModel","ngModelChange"],["for","auditCount",1,"col-1","col-form-label"],["id","auditCount","name","auditCount",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],["id","auditArea","id","auditType","name","auditArea",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["id","auditType","id","auditType","name","actiontype",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],[1,"btn-group"],["type","button",1,"btn","btn-sm","btn-primary","ml-auto","mx-1",3,"click"],["type","button",1,"btn","btn-sm","btn-secondary","ml-auto","mx-1",3,"click"],["class","container-fluid",4,"ngIf"],["id","AuditDetail","tabindex","-1","role","dialog","aria-labelledby","Audit Detail","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-lg modal-dialog-centered","role","document",4,"ngIf"],[3,"graphData","graphLegend","graphOptions","parentThis"],[3,"graphData","graphOptions"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],["id","AuditHead"],["id","SortDate",1,"d-none","d-md-table-cell",3,"click"],["id","SortUser",3,"click"],["id","SortAction",3,"click"],["id","SortInfo",1,"d-none","d-md-table-cell",3,"click"],["id","SortResult",1,"d-none","d-lg-table-cell",3,"click"],["id","SortDuration",1,"d-none","d-lg-table-cell",3,"click"],["id","SortSize",1,"d-none","d-lg-table-cell",3,"click"],["id","AuditList"],["data-toggle","modal","data-target","#AuditDetail",3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],["data-toggle","modal","data-target","#AuditDetail",3,"click"],["id","ColCreated","class","d-none d-md-table-cell",4,"ngIf"],["id","ColUser",4,"ngIf"],["id","ColAction"],["id","ColInfo",1,"d-none","d-md-table-cell"],["id","ColResult",1,"d-none","d-lg-table-cell"],["id","ColDuration",1,"d-none","d-lg-table-cell"],["id","ColDetail","title","Detail of Visbo Audit","data-toggle","modal","data-target","#AuditDetail",1,"Detail",3,"click"],["id","ColCreated",1,"d-none","d-md-table-cell"],["id","ColUser"],[1,"d-flex","justify-content-center"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","AuditDetailTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"col-11"],["id","ButtonPrev","title","Previous Entry",3,"click"],[1,"px-3","col-1","fas","fa-caret-square-left"],[1,"col-1"],["id","ButtonNext","title","Next Entry",3,"click"],[1,"px-3","col-1","fas","fa-caret-square-right"],["id","auditEntry"],[1,"v_compact_t"],[1,"v_compact_t","col-4","form-control-static"],["id","auditCreated",1,"v_compact_t","col-7","form-control-static"],["id","auditUser",1,"v_compact_t","col-7","form-control-static"],["id","auditAction",1,"v_compact_t","col-7","form-control-static"],[1,"v_compact_t","col-7","form-control-static"],[1,"modal-footer","align-items-end"],["id","ButtonMore","type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["id","ButtonLess","type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-primary"],["id","auditVC",1,"v_compact_t","col-7","form-control-static"],["id","auditVP",1,"v_compact_t","col-7","form-control-static"],["id","auditVPV",1,"v_compact_t","col-7","form-control-static"],[1,"v_compact_t","col-7","form-control-static",2,"overflow-wrap","break-word"],["id","ButtonMore","type","button",1,"btn","btn-secondary",3,"click"],["id","ButtonLess","type","button",1,"btn","btn-secondary",3,"click"]],template:function(t,e){1&t&&(Bs(0,"app-sysnavbar"),Ns(1,"div",0),Ns(2,"div",1),Ns(3,"div",2),Ns(4,"div",3),Ns(5,"h2",4),mo(6," Visbo System Audit "),Fs(),Fs(),Fs(),Fs(),Ns(7,"form",5,6),Js("ngSubmit",(function(){return e.getVisboAudits()})),Ns(9,"div",7),Ns(10,"label",8),mo(11,"From:"),Fs(),Ns(12,"input",9),Js("ngModelChange",(function(t){return e.auditFrom=t})),Fs(),Ns(13,"label",10),mo(14,"To:"),Fs(),Ns(15,"input",11),Js("ngModelChange",(function(t){return e.auditTo=t})),Fs(),Fs(),Ns(16,"div",7),Ns(17,"label",12),mo(18,"Filter:"),Fs(),Ns(19,"input",13),Js("ngModelChange",(function(t){return e.auditText=t})),Fs(),Ns(20,"label",14),mo(21,"Max:"),Fs(),Ns(22,"select",15),Js("ngModelChange",(function(t){return e.auditCount=t})),Ns(23,"option"),mo(24,"50"),Fs(),Ns(25,"option"),mo(26,"100"),Fs(),Ns(27,"option"),mo(28,"500"),Fs(),Ns(29,"option"),mo(30,"2000"),Fs(),Fs(),Ns(31,"select",16),Js("ngModelChange",(function(t){return e.auditArea=t})),Gs(32,mE,2,1,"option",17),Fs(),Ns(33,"select",18),Js("ngModelChange",(function(t){return e.auditType=t})),Gs(34,fE,2,1,"option",17),Fs(),Ns(35,"div",19),Ns(36,"button",20),Js("click",(function(){return e.getVisboAudits()})),mo(37,"Filter"),Fs(),Ns(38,"button",21),Js("click",(function(){return e.downloadVisboAudit()})),mo(39,"Download"),Fs(),Ns(40,"button",21),Js("click",(function(){return e.switchChart()})),mo(41),Fs(),Fs(),Fs(),Fs(),Gs(42,vE,9,8,"div",22),Gs(43,PE,24,2,"div",22),Fs(),Ns(44,"div",23),Gs(45,jE,53,21,"div",24),Fs()),2&t&&(_n(12),js("ngModel",e.auditFrom),_n(3),js("ngModel",e.auditTo),_n(4),js("ngModel",e.auditText),_n(3),js("ngModel",e.auditCount),_n(9),js("ngModel",e.auditArea),_n(1),js("ngForOf",e.auditAreaList),_n(1),js("ngModel",e.auditType),_n(1),js("ngForOf",e.auditTypeList),_n(7),fo(e.chartButton),_n(1),js("ngIf",e.chart),_n(1),js("ngIf",!e.chart),_n(2),js("ngIf",e.auditIndex>=0&&e.auditIndex<e.audit.length))},directives:[gC,Ou,Fd,Tu,Od,Nd,Eu,cu,du,gu,Lc,jc,iS,PD,gE],pipes:[qc],styles:[".v_compact_t[_ngcontent-%COMP%]{margin:0;padding-top:0}"]}),t})();const FE=new th({"Content-Type":"application/json"});let BE=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.serviceUrl=this.env.restUrl.concat("/sysuser")}getSysUsers(t){const e=this.serviceUrl;let i=new nh;return t&&(i=i.append("email",t)),i=i.append("maxcount","100"),this.log(`Calling HTTP Request: ${e} `),this.http.get(e,{headers:FE,params:i}).pipe(D(t=>t.user),Kh(t=>this.log(`fetched ${t.length} Users `)),Nh(this.handleError("getSysUsers",[])))}handleError(t="operation",e){return i=>(this.log(`HTTP Request ${t} failed: ${i.error.message} status:${i.status}, Result ${JSON.stringify(e)}`),jh(i))}log(t){this.messageService.add("SysUserService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(Rh),Kt(np))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function HE(t,e){if(1&t&&(Ns(0,"td",12),mo(1),Ua(2,"date"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.status.lastLoginAt,"dd.MM.yy"))}}function KE(t,e){1&t&&(Ns(0,"td",12),mo(1,"Never"),Fs())}function qE(t,e){if(1&t&&(Ns(0,"td",12),mo(1),Ua(2,"date"),Fs()),2&t){const t=Xs().$implicit;_n(1),fo(Oa(2,1,t.status.lastLoginFailedAt,"dd.MM.yy"))}}function zE(t,e){1&t&&(Ns(0,"td",12),mo(1,"Never"),Fs())}function QE(t,e){if(1&t){const t=zs();Ns(0,"tr",18),Js("click",(function(){ei(t);const i=e.index;return Xs().helperUserIndex(i)})),Ns(1,"td",12),mo(2),Fs(),Ns(3,"td"),Ns(4,"a"),mo(5),Fs(),Fs(),Ns(6,"td",12),mo(7),Ua(8,"date"),Fs(),Gs(9,HE,3,4,"td",19),Gs(10,KE,2,0,"td",19),Gs(11,qE,3,4,"td",19),Gs(12,zE,2,0,"td",19),Ns(13,"td"),Ns(14,"button",20),Js("click",(function(){ei(t);const i=e.index;return Xs().helperUserIndex(i)})),mo(15,"i"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit,i=e.index;_n(2),fo(i+1),_n(3),fo(t.email),_n(2),fo(Oa(8,7,t.updatedAt,"dd.MM.yy")),_n(2),js("ngIf",t.status&&t.status.lastLoginAt),_n(1),js("ngIf",!(t.status&&t.status.lastLoginAt)),_n(1),js("ngIf",t.status&&t.status.lastLoginFailedAt),_n(1),js("ngIf",!(t.status&&t.status.lastLoginFailedAt))}}function WE(t,e){if(1&t&&(Ns(0,"div",32),Ns(1,"label",33),mo(2,"Name:"),Fs(),Ns(3,"label",34),mo(4),Fs(),Fs()),2&t){const t=Xs(2);_n(4),bo("",t.user[t.userIndex].profile.firstName," ",t.user[t.userIndex].profile.lastName,"")}}function JE(t,e){if(1&t&&(Ns(0,"div",32),Ns(1,"label",33),mo(2,"Company:"),Fs(),Ns(3,"label",34),mo(4),Fs(),Fs()),2&t){const t=Xs(2);_n(4),fo(t.user[t.userIndex].profile.company)}}function YE(t,e){if(1&t&&(Ns(0,"div",32),Ns(1,"label",33),mo(2,"Phone:"),Fs(),Ns(3,"label",34),mo(4),Fs(),Fs()),2&t){const t=Xs(2);_n(4),fo(t.user[t.userIndex].profile.phone)}}function ZE(t,e){if(1&t&&(Ns(0,"div",32),Ns(1,"label",33),mo(2,"Created:"),Fs(),Ns(3,"label",34),mo(4),Ua(5,"date"),Fs(),Fs()),2&t){const t=Xs(2);_n(4),vo("",Oa(5,1,t.user[t.userIndex].createdAt,"dd.MM.yyyy HH:mm:ss")," ")}}function XE(t,e){if(1&t&&(Ns(0,"div",32),Ns(1,"label",33),mo(2,"Updated:"),Fs(),Ns(3,"label",34),mo(4),Ua(5,"date"),Fs(),Fs()),2&t){const t=Xs(2);_n(4),vo("",Oa(5,1,t.user[t.userIndex].updatedAt,"dd.MM.yyyy HH:mm:ss")," ")}}function tO(t,e){if(1&t&&(Ns(0,"label",34),mo(1),Ua(2,"date"),Fs()),2&t){const t=Xs(2);_n(1),vo("",Oa(2,1,t.user[t.userIndex].status.registeredAt,"dd.MM.yyyy HH:mm:ss")," ")}}function eO(t,e){1&t&&(Ns(0,"label",34),mo(1,"Not registered yet "),Fs())}function iO(t,e){if(1&t&&(Ns(0,"div",32),Ns(1,"label",33),mo(2,"Locked:"),Fs(),Ns(3,"label",34),mo(4),Ua(5,"date"),Fs(),Fs()),2&t){const t=Xs(2);_n(4),vo("",Oa(5,1,t.user[t.userIndex].status.lockedUntil,"dd.MM.yyyy HH:mm:ss")," ")}}function nO(t,e){if(1&t&&(Ns(0,"div",32),Ns(1,"label",33),mo(2,"Retries:"),Fs(),Ns(3,"label",34),mo(4),Fs(),Fs()),2&t){const t=Xs(2);_n(4),vo("",t.user[t.userIndex].status.loginRetries," ")}}function rO(t,e){if(1&t&&(Ns(0,"div",32),Ns(1,"label",33),mo(2,"Last Login:"),Fs(),Ns(3,"label",34),mo(4),Ua(5,"date"),Fs(),Fs()),2&t){const t=Xs(2);_n(4),vo("",Oa(5,1,t.user[t.userIndex].status.lastLoginAt,"dd.MM.yyyy HH:mm:ss")," ")}}function sO(t,e){if(1&t){const t=zs();Ns(0,"button",40),Js("click",(function(){return ei(t),Xs(2).toggleDetail()})),mo(1,"More"),Fs()}}function oO(t,e){if(1&t){const t=zs();Ns(0,"button",40),Js("click",(function(){return ei(t),Xs(2).toggleDetail()})),mo(1,"Less"),Fs()}}function aO(t,e){if(1&t){const t=zs();Ns(0,"div",21),Ns(1,"div",22),Ns(2,"div",23),Ns(3,"h5",24),mo(4,"Detail of User"),Fs(),Ns(5,"button",25),Ns(6,"span",26),mo(7,"\xd7"),Fs(),Fs(),Fs(),Ns(8,"div",27),Ns(9,"div",1),Ns(10,"div",28),Ns(11,"button",29),Js("click",(function(){return ei(t),Xs().pageUserIndex(-1)})),mo(12,"Prev"),Fs(),Fs(),Ns(13,"div",30),Ns(14,"button",31),Js("click",(function(){return ei(t),Xs().pageUserIndex(1)})),mo(15,"Next"),Fs(),Fs(),Fs(),Ns(16,"form"),Ns(17,"div",32),Ns(18,"label",33),mo(19,"User:"),Fs(),Ns(20,"label",34),mo(21),Fs(),Fs(),Gs(22,WE,5,2,"div",35),Gs(23,JE,5,1,"div",35),Gs(24,YE,5,1,"div",35),Gs(25,ZE,6,4,"div",35),Gs(26,XE,6,4,"div",35),Ns(27,"div",32),Ns(28,"label",33),mo(29,"Registered:"),Fs(),Gs(30,tO,3,4,"label",36),Gs(31,eO,2,0,"label",36),Fs(),Gs(32,iO,6,4,"div",35),Gs(33,nO,5,1,"div",35),Gs(34,rO,6,4,"div",35),Fs(),Fs(),Ns(35,"div",37),Gs(36,sO,2,0,"button",38),Gs(37,oO,2,0,"button",38),Ns(38,"button",39),mo(39,"Close"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs();_n(21),vo("",t.user[t.userIndex].email," "),_n(1),js("ngIf",t.user[t.userIndex].profile),_n(1),js("ngIf",t.user[t.userIndex].profile),_n(1),js("ngIf",t.user[t.userIndex].profile),_n(1),js("ngIf",t.showMore),_n(1),js("ngIf",t.showMore),_n(4),js("ngIf",t.user[t.userIndex].status&&t.user[t.userIndex].status.registeredAt),_n(1),js("ngIf",!(t.user[t.userIndex].status&&t.user[t.userIndex].status.registeredAt)),_n(1),js("ngIf",t.user[t.userIndex].status&&t.user[t.userIndex].status.lockedUntil),_n(1),js("ngIf",t.user[t.userIndex].status&&t.user[t.userIndex].status.loginRetries),_n(1),js("ngIf",t.user[t.userIndex].status),_n(2),js("ngIf",!t.showMore),_n(1),js("ngIf",t.showMore)}}let lO=(()=>{class t{constructor(t,e,i,n,r){this.sysuserService=t,this.messageService=e,this.alertService=i,this.route=n,this.router=r}ngOnInit(){this.getSysUsers(),this.sortTable(void 0)}getSysUsers(){this.userMatch&&(this.userMatch=this.userMatch.trim()),this.log("Get with filter "+this.userMatch),this.sysuserService.getSysUsers(this.userMatch).subscribe(t=>{this.user=t,this.sortTable(void 0),this.log("get success")},t=>{this.log(`get failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}helperUserIndex(t){this.userIndex=t}pageUserIndex(t){let e=this.userIndex+t;e<0&&(e=0),e>=this.user.length&&(e=this.user.length-1),this.userIndex=e}helperShortenText(t,e){return Gh(t,e)}toggleDetail(){this.log("Toggle ShowMore"),this.showMore=!this.showMore}sortTable(t){this.user&&(this.log("Sort Table Column "+t),void 0!==t?t!==this.sortColumn?(this.sortColumn=t,this.sortAscending=void 0):void 0!==this.sortAscending&&(this.sortAscending=!this.sortAscending):(this.sortColumn=2,this.sortAscending=void 0),void 0===this.sortAscending&&(this.sortAscending=1===t),1===this.sortColumn?this.user.sort((function(t,e){return xh(t.email,e.email)})):2===this.sortColumn?this.user.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})):3===this.sortColumn?this.user.sort((function(t,e){return Th(t.status&&t.status.lastLoginAt?new Date(t.status.lastLoginAt):new Date("2001-01-01"),e.status&&e.status.lastLoginAt?new Date(e.status.lastLoginAt):new Date("2001-01-01"))})):4===this.sortColumn&&this.user.sort((function(t,e){return Th(t.status&&t.status.lastLoginFailedAt?new Date(t.status.lastLoginFailedAt):new Date("2001-01-01"),e.status&&e.status.lastLoginFailedAt?new Date(e.status.lastLoginFailedAt):new Date("2001-01-01"))})),this.sortAscending||this.user.reverse())}log(t){this.messageService.add("Sys User: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(BE),Rs(Rh),Rs(Df),Rs(Fg),Rs(rf))},t.\u0275cmp=le({type:t,selectors:[["app-sysuser"]],decls:34,vars:3,consts:[[1,"well"],[1,"row"],[1,"panel-heading"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group","row"],["for","userMatch",1,"col-2","col-form-label"],["id","userMatch","type","text","name","userMatch",1,"col-2","col-sm-4","form-control","mx-1",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-primary","mx-1",3,"click"],[1,"container-fluid"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[1,"d-none","d-md-table-cell"],[3,"click"],[1,"d-none","d-md-table-cell",3,"click"],["data-toggle","modal","data-target","#UserDetail",3,"click",4,"ngFor","ngForOf"],["id","UserDetail","tabindex","-1","role","dialog","aria-labelledby","User Detail","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-lg modal-dialog-centered","role","document",4,"ngIf"],["data-toggle","modal","data-target","#UserDetail",3,"click"],["class","d-none d-md-table-cell",4,"ngIf"],["title","Detail of Visbo User","data-toggle","modal","data-target","#UserDetail",1,"Detail",3,"click"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","UserDetailTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"col-10"],["type","button","title","Prev User",1,"btn","btn-secondary",3,"click"],[1,"col-2"],["type","button","title","Next User",1,"btn","btn-secondary","align-self-end",3,"click"],[1,"form-group"],[1,"col-4","col-form-label"],[1,"col-7","form-control-static"],["class","form-group",4,"ngIf"],["class","col-7 form-control-static",4,"ngIf"],[1,"modal-footer","align-items-end"],["type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["type","button","data-dismiss","modal",1,"btn","btn-primary"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(t,e){1&t&&(Bs(0,"app-sysnavbar"),Ns(1,"div",0),Ns(2,"div",1),Ns(3,"h2",2),mo(4," Visbo Users "),Fs(),Fs(),Ns(5,"form",3,4),Js("ngSubmit",(function(){return e.getSysUsers()})),Ns(7,"div",5),Ns(8,"label",6),mo(9,"Filter:"),Fs(),Ns(10,"input",7),Js("ngModelChange",(function(t){return e.userMatch=t})),Fs(),Ns(11,"button",8),Js("click",(function(){return e.getSysUsers()})),mo(12,"Filter"),Fs(),Fs(),Fs(),Ns(13,"div",9),Ns(14,"div",10),Ns(15,"table",11),Ns(16,"thead"),Ns(17,"tr"),Ns(18,"th",12),mo(19,"Nr."),Fs(),Ns(20,"th",13),Js("click",(function(){return e.sortTable(1)})),mo(21,"User"),Fs(),Ns(22,"th",14),Js("click",(function(){return e.sortTable(2)})),mo(23,"Updated"),Fs(),Ns(24,"th",14),Js("click",(function(){return e.sortTable(3)})),mo(25,"Last Login"),Fs(),Ns(26,"th",14),Js("click",(function(){return e.sortTable(4)})),mo(27,"Failed Login"),Fs(),Ns(28,"th"),mo(29,"Detail"),Fs(),Fs(),Fs(),Ns(30,"tbody"),Gs(31,QE,16,10,"tr",15),Fs(),Fs(),Fs(),Fs(),Fs(),Ns(32,"div",16),Gs(33,aO,40,13,"div",17),Fs()),2&t&&(_n(10),js("ngModel",e.userMatch),_n(21),js("ngForOf",e.user),_n(2),js("ngIf",e.userIndex>=0&&e.userIndex<e.user.length))},directives:[gC,Ou,Fd,Tu,Od,Nd,Eu,Lc,jc],pipes:[qc],styles:[""]}),t})(),cO=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.serviceUrl=this.env.restUrl.concat("/syslog")}getSysLogs(t){const e=this.serviceUrl,i=new th({"Content-Type":"application/json"});let n=new nh;return n=n.append("ageDays",t.toString()),this.log("Calling HTTP Request: "+e),this.http.get(e,{headers:i,params:n}).pipe(D(t=>t.files),Kh(t=>this.log(`fetched ${t.length} Log Files `)),Nh(this.handleError("getSysLog")))}getSysLog(t,e){const i=`${this.serviceUrl}/file/${t}/${e}`;this.log("Calling HTTP Request for a specific log file: "+i);let n=void 0;return n={},n.observe="body",n.responseType="text",this.http.get(i,n).pipe(Kh(()=>this.log("fetched Log File Response ")),Nh(this.handleError(`getSysLog name:${e} `)))}handleError(t="operation",e){return i=>(this.log(`HTTP Request ${t} failed: ${i.error.message} status:${i.status}, Result ${JSON.stringify(e)}`),jh(i))}log(t){this.messageService.add("VisboLogsService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(Rh),Kt(np))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function dO(t,e){if(1&t){const t=zs();Ns(0,"tr",16),Js("click",(function(){ei(t);const i=e.index;return Xs().helperFileIndex(i)}))("click",(function(){ei(t);const i=e.$implicit;return Xs().getVisboLogFile(i)})),Ns(1,"td",15),Ns(2,"a"),mo(3),Fs(),Fs(),Ns(4,"td",15),mo(5),Fs(),Ns(6,"td"),mo(7),Ua(8,"date"),Fs(),Ns(9,"td"),mo(10),Fs(),Ns(11,"td"),Ns(12,"button",29),Js("click",(function(){ei(t);const i=e.$implicit;return Xs().getVisboLogFile(i)})),mo(13,"i"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit,i=Xs();_n(3),fo(t.name),_n(2),fo(t.folder),_n(2),fo(Oa(8,4,t.updatedAt,"dd.MM HH:mm")),_n(3),fo(i.formatBytes(t.size,void 0))}}function uO(t,e){if(1&t){const t=zs();Ns(0,"div",30),Ns(1,"form"),Ns(2,"div",7),Ns(3,"label",31),mo(4,"VC:"),Fs(),Ns(5,"select",32),Js("ngModelChange",(function(e){return ei(t),Xs().logLevelSetting.value.VC=e})),Ns(6,"option",33),mo(7,"Fatal"),Fs(),Ns(8,"option",34),mo(9,"Warning"),Fs(),Ns(10,"option",35),mo(11,"Information"),Fs(),Ns(12,"option",36),mo(13,"Debug"),Fs(),Ns(14,"option",37),mo(15,"Trace"),Fs(),Fs(),Fs(),Ns(16,"div",7),Ns(17,"label",31),mo(18,"VP:"),Fs(),Ns(19,"select",38),Js("ngModelChange",(function(e){return ei(t),Xs().logLevelSetting.value.VP=e})),Ns(20,"option",33),mo(21,"Fatal"),Fs(),Ns(22,"option",34),mo(23,"Warning"),Fs(),Ns(24,"option",35),mo(25,"Information"),Fs(),Ns(26,"option",36),mo(27,"Debug"),Fs(),Ns(28,"option",37),mo(29,"Trace"),Fs(),Fs(),Fs(),Ns(30,"div",7),Ns(31,"label",31),mo(32,"VPV:"),Fs(),Ns(33,"select",39),Js("ngModelChange",(function(e){return ei(t),Xs().logLevelSetting.value.VPV=e})),Ns(34,"option",33),mo(35,"Fatal"),Fs(),Ns(36,"option",34),mo(37,"Warning"),Fs(),Ns(38,"option",35),mo(39,"Information"),Fs(),Ns(40,"option",36),mo(41,"Debug"),Fs(),Ns(42,"option",37),mo(43,"Trace"),Fs(),Fs(),Fs(),Ns(44,"div",7),Ns(45,"label",31),mo(46,"USER:"),Fs(),Ns(47,"select",40),Js("ngModelChange",(function(e){return ei(t),Xs().logLevelSetting.value.USER=e})),Ns(48,"option",33),mo(49,"Fatal"),Fs(),Ns(50,"option",34),mo(51,"Warning"),Fs(),Ns(52,"option",35),mo(53,"Information"),Fs(),Ns(54,"option",36),mo(55,"Debug"),Fs(),Ns(56,"option",37),mo(57,"Trace"),Fs(),Fs(),Fs(),Ns(58,"div",7),Ns(59,"label",31),mo(60,"MAIL:"),Fs(),Ns(61,"select",41),Js("ngModelChange",(function(e){return ei(t),Xs().logLevelSetting.value.MAIL=e})),Ns(62,"option",33),mo(63,"Fatal"),Fs(),Ns(64,"option",34),mo(65,"Warning"),Fs(),Ns(66,"option",35),mo(67,"Information"),Fs(),Ns(68,"option",36),mo(69,"Debug"),Fs(),Ns(70,"option",37),mo(71,"Trace"),Fs(),Fs(),Fs(),Ns(72,"div",7),Ns(73,"label",31),mo(74,"OTHER:"),Fs(),Ns(75,"select",42),Js("ngModelChange",(function(e){return ei(t),Xs().logLevelSetting.value.OTHER=e})),Ns(76,"option",33),mo(77,"Fatal"),Fs(),Ns(78,"option",34),mo(79,"Warning"),Fs(),Ns(80,"option",35),mo(81,"Information"),Fs(),Ns(82,"option",36),mo(83,"Debug"),Fs(),Ns(84,"option",37),mo(85,"Trace"),Fs(),Fs(),Fs(),Ns(86,"div",7),Ns(87,"label",31),mo(88,"All:"),Fs(),Ns(89,"select",43),Js("ngModelChange",(function(e){return ei(t),Xs().logLevelSetting.value.All=e})),Ns(90,"option",33),mo(91,"Fatal"),Fs(),Ns(92,"option",34),mo(93,"Warning"),Fs(),Ns(94,"option",35),mo(95,"Information"),Fs(),Ns(96,"option",36),mo(97,"Debug"),Fs(),Ns(98,"option",37),mo(99,"Trace"),Fs(),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs();_n(5),js("ngModel",t.logLevelSetting.value.VC),_n(14),js("ngModel",t.logLevelSetting.value.VP),_n(14),js("ngModel",t.logLevelSetting.value.VPV),_n(14),js("ngModel",t.logLevelSetting.value.USER),_n(14),js("ngModel",t.logLevelSetting.value.MAIL),_n(14),js("ngModel",t.logLevelSetting.value.OTHER),_n(14),js("ngModel",t.logLevelSetting.value.All)}}function hO(t,e){if(1&t){const t=zs();Ns(0,"tr",13),Js("click",(function(){ei(t);const i=e.index;return Xs().helperTaskIndex(i)})),Ns(1,"td"),Ns(2,"a"),mo(3),Fs(),Fs(),Ns(4,"td",14),mo(5),Ua(6,"date"),Fs(),Ns(7,"td",14),mo(8),Ua(9,"date"),Fs(),Ns(10,"td"),mo(11),Fs(),Ns(12,"td"),Ns(13,"button",15),mo(14,"i"),Fs(),Fs(),Fs()}if(2&t){const t=e.$implicit;_n(3),fo(t.name),_n(2),fo(Oa(6,4,t.value.lastRun,"dd.MM HH:mm:ss")),_n(3),fo(Oa(9,7,t.value.nextRun,"dd.MM HH:mm:ss")),_n(3),fo(t.value.taskSpecific&&t.value.taskSpecific.result)}}function pO(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"div",27),Ns(2,"label",28),mo(3,"Result:"),Fs(),Ns(4,"label",29),mo(5),Fs(),Fs(),Ns(6,"div",27),Ns(7,"label",28),mo(8,"Message:"),Fs(),Ns(9,"label",29),mo(10),Fs(),Fs(),Fs()),2&t){const t=Xs(3);_n(5),fo(t.vcsetting[t.taskIndex].value.taskSpecific.result),_n(5),fo(t.vcsetting[t.taskIndex].value.taskSpecific.resultDescription)}}function gO(t,e){if(1&t&&(Ns(0,"div"),Ns(1,"div",27),Ns(2,"label",28),mo(3,"Last Run:"),Fs(),Ns(4,"label",29),mo(5),Ua(6,"date"),Fs(),Fs(),Ns(7,"div",27),Ns(8,"label",28),mo(9,"Next Run:"),Fs(),Ns(10,"label",29),mo(11),Ua(12,"date"),Fs(),Fs(),Ns(13,"div",27),Ns(14,"label",28),mo(15,"Last Duration:"),Fs(),Ns(16,"label",29),mo(17),Ua(18,"date"),Fs(),Fs(),Gs(19,pO,11,2,"div",30),Fs()),2&t){const t=Xs(2);_n(5),fo(Oa(6,4,t.vcsetting[t.taskIndex].value.lastRun,"dd.MM HH:mm:ss")),_n(6),fo(Oa(12,7,t.vcsetting[t.taskIndex].value.nextRun,"dd.MM HH:mm:ss")),_n(6),fo(Oa(18,10,t.vcsetting[t.taskIndex].value.lastDuration,"mm:ss:SSS")),_n(2),js("ngIf",t.vcsetting[t.taskIndex].value.taskSpecific)}}function mO(t,e){if(1&t){const t=zs();Ns(0,"div",16),Ns(1,"div",17),Ns(2,"div",18),Ns(3,"h5",19),mo(4,"Detail of Task"),Fs(),Ns(5,"button",20),Ns(6,"span",21),mo(7,"\xd7"),Fs(),Fs(),Fs(),Ns(8,"div",22),Ns(9,"div",1),Ns(10,"div",23),Ns(11,"button",24),Js("click",(function(){return ei(t),Xs().pageTaskIndex(-1)})),mo(12,"Prev"),Fs(),Fs(),Ns(13,"div",25),Ns(14,"button",26),Js("click",(function(){return ei(t),Xs().pageTaskIndex(1)})),mo(15,"Next"),Fs(),Fs(),Fs(),Ns(16,"form"),Ns(17,"div",27),Ns(18,"label",28),mo(19,"Task:"),Fs(),Ns(20,"label",29),mo(21),Fs(),Fs(),Gs(22,gO,20,13,"div",30),Fs(),Fs(),Ns(23,"div",31),Ns(24,"button",32),mo(25,"Close"),Fs(),Ns(26,"button",33),Js("click",(function(){return ei(t),Xs().executeTask()})),mo(27,"Execute"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs();_n(21),vo("",t.vcsetting[t.taskIndex].name," "),_n(1),js("ngIf",t.vcsetting[t.taskIndex].value)}}function fO(t,e){if(1&t){const t=zs();Ns(0,"tr",11),Js("click",(function(){ei(t);const i=e.$implicit;return Xs().editConfigName(i.name)})),Ns(1,"td"),Ns(2,"a"),mo(3),Fs(),Fs(),Ns(4,"td"),mo(5),Fs(),Ns(6,"td"),mo(7),Ua(8,"date"),Fs(),Fs()}if(2&t){const t=e.$implicit,i=Xs();_n(3),fo(t.name),_n(2),fo(i.getMainInfo(t)),_n(2),fo(Oa(8,3,t.updatedAt,"dd.MM HH:mm:ss"))}}function vO(t,e){1&t&&(Ns(0,"h5",23),mo(1,"Config UI URL"),Fs())}function bO(t,e){1&t&&(Ns(0,"h5",23),mo(1,"Config Debug Setting"),Fs())}function yO(t,e){1&t&&(Ns(0,"h5",23),mo(1,"Config Password Policy"),Fs())}function CO(t,e){1&t&&(Ns(0,"h5",23),mo(1,"Config SMTP Setting"),Fs())}function VO(t,e){1&t&&(Ns(0,"h5",23),mo(1,"Config Redis Address"),Fs())}function wO(t,e){1&t&&(Ns(0,"h5",23),mo(1,"Config Maximum Log File Age"),Fs())}function AO(t,e){if(1&t){const t=zs();Ns(0,"form"),Ns(1,"div"),Ns(2,"div",24),Ns(3,"label",25),mo(4,"UI Url:"),Fs(),Ns(5,"input",26),Js("ngModelChange",(function(e){ei(t);const i=Xs(2);return i.vcsetting[i.editIndex].value.UIUrl=e})),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(5),js("ngModel",t.vcsetting[t.editIndex].value.UIUrl)}}function PO(t,e){if(1&t){const t=zs();Ns(0,"form"),Ns(1,"div"),Ns(2,"div",24),Ns(3,"label",27),mo(4,"PW Policy Regex:"),Fs(),Ns(5,"input",28),Js("ngModelChange",(function(e){ei(t);const i=Xs(2);return i.vcsetting[i.editIndex].value.PWPolicy=e})),Fs(),Fs(),Ns(6,"div",24),Ns(7,"label",29),mo(8,"PW Policy Description:"),Fs(),Ns(9,"textarea",30),Js("ngModelChange",(function(e){ei(t);const i=Xs(2);return i.vcsetting[i.editIndex].value.Description=e})),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(5),js("ngModel",t.vcsetting[t.editIndex].value.PWPolicy),_n(4),js("ngModel",t.vcsetting[t.editIndex].value.Description)}}function kO(t,e){if(1&t){const t=zs();Ns(0,"div"),Ns(1,"div",24),Ns(2,"label",31),mo(3,"SMTP Host:"),Fs(),Ns(4,"input",32),Js("ngModelChange",(function(e){ei(t);const i=Xs(3);return i.vcsetting[i.editIndex].value.host=e})),Fs(),Fs(),Ns(5,"div",24),Ns(6,"label",33),mo(7,"User:"),Fs(),Ns(8,"input",34),Js("ngModelChange",(function(e){ei(t);const i=Xs(3);return i.vcsetting[i.editIndex].value.auth.user=e})),Fs(),Fs(),Ns(9,"div",24),Ns(10,"label",35),mo(11,"Password:"),Fs(),Ns(12,"input",36),Js("ngModelChange",(function(e){ei(t);const i=Xs(3);return i.vcsetting[i.editIndex].value.auth.pass=e})),Fs(),Fs(),Ns(13,"div",24),Ns(14,"label",37),mo(15,"Port:"),Fs(),Ns(16,"input",38),Js("ngModelChange",(function(e){ei(t);const i=Xs(3);return i.vcsetting[i.editIndex].value.port=e})),Fs(),Fs(),Ns(17,"div",24),Ns(18,"label",39),mo(19,"Connection Timeout:"),Fs(),Ns(20,"input",40),Js("ngModelChange",(function(e){ei(t);const i=Xs(3);return i.vcsetting[i.editIndex].value.connectionTimeout=e})),Fs(),Fs(),Ns(21,"div",24),Ns(22,"label",41),mo(23,"Greeting Timeout:"),Fs(),Ns(24,"input",42),Js("ngModelChange",(function(e){ei(t);const i=Xs(3);return i.vcsetting[i.editIndex].value.greetingTimeout=e})),Fs(),Fs(),Ns(25,"div",43),Ns(26,"input",44,45),Js("ngModelChange",(function(e){ei(t);const i=Xs(3);return i.vcsetting[i.editIndex].value.pool=e})),Fs(),Ns(28,"label",46),mo(29,"Pool Connections"),Fs(),Fs(),Ns(30,"div",43),Ns(31,"input",47,48),Js("ngModelChange",(function(e){ei(t);const i=Xs(3);return i.vcsetting[i.editIndex].value.secure=e})),Fs(),Ns(33,"label",49),mo(34,"Secure Connection"),Fs(),Fs(),Ns(35,"div",43),Ns(36,"input",50,51),Js("ngModelChange",(function(e){ei(t);const i=Xs(3);return i.vcsetting[i.editIndex].value.requireTLS=e})),Fs(),Ns(38,"label",52),mo(39,"Require TLS"),Fs(),Fs(),Fs()}if(2&t){const t=Xs(3);_n(4),js("ngModel",t.vcsetting[t.editIndex].value.host),_n(4),js("ngModel",t.vcsetting[t.editIndex].value.auth.user),_n(4),js("ngModel",t.vcsetting[t.editIndex].value.auth.pass),_n(4),js("ngModel",t.vcsetting[t.editIndex].value.port),_n(4),js("ngModel",t.vcsetting[t.editIndex].value.connectionTimeout),_n(4),js("ngModel",t.vcsetting[t.editIndex].value.greetingTimeout),_n(2),js("ngModel",t.vcsetting[t.editIndex].value.pool),_n(5),js("ngModel",t.vcsetting[t.editIndex].value.secure),_n(5),js("ngModel",t.vcsetting[t.editIndex].value.requireTLS)}}function DO(t,e){if(1&t&&(Ns(0,"form"),Gs(1,kO,40,9,"div",19),Fs()),2&t){const t=Xs(2);_n(1),js("ngIf",t.editIndex>=0&&"SMTP"==t.vcsetting[t.editIndex].name)}}function MO(t,e){if(1&t){const t=zs();Ns(0,"form"),Ns(1,"div"),Ns(2,"div",24),Ns(3,"label",53),mo(4,"Host:"),Fs(),Ns(5,"input",54),Js("ngModelChange",(function(e){ei(t);const i=Xs(2);return i.vcsetting[i.editIndex].value.host=e})),Fs(),Fs(),Ns(6,"div",24),Ns(7,"label",55),mo(8,"Port:"),Fs(),Ns(9,"input",56),Js("ngModelChange",(function(e){ei(t);const i=Xs(2);return i.vcsetting[i.editIndex].value.port=e})),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(5),js("ngModel",t.vcsetting[t.editIndex].value.host),_n(4),js("ngModel",t.vcsetting[t.editIndex].value.port)}}function SO(t,e){if(1&t){const t=zs();Ns(0,"form"),Ns(1,"div",57),Ns(2,"label",58),mo(3,"VC:"),Fs(),Ns(4,"select",59),Js("ngModelChange",(function(e){ei(t);const i=Xs(2);return i.vcsetting[i.editIndex].value.VC=e})),Ns(5,"option",60),mo(6,"Fatal"),Fs(),Ns(7,"option",61),mo(8,"Warning"),Fs(),Ns(9,"option",62),mo(10,"Information"),Fs(),Ns(11,"option",63),mo(12,"Debug"),Fs(),Ns(13,"option",64),mo(14,"Trace"),Fs(),Fs(),Fs(),Ns(15,"div",57),Ns(16,"label",58),mo(17,"VP:"),Fs(),Ns(18,"select",65),Js("ngModelChange",(function(e){ei(t);const i=Xs(2);return i.vcsetting[i.editIndex].value.VP=e})),Ns(19,"option",60),mo(20,"Fatal"),Fs(),Ns(21,"option",61),mo(22,"Warning"),Fs(),Ns(23,"option",62),mo(24,"Information"),Fs(),Ns(25,"option",63),mo(26,"Debug"),Fs(),Ns(27,"option",64),mo(28,"Trace"),Fs(),Fs(),Fs(),Ns(29,"div",57),Ns(30,"label",58),mo(31,"VPV:"),Fs(),Ns(32,"select",66),Js("ngModelChange",(function(e){ei(t);const i=Xs(2);return i.vcsetting[i.editIndex].value.VPV=e})),Ns(33,"option",60),mo(34,"Fatal"),Fs(),Ns(35,"option",61),mo(36,"Warning"),Fs(),Ns(37,"option",62),mo(38,"Information"),Fs(),Ns(39,"option",63),mo(40,"Debug"),Fs(),Ns(41,"option",64),mo(42,"Trace"),Fs(),Fs(),Fs(),Ns(43,"div",57),Ns(44,"label",58),mo(45,"USER:"),Fs(),Ns(46,"select",67),Js("ngModelChange",(function(e){ei(t);const i=Xs(2);return i.vcsetting[i.editIndex].value.USER=e})),Ns(47,"option",60),mo(48,"Fatal"),Fs(),Ns(49,"option",61),mo(50,"Warning"),Fs(),Ns(51,"option",62),mo(52,"Information"),Fs(),Ns(53,"option",63),mo(54,"Debug"),Fs(),Ns(55,"option",64),mo(56,"Trace"),Fs(),Fs(),Fs(),Ns(57,"div",57),Ns(58,"label",58),mo(59,"MAIL:"),Fs(),Ns(60,"select",68),Js("ngModelChange",(function(e){ei(t);const i=Xs(2);return i.vcsetting[i.editIndex].value.MAIL=e})),Ns(61,"option",60),mo(62,"Fatal"),Fs(),Ns(63,"option",61),mo(64,"Warning"),Fs(),Ns(65,"option",62),mo(66,"Information"),Fs(),Ns(67,"option",63),mo(68,"Debug"),Fs(),Ns(69,"option",64),mo(70,"Trace"),Fs(),Fs(),Fs(),Ns(71,"div",57),Ns(72,"label",58),mo(73,"OTHER:"),Fs(),Ns(74,"select",69),Js("ngModelChange",(function(e){ei(t);const i=Xs(2);return i.vcsetting[i.editIndex].value.OTHER=e})),Ns(75,"option",60),mo(76,"Fatal"),Fs(),Ns(77,"option",61),mo(78,"Warning"),Fs(),Ns(79,"option",62),mo(80,"Information"),Fs(),Ns(81,"option",63),mo(82,"Debug"),Fs(),Ns(83,"option",64),mo(84,"Trace"),Fs(),Fs(),Fs(),Ns(85,"div",57),Ns(86,"label",58),mo(87,"All:"),Fs(),Ns(88,"select",70),Js("ngModelChange",(function(e){ei(t);const i=Xs(2);return i.vcsetting[i.editIndex].value.All=e})),Ns(89,"option",60),mo(90,"Fatal"),Fs(),Ns(91,"option",61),mo(92,"Warning"),Fs(),Ns(93,"option",62),mo(94,"Information"),Fs(),Ns(95,"option",63),mo(96,"Debug"),Fs(),Ns(97,"option",64),mo(98,"Trace"),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(4),js("ngModel",t.vcsetting[t.editIndex].value.VC),_n(14),js("ngModel",t.vcsetting[t.editIndex].value.VP),_n(14),js("ngModel",t.vcsetting[t.editIndex].value.VPV),_n(14),js("ngModel",t.vcsetting[t.editIndex].value.USER),_n(14),js("ngModel",t.vcsetting[t.editIndex].value.MAIL),_n(14),js("ngModel",t.vcsetting[t.editIndex].value.OTHER),_n(14),js("ngModel",t.vcsetting[t.editIndex].value.All)}}function IO(t,e){if(1&t){const t=zs();Ns(0,"form"),Ns(1,"div"),Ns(2,"div",24),Ns(3,"label",71),mo(4,"Max Age:"),Fs(),Ns(5,"input",72),Js("ngModelChange",(function(e){ei(t);const i=Xs(2);return i.vcsetting[i.editIndex].value.duration=e})),Fs(),Fs(),Fs(),Fs()}if(2&t){const t=Xs(2);_n(5),js("ngModel",t.vcsetting[t.editIndex].value.duration)}}function xO(t,e){if(1&t){const t=zs();Ns(0,"button",73),Js("click",(function(){ei(t);const e=Xs(2);return e.updateConfig(e.vcsetting[e.editIndex])})),mo(1,"Update"),Fs()}}function TO(t,e){if(1&t&&(Ns(0,"div",12),Ns(1,"div",13),Ns(2,"div",14),Gs(3,vO,2,0,"h5",15),Gs(4,bO,2,0,"h5",15),Gs(5,yO,2,0,"h5",15),Gs(6,CO,2,0,"h5",15),Gs(7,VO,2,0,"h5",15),Gs(8,wO,2,0,"h5",15),Ns(9,"button",16),Ns(10,"span",17),mo(11,"\xd7"),Fs(),Fs(),Fs(),Ns(12,"div",18),Gs(13,AO,6,1,"form",19),Gs(14,PO,10,2,"form",19),Gs(15,DO,2,1,"form",19),Gs(16,MO,10,2,"form",19),Gs(17,SO,99,7,"form",19),Gs(18,IO,6,1,"form",19),Fs(),Ns(19,"div",20),Ns(20,"button",21),mo(21,"Close"),Fs(),Gs(22,xO,2,0,"button",22),Fs(),Fs(),Fs()),2&t){const t=Xs();_n(3),js("ngIf","UI URL"==t.vcsetting[t.editIndex].name),_n(1),js("ngIf","DEBUG"==t.vcsetting[t.editIndex].name),_n(1),js("ngIf","PW Policy"==t.vcsetting[t.editIndex].name),_n(1),js("ngIf","SMTP"==t.vcsetting[t.editIndex].name),_n(1),js("ngIf","REDIS"==t.vcsetting[t.editIndex].name),_n(1),js("ngIf","Log Age"==t.vcsetting[t.editIndex].name),_n(5),js("ngIf","UI URL"==t.vcsetting[t.editIndex].name),_n(1),js("ngIf","PW Policy"==t.vcsetting[t.editIndex].name),_n(1),js("ngIf","SMTP"==t.vcsetting[t.editIndex].name),_n(1),js("ngIf","REDIS"==t.vcsetting[t.editIndex].name),_n(1),js("ngIf","DEBUG"==t.vcsetting[t.editIndex].name),_n(1),js("ngIf","Log Age"==t.vcsetting[t.editIndex].name),_n(4),js("ngIf",t.hasSystemPerm(t.permSystem.Modify))}}const _O=[{path:"login",component:Gv},{path:"register",component:Wv},{path:"registerconfirm",component:Yv},{path:"oauthconfirm",component:Xv},{path:"register/:id",component:Wv},{path:"pwforgotten",component:sb},{path:"pwreset",component:ub},{path:"dashboard",component:Pb,canActivate:[tb]},{path:"vc",component:Sb,canActivate:[tb]},{path:"vcDetail/:id",component:aC,canActivate:[tb]},{path:"vcAudit/:id",component:BC,canActivate:[tb]},{path:"vp",component:qA,canActivate:[tb]},{path:"vp/:id",component:qA,canActivate:[tb]},{path:"vpDetail/:id",component:Ok,canActivate:[tb]},{path:"vpAudit/:id",component:vV,canActivate:[tb]},{path:"vpViewCost/:id",component:ex,canActivate:[tb]},{path:"vpViewDeadlines/:id",component:ex,canActivate:[tb]},{path:"vpViewDeliveries/:id",component:ex,canActivate:[tb]},{path:"vpView/:id",component:ex,canActivate:[tb]},{path:"vpKeyMetrics/:id",component:ex,canActivate:[tb]},{path:"vpRestrict/:id",component:vx,canActivate:[tb]},{path:"vpv",component:rD,canActivate:[tb]},{path:"vpv/:id",component:rD,canActivate:[tb]},{path:"vpf/:id",component:AD,canActivate:[tb]},{path:"settings",component:bx,canActivate:[tb]},{path:"profile",component:Ex,canActivate:[tb]},{path:"sysadmins",component:e_,canActivate:[tb]},{path:"sysvc",component:a_,canActivate:[tb]},{path:"sysvcDetail/:id",component:DU,canActivate:[tb]},{path:"sysvp/:id",component:_U,canActivate:[tb]},{path:"sysvpDetail/:id",component:pE,canActivate:[tb]},{path:"sysaudit",component:NE,canActivate:[tb]},{path:"sysuser",component:lO,canActivate:[tb]},{path:"syslog",component:(()=>{class t{constructor(t,e,i,n,r){this.visbocenterService=t,this.visbosettingService=e,this.syslogService=i,this.messageService=n,this.alertService=r}ngOnInit(){this.systemVC=this.visbocenterService.getSysVCId(),this.ageDays=3,this.sortColumn=2,this.getVisboLogs(),this.sortTable(1),this.log("syslog init VC ID "+this.systemVC)}getVisboLogs(){this.log("syslog getVisboLogs"),this.sortAscending=!this.sortAscending,this.syslogService.getSysLogs(this.ageDays).subscribe(t=>{this.files=t,this.sortTable(this.sortColumn),this.log("get Logs success")},t=>{this.log(`get Logs failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}helperFileIndex(t){this.fileIndex=t}switchView(){this.logDataShow=!this.logDataShow}getVisboLogFile(t){this.log("syslog getVisboLogFile"),this.syslogService.getSysLog(t.folder,t.name).subscribe(e=>{this.log("get Log Content success Start: "+e.substring(0,30)),this.downloadFile(e,t.name)},t=>{this.log(`get Log Content failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}getLogLevel(){this.log("syslog getLogLevel"),this.visbosettingService.getVCSettingByName(this.systemVC,"DEBUG",!0).subscribe(t=>{this.logLevelSetting=t[0],this.log("get Log Level success "+JSON.stringify(this.logLevelSetting))},t=>{this.log(`get Log Level failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}setLogLevel(){this.log("syslog setLogLevel"),this.visbosettingService.updateVCSetting(this.systemVC,this.logLevelSetting,!0).subscribe(t=>{this.log("set Log Level success "+JSON.stringify(t)),this.alertService.success("Successfully changed Log Level",!0),this.logLevelSetting=t},t=>{this.log(`set Log Level failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}downloadFile(t,e){this.log("download File succeeded Len: "+t.length);const i=new Blob([t],{type:"text/plain"}),n=window.URL.createObjectURL(i);this.log("Open URL "+n);const r=document.createElement("a");document.body.appendChild(r),r.href=n,r.download=e+".log",r.click(),window.URL.revokeObjectURL(n)}formatBytes(t,e=2){if(0===t)return"0 Bytes";const i=e||2,n=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,n)).toFixed(i))+" "+["Bytes","KB","MB","GB"][n]}sortTable(t){this.files&&(void 0===t&&void 0!==this.sortColumn||(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t:!this.sortAscending),1===this.sortColumn?this.files.sort((function(t,e){return xh(t.name,e.name)})):2===this.sortColumn?this.files.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})):3===this.sortColumn&&this.files.sort((function(t,e){return t.size-e.size})),this.sortAscending||this.files.reverse())}log(t){this.messageService.add("Sys Logs: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(xv),Rs(Ib),Rs(cO),Rs(Rh),Rs(Df))},t.\u0275cmp=le({type:t,selectors:[["app-syslog"]],decls:62,vars:3,consts:[[1,"well"],[1,"container-fluid"],[1,"row"],[1,"col"],[1,"panel-heading"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group","row"],["for","auditCount",1,"col-form-label"],["name","ageDays",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-primary","mx-1",3,"click"],["type","button","data-toggle","modal","data-target","#ChangeLogLevel",1,"btn","btn-sm","btn-primary","float-right",3,"click"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[1,"d-none","d-md-table-cell",3,"click"],[1,"d-none","d-md-table-cell"],[3,"click"],[3,"click",4,"ngFor","ngForOf"],["id","ChangeLogLevel","tabindex","-1","role","dialog","aria-labelledby","ChangeLogLevelTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","ChangeLogLevelTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],["class","modal-body",4,"ngIf"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"],["title","Save As",1,"Detail",3,"click"],[1,"modal-body"],[1,"col-3","col-form-label"],["name","VC",1,"col-8","form-control",3,"ngModel","ngModelChange"],["value","fatal"],["value","warn"],["value","info"],["value","debug"],["value","trace"],["name","VP",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","VPV",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","USER",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","MAIL",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","OTHER",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","All",1,"col-8","form-control",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(Bs(0,"app-sysnavbar"),Ns(1,"div",0),Ns(2,"div",1),Ns(3,"div",2),Ns(4,"div",3),Ns(5,"h2",4),mo(6," Visbo Log Files "),Fs(),Fs(),Fs(),Ns(7,"div",3),Ns(8,"form",5,6),Js("ngSubmit",(function(){return e.getVisboLogs()})),Ns(10,"div",7),Ns(11,"label",8),mo(12,"Max age in days:"),Fs(),Ns(13,"select",9),Js("ngModelChange",(function(t){return e.ageDays=t})),Ns(14,"option"),mo(15,"0"),Fs(),Ns(16,"option"),mo(17,"3"),Fs(),Ns(18,"option"),mo(19,"7"),Fs(),Ns(20,"option"),mo(21,"30"),Fs(),Ns(22,"option"),mo(23,"365"),Fs(),Fs(),Ns(24,"button",10),Js("click",(function(){return e.getVisboLogs()})),mo(25,"Refresh"),Fs(),Ns(26,"div",3),Ns(27,"button",11),Js("click",(function(){return e.getLogLevel()})),mo(28,"Change Log Level"),Fs(),Fs(),Fs(),Fs(),Fs(),Fs(),Ns(29,"div"),Ns(30,"div",1),Ns(31,"div",12),Ns(32,"table",13),Ns(33,"thead"),Ns(34,"tr"),Ns(35,"th",14),Js("click",(function(){return e.sortTable(1)})),mo(36,"Name"),Fs(),Ns(37,"th",15),mo(38,"Host"),Fs(),Ns(39,"th",16),Js("click",(function(){return e.sortTable(2)})),mo(40,"Modified"),Fs(),Ns(41,"th",16),Js("click",(function(){return e.sortTable(3)})),mo(42," Size"),Fs(),Ns(43,"th"),mo(44,"Detail"),Fs(),Fs(),Fs(),Ns(45,"tbody"),Gs(46,dO,14,7,"tr",17),Fs(),Fs(),Fs(),Fs(),Fs(),Fs(),Ns(47,"div",18),Ns(48,"div",19),Ns(49,"div",20),Ns(50,"div",21),Ns(51,"h5",22),mo(52,"Change Log Level"),Fs(),Ns(53,"button",23),Ns(54,"span",24),mo(55,"\xd7"),Fs(),Fs(),Fs(),Gs(56,uO,100,7,"div",25),Ns(57,"div",26),Ns(58,"button",27),mo(59,"Close"),Fs(),Ns(60,"button",28),Js("click",(function(){return e.setLogLevel()})),mo(61,"Save"),Fs(),Fs(),Fs(),Fs(),Fs()),2&t&&(_n(13),js("ngModel",e.ageDays),_n(33),js("ngForOf",e.files),_n(10),js("ngIf",e.logLevelSetting))},directives:[gC,Ou,Fd,Tu,cu,Nd,Eu,du,gu,Lc,jc],pipes:[qc],encapsulation:2}),t})(),canActivate:[tb]},{path:"systasks",component:(()=>{class t{constructor(t,e,i,n){this.visbocenterService=t,this.visbosettingService=e,this.messageService=i,this.alertService=n}ngOnInit(){this.systemVC=this.visbocenterService.getSysVCId(),this.getVisboTasks()}getVisboTasks(){this.log("getVisboTasks"),this.visbosettingService.getVCSettingByType(this.systemVC,"Task",!0).subscribe(t=>{this.vcsetting=t,this.sortTable(void 0),this.log("get Settings success "+t.length),this.alertService.clear()},t=>{this.log(`get Settings failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}helperTaskIndex(t){this.taskIndex=t}pageTaskIndex(t){let e;e=this.taskIndex+t,e<0&&(e=0),e>=this.vcsetting.length&&(e=this.vcsetting.length-1),this.taskIndex=e}executeTask(){this.log(`execute Task Immediately: ${this.vcsetting[this.taskIndex].name} `),this.vcsetting[this.taskIndex].value.nextRun=new Date,this.visbosettingService.updateVCSetting(this.systemVC,this.vcsetting[this.taskIndex],!0).subscribe(t=>{this.log("execute Task success "+JSON.stringify(t)),this.alertService.success("Successfully set Task to execute",!1),this.vcsetting[this.taskIndex]=t},t=>{this.log(`execute Task failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}sortTable(t){this.vcsetting&&(void 0===t&&void 0!==this.sortColumn||(void 0===this.sortColumn&&(this.sortColumn=1),t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?0===t:!this.sortAscending),1===this.sortColumn?this.vcsetting.sort((function(t,e){return xh(t.name,e.name)})):2===this.sortColumn?this.vcsetting.sort((function(t,e){let i=0;return t.value.lastRun>e.value.lastRun?i=1:t.value.lastRun<e.value.lastRun&&(i=-1),i})):3===this.sortColumn?this.vcsetting.sort((function(t,e){let i=0;return t.value.nextRun>e.value.nextRun?i=1:t.value.nextRun<e.value.nextRun&&(i=-1),i})):4===this.sortColumn&&this.vcsetting.sort((function(t,e){let i=0,n=0;return t.value.taskSpecific&&t.value.taskSpecific.result&&(i=t.value.taskSpecific.result),e.value.taskSpecific&&e.value.taskSpecific.result&&(n=e.value.taskSpecific.result),i-n})),this.sortAscending||this.vcsetting.reverse())}log(t){this.messageService.add("Sys Tasks: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(xv),Rs(Ib),Rs(Rh),Rs(Df))},t.\u0275cmp=le({type:t,selectors:[["app-systasks"]],decls:29,vars:2,consts:[[1,"well"],[1,"row"],[1,"col"],[1,"panel-heading"],["type","button",1,"btn","btn-primary","float-right",3,"click"],[1,"container-fluid"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[3,"click"],[1,"d-none","d-md-table-cell",3,"click"],["data-toggle","modal","data-target","#TaskDetail",3,"click",4,"ngFor","ngForOf"],["id","TaskDetail","tabindex","-1","role","dialog","aria-labelledby","Task Detail","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-lg modal-dialog-centered","role","document",4,"ngIf"],["data-toggle","modal","data-target","#TaskDetail",3,"click"],[1,"d-none","d-md-table-cell"],["title","detail",1,"Detail"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","TaskDetailTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"col-10"],["type","button","title","Prev Task",1,"btn","btn-secondary",3,"click"],[1,"col-2"],["type","button","title","Next Task",1,"btn","btn-secondary","align-self-end",3,"click"],[1,"form-group"],[1,"col-4","col-form-label"],[1,"col-7","form-control-static"],[4,"ngIf"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(Bs(0,"app-sysnavbar"),Ns(1,"div",0),Ns(2,"div",1),Ns(3,"div",2),Ns(4,"h2",3),mo(5," Visbo Task System View "),Fs(),Fs(),Ns(6,"div",2),Ns(7,"button",4),Js("click",(function(){return e.getVisboTasks()})),mo(8,"Refresh"),Fs(),Fs(),Fs(),Ns(9,"div"),Ns(10,"div",5),Ns(11,"div",6),Ns(12,"table",7),Ns(13,"thead"),Ns(14,"tr"),Ns(15,"th",8),Js("click",(function(){return e.sortTable(1)})),mo(16,"Name"),Fs(),Ns(17,"th",9),Js("click",(function(){return e.sortTable(2)})),mo(18,"Last Run"),Fs(),Ns(19,"th",9),Js("click",(function(){return e.sortTable(3)})),mo(20,"Next Run"),Fs(),Ns(21,"th",8),Js("click",(function(){return e.sortTable(4)})),mo(22,"Last Result"),Fs(),Ns(23,"th"),mo(24,"Detail"),Fs(),Fs(),Fs(),Ns(25,"tbody"),Gs(26,hO,15,10,"tr",10),Fs(),Fs(),Fs(),Fs(),Fs(),Fs(),Ns(27,"div",11),Gs(28,mO,28,2,"div",12),Fs()),2&t&&(_n(26),js("ngForOf",e.vcsetting),_n(2),js("ngIf",e.taskIndex>=0&&e.taskIndex<e.vcsetting.length))},directives:[gC,Lc,jc,Ou,Fd,Tu],pipes:[qc],styles:[""]}),t})(),canActivate:[tb]},{path:"sysconfig",component:(()=>{class t{constructor(t,e,i,n){this.visbocenterService=t,this.visbosettingService=e,this.messageService=i,this.alertService=n,this.combinedPerm=void 0,this.permSystem=wv}ngOnInit(){this.systemVC=this.visbocenterService.getSysVCId(),this.getVisboConfig(),this.combinedPerm=this.visbocenterService.getSysAdminRole()}getVisboConfig(){this.log("get VisboConfig Values"),this.visbosettingService.getVCSettingByType(this.systemVC,"SysConfig",!0).subscribe(t=>{this.vcsetting=t,this.sortTable(1),this.log("get Settings success "+t.length)},t=>{this.log(`get Settings failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}getMainInfo(t){let e="";if(t.value)switch(t.name){case"UI URL":e=t.value.UIUrl;break;case"SMTP":e=t.value.auth&&t.value.auth.user;break;case"PW Policy":e=(t.value.Description||"").substring(0,60).concat("...");break;case"DEBUG":e=JSON.stringify(t.value).substring(0,60).concat("...");break;case"Log Age":e=t.value.duration;break;case"REDIS":e=t.value.host}return e||""}helperConfigName(t){for(let e=0;e<this.vcsetting.length;e++)if(this.vcsetting[e].name===t)return e}editConfigName(t){this.log("Edit Config  "+t);for(let e=0;e<this.vcsetting.length;e++)if(this.vcsetting[e].name===t)return this.editIndex=e,e}updateConfig(t){this.log("Update Config  "+JSON.stringify(t)),this.visbosettingService.updateVCSetting(this.systemVC,t,!0).subscribe(e=>{this.log("set System Config success "+JSON.stringify(e)),this.alertService.success("Successfully changed System Configuration",!0),this.vcsetting[this.helperConfigName(t.name)]=e},t=>{this.log(`set System Config failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Lh(t))})}hasSystemPerm(t){return(this.combinedPerm.system&t)>0}sortTable(t){this.vcsetting&&(void 0===t&&void 0!==this.sortColumn||(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t:!this.sortAscending),1===this.sortColumn?this.vcsetting.sort((function(t,e){return xh(t.name,e.name)})):3===this.sortColumn&&this.vcsetting.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})),this.sortAscending||this.vcsetting.reverse())}log(t){this.messageService.add("Sys Config: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rs(xv),Rs(Ib),Rs(Rh),Rs(Df))},t.\u0275cmp=le({type:t,selectors:[["app-sysconfig"]],decls:21,vars:2,consts:[[1,"well"],[1,"row"],[1,"panel-heading"],[1,"container-fluid"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[3,"click"],[1,"d-none","d-md-table-cell",3,"click"],["data-toggle","modal","data-target","#ConfigValue",3,"click",4,"ngFor","ngForOf"],["id","ConfigValue","tabindex","-1","role","dialog","aria-labelledby","Config Value","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-lg modal-dialog-centered","role","document",4,"ngIf"],["data-toggle","modal","data-target","#ConfigValue",3,"click"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["class","modal-title","id","ConfigDetailTitle",4,"ngIf"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[4,"ngIf"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button","class","btn btn-primary","data-dismiss","modal",3,"click",4,"ngIf"],["id","ConfigDetailTitle",1,"modal-title"],[1,"form-group"],["for","configUIUrl",1,"col-3","col-form-label"],["type","text","name","configUIUrl","placeholder","URL for Web UI",1,"col-7","form-control",3,"ngModel","ngModelChange"],["for","configPWPolicy",1,"col-4","col-form-label"],["type","text","name","configPWPolicy",1,"form-control",3,"ngModel","ngModelChange"],["for","configPWPolicyDesc",1,"col-4","col-form-label"],["name","configPWPolicyDesc",1,"form-control",3,"ngModel","ngModelChange"],["for","configSMTPHost",1,"col-4","col-form-label"],["type","text","name","configSMTPHost",1,"form-control",3,"ngModel","ngModelChange"],["for","configSMTPUser",1,"col-4","col-form-label"],["type","text","name","configSMTPUser",1,"form-control",3,"ngModel","ngModelChange"],["for","configSMTPUserPW",1,"col-4","col-form-label"],["type","password","name","configSMTPUserPW",1,"form-control",3,"ngModel","ngModelChange"],["for","configSMTPPort",1,"col-4","col-form-label"],["type","number","name","configSMTPPort",1,"form-control",3,"ngModel","ngModelChange"],["for","configSMTPConTimeout",1,"col-4","col-form-label"],["type","number","name","configSMTPConTimeout",1,"form-control",3,"ngModel","ngModelChange"],["for","configSMTPGreetTimeout",1,"col-4","col-form-label"],["type","number","name","configSMTPGreetTimeout",1,"form-control",3,"ngModel","ngModelChange"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","check1","name","configSMTPPool",1,"custom-control-input",3,"ngModel","ngModelChange"],["configSMTPPool","ngModel"],["for","check1",1,"custom-control-label"],["type","checkbox","id","check2","name","configSMTPSecure",1,"custom-control-input",3,"ngModel","ngModelChange"],["configSMTPSecure","ngModel"],["for","check2",1,"custom-control-label"],["type","checkbox","id","check3","name","configSMTPTls",1,"custom-control-input",3,"ngModel","ngModelChange"],["configSMTPTls","ngModel"],["for","check3",1,"custom-control-label"],["for","configREDISHost",1,"col-4","col-form-label"],["type","text","name","configREDISHost",1,"form-control",3,"ngModel","ngModelChange"],["for","configREDISPort",1,"col-4","col-form-label"],["type","number","name","configREDISPort",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group","row"],[1,"col-3","col-form-label"],["name","VC",1,"col-8","form-control",3,"ngModel","ngModelChange"],["value","fatal"],["value","warn"],["value","info"],["value","debug"],["value","trace"],["name","VP",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","VPV",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","USER",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","MAIL",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","OTHER",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","All",1,"col-8","form-control",3,"ngModel","ngModelChange"],["for","configLogAge",1,"col-4","col-form-label"],["type","number","name","configLogAge",1,"form-control",3,"ngModel","ngModelChange"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(Bs(0,"app-sysnavbar"),Ns(1,"div",0),Ns(2,"div",1),Ns(3,"h2",2),mo(4," Visbo Config System View "),Fs(),Fs(),Ns(5,"div"),Ns(6,"div",3),Ns(7,"div",4),Ns(8,"table",5),Ns(9,"thead"),Ns(10,"tr"),Ns(11,"th",6),Js("click",(function(){return e.sortTable(1)})),mo(12,"Name"),Fs(),Ns(13,"th",7),Js("click",(function(){return e.sortTable(2)})),mo(14,"Info"),Fs(),Ns(15,"th",6),Js("click",(function(){return e.sortTable(3)})),mo(16,"Updated"),Fs(),Fs(),Fs(),Ns(17,"tbody"),Gs(18,fO,9,6,"tr",8),Fs(),Fs(),Fs(),Fs(),Fs(),Fs(),Ns(19,"div",9),Gs(20,TO,23,13,"div",10),Fs()),2&t&&(_n(18),js("ngForOf",e.vcsetting),_n(2),js("ngIf",e.vcsetting&&e.editIndex>=0))},directives:[gC,Lc,jc,Ou,Fd,Tu,Od,Nd,Eu,eu,_d,cu,du,gu],pipes:[qc],styles:[""]}),t})(),canActivate:[tb]},{path:"",redirectTo:"/dashboard",pathMatch:"full"},{path:"**",redirectTo:"/dashboard"}];let UO=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[vf.forRoot(_O,{onSameUrlNavigation:"reload"})],vf]}),t})();class EO{constructor(t,e="/assets/i18n/",i=".json"){this.http=t,this.prefix=e,this.suffix=i}getTranslation(t){return this.http.get(`${this.prefix}${t}${this.suffix}`)}}let OO=(()=>{class t{constructor(t,e){this.authenticationService=t,this.alertService=e}intercept(t,e){const i=JSON.parse(localStorage.getItem("currentToken"));return i&&(t=t.clone({setHeaders:{"access-key":""+i}})),e.handle(t).pipe(Nh(t=>(t&&401===t.status&&(console.log("Interceptor: Session Expired, redirect to login"),this.authenticationService.logout(),this.alertService.error("Session expired",!0),location.reload()),jh(t))))}}return t.\u0275fac=function(e){return new(e||t)(Kt(sp),Kt(Df))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const GO={provide:np,useFactory:()=>{const t=new np,e=(window||{}).__env||{};for(const i in e)e.hasOwnProperty(i)&&(t[i]=window.__env[i]);return t},deps:[]};let LO=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[],imports:[[Qc,IV]]}),t})(),RO=(()=>{class t{}return t.\u0275mod=he({type:t,bootstrap:[Cv]}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[Md,tb,Df,sp,Cx,xv,Ib,fb,wV,dC,BE,cO,{provide:fh,useClass:OO,multi:!0},Rh,GO],imports:[[kd,qu,UO,SV,Ih,lv.forRoot({loader:{provide:Nf,useFactory:jO,deps:[gh]}}),LO]]}),t})();function jO(t){return new EO(t)}Ad().bootstrapModule(RO)}},[[0,0]]]);