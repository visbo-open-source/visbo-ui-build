(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(t,e,i){t.exports=i("zUnb")},KtZj:function(t,e,i){"use strict";var n,s;"undefined"!=typeof window&&window,void 0===(s="function"==typeof(n=function(){if("undefined"==typeof window)return null;var t="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),e=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||function(e){return t.setTimeout(e,20)},i=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||function(e){t.clearTimeout(e)};function n(t,e){var i=Object.prototype.toString.call(t),n="[object Array]"===i||"[object NodeList]"===i||"[object HTMLCollection]"===i||"[object Object]"===i||"undefined"!=typeof jQuery&&t instanceof jQuery||"undefined"!=typeof Elements&&t instanceof Elements,s=0,r=t.length;if(n)for(;s<r;s++)e(t[s]);else e(t)}function s(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var e=t.getBoundingClientRect();return{width:Math.round(e.width),height:Math.round(e.height)}}function r(t,e){Object.keys(e).forEach((function(i){t.style[i]=e[i]}))}var o=function(t,a){var l=0;function c(){var t,e,i=[];this.add=function(t){i.push(t)},this.call=function(n){for(t=0,e=i.length;t<e;t++)i[t].call(this,n)},this.remove=function(n){var s=[];for(t=0,e=i.length;t<e;t++)i[t]!==n&&s.push(i[t]);i=s},this.length=function(){return i.length}}n(t,(function(t){!function(t,i){if(t)if(t.resizedAttached)t.resizedAttached.add(i);else{t.resizedAttached=new c,t.resizedAttached.add(i),t.resizeSensor=document.createElement("div"),t.resizeSensor.dir="ltr",t.resizeSensor.className="resize-sensor";var n={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},o={position:"absolute",left:"0px",top:"0px",transition:"0s"};r(t.resizeSensor,n);var a=document.createElement("div");a.className="resize-sensor-expand",r(a,n);var d=document.createElement("div");r(d,o),a.appendChild(d);var u=document.createElement("div");u.className="resize-sensor-shrink",r(u,n);var h=document.createElement("div");r(h,o),r(h,{width:"200%",height:"200%"}),u.appendChild(h),t.resizeSensor.appendChild(a),t.resizeSensor.appendChild(u),t.appendChild(t.resizeSensor);var p=window.getComputedStyle(t),g=p?p.getPropertyValue("position"):null;"absolute"!==g&&"relative"!==g&&"fixed"!==g&&"sticky"!==g&&(t.style.position="relative");var m=!1,f=0,v=s(t),b=0,y=0,C=!0;l=0;var V=function(){if(C){if(0===t.offsetWidth&&0===t.offsetHeight)return void(l||(l=e((function(){l=0,V()}))));C=!1}var i,n;n=t.offsetHeight,d.style.width=(i=t.offsetWidth)+10+"px",d.style.height=n+10+"px",a.scrollLeft=i+10,a.scrollTop=n+10,u.scrollLeft=i+10,u.scrollTop=n+10};t.resizeSensor.resetSensor=V;var w=function(){f=0,m&&(b=v.width,y=v.height,t.resizedAttached&&t.resizedAttached.call(v))},A=function(){v=s(t),(m=v.width!==b||v.height!==y)&&!f&&(f=e(w)),V()},P=function(t,e,i){t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener(e,i)};P(a,"scroll",A),P(u,"scroll",A),l=e((function(){l=0,V()}))}}(t,a)})),this.detach=function(e){l||(i(l),l=0),o.detach(t,e)},this.reset=function(){t.resizeSensor.resetSensor()}};if(o.reset=function(t){n(t,(function(t){t.resizeSensor.resetSensor()}))},o.detach=function(t,e){n(t,(function(t){t&&(t.resizedAttached&&"function"==typeof e&&(t.resizedAttached.remove(e),t.resizedAttached.length())||t.resizeSensor&&(t.contains(t.resizeSensor)&&t.removeChild(t.resizeSensor),delete t.resizeSensor,delete t.resizedAttached))}))},"undefined"!=typeof MutationObserver){var a=new MutationObserver((function(t){for(var e in t)if(t.hasOwnProperty(e))for(var i=t[e].addedNodes,n=0;n<i.length;n++)i[n].resizeSensor&&o.reset(i[n])}));document.addEventListener("DOMContentLoaded",(function(t){a.observe(document.body,{childList:!0,subtree:!0})}))}return o})?n.call(e,i,e,t):n)||(t.exports=s)},crnd:function(t,e){function i(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}i.keys=function(){return[]},i.resolve=i,t.exports=i,i.id="crnd"},h9Sk:function(t,e,i){t.exports={ResizeSensor:i("KtZj"),ElementQueries:i("rnKy")}},rnKy:function(t,e,i){"use strict";var n,s,r;"undefined"!=typeof window&&window,s=[i("KtZj")],void 0===(r="function"==typeof(n=function(t){var e=function(){var e,i={},n=[];function s(t){t||(t=document.documentElement);var e=window.getComputedStyle(t,null).fontSize;return parseFloat(e)||16}function r(t,e){var i=e.split(/\d/),n=i[i.length-1];switch(e=parseFloat(e),n){case"px":return e;case"em":return e*s(t);case"rem":return e*s();case"vw":return e*document.documentElement.clientWidth/100;case"vh":return e*document.documentElement.clientHeight/100;case"vmin":case"vmax":var r=document.documentElement.clientWidth/100,o=document.documentElement.clientHeight/100;return e*(0,Math["vmin"===n?"min":"max"])(r,o);default:return e}}function o(t,e){var n,s,o,a,l,c,d,u;this.element=t;var h=["min-width","min-height","max-width","max-height"];this.call=function(){for(n in o=function(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var e=t.getBoundingClientRect();return{width:Math.round(e.width),height:Math.round(e.height)}}(this.element),c={},i[e])i[e].hasOwnProperty(n)&&(a=r(this.element,(s=i[e][n]).value),l="width"===s.property?o.width:o.height,d="","min"===s.mode&&l>=a&&(d+=s.value),"max"===s.mode&&l<=a&&(d+=s.value),c[u=s.mode+"-"+s.property]||(c[u]=""),d&&-1===(" "+c[u]+" ").indexOf(" "+d+" ")&&(c[u]+=" "+d));for(var t in h)h.hasOwnProperty(t)&&(c[h[t]]?this.element.setAttribute(h[t],c[h[t]].substr(1)):this.element.removeAttribute(h[t]))}}function a(e,i){e.elementQueriesSetupInformation||(e.elementQueriesSetupInformation=new o(e,i)),e.elementQueriesSensor||(e.elementQueriesSensor=new t(e,(function(){e.elementQueriesSetupInformation.call()})))}function l(t,s,r,o){if(void 0===i[t]){i[t]=[];var a=n.length;e.innerHTML+="\n"+t+" {animation: 0.1s element-queries;}",e.innerHTML+="\n"+t+" > .resize-sensor {min-width: "+a+"px;}",n.push(t)}i[t].push({mode:s,property:r,value:o})}function c(t){var e;if(document.querySelectorAll&&(e=t?t.querySelectorAll.bind(t):document.querySelectorAll.bind(document)),e||"undefined"==typeof $$||(e=$$),e||"undefined"==typeof jQuery||(e=jQuery),!e)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return e}function d(e){var i=[],n=[],s=[],r=0,o=-1,a=[];for(var l in e.children)if(e.children.hasOwnProperty(l)&&e.children[l].tagName&&"img"===e.children[l].tagName.toLowerCase()){i.push(e.children[l]);var c=e.children[l].getAttribute("min-width")||e.children[l].getAttribute("data-min-width"),d=e.children[l].getAttribute("data-src")||e.children[l].getAttribute("url");s.push(d),n.push({minWidth:c}),c?e.children[l].style.display="none":(r=i.length-1,e.children[l].style.display="block")}function u(){var t,l=!1;for(t in i)i.hasOwnProperty(t)&&n[t].minWidth&&e.offsetWidth>n[t].minWidth&&(l=t);if(l||(l=r),o!==l)if(a[l])i[o].style.display="none",i[l].style.display="block",o=l;else{var c=new Image;c.onload=function(){i[l].src=s[l],i[o].style.display="none",i[l].style.display="block",a[l]=!0,o=l},c.src=s[l]}else i[l].src=s[l]}o=r,e.resizeSensorInstance=new t(e,u),u()}var u=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,h=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function p(t){var e,i,n,s;for(t=t.replace(/'/g,'"');null!==(e=u.exec(t));)for(i=e[1]+e[3],n=e[2];null!==(s=h.exec(n));)l(i,s[1],s[2],s[3])}function g(t){var e="";if(t)if("string"==typeof t)-1===(t=t.toLowerCase()).indexOf("min-width")&&-1===t.indexOf("max-width")||p(t);else for(var i=0,n=t.length;i<n;i++)1===t[i].type?-1!==(e=t[i].selectorText||t[i].cssText).indexOf("min-height")||-1!==e.indexOf("max-height")?p(e):-1===e.indexOf("min-width")&&-1===e.indexOf("max-width")||p(e):4===t[i].type?g(t[i].cssRules||t[i].rules):3===t[i].type&&t[i].styleSheet.hasOwnProperty("cssRules")&&g(t[i].styleSheet.cssRules)}var m=!1;this.init=function(){var i="animationstart";void 0!==document.documentElement.style.webkitAnimationName?i="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?i="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(i="oanimationstart"),document.body.addEventListener(i,(function(e){var i=e.target,s=i&&window.getComputedStyle(i,null),r=s&&s.getPropertyValue("animation-name");if(r&&-1!==r.indexOf("element-queries")){i.elementQueriesSensor=new t(i,(function(){i.elementQueriesSetupInformation&&i.elementQueriesSetupInformation.call()}));var o=window.getComputedStyle(i.resizeSensor,null).getPropertyValue("min-width");o=parseInt(o.replace("px","")),a(e.target,n[o])}})),m||((e=document.createElement("style")).type="text/css",e.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",e.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(e),m=!0);for(var s=0,r=document.styleSheets.length;s<r;s++)try{document.styleSheets[s].href&&0===document.styleSheets[s].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[s].href),g(document.styleSheets[s].cssRules||document.styleSheets[s].rules||document.styleSheets[s].cssText)}catch(o){}!function(){for(var t=c()("[data-responsive-image],[responsive-image]"),e=0,i=t.length;e<i;e++)d(t[e])}()},this.findElementQueriesElements=function(t){!function(t){var e=c(t);for(var n in i)if(i.hasOwnProperty(n))for(var s=e(n,t),r=0,o=s.length;r<o;r++)a(s[r],n)}(t)},this.update=function(){this.init()}};return e.update=function(){e.instance.update()},e.detach=function(t){t.elementQueriesSetupInformation?(t.elementQueriesSensor.detach(),delete t.elementQueriesSetupInformation,delete t.elementQueriesSensor):t.resizeSensorInstance&&(t.resizeSensorInstance.detach(),delete t.resizeSensorInstance)},e.init=function(){e.instance||(e.instance=new e),e.instance.init()},e.findElementQueriesElements=function(t){e.instance.findElementQueriesElements(t)},e.listen=function(){!function(t){if(document.addEventListener)document.addEventListener("DOMContentLoaded",t,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var e=setInterval((function(){/loaded|complete/i.test(document.readyState)&&(t(),clearInterval(e))}),10);else window.onload=t}(e.init)},e})?n.apply(e,s):n)||(t.exports=r)},zUnb:function(t,e,i){"use strict";function n(t){return"function"==typeof t}i.r(e);let s=!1;const r={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else s&&console.log("RxJS: Back to a better error behavior. Thank you. <3");s=t},get useDeprecatedSynchronousErrorHandling(){return s}};function o(t){setTimeout(()=>{throw t},0)}const a={closed:!0,next(t){},error(t){if(r.useDeprecatedSynchronousErrorHandling)throw t;o(t)},complete(){}},l=(()=>Array.isArray||(t=>t&&"number"==typeof t.length))();function c(t){return null!==t&&"object"==typeof t}const d=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();let u=(()=>{class t{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:i,_ctorUnsubscribe:s,_unsubscribe:r,_subscriptions:o}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,i instanceof t)i.remove(this);else if(null!==i)for(let t=0;t<i.length;++t)i[t].remove(this);if(n(r)){s&&(this._unsubscribe=void 0);try{r.call(this)}catch(a){e=a instanceof d?h(a.errors):[a]}}if(l(o)){let t=-1,i=o.length;for(;++t<i;){const i=o[t];if(c(i))try{i.unsubscribe()}catch(a){e=e||[],a instanceof d?e=e.concat(h(a.errors)):e.push(a)}}}if(e)throw new d(e)}add(e){let i=e;if(!e)return t.EMPTY;switch(typeof e){case"function":i=new t(e);case"object":if(i===this||i.closed||"function"!=typeof i.unsubscribe)return i;if(this.closed)return i.unsubscribe(),i;if(!(i instanceof t)){const e=i;i=new t,i._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:n}=i;if(null===n)i._parentOrParents=this;else if(n instanceof t){if(n===this)return i;i._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return i;n.push(this)}const s=this._subscriptions;return null===s?this._subscriptions=[i]:s.push(i),i}remove(t){const e=this._subscriptions;if(e){const i=e.indexOf(t);-1!==i&&e.splice(i,1)}}}return t.EMPTY=function(t){return t.closed=!0,t}(new t),t})();function h(t){return t.reduce((t,e)=>t.concat(e instanceof d?e.errors:e),[])}const p=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())();class g extends u{constructor(t,e,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=a;break;case 1:if(!t){this.destination=a;break}if("object"==typeof t){t instanceof g?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new m(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new m(this,t,e,i)}}[p](){return this}static create(t,e,i){const n=new g(t,e,i);return n.syncErrorThrowable=!1,n}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class m extends g{constructor(t,e,i,s){let r;super(),this._parentSubscriber=t;let o=this;n(e)?r=e:e&&(r=e.next,i=e.error,s=e.complete,e!==a&&(o=Object.create(e),n(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=r,this._error=i,this._complete=s}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;r.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:i}=r;if(this._error)i&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)i?(e.syncErrorValue=t,e.syncErrorThrown=!0):o(t),this.unsubscribe();else{if(this.unsubscribe(),i)throw t;o(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);r.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(i){if(this.unsubscribe(),r.useDeprecatedSynchronousErrorHandling)throw i;o(i)}}__tryOrSetError(t,e,i){if(!r.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,i)}catch(n){return r.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=n,t.syncErrorThrown=!0,!0):(o(n),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const f=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")();function v(t){return t}let b=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(t,e,i){const{operator:n}=this,s=function(t,e,i){if(t){if(t instanceof g)return t;if(t[p])return t[p]()}return t||e||i?new g(t,e,i):new g(a)}(t,e,i);if(s.add(n?n.call(s,this.source):this.source||r.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s)),r.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s}_trySubscribe(t){try{return this._subscribe(t)}catch(e){r.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:i,isStopped:n}=t;if(e||n)return!1;t=i&&i instanceof g?i:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=y(e))((e,i)=>{let n;n=this.subscribe(e=>{try{t(e)}catch(s){i(s),n&&n.unsubscribe()}},i,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[f](){return this}pipe(...t){return 0===t.length?this:(0===(e=t).length?v:1===e.length?e[0]:function(t){return e.reduce((t,e)=>e(t),t)})(this);var e}toPromise(t){return new(t=y(t))((t,e)=>{let i;this.subscribe(t=>i=t,t=>e(t),()=>t(i))})}}return t.create=e=>new t(e),t})();function y(t){if(t||(t=r.Promise||Promise),!t)throw new Error("no Promise impl found");return t}const C=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class V extends u{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const i=e.indexOf(this.subscriber);-1!==i&&e.splice(i,1)}}class w extends g{constructor(t){super(t),this.destination=t}}let A=(()=>{class t extends b{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[p](){return new w(this)}lift(t){const e=new P(this,this);return e.operator=t,e}next(t){if(this.closed)throw new C;if(!this.isStopped){const{observers:e}=this,i=e.length,n=e.slice();for(let s=0;s<i;s++)n[s].next(t)}}error(t){if(this.closed)throw new C;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,i=e.length,n=e.slice();for(let s=0;s<i;s++)n[s].error(t);this.observers.length=0}complete(){if(this.closed)throw new C;this.isStopped=!0;const{observers:t}=this,e=t.length,i=t.slice();for(let n=0;n<e;n++)i[n].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new C;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new C;return this.hasError?(t.error(this.thrownError),u.EMPTY):this.isStopped?(t.complete(),u.EMPTY):(this.observers.push(t),new V(this,t))}asObservable(){const t=new b;return t.source=this,t}}return t.create=(t,e)=>new P(t,e),t})();class P extends A{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):u.EMPTY}}function k(t){return t&&"function"==typeof t.schedule}function D(t,e){return function(i){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new M(t,e))}}class M{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new I(t,this.project,this.thisArg))}}class I extends g{constructor(t,e,i){super(t),this.project=e,this.count=0,this.thisArg=i||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(e)}}const S=t=>e=>{for(let i=0,n=t.length;i<n&&!e.closed;i++)e.next(t[i]);e.complete()};function x(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const T=x(),_=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function U(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const O=t=>{if(t&&"function"==typeof t[f])return n=t,t=>{const e=n[f]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(_(t))return S(t);if(U(t))return i=t,t=>(i.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,o),t);if(t&&"function"==typeof t[T])return e=t,t=>{const i=e[T]();for(;;){let e;try{e=i.next()}catch(n){return t.error(n),t}if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof i.return&&t.add(()=>{i.return&&i.return()}),t};{const e=c(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var e,i,n};function E(t,e){return new b(i=>{const n=new u;let s=0;return n.add(e.schedule((function(){s!==t.length?(i.next(t[s++]),i.closed||n.add(this.schedule())):i.complete()}))),n})}function L(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[f]}(t))return function(t,e){return new b(i=>{const n=new u;return n.add(e.schedule(()=>{const s=t[f]();n.add(s.subscribe({next(t){n.add(e.schedule(()=>i.next(t)))},error(t){n.add(e.schedule(()=>i.error(t)))},complete(){n.add(e.schedule(()=>i.complete()))}}))})),n})}(t,e);if(U(t))return function(t,e){return new b(i=>{const n=new u;return n.add(e.schedule(()=>t.then(t=>{n.add(e.schedule(()=>{i.next(t),n.add(e.schedule(()=>i.complete()))}))},t=>{n.add(e.schedule(()=>i.error(t)))}))),n})}(t,e);if(_(t))return E(t,e);if(function(t){return t&&"function"==typeof t[T]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new b(i=>{const n=new u;let s;return n.add(()=>{s&&"function"==typeof s.return&&s.return()}),n.add(e.schedule(()=>{s=t[T](),n.add(e.schedule((function(){if(i.closed)return;let t,e;try{const i=s.next();t=i.value,e=i.done}catch(n){return void i.error(n)}e?i.complete():(i.next(t),this.schedule())})))})),n})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof b?t:new b(O(t))}class G extends g{constructor(t){super(),this.parent=t}_next(t){this.parent.notifyNext(t)}_error(t){this.parent.notifyError(t),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class R extends g{notifyNext(t){this.destination.next(t)}notifyError(t){this.destination.error(t)}notifyComplete(){this.destination.complete()}}function j(t,e){if(!e.closed)return t instanceof b?t.subscribe(e):O(t)(e)}function $(t,e,i=Number.POSITIVE_INFINITY){return"function"==typeof e?n=>n.pipe($((i,n)=>L(t(i,n)).pipe(D((t,s)=>e(i,t,n,s))),i)):("number"==typeof e&&(i=e),e=>e.lift(new N(t,i)))}class N{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new F(t,this.project,this.concurrent))}}class F extends R{constructor(t,e,i=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const i=this.index++;try{e=this.project(t,i)}catch(n){return void this.destination.error(n)}this.active++,this._innerSub(e)}_innerSub(t){const e=new G(this),i=this.destination;i.add(e);const n=j(t,e);n!==e&&i.add(n)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t){this.destination.next(t)}notifyComplete(){const t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function B(t=Number.POSITIVE_INFINITY){return $(v,t)}function H(t,e){return e?E(t,e):new b(S(t))}function K(){return function(t){return t.lift(new q(t))}}class q{constructor(t){this.connectable=t}call(t,e){const{connectable:i}=this;i._refCount++;const n=new z(t,i),s=e.subscribe(n);return n.closed||(n.connection=i.connect()),s}}class z extends g{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:i}=this,n=t._connection;this.connection=null,!n||i&&n!==i||n.unsubscribe()}}class Q extends b{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new u,t.add(this.source.subscribe(new J(this.getSubject(),this))),t.closed&&(this._connection=null,t=u.EMPTY)),t}refCount(){return K()(this)}}const W=(()=>{const t=Q.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class J extends w{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function Y(){return new A}function Z(t){return{toString:t}.toString()}function X(t,e,i){return Z(()=>{const n=function(t){return function(...e){if(t){const i=t(...e);for(const t in i)this[t]=i[t]}}}(e);function s(...t){if(this instanceof s)return n.apply(this,t),this;const e=new s(...t);return i.annotation=e,i;function i(t,i,n){const s=t.hasOwnProperty("__parameters__")?t.__parameters__:Object.defineProperty(t,"__parameters__",{value:[]}).__parameters__;for(;s.length<=n;)s.push(null);return(s[n]=s[n]||[]).push(e),t}}return i&&(s.prototype=Object.create(i.prototype)),s.prototype.ngMetadataName=t,s.annotationCls=s,s})}const tt=X("Inject",t=>({token:t})),et=X("Optional"),it=X("Self"),nt=X("SkipSelf");var st=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});function rt(t){for(let e in t)if(t[e]===rt)return e;throw Error("Could not find renamed property on target object.")}function ot(t,e){for(const i in e)e.hasOwnProperty(i)&&!t.hasOwnProperty(i)&&(t[i]=e[i])}function at(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function lt(t){return{factory:t.factory,providers:t.providers||[],imports:t.imports||[]}}function ct(t){return dt(t,t[ht])||dt(t,t[mt])}function dt(t,e){return e&&e.token===t?e:null}function ut(t){return t&&(t.hasOwnProperty(pt)||t.hasOwnProperty(ft))?t[pt]:null}const ht=rt({\u0275prov:rt}),pt=rt({\u0275inj:rt}),gt=rt({\u0275provFallback:rt}),mt=rt({ngInjectableDef:rt}),ft=rt({ngInjectorDef:rt});function vt(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(vt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return""+t.overriddenName;if(t.name)return""+t.name;const e=t.toString();if(null==e)return""+e;const i=e.indexOf("\n");return-1===i?e:e.substring(0,i)}function bt(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const yt=rt({__forward_ref__:rt});function Ct(t){return t.__forward_ref__=Ct,t.toString=function(){return vt(this())},t}function Vt(t){return wt(t)?t():t}function wt(t){return"function"==typeof t&&t.hasOwnProperty(yt)&&t.__forward_ref__===Ct}const At="undefined"!=typeof globalThis&&globalThis,Pt="undefined"!=typeof window&&window,kt="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Dt="undefined"!=typeof global&&global,Mt=At||Dt||Pt||kt,It=rt({\u0275cmp:rt}),St=rt({\u0275dir:rt}),xt=rt({\u0275pipe:rt}),Tt=rt({\u0275mod:rt}),_t=rt({\u0275loc:rt}),Ut=rt({\u0275fac:rt}),Ot=rt({__NG_ELEMENT_ID__:rt});class Et{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=at({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return"InjectionToken "+this._desc}}const Lt=new Et("INJECTOR",-1),Gt={},Rt=/\n/gm,jt=rt({provide:String,useValue:rt});let $t,Nt=void 0;function Ft(t){const e=Nt;return Nt=t,e}function Bt(t){const e=$t;return $t=t,e}function Ht(t,e=st.Default){if(void 0===Nt)throw new Error("inject() must be called from an injection context");return null===Nt?qt(t,void 0,e):Nt.get(t,e&st.Optional?null:void 0,e)}function Kt(t,e=st.Default){return($t||Ht)(Vt(t),e)}function qt(t,e,i){const n=ct(t);if(n&&"root"==n.providedIn)return void 0===n.value?n.value=n.factory():n.value;if(i&st.Optional)return null;if(void 0!==e)return e;throw new Error(`Injector: NOT_FOUND [${vt(t)}]`)}function zt(t){const e=[];for(let i=0;i<t.length;i++){const n=Vt(t[i]);if(Array.isArray(n)){if(0===n.length)throw new Error("Arguments array must have arguments.");let t=void 0,i=st.Default;for(let e=0;e<n.length;e++){const s=n[e];s instanceof et||"Optional"===s.ngMetadataName||s===et?i|=st.Optional:s instanceof nt||"SkipSelf"===s.ngMetadataName||s===nt?i|=st.SkipSelf:s instanceof it||"Self"===s.ngMetadataName||s===it?i|=st.Self:t=s instanceof tt||s===tt?s.token:s}e.push(Kt(t,i))}else e.push(Kt(n))}return e}class Qt{get(t,e=Gt){if(e===Gt){const e=new Error(`NullInjectorError: No provider for ${vt(t)}!`);throw e.name="NullInjectorError",e}return e}}class Wt{}class Jt{}function Yt(t,e){t.forEach(t=>Array.isArray(t)?Yt(t,e):e(t))}function Zt(t,e,i){e>=t.length?t.push(i):t.splice(e,0,i)}function Xt(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function te(t,e,i){let n=ie(t,e);return n>=0?t[1|n]=i:(n=~n,function(t,e,i,n){let s=t.length;if(s==e)t.push(i,n);else if(1===s)t.push(n,t[0]),t[0]=i;else{for(s--,t.push(t[s-1],t[s]);s>e;)t[s]=t[s-2],s--;t[e]=i,t[e+1]=n}}(t,n,e,i)),n}function ee(t,e){const i=ie(t,e);if(i>=0)return t[1|i]}function ie(t,e){return function(t,e,i){let n=0,s=t.length>>1;for(;s!==n;){const i=n+(s-n>>1),r=t[i<<1];if(e===r)return i<<1;r>e?s=i:n=i+1}return~(s<<1)}(t,e)}var ne=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}({}),se=function(t){return t[t.Emulated=0]="Emulated",t[t.Native=1]="Native",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}({});const re={},oe=[];let ae=0;function le(t){return Z(()=>{const e={},i={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===ne.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||oe,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||se.Emulated,id:"c",styles:t.styles||oe,_:null,setInput:null,schemas:t.schemas||null,tView:null},n=t.directives,s=t.features,r=t.pipes;return i.id+=ae++,i.inputs=pe(t.inputs,e),i.outputs=pe(t.outputs),s&&s.forEach(t=>t(i)),i.directiveDefs=n?()=>("function"==typeof n?n():n).map(ce):null,i.pipeDefs=r?()=>("function"==typeof r?r():r).map(de):null,i})}function ce(t){return fe(t)||function(t){return t[St]||null}(t)}function de(t){return function(t){return t[xt]||null}(t)}const ue={};function he(t){const e={type:t.type,bootstrap:t.bootstrap||oe,declarations:t.declarations||oe,imports:t.imports||oe,exports:t.exports||oe,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&Z(()=>{ue[t.id]=t.type}),e}function pe(t,e){if(null==t)return re;const i={};for(const n in t)if(t.hasOwnProperty(n)){let s=t[n],r=s;Array.isArray(s)&&(r=s[1],s=s[0]),i[s]=n,e&&(e[s]=r)}return i}const ge=le;function me(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function fe(t){return t[It]||null}function ve(t,e){return t.hasOwnProperty(Ut)?t[Ut]:null}function be(t,e){const i=t[Tt]||null;if(!i&&!0===e)throw new Error(`Type ${vt(t)} does not have '\u0275mod' property.`);return i}function ye(t){return Array.isArray(t)&&"object"==typeof t[1]}function Ce(t){return Array.isArray(t)&&!0===t[1]}function Ve(t){return 0!=(8&t.flags)}function we(t){return 2==(2&t.flags)}function Ae(t){return 1==(1&t.flags)}function Pe(t){return null!==t.template}function ke(t){return 0!=(512&t[2])}function De(t){return"string"==typeof t?t:null==t?"":""+t}function Me(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():De(t)}const Ie=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Mt))();function Se(t){return t instanceof Function?t():t}function xe(t,e){const i=e?" in "+e:"";throw new Error(`No provider for ${Me(t)} found${i}`)}class Te{constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function _e(){return Ue}function Ue(t){return t.type.prototype.ngOnChanges&&(t.setInput=Ee),Oe}function Oe(){const t=Le(this),e=null==t?void 0:t.current;if(e){const i=t.previous;if(i===re)t.previous=e;else for(let t in e)i[t]=e[t];t.current=null,this.ngOnChanges(e)}}function Ee(t,e,i,n){const s=Le(t)||function(t,e){return t.__ngSimpleChanges__=e}(t,{previous:re,current:null}),r=s.current||(s.current={}),o=s.previous,a=this.declaredInputs[i],l=o[a];r[a]=new Te(l&&l.currentValue,e,o===re),t[n]=e}function Le(t){return t.__ngSimpleChanges__||null}_e.ngInherit=!0;let Ge=void 0;function Re(t){return!!t.listen}const je={createRenderer:(t,e)=>void 0!==Ge?Ge:"undefined"!=typeof document?document:void 0};function $e(t){for(;Array.isArray(t);)t=t[0];return t}function Ne(t,e){return $e(e[t+20])}function Fe(t,e){return $e(e[t.index])}function Be(t,e){return t.data[e+20]}function He(t,e){return t[e+20]}function Ke(t,e){const i=e[t];return ye(i)?i:i[0]}function qe(t){const e=function(t){return t.__ngContext__||null}(t);return e?Array.isArray(e)?e:e.lView:null}function ze(t){return 128==(128&t[2])}function Qe(t,e){return null===t||null==e?null:t[e]}function We(t){t[18]=0}function Je(t,e){t[5]+=e;let i=t,n=t[3];for(;null!==n&&(1===e&&1===i[5]||-1===e&&0===i[5]);)n[5]+=e,i=n,n=n[3]}const Ye={lFrame:bi(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Ze(){return Ye.bindingsEnabled}function Xe(){return Ye.lFrame.lView}function ti(){return Ye.lFrame.tView}function ei(t){Ye.lFrame.contextLView=t}function ii(){return Ye.lFrame.currentTNode}function ni(t,e){Ye.lFrame.currentTNode=t,Ye.lFrame.isParent=e}function si(){return Ye.lFrame.isParent}function ri(){Ye.lFrame.isParent=!1}function oi(){return Ye.isInCheckNoChangesMode}function ai(t){Ye.isInCheckNoChangesMode=t}function li(){const t=Ye.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function ci(){return Ye.lFrame.bindingIndex}function di(){return Ye.lFrame.bindingIndex++}function ui(t){const e=Ye.lFrame,i=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,i}function hi(t,e){const i=Ye.lFrame;i.bindingIndex=i.bindingRootIndex=t,pi(e)}function pi(t){Ye.lFrame.currentDirectiveIndex=t}function gi(t){Ye.lFrame.currentQueryIndex=t}function mi(t,e){const i=vi();Ye.lFrame=i,i.currentTNode=e,i.lView=t}function fi(t){const e=vi(),i=t[1];Ye.lFrame=e,e.currentTNode=i.firstChild,e.lView=t,e.tView=i,e.contextLView=t,e.bindingIndex=i.bindingStartIndex}function vi(){const t=Ye.lFrame,e=null===t?null:t.child;return null===e?bi(t):e}function bi(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:0,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null};return null!==t&&(t.child=e),e}function yi(){const t=Ye.lFrame;return Ye.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Ci=yi;function Vi(){const t=yi();t.isParent=!0,t.tView=null,t.selectedIndex=0,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function wi(){return Ye.lFrame.selectedIndex}function Ai(t){Ye.lFrame.selectedIndex=t}function Pi(){const t=Ye.lFrame;return Be(t.tView,t.selectedIndex)}function ki(t,e){for(let i=e.directiveStart,n=e.directiveEnd;i<n;i++){const e=t.data[i].type.prototype,{ngAfterContentInit:n,ngAfterContentChecked:s,ngAfterViewInit:r,ngAfterViewChecked:o,ngOnDestroy:a}=e;n&&(t.contentHooks||(t.contentHooks=[])).push(-i,n),s&&((t.contentHooks||(t.contentHooks=[])).push(i,s),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(i,s)),r&&(t.viewHooks||(t.viewHooks=[])).push(-i,r),o&&((t.viewHooks||(t.viewHooks=[])).push(i,o),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(i,o)),null!=a&&(t.destroyHooks||(t.destroyHooks=[])).push(i,a)}}function Di(t,e,i){Si(t,e,3,i)}function Mi(t,e,i,n){(3&t[2])===i&&Si(t,e,i,n)}function Ii(t,e){let i=t[2];(3&i)===e&&(i&=2047,i+=1,t[2]=i)}function Si(t,e,i,n){const s=null!=n?n:-1;let r=0;for(let o=void 0!==n?65535&t[18]:0;o<e.length;o++)if("number"==typeof e[o+1]){if(r=e[o],null!=n&&r>=n)break}else e[o]<0&&(t[18]+=65536),(r<s||-1==s)&&(xi(t,i,e,o),t[18]=(4294901760&t[18])+o+2),o++}function xi(t,e,i,n){const s=i[n]<0,r=i[n+1],o=t[s?-i[n]:i[n]];s?t[2]>>11<t[18]>>16&&(3&t[2])===e&&(t[2]+=2048,r.call(o)):r.call(o)}class Ti{constructor(t,e,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function _i(t,e,i){const n=Re(t);let s=0;for(;s<i.length;){const r=i[s];if("number"==typeof r){if(0!==r)break;s++;const o=i[s++],a=i[s++],l=i[s++];n?t.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=r,a=i[++s];Oi(o)?n&&t.setProperty(e,o,a):n?t.setAttribute(e,o,a):e.setAttribute(o,a),s++}}return s}function Ui(t){return 3===t||4===t||6===t}function Oi(t){return 64===t.charCodeAt(0)}function Ei(t,e){if(null===e||0===e.length);else if(null===t||0===t.length)t=e.slice();else{let i=-1;for(let n=0;n<e.length;n++){const s=e[n];"number"==typeof s?i=s:0===i||Li(t,i,s,null,-1===i||2===i?e[++n]:null)}}return t}function Li(t,e,i,n,s){let r=0,o=t.length;if(-1===e)o=-1;else for(;r<t.length;){const i=t[r++];if("number"==typeof i){if(i===e){o=-1;break}if(i>e){o=r-1;break}}}for(;r<t.length;){const e=t[r];if("number"==typeof e)break;if(e===i){if(null===n)return void(null!==s&&(t[r+1]=s));if(n===t[r+1])return void(t[r+2]=s)}r++,null!==n&&r++,null!==s&&r++}-1!==o&&(t.splice(o,0,e),r=o+1),t.splice(r++,0,i),null!==n&&t.splice(r++,0,n),null!==s&&t.splice(r++,0,s)}function Gi(t){return-1!==t}function Ri(t){return 32767&t}function ji(t,e){let i=t>>16,n=e;for(;i>0;)n=n[15],i--;return n}let $i=!0;function Ni(t){const e=$i;return $i=t,e}let Fi=0;function Bi(t,e){const i=Ki(t,e);if(-1!==i)return i;const n=e[1];n.firstCreatePass&&(t.injectorIndex=e.length,Hi(n.data,t),Hi(e,null),Hi(n.blueprint,null));const s=qi(t,e),r=t.injectorIndex;if(Gi(s)){const t=Ri(s),i=ji(s,e),n=i[1].data;for(let s=0;s<8;s++)e[r+s]=i[t+s]|n[t+s]}return e[r+8]=s,r}function Hi(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Ki(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function qi(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let i=0,n=null,s=e;for(;null!==s;){const t=s[1],e=t.type;if(n=2===e?t.declTNode:1===e?s[6]:null,null===n)return-1;if(i++,s=s[15],-1!==n.injectorIndex)return n.injectorIndex|i<<16}return-1}function zi(t,e,i){!function(t,e,i){let n;"string"==typeof i?n=i.charCodeAt(0)||0:i.hasOwnProperty(Ot)&&(n=i[Ot]),null==n&&(n=i[Ot]=Fi++);const s=255&n,r=1<<s,o=64&s,a=32&s,l=e.data;128&s?o?a?l[t+7]|=r:l[t+6]|=r:a?l[t+5]|=r:l[t+4]|=r:o?a?l[t+3]|=r:l[t+2]|=r:a?l[t+1]|=r:l[t]|=r}(t,e,i)}function Qi(t,e,i,n=st.Default,s){if(null!==t){const s=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(Ot)?t[Ot]:void 0;return"number"==typeof e&&e>0?255&e:e}(i);if("function"==typeof s){mi(e,t);try{const t=s();if(null!=t||n&st.Optional)return t;xe(i)}finally{Ci()}}else if("number"==typeof s){if(-1===s)return new tn(t,e);let r=null,o=Ki(t,e),a=-1,l=n&st.Host?e[16][6]:null;for((-1===o||n&st.SkipSelf)&&(a=-1===o?qi(t,e):e[o+8],-1!==a&&Xi(n,!1)?(r=e[1],o=Ri(a),e=ji(a,e)):o=-1);-1!==o;){const t=e[1];if(Zi(s,o,t.data)){const t=Ji(o,e,i,r,n,l);if(t!==Wi)return t}a=e[o+8],-1!==a&&Xi(n,e[1].data[o+8]===l)&&Zi(s,o,e)?(r=t,o=Ri(a),e=ji(a,e)):o=-1}}}if(n&st.Optional&&void 0===s&&(s=null),0==(n&(st.Self|st.Host))){const t=e[9],r=Bt(void 0);try{return t?t.get(i,s,n&st.Optional):qt(i,s,n&st.Optional)}finally{Bt(r)}}if(n&st.Optional)return s;xe(i,"NodeInjector")}const Wi={};function Ji(t,e,i,n,s,r){const o=e[1],a=o.data[t+8],l=function(t,e,i,n,s){const r=t.providerIndexes,o=e.data,a=1048575&r,l=t.directiveStart,c=r>>20,d=s?a+c:t.directiveEnd;for(let u=n?a:a+c;u<d;u++){const t=o[u];if(u<l&&i===t||u>=l&&t.type===i)return u}if(s){const t=o[l];if(t&&Pe(t)&&t.type===i)return l}return null}(a,o,i,null==n?we(a)&&$i:n!=o&&2===a.type,s&st.Host&&r===a);return null!==l?Yi(e,o,l,a):Wi}function Yi(t,e,i,n){let s=t[i];const r=e.data;if(s instanceof Ti){const o=s;o.resolving&&function(t,e){throw new Error("Circular dependency in DI detected for "+t)}(Me(r[i]));const a=Ni(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Bt(o.injectImpl):null;mi(t,n);try{s=t[i]=o.factory(void 0,r,t,n),e.firstCreatePass&&i>=n.directiveStart&&function(t,e,i){const{ngOnChanges:n,ngOnInit:s,ngDoCheck:r}=e.type.prototype;if(n){const n=Ue(e);(i.preOrderHooks||(i.preOrderHooks=[])).push(t,n),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t,n)}s&&(i.preOrderHooks||(i.preOrderHooks=[])).push(0-t,s),r&&((i.preOrderHooks||(i.preOrderHooks=[])).push(t,r),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t,r))}(i,r[i],e)}finally{null!==l&&Bt(l),Ni(a),o.resolving=!1,Ci()}}return s}function Zi(t,e,i){const n=64&t,s=32&t;let r;return r=128&t?n?s?i[e+7]:i[e+6]:s?i[e+5]:i[e+4]:n?s?i[e+3]:i[e+2]:s?i[e+1]:i[e],!!(r&1<<t)}function Xi(t,e){return!(t&st.Self||t&st.Host&&e)}class tn{constructor(t,e){this._tNode=t,this._lView=e}get(t,e){return Qi(this._tNode,this._lView,t,void 0,e)}}function en(t){const e=t;if(wt(t))return()=>{const t=en(Vt(e));return t?t():null};let i=ve(e);if(null===i){const t=ut(e);i=t&&t.factory}return i||null}function nn(t){return Z(()=>{const e=t.prototype.constructor,i=e[Ut]||en(e),n=Object.prototype;let s=Object.getPrototypeOf(t.prototype).constructor;for(;s&&s!==n;){const t=s[Ut]||en(s);if(t&&t!==i)return t;s=Object.getPrototypeOf(s)}return t=>new t})}function sn(t){return t.ngDebugContext}function rn(t){return t.ngOriginalError}function on(t,...e){t.error(...e)}class an{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),i=this._findContext(t),n=function(t){return t.ngErrorLogger||on}(t);n(this._console,"ERROR",t),e&&n(this._console,"ORIGINAL ERROR",e),i&&n(this._console,"ERROR CONTEXT",i)}_findContext(t){return t?sn(t)?sn(t):this._findContext(rn(t)):null}_findOriginalError(t){let e=rn(t);for(;e&&rn(e);)e=rn(e);return e}}class ln{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return"SafeValue must use [property]=binding: "+this.changingThisBreaksApplicationSecurity+" (see http://g.co/ng/security#xss)"}}function cn(t){return t instanceof ln?t.changingThisBreaksApplicationSecurity:t}let dn=!1;function un(){return dn=!0,!0}const hn=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,pn=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var gn=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}({});function mn(t){const e=function(){const t=Xe();return t&&t[12]}();return e?e.sanitize(gn.URL,t)||"":function(t,e){const i=function(t){return t instanceof ln&&t.getTypeName()||null}(t);if(null!=i&&i!==e){if("ResourceURL"===i&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${i} (see http://g.co/ng/security#xss)`)}return i===e}(t,"URL")?cn(t):(i=De(t),(i=String(i)).match(hn)||i.match(pn)?i:(un()&&console.warn(`WARNING: sanitizing unsafe URL value ${i} (see http://g.co/ng/security#xss)`),"unsafe:"+i));var i}function fn(t,e){t.__ngContext__=e}function vn(t,e,i){let n=t.length;for(;;){const s=t.indexOf(e,i);if(-1===s)return s;if(0===s||t.charCodeAt(s-1)<=32){const i=e.length;if(s+i===n||t.charCodeAt(s+i)<=32)return s}i=s+1}}function bn(t,e,i){let n=0;for(;n<t.length;){let s=t[n++];if(i&&"class"===s){if(s=t[n],-1!==vn(s.toLowerCase(),e,0))return!0}else if(1===s){for(;n<t.length&&"string"==typeof(s=t[n++]);)if(s.toLowerCase()===e)return!0;return!1}}return!1}function yn(t){return 0===t.type&&"ng-template"!==t.tagName}function Cn(t,e,i){return e===(0!==t.type||i?t.tagName:"ng-template")}function Vn(t,e,i){let n=4;const s=t.attrs||[],r=function(t){for(let e=0;e<t.length;e++)if(Ui(t[e]))return e;return t.length}(s);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&n){if(n=2|1&n,""!==l&&!Cn(t,l,i)||""===l&&1===e.length){if(wn(n))return!1;o=!0}}else{const c=8&n?l:e[++a];if(8&n&&null!==t.attrs){if(!bn(t.attrs,c,i)){if(wn(n))return!1;o=!0}continue}const d=An(8&n?"class":l,s,yn(t),i);if(-1===d){if(wn(n))return!1;o=!0;continue}if(""!==c){let t;t=d>r?"":s[d+1].toLowerCase();const e=8&n?t:null;if(e&&-1!==vn(e,c,0)||2&n&&c!==t){if(wn(n))return!1;o=!0}}}}else{if(!o&&!wn(n)&&!wn(l))return!1;if(o&&wn(l))continue;o=!1,n=l|1&n}}return wn(n)||o}function wn(t){return 0==(1&t)}function An(t,e,i,n){if(null===e)return-1;let s=0;if(n||!i){let i=!1;for(;s<e.length;){const n=e[s];if(n===t)return s;if(3===n||6===n)i=!0;else{if(1===n||2===n){let t=e[++s];for(;"string"==typeof t;)t=e[++s];continue}if(4===n)break;if(0===n){s+=4;continue}}s+=i?1:2}return-1}return function(t,e){let i=t.indexOf(4);if(i>-1)for(i++;i<t.length;){const n=t[i];if("number"==typeof n)return-1;if(n===e)return i;i++}return-1}(e,t)}function Pn(t,e,i=!1){for(let n=0;n<e.length;n++)if(Vn(t,e[n],i))return!0;return!1}function kn(t,e){return t?":not("+e.trim()+")":e}function Dn(t){let e=t[0],i=1,n=2,s="",r=!1;for(;i<t.length;){let o=t[i];if("string"==typeof o)if(2&n){const e=t[++i];s+="["+o+(e.length>0?'="'+e+'"':"")+"]"}else 8&n?s+="."+o:4&n&&(s+=" "+o);else""===s||wn(o)||(e+=kn(r,s),s=""),n=o,r=r||!wn(n);i++}return""!==s&&(e+=kn(r,s)),e}const Mn={};function In(t){const e=t[3];return Ce(e)?e[3]:e}function Sn(t){return Tn(t[13])}function xn(t){return Tn(t[4])}function Tn(t){for(;null!==t&&!Ce(t);)t=t[4];return t}function _n(t){Un(ti(),Xe(),wi()+t,oi())}function Un(t,e,i,n){if(!n)if(3==(3&e[2])){const n=t.preOrderCheckHooks;null!==n&&Di(e,n,i)}else{const n=t.preOrderHooks;null!==n&&Mi(e,n,0,i)}Ai(i)}function On(t,e){return t<<17|e<<2}function En(t){return t>>17&32767}function Ln(t){return 2|t}function Gn(t){return(131068&t)>>2}function Rn(t,e){return-131069&t|e<<2}function jn(t){return 1|t}function $n(t,e){const i=t.contentQueries;if(null!==i)for(let n=0;n<i.length;n+=2){const s=i[n],r=i[n+1];if(-1!==r){const i=t.data[r];gi(s),i.contentQueries(2,e[r],r)}}}function Nn(t,e,i){return Re(e)?e.createElement(t,i):null===i?e.createElement(t):e.createElementNS(i,t)}function Fn(t,e,i,n,s,r,o,a,l,c){const d=e.blueprint.slice();return d[0]=s,d[2]=140|n,We(d),d[3]=d[15]=t,d[8]=i,d[10]=o||t&&t[10],d[11]=a||t&&t[11],d[12]=l||t&&t[12]||null,d[9]=c||t&&t[9]||null,d[6]=r,d[16]=2==e.type?t[16]:d,d}function Bn(t,e,i,n,s){const r=e+20,o=t.data[r]||function(t,e,i,n,s){const r=ii(),o=si(),a=t.data[e]=function(t,e,i,n,s,r){return{type:i,index:n,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,tagName:s,attrs:r,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?r:r&&r.parent,i,e,n,s);return null===t.firstChild&&(t.firstChild=a),null!==r&&(o&&null==r.child&&null!==a.parent?r.child=a:o||(r.next=a)),a}(t,r,i,n,s);return ni(o,!0),o}function Hn(t,e,i){fi(e);try{const n=t.viewQuery;null!==n&&Cs(1,n,i);const s=t.template;null!==s&&zn(t,e,s,1,i),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&$n(t,e),t.staticViewQueries&&Cs(2,t.viewQuery,i);const r=t.components;null!==r&&function(t,e){for(let i=0;i<e.length;i++)ms(t,e[i])}(e,r)}catch(n){throw t.firstCreatePass&&(t.incompleteFirstPass=!0),n}finally{e[2]&=-5,Vi()}}function Kn(t,e,i,n){const s=e[2];if(256==(256&s))return;fi(e);const r=oi();try{We(e),Ye.lFrame.bindingIndex=t.bindingStartIndex,null!==i&&zn(t,e,i,2,n);const o=3==(3&s);if(!r)if(o){const i=t.preOrderCheckHooks;null!==i&&Di(e,i,null)}else{const i=t.preOrderHooks;null!==i&&Mi(e,i,0,null),Ii(e,0)}if(function(t){for(let e=Sn(t);null!==e;e=xn(e)){if(!e[2])continue;const t=e[9];for(let e=0;e<t.length;e++){const i=t[e],n=i[3];0==(1024&i[2])&&Je(n,1),i[2]|=1024}}}(e),function(t){for(let e=Sn(t);null!==e;e=xn(e))for(let t=10;t<e.length;t++){const i=e[t],n=i[1];ze(i)&&Kn(n,i,n.template,i[8])}}(e),null!==t.contentQueries&&$n(t,e),!r)if(o){const i=t.contentCheckHooks;null!==i&&Di(e,i)}else{const i=t.contentHooks;null!==i&&Mi(e,i,1),Ii(e,1)}!function(t,e){try{const i=t.expandoInstructions;if(null!==i){let n=t.expandoStartIndex,s=-1,r=-1;for(let t=0;t<i.length;t++){const o=i[t];"number"==typeof o?o<=0?(r=0-o,Ai(r),n+=9+i[++t],s=n):n+=o:(null!==o&&(hi(n,s),o(2,e[s])),s++)}}}finally{Ai(-1)}}(t,e);const a=t.components;null!==a&&function(t,e){for(let i=0;i<e.length;i++)gs(t,e[i])}(e,a);const l=t.viewQuery;if(null!==l&&Cs(2,l,n),!r)if(o){const i=t.viewCheckHooks;null!==i&&Di(e,i)}else{const i=t.viewHooks;null!==i&&Mi(e,i,2),Ii(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),r||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Je(e[3],-1))}finally{Vi()}}function qn(t,e,i,n){const s=e[10],r=!oi(),o=4==(4&e[2]);try{r&&!o&&s.begin&&s.begin(),o&&Hn(t,e,n),Kn(t,e,i,n)}finally{r&&!o&&s.end&&s.end()}}function zn(t,e,i,n,s){const r=wi();try{Ai(-1),2&n&&e.length>20&&Un(t,e,0,oi()),i(n,s)}finally{Ai(r)}}function Qn(t,e,i){if(Ve(e)){const n=e.directiveEnd;for(let s=e.directiveStart;s<n;s++){const e=t.data[s];e.contentQueries&&e.contentQueries(1,i[s],s)}}}function Wn(t,e,i){Ze()&&(function(t,e,i,n){const s=i.directiveStart,r=i.directiveEnd;t.firstCreatePass||Bi(i,e),fn(n,e);const o=i.initialInputs;for(let a=s;a<r;a++){const n=t.data[a],r=Pe(n);r&&ds(e,i,n);const l=Yi(e,t,a,i);fn(l,e),null!==o&&us(0,a-s,l,n,0,o),r&&(Ke(i.index,e)[8]=l)}}(t,e,i,Fe(i,e)),128==(128&i.flags)&&function(t,e,i){const n=i.directiveStart,s=i.directiveEnd,r=t.expandoInstructions,o=t.firstCreatePass,a=i.index-20,l=Ye.lFrame.currentDirectiveIndex;try{Ai(a);for(let i=n;i<s;i++){const n=t.data[i],s=e[i];pi(i),null!==n.hostBindings||0!==n.hostVars||null!==n.hostAttrs?ss(n,s):o&&r.push(null)}}finally{Ai(-1),pi(l)}}(t,e,i))}function Jn(t,e,i=Fe){const n=e.localNames;if(null!==n){let s=e.index+1;for(let r=0;r<n.length;r+=2){const o=n[r+1],a=-1===o?i(e,t):t[o];t[s++]=a}}}function Yn(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Zn(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function Zn(t,e,i,n,s,r,o,a,l,c){const d=20+n,u=d+s,h=function(t,e){const i=[];for(let n=0;n<e;n++)i.push(n<t?null:Mn);return i}(d,u),p="function"==typeof c?c():c;return h[1]={type:t,blueprint:h,template:i,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:u,expandoInstructions:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof r?r():r,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1}}function Xn(t,e,i){for(let n in t)if(t.hasOwnProperty(n)){const s=t[n];(i=null===i?{}:i).hasOwnProperty(n)?i[n].push(e,s):i[n]=[e,s]}return i}function ts(t,e,i,n,s,r,o,a){const l=Fe(e,i);let c,d=e.inputs;!a&&null!=d&&(c=d[n])?(Ps(t,i,c,n,s),we(e)&&function(t,e){const i=Ke(e,t);16&i[2]||(i[2]|=64)}(i,e.index)):2===e.type&&(n=function(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(n),s=null!=o?o(s,e.tagName||"",n):s,Re(r)?r.setProperty(l,n,s):Oi(n)||(l.setProperty?l.setProperty(n,s):l[n]=s))}function es(t,e,i,n){let s=!1;if(Ze()){const r=function(t,e,i){const n=t.directiveRegistry;let s=null;if(n)for(let r=0;r<n.length;r++){const o=n[r];Pn(i,o.selectors,!1)&&(s||(s=[]),zi(Bi(i,e),t,o.type),Pe(o)?(os(t,i),s.unshift(o)):s.push(o))}return s}(t,e,i),o=null===n?null:{"":-1};if(null!==r){let n=0;s=!0,ls(i,t.data.length,r.length);for(let t=0;t<r.length;t++){const e=r[t];e.providersResolver&&e.providersResolver(e)}rs(t,i,r.length);let a=!1,l=!1;for(let s=0;s<r.length;s++){const c=r[s];i.mergedAttrs=Ei(i.mergedAttrs,c.hostAttrs),cs(t,e,c),as(t.data.length-1,c,o),null!==c.contentQueries&&(i.flags|=8),null===c.hostBindings&&null===c.hostAttrs&&0===c.hostVars||(i.flags|=128);const d=c.type.prototype;!a&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(i.index-20),a=!0),l||!d.ngOnChanges&&!d.ngDoCheck||((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i.index-20),l=!0),is(t,c),n+=c.hostVars}!function(t,e){const i=e.directiveEnd,n=t.data,s=e.attrs,r=[];let o=null,a=null;for(let l=e.directiveStart;l<i;l++){const t=n[l],i=t.inputs,c=null===s||yn(e)?null:hs(i,s);r.push(c),o=Xn(i,l,o),a=Xn(t.outputs,l,a)}null!==o&&(o.hasOwnProperty("class")&&(e.flags|=16),o.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=r,e.inputs=o,e.outputs=a}(t,i),ns(t,e,n)}o&&function(t,e,i){if(e){const n=t.localNames=[];for(let t=0;t<e.length;t+=2){const s=i[e[t+1]];if(null==s)throw new Error(`Export of name '${e[t+1]}' not found!`);n.push(e[t],s)}}}(i,n,o)}return i.mergedAttrs=Ei(i.mergedAttrs,i.attrs),s}function is(t,e){const i=t.expandoInstructions;i.push(e.hostBindings),0!==e.hostVars&&i.push(e.hostVars)}function ns(t,e,i){for(let n=0;n<i;n++)e.push(Mn),t.blueprint.push(Mn),t.data.push(null)}function ss(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function rs(t,e,i){const n=20-e.index,s=t.data.length-(1048575&e.providerIndexes);(t.expandoInstructions||(t.expandoInstructions=[])).push(n,s,i)}function os(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function as(t,e,i){if(i){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)i[e.exportAs[n]]=t;Pe(e)&&(i[""]=t)}}function ls(t,e,i){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+i,t.providerIndexes=e}function cs(t,e,i){t.data.push(i);const n=i.factory||(i.factory=ve(i.type)),s=new Ti(n,Pe(i),null);t.blueprint.push(s),e.push(s)}function ds(t,e,i){const n=Fe(e,t),s=Yn(i),r=t[10],o=fs(t,Fn(t,s,null,i.onPush?64:16,n,e,r,r.createRenderer(n,i),null,null));t[e.index]=o}function us(t,e,i,n,s,r){const o=r[e];if(null!==o){const t=n.setInput;for(let e=0;e<o.length;){const s=o[e++],r=o[e++],a=o[e++];null!==t?n.setInput(i,a,s,r):i[r]=a}}}function hs(t,e){let i=null,n=0;for(;n<e.length;){const s=e[n];if(0!==s)if(5!==s){if("number"==typeof s)break;t.hasOwnProperty(s)&&(null===i&&(i=[]),i.push(s,t[s],e[n+1])),n+=2}else n+=2;else n+=4}return i}function ps(t,e,i,n){return new Array(t,!0,!1,e,null,0,n,i,null,null)}function gs(t,e){const i=Ke(e,t);if(ze(i)){const t=i[1];80&i[2]?Kn(t,i,t.template,i[8]):i[5]>0&&function t(e){for(let n=Sn(e);null!==n;n=xn(n))for(let e=10;e<n.length;e++){const i=n[e];if(1024&i[2]){const t=i[1];Kn(t,i,t.template,i[8])}else i[5]>0&&t(i)}const i=e[1].components;if(null!==i)for(let n=0;n<i.length;n++){const s=Ke(i[n],e);ze(s)&&s[5]>0&&t(s)}}(i)}}function ms(t,e){const i=Ke(e,t),n=i[1];!function(t,e){for(let i=e.length;i<t.blueprint.length;i++)e.push(t.blueprint[i])}(n,i),Hn(n,i,i[8])}function fs(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function vs(t){for(;t;){t[2]|=64;const e=In(t);if(ke(t)&&!e)return t;t=e}return null}function bs(t,e,i){const n=e[10];n.begin&&n.begin();try{Kn(t,e,t.template,i)}catch(s){throw As(e,s),s}finally{n.end&&n.end()}}function ys(t){!function(t){for(let e=0;e<t.components.length;e++){const i=t.components[e],n=qe(i),s=n[1];qn(s,n,s.template,i)}}(t[8])}function Cs(t,e,i){gi(0),e(t,i)}const Vs=(()=>Promise.resolve(null))();function ws(t){return t[7]||(t[7]=[])}function As(t,e){const i=t[9],n=i?i.get(an,null):null;n&&n.handleError(e)}function Ps(t,e,i,n,s){for(let r=0;r<i.length;){const o=i[r++],a=i[r++],l=e[o],c=t.data[o];null!==c.setInput?c.setInput(l,s,n,a):l[a]=s}}function ks(t,e,i){const n=Ne(e,t),s=t[11];Re(s)?s.setValue(n,i):n.textContent=i}function Ds(t,e,i,n,s){if(null!=n){let r,o=!1;Ce(n)?r=n:ye(n)&&(o=!0,n=n[0]);const a=$e(n);0===t&&null!==i?null==s?_s(e,i,a):Ts(e,i,a,s||null):1===t&&null!==i?Ts(e,i,a,s||null):2===t?function(t,e,i){const n=Os(t,e);n&&function(t,e,i,n){Re(t)?t.removeChild(e,i,n):e.removeChild(i)}(t,n,e,i)}(e,a,o):3===t&&e.destroyNode(a),null!=r&&function(t,e,i,n,s){const r=i[7];r!==$e(i)&&Ds(e,t,n,r,s);for(let o=10;o<i.length;o++){const s=i[o];Gs(s[1],s,t,e,n,r)}}(e,t,r,i,s)}}function Ms(t,e){const i=t[9],n=i.indexOf(e),s=e[3];1024&e[2]&&(e[2]&=-1025,Je(s,-1)),i.splice(n,1)}function Is(t,e){if(t.length<=10)return;const i=10+e,n=t[i];if(n){const r=n[17];null!==r&&r!==t&&Ms(r,n),e>0&&(t[i-1][4]=n[4]);const o=Xt(t,10+e);Gs(n[1],s=n,s[11],2,null,null),s[0]=null,s[6]=null;const a=o[19];null!==a&&a.detachView(o[1]),n[3]=null,n[4]=null,n[2]&=-129}var s;return n}function Ss(t,e){if(!(256&e[2])){const i=e[11];Re(i)&&i.destroyNode&&Gs(t,e,i,3,null,null),function(t){let e=t[13];if(!e)return xs(t[1],t);for(;e;){let i=null;if(ye(e))i=e[13];else{const t=e[10];t&&(i=t)}if(!i){for(;e&&!e[4]&&e!==t;)ye(e)&&xs(e[1],e),e=e[3];null===e&&(e=t),ye(e)&&xs(e[1],e),i=e&&e[4]}e=i}}(e)}}function xs(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let i;if(null!=t&&null!=(i=t.destroyHooks))for(let n=0;n<i.length;n+=2){const t=e[i[n]];if(!(t instanceof Ti)){const e=i[n+1];if(Array.isArray(e))for(let i=0;i<e.length;i+=2)e[i+1].call(t[e[i]]);else e.call(t)}}}(t,e),function(t,e){const i=t.cleanup;if(null!==i){const t=e[7];for(let n=0;n<i.length-1;n+=2)if("string"==typeof i[n]){const s=i[n+1],r="function"==typeof s?s(e):$e(e[s]),o=t[i[n+2]],a=i[n+3];"boolean"==typeof a?r.removeEventListener(i[n],o,a):a>=0?t[a]():t[-a].unsubscribe(),n+=2}else i[n].call(t[i[n+1]]);e[7]=null}}(t,e),1===e[1].type&&Re(e[11])&&e[11].destroy();const i=e[17];if(null!==i&&Ce(e[3])){i!==e[3]&&Ms(i,e);const n=e[19];null!==n&&n.detachView(t)}}}function Ts(t,e,i,n){Re(t)?t.insertBefore(e,i,n):e.insertBefore(i,n,!0)}function _s(t,e,i){Re(t)?t.appendChild(e,i):e.appendChild(i)}function Us(t,e,i,n){null!==n?Ts(t,e,i,n):_s(t,e,i)}function Os(t,e){return Re(t)?t.parentNode(e):e.parentNode}function Es(t,e,i,n){const s=function(t,e,i){let n=e.parent;for(;null!=n&&(3===n.type||4===n.type);)n=(e=n).parent;if(null===n)return i[0];if(e&&4===e.type&&4&e.flags)return Fe(e,i).parentNode;if(2&n.flags){const e=t.data,i=e[e[n.index].directiveStart].encapsulation;if(i!==se.ShadowDom&&i!==se.Native)return null}return Fe(n,i)}(t,n,e);if(null!=s){const t=e[11],r=function(t,e){return 3===t.type||4===t.type?Fe(t,e):null}(n.parent||e[6],e);if(Array.isArray(i))for(let e=0;e<i.length;e++)Us(t,s,i[e],r);else Us(t,s,i,r)}}function Ls(t,e,i,n,s,r,o){for(;null!=i;){const a=n[i.index],l=i.type;o&&0===e&&(a&&fn($e(a),n),i.flags|=4),64!=(64&i.flags)&&(3===l||4===l?(Ls(t,e,i.child,n,s,r,!1),Ds(e,t,s,a,r)):1===l?Rs(t,e,n,i,s,r):Ds(e,t,s,a,r)),i=o?i.projectionNext:i.next}}function Gs(t,e,i,n,s,r){Ls(i,n,t.firstChild,e,s,r,!1)}function Rs(t,e,i,n,s,r){const o=i[16],a=o[6].projection[n.projection];if(Array.isArray(a))for(let l=0;l<a.length;l++)Ds(e,t,s,a[l],r);else Ls(t,e,a,o[3],s,r,!0)}function js(t,e,i){Re(t)?t.setAttribute(e,"style",i):e.style.cssText=i}function $s(t,e,i){Re(t)?""===i?t.removeAttribute(e,"class"):t.setAttribute(e,"class",i):e.className=i}class Ns{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._viewContainerRef=null}get rootNodes(){const t=this._lView,e=t[1];return function t(e,i,n,s,r=!1){for(;null!==n;){const o=i[n.index];if(null!==o&&s.push($e(o)),Ce(o))for(let e=10;e<o.length;e++){const i=o[e],n=i[1].firstChild;null!==n&&t(i[1],i,n,s)}const a=n.type;if(3===a||4===a)t(e,i,n.child,s);else if(1===a){const e=i[16],r=e[6].projection[n.projection];if(Array.isArray(r))s.push(...r);else{const i=In(e);t(i[1],i,r,s,!0)}}n=r?n.projectionNext:n.next}return s}(e,t,e.firstChild,[])}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){const t=this._viewContainerRef.indexOf(this);t>-1&&this._viewContainerRef.detach(t),this._viewContainerRef=null}Ss(this._lView[1],this._lView)}onDestroy(t){!function(t,e,i,n){const s=ws(e);s.push(null),t.firstCreatePass&&function(t){return t.cleanup||(t.cleanup=[])}(t).push(n,s.length-1)}(this._lView[1],this._lView,0,t)}markForCheck(){vs(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){bs(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,i){ai(!0);try{bs(t,e,i)}finally{ai(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(t){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=t}detachFromAppRef(){var t;this._appRef=null,Gs(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class Fs extends Ns{constructor(t){super(t),this._view=t}detectChanges(){ys(this._view)}checkNoChanges(){!function(t){ai(!0);try{ys(t)}finally{ai(!1)}}(this._view)}get context(){return null}}let Bs,Hs,Ks;function qs(t,e,i){return Bs||(Bs=class extends t{}),new Bs(Fe(e,i))}function zs(t,e,i,n){return Hs||(Hs=class extends t{constructor(t,e,i){super(),this._declarationView=t,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(t){const e=this._declarationTContainer.tViews,i=Fn(this._declarationView,e,t,16,null,e.declTNode,null,null,null,null);i[17]=this._declarationView[this._declarationTContainer.index];const n=this._declarationView[19];return null!==n&&(i[19]=n.createEmbeddedView(e)),Hn(e,i,t),new Ns(i)}}),0===i.type?new Hs(n,i,qs(e,i,n)):null}function Qs(t=!1){return function(t,e,i){if(!i&&we(t)){const i=Ke(t.index,e);return new Ns(i,i)}return 2===t.type||0===t.type||3===t.type||4===t.type?new Ns(e[16],e):null}(ii(),Xe(),t)}let Ws=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Js(),t})();const Js=Qs,Ys=Function,Zs=new Et("Set Injector scope."),Xs={},tr={},er=[];let ir=void 0;function nr(){return void 0===ir&&(ir=new Qt),ir}function sr(t,e=null,i=null,n){return new rr(t,i,e||nr(),n)}class rr{constructor(t,e,i,n=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];e&&Yt(e,i=>this.processProvider(i,t,e)),Yt([t],t=>this.processInjectorType(t,[],s)),this.records.set(Lt,lr(void 0,this));const r=this.records.get(Zs);this.scope=null!=r?r.value:null,this.source=n||("object"==typeof t?null:vt(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=Gt,i=st.Default){this.assertNotDestroyed();const n=Ft(this);try{if(!(i&st.SkipSelf)){let e=this.records.get(t);if(void 0===e){const i=("function"==typeof(s=t)||"object"==typeof s&&s instanceof Et)&&ct(t);e=i&&this.injectableDefInScope(i)?lr(or(t),Xs):null,this.records.set(t,e)}if(null!=e)return this.hydrate(t,e)}return(i&st.Self?nr():this.parent).get(t,e=i&st.Optional&&e===Gt?null:e)}catch(r){if("NullInjectorError"===r.name){if((r.ngTempTokenPath=r.ngTempTokenPath||[]).unshift(vt(t)),n)throw r;return function(t,e,i,n){const s=t.ngTempTokenPath;throw e.__source&&s.unshift(e.__source),t.message=function(t,e,i,n=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let s=vt(e);if(Array.isArray(e))s=e.map(vt).join(" -> ");else if("object"==typeof e){let t=[];for(let i in e)if(e.hasOwnProperty(i)){let n=e[i];t.push(i+":"+("string"==typeof n?JSON.stringify(n):vt(n)))}s=`{${t.join(", ")}}`}return`${i}${n?"("+n+")":""}[${s}]: ${t.replace(Rt,"\n  ")}`}("\n"+t.message,s,i,n),t.ngTokenPath=s,t.ngTempTokenPath=null,t}(r,t,"R3InjectorError",this.source)}throw r}finally{Ft(n)}var s}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((e,i)=>t.push(vt(i))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,i){if(!(t=Vt(t)))return!1;let n=ut(t);const s=null==n&&t.ngModule||void 0,r=void 0===s?t:s,o=-1!==i.indexOf(r);if(void 0!==s&&(n=ut(s)),null==n)return!1;if(null!=n.imports&&!o){let t;i.push(r);try{Yt(n.imports,n=>{this.processInjectorType(n,e,i)&&(void 0===t&&(t=[]),t.push(n))})}finally{}if(void 0!==t)for(let e=0;e<t.length;e++){const{ngModule:i,providers:n}=t[e];Yt(n,t=>this.processProvider(t,i,n||er))}}this.injectorDefTypes.add(r),this.records.set(r,lr(n.factory,Xs));const a=n.providers;if(null!=a&&!o){const e=t;Yt(a,t=>this.processProvider(t,e,a))}return void 0!==s&&void 0!==t.providers}processProvider(t,e,i){let n=dr(t=Vt(t))?t:Vt(t&&t.provide);const s=function(t,e,i){return cr(t)?lr(void 0,t.useValue):lr(ar(t),Xs)}(t);if(dr(t)||!0!==t.multi)this.records.get(n);else{let e=this.records.get(n);e||(e=lr(void 0,Xs,!0),e.factory=()=>zt(e.multi),this.records.set(n,e)),n=t,e.multi.push(t)}this.records.set(n,s)}hydrate(t,e){var i;return e.value===Xs&&(e.value=tr,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(i=e.value)&&"object"==typeof i&&"function"==typeof i.ngOnDestroy&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){return!!t.providedIn&&("string"==typeof t.providedIn?"any"===t.providedIn||t.providedIn===this.scope:this.injectorDefTypes.has(t.providedIn))}}function or(t){const e=ct(t),i=null!==e?e.factory:ve(t);if(null!==i)return i;const n=ut(t);if(null!==n)return n.factory;if(t instanceof Et)throw new Error(`Token ${vt(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const i=function(t,e){const i=[];for(let n=0;n<t;n++)i.push("?");return i}(e);throw new Error(`Can't resolve all parameters for ${vt(t)}: (${i.join(", ")}).`)}const i=function(t){const e=t&&(t[ht]||t[mt]||t[gt]&&t[gt]());if(e){const i=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${i}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${i}" class.`),e}return null}(t);return null!==i?()=>i.factory(t):()=>new t}(t);throw new Error("unreachable")}function ar(t,e,i){let n=void 0;if(dr(t)){const e=Vt(t);return ve(e)||or(e)}if(cr(t))n=()=>Vt(t.useValue);else if((s=t)&&s.useFactory)n=()=>t.useFactory(...zt(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))n=()=>Kt(Vt(t.useExisting));else{const e=Vt(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return ve(e)||or(e);n=()=>new e(...zt(t.deps))}var s;return n}function lr(t,e,i=!1){return{factory:t,value:e,multi:i?[]:void 0}}function cr(t){return null!==t&&"object"==typeof t&&jt in t}function dr(t){return"function"==typeof t}const ur=function(t,e,i){return function(t,e=null,i=null,n){const s=sr(t,e,i,n);return s._resolveInjectorDefTypes(),s}({name:i},e,t,i)};let hr=(()=>{class t{static create(t,e){return Array.isArray(t)?ur(t,e,""):ur(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=Gt,t.NULL=new Qt,t.\u0275prov=at({token:t,providedIn:"any",factory:()=>Kt(Lt)}),t.__NG_ELEMENT_ID__=-1,t})();const pr=new Et("AnalyzeForEntryComponents");function gr(t,e,i){let n=i?t.styles:null,s=i?t.classes:null,r=0;if(null!==e)for(let o=0;o<e.length;o++){const t=e[o];"number"==typeof t?r=t:1==r?s=bt(s,t):2==r&&(n=bt(n,t+": "+e[++o]+";"))}i?t.styles=n:t.stylesWithoutHost=n,i?t.classes=s:t.classesWithoutHost=s}function mr(t,e){const i=qe(t)[1],n=i.data.length-1;ki(i,{directiveStart:n,directiveEnd:n+1})}function fr(t){let e=Object.getPrototypeOf(t.type.prototype).constructor,i=!0;const n=[t];for(;e;){let s=void 0;if(Pe(t))s=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");s=e.\u0275dir}if(s){if(i){n.push(s);const e=t;e.inputs=vr(t.inputs),e.declaredInputs=vr(t.declaredInputs),e.outputs=vr(t.outputs);const i=s.hostBindings;i&&Cr(t,i);const r=s.viewQuery,o=s.contentQueries;if(r&&br(t,r),o&&yr(t,o),ot(t.inputs,s.inputs),ot(t.declaredInputs,s.declaredInputs),ot(t.outputs,s.outputs),Pe(s)&&s.data.animation){const e=t.data;e.animation=(e.animation||[]).concat(s.data.animation)}}const e=s.features;if(e)for(let n=0;n<e.length;n++){const s=e[n];s&&s.ngInherit&&s(t),s===fr&&(i=!1)}}e=Object.getPrototypeOf(e)}!function(t){let e=0,i=null;for(let n=t.length-1;n>=0;n--){const s=t[n];s.hostVars=e+=s.hostVars,s.hostAttrs=Ei(s.hostAttrs,i=Ei(i,s.hostAttrs))}}(n)}function vr(t){return t===re?{}:t===oe?[]:t}function br(t,e){const i=t.viewQuery;t.viewQuery=i?(t,n)=>{e(t,n),i(t,n)}:e}function yr(t,e){const i=t.contentQueries;t.contentQueries=i?(t,n,s)=>{e(t,n,s),i(t,n,s)}:e}function Cr(t,e){const i=t.hostBindings;t.hostBindings=i?(t,n)=>{e(t,n),i(t,n)}:e}let Vr=null;function wr(){if(!Vr){const t=Mt.Symbol;if(t&&t.iterator)Vr=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const i=t[e];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Vr=i)}}}return Vr}class Ar{constructor(t){this.wrapped=t}static wrap(t){return new Ar(t)}static unwrap(t){return Ar.isWrapped(t)?t.wrapped:t}static isWrapped(t){return t instanceof Ar}}function Pr(t){return!!kr(t)&&(Array.isArray(t)||!(t instanceof Map)&&wr()in t)}function kr(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Dr(t,e,i){return t[e]=i}function Mr(t,e){return t[e]}function Ir(t,e,i){return!Object.is(t[e],i)&&(t[e]=i,!0)}function Sr(t,e,i,n){const s=Ir(t,e,i);return Ir(t,e+1,n)||s}function xr(t,e,i,n,s){const r=Sr(t,e,i,n);return Ir(t,e+2,s)||r}function Tr(t,e,i,n,s,r){const o=Sr(t,e,i,n);return Sr(t,e+2,s,r)||o}function _r(t,e,i,n){const s=Xe();return Ir(s,di(),e)&&(ti(),function(t,e,i,n,s,r){const o=Fe(t,e),a=e[11];if(null==n)Re(a)?a.removeAttribute(o,i,r):o.removeAttribute(i);else{const e=null==s?De(n):s(n,t.tagName||"",i);Re(a)?a.setAttribute(o,i,e,r):r?o.setAttributeNS(r,i,e):o.setAttribute(i,e)}}(Pi(),s,t,e,i,n)),_r}function Ur(t,e,i,n){return Ir(t,di(),i)?e+De(i)+n:Mn}function Or(t,e,i,n,s,r){const o=Sr(t,ci(),i,s);return ui(2),o?e+De(i)+n+De(s)+r:Mn}function Er(t,e,i,n,s,r,o,a){const l=xr(t,ci(),i,s,o);return ui(3),l?e+De(i)+n+De(s)+r+De(o)+a:Mn}function Lr(t,e,i,n,s,r,o,a){const l=Xe(),c=ti(),d=t+20,u=c.firstCreatePass?function(t,e,i,n,s,r,o,a,l){const c=e.consts,d=Bn(e,t,0,o||null,Qe(c,a));es(e,i,d,Qe(c,l)),ki(e,d);const u=d.tViews=Zn(2,d,n,s,r,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,d),u.queries=e.queries.embeddedTView(d)),d}(t,c,l,e,i,n,s,r,o):c.data[d];ni(u,!1);const h=l[11].createComment("");Es(c,l,h,u),fn(h,l),fs(l,l[d]=ps(h,l,h,u)),Ae(u)&&Wn(c,l,u),null!=o&&Jn(l,u,a)}function Gr(t){return He(Ye.lFrame.contextLView,t)}function Rr(t,e=st.Default){const i=Xe();return null===i?Kt(t,e):Qi(ii(),i,Vt(t),e)}function jr(t,e,i){const n=Xe();return Ir(n,di(),e)&&ts(ti(),Pi(),n,t,e,n[11],i,!1),jr}function $r(t,e,i,n,s){const r=s?"class":"style";Ps(t,i,e.inputs[r],r,n)}function Nr(t,e,i,n){const s=Xe(),r=ti(),o=20+t,a=s[11],l=s[o]=Nn(e,a,Ye.lFrame.currentNamespace),c=r.firstCreatePass?function(t,e,i,n,s,r,o){const a=e.consts,l=Bn(e,t,2,s,Qe(a,r));return es(e,i,l,Qe(a,o)),null!==l.attrs&&gr(l,l.attrs,!1),null!==l.mergedAttrs&&gr(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(t,r,s,0,e,i,n):r.data[o];ni(c,!0);const d=c.mergedAttrs;null!==d&&_i(a,l,d);const u=c.classes;null!==u&&$s(a,l,u);const h=c.styles;null!==h&&js(a,l,h),Es(r,s,l,c),0===Ye.lFrame.elementDepthCount&&fn(l,s),Ye.lFrame.elementDepthCount++,Ae(c)&&(Wn(r,s,c),Qn(r,c,s)),null!==n&&Jn(s,c)}function Fr(){let t=ii();si()?ri():(t=t.parent,ni(t,!1));const e=t;Ye.lFrame.elementDepthCount--;const i=ti();i.firstCreatePass&&(ki(i,t),Ve(t)&&i.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&$r(i,e,Xe(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&$r(i,e,Xe(),e.stylesWithoutHost,!1)}function Br(t,e,i,n){Nr(t,e,i,n),Fr()}function Hr(t,e,i){const n=Xe(),s=ti(),r=t+20,o=s.firstCreatePass?function(t,e,i,n,s){const r=e.consts,o=Qe(r,n),a=Bn(e,t,3,"ng-container",o);return null!==o&&gr(a,o,!0),es(e,i,a,Qe(r,s)),null!==e.queries&&e.queries.elementStart(e,a),a}(t,s,n,e,i):s.data[r];ni(o,!0);const a=n[r]=n[11].createComment("");Es(s,n,a,o),fn(a,n),Ae(o)&&(Wn(s,n,o),Qn(s,o,n)),null!=i&&Jn(n,o)}function Kr(){let t=ii();const e=ti();si()?ri():(t=t.parent,ni(t,!1)),e.firstCreatePass&&(ki(e,t),Ve(t)&&e.queries.elementEnd(t))}function qr(t,e,i){Hr(t,e,i),Kr()}function zr(){return Xe()}function Qr(t){return!!t&&"function"==typeof t.then}function Wr(t){return!!t&&"function"==typeof t.subscribe}function Jr(t,e,i=!1,n){const s=Xe(),r=ti(),o=ii();return function(t,e,i,n,s,r,o=!1,a){const l=Ae(n),c=t.firstCreatePass&&(t.cleanup||(t.cleanup=[])),d=ws(e);let u=!0;if(2===n.type){const h=Fe(n,e),p=a?a(h):re,g=p.target||h,m=d.length,f=a?t=>a($e(t[n.index])).target:n.index;if(Re(i)){let o=null;if(!a&&l&&(o=function(t,e,i,n){const s=t.cleanup;if(null!=s)for(let r=0;r<s.length-1;r+=2){const t=s[r];if(t===i&&s[r+1]===n){const t=e[7],i=s[r+2];return t.length>i?t[i]:null}"string"==typeof t&&(r+=2)}return null}(t,e,s,n.index)),null!==o)(o.__ngLastListenerFn__||o).__ngNextListenerFn__=r,o.__ngLastListenerFn__=r,u=!1;else{r=Zr(n,e,r,!1);const t=i.listen(p.name||g,s,r);d.push(r,t),c&&c.push(s,f,m,m+1)}}else r=Zr(n,e,r,!0),g.addEventListener(s,r,o),d.push(r),c&&c.push(s,f,m,o)}const h=n.outputs;let p;if(u&&null!==h&&(p=h[s])){const t=p.length;if(t)for(let i=0;i<t;i+=2){const t=e[p[i]][p[i+1]].subscribe(r),o=d.length;d.push(r,t),c&&c.push(s,n.index,o,-(o+1))}}}(r,s,s[11],o,t,e,i,n),Jr}function Yr(t,e,i){try{return!1!==e(i)}catch(n){return As(t,n),!1}}function Zr(t,e,i,n){return function s(r){if(r===Function)return i;const o=2&t.flags?Ke(t.index,e):e;0==(32&e[2])&&vs(o);let a=Yr(e,i,r),l=s.__ngNextListenerFn__;for(;l;)a=Yr(e,l,r)&&a,l=l.__ngNextListenerFn__;return n&&!1===a&&(r.preventDefault(),r.returnValue=!1),a}}function Xr(t=1){return function(t){return(Ye.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,Ye.lFrame.contextLView))[8]}(t)}function to(t,e,i){return eo(t,"",e,"",i),to}function eo(t,e,i,n,s){const r=Xe(),o=Ur(r,e,i,n);return o!==Mn&&ts(ti(),Pi(),r,t,o,r[11],s,!1),eo}function io(t,e,i,n,s,r,o){const a=Xe(),l=Or(a,e,i,n,s,r);return l!==Mn&&ts(ti(),Pi(),a,t,l,a[11],o,!1),io}function no(t,e,i,n,s,r,o,a,l){const c=Xe(),d=Er(c,e,i,n,s,r,o,a);return d!==Mn&&ts(ti(),Pi(),c,t,d,c[11],l,!1),no}const so=[];function ro(t,e,i,n,s){const r=t[i+1],o=null===e;let a=n?En(r):Gn(r),l=!1;for(;0!==a&&(!1===l||o);){const i=t[a+1];oo(t[a],e)&&(l=!0,t[a+1]=n?jn(i):Ln(i)),a=n?En(i):Gn(i)}l&&(t[i+1]=n?Ln(r):jn(r))}function oo(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&ie(t,e)>=0}function ao(t,e,i){return co(t,e,i,!1),ao}function lo(t,e){return co(t,e,null,!0),lo}function co(t,e,i,n){const s=Xe(),r=ti(),o=ui(2);r.firstUpdatePass&&function(t,e,i,n){const s=t.data;if(null===s[i+1]){const r=s[wi()+20],o=function(t,e){return e>=t.expandoStartIndex}(t,i);(function(t,e){return 0!=(t.flags&(e?16:32))})(r,n)&&null===e&&!o&&(e=!1),e=function(t,e,i,n){const s=function(t){const e=Ye.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let r=n?e.residualClasses:e.residualStyles;if(null===s)0===(n?e.classBindings:e.styleBindings)&&(i=ho(i=uo(null,t,e,i,n),e.attrs,n),r=null);else{const o=e.directiveStylingLast;if(-1===o||t[o]!==s)if(i=uo(s,t,e,i,n),null===r){let i=function(t,e,i){const n=i?e.classBindings:e.styleBindings;if(0!==Gn(n))return t[En(n)]}(t,e,n);void 0!==i&&Array.isArray(i)&&(i=uo(null,t,e,i[1],n),i=ho(i,e.attrs,n),function(t,e,i,n){t[En(i?e.classBindings:e.styleBindings)]=n}(t,e,n,i))}else r=function(t,e,i){let n=void 0;const s=e.directiveEnd;for(let r=1+e.directiveStylingLast;r<s;r++)n=ho(n,t[r].hostAttrs,i);return ho(n,e.attrs,i)}(t,e,n)}return void 0!==r&&(n?e.residualClasses=r:e.residualStyles=r),i}(s,r,e,n),function(t,e,i,n,s,r){let o=r?e.classBindings:e.styleBindings,a=En(o),l=Gn(o);t[n]=i;let c,d=!1;if(Array.isArray(i)){const t=i;c=t[1],(null===c||ie(t,c)>0)&&(d=!0)}else c=i;if(s)if(0!==l){const e=En(t[a+1]);t[n+1]=On(e,a),0!==e&&(t[e+1]=Rn(t[e+1],n)),t[a+1]=131071&t[a+1]|n<<17}else t[n+1]=On(a,0),0!==a&&(t[a+1]=Rn(t[a+1],n)),a=n;else t[n+1]=On(l,0),0===a?a=n:t[l+1]=Rn(t[l+1],n),l=n;d&&(t[n+1]=Ln(t[n+1])),ro(t,c,n,!0),ro(t,c,n,!1),function(t,e,i,n,s){const r=s?t.residualClasses:t.residualStyles;null!=r&&"string"==typeof e&&ie(r,e)>=0&&(i[n+1]=jn(i[n+1]))}(e,c,t,n,r),o=On(a,l),r?e.classBindings=o:e.styleBindings=o}(s,r,e,i,o,n)}}(r,t,o,n),e!==Mn&&Ir(s,o,e)&&function(t,e,i,n,s,r,o,a){if(2!==e.type)return;const l=t.data,c=l[a+1];go(1==(1&c)?po(l,e,i,s,Gn(c),o):void 0)||(go(r)||function(t){return 2==(2&t)}(c)&&(r=po(l,null,i,s,a,o)),function(t,e,i,n,s){const r=Re(t);if(e)s?r?t.addClass(i,n):i.classList.add(n):r?t.removeClass(i,n):i.classList.remove(n);else{const e=-1==n.indexOf("-")?void 0:2;null==s?r?t.removeStyle(i,n,e):i.style.removeProperty(n):r?t.setStyle(i,n,s,e):i.style.setProperty(n,s)}}(n,o,Ne(wi(),i),s,r))}(r,r.data[wi()+20],s,s[11],t,s[o+1]=function(t,e){return null==t||("string"==typeof e?t+=e:"object"==typeof t&&(t=vt(cn(t)))),t}(e,i),n,o)}function uo(t,e,i,n,s){let r=null;const o=i.directiveEnd;let a=i.directiveStylingLast;for(-1===a?a=i.directiveStart:a++;a<o&&(r=e[a],n=ho(n,r.hostAttrs,s),r!==t);)a++;return null!==t&&(i.directiveStylingLast=a),n}function ho(t,e,i){const n=i?1:2;let s=-1;if(null!==e)for(let r=0;r<e.length;r++){const o=e[r];"number"==typeof o?s=o:s===n&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),te(t,o,!!i||e[++r]))}return void 0===t?null:t}function po(t,e,i,n,s,r){const o=null===e;let a=void 0;for(;s>0;){const e=t[s],r=Array.isArray(e),l=r?e[1]:e,c=null===l;let d=i[s+1];d===Mn&&(d=c?so:void 0);let u=c?ee(d,n):l===n?d:void 0;if(r&&!go(u)&&(u=ee(e,n)),go(u)&&(a=u,o))return a;const h=t[s+1];s=o?En(h):Gn(h)}if(null!==e){let t=r?e.residualClasses:e.residualStyles;null!=t&&(a=ee(t,n))}return a}function go(t){return void 0!==t}function mo(t,e=""){const i=Xe(),n=ti(),s=t+20,r=n.firstCreatePass?Bn(n,t,2,null,null):n.data[s],o=i[s]=function(t,e){return Re(e)?e.createText(t):e.createTextNode(t)}(e,i[11]);Es(n,i,o,r),ni(r,!1)}function fo(t){return vo("",t,""),fo}function vo(t,e,i){const n=Xe(),s=Ur(n,t,e,i);return s!==Mn&&ks(n,wi(),s),vo}function bo(t,e,i,n,s){const r=Xe(),o=Or(r,t,e,i,n,s);return o!==Mn&&ks(r,wi(),o),bo}function yo(t,e,i,n,s,r,o){const a=Xe(),l=Er(a,t,e,i,n,s,r,o);return l!==Mn&&ks(a,wi(),l),yo}function Co(t,e,i,n,s,r,o,a,l){const c=Xe(),d=function(t,e,i,n,s,r,o,a,l,c){const d=Tr(t,ci(),i,s,o,l);return ui(4),d?e+De(i)+n+De(s)+r+De(o)+a+De(l)+c:Mn}(c,t,e,i,n,s,r,o,a,l);return d!==Mn&&ks(c,wi(),d),Co}function Vo(t,e,i){const n=Xe();return Ir(n,di(),e)&&ts(ti(),Pi(),n,t,e,n[11],i,!0),Vo}const wo=void 0;var Ao=["en",[["a","p"],["AM","PM"],wo],[["AM","PM"],wo,wo],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],wo,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],wo,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",wo,"{1} 'at' {0}",wo],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){let e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let Po={};function ko(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let i=Do(e);if(i)return i;const n=e.split("-")[0];if(i=Do(n),i)return i;if("en"===n)return Ao;throw new Error(`Missing locale data for the locale "${t}".`)}function Do(t){return t in Po||(Po[t]=Mt.ng&&Mt.ng.common&&Mt.ng.common.locales&&Mt.ng.common.locales[t]),Po[t]}var Mo=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}({});let Io="en-US";function So(t){var e,i;i="Expected localeId to be defined",null==(e=t)&&function(t,e,i,n){throw new Error("ASSERTION ERROR: "+t+` [Expected=> null != ${e} <=Actual]`)}(i,e),"string"==typeof t&&(Io=t.toLowerCase().replace(/_/g,"-"))}function xo(t,e,i,n,s){if(t=Vt(t),Array.isArray(t))for(let r=0;r<t.length;r++)xo(t[r],e,i,n,s);else{const r=ti(),o=Xe();let a=dr(t)?t:Vt(t.provide),l=ar(t);const c=ii(),d=1048575&c.providerIndexes,u=c.directiveStart,h=c.providerIndexes>>20;if(dr(t)||!t.multi){const n=new Ti(l,s,Rr),p=Uo(a,e,s?d:d+h,u);-1===p?(zi(Bi(c,o),r,a),To(r,t,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,s&&(c.providerIndexes+=1048576),i.push(n),o.push(n)):(i[p]=n,o[p]=n)}else{const p=Uo(a,e,d+h,u),g=Uo(a,e,d,d+h),m=p>=0&&i[p],f=g>=0&&i[g];if(s&&!f||!s&&!m){zi(Bi(c,o),r,a);const d=function(t,e,i,n,s){const r=new Ti(t,i,Rr);return r.multi=[],r.index=e,r.componentProviders=0,_o(r,s,n&&!i),r}(s?Eo:Oo,i.length,s,n,l);!s&&f&&(i[g].providerFactory=d),To(r,t,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,s&&(c.providerIndexes+=1048576),i.push(d),o.push(d)}else To(r,t,p>-1?p:g,_o(i[s?g:p],l,!s&&n));!s&&n&&f&&i[g].componentProviders++}}}function To(t,e,i,n){const s=dr(e);if(s||e.useClass){const r=(e.useClass||e).prototype.ngOnDestroy;if(r){const o=t.destroyHooks||(t.destroyHooks=[]);if(!s&&e.multi){const t=o.indexOf(i);-1===t?o.push(i,[n,r]):o[t+1].push(n,r)}else o.push(i,r)}}}function _o(t,e,i){return i&&t.componentProviders++,t.multi.push(e)-1}function Uo(t,e,i,n){for(let s=i;s<n;s++)if(e[s]===t)return s;return-1}function Oo(t,e,i,n){return Lo(this.multi,[])}function Eo(t,e,i,n){const s=this.multi;let r;if(this.providerFactory){const t=this.providerFactory.componentProviders,e=Yi(i,i[1],this.providerFactory.index,n);r=e.slice(0,t),Lo(s,r);for(let i=t;i<e.length;i++)r.push(e[i])}else r=[],Lo(s,r);return r}function Lo(t,e){for(let i=0;i<t.length;i++)e.push((0,t[i])());return e}function Go(t,e=[]){return i=>{i.providersResolver=(i,n)=>function(t,e,i){const n=ti();if(n.firstCreatePass){const s=Pe(t);xo(i,n.data,n.blueprint,s,!0),xo(e,n.data,n.blueprint,s,!1)}}(i,n?n(t):t,e)}}class Ro{}class jo{resolveComponentFactory(t){throw function(t){const e=Error(`No component factory found for ${vt(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(t)}}let $o=(()=>{class t{}return t.NULL=new jo,t})(),No=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=()=>Fo(t),t})();const Fo=function(t){return qs(t,ii(),Xe())};class Bo{}var Ho=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}({});let Ko=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>qo(),t})();const qo=function(){const t=Xe(),e=Ke(ii().index,t);return function(t){const e=t[11];if(Re(e))return e;throw new Error("Cannot inject Renderer2 when the application uses Renderer3!")}(ye(e)?e:t)};let zo=(()=>{class t{}return t.\u0275prov=at({token:t,providedIn:"root",factory:()=>null}),t})();class Qo{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Wo=new Qo("10.2.4");class Jo{constructor(){}supports(t){return Pr(t)}create(t){return new Zo(t)}}const Yo=(t,e)=>e;class Zo{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||Yo}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,i=this._removalsHead,n=0,s=null;for(;e||i;){const r=!i||e&&e.currentIndex<ia(i,n,s)?e:i,o=ia(r,n,s),a=r.currentIndex;if(r===i)n--,i=i._nextRemoved;else if(e=e._next,null==r.previousIndex)n++;else{s||(s=[]);const t=o-n,e=a-n;if(t!=e){for(let i=0;i<t;i++){const n=i<s.length?s[i]:s[i]=0,r=n+i;e<=r&&r<t&&(s[i]=n+1)}s[r.previousIndex]=e-t}}o!==a&&t(r,o,a)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!Pr(t))throw new Error(`Error trying to diff '${vt(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,i,n,s=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)i=t[e],n=this._trackByFn(e,i),null!==s&&Object.is(s.trackById,n)?(r&&(s=this._verifyReinsertion(s,i,n,e)),Object.is(s.item,i)||this._addIdentityChange(s,i)):(s=this._mismatch(s,i,n,e),r=!0),s=s._next}else e=0,function(t,e){if(Array.isArray(t))for(let i=0;i<t.length;i++)e(t[i]);else{const i=t[wr()]();let n;for(;!(n=i.next()).done;)e(n.value)}}(t,t=>{n=this._trackByFn(e,t),null!==s&&Object.is(s.trackById,n)?(r&&(s=this._verifyReinsertion(s,t,n,e)),Object.is(s.item,t)||this._addIdentityChange(s,t)):(s=this._mismatch(s,t,n,e),r=!0),s=s._next,e++}),this.length=e;return this._truncate(s),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,i,n){let s;return null===t?s=this._itTail:(s=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,n))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,s,n)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,s,n)):t=this._addAfter(new Xo(e,i),s,n),t}_verifyReinsertion(t,e,i,n){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?t=this._reinsertAfter(s,t._prev,n):t.currentIndex!=n&&(t.currentIndex=n,this._addToMoves(t,n)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const n=t._prevRemoved,s=t._nextRemoved;return null===n?this._removalsHead=s:n._nextRemoved=s,null===s?this._removalsTail=n:s._prevRemoved=n,this._insertAfter(t,e,i),this._addToMoves(t,i),t}_moveAfter(t,e,i){return this._unlink(t),this._insertAfter(t,e,i),this._addToMoves(t,i),t}_addAfter(t,e,i){return this._insertAfter(t,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,i){const n=null===e?this._itHead:e._next;return t._next=n,t._prev=e,null===n?this._itTail=t:n._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new ea),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,i=t._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new ea),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Xo{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class ta{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const e=t._prevDup,i=t._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class ea{constructor(){this.map=new Map}put(t){const e=t.trackById;let i=this.map.get(e);i||(i=new ta,this.map.set(e,i)),i.add(t)}get(t,e){const i=this.map.get(t);return i?i.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function ia(t,e,i){const n=t.previousIndex;if(null===n)return n;let s=0;return i&&n<i.length&&(s=i[n]),n+e+s}class na{constructor(){}supports(t){return t instanceof Map||kr(t)}create(){return new sa}}class sa{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||kr(t)))throw new Error(`Error trying to diff '${vt(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,i)=>{if(e&&e.key===i)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const n=this._getOrCreateRecordForKey(i,t);e=this._insertBeforeOrAppend(e,n)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const i=t._prev;return e._next=t,e._prev=i,t._prev=e,i&&(i._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const i=this._records.get(t);this._maybeAddToChanges(i,e);const n=i._prev,s=i._next;return n&&(n._next=s),s&&(s._prev=n),i._next=null,i._prev=null,i}const i=new ra(t);return this._records.set(t,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(i=>e(t[i],i))}}class ra{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let oa=(()=>{class t{constructor(t){this.factories=t}static create(e,i){if(null!=i){const t=i.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>{if(!i)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,i)},deps:[[t,new nt,new et]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${i=t,i.name||typeof i}'`);var i}}return t.\u0275prov=at({token:t,providedIn:"root",factory:()=>new t([new Jo])}),t})(),aa=(()=>{class t{constructor(t){this.factories=t}static create(e,i){if(i){const t=i.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>{if(!i)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,i)},deps:[[t,new nt,new et]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.\u0275prov=at({token:t,providedIn:"root",factory:()=>new t([new na])}),t})();const la=[new na],ca=new oa([new Jo]),da=new aa(la);let ua=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>ha(t,No),t})();const ha=function(t,e){return zs(t,e,ii(),Xe())};let pa=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>ga(t,No),t})();const ga=function(t,e){return function(t,e,i,n){let s;Ks||(Ks=class extends t{constructor(t,e,i){super(),this._lContainer=t,this._hostTNode=e,this._hostView=i}get element(){return qs(e,this._hostTNode,this._hostView)}get injector(){return new tn(this._hostTNode,this._hostView)}get parentInjector(){const t=qi(this._hostTNode,this._hostView);if(Gi(t)){const e=ji(t,this._hostView),i=Ri(t);return new tn(e[1].data[i+8],e)}return new tn(null,this._hostView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){return null!==this._lContainer[8]&&this._lContainer[8][t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,i){const n=t.createEmbeddedView(e||{});return this.insert(n,i),n}createComponent(t,e,i,n,s){const r=i||this.parentInjector;if(!s&&null==t.ngModule&&r){const t=r.get(Wt,null);t&&(s=t)}const o=t.create(r,n,void 0,s);return this.insert(o.hostView,e),o}insert(t,e){const i=t._lView,n=i[1];if(t.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");if(this.allocateContainerIfNeeded(),Ce(i[3])){const e=this.indexOf(t);if(-1!==e)this.detach(e);else{const e=i[3],n=new Ks(e,e[6],e[3]);n.detach(n.indexOf(t))}}const s=this._adjustIndex(e),r=this._lContainer;!function(t,e,i,n){const s=10+n,r=i.length;n>0&&(i[s-1][4]=e),n<r-10?(e[4]=i[s],Zt(i,10+n,e)):(i.push(e),e[4]=null),e[3]=i;const o=e[17];null!==o&&i!==o&&function(t,e){const i=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===i?t[9]=[e]:i.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(t),e[2]|=128}(n,i,r,s);const o=function t(e,i){const n=10+e+1;if(n<i.length){const e=i[n],s=e[1].firstChild;if(null!==s)return function e(i,n){if(null!==n){const s=n.type;if(2===s)return Fe(n,i);if(0===s)return t(-1,i[n.index]);if(3===s||4===s){const s=n.child;if(null!==s)return e(i,s);{const e=i[n.index];return Ce(e)?t(-1,e):$e(e)}}{const t=i[16],s=t[6],r=In(t),o=s.projection[n.projection];return null!=o?e(r,o):e(i,n.next)}}return null}(e,s)}return i[7]}(s,r),a=i[11],l=Os(a,r[7]);return null!==l&&function(t,e,i,n,s,r){n[0]=s,n[6]=e,Gs(t,n,i,1,s,r)}(n,r[6],a,i,l,o),t.attachToViewContainerRef(this),Zt(r[8],s,t),t}move(t,e){if(t.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");return this.insert(t,e)}indexOf(t){const e=this._lContainer[8];return null!==e?e.indexOf(t):-1}remove(t){this.allocateContainerIfNeeded();const e=this._adjustIndex(t,-1),i=Is(this._lContainer,e);i&&(Xt(this._lContainer[8],e),Ss(i[1],i))}detach(t){this.allocateContainerIfNeeded();const e=this._adjustIndex(t,-1),i=Is(this._lContainer,e);return i&&null!=Xt(this._lContainer[8],e)?new Ns(i):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}allocateContainerIfNeeded(){null===this._lContainer[8]&&(this._lContainer[8]=[])}});const r=n[i.index];if(Ce(r))s=r;else{let t;if(3===i.type)t=$e(r);else if(t=n[11].createComment(""),ke(n)){const e=n[11],s=Fe(i,n);Ts(e,Os(e,s),t,function(t,e){return Re(t)?t.nextSibling(e):e.nextSibling}(e,s))}else Es(n[1],n,t,i);n[i.index]=s=ps(r,n,t,i),fs(n,s)}return new Ks(s,i,n)}(t,e,ii(),Xe())},ma={};class fa extends $o{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=fe(t);return new ya(e,this.ngModule)}}function va(t){const e=[];for(let i in t)t.hasOwnProperty(i)&&e.push({propName:t[i],templateName:i});return e}const ba=new Et("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Ie});class ya extends Ro{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(Dn).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return va(this.componentDef.inputs)}get outputs(){return va(this.componentDef.outputs)}create(t,e,i,n){const s=(n=n||this.ngModule)?function(t,e){return{get:(i,n,s)=>{const r=t.get(i,ma,s);return r!==ma||n===ma?r:e.get(i,n,s)}}}(t,n.injector):t,r=s.get(Bo,je),o=s.get(zo,null),a=r.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",c=i?function(t,e,i){if(Re(t))return t.selectRootElement(e,i===se.ShadowDom);let n="string"==typeof e?t.querySelector(e):e;return n.textContent="",n}(a,i,this.componentDef.encapsulation):Nn(l,r.createRenderer(null,this.componentDef),function(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(l)),d=this.componentDef.onPush?576:528,u={components:[],scheduler:Ie,clean:Vs,playerHandler:null,flags:0},h=Zn(0,null,null,1,0,null,null,null,null,null),p=Fn(null,h,u,d,null,null,r,a,o,s);let g,m;fi(p);try{const t=function(t,e,i,n,s,r){const o=i[1];i[20]=t;const a=Bn(o,0,2,null,null),l=a.mergedAttrs=e.hostAttrs;null!==l&&(gr(a,l,!0),null!==t&&(_i(s,t,l),null!==a.classes&&$s(s,t,a.classes),null!==a.styles&&js(s,t,a.styles)));const c=n.createRenderer(t,e),d=Fn(i,Yn(e),null,e.onPush?64:16,i[20],a,n,c,null,null);return o.firstCreatePass&&(zi(Bi(a,i),o,e.type),os(o,a),ls(a,i.length,1)),fs(i,d),i[20]=d}(c,this.componentDef,p,r,a);if(c)if(i)_i(a,c,["ng-version",Wo.full]);else{const{attrs:t,classes:e}=function(t){const e=[],i=[];let n=1,s=2;for(;n<t.length;){let r=t[n];if("string"==typeof r)2===s?""!==r&&e.push(r,t[++n]):8===s&&i.push(r);else{if(!wn(s))break;s=r}n++}return{attrs:e,classes:i}}(this.componentDef.selectors[0]);t&&_i(a,c,t),e&&e.length>0&&$s(a,c,e.join(" "))}if(m=Be(h,0),void 0!==e){const t=m.projection=[];for(let i=0;i<this.ngContentSelectors.length;i++){const n=e[i];t.push(null!=n?Array.from(n):null)}}g=function(t,e,i,n,s){const r=i[1],o=function(t,e,i){const n=ii();t.firstCreatePass&&(i.providersResolver&&i.providersResolver(i),rs(t,n,1),cs(t,e,i));const s=Yi(e,t,e.length-1,n);fn(s,e);const r=Fe(n,e);return r&&fn(r,e),s}(r,i,e);n.components.push(o),t[8]=o,s&&s.forEach(t=>t(o,e)),e.contentQueries&&e.contentQueries(1,o,i.length-1);const a=ii();if(r.firstCreatePass&&(null!==e.hostBindings||null!==e.hostAttrs)){Ai(a.index-20);const t=i[1];is(t,e),ns(t,i,e.hostVars),ss(e,o)}return o}(t,this.componentDef,p,u,[mr]),Hn(h,p,null)}finally{Vi()}return new Ca(this.componentType,g,qs(No,m,p),p,m)}}class Ca extends class{}{constructor(t,e,i,n,s){super(),this.location=i,this._rootLView=n,this._tNode=s,this.destroyCbs=[],this.instance=e,this.hostView=this.changeDetectorRef=new Fs(n),this.componentType=t}get injector(){return new tn(this._tNode,this._rootLView)}destroy(){this.destroyCbs&&(this.destroyCbs.forEach(t=>t()),this.destroyCbs=null,!this.hostView.destroyed&&this.hostView.destroy())}onDestroy(t){this.destroyCbs&&this.destroyCbs.push(t)}}const Va=new Map;class wa extends Wt{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new fa(this);const i=be(t),n=t[_t]||null;n&&So(n),this._bootstrapComponents=Se(i.bootstrap),this._r3Injector=sr(t,e,[{provide:Wt,useValue:this},{provide:$o,useValue:this.componentFactoryResolver}],vt(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=hr.THROW_IF_NOT_FOUND,i=st.Default){return t===hr||t===Wt||t===Lt?this:this._r3Injector.get(t,e,i)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Aa extends Jt{constructor(t){super(),this.moduleType=t,null!==be(t)&&function(t){const e=new Set;!function t(i){const n=be(i,!0),s=n.id;null!==s&&(function(t,e,i){if(e&&e!==i)throw new Error(`Duplicate module registered for ${t} - ${vt(e)} vs ${vt(e.name)}`)}(s,Va.get(s),i),Va.set(s,i));const r=Se(n.imports);for(const o of r)e.has(o)||(e.add(o),t(o))}(t)}(t)}create(t){return new wa(this.moduleType,t)}}function Pa(t,e,i){const n=li()+t,s=Xe();return s[n]===Mn?Dr(s,n,i?e.call(i):e()):Mr(s,n)}function ka(t,e,i,n){return Ta(Xe(),li(),t,e,i,n)}function Da(t,e,i,n,s){return _a(Xe(),li(),t,e,i,n,s)}function Ma(t,e,i,n,s,r){return function(t,e,i,n,s,r,o,a){const l=e+i;return xr(t,l,s,r,o)?Dr(t,l+3,a?n.call(a,s,r,o):n(s,r,o)):xa(t,l+3)}(Xe(),li(),t,e,i,n,s,r)}function Ia(t,e,i,n,s,r,o){return function(t,e,i,n,s,r,o,a,l){const c=e+i;return Tr(t,c,s,r,o,a)?Dr(t,c+4,l?n.call(l,s,r,o,a):n(s,r,o,a)):xa(t,c+4)}(Xe(),li(),t,e,i,n,s,r,o)}function Sa(t,e,i,n,s,r,o,a,l){const c=li()+t,d=Xe(),u=Tr(d,c,i,n,s,r);return Sr(d,c+4,o,a)||u?Dr(d,c+6,l?e.call(l,i,n,s,r,o,a):e(i,n,s,r,o,a)):Mr(d,c+6)}function xa(t,e){const i=t[e];return i===Mn?void 0:i}function Ta(t,e,i,n,s,r){const o=e+i;return Ir(t,o,s)?Dr(t,o+1,r?n.call(r,s):n(s)):xa(t,o+1)}function _a(t,e,i,n,s,r,o){const a=e+i;return Sr(t,a,s,r)?Dr(t,a+2,o?n.call(o,s,r):n(s,r)):xa(t,a+2)}function Ua(t,e){const i=ti();let n;const s=t+20;i.firstCreatePass?(n=function(t,e){if(e)for(let i=e.length-1;i>=0;i--){const n=e[i];if(t===n.name)return n}throw new Error(`The pipe '${t}' could not be found!`)}(e,i.pipeRegistry),i.data[s]=n,n.onDestroy&&(i.destroyHooks||(i.destroyHooks=[])).push(s,n.onDestroy)):n=i.data[s];const r=n.factory||(n.factory=ve(n.type)),o=Bt(Rr);try{const e=Ni(!1),n=r();return Ni(e),function(t,e,i,n){const s=i+20;s>=t.data.length&&(t.data[s]=null,t.blueprint[s]=null),e[s]=n}(i,Xe(),t,n),n}finally{Bt(o)}}function Oa(t,e,i){const n=Xe(),s=He(n,t);return Ga(n,La(n,t)?Ta(n,li(),e,s.transform,i,s):s.transform(i))}function Ea(t,e,i,n){const s=Xe(),r=He(s,t);return Ga(s,La(s,t)?_a(s,li(),e,r.transform,i,n,r):r.transform(i,n))}function La(t,e){return t[1].data[e+20].pure}function Ga(t,e){return Ar.isWrapped(e)&&(e=Ar.unwrap(e),t[ci()]=Mn),e}const Ra=class extends A{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,i){let n,s=t=>null,r=()=>null;t&&"object"==typeof t?(n=this.__isAsync?e=>{setTimeout(()=>t.next(e))}:e=>{t.next(e)},t.error&&(s=this.__isAsync?e=>{setTimeout(()=>t.error(e))}:e=>{t.error(e)}),t.complete&&(r=this.__isAsync?()=>{setTimeout(()=>t.complete())}:()=>{t.complete()})):(n=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)},e&&(s=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)}),i&&(r=this.__isAsync?()=>{setTimeout(()=>i())}:()=>{i()}));const o=super.subscribe(n,s,r);return t instanceof u&&t.add(o),o}};function ja(t,e){return zs(ua,No,t,e)}const $a=new Et("Application Initializer");let Na=(()=>{class t{constructor(t){this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const e=this.appInits[i]();Qr(e)&&t.push(e)}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(Kt($a,8))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Fa=new Et("AppId"),Ba={provide:Fa,useFactory:function(){return`${Ha()}${Ha()}${Ha()}`},deps:[]};function Ha(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Ka=new Et("Platform Initializer"),qa=new Et("Platform ID"),za=new Et("appBootstrapListener");let Qa=(()=>{class t{log(t){console.log(t)}warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Wa=new Et("LocaleId"),Ja=new Et("DefaultCurrencyCode");class Ya{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const Za=function(t){return new Aa(t)},Xa=Za,tl=function(t){return Promise.resolve(Za(t))},el=function(t){const e=Za(t),i=Se(be(t).declarations).reduce((t,e)=>{const i=fe(e);return i&&t.push(new ya(i)),t},[]);return new Ya(e,i)},il=el,nl=function(t){return Promise.resolve(el(t))};let sl=(()=>{class t{constructor(){this.compileModuleSync=Xa,this.compileModuleAsync=tl,this.compileModuleAndAllComponentsSync=il,this.compileModuleAndAllComponentsAsync=nl}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const rl=(()=>Promise.resolve(0))();function ol(t){"undefined"==typeof Zone?rl.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class al{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ra(!1),this.onMicrotaskEmpty=new Ra(!1),this.onStable=new Ra(!1),this.onError=new Ra(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=e,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){let t=Mt.requestAnimationFrame,e=Mt.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i);const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=!!t.shouldCoalesceEventChangeDetection&&t.nativeRequestAnimationFrame&&(()=>{!function(t){-1===t.lastRequestAnimationFrameId&&(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Mt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,ul(t),dl(t)},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),ul(t))}(t)});t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:e},onInvokeTask:(i,n,s,r,o,a)=>{try{return hl(t),i.invokeTask(s,r,o,a)}finally{e&&"eventTask"===r.type&&e(),pl(t)}},onInvoke:(e,i,n,s,r,o,a)=>{try{return hl(t),e.invoke(n,s,r,o,a)}finally{pl(t)}},onHasTask:(e,i,n,s)=>{e.hasTask(n,s),i===n&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,ul(t),dl(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(e,i,n,s)=>(e.handleError(n,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(this)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!al.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(al.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,n){const s=this._inner,r=s.scheduleEventTask("NgZoneEvent: "+n,t,cl,ll,ll);try{return s.runTask(r,e,i)}finally{s.cancelTask(r)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}}function ll(){}const cl={};function dl(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function ul(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||t.shouldCoalesceEventChangeDetection&&-1!==t.lastRequestAnimationFrameId)}function hl(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function pl(t){t._nesting--,dl(t)}class gl{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ra,this.onMicrotaskEmpty=new Ra,this.onStable=new Ra,this.onError=new Ra}run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,n){return t.apply(e,i)}}let ml=(()=>{class t{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{al.assertNotInAngularZone(),ol(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())ol(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,i){let n=-1;e&&e>0&&(n=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==n),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:n,updateCb:i})}whenStable(t,e,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,i){return[]}}return t.\u0275fac=function(e){return new(e||t)(Kt(al))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),fl=(()=>{class t{constructor(){this._applications=new Map,yl.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return yl.findTestabilityInTree(this,t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class vl{addToWindow(t){}findTestabilityInTree(t,e,i){return null}}let bl,yl=new vl;const Cl=new Et("AllowMultipleToken");class Vl{constructor(t,e){this.name=t,this.token=e}}function wl(t,e,i=[]){const n="Platform: "+e,s=new Et(n);return(e=[])=>{let r=Al();if(!r||r.injector.get(Cl,!1))if(t)t(i.concat(e).concat({provide:s,useValue:!0}));else{const t=i.concat(e).concat({provide:s,useValue:!0},{provide:Zs,useValue:"platform"});!function(t){if(bl&&!bl.destroyed&&!bl.injector.get(Cl,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");bl=t.get(Pl);const e=t.get(Ka,null);e&&e.forEach(t=>t())}(hr.create({providers:t,name:n}))}return function(t){const e=Al();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(s)}}function Al(){return bl&&!bl.destroyed?bl:null}let Pl=(()=>{class t{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const i=function(t,e){let i;return i="noop"===t?new gl:("zone.js"===t?void 0:t)||new al({enableLongStackTrace:un(),shouldCoalesceEventChangeDetection:e}),i}(e?e.ngZone:void 0,e&&e.ngZoneEventCoalescing||!1),n=[{provide:al,useValue:i}];return i.run(()=>{const e=hr.create({providers:n,parent:this.injector,name:t.moduleType.name}),s=t.create(e),r=s.injector.get(an,null);if(!r)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return s.onDestroy(()=>Ml(this._modules,s)),i.runOutsideAngular(()=>i.onError.subscribe({next:t=>{r.handleError(t)}})),function(t,e,i){try{const n=i();return Qr(n)?n.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):n}catch(n){throw e.runOutsideAngular(()=>t.handleError(n)),n}}(r,i,()=>{const t=s.injector.get(Na);return t.runInitializers(),t.donePromise.then(()=>(So(s.injector.get(Wa,"en-US")||"en-US"),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,e=[]){const i=kl({},e);return function(t,e,i){const n=new Aa(i);return Promise.resolve(n)}(0,0,t).then(t=>this.bootstrapModuleFactory(t,i))}_moduleDoBootstrap(t){const e=t.injector.get(Dl);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${vt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(Kt(hr))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function kl(t,e){return Array.isArray(e)?e.reduce(kl,t):Object.assign(Object.assign({},t),e)}let Dl=(()=>{class t{constructor(t,e,i,n,s,r){this._zone=t,this._console=e,this._injector=i,this._exceptionHandler=n,this._componentFactoryResolver=s,this._initStatus=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=un(),this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new b(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),a=new b(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{al.assertNotInAngularZone(),ol(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const i=this._zone.onUnstable.subscribe(()=>{al.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),i.unsubscribe()}});this.isStable=function(...t){let e=Number.POSITIVE_INFINITY,i=null,n=t[t.length-1];return k(n)?(i=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof n&&(e=t.pop()),null===i&&1===t.length&&t[0]instanceof b?t[0]:B(e)(H(t,i))}(o,a.pipe(t=>{return K()((e=Y,function(t){let i;i="function"==typeof e?e:function(){return e};const n=Object.create(t,W);return n.source=t,n.subjectFactory=i,n})(t));var e}))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let i;i=t instanceof Ro?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(i.componentType);const n=i.isBoundToModule?void 0:this._injector.get(Wt),s=i.create(hr.NULL,[],e||i.selector,n);s.onDestroy(()=>{this._unloadComponent(s)});const r=s.injector.get(ml,null);return r&&s.injector.get(fl).registerApplication(s.location.nativeElement,r),this._loadComponent(s),un()&&this._console.log("Angular is running in development mode. Call enableProdMode() to enable production mode."),s}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges();if(this._enforceNoNewChanges)for(let t of this._views)t.checkNoChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;Ml(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(za,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}_unloadComponent(t){this.detachView(t.hostView),Ml(this.components,t)}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy())}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(Kt(al),Kt(Qa),Kt(hr),Kt(an),Kt($o),Kt(Na))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function Ml(t,e){const i=t.indexOf(e);i>-1&&t.splice(i,1)}class Il{}class Sl{}const xl={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let Tl=(()=>{class t{constructor(t,e){this._compiler=t,this._config=e||xl}load(t){return this.loadAndCompile(t)}loadAndCompile(t){let[e,n]=t.split("#");return void 0===n&&(n="default"),i("crnd")(e).then(t=>t[n]).then(t=>_l(t,e,n)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,n]=t.split("#"),s="NgFactory";return void 0===n&&(n="default",s=""),i("crnd")(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[n+s]).then(t=>_l(t,e,n))}}return t.\u0275fac=function(e){return new(e||t)(Kt(sl),Kt(Sl,8))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function _l(t,e,i){if(!t)throw new Error(`Cannot find '${i}' in '${e}'`);return t}const Ul=wl(null,"core",[{provide:qa,useValue:"unknown"},{provide:Pl,deps:[hr]},{provide:fl,deps:[]},{provide:Qa,deps:[]}]),Ol=[{provide:Dl,useClass:Dl,deps:[al,Qa,hr,an,$o,Na]},{provide:ba,deps:[al],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:Na,useClass:Na,deps:[[new et,$a]]},{provide:sl,useClass:sl,deps:[]},Ba,{provide:oa,useFactory:function(){return ca},deps:[]},{provide:aa,useFactory:function(){return da},deps:[]},{provide:Wa,useFactory:function(t){return So(t=t||"undefined"!=typeof $localize&&$localize.locale||"en-US"),t},deps:[[new tt(Wa),new et,new nt]]},{provide:Ja,useValue:"USD"}];let El=(()=>{class t{constructor(t){}}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)(Kt(Dl))},providers:Ol}),t})(),Ll=null;function Gl(){return Ll}const Rl=new Et("DocumentToken");let jl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({factory:$l,token:t,providedIn:"platform"}),t})();function $l(){return Kt(Fl)}const Nl=new Et("Location Initialized");let Fl=(()=>{class t extends jl{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=Gl().getLocation(),this._history=Gl().getHistory()}getBaseHrefFromDOM(){return Gl().getBaseHref(this._doc)}onPopState(t){Gl().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}onHashChange(t){Gl().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,i){Bl()?this._history.pushState(t,e,i):this.location.hash=i}replaceState(t,e,i){Bl()?this._history.replaceState(t,e,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(Kt(Rl))},t.\u0275prov=at({factory:Hl,token:t,providedIn:"platform"}),t})();function Bl(){return!!window.history.pushState}function Hl(){return new Fl(Kt(Rl))}function Kl(t,e){if(0==t.length)return e;if(0==e.length)return t;let i=0;return t.endsWith("/")&&i++,e.startsWith("/")&&i++,2==i?t+e.substring(1):1==i?t+e:t+"/"+e}function ql(t){const e=t.match(/#|\?|$/),i=e&&e.index||t.length;return t.slice(0,i-("/"===t[i-1]?1:0))+t.slice(i)}function zl(t){return t&&"?"!==t[0]?"?"+t:t}let Ql=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({factory:Wl,token:t,providedIn:"root"}),t})();function Wl(t){const e=Kt(Rl).location;return new Yl(Kt(jl),e&&e.origin||"")}const Jl=new Et("appBaseHref");let Yl=(()=>{class t extends Ql{constructor(t,e){if(super(),this._platformLocation=t,null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Kl(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+zl(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${e}${i}`:e}pushState(t,e,i,n){const s=this.prepareExternalUrl(i+zl(n));this._platformLocation.pushState(t,e,s)}replaceState(t,e,i,n){const s=this.prepareExternalUrl(i+zl(n));this._platformLocation.replaceState(t,e,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(Kt(jl),Kt(Jl,8))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Zl=(()=>{class t extends Ql{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",null!=e&&(this._baseHref=e)}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=Kl(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,i,n){let s=this.prepareExternalUrl(i+zl(n));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.pushState(t,e,s)}replaceState(t,e,i,n){let s=this.prepareExternalUrl(i+zl(n));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(Kt(jl),Kt(Jl,8))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Xl=(()=>{class t{constructor(t,e){this._subject=new Ra,this._urlChangeListeners=[],this._platformStrategy=t;const i=this._platformStrategy.getBaseHref();this._platformLocation=e,this._baseHref=ql(ec(i)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+zl(e))}normalize(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,ec(e)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e="",i=null){this._platformStrategy.pushState(i,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+zl(e)),i)}replaceState(t,e="",i=null){this._platformStrategy.replaceState(i,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+zl(e)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)}))}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(i=>i(t,e))}subscribe(t,e,i){return this._subject.subscribe({next:t,error:e,complete:i})}}return t.\u0275fac=function(e){return new(e||t)(Kt(Ql),Kt(jl))},t.normalizeQueryParams=zl,t.joinWithSlash=Kl,t.stripTrailingSlash=ql,t.\u0275prov=at({factory:tc,token:t,providedIn:"root"}),t})();function tc(){return new Xl(Kt(Ql),Kt(jl))}function ec(t){return t.replace(/\/index.html$/,"")}var ic=function(t){return t[t.Decimal=0]="Decimal",t[t.Percent=1]="Percent",t[t.Currency=2]="Currency",t[t.Scientific=3]="Scientific",t}({}),nc=function(t){return t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Two=2]="Two",t[t.Few=3]="Few",t[t.Many=4]="Many",t[t.Other=5]="Other",t}({}),sc=function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t}({}),rc=function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t}({}),oc=function(t){return t[t.Short=0]="Short",t[t.Medium=1]="Medium",t[t.Long=2]="Long",t[t.Full=3]="Full",t}({}),ac=function(t){return t[t.Decimal=0]="Decimal",t[t.Group=1]="Group",t[t.List=2]="List",t[t.PercentSign=3]="PercentSign",t[t.PlusSign=4]="PlusSign",t[t.MinusSign=5]="MinusSign",t[t.Exponential=6]="Exponential",t[t.SuperscriptingExponent=7]="SuperscriptingExponent",t[t.PerMille=8]="PerMille",t[t[1/0]=9]="Infinity",t[t.NaN=10]="NaN",t[t.TimeSeparator=11]="TimeSeparator",t[t.CurrencyDecimal=12]="CurrencyDecimal",t[t.CurrencyGroup=13]="CurrencyGroup",t}({});function lc(t,e){return pc(ko(t)[Mo.DateFormat],e)}function cc(t,e){return pc(ko(t)[Mo.TimeFormat],e)}function dc(t,e){return pc(ko(t)[Mo.DateTimeFormat],e)}function uc(t,e){const i=ko(t),n=i[Mo.NumberSymbols][e];if(void 0===n){if(e===ac.CurrencyDecimal)return i[Mo.NumberSymbols][ac.Decimal];if(e===ac.CurrencyGroup)return i[Mo.NumberSymbols][ac.Group]}return n}function hc(t){if(!t[Mo.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[Mo.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function pc(t,e){for(let i=e;i>-1;i--)if(void 0!==t[i])return t[i];throw new Error("Locale data API: locale data undefined")}function gc(t){const[e,i]=t.split(":");return{hours:+e,minutes:+i}}const mc=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,fc={},vc=/((?:[^GyMLwWdEabBhHmsSzZO']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var bc=function(t){return t[t.Short=0]="Short",t[t.ShortGMT=1]="ShortGMT",t[t.Long=2]="Long",t[t.Extended=3]="Extended",t}({}),yc=function(t){return t[t.FullYear=0]="FullYear",t[t.Month=1]="Month",t[t.Date=2]="Date",t[t.Hours=3]="Hours",t[t.Minutes=4]="Minutes",t[t.Seconds=5]="Seconds",t[t.FractionalSeconds=6]="FractionalSeconds",t[t.Day=7]="Day",t}({}),Cc=function(t){return t[t.DayPeriods=0]="DayPeriods",t[t.Days=1]="Days",t[t.Months=2]="Months",t[t.Eras=3]="Eras",t}({});function Vc(t,e){return e&&(t=t.replace(/\{([^}]+)}/g,(function(t,i){return null!=e&&i in e?e[i]:t}))),t}function wc(t,e,i="-",n,s){let r="";(t<0||s&&t<=0)&&(s?t=1-t:(t=-t,r=i));let o=String(t);for(;o.length<e;)o="0"+o;return n&&(o=o.substr(o.length-e)),r+o}function Ac(t,e,i=0,n=!1,s=!1){return function(r,o){let a=function(t,e){switch(t){case yc.FullYear:return e.getFullYear();case yc.Month:return e.getMonth();case yc.Date:return e.getDate();case yc.Hours:return e.getHours();case yc.Minutes:return e.getMinutes();case yc.Seconds:return e.getSeconds();case yc.FractionalSeconds:return e.getMilliseconds();case yc.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,r);if((i>0||a>-i)&&(a+=i),t===yc.Hours)0===a&&-12===i&&(a=12);else if(t===yc.FractionalSeconds)return l=e,wc(a,3).substr(0,l);var l;const c=uc(o,ac.MinusSign);return wc(a,e,c,n,s)}}function Pc(t,e,i=sc.Format,n=!1){return function(s,r){return function(t,e,i,n,s,r){switch(i){case Cc.Months:return function(t,e,i){const n=ko(t),s=pc([n[Mo.MonthsFormat],n[Mo.MonthsStandalone]],e);return pc(s,i)}(e,s,n)[t.getMonth()];case Cc.Days:return function(t,e,i){const n=ko(t),s=pc([n[Mo.DaysFormat],n[Mo.DaysStandalone]],e);return pc(s,i)}(e,s,n)[t.getDay()];case Cc.DayPeriods:const o=t.getHours(),a=t.getMinutes();if(r){const t=function(t){const e=ko(t);return hc(e),(e[Mo.ExtraData][2]||[]).map(t=>"string"==typeof t?gc(t):[gc(t[0]),gc(t[1])])}(e),i=function(t,e,i){const n=ko(t);hc(n);const s=pc([n[Mo.ExtraData][0],n[Mo.ExtraData][1]],e)||[];return pc(s,i)||[]}(e,s,n),r=t.findIndex(t=>{if(Array.isArray(t)){const[e,i]=t,n=o>=e.hours&&a>=e.minutes,s=o<i.hours||o===i.hours&&a<i.minutes;if(e.hours<i.hours){if(n&&s)return!0}else if(n||s)return!0}else if(t.hours===o&&t.minutes===a)return!0;return!1});if(-1!==r)return i[r]}return function(t,e,i){const n=ko(t),s=pc([n[Mo.DayPeriodsFormat],n[Mo.DayPeriodsStandalone]],e);return pc(s,i)}(e,s,n)[o<12?0:1];case Cc.Eras:return function(t,e){return pc(ko(t)[Mo.Eras],e)}(e,n)[t.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type "+i)}}(s,r,t,e,i,n)}}function kc(t){return function(e,i,n){const s=-1*n,r=uc(i,ac.MinusSign),o=s>0?Math.floor(s/60):Math.ceil(s/60);switch(t){case bc.Short:return(s>=0?"+":"")+wc(o,2,r)+wc(Math.abs(s%60),2,r);case bc.ShortGMT:return"GMT"+(s>=0?"+":"")+wc(o,1,r);case bc.Long:return"GMT"+(s>=0?"+":"")+wc(o,2,r)+":"+wc(Math.abs(s%60),2,r);case bc.Extended:return 0===n?"Z":(s>=0?"+":"")+wc(o,2,r)+":"+wc(Math.abs(s%60),2,r);default:throw new Error(`Unknown zone width "${t}"`)}}}function Dc(t,e=!1){return function(i,n){let s;if(e){const t=new Date(i.getFullYear(),i.getMonth(),1).getDay()-1,e=i.getDate();s=1+Math.floor((e+t)/7)}else{const t=(r=i,new Date(r.getFullYear(),r.getMonth(),r.getDate()+(4-r.getDay()))),e=function(t){const e=new Date(t,0,1).getDay();return new Date(t,0,1+(e<=4?4:11)-e)}(t.getFullYear()),n=t.getTime()-e.getTime();s=1+Math.round(n/6048e5)}var r;return wc(s,t,uc(n,ac.MinusSign))}}const Mc={};function Ic(t,e){t=t.replace(/:/g,"");const i=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(i)?e:i}function Sc(t){return t instanceof Date&&!isNaN(t.valueOf())}const xc=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function Tc(t){const e=parseInt(t);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+t);return e}class _c{}let Uc=(()=>{class t extends _c{constructor(t){super(),this.locale=t}getPluralCategory(t,e){switch(function(t){return ko(t)[Mo.PluralCase]}(e||this.locale)(t)){case nc.Zero:return"zero";case nc.One:return"one";case nc.Two:return"two";case nc.Few:return"few";case nc.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(Kt(Wa))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function Oc(t,e){e=encodeURIComponent(e);for(const i of t.split(";")){const t=i.indexOf("="),[n,s]=-1==t?[i,""]:[i.slice(0,t),i.slice(t+1)];if(n.trim()===e)return decodeURIComponent(s)}return null}let Ec=(()=>{class t{constructor(t,e,i,n){this._iterableDiffers=t,this._keyValueDiffers=e,this._ngEl=i,this._renderer=n,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(Pr(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachChangedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachRemovedItem(t=>{t.previousValue&&this._toggleClass(t.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(t=>{if("string"!=typeof t.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got "+vt(t.item));this._toggleClass(t.item,!0)}),t.forEachRemovedItem(t=>this._toggleClass(t.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!0)):Object.keys(t).forEach(e=>this._toggleClass(e,!!t[e])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!1)):Object.keys(t).forEach(t=>this._toggleClass(t,!1)))}_toggleClass(t,e){(t=t.trim())&&t.split(/\s+/g).forEach(t=>{e?this._renderer.addClass(this._ngEl.nativeElement,t):this._renderer.removeClass(this._ngEl.nativeElement,t)})}}return t.\u0275fac=function(e){return new(e||t)(Rr(oa),Rr(aa),Rr(No),Rr(Ko))},t.\u0275dir=ge({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),t})();class Lc{constructor(t,e,i,n){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=n}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Gc=(()=>{class t{constructor(t,e,i){this._viewContainer=t,this._template=e,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){un()&&null!=t&&"function"!=typeof t&&console&&console.warn&&console.warn(`trackBy must be a function, but received ${JSON.stringify(t)}. See https://angular.io/api/common/NgForOf#change-propagation for more information.`),this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const i=this._ngForOf;if(!this._differ&&i)try{this._differ=this._differs.find(i).create(this.ngForTrackBy)}catch(e){throw new Error(`Cannot find a differ supporting object '${i}' of type '${t=i,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,i,n)=>{if(null==t.previousIndex){const i=this._viewContainer.createEmbeddedView(this._template,new Lc(null,this._ngForOf,-1,-1),null===n?void 0:n),s=new Rc(t,i);e.push(s)}else if(null==n)this._viewContainer.remove(null===i?void 0:i);else if(null!==i){const s=this._viewContainer.get(i);this._viewContainer.move(s,n);const r=new Rc(t,s);e.push(r)}});for(let i=0;i<e.length;i++)this._perViewChange(e[i].view,e[i].record);for(let i=0,n=this._viewContainer.length;i<n;i++){const t=this._viewContainer.get(i);t.context.index=i,t.context.count=n,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(Rr(pa),Rr(ua),Rr(oa))},t.\u0275dir=ge({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class Rc{constructor(t,e){this.record=t,this.view=e}}let jc=(()=>{class t{constructor(t,e){this._viewContainer=t,this._context=new $c,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Nc("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Nc("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(Rr(pa),Rr(ua))},t.\u0275dir=ge({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class $c{constructor(){this.$implicit=null,this.ngIf=null}}function Nc(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${vt(e)}'.`)}let Fc=(()=>{class t{constructor(t,e,i){this._ngEl=t,this._differs=e,this._renderer=i,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,e){const[i,n]=t.split(".");null!=(e=null!=e&&n?`${e}${n}`:e)?this._renderer.setStyle(this._ngEl.nativeElement,i,e):this._renderer.removeStyle(this._ngEl.nativeElement,i)}_applyChanges(t){t.forEachRemovedItem(t=>this._setStyle(t.key,null)),t.forEachAddedItem(t=>this._setStyle(t.key,t.currentValue)),t.forEachChangedItem(t=>this._setStyle(t.key,t.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(Rr(No),Rr(aa),Rr(Ko))},t.\u0275dir=ge({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),t})(),Bc=(()=>{class t{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(t){if(this._shouldRecreateView(t)){const t=this._viewContainerRef;this._viewRef&&t.remove(t.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?t.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&this.ngTemplateOutletContext&&this._updateExistingContext(this.ngTemplateOutletContext)}_shouldRecreateView(t){const e=t.ngTemplateOutletContext;return!!t.ngTemplateOutlet||e&&this._hasContextShapeChanged(e)}_hasContextShapeChanged(t){const e=Object.keys(t.previousValue||{}),i=Object.keys(t.currentValue||{});if(e.length===i.length){for(let t of i)if(-1===e.indexOf(t))return!0;return!1}return!0}_updateExistingContext(t){for(let e of Object.keys(t))this._viewRef.context[e]=this.ngTemplateOutletContext[e]}}return t.\u0275fac=function(e){return new(e||t)(Rr(pa))},t.\u0275dir=ge({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[_e]}),t})();function Hc(t,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${vt(t)}'`)}let Kc=(()=>{class t{transform(e){if(!e)return e;if("string"!=typeof e)throw Hc(t,e);return e.toUpperCase()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=me({name:"uppercase",type:t,pure:!0}),t})(),qc=(()=>{class t{constructor(t){this.locale=t}transform(e,i="mediumDate",n,s){if(null==e||""===e||e!=e)return null;try{return function(t,e,i,n){let s=function(t){if(Sc(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){t=t.trim();const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);if(/^(\d{4}-\d{1,2}-\d{1,2})$/.test(t)){const[e,i,n]=t.split("-").map(t=>+t);return new Date(e,i-1,n)}let i;if(i=t.match(mc))return function(t){const e=new Date(0);let i=0,n=0;const s=t[8]?e.setUTCFullYear:e.setFullYear,r=t[8]?e.setUTCHours:e.setHours;t[9]&&(i=Number(t[9]+t[10]),n=Number(t[9]+t[11])),s.call(e,Number(t[1]),Number(t[2])-1,Number(t[3]));const o=Number(t[4]||0)-i,a=Number(t[5]||0)-n,l=Number(t[6]||0),c=Math.round(1e3*parseFloat("0."+(t[7]||0)));return r.call(e,o,a,l,c),e}(i)}const e=new Date(t);if(!Sc(e))throw new Error(`Unable to convert "${t}" into a date`);return e}(t);e=function t(e,i){const n=function(t){return ko(t)[Mo.LocaleId]}(e);if(fc[n]=fc[n]||{},fc[n][i])return fc[n][i];let s="";switch(i){case"shortDate":s=lc(e,oc.Short);break;case"mediumDate":s=lc(e,oc.Medium);break;case"longDate":s=lc(e,oc.Long);break;case"fullDate":s=lc(e,oc.Full);break;case"shortTime":s=cc(e,oc.Short);break;case"mediumTime":s=cc(e,oc.Medium);break;case"longTime":s=cc(e,oc.Long);break;case"fullTime":s=cc(e,oc.Full);break;case"short":const i=t(e,"shortTime"),n=t(e,"shortDate");s=Vc(dc(e,oc.Short),[i,n]);break;case"medium":const r=t(e,"mediumTime"),o=t(e,"mediumDate");s=Vc(dc(e,oc.Medium),[r,o]);break;case"long":const a=t(e,"longTime"),l=t(e,"longDate");s=Vc(dc(e,oc.Long),[a,l]);break;case"full":const c=t(e,"fullTime"),d=t(e,"fullDate");s=Vc(dc(e,oc.Full),[c,d])}return s&&(fc[n][i]=s),s}(i,e)||e;let r,o=[];for(;e;){if(r=vc.exec(e),!r){o.push(e);break}{o=o.concat(r.slice(1));const t=o.pop();if(!t)break;e=t}}let a=s.getTimezoneOffset();n&&(a=Ic(n,a),s=function(t,e,i){const n=t.getTimezoneOffset();return function(t,e){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+e),t}(t,-1*(Ic(e,n)-n))}(s,n));let l="";return o.forEach(t=>{const e=function(t){if(Mc[t])return Mc[t];let e;switch(t){case"G":case"GG":case"GGG":e=Pc(Cc.Eras,rc.Abbreviated);break;case"GGGG":e=Pc(Cc.Eras,rc.Wide);break;case"GGGGG":e=Pc(Cc.Eras,rc.Narrow);break;case"y":e=Ac(yc.FullYear,1,0,!1,!0);break;case"yy":e=Ac(yc.FullYear,2,0,!0,!0);break;case"yyy":e=Ac(yc.FullYear,3,0,!1,!0);break;case"yyyy":e=Ac(yc.FullYear,4,0,!1,!0);break;case"M":case"L":e=Ac(yc.Month,1,1);break;case"MM":case"LL":e=Ac(yc.Month,2,1);break;case"MMM":e=Pc(Cc.Months,rc.Abbreviated);break;case"MMMM":e=Pc(Cc.Months,rc.Wide);break;case"MMMMM":e=Pc(Cc.Months,rc.Narrow);break;case"LLL":e=Pc(Cc.Months,rc.Abbreviated,sc.Standalone);break;case"LLLL":e=Pc(Cc.Months,rc.Wide,sc.Standalone);break;case"LLLLL":e=Pc(Cc.Months,rc.Narrow,sc.Standalone);break;case"w":e=Dc(1);break;case"ww":e=Dc(2);break;case"W":e=Dc(1,!0);break;case"d":e=Ac(yc.Date,1);break;case"dd":e=Ac(yc.Date,2);break;case"E":case"EE":case"EEE":e=Pc(Cc.Days,rc.Abbreviated);break;case"EEEE":e=Pc(Cc.Days,rc.Wide);break;case"EEEEE":e=Pc(Cc.Days,rc.Narrow);break;case"EEEEEE":e=Pc(Cc.Days,rc.Short);break;case"a":case"aa":case"aaa":e=Pc(Cc.DayPeriods,rc.Abbreviated);break;case"aaaa":e=Pc(Cc.DayPeriods,rc.Wide);break;case"aaaaa":e=Pc(Cc.DayPeriods,rc.Narrow);break;case"b":case"bb":case"bbb":e=Pc(Cc.DayPeriods,rc.Abbreviated,sc.Standalone,!0);break;case"bbbb":e=Pc(Cc.DayPeriods,rc.Wide,sc.Standalone,!0);break;case"bbbbb":e=Pc(Cc.DayPeriods,rc.Narrow,sc.Standalone,!0);break;case"B":case"BB":case"BBB":e=Pc(Cc.DayPeriods,rc.Abbreviated,sc.Format,!0);break;case"BBBB":e=Pc(Cc.DayPeriods,rc.Wide,sc.Format,!0);break;case"BBBBB":e=Pc(Cc.DayPeriods,rc.Narrow,sc.Format,!0);break;case"h":e=Ac(yc.Hours,1,-12);break;case"hh":e=Ac(yc.Hours,2,-12);break;case"H":e=Ac(yc.Hours,1);break;case"HH":e=Ac(yc.Hours,2);break;case"m":e=Ac(yc.Minutes,1);break;case"mm":e=Ac(yc.Minutes,2);break;case"s":e=Ac(yc.Seconds,1);break;case"ss":e=Ac(yc.Seconds,2);break;case"S":e=Ac(yc.FractionalSeconds,1);break;case"SS":e=Ac(yc.FractionalSeconds,2);break;case"SSS":e=Ac(yc.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=kc(bc.Short);break;case"ZZZZZ":e=kc(bc.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=kc(bc.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=kc(bc.Long);break;default:return null}return Mc[t]=e,e}(t);l+=e?e(s,i,a):"''"===t?"'":t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}(e,i,s||this.locale,n)}catch(r){throw Hc(t,r.message)}}}return t.\u0275fac=function(e){return new(e||t)(Rr(Wa))},t.\u0275pipe=me({name:"date",type:t,pure:!0}),t})(),zc=(()=>{class t{constructor(t){this._locale=t}transform(e,i,n){if(function(t){return null==t||""===t||t!=t}(e))return null;n=n||this._locale;try{return function(t,e,i){return function(t,e,i,n,s,r,o=!1){let a="",l=!1;if(isFinite(t)){let c=function(t){let e,i,n,s,r,o=Math.abs(t)+"",a=0;for((i=o.indexOf("."))>-1&&(o=o.replace(".","")),(n=o.search(/e/i))>0?(i<0&&(i=n),i+=+o.slice(n+1),o=o.substring(0,n)):i<0&&(i=o.length),n=0;"0"===o.charAt(n);n++);if(n===(r=o.length))e=[0],i=1;else{for(r--;"0"===o.charAt(r);)r--;for(i-=n,e=[],s=0;n<=r;n++,s++)e[s]=Number(o.charAt(n))}return i>22&&(e=e.splice(0,21),a=i-1,i=1),{digits:e,exponent:a,integerLen:i}}(t);o&&(c=function(t){if(0===t.digits[0])return t;const e=t.digits.length-t.integerLen;return t.exponent?t.exponent+=2:(0===e?t.digits.push(0,0):1===e&&t.digits.push(0),t.integerLen+=2),t}(c));let d=e.minInt,u=e.minFrac,h=e.maxFrac;if(r){const t=r.match(xc);if(null===t)throw new Error(r+" is not a valid digit info");const e=t[1],i=t[3],n=t[5];null!=e&&(d=Tc(e)),null!=i&&(u=Tc(i)),null!=n?h=Tc(n):null!=i&&u>h&&(h=u)}!function(t,e,i){if(e>i)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${i}).`);let n=t.digits,s=n.length-t.integerLen;const r=Math.min(Math.max(e,s),i);let o=r+t.integerLen,a=n[o];if(o>0){n.splice(Math.max(t.integerLen,o));for(let t=o;t<n.length;t++)n[t]=0}else{s=Math.max(0,s),t.integerLen=1,n.length=Math.max(1,o=r+1),n[0]=0;for(let t=1;t<o;t++)n[t]=0}if(a>=5)if(o-1<0){for(let e=0;e>o;e--)n.unshift(0),t.integerLen++;n.unshift(1),t.integerLen++}else n[o-1]++;for(;s<Math.max(0,r);s++)n.push(0);let l=0!==r;const c=e+t.integerLen,d=n.reduceRight((function(t,e,i,n){return n[i]=(e+=t)<10?e:e-10,l&&(0===n[i]&&i>=c?n.pop():l=!1),e>=10?1:0}),0);d&&(n.unshift(d),t.integerLen++)}(c,u,h);let p=c.digits,g=c.integerLen;const m=c.exponent;let f=[];for(l=p.every(t=>!t);g<d;g++)p.unshift(0);for(;g<0;g++)p.unshift(0);g>0?f=p.splice(g,p.length):(f=p,p=[0]);const v=[];for(p.length>=e.lgSize&&v.unshift(p.splice(-e.lgSize,p.length).join(""));p.length>e.gSize;)v.unshift(p.splice(-e.gSize,p.length).join(""));p.length&&v.unshift(p.join("")),a=v.join(uc(i,n)),f.length&&(a+=uc(i,s)+f.join("")),m&&(a+=uc(i,ac.Exponential)+"+"+m)}else a=uc(i,ac.Infinity);return a=t<0&&!l?e.negPre+a+e.negSuf:e.posPre+a+e.posSuf,a}(t,function(t,e="-"){const i={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},n=t.split(";"),s=n[0],r=n[1],o=-1!==s.indexOf(".")?s.split("."):[s.substring(0,s.lastIndexOf("0")+1),s.substring(s.lastIndexOf("0")+1)],a=o[0],l=o[1]||"";i.posPre=a.substr(0,a.indexOf("#"));for(let d=0;d<l.length;d++){const t=l.charAt(d);"0"===t?i.minFrac=i.maxFrac=d+1:"#"===t?i.maxFrac=d+1:i.posSuf+=t}const c=a.split(",");if(i.gSize=c[1]?c[1].length:0,i.lgSize=c[2]||c[1]?(c[2]||c[1]).length:0,r){const t=s.length-i.posPre.length-i.posSuf.length,e=r.indexOf("#");i.negPre=r.substr(0,e).replace(/'/g,""),i.negSuf=r.substr(e+t).replace(/'/g,"")}else i.negPre=e+i.posPre,i.negSuf=i.posSuf;return i}(function(t,e){return ko(t)[Mo.NumberFormats][e]}(e,ic.Decimal),uc(e,ac.MinusSign)),e,ac.Group,ac.Decimal,i)}(function(t){if("string"==typeof t&&!isNaN(Number(t)-parseFloat(t)))return Number(t);if("number"!=typeof t)throw new Error(t+" is not a number");return t}(e),n,i)}catch(s){throw Hc(t,s.message)}}}return t.\u0275fac=function(e){return new(e||t)(Rr(Wa))},t.\u0275pipe=me({name:"number",type:t,pure:!0}),t})(),Qc=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[{provide:_c,useClass:Uc}]}),t})(),Wc=(()=>{class t{}return t.\u0275prov=at({token:t,providedIn:"root",factory:()=>new Jc(Kt(Rl),window,Kt(an))}),t})();class Jc{constructor(t,e,i){this.document=t,this.window=e,this.errorHandler=i,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.scrollX,this.window.scrollY]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(this.supportsScrolling()){const e=this.document.getElementById(t)||this.document.getElementsByName(t)[0];e&&this.scrollToElement(e)}}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),i=e.left+this.window.pageXOffset,n=e.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],n-s[1])}supportScrollRestoration(){try{if(!this.window||!this.window.scrollTo)return!1;const t=Yc(this.window.history)||Yc(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window.scrollTo}catch(t){return!1}}}function Yc(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class Zc extends class extends class{}{constructor(){super()}supportsDOMEvents(){return!0}}{static makeCurrent(){var t;t=new Zc,Ll||(Ll=t)}getProperty(t,e){return t[e]}log(t){window.console&&window.console.log&&window.console.log(t)}logGroup(t){window.console&&window.console.group&&window.console.group(t)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(t,e,i){return t.addEventListener(e,i,!1),()=>{t.removeEventListener(e,i,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){return t.parentNode&&t.parentNode.removeChild(t),t}getValue(t){return t.value}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(t){const e=td||(td=document.querySelector("base"),td)?td.getAttribute("href"):null;return null==e?null:(i=e,Xc||(Xc=document.createElement("a")),Xc.setAttribute("href",i),"/"===Xc.pathname.charAt(0)?Xc.pathname:"/"+Xc.pathname);var i}resetBaseElement(){td=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(t){return Oc(document.cookie,t)}}let Xc,td=null;const ed=new Et("TRANSITION_ID"),id=[{provide:$a,useFactory:function(t,e,i){return()=>{i.get(Na).donePromise.then(()=>{const i=Gl();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter(e=>e.getAttribute("ng-transition")===t).forEach(t=>i.remove(t))})}},deps:[ed,Rl,hr],multi:!0}];class nd{static init(){var t;t=new nd,yl=t}addToWindow(t){Mt.getAngularTestability=(e,i=!0)=>{const n=t.findTestabilityInTree(e,i);if(null==n)throw new Error("Could not find testability for element.");return n},Mt.getAllAngularTestabilities=()=>t.getAllTestabilities(),Mt.getAllAngularRootElements=()=>t.getAllRootElements(),Mt.frameworkStabilizers||(Mt.frameworkStabilizers=[]),Mt.frameworkStabilizers.push(t=>{const e=Mt.getAllAngularTestabilities();let i=e.length,n=!1;const s=function(e){n=n||e,i--,0==i&&t(n)};e.forEach((function(t){t.whenStable(s)}))})}findTestabilityInTree(t,e,i){if(null==e)return null;const n=t.getTestability(e);return null!=n?n:i?Gl().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}const sd=new Et("EventManagerPlugins");let rd=(()=>{class t{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,i){return this._findPluginFor(e).addEventListener(t,e,i)}addGlobalEventListener(t,e,i){return this._findPluginFor(e).addGlobalEventListener(t,e,i)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const i=this._plugins;for(let n=0;n<i.length;n++){const e=i[n];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error("No event manager plugin found for event "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(sd),Kt(al))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class od{constructor(t){this._doc=t}addGlobalEventListener(t,e,i){const n=Gl().getGlobalEventTarget(this._doc,t);if(!n)throw new Error(`Unsupported event target ${n} for event ${e}`);return this.addEventListener(n,e,i)}}let ad=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),ld=(()=>{class t extends ad{constructor(t){super(),this._doc=t,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(t.head)}_addStylesToHost(t,e){t.forEach(t=>{const i=this._doc.createElement("style");i.textContent=t,this._styleNodes.add(e.appendChild(i))})}addHost(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}removeHost(t){this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach(e=>this._addStylesToHost(t,e))}ngOnDestroy(){this._styleNodes.forEach(t=>Gl().remove(t))}}return t.\u0275fac=function(e){return new(e||t)(Kt(Rl))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const cd={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},dd=/%COMP%/g;function ud(t,e,i){for(let n=0;n<e.length;n++){let s=e[n];Array.isArray(s)?ud(t,s,i):(s=s.replace(dd,t),i.push(s))}return i}function hd(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let pd=(()=>{class t{constructor(t,e,i){this.eventManager=t,this.sharedStylesHost=e,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new gd(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case se.Emulated:{let i=this.rendererByCompId.get(e.id);return i||(i=new md(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,i)),i.applyToHost(t),i}case se.Native:case se.ShadowDom:return new fd(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=ud(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(Kt(rd),Kt(ld),Kt(Fa))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class gd{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(cd[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,i){t&&t.insertBefore(e,i)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error(`The selector "${t}" did not match any elements`);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,n){if(n){e=n+":"+e;const s=cd[n];s?t.setAttributeNS(s,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){const n=cd[i];n?t.removeAttributeNS(n,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,n){n&Ho.DashCase?t.style.setProperty(e,i,n&Ho.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&Ho.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t[e]=i}setValue(t,e){t.nodeValue=e}listen(t,e,i){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,hd(i)):this.eventManager.addEventListener(t,e,hd(i))}}class md extends gd{constructor(t,e,i,n){super(t),this.component=i;const s=ud(n+"-"+i.id,i.styles,[]);e.addStyles(s),this.contentAttr="_ngcontent-%COMP%".replace(dd,n+"-"+i.id),this.hostAttr="_nghost-%COMP%".replace(dd,n+"-"+i.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}}class fd extends gd{constructor(t,e,i,n){super(t),this.sharedStylesHost=e,this.hostEl=i,this.component=n,this.shadowRoot=n.encapsulation===se.ShadowDom?i.attachShadow({mode:"open"}):i.createShadowRoot(),this.sharedStylesHost.addHost(this.shadowRoot);const s=ud(n.id,n.styles,[]);for(let r=0;r<s.length;r++){const t=document.createElement("style");t.textContent=s[r],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let vd=(()=>{class t extends od{constructor(t){super(t)}supports(t){return!0}addEventListener(t,e,i){return t.addEventListener(e,i,!1),()=>this.removeEventListener(t,e,i)}removeEventListener(t,e,i){return t.removeEventListener(e,i)}}return t.\u0275fac=function(e){return new(e||t)(Kt(Rl))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const bd=["alt","control","meta","shift"],yd={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Cd={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Vd={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let wd=(()=>{class t extends od{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,i,n){const s=t.parseEventName(i),r=t.eventCallback(s.fullKey,n,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Gl().onAndCancel(e,s.domEventName,r))}static parseEventName(e){const i=e.toLowerCase().split("."),n=i.shift();if(0===i.length||"keydown"!==n&&"keyup"!==n)return null;const s=t._normalizeKey(i.pop());let r="";if(bd.forEach(t=>{const e=i.indexOf(t);e>-1&&(i.splice(e,1),r+=t+".")}),r+=s,0!=i.length||0===s.length)return null;const o={};return o.domEventName=n,o.fullKey=r,o}static getEventFullKey(t){let e="",i=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&Cd.hasOwnProperty(e)&&(e=Cd[e]))}return yd[e]||e}(t);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),bd.forEach(n=>{n!=i&&(0,Vd[n])(t)&&(e+=n+".")}),e+=i,e}static eventCallback(e,i,n){return s=>{t.getEventFullKey(s)===e&&n.runGuarded(()=>i(s))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return t.\u0275fac=function(e){return new(e||t)(Kt(Rl))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Ad=wl(Ul,"browser",[{provide:qa,useValue:"browser"},{provide:Ka,useValue:function(){Zc.makeCurrent(),nd.init()},multi:!0},{provide:Rl,useFactory:function(){return function(t){Ge=t}(document),document},deps:[]}]),Pd=[[],{provide:Zs,useValue:"root"},{provide:an,useFactory:function(){return new an},deps:[]},{provide:sd,useClass:vd,multi:!0,deps:[Rl,al,qa]},{provide:sd,useClass:wd,multi:!0,deps:[Rl]},[],{provide:pd,useClass:pd,deps:[rd,ld,Fa]},{provide:Bo,useExisting:pd},{provide:ad,useExisting:ld},{provide:ld,useClass:ld,deps:[Rl]},{provide:ml,useClass:ml,deps:[al]},{provide:rd,useClass:rd,deps:[sd,al]},[]];let kd=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:Fa,useValue:e.appId},{provide:ed,useExisting:Fa},id]}}}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)(Kt(t,12))},providers:Pd,imports:[Qc,El]}),t})();function Dd(){return new Md(Kt(Rl))}let Md=(()=>{class t{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return t.\u0275fac=function(e){return new(e||t)(Kt(Rl))},t.\u0275prov=at({factory:Dd,token:t,providedIn:"root"}),t})();function Id(...t){if(1===t.length){const e=t[0];if(l(e))return Sd(e,null);if(c(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return Sd(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return Sd(t=1===t.length&&l(t[0])?t[0]:t,null).pipe(D(t=>e(...t)))}return Sd(t,null)}function Sd(t,e){return new b(i=>{const n=t.length;if(0===n)return void i.complete();const s=new Array(n);let r=0,o=0;for(let a=0;a<n;a++){const l=L(t[a]);let c=!1;i.add(l.subscribe({next:t=>{c||(c=!0,o++),s[a]=t},error:t=>i.error(t),complete:()=>{r++,r!==n&&c||(o===n&&i.next(e?e.reduce((t,e,i)=>(t[e]=s[i],t),{}):s),i.complete())}}))}})}"undefined"!=typeof window&&window;const xd=new Et("NgValueAccessor"),Td={provide:xd,useExisting:Ct(()=>_d),multi:!0};let _d=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"checked",t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Ko),Rr(No))},t.\u0275dir=ge({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,e){1&t&&Jr("change",(function(t){return e.onChange(t.target.checked)}))("blur",(function(){return e.onTouched()}))},features:[Go([Td])]}),t})();const Ud={provide:xd,useExisting:Ct(()=>Ed),multi:!0},Od=new Et("CompositionEventMode");let Ed=(()=>{class t{constructor(t,e,i){this._renderer=t,this._elementRef=e,this._compositionMode=i,this.onChange=t=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const t=Gl()?Gl().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Ko),Rr(No),Rr(Od,8))},t.\u0275dir=ge({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,e){1&t&&Jr("input",(function(t){return e._handleInput(t.target.value)}))("blur",(function(){return e.onTouched()}))("compositionstart",(function(){return e._compositionStart()}))("compositionend",(function(t){return e._compositionEnd(t.target.value)}))},features:[Go([Ud])]}),t})(),Ld=(()=>{class t{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=ge({type:t}),t})(),Gd=(()=>{class t extends Ld{get formDirective(){return null}get path(){return null}}return t.\u0275fac=function(e){return Rd(e||t)},t.\u0275dir=ge({type:t,features:[fr]}),t})();const Rd=nn(Gd);class jd extends Ld{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null,this._rawValidators=[],this._rawAsyncValidators=[]}get validator(){}get asyncValidator(){}}class $d{constructor(t){this._cd=t}get ngClassUntouched(){return!!this._cd.control&&this._cd.control.untouched}get ngClassTouched(){return!!this._cd.control&&this._cd.control.touched}get ngClassPristine(){return!!this._cd.control&&this._cd.control.pristine}get ngClassDirty(){return!!this._cd.control&&this._cd.control.dirty}get ngClassValid(){return!!this._cd.control&&this._cd.control.valid}get ngClassInvalid(){return!!this._cd.control&&this._cd.control.invalid}get ngClassPending(){return!!this._cd.control&&this._cd.control.pending}}let Nd=(()=>{class t extends $d{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jd,2))},t.\u0275dir=ge({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,e){2&t&&lo("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[fr]}),t})(),Fd=(()=>{class t extends $d{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Gd,2))},t.\u0275dir=ge({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(t,e){2&t&&lo("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[fr]}),t})();function Bd(t){return null==t||0===t.length}function Hd(t){return null!=t&&"number"==typeof t.length}const Kd=new Et("NgValidators"),qd=new Et("NgAsyncValidators"),zd=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Qd{static min(t){return e=>{if(Bd(e.value)||Bd(t))return null;const i=parseFloat(e.value);return!isNaN(i)&&i<t?{min:{min:t,actual:e.value}}:null}}static max(t){return e=>{if(Bd(e.value)||Bd(t))return null;const i=parseFloat(e.value);return!isNaN(i)&&i>t?{max:{max:t,actual:e.value}}:null}}static required(t){return Bd(t.value)?{required:!0}:null}static requiredTrue(t){return!0===t.value?null:{required:!0}}static email(t){return Bd(t.value)||zd.test(t.value)?null:{email:!0}}static minLength(t){return e=>Bd(e.value)||!Hd(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}static maxLength(t){return e=>Hd(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}static pattern(t){if(!t)return Qd.nullValidator;let e,i;return"string"==typeof t?(i="","^"!==t.charAt(0)&&(i+="^"),i+=t,"$"!==t.charAt(t.length-1)&&(i+="$"),e=new RegExp(i)):(i=t.toString(),e=t),t=>{if(Bd(t.value))return null;const n=t.value;return e.test(n)?null:{pattern:{requiredPattern:i,actualValue:n}}}}static nullValidator(t){return null}static compose(t){if(!t)return null;const e=t.filter(Wd);return 0==e.length?null:function(t){return Yd(Zd(t,e))}}static composeAsync(t){if(!t)return null;const e=t.filter(Wd);return 0==e.length?null:function(t){return Id(Zd(t,e).map(Jd)).pipe(D(Yd))}}}function Wd(t){return null!=t}function Jd(t){const e=Qr(t)?L(t):t;return Wr(e),e}function Yd(t){let e={};return t.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function Zd(t,e){return e.map(e=>e(t))}function Xd(t){return t.map(t=>function(t){return!t.validate}(t)?t:e=>t.validate(e))}const tu={provide:xd,useExisting:Ct(()=>eu),multi:!0};let eu=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Ko),Rr(No))},t.\u0275dir=ge({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,e){1&t&&Jr("input",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},features:[Go([tu])]}),t})();const iu={provide:xd,useExisting:Ct(()=>su),multi:!0};let nu=(()=>{class t{constructor(){this._accessors=[]}add(t,e){this._accessors.push([t,e])}remove(t){for(let e=this._accessors.length-1;e>=0;--e)if(this._accessors[e][1]===t)return void this._accessors.splice(e,1)}select(t){this._accessors.forEach(e=>{this._isSameGroup(e,t)&&e[1]!==t&&e[1].fireUncheck(t.value)})}_isSameGroup(t,e){return!!t[0].control&&t[0]._parent===e._control._parent&&t[1].name===e.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),su=(()=>{class t{constructor(t,e,i,n){this._renderer=t,this._elementRef=e,this._registry=i,this._injector=n,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this._control=this._injector.get(jd),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}fireUncheck(t){this.writeValue(t)}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Ko),Rr(No),Rr(nu),Rr(hr))},t.\u0275dir=ge({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(t,e){1&t&&Jr("change",(function(){return e.onChange()}))("blur",(function(){return e.onTouched()}))},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Go([iu])]}),t})();const ru={provide:xd,useExisting:Ct(()=>ou),multi:!0};let ou=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(t))}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Ko),Rr(No))},t.\u0275dir=ge({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,e){1&t&&Jr("change",(function(t){return e.onChange(t.target.value)}))("input",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},features:[Go([ru])]}),t})();const au={provide:xd,useExisting:Ct(()=>cu),multi:!0};function lu(t,e){return null==t?""+e:(e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}let cu=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const e=this._getOptionId(t);null==e&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const i=lu(e,t);this._renderer.setProperty(this._elementRef.nativeElement,"value",i)}registerOnChange(t){this.onChange=e=>{this.value=this._getOptionValue(e),t(this.value)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e),t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e):t}}return t.\u0275fac=function(e){return new(e||t)(Rr(Ko),Rr(No))},t.\u0275dir=ge({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,e){1&t&&Jr("change",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},inputs:{compareWith:"compareWith"},features:[Go([au])]}),t})(),du=(()=>{class t{constructor(t,e,i){this._element=t,this._renderer=e,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(lu(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(Rr(No),Rr(Ko),Rr(cu,9))},t.\u0275dir=ge({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const uu={provide:xd,useExisting:Ct(()=>pu),multi:!0};function hu(t,e){return null==t?""+e:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}let pu=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let e;if(this.value=t,Array.isArray(t)){const i=t.map(t=>this._getOptionId(t));e=(t,e)=>{t._setSelected(i.indexOf(e.toString())>-1)}}else e=(t,e)=>{t._setSelected(!1)};this._optionMap.forEach(e)}registerOnChange(t){this.onChange=e=>{const i=[];if(void 0!==e.selectedOptions){const t=e.selectedOptions;for(let e=0;e<t.length;e++){const n=t.item(e),s=this._getOptionValue(n.value);i.push(s)}}else{const t=e.options;for(let e=0;e<t.length;e++){const n=t.item(e);if(n.selected){const t=this._getOptionValue(n.value);i.push(t)}}}this.value=i,t(i)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(t){const e=(this._idCounter++).toString();return this._optionMap.set(e,t),e}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e)._value,t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e)._value:t}}return t.\u0275fac=function(e){return new(e||t)(Rr(Ko),Rr(No))},t.\u0275dir=ge({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,e){1&t&&Jr("change",(function(t){return e.onChange(t.target)}))("blur",(function(){return e.onTouched()}))},inputs:{compareWith:"compareWith"},features:[Go([uu])]}),t})(),gu=(()=>{class t{constructor(t,e,i){this._element=t,this._renderer=e,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(hu(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(hu(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(Rr(No),Rr(Ko),Rr(pu,9))},t.\u0275dir=ge({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();function mu(t,e){t.validator=Qd.compose([t.validator,e.validator]),t.asyncValidator=Qd.composeAsync([t.asyncValidator,e.asyncValidator]),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(i=>{t._pendingValue=i,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&fu(t,e)})}(t,e),function(t,e){t.registerOnChange((t,i)=>{e.valueAccessor.writeValue(t),i&&e.viewToModelUpdate(t)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&fu(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),e.valueAccessor.setDisabledState&&t.registerOnDisabledChange(t=>{e.valueAccessor.setDisabledState(t)}),e._rawValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())}),e._rawAsyncValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())})}function fu(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function vu(t){return null!=t?Qd.compose(Xd(t)):null}function bu(t){return null!=t?Qd.composeAsync(Xd(t)):null}const yu=[_d,ou,eu,cu,pu,su];function Cu(t){return(Pu(t)?t.validators:t)||null}function Vu(t){return Array.isArray(t)?vu(t):t||null}function wu(t,e){return(Pu(e)?e.asyncValidators:t)||null}function Au(t){return Array.isArray(t)?bu(t):t||null}function Pu(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class ku{constructor(t,e){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=Vu(this._rawValidators),this._composedAsyncValidatorFn=Au(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return"VALID"===this.status}get invalid(){return"INVALID"===this.status}get pending(){return"PENDING"==this.status}get disabled(){return"DISABLED"===this.status}get enabled(){return"DISABLED"!==this.status}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=Vu(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=Au(t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status="PENDING",!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild(e=>{e.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status="VALID",this._forEachChild(e=>{e.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status="PENDING",this._hasOwnPendingAsyncValidator=!0;const e=Jd(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(e=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(e,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(t,e,i){if(null==e)return null;if(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length)return null;let n=t;return e.forEach(t=>{n=n instanceof Mu?n.controls.hasOwnProperty(t)?n.controls[t]:null:n instanceof Iu&&n.at(t)||null}),n}(this,t)}getError(t,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Ra,this.statusChanges=new Ra}_calculateStatus(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Pu(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}}class Du extends ku{constructor(t=null,e,i){super(Cu(e),wu(i,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),this._initObservables()}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(t=>t(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_clearChangeFns(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=()=>{}}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class Mu extends ku{constructor(t,e,i){super(Cu(e),wu(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e){this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity(),this._onCollectionChange()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(i=>{this._throwIfControlMissing(i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){Object.keys(t).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t={},e={}){this._forEachChild((i,n)=>{i.reset(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,i)=>(t[i]=e instanceof Du?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(t,e)=>!!e._syncPendingControls()||t);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>t(this.controls[e],e))}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const i=this.controls[e];if(this.contains(e)&&t(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,i)=>((e.enabled||this.disabled)&&(t[i]=e.value),t))}_reduceChildren(t,e){let i=t;return this._forEachChild((t,n)=>{i=e(i,t,n)}),i}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,i)=>{if(void 0===t[i])throw new Error(`Must supply a value for form control with name: '${i}'.`)})}}class Iu extends ku{constructor(t,e,i){super(Cu(e),wu(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}at(t){return this.controls[t]}push(t){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()}insert(t,e){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity()}removeAt(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((t,i)=>{this._throwIfControlMissing(i),this.at(i).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t.forEach((t,i)=>{this.at(i)&&this.at(i).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t=[],e={}){this._forEachChild((i,n)=>{i.reset(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t instanceof Du?t.value:t.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let t=this.controls.reduce((t,e)=>!!e._syncPendingControls()||t,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error("Cannot find form control at index "+t)}_forEachChild(t){this.controls.forEach((e,i)=>{t(e,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,i)=>{if(void 0===t[i])throw new Error(`Must supply a value for form control at index: ${i}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const Su={provide:Gd,useExisting:Ct(()=>Tu)},xu=(()=>Promise.resolve(null))();let Tu=(()=>{class t extends Gd{constructor(t,e){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new Ra,this.form=new Mu({},vu(t),bu(e))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){xu.then(()=>{const e=this._findContainer(t.path);t.control=e.registerControl(t.name,t.control),mu(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){xu.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name),function(t,e){const i=t.indexOf(e);i>-1&&t.splice(i,1)}(this._directives,t)})}addFormGroup(t){xu.then(()=>{const e=this._findContainer(t.path),i=new Mu({});(function(t,e){t.validator=Qd.compose([t.validator,e.validator]),t.asyncValidator=Qd.composeAsync([t.asyncValidator,e.asyncValidator])})(i,t),e.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){xu.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,e){xu.then(()=>{this.form.get(t.path).setValue(e)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,e=this._directives,this.form._syncPendingControls(),e.forEach(t=>{const e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)}),this.ngSubmit.emit(t),!1;var e}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return t.\u0275fac=function(e){return new(e||t)(Rr(Kd,10),Rr(qd,10))},t.\u0275dir=ge({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,e){1&t&&Jr("submit",(function(t){return e.onSubmit(t)}))("reset",(function(){return e.onReset()}))},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Go([Su]),fr]}),t})();const _u={provide:jd,useExisting:Ct(()=>Ou)},Uu=(()=>Promise.resolve(null))();let Ou=(()=>{class t extends jd{constructor(t,e,i,n){super(),this.control=new Du,this._registered=!1,this.update=new Ra,this._parent=t,this._rawValidators=e||[],this._rawAsyncValidators=i||[],this.valueAccessor=function(t,e){if(!e)return null;Array.isArray(e);let i=void 0,n=void 0,s=void 0;return e.forEach(t=>{var e;t.constructor===Ed?i=t:(e=t,yu.some(t=>e.constructor===t)?n=t:s=t)}),s||n||i||null}(0,n)}ngOnChanges(t){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in t&&this._updateDisabled(t),function(t,e){if(!t.hasOwnProperty("model"))return!1;const i=t.model;return!!i.isFirstChange()||!Object.is(e,i.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?function(t,e){return[...e.path,t]}(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return vu(this._rawValidators)}get asyncValidator(){return bu(this._rawAsyncValidators)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){mu(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){Uu.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1})})}_updateDisabled(t){const e=t.isDisabled.currentValue,i=""===e||e&&"false"!==e;Uu.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable()})}}return t.\u0275fac=function(e){return new(e||t)(Rr(Gd,9),Rr(Kd,10),Rr(qd,10),Rr(xd,10))},t.\u0275dir=ge({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Go([_u]),fr,_e]}),t})(),Eu=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=ge({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const Lu={provide:Kd,useExisting:Ct(()=>Ru),multi:!0},Gu={provide:Kd,useExisting:Ct(()=>ju),multi:!0};let Ru=(()=>{class t{constructor(){this._required=!1}get required(){return this._required}set required(t){this._required=null!=t&&!1!==t&&""+t!="false",this._onChange&&this._onChange()}validate(t){return this.required?Qd.required(t):null}registerOnValidatorChange(t){this._onChange=t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=ge({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(t,e){2&t&&_r("required",e.required?"":null)},inputs:{required:"required"},features:[Go([Lu])]}),t})(),ju=(()=>{class t extends Ru{validate(t){return this.required?Qd.requiredTrue(t):null}}return t.\u0275fac=function(e){return $u(e||t)},t.\u0275dir=ge({type:t,selectors:[["input","type","checkbox","required","","formControlName",""],["input","type","checkbox","required","","formControl",""],["input","type","checkbox","required","","ngModel",""]],hostVars:1,hostBindings:function(t,e){2&t&&_r("required",e.required?"":null)},features:[Go([Gu]),fr]}),t})();const $u=nn(ju),Nu={provide:Kd,useExisting:Ct(()=>Fu),multi:!0};let Fu=(()=>{class t{constructor(){this._validator=Qd.nullValidator}ngOnChanges(t){"minlength"in t&&(this._createValidator(),this._onChange&&this._onChange())}validate(t){return null==this.minlength?null:this._validator(t)}registerOnValidatorChange(t){this._onChange=t}_createValidator(){this._validator=Qd.minLength("number"==typeof this.minlength?this.minlength:parseInt(this.minlength,10))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=ge({type:t,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(t,e){2&t&&_r("minlength",e.minlength?e.minlength:null)},inputs:{minlength:"minlength"},features:[Go([Nu]),_e]}),t})();const Bu={provide:Kd,useExisting:Ct(()=>Hu),multi:!0};let Hu=(()=>{class t{constructor(){this._validator=Qd.nullValidator}ngOnChanges(t){"pattern"in t&&(this._createValidator(),this._onChange&&this._onChange())}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}_createValidator(){this._validator=Qd.pattern(this.pattern)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=ge({type:t,selectors:[["","pattern","","formControlName",""],["","pattern","","formControl",""],["","pattern","","ngModel",""]],hostVars:1,hostBindings:function(t,e){2&t&&_r("pattern",e.pattern?e.pattern:null)},inputs:{pattern:"pattern"},features:[Go([Bu]),_e]}),t})(),Ku=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)}}),t})(),qu=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[nu],imports:[Ku]}),t})();function zu(...t){let e=t[t.length-1];return k(e)?(t.pop(),E(t,e)):H(t)}function Qu(t,e){return $(t,e,1)}function Wu(t,e){return function(i){return i.lift(new Ju(t,e))}}class Ju{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new Yu(t,this.predicate,this.thisArg))}}class Yu extends g{constructor(t,e,i){super(t),this.predicate=e,this.thisArg=i,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(i){return void this.destination.error(i)}e&&this.destination.next(t)}}class Zu{}class Xu{}class th{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(t=>{const e=t.indexOf(":");if(e>0){const i=t.slice(0,e),n=i.toLowerCase(),s=t.slice(e+1).trim();this.maybeSetNormalizedName(i,n),this.headers.has(n)?this.headers.get(n).push(s):this.headers.set(n,[s])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let i=t[e];const n=e.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(n,i),this.maybeSetNormalizedName(e,n))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof th?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new th;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof th?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(t.name,e);const n=("a"===t.op?this.headers.get(e):void 0)||[];n.push(...i),this.headers.set(e,n);break;case"d":const s=t.value;if(s){let t=this.headers.get(e);if(!t)return;t=t.filter(t=>-1===s.indexOf(t)),0===t.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,t)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class eh{encodeKey(t){return ih(t)}encodeValue(t){return ih(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}function ih(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class nh{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new eh,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){const i=new Map;return t.length>0&&t.split("&").forEach(t=>{const n=t.indexOf("="),[s,r]=-1==n?[e.decodeKey(t),""]:[e.decodeKey(t.slice(0,n)),e.decodeValue(t.slice(n+1))],o=i.get(s)||[];o.push(r),i.set(s,o)}),i}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const i=t.fromObject[e];this.map.set(e,Array.isArray(i)?i:[i])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(t=>e+"="+this.encoder.encodeValue(t)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new nh({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat([t]),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(t.value),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let e=this.map.get(t.param)||[];const i=e.indexOf(t.value);-1!==i&&e.splice(i,1),e.length>0?this.map.set(t.param,e):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}function sh(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function rh(t){return"undefined"!=typeof Blob&&t instanceof Blob}function oh(t){return"undefined"!=typeof FormData&&t instanceof FormData}class ah{constructor(t,e,i,n){let s;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||n?(this.body=void 0!==i?i:null,s=n):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.params&&(this.params=s.params)),this.headers||(this.headers=new th),this.params){const t=this.params.toString();if(0===t.length)this.urlWithParams=e;else{const i=e.indexOf("?");this.urlWithParams=e+(-1===i?"?":i<e.length-1?"&":"")+t}}else this.params=new nh,this.urlWithParams=e}serializeBody(){return null===this.body?null:sh(this.body)||rh(this.body)||oh(this.body)||"string"==typeof this.body?this.body:this.body instanceof nh?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||oh(this.body)?null:rh(this.body)?this.body.type||null:sh(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof nh?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}clone(t={}){const e=t.method||this.method,i=t.url||this.url,n=t.responseType||this.responseType,s=void 0!==t.body?t.body:this.body,r=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,o=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let a=t.headers||this.headers,l=t.params||this.params;return void 0!==t.setHeaders&&(a=Object.keys(t.setHeaders).reduce((e,i)=>e.set(i,t.setHeaders[i]),a)),t.setParams&&(l=Object.keys(t.setParams).reduce((e,i)=>e.set(i,t.setParams[i]),l)),new ah(e,i,s,{params:l,headers:a,reportProgress:o,responseType:n,withCredentials:r})}}var lh=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}({});class ch{constructor(t,e=200,i="OK"){this.headers=t.headers||new th,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||i,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class dh extends ch{constructor(t={}){super(t),this.type=lh.ResponseHeader}clone(t={}){return new dh({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class uh extends ch{constructor(t={}){super(t),this.type=lh.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new uh({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class hh extends ch{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?"Http failure during parsing for "+(t.url||"(unknown url)"):`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function ph(t,e){return{body:e,headers:t.headers,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let gh=(()=>{class t{constructor(t){this.handler=t}request(t,e,i={}){let n;if(t instanceof ah)n=t;else{let s=void 0;s=i.headers instanceof th?i.headers:new th(i.headers);let r=void 0;i.params&&(r=i.params instanceof nh?i.params:new nh({fromObject:i.params})),n=new ah(t,e,void 0!==i.body?i.body:null,{headers:s,params:r,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const s=zu(n).pipe(Qu(t=>this.handler.handle(t)));if(t instanceof ah||"events"===i.observe)return s;const r=s.pipe(Wu(t=>t instanceof uh));switch(i.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return r.pipe(D(t=>{if(null!==t.body&&!(t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return t.body}));case"blob":return r.pipe(D(t=>{if(null!==t.body&&!(t.body instanceof Blob))throw new Error("Response is not a Blob.");return t.body}));case"text":return r.pipe(D(t=>{if(null!==t.body&&"string"!=typeof t.body)throw new Error("Response is not a string.");return t.body}));case"json":default:return r.pipe(D(t=>t.body))}case"response":return r;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(t,e={}){return this.request("DELETE",t,e)}get(t,e={}){return this.request("GET",t,e)}head(t,e={}){return this.request("HEAD",t,e)}jsonp(t,e){return this.request("JSONP",t,{params:(new nh).append(e,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,e={}){return this.request("OPTIONS",t,e)}patch(t,e,i={}){return this.request("PATCH",t,ph(i,e))}post(t,e,i={}){return this.request("POST",t,ph(i,e))}put(t,e,i={}){return this.request("PUT",t,ph(i,e))}}return t.\u0275fac=function(e){return new(e||t)(Kt(Zu))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class mh{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const fh=new Et("HTTP_INTERCEPTORS");let vh=(()=>{class t{intercept(t,e){return e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const bh=/^\)\]\}',?\n/;class yh{}let Ch=(()=>{class t{constructor(){}build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Vh=(()=>{class t{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new b(e=>{const i=this.xhrFactory.build();if(i.open(t.method,t.urlWithParams),t.withCredentials&&(i.withCredentials=!0),t.headers.forEach((t,e)=>i.setRequestHeader(t,e.join(","))),t.headers.has("Accept")||i.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const e=t.detectContentTypeHeader();null!==e&&i.setRequestHeader("Content-Type",e)}if(t.responseType){const e=t.responseType.toLowerCase();i.responseType="json"!==e?e:"text"}const n=t.serializeBody();let s=null;const r=()=>{if(null!==s)return s;const e=1223===i.status?204:i.status,n=i.statusText||"OK",r=new th(i.getAllResponseHeaders()),o=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(i)||t.url;return s=new dh({headers:r,status:e,statusText:n,url:o}),s},o=()=>{let{headers:n,status:s,statusText:o,url:a}=r(),l=null;204!==s&&(l=void 0===i.response?i.responseText:i.response),0===s&&(s=l?200:0);let c=s>=200&&s<300;if("json"===t.responseType&&"string"==typeof l){const t=l;l=l.replace(bh,"");try{l=""!==l?JSON.parse(l):null}catch(d){l=t,c&&(c=!1,l={error:d,text:l})}}c?(e.next(new uh({body:l,headers:n,status:s,statusText:o,url:a||void 0})),e.complete()):e.error(new hh({error:l,headers:n,status:s,statusText:o,url:a||void 0}))},a=t=>{const{url:n}=r(),s=new hh({error:t,status:i.status||0,statusText:i.statusText||"Unknown Error",url:n||void 0});e.error(s)};let l=!1;const c=n=>{l||(e.next(r()),l=!0);let s={type:lh.DownloadProgress,loaded:n.loaded};n.lengthComputable&&(s.total=n.total),"text"===t.responseType&&i.responseText&&(s.partialText=i.responseText),e.next(s)},d=t=>{let i={type:lh.UploadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),e.next(i)};return i.addEventListener("load",o),i.addEventListener("error",a),t.reportProgress&&(i.addEventListener("progress",c),null!==n&&i.upload&&i.upload.addEventListener("progress",d)),i.send(n),e.next({type:lh.Sent}),()=>{i.removeEventListener("error",a),i.removeEventListener("load",o),t.reportProgress&&(i.removeEventListener("progress",c),null!==n&&i.upload&&i.upload.removeEventListener("progress",d)),i.readyState!==i.DONE&&i.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(Kt(yh))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const wh=new Et("XSRF_COOKIE_NAME"),Ah=new Et("XSRF_HEADER_NAME");class Ph{}let kh=(()=>{class t{constructor(t,e,i){this.doc=t,this.platform=e,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Oc(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(Kt(Rl),Kt(qa),Kt(wh))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Dh=(()=>{class t{constructor(t,e){this.tokenService=t,this.headerName=e}intercept(t,e){const i=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||i.startsWith("http://")||i.startsWith("https://"))return e.handle(t);const n=this.tokenService.getToken();return null===n||t.headers.has(this.headerName)||(t=t.clone({headers:t.headers.set(this.headerName,n)})),e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(Ph),Kt(Ah))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Mh=(()=>{class t{constructor(t,e){this.backend=t,this.injector=e,this.chain=null}handle(t){if(null===this.chain){const t=this.injector.get(fh,[]);this.chain=t.reduceRight((t,e)=>new mh(t,e),this.backend)}return this.chain.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(Xu),Kt(hr))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Ih=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:Dh,useClass:vh}]}}static withOptions(e={}){return{ngModule:t,providers:[e.cookieName?{provide:wh,useValue:e.cookieName}:[],e.headerName?{provide:Ah,useValue:e.headerName}:[]]}}}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[Dh,{provide:fh,useExisting:Dh,multi:!0},{provide:Ph,useClass:kh},{provide:wh,useValue:"XSRF-TOKEN"},{provide:Ah,useValue:"X-XSRF-TOKEN"}]}),t})(),Sh=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[gh,{provide:Zu,useClass:Mh},Vh,{provide:Xu,useExisting:Vh},Ch,{provide:yh,useExisting:Ch}],imports:[[Ih.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})();function xh(t,e){let i=0;return i=(t=t||"").localeCompare(e=e||""),i}function Th(t,e){let i=0;return void 0===t&&(t=new Date(-864e13)),void 0===e&&(e=new Date(-864e13)),t<e?i=-1:t>e&&(i=1),i}function _h(t,e,i="en"){return t.toLocaleDateString(i,"longDate"==e?{year:"numeric",month:"2-digit",day:"2-digit"}:"fullDate"==e?{year:"2-digit",month:"2-digit",day:"2-digit"}:"shortDate"==e?{year:"numeric",month:"short"}:"fullMonthYear"==e?{year:"numeric",month:"long"}:{year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function Uh(t,e){if(!e&&!t)return;const i=t?new Date(t):new Date;return i?i.toISOString():void 0}function Oh(t){const e=new Date;return e.setHours(0,0,0,0),!!(t&&t.getTime()>=e.getTime())}function Eh(t,e){if(!t||!e)return!1;const i=new Date(t),n=new Date(e);return i.setHours(0,0,0,0),n.setHours(0,0,0,0),i.toISOString()===n.toISOString()}function Lh(t,e,i){return t?t.length<e?t:e<3?"...":i?"...".concat(t.substr(t.length-e)):t.substring(0,e-3).concat("..."):""}function Gh(t){let e="Unknown Error";return t&&(0===t.status?(e="Server not reachable with ",e=e.concat(t.url||""),console.log(`Rest Server not reachable: ${t.status} ${t.statusText}, Message ${t.message}`)):(console.log(`Rest Error Status: ${t.status} ${t.statusText}, Message ${t.message}, Name: ${t.error.name||""}`),t.error&&t.error.message?e=t.error.message:t.message?e=t.message:t.statusText&&(e=t.statusText))),e}function Rh(){return"1"===localStorage.getItem("printPreView")}let jh=(()=>{class t{constructor(){this.messages=[],this.activateMessages=void 0,this.activateMessageToggle=new Ra(!0)}initstatus(){void 0===this.activateMessages&&(this.activateMessages="On"===localStorage.getItem("activateMessages"))}toggle(){return this.initstatus(),this.activateMessages=!this.activateMessages,localStorage.setItem("activateMessages",this.activateMessages?"On":"Off"),this.activateMessageToggle.emit(this.activateMessages),console.log("Messages Toggle to %s",this.activateMessages),this.activateMessages}getstatus(){return this.initstatus(),this.activateMessages}add(t){this.messages.push(t),this.messages.length>20&&this.messages.shift()}clear(){this.messages=[]}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function $h(t,e){return new b(e?i=>e.schedule(Nh,0,{error:t,subscriber:i}):e=>e.error(t))}function Nh({error:t,subscriber:e}){e.error(t)}function Fh(t){return function(e){const i=new Bh(t),n=e.lift(i);return i.caught=n}}class Bh{constructor(t){this.selector=t}call(t,e){return e.subscribe(new Hh(t,this.selector,this.caught))}}class Hh extends R{constructor(t,e,i){super(t),this.selector=e,this.caught=i}error(t){if(!this.isStopped){let i;try{i=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const n=new G(this);this.add(n);const s=j(i,n);s!==n&&this.add(s)}}}function Kh(){}function qh(t,e,i){return function(n){return n.lift(new zh(t,e,i))}}class zh{constructor(t,e,i){this.nextOrObserver=t,this.error=e,this.complete=i}call(t,e){return e.subscribe(new Qh(t,this.nextOrObserver,this.error,this.complete))}}class Qh extends g{constructor(t,e,i,s){super(t),this._tapNext=Kh,this._tapError=Kh,this._tapComplete=Kh,this._tapError=i||Kh,this._tapComplete=s||Kh,n(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||Kh,this._tapError=e.error||Kh,this._tapComplete=e.complete||Kh)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}class Wh{}class Jh{}class Yh{}class Zh{}class Xh{}function tp(t){this.message=t}(tp.prototype=new Error).name="InvalidCharacterError";var ep="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new tp("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,n,s=0,r=0,o="";n=e.charAt(r++);~n&&(i=s%4?64*i+n:n,s++%4)?o+=String.fromCharCode(255&i>>(-2*s&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return o};function ip(t){this.message=t}(ip.prototype=new Error).name="InvalidTokenError";var np=function(t,e){if("string"!=typeof t)throw new ip("Invalid token specified");var i=!0===(e=e||{}).header?0:1;try{return JSON.parse(function(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(t){return decodeURIComponent(ep(t).replace(/(.)/g,(function(t,e){var i=e.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i})))}(e)}catch(t){return ep(e)}}(t.split(".")[i]))}catch(t){throw new ip("Invalid token specified: "+t.message)}};class sp{constructor(){this.restUrl="https://dev.visbo.net/api"}}const rp={headers:new th({"Content-Type":"application/json"})};let op=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.isLoggedIn=!1,this.authUrl=this.env.restUrl.concat("/token/user")}logoutCheck(){if(this.isLoggedIn)return this.logoutTime}login(t,e){const i=this.authUrl+"/login";this.log(`Calling HTTP Request: ${i} for: ${t}`);const n=new Wh;return n.email=t,n.password=e,this.http.post(i,n).pipe(D(t=>{if(t&&t.token){this.log("Login Request Successful:  "+t.user.email),localStorage.setItem("currentUser",JSON.stringify(t.user)),localStorage.setItem("currentToken",JSON.stringify(t.token)),this.isLoggedIn=!0;const e=np(t.token);return e&&e.exp&&(this.logoutTime=new Date(1e3*e.exp)),this.log("Login Request logoutTime:  "+this.logoutTime),t.user}return null}),Fh(this.handleError("LoginError")))}loginGoogleUrl(){return this.authUrl+"/logingoogle"}loginGoogle(){const t=this.authUrl+"/logingoogle";return this.log("Calling HTTP Request: "+t),this.http.post(t,{}).pipe(D(t=>{if(console.log("google Login :  "+JSON.stringify(t)),t&&t.token){this.log("Login Request Successful:  "+t.user.email),localStorage.setItem("currentUser",JSON.stringify(t.user)),localStorage.setItem("currentToken",JSON.stringify(t.token)),this.isLoggedIn=!0;const e=np(t.token);return e&&e.exp&&(this.logoutTime=new Date(1e3*e.exp)),this.log("Login Request logoutTime:  "+this.logoutTime),t.user}return null}),Fh(this.handleError("LoginError")))}oauthconfirm(t){localStorage.setItem("currentUser",JSON.stringify({profile:{company:"Privat",firstName:"Markus (G)",lastName:"Seyfried"},status:{registeredAt:"2020-11-10T16:20:32.620Z",lastLoginAt:"2020-11-10T18:10:31.694Z",loginRetries:0},_id:"5b60762decb6077f42ba27d2",email:"markus.seyfried@gmail.com",createdAt:"2018-07-31T14:46:05.138Z",updatedAt:"2020-11-10T18:22:39.469Z",__v:3,userAgents:[]})),localStorage.setItem("currentToken",JSON.stringify(t))}logout(){this.isLoggedIn=!1,localStorage.clear()}getActiveUser(){return JSON.parse(localStorage.getItem("currentUser"))}pwforgotten(t){const e=this.authUrl+"/pwforgotten",i=new Xh;return i.email=t.email,this.log(`Calling HTTP Request: ${e} for: ${i.email} `),this.http.post(e,i).pipe(D(t=>(this.log("PW Forgotten Request executed"),t&&this.log("PW Forgotten Request Successful:  "+JSON.stringify(t)),t)),Fh(this.handleError("pwforgotten")))}pwreset(t,e){const i=this.authUrl+"/pwreset",n={token:e,password:t.password};return this.log(`Calling HTTP Request: ${i} with: ${e} `),this.http.post(i,n).pipe(D(t=>(this.log("PW Reset Request executed"),this.log(t?"PW Reset Request Successful:  "+JSON.stringify(t):"PW Reset Request Unsuccessful:  "+JSON.stringify(t)),t)),Fh(this.handleError("pwreset")))}registerconfirm(t,e){const i=this.authUrl+"/confirm",n={_id:t,hash:e};return this.log(`Calling HTTP Request: ${i} for: ${t} `),this.http.post(i,n).pipe(D(t=>(this.log("e-mail confirm Request executed"),t&&this.log("e-mail confirm Request Successful:  "+JSON.stringify(t)),t)),Fh(this.handleError("pwreset")))}getUser(t,e){const i=this.authUrl+"/signup",n=new th({"Content-Type":"application/json"});let s=new nh;return t&&(s=s.append("id",t)),e&&(s=s.append("hash",e)),this.log(`Calling HTTP Request: ${i} for: ${t} hash ${e}`),this.http.get(i,{headers:n,params:s}).pipe(D(t=>t.user),Fh(this.handleError("get registerUser")))}createUser(t,e){const i=this.authUrl+"/signup",n=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("hash",e)),this.log(`Calling HTTP Request: ${i} for: ${t.email||t._id} hash ${e} Profile: ${JSON.stringify(t.profile)}`),this.http.post(i,t,{headers:n,params:s}).pipe(D(t=>(this.log("Registration Request executed:  "+JSON.stringify(t)),t.user?(this.log("Registration Request Successful:  "+t.user.email),t.user):new Xh)),Fh(this.handleError("registerUser")))}restVersion(){const t=this.env.restUrl.concat("/status");return this.log("Calling HTTP Request: "+t),this.http.get(t,rp).pipe(D(t=>t.status),qh(()=>this.log("fetched Status  ")),Fh(this.handleError("restVersion")))}initPWPolicy(){const t=this.env.restUrl.concat("/status/pwpolicy");return this.log("Calling HTTP Request: "+t),this.http.get(t,rp).pipe(D(t=>{var e;return this.pwPolicy=null===(e=t.value)||void 0===e?void 0:e.PWPolicy,t.value}),qh(t=>this.log("fetched PW Policy "+JSON.stringify(t))),Fh(this.handleError("initPWPolicy")))}getSetting(){const t=this.env.restUrl.concat("/status/setting");return this.log("Calling HTTP Request: "+t),this.http.get(t,rp).pipe(D(t=>t.vcsetting),qh(t=>this.log("fetched Setting "+JSON.stringify(t))),Fh(this.handleError("initSetting")))}getPWPolicy(){return this.pwPolicy}handleError(t="operation",e){return i=>(this.log(`${t} failed: ${JSON.stringify(i)} Status: ${i.status}, StatusText: ${i.statusText}, Message: ${i.message}, Result ${JSON.stringify(e)} `),$h(i))}log(t){this.messageService.add("AuthenticationService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(jh),Kt(sp))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class ap extends A{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new C;return this._value}next(t){super.next(this._value=t)}}class lp extends g{notifyNext(t,e,i,n,s){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}class cp extends g{constructor(t,e,i){super(),this.parent=t,this.outerValue=e,this.outerIndex=i,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function dp(t,e,i,n,s=new cp(t,i,n)){if(!s.closed)return e instanceof b?e.subscribe(s):O(e)(s)}const up={};class hp{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new pp(t,this.resultSelector))}}class pp extends lp{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(up),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let i=0;i<e;i++)this.add(dp(this,t[i],void 0,i))}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,i){const n=this.values,s=this.toRespond?n[i]===up?--this.toRespond:this.toRespond:0;n[i]=e,0===s&&(this.resultSelector?this._tryResultSelector(n):this.destination.next(n.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(i){return void this.destination.error(i)}this.destination.next(e)}}const gp=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})(),mp=new b(t=>t.complete());function fp(t){return t?function(t){return new b(e=>t.schedule(()=>e.complete()))}(t):mp}function vp(t){return new b(e=>{let i;try{i=t()}catch(n){return void e.error(n)}return(i?L(i):fp()).subscribe(e)})}function bp(){return B(1)}const yp=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function Cp(t){return function(e){return 0===t?fp():e.lift(new Vp(t))}}class Vp{constructor(t){if(this.total=t,this.total<0)throw new yp}call(t,e){return e.subscribe(new wp(t,this.total))}}class wp extends g{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,i=this.total,n=this.count++;e.length<i?e.push(t):e[n%i]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const i=this.count>=this.total?this.total:this.count,n=this.ring;for(let s=0;s<i;s++){const s=e++%i;t.next(n[s])}}t.complete()}}function Ap(t=Dp){return e=>e.lift(new Pp(t))}class Pp{constructor(t){this.errorFactory=t}call(t,e){return e.subscribe(new kp(t,this.errorFactory))}}class kp extends g{constructor(t,e){super(t),this.errorFactory=e,this.hasValue=!1}_next(t){this.hasValue=!0,this.destination.next(t)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}}function Dp(){return new gp}function Mp(t=null){return e=>e.lift(new Ip(t))}class Ip{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new Sp(t,this.defaultValue))}}class Sp extends g{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function xp(t,e){return"function"==typeof e?i=>i.pipe(xp((i,n)=>L(t(i,n)).pipe(D((t,s)=>e(i,t,n,s))))):e=>e.lift(new Tp(t))}class Tp{constructor(t){this.project=t}call(t,e){return e.subscribe(new _p(t,this.project))}}class _p extends R{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const i=this.index++;try{e=this.project(t,i)}catch(n){return void this.destination.error(n)}this._innerSub(e)}_innerSub(t){const e=this.innerSubscription;e&&e.unsubscribe();const i=new G(this),n=this.destination;n.add(i),this.innerSubscription=j(t,i),this.innerSubscription!==i&&n.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(t){this.destination.next(t)}}function Up(t){return e=>0===t?fp():e.lift(new Op(t))}class Op{constructor(t){if(this.total=t,this.total<0)throw new yp}call(t,e){return e.subscribe(new Ep(t,this.total))}}class Ep extends g{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,i=++this.count;i<=e&&(this.destination.next(t),i===e&&(this.destination.complete(),this.unsubscribe()))}}function Lp(...t){return bp()(zu(...t))}class Gp{constructor(t,e,i=!1){this.accumulator=t,this.seed=e,this.hasSeed=i}call(t,e){return e.subscribe(new Rp(t,this.accumulator,this.seed,this.hasSeed))}}class Rp extends g{constructor(t,e,i,n){super(t),this.accumulator=e,this._seed=i,this.hasSeed=n,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let i;try{i=this.accumulator(this.seed,t,e)}catch(n){this.destination.error(n)}this.seed=i,this.destination.next(i)}}function jp(t,e){const i=arguments.length>=2;return n=>n.pipe(t?Wu((e,i)=>t(e,i,n)):v,Up(1),i?Mp(e):Ap(()=>new gp))}class $p{constructor(t){this.callback=t}call(t,e){return e.subscribe(new Np(t,this.callback))}}class Np extends g{constructor(t,e){super(t),this.add(new u(e))}}class Fp{constructor(t,e){this.id=t,this.url=e}}class Bp extends Fp{constructor(t,e,i="imperative",n=null){super(t,e),this.navigationTrigger=i,this.restoredState=n}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Hp extends Fp{constructor(t,e,i){super(t,e),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Kp extends Fp{constructor(t,e,i){super(t,e),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class qp extends Fp{constructor(t,e,i){super(t,e),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class zp extends Fp{constructor(t,e,i,n){super(t,e),this.urlAfterRedirects=i,this.state=n}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Qp extends Fp{constructor(t,e,i,n){super(t,e),this.urlAfterRedirects=i,this.state=n}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Wp extends Fp{constructor(t,e,i,n,s){super(t,e),this.urlAfterRedirects=i,this.state=n,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Jp extends Fp{constructor(t,e,i,n){super(t,e),this.urlAfterRedirects=i,this.state=n}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Yp extends Fp{constructor(t,e,i,n){super(t,e),this.urlAfterRedirects=i,this.state=n}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Zp{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Xp{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class tg{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class eg{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ig{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ng{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class sg{constructor(t,e,i){this.routerEvent=t,this.position=e,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class rg{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function og(t){return new rg(t)}function ag(t){const e=Error("NavigationCancelingError: "+t);return e.ngNavigationCancelingError=!0,e}function lg(t,e,i){const n=i.path.split("/");if(n.length>t.length)return null;if("full"===i.pathMatch&&(e.hasChildren()||n.length<t.length))return null;const s={};for(let r=0;r<n.length;r++){const e=n[r],i=t[r];if(e.startsWith(":"))s[e.substring(1)]=i;else if(e!==i.path)return null}return{consumed:t.slice(0,n.length),posParams:s}}function cg(t,e){const i=Object.keys(t),n=Object.keys(e);if(!i||!n||i.length!=n.length)return!1;let s;for(let r=0;r<i.length;r++)if(s=i[r],!dg(t[s],e[s]))return!1;return!0}function dg(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const i=[...t].sort(),n=[...e].sort();return i.every((t,e)=>n[e]===t)}return t===e}function ug(t){return Array.prototype.concat.apply([],t)}function hg(t){return t.length>0?t[t.length-1]:null}function pg(t,e){for(const i in t)t.hasOwnProperty(i)&&e(t[i],i)}function gg(t){return Wr(t)?t:Qr(t)?L(Promise.resolve(t)):zu(t)}function mg(t,e,i){return i?function(t,e){return cg(t,e)}(t.queryParams,e.queryParams)&&function t(e,i){if(!yg(e.segments,i.segments))return!1;if(e.numberOfChildren!==i.numberOfChildren)return!1;for(const n in i.children){if(!e.children[n])return!1;if(!t(e.children[n],i.children[n]))return!1}return!0}(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(i=>dg(t[i],e[i]))}(t.queryParams,e.queryParams)&&function t(e,i){return function e(i,n,s){if(i.segments.length>s.length)return!!yg(i.segments.slice(0,s.length),s)&&!n.hasChildren();if(i.segments.length===s.length){if(!yg(i.segments,s))return!1;for(const e in n.children){if(!i.children[e])return!1;if(!t(i.children[e],n.children[e]))return!1}return!0}{const t=s.slice(0,i.segments.length),r=s.slice(i.segments.length);return!!yg(i.segments,t)&&!!i.children.primary&&e(i.children.primary,n,r)}}(e,i,i.segments)}(t.root,e.root)}class fg{constructor(t,e,i){this.root=t,this.queryParams=e,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=og(this.queryParams)),this._queryParamMap}toString(){return Ag.serialize(this)}}class vg{constructor(t,e){this.segments=t,this.children=e,this.parent=null,pg(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Pg(this)}}class bg{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=og(this.parameters)),this._parameterMap}toString(){return xg(this)}}function yg(t,e){return t.length===e.length&&t.every((t,i)=>t.path===e[i].path)}function Cg(t,e){let i=[];return pg(t.children,(t,n)=>{"primary"===n&&(i=i.concat(e(t,n)))}),pg(t.children,(t,n)=>{"primary"!==n&&(i=i.concat(e(t,n)))}),i}class Vg{}class wg{parse(t){const e=new Eg(t);return new fg(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){return`${"/"+function t(e,i){if(!e.hasChildren())return Pg(e);if(i){const i=e.children.primary?t(e.children.primary,!1):"",n=[];return pg(e.children,(e,i)=>{"primary"!==i&&n.push(`${i}:${t(e,!1)}`)}),n.length>0?`${i}(${n.join("//")})`:i}{const i=Cg(e,(i,n)=>"primary"===n?[t(e.children.primary,!1)]:[`${n}:${t(i,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children.primary?`${Pg(e)}/${i[0]}`:`${Pg(e)}/(${i.join("//")})`}}(t.root,!0)}${function(t){const e=Object.keys(t).map(e=>{const i=t[e];return Array.isArray(i)?i.map(t=>`${Dg(e)}=${Dg(t)}`).join("&"):`${Dg(e)}=${Dg(i)}`});return e.length?"?"+e.join("&"):""}(t.queryParams)}${"string"==typeof t.fragment?"#"+encodeURI(t.fragment):""}`}}const Ag=new wg;function Pg(t){return t.segments.map(t=>xg(t)).join("/")}function kg(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Dg(t){return kg(t).replace(/%3B/gi,";")}function Mg(t){return kg(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ig(t){return decodeURIComponent(t)}function Sg(t){return Ig(t.replace(/\+/g,"%20"))}function xg(t){return`${Mg(t.path)}${e=t.parameters,Object.keys(e).map(t=>`;${Mg(t)}=${Mg(e[t])}`).join("")}`;var e}const Tg=/^[^\/()?;=#]+/;function _g(t){const e=t.match(Tg);return e?e[0]:""}const Ug=/^[^=?&#]+/,Og=/^[^?&#]+/;class Eg{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new vg([],{}):new vg([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(i.primary=new vg(t,e)),i}parseSegment(){const t=_g(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new bg(Ig(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=_g(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const t=_g(this.remaining);t&&(i=t,this.capture(i))}t[Ig(e)]=Ig(i)}parseQueryParam(t){const e=function(t){const e=t.match(Ug);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(Og);return e?e[0]:""}(this.remaining);t&&(i=t,this.capture(i))}const n=Sg(e),s=Sg(i);if(t.hasOwnProperty(n)){let e=t[n];Array.isArray(e)||(e=[e],t[n]=e),e.push(s)}else t[n]=s}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=_g(this.remaining),n=this.remaining[i.length];if("/"!==n&&")"!==n&&";"!==n)throw new Error(`Cannot parse url '${this.url}'`);let s=void 0;i.indexOf(":")>-1?(s=i.substr(0,i.indexOf(":")),this.capture(s),this.capture(":")):t&&(s="primary");const r=this.parseChildren();e[s]=1===Object.keys(r).length?r.primary:new vg([],r),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class Lg{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=Gg(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=Gg(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=Rg(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return Rg(t,this._root).map(t=>t.value)}}function Gg(t,e){if(t===e.value)return e;for(const i of e.children){const e=Gg(t,i);if(e)return e}return null}function Rg(t,e){if(t===e.value)return[e];for(const i of e.children){const n=Rg(t,i);if(n.length)return n.unshift(e),n}return[]}class jg{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function $g(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class Ng extends Lg{constructor(t,e){super(t),this.snapshot=e,zg(this,t)}toString(){return this.snapshot.toString()}}function Fg(t,e){const i=function(t,e){const i=new Kg([],{},{},"",{},"primary",e,null,t.root,-1,{});return new qg("",new jg(i,[]))}(t,e),n=new ap([new bg("",{})]),s=new ap({}),r=new ap({}),o=new ap({}),a=new ap(""),l=new Bg(n,s,o,a,r,"primary",e,i.root);return l.snapshot=i.root,new Ng(new jg(l,[]),i)}class Bg{constructor(t,e,i,n,s,r,o,a){this.url=t,this.params=e,this.queryParams=i,this.fragment=n,this.data=s,this.outlet=r,this.component=o,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(D(t=>og(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(D(t=>og(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Hg(t,e="emptyOnly"){const i=t.pathFromRoot;let n=0;if("always"!==e)for(n=i.length-1;n>=1;){const t=i[n],e=i[n-1];if(t.routeConfig&&""===t.routeConfig.path)n--;else{if(e.component)break;n--}}return function(t){return t.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(i.slice(n))}class Kg{constructor(t,e,i,n,s,r,o,a,l,c,d){this.url=t,this.params=e,this.queryParams=i,this.fragment=n,this.data=s,this.outlet=r,this.component=o,this.routeConfig=a,this._urlSegment=l,this._lastPathIndex=c,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=og(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=og(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class qg extends Lg{constructor(t,e){super(e),this.url=t,zg(this,e)}toString(){return Qg(this._root)}}function zg(t,e){e.value._routerState=t,e.children.forEach(e=>zg(t,e))}function Qg(t){const e=t.children.length>0?` { ${t.children.map(Qg).join(", ")} } `:"";return`${t.value}${e}`}function Wg(t){if(t.snapshot){const e=t.snapshot,i=t._futureSnapshot;t.snapshot=i,cg(e.queryParams,i.queryParams)||t.queryParams.next(i.queryParams),e.fragment!==i.fragment&&t.fragment.next(i.fragment),cg(e.params,i.params)||t.params.next(i.params),function(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!cg(t[i],e[i]))return!1;return!0}(e.url,i.url)||t.url.next(i.url),cg(e.data,i.data)||t.data.next(i.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function Jg(t,e){var i,n;return cg(t.params,e.params)&&yg(i=t.url,n=e.url)&&i.every((t,e)=>cg(t.parameters,n[e].parameters))&&!(!t.parent!=!e.parent)&&(!t.parent||Jg(t.parent,e.parent))}function Yg(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function Zg(t){return"object"==typeof t&&null!=t&&t.outlets}function Xg(t,e,i,n,s){let r={};return n&&pg(n,(t,e)=>{r[e]=Array.isArray(t)?t.map(t=>""+t):""+t}),new fg(i.root===t?e:function t(e,i,n){const s={};return pg(e.children,(e,r)=>{s[r]=e===i?n:t(e,i,n)}),new vg(e.segments,s)}(i.root,t,e),r,s)}class tm{constructor(t,e,i){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=i,t&&i.length>0&&Yg(i[0]))throw new Error("Root segment cannot have matrix parameters");const n=i.find(Zg);if(n&&n!==hg(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class em{constructor(t,e,i){this.segmentGroup=t,this.processChildren=e,this.index=i}}function im(t,e,i){if(t||(t=new vg([],{})),0===t.segments.length&&t.hasChildren())return nm(t,e,i);const n=function(t,e,i){let n=0,s=e;const r={match:!1,pathIndex:0,commandIndex:0};for(;s<t.segments.length;){if(n>=i.length)return r;const e=t.segments[s],o=i[n];if(Zg(o))break;const a=""+o,l=n<i.length-1?i[n+1]:null;if(s>0&&void 0===a)break;if(a&&l&&"object"==typeof l&&void 0===l.outlets){if(!am(a,l,e))return r;n+=2}else{if(!am(a,{},e))return r;n++}s++}return{match:!0,pathIndex:s,commandIndex:n}}(t,e,i),s=i.slice(n.commandIndex);if(n.match&&n.pathIndex<t.segments.length){const e=new vg(t.segments.slice(0,n.pathIndex),{});return e.children.primary=new vg(t.segments.slice(n.pathIndex),t.children),nm(e,0,s)}return n.match&&0===s.length?new vg(t.segments,{}):n.match&&!t.hasChildren()?sm(t,e,i):n.match?nm(t,0,s):sm(t,e,i)}function nm(t,e,i){if(0===i.length)return new vg(t.segments,{});{const n=function(t){return Zg(t[0])?t[0].outlets:{primary:t}}(i),s={};return pg(n,(i,n)=>{null!==i&&(s[n]=im(t.children[n],e,i))}),pg(t.children,(t,e)=>{void 0===n[e]&&(s[e]=t)}),new vg(t.segments,s)}}function sm(t,e,i){const n=t.segments.slice(0,e);let s=0;for(;s<i.length;){const r=i[s];if(Zg(r)){const t=rm(r.outlets);return new vg(n,t)}if(0===s&&Yg(i[0])){n.push(new bg(t.segments[e].path,i[0])),s++;continue}const o=Zg(r)?r.outlets.primary:""+r,a=s<i.length-1?i[s+1]:null;o&&a&&Yg(a)?(n.push(new bg(o,om(a))),s+=2):(n.push(new bg(o,{})),s++)}return new vg(n,{})}function rm(t){const e={};return pg(t,(t,i)=>{null!==t&&(e[i]=sm(new vg([],{}),0,t))}),e}function om(t){const e={};return pg(t,(t,i)=>e[i]=""+t),e}function am(t,e,i){return t==i.path&&cg(e,i.parameters)}class lm{constructor(t,e,i,n){this.routeReuseStrategy=t,this.futureState=e,this.currState=i,this.forwardEvent=n}activate(t){const e=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,i,t),Wg(this.futureState.root),this.activateChildRoutes(e,i,t)}deactivateChildRoutes(t,e,i){const n=$g(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,n[e],i),delete n[e]}),pg(n,(t,e)=>{this.deactivateRouteAndItsChildren(t,i)})}deactivateRoutes(t,e,i){const n=t.value,s=e?e.value:null;if(n===s)if(n.component){const s=i.getContext(n.outlet);s&&this.deactivateChildRoutes(t,e,s.children)}else this.deactivateChildRoutes(t,e,i);else s&&this.deactivateRouteAndItsChildren(e,i)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const i=e.getContext(t.value.outlet);if(i&&i.outlet){const e=i.outlet.detach(),n=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:n})}}deactivateRouteAndOutlet(t,e){const i=e.getContext(t.value.outlet);if(i){const n=$g(t),s=t.value.component?i.children:e;pg(n,(t,e)=>this.deactivateRouteAndItsChildren(t,s)),i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated())}}activateChildRoutes(t,e,i){const n=$g(e);t.children.forEach(t=>{this.activateRoutes(t,n[t.value.outlet],i),this.forwardEvent(new ng(t.value.snapshot))}),t.children.length&&this.forwardEvent(new eg(t.value.snapshot))}activateRoutes(t,e,i){const n=t.value,s=e?e.value:null;if(Wg(n),n===s)if(n.component){const s=i.getOrCreateContext(n.outlet);this.activateChildRoutes(t,e,s.children)}else this.activateChildRoutes(t,e,i);else if(n.component){const e=i.getOrCreateContext(n.outlet);if(this.routeReuseStrategy.shouldAttach(n.snapshot)){const t=this.routeReuseStrategy.retrieve(n.snapshot);this.routeReuseStrategy.store(n.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),cm(t.route)}else{const i=function(t){for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(n.snapshot),s=i?i.module.componentFactoryResolver:null;e.attachRef=null,e.route=n,e.resolver=s,e.outlet&&e.outlet.activateWith(n,s),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,i)}}function cm(t){Wg(t.value),t.children.forEach(cm)}class dm{constructor(t,e){this.routes=t,this.module=e}}function um(t){return"function"==typeof t}function hm(t){return t instanceof fg}const pm=Symbol("INITIAL_VALUE");function gm(){return xp(t=>function(...t){let e=void 0,i=void 0;return k(t[t.length-1])&&(i=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&l(t[0])&&(t=t[0]),H(t,i).lift(new hp(e))}(...t.map(t=>t.pipe(Up(1),function(...t){const e=t[t.length-1];return k(e)?(t.pop(),i=>Lp(t,i,e)):e=>Lp(t,e)}(pm)))).pipe(function(t,e){let i=!1;return arguments.length>=2&&(i=!0),function(n){return n.lift(new Gp(t,e,i))}}((t,e)=>{let i=!1;return e.reduce((t,n,s)=>{if(t!==pm)return t;if(n===pm&&(i=!0),!i){if(!1===n)return n;if(s===e.length-1||hm(n))return n}return t},t)},pm),Wu(t=>t!==pm),D(t=>hm(t)?t:!0===t),Up(1)))}class mm{constructor(t){this.segmentGroup=t||null}}class fm{constructor(t){this.urlTree=t}}function vm(t){return new b(e=>e.error(new mm(t)))}function bm(t){return new b(e=>e.error(new fm(t)))}function ym(t){return new b(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class Cm{constructor(t,e,i,n,s){this.configLoader=e,this.urlSerializer=i,this.urlTree=n,this.config=s,this.allowRedirects=!0,this.ngModule=t.get(Wt)}apply(){return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,"primary").pipe(D(t=>this.createUrlTree(t,this.urlTree.queryParams,this.urlTree.fragment))).pipe(Fh(t=>{if(t instanceof fm)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof mm)throw this.noMatchError(t);throw t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,"primary").pipe(D(e=>this.createUrlTree(e,t.queryParams,t.fragment))).pipe(Fh(t=>{if(t instanceof mm)throw this.noMatchError(t);throw t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,i){const n=t.segments.length>0?new vg([],{primary:t}):t;return new fg(n,e,i)}expandSegmentGroup(t,e,i,n){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(t,e,i).pipe(D(t=>new vg([],t))):this.expandSegment(t,i,e,i.segments,n,!0)}expandChildren(t,e,i){return function(t,e){if(0===Object.keys(t).length)return zu({});const i=[],n=[],s={};return pg(t,(t,r)=>{const o=e(r,t).pipe(D(t=>s[r]=t));"primary"===r?i.push(o):n.push(o)}),zu.apply(null,i.concat(n)).pipe(bp(),function(t,e){const i=arguments.length>=2;return n=>n.pipe(t?Wu((e,i)=>t(e,i,n)):v,Cp(1),i?Mp(e):Ap(()=>new gp))}(),D(()=>s))}(i.children,(i,n)=>this.expandSegmentGroup(t,e,n,i))}expandSegment(t,e,i,n,s,r){return zu(...i).pipe(Qu(o=>this.expandSegmentAgainstRoute(t,e,i,o,n,s,r).pipe(Fh(t=>{if(t instanceof mm)return zu(null);throw t}))),jp(t=>!!t),Fh((t,i)=>{if(t instanceof gp||"EmptyError"===t.name){if(this.noLeftoversInUrl(e,n,s))return zu(new vg([],{}));throw new mm(e)}throw t}))}noLeftoversInUrl(t,e,i){return 0===e.length&&!t.children[i]}expandSegmentAgainstRoute(t,e,i,n,s,r,o){return Pm(n)!==r?vm(e):void 0===n.redirectTo?this.matchSegmentAgainstRoute(t,e,n,s):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,i,n,s,r):vm(e)}expandSegmentAgainstRouteUsingRedirect(t,e,i,n,s,r){return"**"===n.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,i,n,r):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,n,s,r)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,i,n){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?bm(s):this.lineralizeSegments(i,s).pipe($(i=>{const s=new vg(i,{});return this.expandSegment(t,s,e,i,n,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,n,s,r){const{matched:o,consumedSegments:a,lastChild:l,positionalParamSegments:c}=Vm(e,n,s);if(!o)return vm(e);const d=this.applyRedirectCommands(a,n.redirectTo,c);return n.redirectTo.startsWith("/")?bm(d):this.lineralizeSegments(n,d).pipe($(n=>this.expandSegment(t,e,i,n.concat(s.slice(l)),r,!1)))}matchSegmentAgainstRoute(t,e,i,n){if("**"===i.path)return i.loadChildren?this.configLoader.load(t.injector,i).pipe(D(t=>(i._loadedConfig=t,new vg(n,{})))):zu(new vg(n,{}));const{matched:s,consumedSegments:r,lastChild:o}=Vm(e,i,n);if(!s)return vm(e);const a=n.slice(o);return this.getChildConfig(t,i,n).pipe($(t=>{const i=t.module,n=t.routes,{segmentGroup:s,slicedSegments:o}=function(t,e,i,n){return i.length>0&&function(t,e,i){return i.some(i=>Am(t,e,i)&&"primary"!==Pm(i))}(t,i,n)?{segmentGroup:wm(new vg(e,function(t,e){const i={};i.primary=e;for(const n of t)""===n.path&&"primary"!==Pm(n)&&(i[Pm(n)]=new vg([],{}));return i}(n,new vg(i,t.children)))),slicedSegments:[]}:0===i.length&&function(t,e,i){return i.some(i=>Am(t,e,i))}(t,i,n)?{segmentGroup:wm(new vg(t.segments,function(t,e,i,n){const s={};for(const r of i)Am(t,e,r)&&!n[Pm(r)]&&(s[Pm(r)]=new vg([],{}));return Object.assign(Object.assign({},n),s)}(t,i,n,t.children))),slicedSegments:i}:{segmentGroup:t,slicedSegments:i}}(e,r,a,n);return 0===o.length&&s.hasChildren()?this.expandChildren(i,n,s).pipe(D(t=>new vg(r,t))):0===n.length&&0===o.length?zu(new vg(r,{})):this.expandSegment(i,s,n,o,"primary",!0).pipe(D(t=>new vg(r.concat(t.segments),t.children)))}))}getChildConfig(t,e,i){return e.children?zu(new dm(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?zu(e._loadedConfig):this.runCanLoadGuards(t.injector,e,i).pipe($(i=>i?this.configLoader.load(t.injector,e).pipe(D(t=>(e._loadedConfig=t,t))):function(t){return new b(e=>e.error(ag(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):zu(new dm([],t))}runCanLoadGuards(t,e,i){const n=e.canLoad;return n&&0!==n.length?zu(n.map(n=>{const s=t.get(n);let r;if(function(t){return t&&um(t.canLoad)}(s))r=s.canLoad(e,i);else{if(!um(s))throw new Error("Invalid CanLoad guard");r=s(e,i)}return gg(r)})).pipe(gm(),qh(t=>{if(!hm(t))return;const e=ag(`Redirecting to "${this.urlSerializer.serialize(t)}"`);throw e.url=t,e}),D(t=>!0===t)):zu(!0)}lineralizeSegments(t,e){let i=[],n=e.root;for(;;){if(i=i.concat(n.segments),0===n.numberOfChildren)return zu(i);if(n.numberOfChildren>1||!n.children.primary)return ym(t.redirectTo);n=n.children.primary}}applyRedirectCommands(t,e,i){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,i)}applyRedirectCreatreUrlTree(t,e,i,n){const s=this.createSegmentGroup(t,e.root,i,n);return new fg(s,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const i={};return pg(t,(t,n)=>{if("string"==typeof t&&t.startsWith(":")){const s=t.substring(1);i[n]=e[s]}else i[n]=t}),i}createSegmentGroup(t,e,i,n){const s=this.createSegments(t,e.segments,i,n);let r={};return pg(e.children,(e,s)=>{r[s]=this.createSegmentGroup(t,e,i,n)}),new vg(s,r)}createSegments(t,e,i,n){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,n):this.findOrReturn(e,i))}findPosParam(t,e,i){const n=i[e.path.substring(1)];if(!n)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return n}findOrReturn(t,e){let i=0;for(const n of e){if(n.path===t.path)return e.splice(i),n;i++}return t}}function Vm(t,e,i){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||i.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};const n=(e.matcher||lg)(i,t,e);return n?{matched:!0,consumedSegments:n.consumed,lastChild:n.consumed.length,positionalParamSegments:n.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function wm(t){if(1===t.numberOfChildren&&t.children.primary){const e=t.children.primary;return new vg(t.segments.concat(e.segments),e.children)}return t}function Am(t,e,i){return(!(t.hasChildren()||e.length>0)||"full"!==i.pathMatch)&&""===i.path&&void 0!==i.redirectTo}function Pm(t){return t.outlet||"primary"}class km{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Dm{constructor(t,e){this.component=t,this.route=e}}function Mm(t,e,i){const n=t._root;return function t(e,i,n,s,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=$g(i);return e.children.forEach(e=>{!function(e,i,n,s,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=e.value,a=i?i.value:null,l=n?n.getContext(e.value.outlet):null;if(a&&o.routeConfig===a.routeConfig){const c=function(t,e,i){if("function"==typeof i)return i(t,e);switch(i){case"pathParamsChange":return!yg(t.url,e.url);case"pathParamsOrQueryParamsChange":return!yg(t.url,e.url)||!cg(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Jg(t,e)||!cg(t.queryParams,e.queryParams);case"paramsChange":default:return!Jg(t,e)}}(a,o,o.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new km(s)):(o.data=a.data,o._resolvedData=a._resolvedData),t(e,i,o.component?l?l.children:null:n,s,r),c&&l&&l.outlet&&l.outlet.isActivated&&r.canDeactivateChecks.push(new Dm(l.outlet.component,a))}else a&&Sm(i,l,r),r.canActivateChecks.push(new km(s)),t(e,null,o.component?l?l.children:null:n,s,r)}(e,o[e.value.outlet],n,s.concat([e.value]),r),delete o[e.value.outlet]}),pg(o,(t,e)=>Sm(t,n.getContext(e),r)),r}(n,e?e._root:null,i,[n.value])}function Im(t,e,i){const n=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(n?n.module.injector:i).get(t)}function Sm(t,e,i){const n=$g(t),s=t.value;pg(n,(t,n)=>{Sm(t,s.component?e?e.children.getContext(n):null:e,i)}),i.canDeactivateChecks.push(new Dm(s.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,s))}function xm(t,e){return null!==t&&e&&e(new ig(t)),zu(!0)}function Tm(t,e){return null!==t&&e&&e(new tg(t)),zu(!0)}function _m(t,e,i){const n=e.routeConfig?e.routeConfig.canActivate:null;return n&&0!==n.length?zu(n.map(n=>vp(()=>{const s=Im(n,e,i);let r;if(function(t){return t&&um(t.canActivate)}(s))r=gg(s.canActivate(e,t));else{if(!um(s))throw new Error("Invalid CanActivate guard");r=gg(s(e,t))}return r.pipe(jp())}))).pipe(gm()):zu(!0)}function Um(t,e,i){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(t=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)).filter(t=>null!==t).map(e=>vp(()=>zu(e.guards.map(s=>{const r=Im(s,e.node,i);let o;if(function(t){return t&&um(t.canActivateChild)}(r))o=gg(r.canActivateChild(n,t));else{if(!um(r))throw new Error("Invalid CanActivateChild guard");o=gg(r(n,t))}return o.pipe(jp())})).pipe(gm())));return zu(s).pipe(gm())}class Om{}class Em{constructor(t,e,i,n,s,r){this.rootComponentType=t,this.config=e,this.urlTree=i,this.url=n,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=r}recognize(){try{const t=Rm(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,"primary"),i=new Kg([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),n=new jg(i,e),s=new qg(this.url,n);return this.inheritParamsAndData(s._root),zu(s)}catch(t){return new b(e=>e.error(t))}}inheritParamsAndData(t){const e=t.value,i=Hg(e,this.paramsInheritanceStrategy);e.params=Object.freeze(i.params),e.data=Object.freeze(i.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,i){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,i)}processChildren(t,e){const i=Cg(e,(e,i)=>this.processSegmentGroup(t,e,i));return function(t){const e={};t.forEach(t=>{const i=e[t.value.outlet];if(i){const e=i.url.map(t=>t.toString()).join("/"),n=t.value.url.map(t=>t.toString()).join("/");throw new Error(`Two segments cannot have the same outlet name: '${e}' and '${n}'.`)}e[t.value.outlet]=t.value})}(i),i.sort((t,e)=>"primary"===t.value.outlet?-1:"primary"===e.value.outlet?1:t.value.outlet.localeCompare(e.value.outlet)),i}processSegment(t,e,i,n){for(const r of t)try{return this.processSegmentAgainstRoute(r,e,i,n)}catch(s){if(!(s instanceof Om))throw s}if(this.noLeftoversInUrl(e,i,n))return[];throw new Om}noLeftoversInUrl(t,e,i){return 0===e.length&&!t.children[i]}processSegmentAgainstRoute(t,e,i,n){if(t.redirectTo)throw new Om;if((t.outlet||"primary")!==n)throw new Om;let s,r=[],o=[];if("**"===t.path){const r=i.length>0?hg(i).parameters:{};s=new Kg(i,r,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Nm(t),n,t.component,t,Lm(e),Gm(e)+i.length,Fm(t))}else{const a=function(t,e,i){if(""===e.path){if("full"===e.pathMatch&&(t.hasChildren()||i.length>0))throw new Om;return{consumedSegments:[],lastChild:0,parameters:{}}}const n=(e.matcher||lg)(i,t,e);if(!n)throw new Om;const s={};pg(n.posParams,(t,e)=>{s[e]=t.path});const r=n.consumed.length>0?Object.assign(Object.assign({},s),n.consumed[n.consumed.length-1].parameters):s;return{consumedSegments:n.consumed,lastChild:n.consumed.length,parameters:r}}(e,t,i);r=a.consumedSegments,o=i.slice(a.lastChild),s=new Kg(r,a.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Nm(t),n,t.component,t,Lm(e),Gm(e)+r.length,Fm(t))}const a=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:l,slicedSegments:c}=Rm(e,r,o,a,this.relativeLinkResolution);if(0===c.length&&l.hasChildren()){const t=this.processChildren(a,l);return[new jg(s,t)]}if(0===a.length&&0===c.length)return[new jg(s,[])];const d=this.processSegment(a,l,c,"primary");return[new jg(s,d)]}}function Lm(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function Gm(t){let e=t,i=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,i+=e._segmentIndexShift?e._segmentIndexShift:0;return i-1}function Rm(t,e,i,n,s){if(i.length>0&&function(t,e,i){return i.some(i=>jm(t,e,i)&&"primary"!==$m(i))}(t,i,n)){const s=new vg(e,function(t,e,i,n){const s={};s.primary=n,n._sourceSegment=t,n._segmentIndexShift=e.length;for(const r of i)if(""===r.path&&"primary"!==$m(r)){const i=new vg([],{});i._sourceSegment=t,i._segmentIndexShift=e.length,s[$m(r)]=i}return s}(t,e,n,new vg(i,t.children)));return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===i.length&&function(t,e,i){return i.some(i=>jm(t,e,i))}(t,i,n)){const r=new vg(t.segments,function(t,e,i,n,s,r){const o={};for(const a of n)if(jm(t,i,a)&&!s[$m(a)]){const i=new vg([],{});i._sourceSegment=t,i._segmentIndexShift="legacy"===r?t.segments.length:e.length,o[$m(a)]=i}return Object.assign(Object.assign({},s),o)}(t,e,i,n,t.children,s));return r._sourceSegment=t,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:i}}const r=new vg(t.segments,t.children);return r._sourceSegment=t,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:i}}function jm(t,e,i){return(!(t.hasChildren()||e.length>0)||"full"!==i.pathMatch)&&""===i.path&&void 0===i.redirectTo}function $m(t){return t.outlet||"primary"}function Nm(t){return t.data||{}}function Fm(t){return t.resolve||{}}function Bm(t){return function(e){return e.pipe(xp(e=>{const i=t(e);return i?L(i).pipe(D(()=>e)):L([e])}))}}class Hm extends class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}let Km=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=le({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&Br(0,"router-outlet")},directives:function(){return[lf]},encapsulation:2}),t})();function qm(t,e=""){for(let i=0;i<t.length;i++){const n=t[i];zm(n,Qm(e,n))}}function zm(t,e){if(!t)throw new Error(`\n      Invalid configuration of route '${e}': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    `);if(Array.isArray(t))throw new Error(`Invalid configuration of route '${e}': Array cannot be specified`);if(!t.component&&!t.children&&!t.loadChildren&&t.outlet&&"primary"!==t.outlet)throw new Error(`Invalid configuration of route '${e}': a componentless route without children or loadChildren cannot have a named outlet set`);if(t.redirectTo&&t.children)throw new Error(`Invalid configuration of route '${e}': redirectTo and children cannot be used together`);if(t.redirectTo&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': redirectTo and loadChildren cannot be used together`);if(t.children&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': children and loadChildren cannot be used together`);if(t.redirectTo&&t.component)throw new Error(`Invalid configuration of route '${e}': redirectTo and component cannot be used together`);if(t.path&&t.matcher)throw new Error(`Invalid configuration of route '${e}': path and matcher cannot be used together`);if(void 0===t.redirectTo&&!t.component&&!t.children&&!t.loadChildren)throw new Error(`Invalid configuration of route '${e}'. One of the following must be provided: component, redirectTo, children or loadChildren`);if(void 0===t.path&&void 0===t.matcher)throw new Error(`Invalid configuration of route '${e}': routes must have either a path or a matcher specified`);if("string"==typeof t.path&&"/"===t.path.charAt(0))throw new Error(`Invalid configuration of route '${e}': path cannot start with a slash`);if(""===t.path&&void 0!==t.redirectTo&&void 0===t.pathMatch)throw new Error(`Invalid configuration of route '{path: "${e}", redirectTo: "${t.redirectTo}"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`);if(void 0!==t.pathMatch&&"full"!==t.pathMatch&&"prefix"!==t.pathMatch)throw new Error(`Invalid configuration of route '${e}': pathMatch can only be set to 'prefix' or 'full'`);t.children&&qm(t.children,e)}function Qm(t,e){return e?t||e.path?t&&!e.path?t+"/":!t&&e.path?e.path:`${t}/${e.path}`:"":t}function Wm(t){const e=t.children&&t.children.map(Wm),i=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!i.component&&(e||i.loadChildren)&&i.outlet&&"primary"!==i.outlet&&(i.component=Km),i}const Jm=new Et("ROUTES");class Ym{constructor(t,e,i,n){this.loader=t,this.compiler=e,this.onLoadStartListener=i,this.onLoadEndListener=n}load(t,e){return this.onLoadStartListener&&this.onLoadStartListener(e),this.loadModuleFactory(e.loadChildren).pipe(D(i=>{this.onLoadEndListener&&this.onLoadEndListener(e);const n=i.create(t);return new dm(ug(n.injector.get(Jm)).map(Wm),n)}))}loadModuleFactory(t){return"string"==typeof t?L(this.loader.load(t)):gg(t()).pipe($(t=>t instanceof Jt?zu(t):L(this.compiler.compileModuleAsync(t))))}}class Zm{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Xm,this.attachRef=null}}class Xm{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const i=this.getOrCreateContext(t);i.outlet=e,this.contexts.set(t,i)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new Zm,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}class tf{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function ef(t){throw t}function nf(t,e,i){return e.parse("/")}function sf(t,e){return zu(null)}let rf=(()=>{class t{constructor(t,e,i,n,s,r,o,a){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=i,this.location=n,this.config=a,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.lastLocationChangeInfo=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new A,this.errorHandler=ef,this.malformedUriErrorHandler=nf,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:sf,afterPreactivation:sf},this.urlHandlingStrategy=new tf,this.routeReuseStrategy=new Hm,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=s.get(Wt),this.console=s.get(Qa);const l=s.get(al);this.isNgZoneEnabled=l instanceof al,this.resetConfig(a),this.currentUrlTree=new fg(new vg([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Ym(r,o,t=>this.triggerEvent(new Zp(t)),t=>this.triggerEvent(new Xp(t))),this.routerState=Fg(this.currentUrlTree,this.rootComponentType),this.transitions=new ap({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(t){const e=this.events;return t.pipe(Wu(t=>0!==t.id),D(t=>Object.assign(Object.assign({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),xp(t=>{let i=!1,n=!1;return zu(t).pipe(qh(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),xp(t=>{const i=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||i)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return zu(t).pipe(xp(t=>{const i=this.transitions.getValue();return e.next(new Bp(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),i!==this.transitions.getValue()?mp:[t]}),xp(t=>Promise.resolve(t)),(n=this.ngModule.injector,s=this.configLoader,r=this.urlSerializer,o=this.config,function(t){return t.pipe(xp(t=>function(t,e,i,n,s){return new Cm(t,e,i,n,s).apply()}(n,s,r,t.extractedUrl,o).pipe(D(e=>Object.assign(Object.assign({},t),{urlAfterRedirects:e})))))}),qh(t=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:t.urlAfterRedirects})}),function(t,e,i,n,s){return function(r){return r.pipe($(r=>function(t,e,i,n,s="emptyOnly",r="legacy"){return new Em(t,e,i,n,s,r).recognize()}(t,e,r.urlAfterRedirects,i(r.urlAfterRedirects),n,s).pipe(D(t=>Object.assign(Object.assign({},r),{targetSnapshot:t})))))}}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),qh(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),qh(t=>{const i=new zp(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(i)}));var n,s,r,o;if(i&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:i,extractedUrl:n,source:s,restoredState:r,extras:o}=t,a=new Bp(i,this.serializeUrl(n),s,r);e.next(a);const l=Fg(n,this.rootComponentType).snapshot;return zu(Object.assign(Object.assign({},t),{targetSnapshot:l,urlAfterRedirects:n,extras:Object.assign(Object.assign({},o),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),mp}),Bm(t=>{const{targetSnapshot:e,id:i,extractedUrl:n,rawUrl:s,extras:{skipLocationChange:r,replaceUrl:o}}=t;return this.hooks.beforePreactivation(e,{navigationId:i,appliedUrlTree:n,rawUrlTree:s,skipLocationChange:!!r,replaceUrl:!!o})}),qh(t=>{const e=new Qp(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),D(t=>Object.assign(Object.assign({},t),{guards:Mm(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return function(i){return i.pipe($(i=>{const{targetSnapshot:n,currentSnapshot:s,guards:{canActivateChecks:r,canDeactivateChecks:o}}=i;return 0===o.length&&0===r.length?zu(Object.assign(Object.assign({},i),{guardsResult:!0})):function(t,e,i,n){return L(t).pipe($(t=>function(t,e,i,n,s){const r=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return r&&0!==r.length?zu(r.map(r=>{const o=Im(r,e,s);let a;if(function(t){return t&&um(t.canDeactivate)}(o))a=gg(o.canDeactivate(t,e,i,n));else{if(!um(o))throw new Error("Invalid CanDeactivate guard");a=gg(o(t,e,i,n))}return a.pipe(jp())})).pipe(gm()):zu(!0)}(t.component,t.route,i,e,n)),jp(t=>!0!==t,!0))}(o,n,s,t).pipe($(i=>i&&"boolean"==typeof i?function(t,e,i,n){return L(e).pipe(Qu(e=>L([Tm(e.route.parent,n),xm(e.route,n),Um(t,e.path,i),_m(t,e.route,i)]).pipe(bp(),jp(t=>!0!==t,!0))),jp(t=>!0!==t,!0))}(n,r,t,e):zu(i)),D(t=>Object.assign(Object.assign({},i),{guardsResult:t})))}))}}(this.ngModule.injector,t=>this.triggerEvent(t)),qh(t=>{if(hm(t.guardsResult)){const e=ag(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}}),qh(t=>{const e=new Wp(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),Wu(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const i=new Kp(t.id,this.serializeUrl(t.extractedUrl),"");return e.next(i),t.resolve(!1),!1}return!0}),Bm(t=>{if(t.guards.canActivateChecks.length)return zu(t).pipe(qh(t=>{const e=new Jp(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),xp(t=>{let i=!1;return zu(t).pipe((n=this.paramsInheritanceStrategy,s=this.ngModule.injector,function(t){return t.pipe($(t=>{const{targetSnapshot:e,guards:{canActivateChecks:i}}=t;if(!i.length)return zu(t);let r=0;return L(i).pipe(Qu(t=>function(t,e,i,n){return function(t,e,i,n){const s=Object.keys(t);if(0===s.length)return zu({});const r={};return L(s).pipe($(s=>function(t,e,i,n){const s=Im(t,e,n);return gg(s.resolve?s.resolve(e,i):s(e,i))}(t[s],e,i,n).pipe(qh(t=>{r[s]=t}))),Cp(1),$(()=>Object.keys(r).length===s.length?zu(r):mp))}(t._resolve,t,e,n).pipe(D(e=>(t._resolvedData=e,t.data=Object.assign(Object.assign({},t.data),Hg(t,i).resolve),null)))}(t.route,e,n,s)),qh(()=>r++),Cp(1),$(e=>r===i.length?zu(t):mp))}))}),qh({next:()=>i=!0,complete:()=>{if(!i){const i=new Kp(t.id,this.serializeUrl(t.extractedUrl),"At least one route resolver didn't emit any value.");e.next(i),t.resolve(!1)}}}));var n,s}),qh(t=>{const e=new Yp(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}))}),Bm(t=>{const{targetSnapshot:e,id:i,extractedUrl:n,rawUrl:s,extras:{skipLocationChange:r,replaceUrl:o}}=t;return this.hooks.afterPreactivation(e,{navigationId:i,appliedUrlTree:n,rawUrlTree:s,skipLocationChange:!!r,replaceUrl:!!o})}),D(t=>{const e=function(t,e,i){const n=function t(e,i,n){if(n&&e.shouldReuseRoute(i.value,n.value.snapshot)){const s=n.value;s._futureSnapshot=i.value;const r=function(e,i,n){return i.children.map(i=>{for(const s of n.children)if(e.shouldReuseRoute(s.value.snapshot,i.value))return t(e,i,s);return t(e,i)})}(e,i,n);return new jg(s,r)}{const n=e.retrieve(i.value);if(n){const t=n.route;return function t(e,i){if(e.value.routeConfig!==i.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==i.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");i.value._futureSnapshot=e.value;for(let n=0;n<e.children.length;++n)t(e.children[n],i.children[n])}(i,t),t}{const n=new Bg(new ap((s=i.value).url),new ap(s.params),new ap(s.queryParams),new ap(s.fragment),new ap(s.data),s.outlet,s.component,s),r=i.children.map(i=>t(e,i));return new jg(n,r)}}var s}(t,e._root,i?i._root:void 0);return new Ng(n,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign(Object.assign({},t),{targetRouterState:e})}),qh(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),(r=this.rootContexts,o=this.routeReuseStrategy,a=t=>this.triggerEvent(t),D(t=>(new lm(o,t.targetRouterState,t.currentRouterState,a).activate(r),t))),qh({next(){i=!0},complete(){i=!0}}),(s=()=>{if(!i&&!n){this.resetUrlToCurrentUrlTree();const i=new Kp(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);e.next(i),t.resolve(!1)}this.currentNavigation=null},t=>t.lift(new $p(s))),Fh(i=>{if(n=!0,(s=i)&&s.ngNavigationCancelingError){const n=hm(i.url);n||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const s=new Kp(t.id,this.serializeUrl(t.extractedUrl),i.message);e.next(s),n?setTimeout(()=>{const e=this.urlHandlingStrategy.merge(i.url,this.rawUrlTree);return this.scheduleNavigation(e,"imperative",null,{skipLocationChange:t.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:t.resolve,reject:t.reject,promise:t.promise})},0):t.resolve(!1)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const n=new qp(t.id,this.serializeUrl(t.extractedUrl),i);e.next(n);try{t.resolve(this.errorHandler(i))}catch(r){t.reject(r)}}var s;return mp}));var s,r,o,a}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const e=this.extractLocationChangeInfoFromEvent(t);this.shouldScheduleNavigation(this.lastLocationChangeInfo,e)&&setTimeout(()=>{const{source:t,state:i,urlTree:n}=e,s={replaceUrl:!0};if(i){const t=Object.assign({},i);delete t.navigationId,0!==Object.keys(t).length&&(s.state=t)}this.scheduleNavigation(n,t,i,s)},0),this.lastLocationChangeInfo=e}))}extractLocationChangeInfoFromEvent(t){var e;return{source:"popstate"===t.type?"popstate":"hashchange",urlTree:this.parseUrl(t.url),state:(null===(e=t.state)||void 0===e?void 0:e.navigationId)?t.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(t,e){if(!t)return!0;const i=e.urlTree.toString()===t.urlTree.toString();return!(e.transitionId===t.transitionId&&i&&("hashchange"===e.source&&"popstate"===t.source||"popstate"===e.source&&"hashchange"===t.source))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){qm(t),this.config=t.map(Wm),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0)}createUrlTree(t,e={}){const{relativeTo:i,queryParams:n,fragment:s,preserveQueryParams:r,queryParamsHandling:o,preserveFragment:a}=e;un()&&r&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");const l=i||this.routerState.root,c=a?this.currentUrlTree.fragment:s;let d=null;if(o)switch(o){case"merge":d=Object.assign(Object.assign({},this.currentUrlTree.queryParams),n);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=n||null}else d=r?this.currentUrlTree.queryParams:n||null;return null!==d&&(d=this.removeEmptyProps(d)),function(t,e,i,n,s){if(0===i.length)return Xg(e.root,e.root,e,n,s);const r=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new tm(!0,0,t);let e=0,i=!1;const n=t.reduce((t,n,s)=>{if("object"==typeof n&&null!=n){if(n.outlets){const e={};return pg(n.outlets,(t,i)=>{e[i]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(n.segmentPath)return[...t,n.segmentPath]}return"string"!=typeof n?[...t,n]:0===s?(n.split("/").forEach((n,s)=>{0==s&&"."===n||(0==s&&""===n?i=!0:".."===n?e++:""!=n&&t.push(n))}),t):[...t,n]},[]);return new tm(i,e,n)}(i);if(r.toRoot())return Xg(e.root,new vg([],{}),e,n,s);const o=function(t,e,i){if(t.isAbsolute)return new em(e.root,!0,0);if(-1===i.snapshot._lastPathIndex){const t=i.snapshot._urlSegment;return new em(t,t===e.root,0)}const n=Yg(t.commands[0])?0:1;return function(t,e,i){let n=t,s=e,r=i;for(;r>s;){if(r-=s,n=n.parent,!n)throw new Error("Invalid number of '../'");s=n.segments.length}return new em(n,!1,s-r)}(i.snapshot._urlSegment,i.snapshot._lastPathIndex+n,t.numberOfDoubleDots)}(r,e,t),a=o.processChildren?nm(o.segmentGroup,o.index,r.commands):im(o.segmentGroup,o.index,r.commands);return Xg(o.segmentGroup,a,e,n,s)}(l,this.currentUrlTree,t,d,c)}navigateByUrl(t,e={skipLocationChange:!1}){un()&&this.isNgZoneEnabled&&!al.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");const i=hm(t)?t:this.parseUrl(t),n=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(n,"imperative",null,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const i=t[e];if(null==i)throw new Error(`The requested path contains ${i} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(i){e=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return e}isActive(t,e){if(hm(t))return mg(this.currentUrlTree,t,e);const i=this.parseUrl(t);return mg(this.currentUrlTree,i,e)}removeEmptyProps(t){return Object.keys(t).reduce((e,i)=>{const n=t[i];return null!=n&&(e[i]=n),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new Hp(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,e,i,n,s){const r=this.getTransition(),o="imperative"!==e&&"imperative"===(null==r?void 0:r.source),a=(this.lastSuccessfulId===r.id||this.currentNavigation?r.rawUrl:r.urlAfterRedirects).toString()===t.toString();if(o&&a)return Promise.resolve(!0);let l,c,d;s?(l=s.resolve,c=s.reject,d=s.promise):d=new Promise((t,e)=>{l=t,c=e});const u=++this.navigationId;return this.setTransition({id:u,source:e,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:n,resolve:l,reject:c,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(t=>Promise.reject(t))}setBrowserUrl(t,e,i,n){const s=this.urlSerializer.serialize(t);n=n||{},this.location.isCurrentPathEqualTo(s)||e?this.location.replaceState(s,"",Object.assign(Object.assign({},n),{navigationId:i})):this.location.go(s,"",Object.assign(Object.assign({},n),{navigationId:i}))}resetStateAndUrl(t,e,i){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}return t.\u0275fac=function(e){return new(e||t)(Kt(Ys),Kt(Vg),Kt(Xm),Kt(Xl),Kt(hr),Kt(Il),Kt(sl),Kt(void 0))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),of=(()=>{class t{constructor(t,e,i){this.router=t,this.route=e,this.locationStrategy=i,this.commands=[],this.onChanges=new A,this.subscription=t.events.subscribe(t=>{t instanceof Hp&&this.updateTargetUrlAndHref()})}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:[]}set preserveQueryParams(t){un()&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead."),this.preserve=t}ngOnChanges(t){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,e,i,n,s){if(0!==t||e||i||n||s)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;const r={skipLocationChange:af(this.skipLocationChange),replaceUrl:af(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,r),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:af(this.preserve),queryParamsHandling:this.queryParamsHandling,preserveFragment:af(this.preserveFragment)})}}return t.\u0275fac=function(e){return new(e||t)(Rr(rf),Rr(Bg),Rr(Ql))},t.\u0275dir=ge({type:t,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(t,e){1&t&&Jr("click",(function(t){return e.onClick(t.button,t.ctrlKey,t.shiftKey,t.altKey,t.metaKey)})),2&t&&(Vo("href",e.href,mn),_r("target",e.target))},inputs:{routerLink:"routerLink",preserveQueryParams:"preserveQueryParams",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state"},features:[_e]}),t})();function af(t){return""===t||!!t}let lf=(()=>{class t{constructor(t,e,i,n,s){this.parentContexts=t,this.location=e,this.resolver=i,this.changeDetector=s,this.activated=null,this._activatedRoute=null,this.activateEvents=new Ra,this.deactivateEvents=new Ra,this.name=n||"primary",t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const i=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),n=this.parentContexts.getOrCreateContext(this.name).children,s=new cf(t,n,this.location.injector);this.activated=this.location.createComponent(i,this.location.length,s),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Xm),Rr(pa),Rr($o),("name",function(t,e){const i=t.attrs;if(i){const t=i.length;let e=0;for(;e<t;){const n=i[e];if(Ui(n))break;if(0===n)e+=2;else if("number"==typeof n)for(e++;e<t&&"string"==typeof i[e];)e++;else{if("name"===n)return i[e+1];e+=2}}}return null}(ii())),Rr(Ws))},t.\u0275dir=ge({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),t})();class cf{constructor(t,e,i){this.route=t,this.childContexts=e,this.parent=i}get(t,e){return t===Bg?this.route:t===Xm?this.childContexts:this.parent.get(t,e)}}class df{}class uf{preload(t,e){return zu(null)}}let hf=(()=>{class t{constructor(t,e,i,n,s){this.router=t,this.injector=n,this.preloadingStrategy=s,this.loader=new Ym(e,i,e=>t.triggerEvent(new Zp(e)),e=>t.triggerEvent(new Xp(e)))}setUpPreloading(){this.subscription=this.router.events.pipe(Wu(t=>t instanceof Hp),Qu(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(Wt);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,e){const i=[];for(const n of e)if(n.loadChildren&&!n.canLoad&&n._loadedConfig){const t=n._loadedConfig;i.push(this.processRoutes(t.module,t.routes))}else n.loadChildren&&!n.canLoad?i.push(this.preloadConfig(t,n)):n.children&&i.push(this.processRoutes(t,n.children));return L(i).pipe(B(),D(t=>{}))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>this.loader.load(t.injector,e).pipe($(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}return t.\u0275fac=function(e){return new(e||t)(Kt(rf),Kt(Il),Kt(sl),Kt(hr),Kt(df))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),pf=(()=>{class t{constructor(t,e,i={}){this.router=t,this.viewportScroller=e,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Bp?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Hp&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof sg&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new sg(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(Kt(rf),Kt(Wc),Kt(void 0))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const gf=new Et("ROUTER_CONFIGURATION"),mf=new Et("ROUTER_FORROOT_GUARD"),ff=[Xl,{provide:Vg,useClass:wg},{provide:rf,useFactory:function(t,e,i,n,s,r,o,a={},l,c){const d=new rf(null,t,e,i,n,s,r,ug(o));if(l&&(d.urlHandlingStrategy=l),c&&(d.routeReuseStrategy=c),a.errorHandler&&(d.errorHandler=a.errorHandler),a.malformedUriErrorHandler&&(d.malformedUriErrorHandler=a.malformedUriErrorHandler),a.enableTracing){const t=Gl();d.events.subscribe(e=>{t.logGroup("Router Event: "+e.constructor.name),t.log(e.toString()),t.log(e),t.logGroupEnd()})}return a.onSameUrlNavigation&&(d.onSameUrlNavigation=a.onSameUrlNavigation),a.paramsInheritanceStrategy&&(d.paramsInheritanceStrategy=a.paramsInheritanceStrategy),a.urlUpdateStrategy&&(d.urlUpdateStrategy=a.urlUpdateStrategy),a.relativeLinkResolution&&(d.relativeLinkResolution=a.relativeLinkResolution),d},deps:[Vg,Xm,Xl,hr,Il,sl,Jm,gf,[class{},new et],[class{},new et]]},Xm,{provide:Bg,useFactory:function(t){return t.routerState.root},deps:[rf]},{provide:Il,useClass:Tl},hf,uf,class{preload(t,e){return e().pipe(Fh(()=>zu(null)))}},{provide:gf,useValue:{enableTracing:!1}}];function vf(){return new Vl("Router",rf)}let bf=(()=>{class t{constructor(t,e){}static forRoot(e,i){return{ngModule:t,providers:[ff,wf(e),{provide:mf,useFactory:Vf,deps:[[rf,new et,new nt]]},{provide:gf,useValue:i||{}},{provide:Ql,useFactory:Cf,deps:[jl,[new tt(Jl),new et],gf]},{provide:pf,useFactory:yf,deps:[rf,Wc,gf]},{provide:df,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:uf},{provide:Vl,multi:!0,useFactory:vf},[Af,{provide:$a,multi:!0,useFactory:Pf,deps:[Af]},{provide:Df,useFactory:kf,deps:[Af]},{provide:za,multi:!0,useExisting:Df}]]}}static forChild(e){return{ngModule:t,providers:[wf(e)]}}}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)(Kt(mf,8),Kt(rf,8))}}),t})();function yf(t,e,i){return i.scrollOffset&&e.setOffset(i.scrollOffset),new pf(t,e,i)}function Cf(t,e,i={}){return i.useHash?new Zl(t,e):new Yl(t,e)}function Vf(t){if(t)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function wf(t){return[{provide:pr,multi:!0,useValue:t},{provide:Jm,multi:!0,useValue:t}]}let Af=(()=>{class t{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new A}appInitializer(){return this.injector.get(Nl,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),i=this.injector.get(rf),n=this.injector.get(gf);if(this.isLegacyDisabled(n)||this.isLegacyEnabled(n))t(!0);else if("disabled"===n.initialNavigation)i.setUpLocationChangeListener(),t(!0);else{if("enabled"!==n.initialNavigation)throw new Error(`Invalid initialNavigation options: '${n.initialNavigation}'`);i.hooks.afterPreactivation=()=>this.initNavigation?zu(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),i.initialNavigation()}return e})}bootstrapListener(t){const e=this.injector.get(gf),i=this.injector.get(hf),n=this.injector.get(pf),s=this.injector.get(rf),r=this.injector.get(Dl);t===r.components[0]&&(this.isLegacyEnabled(e)?s.initialNavigation():this.isLegacyDisabled(e)&&s.setUpLocationChangeListener(),i.setUpPreloading(),n.init(),s.resetRootComponentType(r.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}isLegacyEnabled(t){return"legacy_enabled"===t.initialNavigation||!0===t.initialNavigation||void 0===t.initialNavigation}isLegacyDisabled(t){return"legacy_disabled"===t.initialNavigation||!1===t.initialNavigation}}return t.\u0275fac=function(e){return new(e||t)(Kt(hr))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function Pf(t){return t.appInitializer.bind(t)}function kf(t){return t.bootstrapListener.bind(t)}const Df=new Et("Router Initializer");let Mf=(()=>{class t{constructor(t){this.router=t,this.subject=new A,this.keepAfterNavigationChange=!1,t.events.subscribe(t=>{t instanceof Bp&&(this.keepAfterNavigationChange?this.keepAfterNavigationChange=!1:this.subject.next())})}clear(){this.subject.next()}success(t,e=!1){this.keepAfterNavigationChange=e,this.subject.next({type:"success",text:t})}error(t,e=!1){t||(t="Unknown Error reaching the Server"),this.keepAfterNavigationChange=e,this.subject.next({type:"error",text:t})}getMessage(){return this.subject.asObservable()}}return t.\u0275fac=function(e){return new(e||t)(Kt(rf))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function If(t){return!!t&&(t instanceof b||"function"==typeof t.lift&&"function"==typeof t.subscribe)}class Sf extends u{constructor(t,e){super()}schedule(t,e=0){return this}}class xf extends Sf{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this}requestAsyncId(t,e,i=0){return setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let i=!1,n=void 0;try{this.work(t)}catch(s){i=!0,n=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),n}_unsubscribe(){const t=this.id,e=this.scheduler,i=e.actions,n=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&i.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}class Tf extends xf{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(t,e,i):t.flush(this)}}let _f=(()=>{class t{constructor(e,i=t.now){this.SchedulerAction=e,this.now=i}schedule(t,e=0,i){return new this.SchedulerAction(this,t).schedule(i,e)}}return t.now=()=>Date.now(),t})();class Uf extends _f{constructor(t,e=_f.now){super(t,()=>Uf.delegate&&Uf.delegate!==this?Uf.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,i){return Uf.delegate&&Uf.delegate!==this?Uf.delegate.schedule(t,e,i):super.schedule(t,e,i)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let i;this.active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}class Of extends Uf{}const Ef=new Of(Tf);let Lf=(()=>{class t{constructor(t,e,i){this.kind=t,this.value=e,this.error=i,this.hasValue="N"===t}observe(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}}do(t,e,i){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return i&&i()}}accept(t,e,i){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,i)}toObservable(){switch(this.kind){case"N":return zu(this.value);case"E":return $h(this.error);case"C":return fp()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new t("N",e):t.undefinedValueNotification}static createError(e){return new t("E",void 0,e)}static createComplete(){return t.completeNotification}}return t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t})();class Gf extends g{constructor(t,e,i=0){super(t),this.scheduler=e,this.delay=i}static dispatch(t){const{notification:e,destination:i}=t;e.observe(i),this.unsubscribe()}scheduleMessage(t){this.destination.add(this.scheduler.schedule(Gf.dispatch,this.delay,new Rf(t,this.destination)))}_next(t){this.scheduleMessage(Lf.createNext(t))}_error(t){this.scheduleMessage(Lf.createError(t)),this.unsubscribe()}_complete(){this.scheduleMessage(Lf.createComplete()),this.unsubscribe()}}class Rf{constructor(t,e){this.notification=t,this.destination=e}}class jf extends A{constructor(t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=t<1?1:t,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(t){if(!this.isStopped){const e=this._events;e.push(t),e.length>this._bufferSize&&e.shift()}super.next(t)}nextTimeWindow(t){this.isStopped||(this._events.push(new $f(this._getNow(),t)),this._trimBufferThenGetEvents()),super.next(t)}_subscribe(t){const e=this._infiniteTimeWindow,i=e?this._events:this._trimBufferThenGetEvents(),n=this.scheduler,s=i.length;let r;if(this.closed)throw new C;if(this.isStopped||this.hasError?r=u.EMPTY:(this.observers.push(t),r=new V(this,t)),n&&t.add(t=new Gf(t,n)),e)for(let o=0;o<s&&!t.closed;o++)t.next(i[o]);else for(let o=0;o<s&&!t.closed;o++)t.next(i[o].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),r}_getNow(){return(this.scheduler||Ef).now()}_trimBufferThenGetEvents(){const t=this._getNow(),e=this._bufferSize,i=this._windowTime,n=this._events,s=n.length;let r=0;for(;r<s&&!(t-n[r].time<i);)r++;return s>e&&(r=Math.max(r,s-e)),r>0&&n.splice(0,r),n}}class $f{constructor(t,e){this.time=t,this.value=e}}function Nf(t,e,i){let n;return n=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:i},t=>t.lift(function({bufferSize:t=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:i,scheduler:n}){let s,r,o=0,a=!1,l=!1;return function(c){let d;o++,!s||a?(a=!1,s=new jf(t,e,n),d=s.subscribe(this),r=c.subscribe({next(t){s.next(t)},error(t){a=!0,s.error(t)},complete(){l=!0,r=void 0,s.complete()}}),l&&(r=void 0)):d=s.subscribe(this),this.add(()=>{o--,d.unsubscribe(),d=void 0,r&&!l&&i&&0===o&&(r.unsubscribe(),r=void 0,s=void 0)})}}(n))}class Ff{}let Bf=(()=>{class t extends Ff{getTranslation(t){return zu({})}}return t.\u0275fac=function(e){return Hf(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Hf=nn(Bf);class Kf{}let qf=(()=>{class t{handle(t){return t.key}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function zf(t,e){if(t===e)return!0;if(null===t||null===e)return!1;if(t!=t&&e!=e)return!0;let i,n,s,r=typeof t;if(r==typeof e&&"object"==r){if(!Array.isArray(t)){if(Array.isArray(e))return!1;for(n in s=Object.create(null),t){if(!zf(t[n],e[n]))return!1;s[n]=!0}for(n in e)if(!(n in s)&&void 0!==e[n])return!1;return!0}if(!Array.isArray(e))return!1;if((i=t.length)==e.length){for(n=0;n<i;n++)if(!zf(t[n],e[n]))return!1;return!0}}return!1}function Qf(t){return null!=t}function Wf(t){return t&&"object"==typeof t&&!Array.isArray(t)}class Jf{}let Yf=(()=>{class t extends Jf{constructor(){super(...arguments),this.templateMatcher=/{{\s?([^{}\s]*)\s?}}/g}interpolate(t,e){let i;return i="string"==typeof t?this.interpolateString(t,e):"function"==typeof t?this.interpolateFunction(t,e):t,i}getValue(t,e){let i="string"==typeof e?e.split("."):[e];e="";do{e+=i.shift(),!Qf(t)||!Qf(t[e])||"object"!=typeof t[e]&&i.length?i.length?e+=".":t=void 0:(t=t[e],e="")}while(i.length);return t}interpolateFunction(t,e){return t(e)}interpolateString(t,e){return e?t.replace(this.templateMatcher,(t,i)=>{let n=this.getValue(e,i);return Qf(n)?n:t}):t}}return t.\u0275fac=function(e){return Zf(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Zf=nn(Yf);class Xf{}let tv=(()=>{class t extends Xf{compile(t,e){return t}compileTranslations(t,e){return t}}return t.\u0275fac=function(e){return ev(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const ev=nn(tv);class iv{constructor(){this.currentLang=this.defaultLang,this.translations={},this.langs=[],this.onTranslationChange=new Ra,this.onLangChange=new Ra,this.onDefaultLangChange=new Ra}}const nv=new Et("USE_STORE"),sv=new Et("USE_DEFAULT_LANG"),rv=new Et("DEFAULT_LANGUAGE"),ov=new Et("USE_EXTEND");let av=(()=>{class t{constructor(t,e,i,n,s,r=!0,o=!1,a=!1,l){this.store=t,this.currentLoader=e,this.compiler=i,this.parser=n,this.missingTranslationHandler=s,this.useDefaultLang=r,this.isolate=o,this.extend=a,this.pending=!1,this._onTranslationChange=new Ra,this._onLangChange=new Ra,this._onDefaultLangChange=new Ra,this._langs=[],this._translations={},this._translationRequests={},l&&this.setDefaultLang(l)}get onTranslationChange(){return this.isolate?this._onTranslationChange:this.store.onTranslationChange}get onLangChange(){return this.isolate?this._onLangChange:this.store.onLangChange}get onDefaultLangChange(){return this.isolate?this._onDefaultLangChange:this.store.onDefaultLangChange}get defaultLang(){return this.isolate?this._defaultLang:this.store.defaultLang}set defaultLang(t){this.isolate?this._defaultLang=t:this.store.defaultLang=t}get currentLang(){return this.isolate?this._currentLang:this.store.currentLang}set currentLang(t){this.isolate?this._currentLang=t:this.store.currentLang=t}get langs(){return this.isolate?this._langs:this.store.langs}set langs(t){this.isolate?this._langs=t:this.store.langs=t}get translations(){return this.isolate?this._translations:this.store.translations}set translations(t){this.isolate?this._translations=t:this.store.translations=t}setDefaultLang(t){if(t===this.defaultLang)return;let e=this.retrieveTranslations(t);void 0!==e?(null==this.defaultLang&&(this.defaultLang=t),e.pipe(Up(1)).subscribe(e=>{this.changeDefaultLang(t)})):this.changeDefaultLang(t)}getDefaultLang(){return this.defaultLang}use(t){if(t===this.currentLang)return zu(this.translations[t]);let e=this.retrieveTranslations(t);return void 0!==e?(this.currentLang||(this.currentLang=t),e.pipe(Up(1)).subscribe(e=>{this.changeLang(t)}),e):(this.changeLang(t),zu(this.translations[t]))}retrieveTranslations(t){let e;return(void 0===this.translations[t]||this.extend)&&(this._translationRequests[t]=this._translationRequests[t]||this.getTranslation(t),e=this._translationRequests[t]),e}getTranslation(t){this.pending=!0;const e=this.currentLoader.getTranslation(t).pipe(Nf(1),Up(1));return this.loadingTranslations=e.pipe(D(e=>this.compiler.compileTranslations(e,t)),Nf(1),Up(1)),this.loadingTranslations.subscribe({next:e=>{this.translations[t]=this.extend&&this.translations[t]?Object.assign(Object.assign({},e),this.translations[t]):e,this.updateLangs(),this.pending=!1},error:t=>{this.pending=!1}}),e}setTranslation(t,e,i=!1){e=this.compiler.compileTranslations(e,t),this.translations[t]=(i||this.extend)&&this.translations[t]?function t(e,i){let n=Object.assign({},e);return Wf(e)&&Wf(i)&&Object.keys(i).forEach(s=>{Wf(i[s])?s in e?n[s]=t(e[s],i[s]):Object.assign(n,{[s]:i[s]}):Object.assign(n,{[s]:i[s]})}),n}(this.translations[t],e):e,this.updateLangs(),this.onTranslationChange.emit({lang:t,translations:this.translations[t]})}getLangs(){return this.langs}addLangs(t){t.forEach(t=>{-1===this.langs.indexOf(t)&&this.langs.push(t)})}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResult(t,e,i){let n;if(e instanceof Array){let n={},s=!1;for(let r of e)n[r]=this.getParsedResult(t,r,i),If(n[r])&&(s=!0);return s?Id(e.map(t=>If(n[t])?n[t]:zu(n[t]))).pipe(D(t=>{let i={};return t.forEach((t,n)=>{i[e[n]]=t}),i})):n}if(t&&(n=this.parser.interpolate(this.parser.getValue(t,e),i)),void 0===n&&null!=this.defaultLang&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(n=this.parser.interpolate(this.parser.getValue(this.translations[this.defaultLang],e),i)),void 0===n){let t={key:e,translateService:this};void 0!==i&&(t.interpolateParams=i),n=this.missingTranslationHandler.handle(t)}return void 0!==n?n:e}get(t,e){if(!Qf(t)||!t.length)throw new Error('Parameter "key" required');if(this.pending)return this.loadingTranslations.pipe(Qu(i=>If(i=this.getParsedResult(i,t,e))?i:zu(i)));{let i=this.getParsedResult(this.translations[this.currentLang],t,e);return If(i)?i:zu(i)}}getStreamOnTranslationChange(t,e){if(!Qf(t)||!t.length)throw new Error('Parameter "key" required');return Lp(vp(()=>this.get(t,e)),this.onTranslationChange.pipe(xp(i=>{const n=this.getParsedResult(i.translations,t,e);return"function"==typeof n.subscribe?n:zu(n)})))}stream(t,e){if(!Qf(t)||!t.length)throw new Error('Parameter "key" required');return Lp(vp(()=>this.get(t,e)),this.onLangChange.pipe(xp(i=>{const n=this.getParsedResult(i.translations,t,e);return If(n)?n:zu(n)})))}instant(t,e){if(!Qf(t)||!t.length)throw new Error('Parameter "key" required');let i=this.getParsedResult(this.translations[this.currentLang],t,e);if(If(i)){if(t instanceof Array){let e={};return t.forEach((i,n)=>{e[t[n]]=t[n]}),e}return t}return i}set(t,e,i=this.currentLang){this.translations[i][t]=this.compiler.compile(e,i),this.updateLangs(),this.onTranslationChange.emit({lang:i,translations:this.translations[i]})}changeLang(t){this.currentLang=t,this.onLangChange.emit({lang:t,translations:this.translations[t]}),null==this.defaultLang&&this.changeDefaultLang(t)}changeDefaultLang(t){this.defaultLang=t,this.onDefaultLangChange.emit({lang:t,translations:this.translations[t]})}reloadLang(t){return this.resetLang(t),this.getTranslation(t)}resetLang(t){this._translationRequests[t]=void 0,this.translations[t]=void 0}getBrowserLang(){if("undefined"==typeof window||void 0===window.navigator)return;let t=window.navigator.languages?window.navigator.languages[0]:null;return t=t||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,void 0!==t?(-1!==t.indexOf("-")&&(t=t.split("-")[0]),-1!==t.indexOf("_")&&(t=t.split("_")[0]),t):void 0}getBrowserCultureLang(){if("undefined"==typeof window||void 0===window.navigator)return;let t=window.navigator.languages?window.navigator.languages[0]:null;return t=t||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,t}}return t.\u0275fac=function(e){return new(e||t)(Kt(iv),Kt(Ff),Kt(Xf),Kt(Jf),Kt(Kf),Kt(sv),Kt(nv),Kt(ov),Kt(rv))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),lv=(()=>{class t{constructor(t,e){this.translate=t,this._ref=e,this.value=""}updateValue(t,e,i){let n=e=>{this.value=void 0!==e?e:t,this.lastKey=t,this._ref.markForCheck()};if(i){let s=this.translate.getParsedResult(i,t,e);If(s.subscribe)?s.subscribe(n):n(s)}this.translate.get(t,e).subscribe(n)}transform(t,...e){if(!t||!t.length)return t;if(zf(t,this.lastKey)&&zf(e,this.lastParams))return this.value;let i;if(Qf(e[0])&&e.length)if("string"==typeof e[0]&&e[0].length){let t=e[0].replace(/(\')?([a-zA-Z0-9_]+)(\')?(\s)?:/g,'"$2":').replace(/:(\s)?(\')(.*?)(\')/g,':"$3"');try{i=JSON.parse(t)}catch(n){throw new SyntaxError("Wrong parameter in TranslatePipe. Expected a valid Object, received: "+e[0])}}else"object"!=typeof e[0]||Array.isArray(e[0])||(i=e[0]);return this.lastKey=t,this.lastParams=e,this.updateValue(t,i),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(e=>{this.lastKey&&e.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(t,i,e.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(e=>{this.lastKey&&(this.lastKey=null,this.updateValue(t,i,e.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(t,i))})),this.value}_dispose(){void 0!==this.onTranslationChange&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),void 0!==this.onLangChange&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),void 0!==this.onDefaultLangChange&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}}return t.\u0275fac=function(e){return new(e||t)(Rr(av),function(t=st.Default){const e=Qs(!0);if(null!=e||t&st.Optional)return e;xe("ChangeDetectorRef")}())},t.\u0275pipe=me({name:"translate",type:t,pure:!1}),t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),cv=(()=>{class t{static forRoot(e={}){return{ngModule:t,providers:[e.loader||{provide:Ff,useClass:Bf},e.compiler||{provide:Xf,useClass:tv},e.parser||{provide:Jf,useClass:Yf},e.missingTranslationHandler||{provide:Kf,useClass:qf},iv,{provide:nv,useValue:e.isolate},{provide:sv,useValue:e.useDefaultLang},{provide:ov,useValue:e.extend},{provide:rv,useValue:e.defaultLanguage},av]}}static forChild(e={}){return{ngModule:t,providers:[e.loader||{provide:Ff,useClass:Bf},e.compiler||{provide:Xf,useClass:tv},e.parser||{provide:Jf,useClass:Yf},e.missingTranslationHandler||{provide:Kf,useClass:qf},{provide:nv,useValue:e.isolate},{provide:sv,useValue:e.useDefaultLang},{provide:ov,useValue:e.extend},{provide:rv,useValue:e.defaultLanguage},av]}}}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)}}),t})();const dv=new Uf(xf);function uv(t){const{subscriber:e,counter:i,period:n}=t;e.next(i),this.schedule({subscriber:e,counter:i+1,period:n},n)}function hv(t,e){1&t&&Br(0,"div")}let pv=(()=>{class t{constructor(t,e,i,n,s,r){this.route=t,this.router=e,this.alertService=i,this.authenticationService=n,this.messageService=s,this.translate=r,this.logoutTimer=!0,this.logoutTime=new Date}ngOnInit(){this.logoutTime=new Date,this.logoutTime.setSeconds(this.logoutTime.getSeconds()+100),this.log(`Logout Time Init ${this.logoutTime.toISOString()} `),this.checkLogout()}checkLogout(){(function(t=0,e=dv){var i;return(l(i=t)||!(i-parseFloat(i)+1>=0)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=dv),new b(i=>(i.add(e.schedule(uv,t,{subscriber:i,counter:0,period:t})),i))})(1e4).subscribe(()=>{const t=new Date;let e=this.authenticationService.logoutCheck();e||(e=t);const i=Math.round((e.getTime()-t.getTime())/1e3);if(i>0&&i<=120){const t=this.translate.instant("autologout.msg.sessionExpires",{remaining:i});this.alertService.error(t)}if(i<0){const t=this.translate.instant("autologout.msg.sessionExpired");this.alertService.error(t,!0),this.router.navigate(["login"],{queryParams:{returnUrl:this.router.url}})}})}log(t){this.messageService.add("logoutTimer: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Bg),Rr(rf),Rr(Mf),Rr(op),Rr(jh),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-logouttimer"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(t,e){1&t&&Lr(0,hv,1,0,"div",0),2&t&&jr("ngIf",e.logoutTimer)},directives:[jc],styles:["h2[_ngcontent-%COMP%]{color:red;font-family:Arial,Helvetica,sans-serif;font-weight:lighter}body[_ngcontent-%COMP%]{margin:2em}body[_ngcontent-%COMP%], button[_ngcontent-%COMP%], input[text][_ngcontent-%COMP%]{color:#dc143c;font-family:Cambria,Georgia}button.clear[_ngcontent-%COMP%]{font-family:Arial;background-color:#eee;border:none;padding:5px 10px;border-radius:4px;cursor:pointer;cursor:hand}button[_ngcontent-%COMP%]:hover{background-color:#cfd8dc}button[_ngcontent-%COMP%]:disabled{background-color:#eee;color:#aaa;cursor:auto}button.clear[_ngcontent-%COMP%]{color:#888;margin-bottom:12px}"]}),t})();function gv(t,e){if(1&t&&(Nr(0,"div"),mo(1),Fr()),2&t){const t=e.$implicit;_n(1),vo(" ",t," ")}}function mv(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"h2"),mo(2,"Messages"),Fr(),Nr(3,"button",1),Jr("click",(function(){return ei(t),Xr().messageService.clear()})),mo(4,"clear"),Fr(),Lr(5,gv,2,1,"div",2),Fr()}if(2&t){const t=Xr();_n(5),jr("ngForOf",t.messageService.messages)}}let fv=(()=>{class t{constructor(t){this.messageService=t}ngOnInit(){this.activateMessage=this.messageService.getstatus(),this.messageService.activateMessageToggle.subscribe(()=>{this.activateMessage=this.messageService.getstatus()})}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh))},t.\u0275cmp=le({type:t,selectors:[["app-messages"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"clear",3,"click"],[4,"ngFor","ngForOf"]],template:function(t,e){1&t&&Lr(0,mv,6,1,"div",0),2&t&&jr("ngIf",e.activateMessage)},directives:[jc,Gc],styles:["h2[_ngcontent-%COMP%]{color:red;font-family:Arial,Helvetica,sans-serif;font-weight:lighter}body[_ngcontent-%COMP%]{margin:2em}body[_ngcontent-%COMP%], button[_ngcontent-%COMP%], input[text][_ngcontent-%COMP%]{color:#dc143c;font-family:Cambria,Georgia}button.clear[_ngcontent-%COMP%]{font-family:Arial;background-color:#eee;border:none;padding:5px 10px;border-radius:4px;cursor:pointer;cursor:hand}button[_ngcontent-%COMP%]:hover{background-color:#cfd8dc}button[_ngcontent-%COMP%]:disabled{background-color:#eee;color:#aaa;cursor:auto}button.clear[_ngcontent-%COMP%]{color:#888;margin-bottom:12px}"]}),t})();const vv=function(t,e,i){return{alert:t,"alert-success":e,"alert-danger":i}};function bv(t,e){if(1&t&&(Nr(0,"div",1),mo(1),Fr()),2&t){const t=Xr();jr("ngClass",Ma(2,vv,t.message,"success"===t.message.type,"error"===t.message.type)),_n(1),vo("",t.message.text,"\n")}}let yv=(()=>{class t{constructor(t){this.alertService=t,this.subscription=t.getMessage().subscribe(t=>{this.message=t})}ngOnDestroy(){this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(Rr(Mf))},t.\u0275cmp=le({type:t,selectors:[["app-alert"]],decls:1,vars:1,consts:[["id","alertMessage",3,"ngClass",4,"ngIf"],["id","alertMessage",3,"ngClass"]],template:function(t,e){1&t&&Lr(0,bv,2,6,"div",0),2&t&&jr("ngIf",e.message)},directives:[jc,Ec],encapsulation:2}),t})();function Cv(t,e){1&t&&(Nr(0,"div",26),Br(1,"img",27),Fr())}function Vv(t,e){if(1&t&&(Nr(0,"div",23),Nr(1,"div",24),Br(2,"app-alert"),Lr(3,Cv,2,0,"div",25),Br(4,"router-outlet"),Fr(),Fr()),2&t){const t=Xr();_n(3),jr("ngIf",!t.getPreView())}}function wv(t,e){if(1&t){const t=zr();Nr(0,"i",28),Jr("click",(function(){return ei(t),Xr().switchPreView()})),Fr()}}function Av(t,e){if(1&t){const t=zr();Nr(0,"i",29),Jr("click",(function(){return ei(t),Xr().switchPreView()})),Fr()}}function Pv(t,e){1&t&&(Nr(0,"div",30),Nr(1,"div",31),Nr(2,"a",32),mo(3),Ua(4,"translate"),Fr(),Fr(),Nr(5,"div",31),Nr(6,"a",33),mo(7),Ua(8,"translate"),Fr(),Fr(),Nr(9,"div",31),Nr(10,"a",34),mo(11),Ua(12,"translate"),Fr(),Fr(),Nr(13,"div",31),Nr(14,"a",35),mo(15),Ua(16,"translate"),Fr(),Fr(),Fr()),2&t&&(_n(3),fo(Oa(4,4,"app.support")),_n(4),fo(Oa(8,6,"app.impressum")),_n(4),fo(Oa(12,8,"app.terms")),_n(4),fo(Oa(16,10,"app.dataProtection")))}let kv=(()=>{class t{constructor(t,e,i,n){this.messageService=t,this.authenticationService=e,this.alertService=i,this.translate=n,this.version="21-02",this.restVersionString=new Date,this.restUIVersionString=new Date,this.localsAvailable=!1}ngOnInit(){const t=this.translate.getBrowserLang();this.log("Browser Language: "+t),this.translate.use(t).subscribe(()=>{this.log(`Successfully initialized '${t}' language.'`),this.localsAvailable=!0},()=>{this.log(`Problem with '${t}' language initialization.'`)}),this.restVersion()}restVersion(){this.authenticationService.restVersion().subscribe(t=>{this.log("Version Status check result "+JSON.stringify(t)),t.version&&(this.restVersionString=new Date(t.version)),t.versionUI&&(this.restUIVersionString=new Date(t.versionUI)),this.log(`Version check success ${t.version}/${this.restVersionString} UI ${t.versionUI}/${this.restUIVersionString}`)},t=>{this.log(`Version Status check Failed: ${t.status} ${t.error.message} `),this.alertService.error(Gh(t))})}pwPolicy(){this.authenticationService.initPWPolicy().subscribe(()=>{this.log("Init PW Policy success")},t=>{this.log(`Init PW Policy Failed: ${t.status} ${t.error.message} `),this.alertService.error(Gh(t))})}getPreView(){return Rh()}switchPreView(){return function(){let t=!Rh();return localStorage.setItem("printPreView",t?"1":"0"),console.log("Switch PreView",t),t}()}log(t){this.messageService.add("App: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(op),Rr(Mf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-root"]],decls:43,vars:27,consts:[["id","visboRoot",1,"jumbotron","pt-0","mt-0",2,"background-color","#ffffff"],["class","wrapper",4,"ngIf"],[1,"bg-light","text-dark","mt-3"],[1,"row"],[1,"col-11"],["href","https://visbo.de/",1,"text-secondary"],["data-toggle","modal","data-target","#versionModal"],[1,"col-1"],["class","fas fa-desktop","style","float: right",3,"click",4,"ngIf"],["class","fas fa-print","style","float: right",3,"click",4,"ngIf"],["class","row d-print-none",4,"ngIf"],["id","versionModal","tabindex","-1","role","dialog","aria-labelledby","versionModalTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","versionModalTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group","row"],["for","restServer",1,"col-4","col-form-label"],[1,"col-8","form-control-static",3,"title"],["for","restUIServer",1,"col-4","col-form-label"],[1,"wrapper"],[1,"container-fluid"],["class","ml-3 mt-0","style","float: right",4,"ngIf"],[1,"ml-3","mt-0",2,"float","right"],["src","assets/visbologo.svg"],[1,"fas","fa-desktop",2,"float","right",3,"click"],[1,"fas","fa-print",2,"float","right",3,"click"],[1,"row","d-print-none"],[1,"col"],["href","mailto:support@visbo.de"],["href","https://visbo.de/impressum","target","_blank"],["href","https://visbo.de/visbo-terms-conditions","target","_blank"],["href","https://visbo.de/visbo-data-protection/","target","_blank"]],template:function(t,e){1&t&&(Nr(0,"div",0),Lr(1,Vv,5,1,"div",1),Nr(2,"div",2),Nr(3,"div",3),Nr(4,"div",4),mo(5," Copyright 2021 \xa9 "),Nr(6,"a",5),mo(7,"VISBO GmbH"),Fr(),mo(8,", "),Nr(9,"a",6),mo(10),Ua(11,"translate"),Fr(),Fr(),Nr(12,"div",7),Lr(13,wv,1,0,"i",8),Lr(14,Av,1,0,"i",9),Fr(),Fr(),Lr(15,Pv,17,12,"div",10),Fr(),Br(16,"app-logouttimer"),Br(17,"app-messages"),Nr(18,"div",11),Nr(19,"div",12),Nr(20,"div",13),Nr(21,"div",14),Nr(22,"h5",15),mo(23),Ua(24,"translate"),Fr(),Nr(25,"button",16),Nr(26,"span",17),mo(27,"\xd7"),Fr(),Fr(),Fr(),Nr(28,"div",18),Nr(29,"div",19),Nr(30,"label",20),mo(31),Ua(32,"translate"),Fr(),Nr(33,"label",21),mo(34),Ua(35,"date"),Fr(),Fr(),Nr(36,"div",19),Nr(37,"label",22),mo(38),Ua(39,"translate"),Fr(),Nr(40,"label",21),mo(41),Ua(42,"date"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr(),Fr()),2&t&&(_n(1),jr("ngIf",e.localsAvailable),_n(9),bo("",Oa(11,13,"app.product")," ",e.version,""),_n(3),jr("ngIf",e.getPreView()),_n(1),jr("ngIf",!e.getPreView()),_n(1),jr("ngIf",!e.getPreView()),_n(8),fo(Oa(24,15,"app.versionInfo")),_n(8),vo("",Oa(32,17,"app.serverVersion"),":"),_n(2),to("title",e.restVersionString.toLocaleString()),_n(1),vo("",Ea(35,19,e.restVersionString,"dd.MM.yyyy")," "),_n(4),vo("",Oa(39,22,"app.uiVersion"),":"),_n(2),to("title",e.restVersionString.toLocaleString()),_n(1),vo("",Ea(42,24,e.restUIVersionString,"dd.MM.yyyy")," "))},directives:[jc,pv,fv,yv,lf],pipes:[lv,qc],encapsulation:2}),t})();class Dv{}var Mv=function(t){return t[t.View=1]="View",t[t.ViewAudit=2]="ViewAudit",t[t.ViewLog=4]="ViewLog",t[t.Modify=16]="Modify",t[t.ManagePerm=32]="ManagePerm",t[t.CreateVC=256]="CreateVC",t[t.DeleteVC=1024]="DeleteVC",t}({}),Iv=function(t){return t[t.View=1]="View",t[t.ViewAudit=2]="ViewAudit",t[t.Modify=16]="Modify",t[t.ManagePerm=32]="ManagePerm",t[t.CreateVP=256]="CreateVP",t}({}),Sv=function(t){return t[t.View=1]="View",t[t.ViewAudit=2]="ViewAudit",t[t.Modify=16]="Modify",t[t.ManagePerm=32]="ManagePerm",t[t.CreateVariant=256]="CreateVariant",t[t.ViewRestricted=512]="ViewRestricted",t[t.DeleteVP=1024]="DeleteVP",t}({});class xv{}class Tv{}class _v{}class Uv{}const Ov=new th({"Content-Type":"application/json"});let Ev=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.vcUrl=this.env.restUrl.concat("/vc")}getVisboCenters(t=!1,e=!1){const i=this.vcUrl;let n=new nh;return t&&(n=n.append("sysadmin","1")),e&&(n=n.append("deleted","1")),this.log(`Calling HTTP Request: ${i} `),this.http.get(i,{headers:Ov,params:n}).pipe(D(t=>t.vc),qh(t=>this.log(`fetched ${t.length} VisboCenters `)),Fh(this.handleError("getVisboCenters")))}getSysVisboCenter(){const t=this.vcUrl;let e=new nh;return e=e.append("systemvc","true"),e=e.append("sysadmin","1"),this.log("Calling HTTP Request for SysVC: "+t),this.http.get(t,{headers:Ov,params:e}).pipe(D(t=>(this.log("fetched System VisboCenter "+JSON.stringify(t)),t.vc&&t.vc.length>0&&(t.vc[0].perm=t.perm,this.combinedPerm=t.perm,localStorage.setItem("combinedPerm",JSON.stringify(t.perm)),localStorage.setItem("systemVC",t.vc[0]._id)),t.vc)),qh(t=>{this.log("fetched System VisboCenter user Role is "+(t[0].perm.system||"None"))}),Fh(this.handleError("getSysVisboCenters")))}getSysAdminRole(){let t;return t=void 0===this.combinedPerm?JSON.parse(localStorage.getItem("combinedPerm")):this.combinedPerm,this.log("SysAdmin Role: "+JSON.stringify(t)),t}getSysVCId(){const t=localStorage.getItem("systemVC");return this.log("Sysem VC ID: "+t),t}getVisboCenter(t,e=!1,i=!1){const n=`${this.vcUrl}/${t}`;let s=new nh;return e&&(s=s.append("sysadmin","1")),i&&(s=s.append("deleted","1")),this.log("Calling HTTP Request for a specific entry: "+n),this.http.get(n,{headers:Ov,params:s}).pipe(D(t=>(t.vc[0].perm=t.perm,t.vc[0])),qh(e=>this.log(`fetched VC ${e.name} id:${t} perm:${JSON.stringify(e.perm)}`)),Fh(this.handleError("getVisboCenter id:"+t)))}getCapacity(t,e,i,n=!1,s=!1,r=!1,o=!1,a=!1){const l=`${this.vcUrl}/${t}/capacity`;let c=new nh;return n&&(c=c.append("hierarchy","1")),s&&(c=c.append("pfv","1")),a&&(c=c.append("perProject","1")),r&&(c=c.append("sysadmin","1")),o&&(c=c.append("deleted","1")),i&&(this.log("Calling RoleID: "+i),c=c.append("roleID",i)),this.log(`Calling Capacity for a VC: ${l} params  ${JSON.stringify(c)}`),this.http.get(l,{headers:Ov,params:c}).pipe(D(t=>(t.vc[0].perm=t.perm,t.vc[0])),qh(e=>this.log(`fetched Capacity for VC ${e.name} id:${t} perm:${JSON.stringify(e.perm)}`)),Fh(this.handleError("getVisboCenter id:"+t)))}addVisboCenter(t){const e=this.vcUrl;let i=new nh;return i=i.append("sysadmin","1"),this.log(`Calling HTTP Request: ${e} ${JSON.stringify(t)}`),this.http.post(e,t,{headers:Ov,params:i}).pipe(D(t=>t.vc[0]),qh(t=>this.log(`added VisboCenter ${t.name} with id=${t._id}`)),Fh(this.handleError("addVisboCenter")))}deleteVisboCenter(t,e=!1,i=!1){const n=t._id,s=`${this.vcUrl}/${n}`;let r=new nh;return e&&(r=r.append("sysadmin","1")),i&&(r=r.append("deleted","1")),this.log(`Calling HTTP Request: ${s} `),this.http.delete(s,{headers:Ov,params:r}).pipe(qh(()=>this.log("deleted VisboCenter id="+n)),Fh(this.handleError("deleteVisboCenter")))}updateVisboCenter(t,e=!1,i=!1){const n=`${this.vcUrl}/${t._id}`;let s=new nh;return e&&(s=s.append("sysadmin","1")),i&&(s=s.append("deleted","1")),this.log(`Calling HTTP Request PUT: ${n} `),this.http.put(n,t,{headers:Ov,params:s}).pipe(D(t=>t.vc[0]),qh(t=>this.log(`updated VisboCenter ${t.name} with id=${t._id}`)),Fh(this.handleError("updateVisboCenter")))}getVCUsers(t,e=!1,i=!1){const n=`${this.vcUrl}/${t}/group?userlist=1`;let s=new nh;return e&&(s=s.append("sysadmin","1")),i&&(s=s.append("deleted","1")),this.log(`Calling HTTP Request GET Users: ${n} `),this.http.get(n,{headers:Ov,params:s}).pipe(D(t=>{const e=new Uv;return e.users=t.users,e.groups=t.groups,e.vpusers=t.vpusers,e}),qh(()=>this.log("fetched Users & Groups Users ")),Fh(this.handleError("getVisboCenterUsers")))}addVCUser(t,e,i,n,s){const r=`${this.vcUrl}/${n}/group/${e}/user`;let o=new nh;s&&(o=o.append("sysadmin","1"));const a={email:t,message:i||""};return this.log(`Calling HTTP Request: ${r} for ${t} `),this.http.post(r,a,{headers:Ov,params:o}).pipe(D(t=>t.groups[0]),qh(t=>this.log("added Visbo User to Group with id="+t._id)),Fh(this.handleError("addVCUser")))}deleteVCUser(t,e,i){const n=`${this.vcUrl}/${e}/group/${t.groupId}/user/${t.userId}`;let s=new nh;return i&&(s=s.append("sysadmin","1")),this.log(`Calling HTTP Request: ${n} for ${t.email} as ${t.groupName} `),this.http.delete(n,{headers:Ov,params:s}).pipe(qh(()=>this.log("deleted Visbo Center User "+t.email)),Fh(this.handleError("deleteVisboCenterUser")))}addVCGroup(t,e){const i=`${this.vcUrl}/${t.vcid}/group`;let n=new nh;return e&&(n=n.append("sysadmin","1")),this.log(`Calling HTTP Request: ${i} for ${t.name} `),this.http.post(i,t,{headers:Ov,params:n}).pipe(D(t=>t.groups[0]),qh(t=>this.log("added Visbo Group with id="+t._id)),Fh(this.handleError("addVCGroup")))}modifyVCGroup(t,e){const i=`${this.vcUrl}/${t.vcid}/group/${t._id}`;let n=new nh;return e&&(n=n.append("sysadmin","1")),this.log(`Calling HTTP Request: ${i} for ${t.name} Perm: ${JSON.stringify(t.permission)} `),this.http.put(i,t,{headers:Ov,params:n}).pipe(D(t=>t.groups[0]),qh(t=>this.log("modified Visbo Group with id="+JSON.stringify(t))),Fh(this.handleError("addVCGroup")))}deleteVCGroup(t,e){const i=`${this.vcUrl}/${t.vcid}/group/${t._id}`;let n=new nh;return e&&(n=n.append("sysadmin","1")),this.log(`Calling HTTP Request: ${i} for Group ${t.name} `),this.http.delete(i,{headers:Ov,params:n}).pipe(qh(()=>this.log("deleted Visbo Center Group "+t.name)),Fh(this.handleError("deleteVisboCenterGroup")))}handleError(t="operation"){return this.log(`HTTP Request ${t} failed`),e=>(this.log(`HTTP Request ${t} failed: ${e.error.message} status:${e.status}`),$h(e))}log(t){this.messageService.add("VisboCenterService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(jh),Kt(sp))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function Lv(t,e){1&t&&(Nr(0,"div",23),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"login.msg.emailRequired")))}function Gv(t,e){1&t&&(Nr(0,"div",24),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"login.msg.pwRequired")))}function Rv(t,e){1&t&&Br(0,"img",25)}function jv(t,e){1&t&&(Nr(0,"a",26),mo(1),Ua(2,"translate"),Fr()),2&t&&(to("href",Xr().loginGoogleUrl(),mn),_n(1),fo(Oa(2,2,"login.btn.loginGoogle")))}const $v=function(t){return{"has-error":t}};let Nv=(()=>{class t{constructor(t,e,i,n,s,r,o,a){this.route=t,this.router=e,this.messageService=i,this.authenticationService=n,this.visbocenterService=s,this.alertService=r,this.translate=o,this.titleService=a,this.loading=!1,this.currentLang="en"}ngOnInit(){this.authenticationService.logout(),this.getSetting(),this.log(`current Language ${this.translate.currentLang} getLangs() ${JSON.stringify(this.translate.getLangs())}`),this.currentLang=this.translate.currentLang,this.titleService.setTitle(this.translate.instant("login.title")),this.route.snapshot.queryParams.email&&(this.email=this.route.snapshot.queryParams.email);const t=(this.route.snapshot.queryParams.returnUrl||"/").split("?");this.returnUrl=t[0],this.returnParams=t[1],this.log(`return url ${this.returnUrl} params ${this.returnParams}`)}restVersion(){this.restVersionString||this.authenticationService.restVersion().subscribe(t=>{this.restVersionString=t.version.toISOString(),this.log("Version Status check success "+this.restVersionString)},t=>{this.log(`Version Status check Failed: ${t.status} ${t.error.message} `),this.alertService.error(Gh(t))})}login(){this.loading=!0,this.authenticationService.login(this.email,this.userpw).subscribe(t=>{if(t.status&&t.status.expiresAt){const e=new Date(t.status.expiresAt);this.log("Login Success BUT EXPIRATION at: "+e.toLocaleString());const i=this.translate.instant("autologout.msg.pwExpires",{expiresAt:e.toLocaleString()});this.alertService.error(i,!0)}else{const e=new Date(t.status.lastLoginAt),i=this.translate.instant("login.msg.loginSuccess",{lastLogin:e.toLocaleString()});this.alertService.success(i,!0)}this.visbocenterService.getSysVisboCenter().subscribe(()=>{this.log(`Login Success ${this.returnUrl} Role ${JSON.stringify(this.visbocenterService.getSysAdminRole())} `),this.router.navigate([this.returnUrl],{replaceUrl:!0,queryParams:this.queryStringToJSON(this.returnParams)})},t=>{this.log(`No SysVC found:  ${t.status} ${t.error.message}`),this.router.navigate(["/"],{replaceUrl:!0})})},t=>{this.log(`Login Failed: ${t.status} ${t.error.message} `);let e=Gh(t);403===t.status&&(e=this.translate.instant("login.msg.loginFailure",{user:this.email})),this.alertService.error(e),this.loading=!1})}loginGoogleUrl(){return this.authenticationService.loginGoogleUrl()}loginGoogle(){this.loading=!0,console.log("GoogleLogin Start "),this.authenticationService.loginGoogle().subscribe(t=>{console.log(`Google Login Success ${this.returnUrl} Role ${JSON.stringify(t)} `),this.log("Google Login Success Result "+JSON.stringify(t));const e=new Date(t.status.lastLoginAt),i=this.translate.instant("login.msg.loginSuccess",{lastLogin:e.toLocaleString()});this.alertService.success(i,!0),this.visbocenterService.getSysVisboCenter().subscribe(()=>{this.log(`Login Success ${this.returnUrl} Role ${JSON.stringify(this.visbocenterService.getSysAdminRole())} `),this.router.navigate([this.returnUrl],{replaceUrl:!0,queryParams:this.queryStringToJSON(this.returnParams)})},t=>{this.log(`No SysVC found:  ${t.status} ${t.error.message}`),this.router.navigate(["/"],{replaceUrl:!0})})},t=>{this.log(`Google Login Failed: ${t.status} ${t.error.message} `);let e=Gh(t);403===t.status&&(e=this.translate.instant("login.msg.loginFailure",{user:this.email})),this.alertService.error(e),this.loading=!1})}pwforgotten(){const t=(this.email||"").trim();this.log(`Forward to password forgotten ${t} `),this.router.navigate(["pwforgotten"],{queryParams:{email:t}})}register(){this.log("Forward to Register"),this.router.navigate(["register"])}relogin(){this.authenticationService.logout(),this.log("reLogin after error 401 to URL "+this.route.snapshot.queryParams.returnUrl),this.returnUrl=this.route.snapshot.queryParams.returnUrl||"/"}useLanguage(t){this.translate.use(t)}queryStringToJSON(t){const e=(t||"").split("&"),i={};return e.forEach((function(t){const e=t.split("=");e[0]&&(i[e[0]]=e[1]||"")})),i}hasSetting(t){let e=void 0;if(t&&this.setting){const i=this.setting.find(e=>e.name==t);i&&(e=i.value)}return e}getSetting(){this.authenticationService.getSetting().subscribe(t=>{this.log("ReST Server Setting success "+JSON.stringify(t)),this.setting=t},t=>{this.log(`Init Settings Failed: ${t.status} ${t.error.message} `),this.alertService.error(Gh(t))})}log(t){this.messageService.add("Login: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Bg),Rr(rf),Rr(jh),Rr(op),Rr(Ev),Rr(Mf),Rr(av),Rr(Md))},t.\u0275cmp=le({type:t,selectors:[["app-login"]],decls:43,vars:38,consts:[[1,"well"],[1,"d-flex","flex-row-reverse"],["name","currentLang",3,"ngModel","ngModelChange","change"],["value","en"],["value","de"],[1,"col-md-6","col-md-offset-3"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group",3,"ngClass"],["for","username"],["id","loginName","type","text","name","username","required","","pattern","[^@\\s]+@[^@\\s]+\\.[^@\\s]+",1,"form-control",3,"ngModel","ngModelChange"],["username","ngModel"],["id","loginNameError","class","help-block",4,"ngIf"],["for","password"],["id","loginPW","type","password","name","password","required","",1,"form-control",3,"ngModel","ngModelChange"],["password","ngModel"],["id","loginPWError","class","help-block",4,"ngIf"],[1,"form-group"],["id","loginButtonLogin",1,"btn","btn-primary",3,"disabled"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==",4,"ngIf"],["class","btn btn-link","style","float: right",3,"href",4,"ngIf"],["id","loginButtonRegister",1,"btn","btn-link",3,"click"],["id","loginButtonPWForgotten",1,"btn","btn-link",3,"click"],["id","loginNameError",1,"help-block"],["id","loginPWError",1,"help-block"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="],[1,"btn","btn-link",2,"float","right",3,"href"]],template:function(t,e){if(1&t){const t=zr();Nr(0,"div",0),Nr(1,"h2"),mo(2),Ua(3,"translate"),Fr(),Br(4,"br"),Nr(5,"div",1),Nr(6,"select",2),Jr("ngModelChange",(function(t){return e.currentLang=t}))("change",(function(){return e.useLanguage(e.currentLang)})),Nr(7,"option",3),mo(8),Ua(9,"translate"),Fr(),Nr(10,"option",4),mo(11),Ua(12,"translate"),Fr(),Fr(),Fr(),Nr(13,"div",5),Nr(14,"form",6,7),Jr("ngSubmit",(function(){return ei(t),Gr(15).form.valid&&e.login()})),Nr(16,"div",8),Nr(17,"label",9),mo(18),Ua(19,"translate"),Fr(),Nr(20,"input",10,11),Jr("ngModelChange",(function(t){return e.email=t})),Fr(),Lr(22,Lv,3,3,"div",12),Fr(),Nr(23,"div",8),Nr(24,"label",13),mo(25),Ua(26,"translate"),Fr(),Nr(27,"input",14,15),Jr("ngModelChange",(function(t){return e.userpw=t})),Fr(),Lr(29,Gv,3,3,"div",16),Fr(),Nr(30,"div",17),Nr(31,"button",18),mo(32),Ua(33,"translate"),Fr(),Lr(34,Rv,1,0,"img",19),Lr(35,jv,3,4,"a",20),Fr(),Fr(),Fr(),Nr(36,"div"),Nr(37,"button",21),Jr("click",(function(){return e.register()})),mo(38),Ua(39,"translate"),Fr(),Nr(40,"button",22),Jr("click",(function(){return e.pwforgotten()})),mo(41),Ua(42,"translate"),Fr(),Fr(),Fr()}if(2&t){const t=Gr(15),i=Gr(21),n=Gr(28);_n(2),fo(Oa(3,18,"login.title")),_n(4),jr("ngModel",e.currentLang),_n(2),fo(Oa(9,20,"language.en")),_n(3),fo(Oa(12,22,"language.de")),_n(5),jr("ngClass",ka(34,$v,t.submitted&&!i.valid)),_n(2),fo(Oa(19,24,"login.lbl.email")),_n(2),jr("ngModel",e.email),_n(2),jr("ngIf",t.submitted&&!i.valid),_n(1),jr("ngClass",ka(36,$v,t.submitted&&!n.valid)),_n(2),fo(Oa(26,26,"login.lbl.password")),_n(2),jr("ngModel",e.userpw),_n(2),jr("ngIf",t.submitted&&!n.valid),_n(2),jr("disabled",e.loading),_n(1),fo(Oa(33,28,"login.btn.login")),_n(2),jr("ngIf",e.loading),_n(1),jr("ngIf",e.hasSetting("OAuthGoogle")),_n(3),fo(Oa(39,30,"login.btn.register")),_n(3),fo(Oa(42,32,"login.btn.pwForgotten"))}},directives:[cu,Nd,Ou,du,gu,Eu,Fd,Tu,Ec,Ed,Ru,Hu,jc],pipes:[lv],encapsulation:2}),t})();function Fv(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"h4"),mo(2),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo(" ",t.user.email," ")}}function Bv(t,e){1&t&&(Nr(0,"div",38),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"register.msg.firstNameRequired")))}function Hv(t,e){1&t&&(Nr(0,"div",38),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"register.msg.lastNameRequired")))}function Kv(t,e){1&t&&(Nr(0,"div",38),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"register.msg.companyRequired")))}function qv(t,e){1&t&&(Nr(0,"div",38),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"register.msg.emailRequired")))}const zv=function(t){return{"has-error":t}};function Qv(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div",5),Nr(2,"label",39),mo(3),Ua(4,"translate"),Fr(),Nr(5,"input",40,41),Jr("ngModelChange",(function(e){return ei(t),Xr(2).user.email=e})),Fr(),Lr(7,qv,3,3,"div",9),Fr(),Fr()}if(2&t){const t=Gr(6);Xr();const e=Gr(1),i=Xr();_n(1),jr("ngClass",ka(6,zv,e.submitted&&!t.valid)),_n(2),fo(Oa(4,4,"register.lbl.email")),_n(2),jr("ngModel",i.user.email),_n(2),jr("ngIf",e.submitted&&!t.valid)}}function Wv(t,e){1&t&&(Nr(0,"div",38),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"register.msg.followPolicy")))}function Jv(t,e){if(1&t&&(Nr(0,"div",38),mo(1),Fr()),2&t){const t=Xr(2);_n(1),fo(t.PWPolicyDescription)}}function Yv(t,e){1&t&&Br(0,"img",42)}const Zv=function(){return["/login"]};function Xv(t,e){if(1&t){const t=zr();Nr(0,"form",2,3),Jr("ngSubmit",(function(){ei(t);const e=Gr(1),i=Xr();return e.form.valid&&i.register()})),Lr(2,Fv,3,1,"div",4),Nr(3,"div",5),Nr(4,"label",6),mo(5),Ua(6,"translate"),Fr(),Nr(7,"input",7,8),Jr("ngModelChange",(function(e){return ei(t),Xr().user.profile.firstName=e})),Fr(),Lr(9,Bv,3,3,"div",9),Fr(),Nr(10,"div",5),Nr(11,"label",10),mo(12),Ua(13,"translate"),Fr(),Nr(14,"input",11,12),Jr("ngModelChange",(function(e){return ei(t),Xr().user.profile.lastName=e})),Fr(),Lr(16,Hv,3,3,"div",9),Fr(),Nr(17,"div",13),Nr(18,"label",14),mo(19),Ua(20,"translate"),Fr(),Nr(21,"input",15,16),Jr("ngModelChange",(function(e){return ei(t),Xr().user.profile.company=e})),Fr(),Lr(23,Kv,3,3,"div",9),Fr(),Nr(24,"div",13),Nr(25,"label",17),mo(26),Ua(27,"translate"),Fr(),Nr(28,"input",18,19),Jr("ngModelChange",(function(e){return ei(t),Xr().user.profile.phone=e})),Fr(),Fr(),Lr(30,Qv,8,8,"div",4),Nr(31,"div",5),Nr(32,"label",20),mo(33),Ua(34,"translate"),Fr(),Nr(35,"input",21,22),Jr("ngModelChange",(function(e){return ei(t),Xr().user.password=e})),Fr(),Lr(37,Wv,3,3,"div",9),Lr(38,Jv,2,1,"div",9),Fr(),Nr(39,"form",23,24),Nr(41,"div"),mo(42),Ua(43,"translate"),Fr(),Nr(44,"div",25),Nr(45,"input",26,27),Jr("ngModelChange",(function(e){return ei(t),Xr().check_TOU=e})),Fr(),Br(47,"label",28),Nr(48,"a",29),mo(49),Ua(50,"translate"),Fr(),Fr(),Nr(51,"div",30),Nr(52,"input",31,32),Jr("ngModelChange",(function(e){return ei(t),Xr().check_DP=e})),Fr(),Br(54,"label",33),Nr(55,"a",34),mo(56),Ua(57,"translate"),Fr(),Fr(),Fr(),Nr(58,"div",13),Nr(59,"button",35),mo(60),Ua(61,"translate"),Fr(),Lr(62,Yv,1,0,"img",36),Nr(63,"a",37),mo(64),Ua(65,"translate"),Fr(),Fr(),Fr()}if(2&t){const t=Gr(1),e=Gr(8),i=Gr(15),n=Gr(22),s=Gr(36),r=Xr();_n(2),jr("ngIf",r.user._id),_n(1),jr("ngClass",ka(51,zv,t.submitted&&!e.valid)),_n(2),fo(Oa(6,31,"register.lbl.firstName")),_n(2),jr("ngModel",r.user.profile.firstName),_n(2),jr("ngIf",t.submitted&&!e.valid),_n(1),jr("ngClass",ka(53,zv,t.submitted&&!i.valid)),_n(2),fo(Oa(13,33,"register.lbl.lastName")),_n(2),jr("ngModel",r.user.profile.lastName),_n(2),jr("ngIf",t.submitted&&!i.valid),_n(3),fo(Oa(20,35,"register.lbl.company")),_n(2),jr("ngModel",r.user.profile.company),_n(2),jr("ngIf",t.submitted&&!n.valid),_n(3),fo(Oa(27,37,"register.lbl.phone")),_n(2),jr("ngModel",r.user.profile.phone),_n(2),jr("ngIf",!r.user._id),_n(1),jr("ngClass",ka(55,zv,t.submitted&&!s.valid)),_n(1),eo("title","Password Rule: ",r.PWPolicyDescription,""),_n(1),vo(" ",Oa(34,39,"register.lbl.password")," (*) "),_n(2),to("pattern",r.PWPolicy),jr("ngModel",r.user.password),_n(2),jr("ngIf",!s.valid),_n(1),jr("ngIf",!s.valid&&r.PWPolicyDescription),_n(4),fo(Oa(43,41,"register.titleTC")),_n(3),jr("ngModel",r.check_TOU),_n(4),fo(Oa(50,43,"register.lbl.acceptTC")),_n(3),jr("ngModel",r.check_DP),_n(4),fo(Oa(57,45,"register.lbl.acceptDP")),_n(4),fo(Oa(61,47,"register.btn.register")),_n(2),jr("ngIf",r.loading),_n(1),jr("routerLink",Pa(57,Zv)),_n(1),fo(Oa(65,49,"register.btn.cancel"))}}let tb=(()=>{class t{constructor(t,e,i,n,s,r){this.messageService=t,this.route=e,this.router=i,this.authenticationService=n,this.alertService=s,this.translate=r,this.hash=void 0,this.loading=!1}ngOnInit(){this.getPWPolicy();const t=this.route.snapshot.paramMap.get("id");if(this.hash=this.route.snapshot.queryParams.hash,t)this.getUser(t,this.hash);else{const t=new Xh;t.profile=new Jh,t.status=new Yh,this.user=t}this.log(`Register for User ${t} hash ${this.hash}`)}register(){if(this.check_DP&&this.check_TOU)this.loading=!0,this.log("Call register Service "+JSON.stringify(this.user)),this.authenticationService.createUser(this.user,this.hash).subscribe(t=>{if(this.hash){const e=this.translate.instant("register.msg.registerSuccess",{email:t.email});this.alertService.success(e,!0)}else{const e=this.translate.instant("register.msg.registerSuccessConfirm",{email:t.email});this.alertService.success(e,!0)}this.router.navigate(["login"])},t=>{this.log("Error during Create User "+t.error.message),this.alertService.error(Gh(t)),this.loading=!1});else{const t=this.translate.instant("register.msg.confirmDP_TOU");this.alertService.error(t,!1)}}getUser(t,e){this.authenticationService.getUser(t,e).subscribe(t=>{this.log("Init Signup User success "+JSON.stringify(t)),t.profile||(t.profile=new Jh),this.user=t},t=>{this.log(`Init Signup User Failed: ${t.status} ${t.error.message} `),this.alertService.error(Gh(t))})}getPWPolicy(){this.authenticationService.initPWPolicy().subscribe(t=>{this.log("Init PW Policy success "+JSON.stringify(t)),this.PWPolicy=t.PWPolicy,this.PWPolicyDescription=t.Description},t=>{this.log(`Init PW Policy Failed: ${t.status} ${t.error.message} `),this.alertService.error(Gh(t))})}log(t){this.messageService.add("Register: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(Bg),Rr(rf),Rr(op),Rr(Mf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-register"]],decls:5,vars:4,consts:[[1,"col-md-6","col-md-offset-3"],["name","form","novalidate","",3,"ngSubmit",4,"ngIf"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[4,"ngIf"],[1,"form-group",3,"ngClass"],["for","firstName"],["type","text","name","firstName","required","","autocomplete","on",1,"form-control",3,"ngModel","ngModelChange"],["firstName","ngModel"],["class","help-block",4,"ngIf"],["for","lastName"],["type","text","name","lastName","required","","autocomplete","on",1,"form-control",3,"ngModel","ngModelChange"],["lastName","ngModel"],[1,"form-group"],["for","company"],["type","text","name","company","required","","autocomplete","on",1,"form-control",3,"ngModel","ngModelChange"],["company","ngModel"],["for","phone"],["type","text","name","phone",1,"form-control",3,"ngModel","ngModelChange"],["phone","ngModel"],["for","password-new","data-toggle","tooltip","data-placement","top","data-delay","50",3,"title"],["type","password","name","password-new","required","","autocomplete","off",1,"form-control",3,"ngModel","pattern","ngModelChange"],["password","ngModel"],["name","legal","novalidate",""],["fLegal","ngForm"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","IDcheckTOU","name","checkTOU","required","",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkTOU","ngModel"],["for","IDcheckTOU",1,"custom-control-label"],["href","https://visbo.de/visbo-terms-conditions","target","_blank"],[1,"custom-control","custom-checkbox","mb-3"],["type","checkbox","id","IDcheckDP","name","checkDP","required","",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkDP","ngModel"],["for","IDcheckDP",1,"custom-control-label"],["href","https://visbo.de/visbo-data-protection","target","_blank"],["type","submit",1,"btn","btn-primary"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==",4,"ngIf"],[1,"btn","btn-link",3,"routerLink"],[1,"help-block"],["for","username"],["type","email","name","username","required","","pattern","[^@\\s]+@[^@\\s]+\\.[^@\\s]+","required","","autocomplete","on",1,"form-control",3,"ngModel","ngModelChange"],["username","ngModel"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="]],template:function(t,e){1&t&&(Nr(0,"div",0),Nr(1,"h2"),mo(2),Ua(3,"translate"),Fr(),Lr(4,Xv,66,58,"form",1),Fr()),2&t&&(_n(2),fo(Oa(3,2,"register.title")),_n(2),jr("ngIf",e.user))},directives:[jc,Eu,Fd,Tu,Ec,Ed,Ru,Nd,Ou,Hu,ju,_d,of],pipes:[lv],styles:[""]}),t})();const eb=function(){return["/login"]};let ib=(()=>{class t{constructor(t,e,i,n,s,r){this.messageService=t,this.router=e,this.route=i,this.authenticationService=n,this.alertService=s,this.translate=r}ngOnInit(){const t=this.route.snapshot.queryParams.hash,e=this.route.snapshot.queryParams.id;this.log(`Init Register Confirm userid ${e} Token ${t}`),this.authenticationService.registerconfirm(e,t).subscribe(()=>{this.log("Register Confirm Success");const t=this.translate.instant("registerConfirm.msg.registerSuccess");this.alertService.success(t,!0),this.router.navigate(["login"])},t=>{this.log("Error during Register Confirm "+t.error.message),this.alertService.error(Gh(t)),this.router.navigate(["login"])})}log(t){this.messageService.add("Register Confirm: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(rf),Rr(Bg),Rr(op),Rr(Mf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-registerconfirm"]],decls:12,vars:8,consts:[[1,"col-md-6","col-md-offset-3"],["name","form","novalidate",""],["f","ngForm"],[1,"form-group"],[1,"btn","btn-link",3,"routerLink"]],template:function(t,e){1&t&&(Nr(0,"div",0),Nr(1,"h2"),mo(2),Ua(3,"translate"),Fr(),Nr(4,"form",1,2),Nr(6,"p"),mo(7),Ua(8,"translate"),Fr(),Nr(9,"div",3),Nr(10,"a",4),mo(11,"Cancel"),Fr(),Fr(),Fr(),Fr()),2&t&&(_n(2),fo(Oa(3,3,"registerConfirm.title")),_n(5),vo(" ",Oa(8,5,"registerConfirm.description")," This is an inbetween page without specific content, you should get redirected to login. If not please use the button below. "),_n(3),jr("routerLink",Pa(7,eb)))},directives:[Eu,Fd,Tu,of],pipes:[lv],styles:[""]}),t})();const nb=function(){return["/login"]};let sb=(()=>{class t{constructor(t,e,i,n,s,r){this.messageService=t,this.router=e,this.route=i,this.authenticationService=n,this.alertService=s,this.translate=r}ngOnInit(){const t=this.route.snapshot.queryParams.hash;console.log("Init OAuth Confirm Hash "+t),this.authenticationService.oauthconfirm(t),console.log("OAuth Confirm Success");const e=this.translate.instant("oauthconfirm.msg.loginSuccess");this.alertService.success(e,!0),this.router.navigate(["/"])}log(t){this.messageService.add("OAuth Confirm: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(rf),Rr(Bg),Rr(op),Rr(Mf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-oauthconfirm"]],decls:12,vars:8,consts:[[1,"col-md-6","col-md-offset-3"],["name","form","novalidate",""],["f","ngForm"],[1,"form-group"],[1,"btn","btn-link",3,"routerLink"]],template:function(t,e){1&t&&(Nr(0,"div",0),Nr(1,"h2"),mo(2),Ua(3,"translate"),Fr(),Nr(4,"form",1,2),Nr(6,"p"),mo(7),Ua(8,"translate"),Fr(),Nr(9,"div",3),Nr(10,"a",4),mo(11,"Cancel"),Fr(),Fr(),Fr(),Fr()),2&t&&(_n(2),fo(Oa(3,3,"oauthconfirm.title")),_n(5),vo(" ",Oa(8,5,"oauthconfirm.description")," This is an inbetween page without specific content, you should get redirected to login. If not please use the button below. "),_n(3),jr("routerLink",Pa(7,nb)))},directives:[Eu,Fd,Tu,of],pipes:[lv],styles:[""]}),t})(),rb=(()=>{class t{constructor(t){this.router=t}canActivate(t,e){return!!localStorage.getItem("currentUser")||(this.router.navigate(["login"],{queryParams:{returnUrl:e.url}}),!1)}}return t.\u0275fac=function(e){return new(e||t)(Kt(rf))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function ob(t,e){1&t&&(Nr(0,"div",12),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"pwForgotten.msg.emailRequired")))}function ab(t,e){1&t&&Br(0,"img",13)}const lb=function(t){return{"has-error":t}},cb=function(){return["/login"]};let db=(()=>{class t{constructor(t,e,i,n,s,r){this.messageService=t,this.route=e,this.router=i,this.authenticationService=n,this.alertService=s,this.translate=r,this.loading=!1}ngOnInit(){this.user=new Xh,this.route.snapshot.queryParams.email&&(this.user.email=this.route.snapshot.queryParams.email),this.log("Password Forgotten for User "+this.user.email)}pwforgotten(){this.loading=!0,this.authenticationService.pwforgotten(this.user).subscribe(()=>{this.alertService.success("Password Forgotten Request successful. Please check your Mail to continue.",!0),this.router.navigate(["login"])},t=>{this.log("Error during Password Forgotten "+t.error.message),this.alertService.error(Gh(t),!0),this.loading=!1})}log(t){this.messageService.add("PW Forgotten: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(Bg),Rr(rf),Rr(op),Rr(Mf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-pwforgotten"]],decls:21,vars:21,consts:[[1,"col-md-6","col-md-offset-3"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group",3,"ngClass"],["for","username"],["type","text","name","username","required","",1,"form-control",3,"ngModel","ngModelChange"],["username","ngModel"],["class","help-block",4,"ngIf"],[1,"form-group"],[1,"btn","btn-primary",3,"disabled"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==",4,"ngIf"],[1,"btn","btn-link",3,"routerLink"],[1,"help-block"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="]],template:function(t,e){if(1&t){const t=zr();Nr(0,"div",0),Nr(1,"h2"),mo(2),Ua(3,"translate"),Fr(),Nr(4,"form",1,2),Jr("ngSubmit",(function(){return ei(t),Gr(5).form.valid&&e.pwforgotten()})),Nr(6,"div",3),Nr(7,"label",4),mo(8),Ua(9,"translate"),Fr(),Nr(10,"input",5,6),Jr("ngModelChange",(function(t){return e.user.email=t})),Fr(),Lr(12,ob,3,3,"div",7),Fr(),Nr(13,"div",8),Nr(14,"button",9),mo(15),Ua(16,"translate"),Fr(),Lr(17,ab,1,0,"img",10),Nr(18,"a",11),mo(19),Ua(20,"translate"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Gr(5),i=Gr(11);_n(2),fo(Oa(3,10,"pwForgotten.title")),_n(4),jr("ngClass",ka(18,lb,t.submitted&&!i.valid)),_n(2),fo(Oa(9,12,"pwForgotten.lbl.email")),_n(2),jr("ngModel",e.user.email),_n(2),jr("ngIf",t.submitted&&!i.valid),_n(2),jr("disabled",e.loading),_n(1),fo(Oa(16,14,"pwForgotten.btn.resetPW")),_n(2),jr("ngIf",e.loading),_n(1),jr("routerLink",Pa(20,cb)),_n(1),fo(Oa(20,16,"pwForgotten.btn.cancel"))}},directives:[Eu,Fd,Tu,Ec,Ed,Ru,Nd,Ou,jc,of],pipes:[lv],styles:[""]}),t})();function ub(t,e){1&t&&(Nr(0,"div",12),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"pwReset.msg.followPolicy")))}function hb(t,e){1&t&&(Nr(0,"div",12),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"pwReset.msg.followRule")))}function pb(t,e){1&t&&Br(0,"img",13)}const gb=function(t){return{"has-error":t}},mb=function(){return["/login"]};let fb=(()=>{class t{constructor(t,e,i,n,s,r){this.messageService=t,this.router=e,this.route=i,this.authenticationService=n,this.alertService=s,this.translate=r,this.loading=!1}ngOnInit(){this.getPWPolicy(),this.user=new Xh,this.token=this.route.snapshot.queryParams.token,this.log("Init PW Reset Token "+this.token)}pwreset(){this.loading=!0,this.authenticationService.pwreset(this.user,this.token).subscribe(()=>{const t=this.translate.instant("pwReset.msg.pwResetSuccess");this.alertService.success(t,!0),this.router.navigate(["login"])},t=>{this.loading=!1;const e=this.translate.instant("pwReset.msg.pwResetError");this.alertService.error(e,!0),this.log("Error during Reset Password "+t.error.message)})}getPWPolicy(){this.authenticationService.initPWPolicy().subscribe(t=>{this.log("Init PW Policy success "+JSON.stringify(t)),this.PWPolicy=t.PWPolicy,this.PWPolicyDescription=t.Description},t=>{this.log(`Init PW Policy Failed: ${t.status} ${t.error.message} `),this.alertService.error(Gh(t))})}log(t){this.messageService.add("PW Reset: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(rf),Rr(Bg),Rr(op),Rr(Mf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-pwreset"]],decls:22,vars:23,consts:[[1,"col-md-6","col-md-offset-3"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group",3,"ngClass"],["for","password","data-toggle","tooltip","data-placement","top","data-delay","50","title","Password Rule: At least one alpha, one capital, one number and one special character and a length of minimum 8."],["type","password","name","password","required","","autocomplete","off",1,"form-control",3,"ngModel","pattern","ngModelChange"],["password","ngModel"],["class","help-block",4,"ngIf"],[1,"form-group"],[1,"btn","btn-primary",3,"disabled"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==",4,"ngIf"],[1,"btn","btn-link",3,"routerLink"],[1,"help-block"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="]],template:function(t,e){if(1&t){const t=zr();Nr(0,"div",0),Nr(1,"h2"),mo(2),Ua(3,"translate"),Fr(),Nr(4,"form",1,2),Jr("ngSubmit",(function(){return ei(t),Gr(5).form.valid&&e.pwreset()})),Nr(6,"div",3),Nr(7,"label",4),mo(8),Ua(9,"translate"),Fr(),Nr(10,"input",5,6),Jr("ngModelChange",(function(t){return e.user.password=t})),Fr(),Lr(12,ub,3,3,"div",7),Lr(13,hb,3,3,"div",7),Fr(),Nr(14,"div",8),Nr(15,"button",9),mo(16),Ua(17,"translate"),Fr(),Lr(18,pb,1,0,"img",10),Nr(19,"a",11),mo(20),Ua(21,"translate"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Gr(5),i=Gr(11);_n(2),fo(Oa(3,12,"pwReset.title")),_n(4),jr("ngClass",ka(20,gb,t.submitted&&!i.valid)),_n(2),vo(" ",Oa(9,14,"pwReset.lbl.newPassword")," (*) "),_n(2),to("pattern",e.PWPolicy),jr("ngModel",e.user.password),_n(2),jr("ngIf",!i.valid),_n(1),jr("ngIf",!i.valid),_n(2),jr("disabled",e.loading),_n(1),fo(Oa(17,16,"pwReset.btn.resetPW")),_n(2),jr("ngIf",e.loading),_n(1),jr("routerLink",Pa(22,mb)),_n(1),fo(Oa(21,18,"pwReset.btn.cancel"))}},directives:[Eu,Fd,Tu,Ec,Ed,Ru,Nd,Ou,Hu,jc,of],pipes:[lv],styles:[""]}),t})();var vb=function(t){return t[t.Project=0]="Project",t[t.Portfolio=1]="Portfolio",t[t.Template=2]="Template",t}({});class bb{}class yb{}const Cb={headers:new th({"Content-Type":"application/json"})};let Vb=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.vpUrl=this.env.restUrl.concat("/vp")}getVisboProjects(t,e=!1,i=!1){const n=""+this.vpUrl,s=new th({"Content-Type":"application/json"});let r=new nh;return t&&(r=r.append("vcid",t)),e&&(r=r.append("sysadmin","1")),i&&(r=r.append("deleted","1")),this.log(`VP getVisboProjects Sysadmin ${e} Deleted ${i}`),this.http.get(n,{headers:s,params:r}).pipe(D(t=>t.vp),qh(t=>this.log(`fetched ${t.length} VisboProjects `)),Fh(this.handleError("getVisboProjects")))}getVisboProjectNo404(t){const e=""+this.vpUrl;return this.log("Calling HTTP Request: "+this.vpUrl),this.http.get(e).pipe(D(t=>t[0]),qh(e=>{this.log(`getVisboProject404 ${e?"fetched":"did not find"} VisboProject id=${t}`)}),Fh(this.handleError("getVisboProject id="+t)))}getVisboProject(t,e=!1,i=!1){const n=`${this.vpUrl}/${t}`,s=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("sysadmin","1")),i&&(r=r.append("deleted","1")),this.log(`Calling HTTP Request for a specific entry: ${n} params ${r}`),this.http.get(n,{headers:s,params:r}).pipe(D(t=>(t.vp[0].perm=t.perm,t.vp[0])),qh(t=>this.log(`fetched vp id=${t._id} ${t.name}`)),Fh(this.handleError("getVisboProject id="+t)))}getCapacity(t,e,i,n,s=!1,r=!1,o=!1,a=!1,l=!1){const c=`${this.vpUrl}/${t}/portfolio/${e}/capacity`,d=new th({"Content-Type":"application/json"});let u=new nh;return s&&(u=u.append("hierarchy","1")),r&&(u=u.append("pfv","1")),l&&(u=u.append("perProject","1")),o&&(u=u.append("sysadmin","1")),a&&(u=u.append("deleted","1")),n&&(this.log("Calling RoleID: "+n),u=u.append("roleID",n)),i&&(u=u.append("refDate",i.toISOString())),this.log("Calling HTTP Request for a specific entry: "+c),this.http.get(c,{headers:d,params:u}).pipe(D(t=>t.vp[0]),qh(i=>this.log(`fetched Capacity for VP/VPF ${t}/ ${e} Len: ${i.capacity.length}`)),Fh(this.handleError("getVisboPortfolio Capacity id:"+e)))}addVisboProject(t){return this.http.post(this.vpUrl,t,Cb).pipe(D(t=>t.vp[0]),qh(t=>this.log("added VisboProject with id="+t._id)),Fh(this.handleError("addVisboProject")))}deleteVisboProject(t,e=!1){const i=t._id,n=`${this.vpUrl}/${i}`,s=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("deleted","1")),this.log(`Calling HTTP Request: ${n} `),this.http.delete(n,{headers:s,params:r}).pipe(qh(()=>this.log("deleted VisboProject id="+i)),Fh(this.handleError("deleteVisboProject")))}updateVisboProject(t,e=!1){const i=`${this.vpUrl}/${t._id}`,n=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("deleted","1")),this.log(`Calling HTTP Request PUT: ${i} `),this.http.put(i,t,{headers:n,params:s}).pipe(D(t=>t.vp[0]),qh(()=>this.log(`updated VisboProject id=${t._id} url=${this.vpUrl}`)),Fh(this.handleError("updateVisboProject")))}getVPUsers(t,e=!1,i=!1){const n=`${this.vpUrl}/${t}/group?userlist=1`,s=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("sysadmin","1")),i&&(r=r.append("deleted","1")),this.log(`Calling HTTP Request GET: ${n} `),this.http.get(n,{headers:s,params:r}).pipe(D(t=>{const e=new Uv;return e.users=t.users,e.groups=t.groups,e}),Fh(this.handleError("getVisboProjectUsers")))}addVPUser(t,e,i,n,s=!1){const r=`${this.vpUrl}/${n}/group/${e}/user`,o=new th({"Content-Type":"application/json"});let a=new nh;s&&(a=a.append("sysadmin","1"));const l={email:t,message:i};return this.log(`Calling HTTP Request: ${r} for ${t} `),this.http.post(r,l,{headers:o,params:a}).pipe(D(t=>t.groups[0]),qh(t=>this.log("added Visbo User to Group with id="+t._id)),Fh(this.handleError("addVPUser")))}deleteVPUser(t,e,i=!1){const n=`${this.vpUrl}/${e}/group/${t.groupId}/user/${t.userId}`,s=new th({"Content-Type":"application/json"});let r=new nh;return i&&(r=r.append("sysadmin","1")),this.log(`Calling HTTP Request: ${n} for ${t.email} as ${t.groupName} `),this.http.delete(n,{headers:s,params:r}).pipe(D(t=>t.groups[0]),qh(()=>this.log("deleted Visbo Project User "+t.email)),Fh(this.handleError("deleteVisboProjectUser")))}addVPGroup(t,e=!1){const i=`${this.vpUrl}/${t.vpids[0]}/group`,n=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("sysadmin","1")),this.log(`Calling HTTP Request: ${i} for ${t.name} `),this.http.post(i,t,{headers:n,params:s}).pipe(D(t=>t.groups[0]),qh(t=>this.log("added Visbo Group with id="+t._id)),Fh(this.handleError("addVPGroup")))}modifyVPGroup(t,e=!1){const i=`${this.vpUrl}/${t.vpids[0]}/group/${t._id}`,n=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("sysadmin","1")),this.log(`Calling HTTP Request: ${i} for ${t.name} `),this.http.put(i,t,{headers:n,params:s}).pipe(D(t=>t.groups[0]),qh(t=>this.log("modified Visbo Group with id="+JSON.stringify(t))),Fh(this.handleError("addVPGroup")))}deleteVPGroup(t,e,i=!1){const n=`${this.vpUrl}/${e}/group/${t._id}`,s=new th({"Content-Type":"application/json"});let r=new nh;return i&&(r=r.append("sysadmin","1")),this.log(`Calling HTTP Request: ${n} for Group ${t.name} `),this.http.delete(n,{headers:s,params:r}).pipe(qh(()=>this.log("deleted Visbo Project Group "+t.name)),Fh(this.handleError("deleteVisboProjectGroup")))}unlockVP(t,e,i=!1){const n=`${this.vpUrl}/${e}/lock`,s=new th({"Content-Type":"application/json"});let r=new nh;return i&&(r=r.append("sysadmin","1")),t&&(r=r.append("variantID",t)),this.log(`Calling HTTP Request: ${n} Params ${r} `),this.http.delete(n,{headers:s,params:r}).pipe(D(t=>t.lock),qh(()=>this.log("deleted Visbo Project Lock for Variant "+t)),Fh(this.handleError("deleteVisboProjectLock")))}deleteRestriction(t,e){const i=`${this.vpUrl}/${t}/restrict/${e}`,n=new th({"Content-Type":"application/json"}),s=new nh;return this.log(`Calling HTTP Request: ${i} Params ${s} `),this.http.delete(i,{headers:n,params:s}).pipe(D(t=>t.vp[0]),qh(t=>this.log("deleted Visbo Project Restriction in VP "+t.name)),Fh(this.handleError("deleteVisboProjectRestriction")))}addRestriction(t,e){const i=`${this.vpUrl}/${t}/restrict`,n=new th({"Content-Type":"application/json"}),s=new nh;return this.log(`Calling HTTP Request: ${i} Params ${s} `),this.http.post(i,e,{headers:n,params:s}).pipe(D(t=>t.restrict[0]),qh(t=>this.log("added Visbo Project Restriction "+JSON.stringify(t))),Fh(this.handleError("addVisboProjectRestriction")))}createVariant(t,e,i=!1){const n=`${this.vpUrl}/${e}/variant`,s=new th({"Content-Type":"application/json"});let r=new nh;i&&(r=r.append("sysadmin","1"));const o={variantName:t};return this.log(`Calling HTTP Request: ${n} for ${t} `),this.http.post(n,o,{headers:s,params:r}).pipe(D(t=>t.variant[0]),qh(t=>this.log("added VP Variant with id="+t._id)),Fh(this.handleError("createVariant")))}deleteVariant(t,e){const i=`${this.vpUrl}/${e}/variant/${t}`,n=new th({"Content-Type":"application/json"}),s=new nh;return this.log(`Calling HTTP Request: ${i} Params ${s} `),this.http.delete(i,{headers:n,params:s}).pipe(D(t=>t.vp[0]),qh(t=>this.log("deleted Visbo Project Variant in VP "+t.name)),Fh(this.handleError("deleteVisboProjectVariant")))}handleError(t="operation"){return e=>(this.log(`HTTP Request failed: ${e.error.message} ${e.status}`),this.log(`${t} failed: ${e.error.message}`),$h(e))}log(t){this.messageService.add("VisboProjectService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(jh),Kt(sp))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function wb(t,e){if(1&t){const t=zr();Nr(0,"li",11),Nr(1,"a",12),mo(2),Ua(3,"translate"),Fr(),Nr(4,"div",13),Nr(5,"a",14),Jr("click",(function(){return ei(t),Xr(2).gotoClickedItem("settings")})),mo(6),Ua(7,"translate"),Fr(),Nr(8,"a",14),Jr("click",(function(){return ei(t),Xr(2).gotoClickedItem("sysadmins")})),mo(9),Ua(10,"translate"),Fr(),Fr(),Fr()}2&t&&(_n(2),vo(" ",Oa(3,3,"navbar.others")," "),_n(4),fo(Oa(7,5,"navbar.settings")),_n(3),fo(Oa(10,7,"navbar.appAdmin")))}function Ab(t,e){if(1&t){const t=zr();Nr(0,"nav",1),Nr(1,"a",2),Jr("click",(function(){return ei(t),Xr().gotoClickedItem("dashboard")})),mo(2),Ua(3,"translate"),Fr(),Nr(4,"button",3),Br(5,"i",4),Fr(),Nr(6,"div",5),Nr(7,"ul",6),Nr(8,"li",7),Nr(9,"a",8),Jr("click",(function(){return ei(t),Xr().gotoClickedItem("vc")})),mo(10),Ua(11,"translate"),Fr(),Fr(),Nr(12,"li",7),Nr(13,"a",8),Jr("click",(function(){return ei(t),Xr().gotoClickedItem("vp")})),mo(14),Ua(15,"translate"),Fr(),Fr(),Nr(16,"li",7),Nr(17,"a",8),Jr("click",(function(){return ei(t),Xr().gotoClickedItem("profile")})),mo(18),Ua(19,"translate"),Fr(),Fr(),Lr(20,wb,11,9,"li",9),Nr(21,"li",7),Nr(22,"a",10),Jr("click",(function(){return ei(t),Xr().gotoClickedItem("login")})),mo(23),Ua(24,"translate"),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr();_n(2),fo(Oa(3,6,"navbar.visbo")),_n(8),fo(Oa(11,8,"navbar.vc")),_n(4),fo(Oa(15,10,"navbar.vp")),_n(4),fo(Oa(19,12,"navbar.profile")),_n(2),jr("ngIf",t.hasSystemPerm(t.permSystem.View)),_n(3),fo(Oa(24,14,"navbar.logout"))}}let Pb=(()=>{class t{constructor(t,e,i,n,s){this.route=t,this.router=e,this.alertService=i,this.messageService=n,this.visbocenterService=s,this.permSystem=Mv}ngOnInit(){this.combinedPerm=this.visbocenterService.getSysAdminRole(),this.log(`Navbar Init Sys Role ${JSON.stringify(this.combinedPerm)} View ${this.permSystem.View}`)}gotoClickedItem(t){this.router.navigate([t])}hasSystemPerm(t){var e;return((null===(e=this.combinedPerm)||void 0===e?void 0:e.system)&t)>0}getPreView(){return Rh()}log(t){this.messageService.add("NavBar: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Bg),Rr(rf),Rr(Mf),Rr(jh),Rr(Ev))},t.\u0275cmp=le({type:t,selectors:[["app-usernavbar"]],decls:1,vars:1,consts:[["class","navbar navbar-expand-md navbar-white bg-light sticky-top",4,"ngIf"],[1,"navbar","navbar-expand-md","navbar-white","bg-light","sticky-top"],[1,"navbar-brand","bg-light",3,"click"],["type","button","data-toggle","collapse","data-target","#navbarMainNavigation","aria-controls","navbarMainNavigation","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"fas","fa-bars"],["id","navbarMainNavigation",1,"collapse","navbar-collapse"],[1,"navbar-nav","mr-auto"],[1,"nav-item"],[1,"nav-link","bg-light",3,"click"],["class","nav-item dropdown",4,"ngIf"],[1,"nav-link","bg-light","align-right",3,"click"],[1,"nav-item","dropdown"],["href","#","id","navbarDropdown","role","button","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"nav-link","dropdown-toggle","bg-light"],["aria-labelledby","navbarDropdown",1,"dropdown-menu"],[1,"dropdown-item",3,"click"]],template:function(t,e){1&t&&Lr(0,Ab,25,16,"nav",0),2&t&&jr("ngIf",!e.getPreView())},directives:[jc],pipes:[lv],styles:[".navbar[_ngcontent-%COMP%]{padding:0;margin-bottom:1em;margin-top:1em}"]}),t})();function kb(t,e){if(1&t){const t=zr();Nr(0,"div",7),Nr(1,"div",8),Nr(2,"div",9),Nr(3,"h3",10),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(2).gotoClickedVc(i)})),Nr(4,"a"),mo(5),Fr(),Fr(),Nr(6,"h6",11),mo(7),Ua(8,"date"),Fr(),Nr(9,"p",12),mo(10),Fr(),Nr(11,"div",13),Nr(12,"button",14),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(2).gotoClickedVc(i)})),mo(13),Ua(14,"translate"),Fr(),Nr(15,"button",15),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(2).gotoClickedVcDetail(i)})),mo(16),Ua(17,"translate"),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit;_n(5),fo(t.name),_n(2),fo(Ea(8,6,t.updatedAt,"dd.MM.yyyy HH:mm")),_n(3),fo(t.description),_n(3),bo("",t.vpCount," ",Oa(14,9,"dashboard.projects"),""),_n(3),fo(Oa(17,11,"dashboard.detail"))}}function Db(t,e){if(1&t&&(Nr(0,"div",2),Nr(1,"div",3),Nr(2,"h2"),mo(3),Ua(4,"translate"),Fr(),Fr(),Nr(5,"div",4),Nr(6,"div",5),Lr(7,kb,18,13,"div",6),Fr(),Fr(),Fr()),2&t){const t=Xr();_n(3),fo(Oa(4,2,"dashboard.topvc")),_n(4),jr("ngForOf",t.visbocenters)}}function Mb(t,e){if(1&t){const t=zr();Nr(0,"div",7),Nr(1,"div",8),Nr(2,"div",9),Nr(3,"h3",10),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(2).gotoClickedVp(i)})),Nr(4,"a"),mo(5),Fr(),Fr(),Nr(6,"h6",16),mo(7),Fr(),Nr(8,"h6",11),mo(9),Ua(10,"date"),Fr(),Nr(11,"p",12),mo(12),Fr(),Nr(13,"div",13),Nr(14,"button",14),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(2).gotoClickedVp(i)})),mo(15),Ua(16,"translate"),Fr(),Nr(17,"button",15),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(2).gotoClickedVpDetail(i)})),mo(18),Ua(19,"translate"),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit;_n(5),fo(t.name),_n(2),fo(t.vc.name),_n(2),fo(Ea(10,7,t.updatedAt,"dd.MM.yyyy HH:mm")),_n(3),fo(t.description),_n(3),bo("",t.vpfCount||t.vpvCount," ",Oa(16,10,"dashboard.versions"),""),_n(3),fo(Oa(19,12,"dashboard.detail"))}}function Ib(t,e){if(1&t&&(Nr(0,"div",2),Nr(1,"div",0),Nr(2,"div",3),Nr(3,"h2"),mo(4),Ua(5,"translate"),Fr(),Fr(),Fr(),Nr(6,"div",4),Nr(7,"div",5),Lr(8,Mb,20,14,"div",6),Fr(),Fr(),Fr()),2&t){const t=Xr();_n(4),fo(Oa(5,2,"dashboard.topvp")),_n(4),jr("ngForOf",t.visboprojects)}}function Sb(t,e){1&t&&(Nr(0,"div",2),Nr(1,"div",3),Nr(2,"h2"),mo(3),Ua(4,"translate"),Fr(),Nr(5,"div"),mo(6),Ua(7,"translate"),Fr(),Fr(),Fr()),2&t&&(_n(3),fo(Oa(4,2,"dashboard.noVC")),_n(3),vo(" ",Oa(7,4,"dashboard.msg.noVC")," "))}let xb=(()=>{class t{constructor(t,e,i,n,s,r,o,a){this.visbocenterService=t,this.visboprojectService=e,this.messageService=i,this.alertService=n,this.route=s,this.router=r,this.translate=o,this.titleService=a,this.visbocenters=[],this.visboprojects=[],this.combinedPerm=void 0,this.permVC=Iv,this.permVP=Sv}ngOnInit(){this.currentLang=this.translate.currentLang,this.titleService.setTitle(this.translate.instant("dashboard.title")),this.getVisboCenters(),this.getVisboProjects()}getVisboCenters(){this.visbocenterService.getVisboCenters().subscribe(t=>{this.visbocenters=t.sort((function(t,e){return t.updatedAt>e.updatedAt?-1:1})).slice(0,3)},t=>{console.log("get VCs failed: error: %d message: %s",t.status,t.error.message),this.alertService.error(Gh(t))})}getVisboProjects(){this.visboprojectService.getVisboProjects(null).subscribe(t=>{this.visboprojects=t.sort((function(t,e){return t.updatedAt>e.updatedAt?-1:1})).slice(0,3)},t=>{console.log("get VPs failed: error: %d message: %s",t.status,t.error.message),this.alertService.error(Gh(t))})}hasVCPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vc&t)>0}gotoClickedVc(t){this.router.navigate(["vp/"+t._id])}gotoClickedVcDetail(t){this.router.navigate(["vcDetail/"+t._id])}gotoClickedVp(t){this.router.navigate(t.vpType===vb.Portfolio?["vpf/"+t._id]:["vpKeyMetrics/"+t._id])}gotoClickedVpVc(t){this.router.navigate(["vp/"+t.vcid])}gotoClickedVpDetail(t){this.router.navigate(["vpDetail/"+t._id])}}return t.\u0275fac=function(e){return new(e||t)(Rr(Ev),Rr(Vb),Rr(jh),Rr(Mf),Rr(Bg),Rr(rf),Rr(av),Rr(Md))},t.\u0275cmp=le({type:t,selectors:[["app-dashboard"]],decls:5,vars:3,consts:[[1,"well"],["class","container-fluit",4,"ngIf"],[1,"container-fluit"],[1,"panel-heading"],[1,"col-12"],[1,"row"],["class","card-group col-sm-8 col-md-6 col-lg-4 mb-2",4,"ngFor","ngForOf"],[1,"card-group","col-sm-8","col-md-6","col-lg-4","mb-2"],[1,"card",2,"width","18rem"],[1,"card-body","d-flex","flex-column"],[1,"card-title",3,"click"],[1,"card-subtitle","mb-2","text-muted"],[1,"card-text"],[1,"align-self-bottom",2,"margin-top","auto"],["type","button",1,"mx-1","btn","btn-primary",3,"click"],["type","button",1,"mx-1","btn","btn-secondary",3,"click"],[1,"card-subtitle","mb-2","text-black"]],template:function(t,e){1&t&&(Nr(0,"div",0),Br(1,"app-usernavbar"),Fr(),Lr(2,Db,8,4,"div",1),Lr(3,Ib,9,4,"div",1),Lr(4,Sb,8,6,"div",1)),2&t&&(_n(2),jr("ngIf",e.visbocenters&&e.visbocenters.length>0),_n(1),jr("ngIf",e.visboprojects&&e.visboprojects.length>0),_n(1),jr("ngIf",e.visbocenters&&0==e.visbocenters.length&&e.visboprojects&&0==e.visboprojects.length))},directives:[Pb,jc,Gc],pipes:[lv,qc],styles:[""]}),t})();function Tb(t,e){if(1&t){const t=zr();Nr(0,"tr",12),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(2).gotoClickedRow(i)})),Nr(1,"td",6),mo(2),Fr(),Nr(3,"td",13),Nr(4,"a"),mo(5),Fr(),Fr(),Nr(6,"td",14),mo(7),Ua(8,"date"),Fr(),Nr(9,"td",15),mo(10),Ua(11,"date"),Fr(),Nr(12,"td",16),mo(13),Fr(),Nr(14,"td",17),Nr(15,"button",18),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(2).gotoDetail(i)})),Ua(16,"translate"),mo(17,"i"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit,i=e.index;_n(2),fo(i+1),_n(3),fo(t.name),_n(2),fo(Ea(8,6,t.updatedAt,"dd.MM.yyyy HH:mm")),_n(3),fo(Ea(11,9,t.updatedAt,"dd.MM.yy")),_n(3),fo(t.vpCount),_n(2),to("title",Oa(16,12,"vc.msg.detail"))}}function _b(t,e){if(1&t){const t=zr();Nr(0,"div",2),Nr(1,"h2",3),mo(2),Ua(3,"translate"),Fr(),Nr(4,"table",4),Nr(5,"thead",5),Nr(6,"tr"),Nr(7,"th",6),mo(8),Ua(9,"translate"),Fr(),Nr(10,"th",7),Jr("click",(function(){return ei(t),Xr().sortVCTable(1)})),mo(11),Ua(12,"translate"),Fr(),Nr(13,"th",8),Jr("click",(function(){return ei(t),Xr().sortVCTable(2)})),mo(14),Ua(15,"translate"),Fr(),Nr(16,"th",9),Jr("click",(function(){return ei(t),Xr().sortVCTable(3)})),mo(17),Ua(18,"translate"),Fr(),Nr(19,"th"),mo(20,"Detail"),Fr(),Fr(),Fr(),Nr(21,"tbody",10),Lr(22,Tb,18,14,"tr",11),Fr(),Fr(),Fr()}if(2&t){const t=Xr();_n(2),vo(" ",Oa(3,6,"vc.title")," "),_n(6),fo(Oa(9,8,"vc.lbl.nr")),_n(3),fo(Oa(12,10,"vc.lbl.name")),_n(3),fo(Oa(15,12,"vc.lbl.modified")),_n(3),fo(Oa(18,14,"vc.lbl.projects")),_n(5),jr("ngForOf",t.visbocenters)}}function Ub(t,e){1&t&&(Nr(0,"div",2),Nr(1,"div",3),Nr(2,"h2"),mo(3),Ua(4,"translate"),Fr(),Nr(5,"div"),mo(6),Ua(7,"translate"),Fr(),Fr(),Fr()),2&t&&(_n(3),fo(Oa(4,2,"vc.noVC")),_n(3),vo(" ",Oa(7,4,"vc.msg.noVC")," "))}let Ob=(()=>{class t{constructor(t,e,i,n,s,r,o){this.visbocenterService=t,this.messageService=e,this.alertService=i,this.route=n,this.router=s,this.translate=r,this.titleService=o}ngOnInit(){this.titleService.setTitle(this.translate.instant("vc.title")),this.getVisboCenters()}getVisboCenters(){this.visbocenterService.getVisboCenters().subscribe(t=>{this.visbocenters=t,this.sortVCTable(1),this.log("get VCs success")},t=>{this.log(`get VCs failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}gotoDetail(t){this.router.navigate(["vcDetail/"+t._id])}gotoClickedRow(t){this.router.navigate(["vp/"+t._id])}sortVCTable(t){this.visbocenters&&(void 0===t&&void 0!==this.sortColumn||(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t:!this.sortAscending),1===this.sortColumn?this.visbocenters.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortColumn?this.visbocenters.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})):3===this.sortColumn&&this.visbocenters.sort((function(t,e){return t.vpCount-e.vpCount})),this.sortAscending||this.visbocenters.reverse())}log(t){this.messageService.add("VisboCenter: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Ev),Rr(jh),Rr(Mf),Rr(Bg),Rr(rf),Rr(av),Rr(Md))},t.\u0275cmp=le({type:t,selectors:[["app-visbocenters"]],decls:4,vars:2,consts:[[1,"well"],["class","panel-body",4,"ngIf"],[1,"panel-body"],[1,"panel-heading"],[1,"table","table-hover","table-sortable"],["id","VCHead"],[1,"d-none","d-md-table-cell"],["id","SortName",3,"click"],["id","SortDate",1,"d-none","d-sm-table-cell",3,"click"],["id","SortProjects",1,"d-none","d-md-table-cell",3,"click"],["id","VCList"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["id","ColName"],["id","ColDate",1,"d-none","d-md-table-cell"],["id","ColDate",1,"d-none","d-sm-table-cell","d-md-none"],["id","ColProjects",1,"d-none","d-md-table-cell"],["id","ColDetail"],[1,"Detail",3,"title","click"]],template:function(t,e){1&t&&(Br(0,"app-usernavbar"),Nr(1,"div",0),Lr(2,_b,23,16,"div",1),Lr(3,Ub,8,6,"div",1),Fr()),2&t&&(_n(2),jr("ngIf",e.visbocenters&&e.visbocenters.length>0),_n(1),jr("ngIf",e.visbocenters&&0==e.visbocenters.length))},directives:[Pb,jc,Gc],pipes:[lv,qc],encapsulation:2}),t})(),Eb=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.vcUrl=this.env.restUrl.concat("/vc")}getVCSettings(t,e=!1){const i=`${this.vcUrl}/${t}/setting`,n=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("sysadmin","1")),this.log(`Calling HTTP Request: ${i} `),this.http.get(i,{headers:n,params:s}).pipe(D(t=>t.vcsetting),qh(t=>this.log(`fetched ${t.length} VCSettings `)),Fh(this.handleError("getVCSettings",[])))}getVCOrganisations(t,e=!1,i,n=!1){const s=`${this.vcUrl}/${t}/organisation`,r=new th({"Content-Type":"application/json"});let o=new nh;return e&&(o=o.append("sysadmin","1")),null!=i&&(o=o.append("refDate",i)),this.log(`Calling HTTP Request: ${s} ${n}`),this.http.get(s,{headers:r,params:o}).pipe(D(t=>t.vcsetting),qh(t=>this.log(`fetched ${t.length} VCOrganisations `)),Fh(this.handleError("getVCOrganisations",[])))}getVCSetting(t,e,i=!1){const n=`${this.vcUrl}/${t}/setting/${e}`,s=new th({"Content-Type":"application/json"});let r=new nh;return i&&(r=r.append("sysadmin","1")),this.log("Calling HTTP Request for a specific entry: "+n),this.http.get(n,{headers:s,params:r}).pipe(D(t=>t.vcsetting[0]),qh(t=>this.log(`fetched VC Setting ${t.name} id:${e} `)),Fh(this.handleError("getVCSetting id:"+e)))}getVCSettingByName(t,e,i=!1){const n=`${this.vcUrl}/${t}/setting?name=${e}`,s=new th({"Content-Type":"application/json"});let r=new nh;return i&&(r=r.append("sysadmin","1")),this.log("Calling HTTP Request for a specific entry: "+n),this.http.get(n,{headers:s,params:r}).pipe(D(t=>t.vcsetting),qh(t=>this.log(`fetched ${t.length} VCSettings `)),Fh(this.handleError("getVCSettings by Name",[])))}getVCSettingByType(t,e,i=!1){const n=`${this.vcUrl}/${t}/setting?type=${e}`,s=new th({"Content-Type":"application/json"});let r=new nh;return i&&(r=r.append("sysadmin","1")),this.log("Calling HTTP Request for a specific entry: "+n),this.http.get(n,{headers:s,params:r}).pipe(D(t=>t.vcsetting),qh(t=>this.log(`fetched ${t.length} VCSettings `)),Fh(this.handleError("getVCSettings by Type",[])))}addVCSetting(t,e,i=!1){const n=`${this.vcUrl}/${t}/setting`,s=new th({"Content-Type":"application/json"});let r=new nh;return i&&(r=r.append("sysadmin","1")),this.log(`Calling HTTP Request: ${n} ${JSON.stringify(e)}`),this.http.post(n,e,{headers:s,params:r}).pipe(D(t=>t.vcsetting[0]),qh(t=>this.log(`added VCSetting ${t.name} with id=${t._id}`)),Fh(this.handleError("addVCSetting")))}deleteVCSetting(t,e=!1){const i=t._id,n=`${this.vcUrl}/${t.vcid}/setting/${i}`,s=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("sysadmin","1")),this.log(`Calling HTTP Request: ${n} `),this.http.delete(n,{headers:s,params:r}).pipe(qh(()=>this.log("deleted VCSetting id="+i)),Fh(this.handleError("deleteVCSetting")))}updateVCSetting(t,e,i=!1){const n=`${this.vcUrl}/${t}/setting/${e._id}`,s=new th({"Content-Type":"application/json"});let r=new nh;return i&&(r=r.append("sysadmin","1")),this.log(`Calling HTTP Request PUT: ${n} `),this.http.put(n,e,{headers:s,params:r}).pipe(D(t=>t.vcsetting[0]),qh(t=>this.log(`updated VCSetting ${t.name} with id=${t._id}`)),Fh(this.handleError("updateVCSetting")))}handleError(t="operation",e){return i=>(this.log(`HTTP Request ${t} failed: ${i.error.message} status:${i.status}, Result ${JSON.stringify(e)}`),$h(i))}log(t){this.messageService.add("VisboSettingService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(jh),Kt(sp))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function Lb(t,e){if(1&t){const t=zr();Nr(0,"input",49),Jr("ngModelChange",(function(e){return ei(t),Xr(2).visbocenter.name=e})),Fr()}2&t&&jr("ngModel",Xr(2).visbocenter.name)}function Gb(t,e){if(1&t&&(Nr(0,"label",50),mo(1),Fr()),2&t){const t=Xr(2);_n(1),vo("",t.visbocenter.name," ")}}function Rb(t,e){if(1&t){const t=zr();Nr(0,"textarea",51),Jr("ngModelChange",(function(e){return ei(t),Xr(2).visbocenter.description=e})),Fr()}2&t&&jr("ngModel",Xr(2).visbocenter.description)}function jb(t,e){if(1&t&&(Nr(0,"label",52),mo(1),Fr()),2&t){const t=Xr(2);_n(1),vo("",t.visbocenter.description," ")}}function $b(t,e){if(1&t){const t=zr();Nr(0,"button",59),Jr("click",(function(){ei(t);const e=Xr(3);return e.gotoVCAudit(e.visbocenter)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vcDetail.btn.viewAudit")))}function Nb(t,e){if(1&t){const t=zr();Nr(0,"button",60),Jr("click",(function(){return ei(t),Xr(3).switchView("Groups")})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vcDetail.btn.viewGroups")))}function Fb(t,e){if(1&t){const t=zr();Nr(0,"button",61),Jr("click",(function(){return ei(t),Xr(3).switchView("Users")})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vcDetail.btn.viewUsers")))}function Bb(t,e){if(1&t){const t=zr();Nr(0,"button",62),Jr("click",(function(){return ei(t),Xr(3).switchView("ProjectUsers")})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vcDetail.btn.viewProjectUsers")))}function Hb(t,e){if(1&t){const t=zr();Nr(0,"button",63),Jr("click",(function(){return ei(t),Xr(3).showSetting()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vcDetail.btn.ViewSetting")))}function Kb(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"div",53),Lr(2,$b,3,3,"button",54),Lr(3,Nb,3,3,"button",55),Lr(4,Fb,3,3,"button",56),Lr(5,Bb,3,3,"button",57),Lr(6,Hb,3,3,"button",58),Fr(),Fr()),2&t){const t=Xr(2);_n(2),jr("ngIf",t.hasVCPerm(t.permVC.ViewAudit)),_n(1),jr("ngIf","Users"==t.showList),_n(1),jr("ngIf","Users"!=t.showList),_n(1),jr("ngIf",t.vgVPUsers&&t.vgVPUsers.length>0),_n(1),jr("ngIf",t.hasVCPerm(t.permVC.Modify))}}function qb(t,e){1&t&&(Nr(0,"div",65),Nr(1,"button",72),mo(2),Ua(3,"translate"),Fr(),Fr()),2&t&&(_n(2),vo(" ",Oa(3,1,"vcDetail.btn.addUser")," "))}function zb(t,e){1&t&&(Nr(0,"th"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vcDetail.lbl.delete")))}function Qb(t,e){if(1&t){const t=zr();Nr(0,"td"),Nr(1,"button",75),Jr("click",(function(){ei(t);const e=Xr().index;return Xr(4).helperUserIndex(e)})),Ua(2,"translate"),mo(3,"\xd7"),Fr(),Fr()}2&t&&(_n(1),to("title",Oa(2,1,"vcDetail.lbl.deleteUser")))}function Wb(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td"),mo(2),Fr(),Nr(3,"td",73),Jr("click",(function(){ei(t);const i=e.index;return Xr(4).calcCombinedPerm(i)})),Nr(4,"a"),mo(5),Fr(),Fr(),Nr(6,"td",74),Jr("click",(function(){return ei(t),Xr(4).switchView("Groups")})),Nr(7,"a"),mo(8),Fr(),Fr(),Lr(9,Qb,4,3,"td",0),Fr()}if(2&t){const t=e.$implicit,i=e.index,n=Xr(4);_n(2),fo(i+1),_n(3),fo(t.email),_n(3),fo(t.groupName),_n(1),jr("ngIf",n.hasVCPerm(n.permVC.ManagePerm))}}function Jb(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div",64),Nr(2,"div",65),Nr(3,"h4",66),mo(4),Ua(5,"translate"),Fr(),Fr(),Lr(6,qb,4,3,"div",67),Fr(),Nr(7,"div",68),Nr(8,"table",69),Nr(9,"thead",70),Nr(10,"tr"),Nr(11,"th"),mo(12),Ua(13,"translate"),Fr(),Nr(14,"th",1),Jr("click",(function(){return ei(t),Xr(3).sortUserTable(1)})),mo(15),Ua(16,"translate"),Fr(),Nr(17,"th",1),Jr("click",(function(){return ei(t),Xr(3).sortUserTable(2)})),mo(18),Ua(19,"translate"),Fr(),Lr(20,zb,3,3,"th",0),Fr(),Fr(),Nr(21,"tbody",71),Lr(22,Wb,10,4,"tr",34),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(3);_n(4),vo(" ",Oa(5,7,"vcDetail.titleUsers")," "),_n(2),jr("ngIf",t.hasVCPerm(t.permVC.ManagePerm)),_n(6),fo(Oa(13,9,"vcDetail.lbl.nr")),_n(3),fo(Oa(16,11,"vcDetail.lbl.email")),_n(3),fo(Oa(19,13,"vcDetail.lbl.group")),_n(2),jr("ngIf",t.hasVCPerm(t.permVC.ManagePerm)),_n(2),jr("ngForOf",t.vgUsers)}}function Yb(t,e){if(1&t){const t=zr();Nr(0,"div",65),Nr(1,"button",79),Jr("click",(function(){return ei(t),Xr(4).initGroup(null)})),mo(2),Ua(3,"translate"),Fr(),Fr()}2&t&&(_n(2),vo(" ",Oa(3,1,"vcDetail.btn.addGroup")," "))}function Zb(t,e){1&t&&(Nr(0,"th"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vcDetail.lbl.delete")))}function Xb(t,e){1&t&&(Nr(0,"td",84),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vcDetail.lbl.global")))}function ty(t,e){1&t&&Br(0,"td",84)}function ey(t,e){if(1&t){const t=zr();Nr(0,"td"),Nr(1,"button",85),Jr("click",(function(){ei(t);const e=Xr().index;return Xr(4).helperRemoveGroup(e)})),Ua(2,"translate"),mo(3,"\xd7"),Fr(),Fr()}2&t&&(_n(1),to("title",Oa(2,1,"vcDetail.msg.removeGroup")))}function iy(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td"),mo(2),Fr(),Nr(3,"td",80),Jr("click",(function(){ei(t);const i=e.index,n=e.$implicit,s=Xr(4);return s.groupIndex=i,s.initGroup(n)})),Nr(4,"a"),mo(5),Fr(),Fr(),Nr(6,"td",81),Jr("click",(function(){return ei(t),Xr(4).switchView("Users")})),Nr(7,"a"),mo(8),Fr(),Fr(),Lr(9,Xb,3,3,"td",82),Lr(10,ty,1,0,"td",82),Lr(11,ey,4,3,"td",0),Nr(12,"td"),Nr(13,"button",83),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(4).initGroup(i)})),Ua(14,"translate"),mo(15,"i"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit,i=e.index,n=Xr(4);_n(2),fo(i+1),_n(3),fo(t.name),_n(3),fo(t.users.length),_n(1),jr("ngIf",t.global),_n(1),jr("ngIf",!t.global),_n(1),jr("ngIf",n.hasVCPerm(n.permVC.ManagePerm)),_n(2),to("title",Oa(14,7,"vcDetail.msg.detailGroup"))}}function ny(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div",64),Nr(2,"div",65),Nr(3,"h5",76),mo(4),Ua(5,"translate"),Fr(),Fr(),Lr(6,Yb,4,3,"div",67),Fr(),Nr(7,"div",68),Nr(8,"table",69),Nr(9,"thead",77),Nr(10,"tr"),Nr(11,"th"),mo(12),Ua(13,"translate"),Fr(),Nr(14,"th",1),Jr("click",(function(){return ei(t),Xr(3).sortGroupTable(1)})),mo(15),Ua(16,"translate"),Fr(),Nr(17,"th",1),Jr("click",(function(){return ei(t),Xr(3).sortGroupTable(2)})),mo(18),Ua(19,"translate"),Fr(),Nr(20,"th"),mo(21),Ua(22,"translate"),Fr(),Lr(23,Zb,3,3,"th",0),Nr(24,"th"),mo(25),Ua(26,"translate"),Fr(),Fr(),Fr(),Nr(27,"tbody",78),Lr(28,iy,16,9,"tr",34),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(3);_n(4),vo(" ",Oa(5,9,"vcDetail.titleGroups")," "),_n(2),jr("ngIf",t.hasVCPerm(t.permVC.ManagePerm)),_n(6),fo(Oa(13,11,"vcDetail.lbl.nr")),_n(3),fo(Oa(16,13,"vcDetail.lbl.group")),_n(3),fo(Oa(19,15,"vcDetail.lbl.members")),_n(3),fo(Oa(22,17,"vcDetail.lbl.type")),_n(2),jr("ngIf",t.hasVCPerm(t.permVC.ManagePerm)),_n(2),fo(Oa(26,19,"vcDetail.lbl.info")),_n(3),jr("ngForOf",t.vgGroups)}}function sy(t,e){if(1&t){const t=zr();Nr(0,"tr",1),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(4).gotoVPDetail(i.vpid)})),Nr(1,"td"),mo(2),Fr(),Nr(3,"td"),mo(4),Fr(),Nr(5,"td"),mo(6),Fr(),Nr(7,"td"),mo(8),Fr(),Fr()}if(2&t){const t=e.$implicit,i=e.index;_n(2),fo(i+1),_n(2),fo(t.users.email),_n(2),fo(t.vp.name),_n(2),fo(t.groupName)}}function ry(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div",64),Nr(2,"div",65),Nr(3,"h5",86),mo(4),Ua(5,"translate"),Fr(),Fr(),Fr(),Nr(6,"div",68),Nr(7,"table",69),Nr(8,"thead"),Nr(9,"tr"),Nr(10,"th"),mo(11),Ua(12,"translate"),Fr(),Nr(13,"th",1),Jr("click",(function(){return ei(t),Xr(3).sortVPUserTable(1)})),mo(14),Ua(15,"translate"),Fr(),Nr(16,"th",1),Jr("click",(function(){return ei(t),Xr(3).sortVPUserTable(2)})),mo(17),Ua(18,"translate"),Fr(),Nr(19,"th"),mo(20),Ua(21,"translate"),Fr(),Fr(),Fr(),Nr(22,"tbody"),Lr(23,sy,9,4,"tr",87),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(3);_n(4),vo(" ",Oa(5,6,"vcDetail.titleProjectUsers")," "),_n(7),fo(Oa(12,8,"vcDetail.lbl.nr")),_n(3),fo(Oa(15,10,"vcDetail.lbl.email")),_n(3),fo(Oa(18,12,"vcDetail.lbl.project")),_n(3),fo(Oa(21,14,"vcDetail.lbl.group")),_n(3),jr("ngForOf",t.vgVPUsers)}}function oy(t,e){if(1&t&&(Nr(0,"div"),Lr(1,Jb,23,15,"div",0),Lr(2,ny,29,21,"div",0),Lr(3,ry,24,16,"div",0),Fr()),2&t){const t=Xr(2);_n(1),jr("ngIf","Users"==t.showList),_n(1),jr("ngIf","Groups"==t.showList),_n(1),jr("ngIf","ProjectUsers"==t.showList)}}function ay(t,e){1&t&&(Nr(0,"th"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vcDetail.lbl.delete")))}function ly(t,e){if(1&t&&(Nr(0,"td",93),mo(1),Ua(2,"date"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.updatedAt,"HH:mm:ss"))}}function cy(t,e){if(1&t&&(Nr(0,"td",93),mo(1),Ua(2,"date"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.updatedAt,"dd.MM.yy"))}}function dy(t,e){if(1&t){const t=zr();Nr(0,"td"),Nr(1,"button",94),Jr("click",(function(){ei(t);const e=Xr().index;return Xr(3).initSetting(e)}))("click",(function(){ei(t);const e=Xr().index;return Xr(3).helperSettingIndex(e)})),Ua(2,"translate"),mo(3,"\xd7"),Fr(),Fr()}2&t&&(_n(1),to("title",Oa(2,1,"vcDetail.lbl.deleteSetting")))}function uy(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td"),mo(2),Fr(),Nr(3,"td",90),Jr("click",(function(){ei(t);const i=e.index;return Xr(3).initSetting(i)})),Nr(4,"a"),mo(5),Fr(),Fr(),Nr(6,"td",91),mo(7),Ua(8,"date"),Fr(),Lr(9,ly,3,4,"td",92),Lr(10,cy,3,4,"td",92),Lr(11,dy,4,3,"td",0),Fr()}if(2&t){const t=e.$implicit,i=e.index,n=Xr(3);_n(2),fo(i+1),_n(3),fo(t.name),_n(2),fo(Ea(8,6,t.timestamp,"dd.MM.yyyy")),_n(2),jr("ngIf",n.isToday(t.updatedAt)),_n(1),jr("ngIf",!n.isToday(t.updatedAt)),_n(1),jr("ngIf",n.hasVCPerm(n.permVC.Modify))}}function hy(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div"),Nr(2,"div",64),Nr(3,"div",65),Nr(4,"h4",66),mo(5),Ua(6,"translate"),Fr(),Fr(),Fr(),Nr(7,"div",68),Nr(8,"table",69),Nr(9,"thead",88),Nr(10,"tr"),Nr(11,"th"),mo(12),Ua(13,"translate"),Fr(),Nr(14,"th",1),Jr("click",(function(){return ei(t),Xr(2).sortSettingTable(1)})),mo(15),Ua(16,"translate"),Fr(),Nr(17,"th",1),Jr("click",(function(){return ei(t),Xr(2).sortSettingTable(2)})),mo(18),Ua(19,"translate"),Fr(),Nr(20,"th",1),Jr("click",(function(){return ei(t),Xr(2).sortSettingTable(3)})),mo(21),Ua(22,"translate"),Fr(),Lr(23,ay,3,3,"th",0),Fr(),Fr(),Nr(24,"tbody",89),Lr(25,uy,12,9,"tr",34),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(5),vo(" ",Oa(6,7,"vcDetail.titleSettings")," "),_n(7),fo(Oa(13,9,"vcDetail.lbl.nr")),_n(3),fo(Oa(16,11,"vcDetail.lbl.settingName")),_n(3),fo(Oa(19,13,"vcDetail.lbl.timestamp")),_n(3),fo(Oa(22,15,"vcDetail.lbl.updatedAt")),_n(2),jr("ngIf",t.hasVCPerm(t.permVC.ManagePerm)),_n(2),jr("ngForOf",t.vcSettings)}}function py(t,e){if(1&t){const t=zr();Nr(0,"button",95),Jr("click",(function(){return ei(t),Xr(2).save()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vcDetail.btn.save")))}function gy(t,e){1&t&&(Nr(0,"div",96),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vcDetail.msg.emailRequired")))}function my(t,e){if(1&t&&(Nr(0,"option"),mo(1),Fr()),2&t){const t=e.$implicit;_n(1),fo(t.name)}}function fy(t,e){1&t&&(Nr(0,"div",96),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vcDetail.msg.groupRequired")))}function vy(t,e){1&t&&(Nr(0,"div",96),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vcDetail.msg.invalidMessage")))}function by(t,e){1&t&&(Nr(0,"button",97),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vcDetail.btn.invite")))}function yy(t,e){if(1&t){const t=zr();Nr(0,"button",98),Jr("click",(function(){return ei(t),Xr(2).addNewVCUser()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vcDetail.btn.invite")))}function Cy(t,e){if(1&t){const t=zr();Nr(0,"div",17),Nr(1,"div",18),Nr(2,"div",19),Nr(3,"h5",99),mo(4),Ua(5,"translate"),Fr(),Nr(6,"button",21),Nr(7,"span",22),mo(8,"\xd7"),Fr(),Fr(),Fr(),Nr(9,"div",23),Nr(10,"div"),Nr(11,"label",100),mo(12),Ua(13,"translate"),Fr(),Fr(),Nr(14,"form"),Nr(15,"div",101),Nr(16,"label",102),mo(17),Ua(18,"translate"),Fr(),Nr(19,"label",103),mo(20),Fr(),Fr(),Nr(21,"div",101),Nr(22,"label",104),mo(23),Ua(24,"translate"),Fr(),Nr(25,"label",103),mo(26),Fr(),Fr(),Nr(27,"div",101),Nr(28,"label",104),mo(29),Ua(30,"translate"),Fr(),Nr(31,"label",103),mo(32),Fr(),Fr(),Fr(),Fr(),Nr(33,"div",38),Nr(34,"button",105),mo(35),Ua(36,"translate"),Fr(),Nr(37,"button",106),Jr("click",(function(){ei(t);const e=Xr(2);return e.removeVCUser(e.vgUsers[e.userIndex],e.visbocenter._id)})),mo(38),Ua(39,"translate"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(4),fo(Oa(5,10,"vcDetail.titleRemoveUser")),_n(8),fo(Oa(13,12,"vcDetail.msg.removeUserConfirm")),_n(5),vo("",Oa(18,14,"vcDetail.lbl.vc"),":"),_n(3),vo("",t.visbocenter.name," "),_n(3),vo("",Oa(24,16,"vcDetail.lbl.user"),":"),_n(3),fo(t.vgUsers[t.userIndex].email),_n(3),vo("",Oa(30,18,"vcDetail.lbl.group"),":"),_n(3),fo(t.vgUsers[t.userIndex].groupName),_n(3),fo(Oa(36,20,"vcDetail.btn.back")),_n(3),fo(Oa(39,22,"vcDetail.btn.delete"))}}function Vy(t,e){1&t&&(Nr(0,"h5",133),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vcDetail.titleModifyGroup")))}function wy(t,e){1&t&&(Nr(0,"h5",133),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vcDetail.titleAddGroup")))}const Ay=function(t){return{"has-error":t}};function Py(t,e){if(1&t&&(Nr(0,"div",26),Nr(1,"label",134),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",135),mo(5),Fr(),Fr()),2&t){Xr();const t=Gr(10),e=Xr(2);jr("ngClass",ka(5,Ay,t.submitted)),_n(2),vo("",Oa(3,3,"vcDetail.lbl.name"),":"),_n(3),fo(e.actGroup.name)}}function ky(t,e){1&t&&(Nr(0,"div",96),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vcDetail.msg.groupNameRequired")))}function Dy(t,e){if(1&t){const t=zr();Nr(0,"div",26),Nr(1,"label",134),mo(2),Ua(3,"translate"),Fr(),Nr(4,"input",136,137),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.name=e})),Fr(),Lr(6,ky,3,3,"div",30),Fr()}if(2&t){const t=Gr(5);Xr();const e=Gr(10),i=Xr(2);jr("ngClass",ka(6,Ay,e.submitted)),_n(2),vo("",Oa(3,4,"vcDetail.lbl.name"),":"),_n(2),jr("ngModel",i.actGroup.name),_n(2),jr("ngIf",t.errors&&(t.dirty||t.touched))}}function My(t,e){if(1&t){const t=zr();Nr(0,"div",138),Nr(1,"div"),mo(2),Ua(3,"translate"),Fr(),Nr(4,"div",111),Nr(5,"input",139,140),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedVPView=e})),Fr(),Nr(7,"label",141),mo(8),Ua(9,"translate"),Fr(),Fr(),Nr(10,"div",111),Nr(11,"input",142,143),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedVPViewAudit=e})),Fr(),Nr(13,"label",144),mo(14),Ua(15,"translate"),Fr(),Fr(),Nr(16,"div",111),Nr(17,"input",145,146),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedVPModify=e})),Fr(),Nr(19,"label",147),mo(20),Ua(21,"translate"),Fr(),Fr(),Nr(22,"div",111),Nr(23,"input",148,149),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedCreateVariant=e})),Fr(),Nr(25,"label",150),mo(26),Ua(27,"translate"),Fr(),Fr(),Nr(28,"div",111),Nr(29,"input",151,152),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedVPManagePerm=e})),Fr(),Nr(31,"label",153),mo(32),Ua(33,"translate"),Fr(),Fr(),Nr(34,"div",111),Nr(35,"input",154,155),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedVPDelete=e})),Fr(),Nr(37,"label",156),mo(38),Ua(39,"translate"),Fr(),Fr(),Fr()}if(2&t){const t=Xr(3);_n(2),fo(Oa(3,13,"perm.titleVPPerm")),_n(3),jr("ngModel",t.actGroup.checkedVPView),_n(3),fo(Oa(9,15,"perm.vpView")),_n(3),jr("ngModel",t.actGroup.checkedVPViewAudit),_n(3),fo(Oa(15,17,"perm.vpViewAudit")),_n(3),jr("ngModel",t.actGroup.checkedVPModify),_n(3),fo(Oa(21,19,"perm.vpModify")),_n(3),jr("ngModel",t.actGroup.checkedCreateVariant),_n(3),fo(Oa(27,21,"perm.vpCreateVariant")),_n(3),jr("ngModel",t.actGroup.checkedVPManagePerm),_n(3),fo(Oa(33,23,"perm.vpManagePerm")),_n(3),jr("ngModel",t.actGroup.checkedVPDelete),_n(3),fo(Oa(39,25,"perm.vpDelete"))}}function Iy(t,e){if(1&t){const t=zr();Nr(0,"div",160),Nr(1,"a",161),Jr("click",(function(){ei(t);const e=Xr().$implicit;return Xr(4).activateUser(e)})),mo(2),Fr(),Fr()}if(2&t){const t=Xr().$implicit;_n(2),fo(t.email)}}function Sy(t,e){if(1&t&&(Hr(0,64),Lr(1,Iy,3,1,"div",159),Kr()),2&t){const t=e.$implicit,i=Xr(4);_n(1),jr("ngIf",t.groupName==i.actGroup.name)}}function xy(t,e){if(1&t&&(Nr(0,"div",138),Nr(1,"label",157),mo(2),Ua(3,"translate"),Fr(),Lr(4,Sy,2,1,"ng-container",158),Fr()),2&t){const t=Xr(3);_n(2),fo(Oa(3,2,"perm.lblGroupMembers")),_n(2),jr("ngForOf",t.vgUsers)}}function Ty(t,e){1&t&&(Nr(0,"div",138),Nr(1,"label",157),mo(2),Ua(3,"translate"),Fr(),Fr()),2&t&&(_n(2),fo(Oa(3,1,"perm.lblNoGroupMembers")))}function _y(t,e){if(1&t&&(Nr(0,"button",162),mo(1),Fr()),2&t){const t=Xr(3);_n(1),fo(t.confirm)}}function Uy(t,e){if(1&t){const t=zr();Nr(0,"button",163),Jr("click",(function(){return ei(t),Xr(3).addModifyVCGroup()})),mo(1),Fr()}if(2&t){const t=Xr(3);_n(1),fo(t.confirm)}}function Oy(t,e){if(1&t){const t=zr();Nr(0,"div",17),Nr(1,"div",18),Nr(2,"div",19),Lr(3,Vy,3,3,"h5",107),Lr(4,wy,3,3,"h5",107),Nr(5,"button",21),Nr(6,"span",22),mo(7,"\xd7"),Fr(),Fr(),Fr(),Nr(8,"div",23),Nr(9,"form",108,109),Lr(11,Py,6,7,"div",110),Lr(12,Dy,7,8,"div",110),Nr(13,"div"),mo(14),Ua(15,"translate"),Fr(),Nr(16,"div",111),Nr(17,"input",112,113),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedView=e})),Fr(),Nr(19,"label",114),mo(20),Ua(21,"translate"),Fr(),Fr(),Nr(22,"div",111),Nr(23,"input",115,116),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedViewAudit=e})),Fr(),Nr(25,"label",117),mo(26),Ua(27,"translate"),Fr(),Fr(),Nr(28,"div",111),Nr(29,"input",118,119),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedModify=e})),Fr(),Nr(31,"label",120),mo(32),Ua(33,"translate"),Fr(),Fr(),Nr(34,"div",111),Nr(35,"input",121,122),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedCreateVP=e})),Fr(),Nr(37,"label",123),mo(38),Ua(39,"translate"),Fr(),Fr(),Nr(40,"div",111),Nr(41,"input",124,125),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedManagePerm=e})),Fr(),Nr(43,"label",126),mo(44),Ua(45,"translate"),Fr(),Fr(),Br(46,"br"),Nr(47,"div",111),Nr(48,"input",127,128),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.global=e})),Fr(),Nr(50,"label",129),mo(51),Ua(52,"translate"),Fr(),Fr(),Lr(53,My,40,27,"div",130),Lr(54,xy,5,4,"div",130),Lr(55,Ty,4,3,"div",130),Nr(56,"div",38),Nr(57,"button",39),mo(58),Ua(59,"translate"),Fr(),Lr(60,_y,2,1,"button",131),Lr(61,Uy,2,1,"button",132),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Gr(10),e=Xr(2);_n(3),jr("ngIf",e.actGroup._id),_n(1),jr("ngIf",!e.actGroup._id),_n(7),jr("ngIf",e.actGroup.internal),_n(1),jr("ngIf",!e.actGroup.internal),_n(2),fo(Oa(15,23,"perm.titleVCPerm")),_n(3),jr("ngModel",e.actGroup.checkedView),_n(3),fo(Oa(21,25,"perm.vcView")),_n(3),jr("ngModel",e.actGroup.checkedViewAudit),_n(3),fo(Oa(27,27,"perm.vcViewAudit")),_n(3),jr("ngModel",e.actGroup.checkedModify),_n(3),fo(Oa(33,29,"perm.vcModify")),_n(3),jr("ngModel",e.actGroup.checkedCreateVP),_n(3),fo(Oa(39,31,"perm.vcCreateVP")),_n(3),jr("ngModel",e.actGroup.checkedManagePerm),_n(3),fo(Oa(45,33,"perm.vcManagePerm")),_n(4),jr("ngModel",e.actGroup.global),_n(3),fo(Oa(52,35,"perm.vcGlobal")),_n(2),jr("ngIf",e.actGroup.global),_n(1),jr("ngIf",e.helperUsersPerGroup(e.actGroup.name)),_n(1),jr("ngIf",!e.helperUsersPerGroup(e.actGroup.name)),_n(3),fo(Oa(59,37,"vcDetail.btn.back")),_n(2),jr("ngIf",!(t.form.valid&&e.hasVCPerm(e.permVC.ManagePerm))),_n(1),jr("ngIf",t.form.valid&&e.hasVCPerm(e.permVC.ManagePerm))}}function Ey(t,e){if(1&t){const t=zr();Nr(0,"div",17),Nr(1,"div",18),Nr(2,"div",19),Nr(3,"h5",99),mo(4),Ua(5,"translate"),Fr(),Nr(6,"button",21),Nr(7,"span",22),mo(8,"\xd7"),Fr(),Fr(),Fr(),Nr(9,"div",23),Nr(10,"div"),Nr(11,"label",100),mo(12),Ua(13,"translate"),Fr(),Fr(),Nr(14,"form"),Nr(15,"div",101),Nr(16,"label",102),mo(17),Ua(18,"translate"),Fr(),Nr(19,"label",103),mo(20),Fr(),Fr(),Nr(21,"div",101),Nr(22,"label",104),mo(23),Ua(24,"translate"),Fr(),Nr(25,"label",103),mo(26),Fr(),Fr(),Nr(27,"div",101),Nr(28,"label",104),mo(29),Ua(30,"translate"),Fr(),Nr(31,"label",103),mo(32),Fr(),Fr(),Fr(),Fr(),Nr(33,"div",38),Nr(34,"button",39),mo(35),Ua(36,"translate"),Fr(),Nr(37,"button",164),Jr("click",(function(){ei(t);const e=Xr(2);return e.removeVCGroup(e.vgGroups[e.groupIndex])})),mo(38),Ua(39,"translate"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(4),fo(Oa(5,10,"vcDetail.titleDeleteGroup")),_n(8),fo(Oa(13,12,"vcDetail.msg.removeGroupConfirm")),_n(5),vo("",Oa(18,14,"vcDetail.lbl.vc"),":"),_n(3),vo("",t.visbocenter.name," "),_n(3),vo("",Oa(24,16,"vcDetail.lbl.group"),":"),_n(3),fo(t.vgGroups[t.groupIndex].name),_n(3),vo("",Oa(30,18,"vcDetail.lbl.members"),":"),_n(3),fo(t.vgGroups[t.groupIndex].users.length),_n(3),fo(Oa(36,20,"vcDetail.btn.back")),_n(3),fo(Oa(39,22,"vcDetail.btn.delete"))}}function Ly(t,e){1&t&&Br(0,"input",192)}function Gy(t,e){1&t&&Br(0,"input",193)}function Ry(t,e){1&t&&Br(0,"input",194)}function jy(t,e){1&t&&Br(0,"input",195)}function $y(t,e){1&t&&Br(0,"input",196)}function Ny(t,e){1&t&&Br(0,"input",197)}function Fy(t,e){1&t&&Br(0,"input",198)}function By(t,e){1&t&&Br(0,"input",199)}function Hy(t,e){1&t&&Br(0,"input",200)}function Ky(t,e){1&t&&Br(0,"input",201)}function qy(t,e){1&t&&Br(0,"input",202)}function zy(t,e){1&t&&Br(0,"input",203)}function Qy(t,e){1&t&&Br(0,"input",204)}function Wy(t,e){1&t&&Br(0,"input",205)}function Jy(t,e){1&t&&Br(0,"input",206)}function Yy(t,e){1&t&&Br(0,"input",207)}function Zy(t,e){1&t&&Br(0,"input",208)}function Xy(t,e){1&t&&Br(0,"input",209)}function tC(t,e){1&t&&Br(0,"input",210)}function eC(t,e){1&t&&Br(0,"input",211)}function iC(t,e){1&t&&Br(0,"input",212)}function nC(t,e){1&t&&Br(0,"input",213)}function sC(t,e){if(1&t){const t=zr();Nr(0,"div",160),Nr(1,"a",214),Jr("click",(function(){ei(t);const e=Xr().$implicit;return Xr(3).activateGroup(e)})),mo(2),Fr(),Fr()}if(2&t){const t=Xr().$implicit;_n(2),fo(t.groupName)}}function rC(t,e){if(1&t&&(Hr(0,64),Lr(1,sC,3,1,"div",159),Kr()),2&t){const t=e.$implicit,i=Xr(3);_n(1),jr("ngIf",t.email==i.vgUsers[i.userIndex].email)}}const oC=function(t){return{name:t}};function aC(t,e){if(1&t&&(Nr(0,"div",165),Nr(1,"div",166),Nr(2,"div",18),Nr(3,"div",19),Nr(4,"h5",167),mo(5),Ua(6,"translate"),Fr(),Nr(7,"button",21),Nr(8,"span",22),mo(9,"\xd7"),Fr(),Fr(),Fr(),Nr(10,"div",23),Nr(11,"div",138),mo(12),Ua(13,"translate"),Fr(),Nr(14,"div",111),Lr(15,Ly,1,0,"input",168),Lr(16,Gy,1,0,"input",169),Nr(17,"label",114),mo(18),Ua(19,"translate"),Fr(),Fr(),Nr(20,"div",111),Lr(21,Ry,1,0,"input",170),Lr(22,jy,1,0,"input",171),Nr(23,"label",117),mo(24),Ua(25,"translate"),Fr(),Fr(),Nr(26,"div",111),Lr(27,$y,1,0,"input",172),Lr(28,Ny,1,0,"input",173),Nr(29,"label",120),mo(30),Ua(31,"translate"),Fr(),Fr(),Nr(32,"div",111),Lr(33,Fy,1,0,"input",174),Lr(34,By,1,0,"input",175),Nr(35,"label",123),mo(36),Ua(37,"translate"),Fr(),Fr(),Nr(38,"div",111),Lr(39,Hy,1,0,"input",176),Lr(40,Ky,1,0,"input",177),Nr(41,"label",126),mo(42),Ua(43,"translate"),Fr(),Fr(),Br(44,"br"),Nr(45,"div"),mo(46),Ua(47,"translate"),Fr(),Nr(48,"div",111),Lr(49,qy,1,0,"input",178),Lr(50,zy,1,0,"input",179),Nr(51,"label",141),mo(52),Ua(53,"translate"),Fr(),Fr(),Nr(54,"div",111),Lr(55,Qy,1,0,"input",180),Lr(56,Wy,1,0,"input",181),Nr(57,"label",144),mo(58),Ua(59,"translate"),Fr(),Fr(),Nr(60,"div",111),Lr(61,Jy,1,0,"input",182),Lr(62,Yy,1,0,"input",183),Nr(63,"label",147),mo(64),Ua(65,"translate"),Fr(),Fr(),Nr(66,"div",111),Lr(67,Zy,1,0,"input",184),Lr(68,Xy,1,0,"input",185),Nr(69,"label",150),mo(70),Ua(71,"translate"),Fr(),Fr(),Nr(72,"div",111),Lr(73,tC,1,0,"input",186),Lr(74,eC,1,0,"input",187),Nr(75,"label",153),mo(76),Ua(77,"translate"),Fr(),Fr(),Nr(78,"div",111),Lr(79,iC,1,0,"input",188),Lr(80,nC,1,0,"input",189),Nr(81,"label",156),mo(82),Ua(83,"translate"),Fr(),Fr(),Nr(84,"label",190),mo(85),Ua(86,"translate"),Fr(),Lr(87,rC,2,1,"ng-container",158),Nr(88,"div",38),Nr(89,"button",191),mo(90),Ua(91,"translate"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr(2);_n(5),fo(Ea(6,39,"vcDetail.titlePermUser",ka(72,oC,t.vgUsers[t.userIndex].email))),_n(7),fo(Oa(13,42,"perm.titleVCPerm")),_n(3),jr("ngIf",t.hasUserVCPerm(t.permVC.View)),_n(1),jr("ngIf",!t.hasUserVCPerm(t.permVC.View)),_n(2),fo(Oa(19,44,"perm.vcView")),_n(3),jr("ngIf",t.hasUserVCPerm(t.permVC.ViewAudit)),_n(1),jr("ngIf",!t.hasUserVCPerm(t.permVC.ViewAudit)),_n(2),fo(Oa(25,46,"perm.vcViewAudit")),_n(3),jr("ngIf",t.hasUserVCPerm(t.permVC.Modify)),_n(1),jr("ngIf",!t.hasUserVCPerm(t.permVC.Modify)),_n(2),fo(Oa(31,48,"perm.vcModify")),_n(3),jr("ngIf",t.hasUserVCPerm(t.permVC.CreateVP)),_n(1),jr("ngIf",!t.hasUserVCPerm(t.permVC.CreateVP)),_n(2),fo(Oa(37,50,"perm.vcCreateVP")),_n(3),jr("ngIf",t.hasUserVCPerm(t.permVC.ManagePerm)),_n(1),jr("ngIf",!t.hasUserVCPerm(t.permVC.ManagePerm)),_n(2),fo(Oa(43,52,"perm.vcManagePerm")),_n(4),fo(Oa(47,54,"perm.titleVPPerm")),_n(3),jr("ngIf",t.hasUserVPPerm(t.permVP.View)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.View)),_n(2),fo(Oa(53,56,"perm.vpView")),_n(3),jr("ngIf",t.hasUserVPPerm(t.permVP.ViewAudit)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.ViewAudit)),_n(2),fo(Oa(59,58,"perm.vpViewAudit")),_n(3),jr("ngIf",t.hasUserVPPerm(t.permVP.Modify)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.Modify)),_n(2),fo(Oa(65,60,"perm.vpModify")),_n(3),jr("ngIf",t.hasUserVPPerm(t.permVP.CreateVariant)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.CreateVariant)),_n(2),fo(Oa(71,62,"perm.vpCreateVariant")),_n(3),jr("ngIf",t.hasUserVPPerm(t.permVP.ManagePerm)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.ManagePerm)),_n(2),fo(Oa(77,64,"perm.vpManagePerm")),_n(3),jr("ngIf",t.hasUserVPPerm(t.permVP.DeleteVP)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.DeleteVP)),_n(2),fo(Oa(83,66,"perm.vpDelete")),_n(3),fo(Oa(86,68,"perm.lblGroupMembership")),_n(2),jr("ngForOf",t.vgUsers),_n(3),fo(Oa(91,70,"vcDetail.btn.back"))}}function lC(t,e){if(1&t){const t=zr();Nr(0,"div",17),Nr(1,"div",18),Nr(2,"div",19),Nr(3,"h5",215),mo(4),Ua(5,"translate"),Fr(),Nr(6,"button",21),Nr(7,"span",22),mo(8,"\xd7"),Fr(),Fr(),Fr(),Nr(9,"div",23),Nr(10,"form",216),Nr(11,"div",101),Nr(12,"label",217),mo(13),Ua(14,"translate"),Fr(),Nr(15,"label",218),mo(16),Fr(),Fr(),Nr(17,"div",101),Nr(18,"label",219),mo(19),Ua(20,"translate"),Fr(),Nr(21,"label",220),mo(22),Fr(),Fr(),Nr(23,"div",101),Nr(24,"label",221),mo(25),Ua(26,"translate"),Fr(),Nr(27,"label",222),mo(28),Ua(29,"date"),Fr(),Fr(),Nr(30,"div",101),Nr(31,"label",223),mo(32),Ua(33,"translate"),Fr(),Nr(34,"label",224),mo(35),Ua(36,"date"),Fr(),Fr(),Fr(),Fr(),Nr(37,"div",38),Nr(38,"button",39),mo(39),Ua(40,"translate"),Fr(),Nr(41,"button",225),Jr("click",(function(){return ei(t),Xr(2).downloadSetting()})),mo(42),Ua(43,"translate"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(4),fo(Oa(5,11,"vcDetail.titleSettings")),_n(9),vo("",Oa(14,13,"vcDetail.lbl.settingName"),":"),_n(3),vo("",t.vcSetting.name," "),_n(3),vo("",Oa(20,15,"vcDetail.lbl.settingType"),":"),_n(3),vo("",t.vcSetting.type," "),_n(3),vo("",Oa(26,17,"vcDetail.lbl.timestamp"),":"),_n(3),vo("",Ea(29,19,t.vcSetting.timestamp,"dd.MM.yy")," "),_n(4),vo("",Oa(33,22,"vcDetail.lbl.updatedAt"),":"),_n(3),vo("",Ea(36,24,t.vcSetting.updatedAt,"dd.MM.yy")," "),_n(4),fo(Oa(40,27,"vcDetail.btn.cancel")),_n(3),fo(Oa(43,29,"vcDetail.btn.download"))}}function cC(t,e){if(1&t&&(Nr(0,"div",101),Nr(1,"label",229),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",103),mo(5),Ua(6,"date"),Fr(),Fr()),2&t){const t=Xr(3);_n(2),vo("",Oa(3,2,"vcDetail.lbl.timestamp"),":"),_n(3),vo("",Ea(6,4,t.vcSetting.timestamp,"dd.MM.yyyy HH:mm")," ")}}function dC(t,e){if(1&t){const t=zr();Nr(0,"div",17),Nr(1,"div",18),Nr(2,"div",19),Nr(3,"h5",226),mo(4),Ua(5,"translate"),Fr(),Nr(6,"button",21),Nr(7,"span",22),mo(8,"\xd7"),Fr(),Fr(),Fr(),Nr(9,"div",23),Nr(10,"div"),Nr(11,"label",100),mo(12),Ua(13,"translate"),Fr(),Fr(),Nr(14,"form"),Nr(15,"div",101),Nr(16,"label",217),mo(17),Ua(18,"translate"),Fr(),Nr(19,"label",103),mo(20),Fr(),Fr(),Nr(21,"div",101),Nr(22,"label",219),mo(23),Ua(24,"translate"),Fr(),Nr(25,"label",103),mo(26),Fr(),Fr(),Lr(27,cC,7,7,"div",227),Nr(28,"div",101),Nr(29,"label",228),mo(30),Ua(31,"translate"),Fr(),Nr(32,"label",103),mo(33),Ua(34,"date"),Fr(),Fr(),Fr(),Fr(),Nr(35,"div",38),Nr(36,"button",39),mo(37),Ua(38,"translate"),Fr(),Nr(39,"button",164),Jr("click",(function(){ei(t);const e=Xr(2);return e.removeVCSetting(e.vcSetting)})),mo(40),Ua(41,"translate"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(4),fo(Oa(5,11,"vcDetail.titleDeleteSetting")),_n(8),fo(Oa(13,13,"vcDetail.msg.removeSettingConfirm")),_n(5),vo("",Oa(18,15,"vcDetail.lbl.setting"),":"),_n(3),vo("",t.vcSetting.name," "),_n(3),vo("",Oa(24,17,"vcDetail.lbl.settingType"),":"),_n(3),vo("",t.vcSetting.type," "),_n(1),jr("ngIf",t.vcSetting.timestamp),_n(3),vo("",Oa(31,19,"vcDetail.lbl.updatedAt"),":"),_n(3),vo("",Ea(34,21,t.vcSetting.updatedAt,"dd.MM.yyyy HH:mm")," "),_n(4),fo(Oa(38,24,"vcDetail.btn.back")),_n(3),fo(Oa(41,26,"vcDetail.btn.delete"))}}function uC(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"h3"),mo(2),Ua(3,"translate"),Nr(4,"a",1),Jr("click",(function(){ei(t);const e=Xr();return e.gotoVPList(e.visbocenter)})),mo(5),Ua(6,"uppercase"),Fr(),Fr(),Nr(7,"form"),Nr(8,"div",2),Nr(9,"label",3),mo(10),Ua(11,"translate"),Fr(),Lr(12,Lb,1,1,"input",4),Lr(13,Gb,2,1,"label",5),Fr(),Nr(14,"div",2),Nr(15,"label",6),mo(16),Ua(17,"translate"),Fr(),Lr(18,Rb,1,1,"textarea",7),Lr(19,jb,2,1,"label",8),Fr(),Nr(20,"div",9),Nr(21,"label",10),mo(22),Ua(23,"translate"),Fr(),Nr(24,"label",11),mo(25),Ua(26,"date"),Fr(),Nr(27,"label",12),mo(28),Ua(29,"date"),Fr(),Fr(),Fr(),Lr(30,Kb,7,5,"div",0),Lr(31,oy,4,3,"div",0),Nr(32,"div"),Lr(33,hy,26,17,"div",0),Fr(),Nr(34,"div",13),Lr(35,py,3,3,"button",14),Nr(36,"button",15),Jr("click",(function(){return ei(t),Xr().goBack()})),mo(37),Ua(38,"translate"),Fr(),Fr(),Nr(39,"div",16),Nr(40,"div",17),Nr(41,"div",18),Nr(42,"div",19),Nr(43,"h5",20),mo(44),Ua(45,"translate"),Fr(),Nr(46,"button",21),Nr(47,"span",22),mo(48,"\xd7"),Fr(),Fr(),Fr(),Nr(49,"div",23),Nr(50,"form",24,25),Nr(52,"div",26),Nr(53,"label",27),mo(54),Ua(55,"translate"),Fr(),Nr(56,"input",28,29),Jr("ngModelChange",(function(e){return ei(t),Xr().newUserInvite.email=e})),Fr(),Lr(58,gy,3,3,"div",30),Fr(),Nr(59,"div",26),Nr(60,"label",31),mo(61),Ua(62,"translate"),Fr(),Nr(63,"select",32,33),Jr("ngModelChange",(function(e){return ei(t),Xr().newUserInvite.groupName=e})),Br(65,"option"),Lr(66,my,2,1,"option",34),Fr(),Lr(67,fy,3,3,"div",30),Fr(),Nr(68,"div",26),Nr(69,"label",35),mo(70),Ua(71,"translate"),Fr(),Nr(72,"textarea",36,37),Jr("ngModelChange",(function(e){return ei(t),Xr().newUserInvite.inviteMessage=e})),mo(74," "),Fr(),Fr(),Lr(75,vy,3,3,"div",30),Nr(76,"div",38),Nr(77,"button",39),mo(78),Ua(79,"translate"),Fr(),Lr(80,by,3,3,"button",40),Lr(81,yy,3,3,"button",41),Fr(),Fr(),Fr(),Fr(),Fr(),Fr(),Nr(82,"div",42),Lr(83,Cy,40,24,"div",43),Fr(),Nr(84,"div",44),Lr(85,Oy,62,39,"div",43),Fr(),Nr(86,"div",45),Lr(87,Ey,40,24,"div",43),Fr(),Lr(88,aC,92,74,"div",46),Nr(89,"div",47),Lr(90,lC,44,31,"div",43),Fr(),Nr(91,"div",48),Lr(92,dC,42,28,"div",43),Fr(),Fr()}if(2&t){const t=Gr(51),e=Gr(57),i=Gr(64),n=Gr(73),s=Xr();_n(2),vo("",Oa(3,39,"vcDetail.title"),": "),_n(3),fo(Oa(6,41,s.visbocenter.name)),_n(5),vo("",Oa(11,43,"vcDetail.lbl.name"),":"),_n(2),jr("ngIf",s.hasVCPerm(s.permVC.Modify)),_n(1),jr("ngIf",!s.hasVCPerm(s.permVC.Modify)),_n(3),vo("",Oa(17,45,"vcDetail.lbl.description"),":"),_n(2),jr("ngIf",s.hasVCPerm(s.permVC.Modify)),_n(1),jr("ngIf",!s.hasVCPerm(s.permVC.Modify)),_n(3),vo("",Oa(23,47,"vcDetail.lbl.createdUpdated"),":"),_n(3),vo("",Ea(26,49,s.visbocenter.createdAt,"dd.MM.yyyy HH:mm:ss")," "),_n(3),vo("",Ea(29,52,s.visbocenter.updatedAt,"dd.MM.yyyy HH:mm:ss")," "),_n(2),jr("ngIf",s.getVCPerm()!=s.permVC.View),_n(1),jr("ngIf",s.getVCPerm()!=s.permVC.View),_n(2),jr("ngIf","Settings"==s.showList),_n(2),jr("ngIf",s.hasVCPerm(s.permVC.Modify)),_n(2),fo(Oa(38,55,"vcDetail.btn.back")),_n(7),fo(Oa(45,57,"vcDetail.titleAddUser")),_n(8),jr("ngClass",ka(67,Ay,t.submitted&&!e.valid)),_n(2),vo("",Oa(55,59,"vcDetail.lbl.email"),":"),_n(2),jr("ngModel",s.newUserInvite.email),_n(2),jr("ngIf",t.submitted&&!e.valid),_n(1),jr("ngClass",ka(69,Ay,t.submitted&&!i.valid)),_n(2),vo("",Oa(62,61,"vcDetail.lbl.group"),":"),_n(2),jr("ngModel",s.newUserInvite.groupName),_n(3),jr("ngForOf",s.vgGroups),_n(1),jr("ngIf",t.submitted&&!i.valid),_n(1),jr("ngClass",ka(71,Ay,t.submitted&&!n.valid)),_n(2),vo("",Oa(71,63,"vcDetail.lbl.message"),":"),_n(2),jr("ngModel",s.newUserInvite.inviteMessage),_n(3),jr("ngIf",t.submitted&&!n.valid),_n(3),fo(Oa(79,65,"vcDetail.btn.cancel")),_n(2),jr("ngIf",!(e.valid&&i.valid)),_n(1),jr("ngIf",e.valid&&i.valid),_n(2),jr("ngIf",s.userIndex>=0&&s.userIndex<s.vgUsers.length),_n(2),jr("ngIf",s.actGroup),_n(2),jr("ngIf",s.groupIndex>=0&&s.groupIndex<s.vgGroups.length),_n(1),jr("ngIf",s.vgUsers&&s.userIndex>=0),_n(2),jr("ngIf",s.vcSetting),_n(2),jr("ngIf",s.vcSetting)}}class hC{}let pC=(()=>{class t{constructor(t,e,i,n,s,r,o,a,l){this.messageService=t,this.visbocenterService=e,this.visbosettingService=i,this.route=n,this.location=s,this.router=r,this.alertService=o,this.translate=a,this.titleService=l,this.newUserInvite=new Zh,this.showList="Users",this.permVC=Iv,this.permVP=Sv,this.sortUserColumn=1,this.sortUserAscending=!0,this.sortVPUserColumn=1,this.sortVPUserAscending=!0,this.sortGroupColumn=1,this.sortGroupAscending=!0,this.sortSettingColumn=1,this.sortSettingAscending=!0}ngOnInit(){this.getVisboCenter(),this.getVisboCenterUsers()}getVisboCenter(){const t=this.route.snapshot.paramMap.get("id");this.visbocenterService.getVisboCenter(t).subscribe(t=>{this.visbocenter=t,this.combinedPerm=t.perm,this.titleService.setTitle(this.translate.instant("vcDetail.titleName",{name:t.name})),this.log(`VisboCenter initialised ${this.visbocenter._id} Perm ${JSON.stringify(this.combinedPerm)} `)},t=>{if(this.log(`Get VC failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vcDetail.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Gh(t))})}hasVCPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vc&t)>0}getVCPerm(){return void 0===this.combinedPerm?0:this.combinedPerm.vc}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}hasUserVCPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vc&t)>0}hasUserVPPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vp&t)>0}getVisboCenterUsers(){const t=this.route.snapshot.paramMap.get("id");this.log("VisboCenter UserList of: "+t),this.visbocenterService.getVCUsers(t).subscribe(t=>{this.vgUsers=t.users,this.vgGroups=t.groups,this.vgVPUsers=t.vpusers,this.log(`fetched Users ${this.vgUsers.length}, Groups ${this.vgGroups.length} Project Users ${this.vgVPUsers.length}`),this.sortUserTable(),this.sortGroupTable()},t=>{if(this.log(`Get VC Users failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vcDetail.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Gh(t))})}gotoVCAudit(t){this.router.navigate(["vcAudit/".concat(t._id)])}goBack(){this.location.back()}gotoVPList(t){this.router.navigate(["vp/".concat(t._id)])}gotoVPDetail(t){this.router.navigate(["vpDetail/".concat(t)])}save(){this.visbocenterService.updateVisboCenter(this.visbocenter).subscribe(t=>{const e=this.translate.instant("vcDetail.msg.updateVCSuccess",{name:t.name});this.alertService.success(e,!0),this.goBack()},t=>{if(this.log(`save VC failed: error: ${t.status} message: ${t.error.message} `),403===t.status){const t=this.translate.instant("vcDetail.msg.errorPermVC",{name:this.visbocenter.name});this.alertService.error(t)}else if(409===t.status){const t=this.translate.instant("vcDetail.msg.errorVCConflict",{name:this.visbocenter.name});this.alertService.error(t)}else this.alertService.error(Gh(t))})}switchView(t){this.showList=t,this.log("VisboCenter new View: "+t)}showSetting(){this.showList="Settings";const t=this.route.snapshot.paramMap.get("id");this.log("VisboCenter Settings of: "+t),this.visbosettingService.getVCSettings(t).subscribe(t=>{this.log("fetched VC Settings "+t.length),this.vcSettings=t,this.sortSettingTable()},t=>{if(this.log(`Get VC Settings failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vcDetail.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Gh(t))})}addNewVCUser(){const t=this.newUserInvite.email.trim(),e=this.newUserInvite.groupName.trim(),i=this.vgGroups.filter(t=>t.name===e)[0],n=i._id;let s="";this.newUserInvite.inviteMessage&&(s=this.newUserInvite.inviteMessage.trim());const r=this.visbocenter._id;this.log(`Add VisboCenter User: ${t} Group: ${e}/${n} VC: ${r}`),t&&n&&this.visbocenterService.addVCUser(t,n,s,r).subscribe(e=>{const n=new _v;n.userId=e.users.filter(e=>e.email===t)[0].userId,n.email=t,n.groupId=e._id,n.groupName=e.name,n.groupType=i.groupType,n.internal=i.internal,this.log("Add VisboCenter User Push: "+JSON.stringify(n)),this.vgUsers.push(n),this.sortUserTable();for(let t=0;t<this.vgGroups.length;t++)if(this.vgGroups[t]._id===e._id){this.vgGroups[t]=e;break}const s=this.translate.instant("vcDetail.msg.addUserSuccess",{name:t});this.alertService.success(s)},t=>{if(this.log("Add VisboCenter User error: "+JSON.stringify(t)),403===t.status){const t=this.translate.instant("vcDetail.msg.errorAddUserPerm",{name:this.visbocenter.name});this.alertService.error(t)}else t.error&&(this.log("Error during add VC user "+t.error.message),this.alertService.error(Gh(t)))})}helperUserIndex(t){this.userIndex=t}helperSettingIndex(t){this.settingIndex=t}calcCombinedPerm(t){this.userIndex=t,this.combinedUserPerm={system:0,vc:0,vp:0},this.vgUsers.forEach(this.addUserPerm,this),this.log(`Combined Permission for ${this.vgUsers[t].email}  ${JSON.stringify(this.combinedUserPerm)}`)}addUserPerm(t){if(t.email!==this.vgUsers[this.userIndex].email)return;this.log("Add User Permission for "+t.groupName);const e=this.vgGroups.findIndex(e=>e.name===t.groupName);e>=0?this.vgGroups[e].permission?(this.combinedUserPerm.system=this.combinedUserPerm.system|(this.vgGroups[e].permission.system||0),this.combinedUserPerm.vc=this.combinedUserPerm.vc|(this.vgGroups[e].permission.vc||0),this.combinedUserPerm.vp=this.combinedUserPerm.vp|(this.vgGroups[e].permission.vp||0)):this.log("Permission for Group not set "+t.groupName):this.log("Group not found "+t.groupName)}helperRemoveGroup(t){this.groupIndex=t}helperUsersPerGroup(t){const e=this.vgGroups&&this.vgGroups.find(e=>e.name===t);return e?e.users.length:0}removeVCUser(t,e){this.log(`Remove VisboCenter User: ${t.email}/${t.userId} Group: ${t.groupName} VC: ${e}`),this.visbocenterService.deleteVCUser(t,e).subscribe(()=>{this.vgUsers=this.vgUsers.filter(e=>e!==t);for(let i=0;i<this.vgGroups.length;i++)if(this.vgGroups[i]._id===t.groupId){for(let e=0;e<this.vgGroups[i].users.length;e++)if(this.vgGroups[i].users[e].userId===t.userId){this.vgGroups[i].users.splice(e,1);break}break}const e=this.translate.instant("vcDetail.msg.removeUserSuccess",{name:t.email});this.alertService.success(e)},e=>{if(this.log("Remove VisboCenter User error: "+e.error.message),403===e.status){const e=this.translate.instant("vcDetail.msg.errorRemoveUserPerm",{name:t.email});this.alertService.error(e)}else this.log("Error during remove VC user "+e.error.message),this.alertService.error(Gh(e))})}helperVCPerm(t){let e=0;return t.checkedView&&(e+=this.permVC.View),t.checkedViewAudit&&(e+=this.permVC.ViewAudit),t.checkedModify&&(e+=this.permVC.Modify),t.checkedCreateVP&&(e+=this.permVC.CreateVP),t.checkedManagePerm&&(e+=this.permVC.ManagePerm),e}helperVPPerm(t){let e=0;return t.checkedVPView&&(e+=this.permVP.View),t.checkedVPViewAudit&&(e+=this.permVP.ViewAudit),t.checkedVPModify&&(e+=this.permVP.Modify),t.checkedCreateVariant&&(e+=this.permVP.CreateVariant),t.checkedVPManagePerm&&(e+=this.permVP.ManagePerm),t.checkedVPDelete&&(e+=this.permVP.DeleteVP),e}activateGroup(t){this.log("Activate Group : "+t.groupName);const e=this.vgGroups.find(e=>e.name==t.groupName);this.initGroup(e)}activateUser(t){this.log("Activate User : "+t.email);const e=this.vgUsers.findIndex(e=>e.email==t.email);e>=0&&this.calcCombinedPerm(e)}initGroup(t){this.actGroup=new Tv,t?(this.confirm=this.translate.instant("VC"===t.groupType?"vcDetail.btn.save":"vcDetail.btn.view"),this.actGroup._id=t._id,this.log(`Init Group Set GroupID : ${this.actGroup._id} ID ${t._id}`),this.actGroup.name=t.name,this.actGroup.groupType=t.groupType,this.actGroup.internal=t.internal,this.actGroup.global=t.global,this.actGroup.checkedView=(t.permission.vc&this.permVC.View)>0,this.actGroup.checkedViewAudit=(t.permission.vc&this.permVC.ViewAudit)>0,this.actGroup.checkedModify=(t.permission.vc&this.permVC.Modify)>0,this.actGroup.checkedCreateVP=(t.permission.vc&this.permVC.CreateVP)>0,this.actGroup.checkedManagePerm=(t.permission.vc&this.permVC.ManagePerm)>0,this.actGroup.checkedVPView=(t.permission.vp&this.permVP.View)>0,this.actGroup.checkedVPViewAudit=(t.permission.vp&this.permVP.ViewAudit)>0,this.actGroup.checkedVPModify=(t.permission.vp&this.permVP.Modify)>0,this.actGroup.checkedCreateVariant=(t.permission.vp&this.permVP.CreateVariant)>0,this.actGroup.checkedVPManagePerm=(t.permission.vp&this.permVP.ManagePerm)>0,this.actGroup.checkedVPDelete=(t.permission.vp&this.permVP.DeleteVP)>0):(this.confirm=this.translate.instant("vcDetail.btn.addGroup"),this.actGroup._id=void 0,this.actGroup.name="",this.actGroup.groupType="VC",this.actGroup.internal=!1,this.actGroup.global=!1,this.actGroup.checkedView=!0),this.log(`Init Group for Creation / Modification: ${this.actGroup.name} ID ${this.actGroup._id} Action ${this.confirm} `)}addModifyVCGroup(){const t=new xv;t.name=this.actGroup.name.trim(),t.global=this.actGroup.global,t.vcid=this.visbocenter._id,t.permission=new Dv,t.permission.vc=this.helperVCPerm(this.actGroup),t.permission.vp=this.helperVPPerm(this.actGroup),this.log(`Add/Modify VisboCenter Group: Group: ${t.name} New/Modify ${this.actGroup._id}`),this.actGroup._id?(this.log(`Modify VisboCenter Group: Group: ${t.name} VC: ${t.vcid} Perm: vc ${t.permission.vc} vp ${t.permission.vp}`),t._id=this.actGroup._id,this.visbocenterService.modifyVCGroup(t).subscribe(e=>{this.vgGroups=this.vgGroups.filter(e=>e._id!==t._id),this.vgGroups.push(e);for(let n=0;n<this.vgUsers.length;n++)this.vgUsers[n].groupId===t._id&&(this.vgUsers[n].groupName=e.name);this.sortUserTable(),this.sortGroupTable();const i=this.translate.instant("vcDetail.msg.changeGroupSuccess",{name:e.name});this.alertService.success(i)},e=>{if(this.log("Modify VisboCenter Group error: "+e.error.message),403===e.status){const e=this.translate.instant("vcDetail.msg.errorChangeGroupPerm",{name:t.name});this.alertService.error(e)}else this.log("Error during modify VC Group "+e.error.message),this.alertService.error(Gh(e))})):(this.log(`Add VisboCenter Group: Group: ${t.name} VC: ${t.vcid} Perm: vc ${t.permission.vc} vp ${t.permission.vp}`),this.visbocenterService.addVCGroup(t).subscribe(e=>{this.vgGroups.push(e);const i=this.translate.instant("vcDetail.msg.createGroupSuccess",{name:t.name});this.alertService.success(i)},e=>{if(this.log("Add VisboCenter Group error: "+e.error.message),403===e.status){const e=this.translate.instant("vcDetail.msg.errorCreateGroupPerm",{name:t.name});this.alertService.error(e)}else this.log("Error during add VC Group "+e.error.message),this.alertService.error(Gh(e))}))}removeVCGroup(t){this.log(`Remove VisboCenter Group: ${t.name}/${t._id} VC: ${t.vcid}`),this.visbocenterService.deleteVCGroup(t).subscribe(e=>{this.log("Remove VisboCenter Group result: "+JSON.stringify(e)),this.vgGroups=this.vgGroups.filter(e=>e!==t),this.vgUsers=this.vgUsers.filter(e=>e.groupId!==t._id);const i=this.translate.instant("vcDetail.msg.removeGroupSuccess",{name:t.name});this.alertService.success(i)},e=>{if(this.log("Remove VisboCenter Group error: "+e.error.message),403===e.status){const e=this.translate.instant("vcDetail.msg.errorRemoveGroupPerm",{name:t.name});this.alertService.error(e)}else this.log("Error during remove VC user "+e.error.message),this.alertService.error(Gh(e))})}initSetting(t){this.vcSetting=this.vcSettings[t]}removeVCSetting(t){this.log(`Remove VisboCenter Setting: ${t.name}/${t.type} Timestamp: ${t.timestamp}`),this.visbosettingService.deleteVCSetting(t).subscribe(e=>{this.log("Remove VisboCenter Setting result: "+JSON.stringify(e)),this.vcSettings=this.vcSettings.filter(e=>e!==t);const i=this.translate.instant("vcDetail.msg.removeSettingSuccess",{name:t.name});this.alertService.success(i)},e=>{if(this.log("Remove VisboCenter Setting error: "+e.error.message),403===e.status){const e=this.translate.instant("vcDetail.msg.errorRemoveSettingPerm",{name:t.name});this.alertService.error(e)}else this.log("Error during remove VC setting "+e.error.message),this.alertService.error(Gh(e))})}calcFullPath(t,e){if(!(e&&t>=0))return;let i="",n=t,s=-1;if(e[n]){const t=e[n]&&e[n].pid;t>=0&&(e[n].parent=e[t]&&e[t].name)}for(;n>=0&&e[n];)i="/".concat(e[n].name,i),n=e[n].pid,s+=1;e[t].path=i,e[t].level=s}downloadSetting(){var t;const e=this.vcSetting;if(this.log(`Download Setting ${e.name} ${e.type} ${e.updatedAt}`),"organisation"==e.type&&(null===(t=e.value)||void 0===t?void 0:t.allRoles)){const t=[];for(let h=0;e.value.allRoles&&h<e.value.allRoles.length;h++){const i=e.value.allRoles[h],n=i.uid;t[n]||(t[n]=new hC,t[n].uid=n,t[n].calcid=n,t[n].pid=void 0),t[n].name=i.name,t[n].isExternRole=i.isExternRole,t[n].defaultKapa=i.defaultKapa,t[n].tagessatz=i.tagessatzIntern,t[n].employeeNr=i.employeeNr,t[n].defaultDayCapa=i.defaultDayCapa,i.entryDate>"0001-01-01T00:00:00Z"&&(t[n].entryDate=i.entryDate),i.exitDate<"2200-11-30T23:00:00Z"&&(t[n].exitDate=i.exitDate),t[n].aliases=i.aliases,i.isTeam?(this.log("Skip Handling of Team Members"),t[n].type=2,t[n].isTeam=!0):t[n].type=1;for(let e=0;e<i.subRoleIDs.length;e++){const s=Number(i.subRoleIDs[e].key);if(s<0){this.log(`Inconsistent Org Structure Role ${n} SubRole ${i.subRoleIDs[e].key}`);break}t[s]?this.log(`SubRole already exists ${n} SubRole ${s}`):(t[s]=new hC,t[s].uid=s,t[s].calcid=s),t[s].pid||(t[s].pid=n)}}let i=0;e.value.allRoles.forEach(t=>{t.uid>i&&(i=t.uid)}),this.log("MaxID "+i);for(let h=0;h<e.value.allRoles.length;h++){const n=e.value.allRoles[h];if(n.isTeam&&n.subRoleIDs&&n.subRoleIDs.length>0)for(let e=0;e<n.subRoleIDs.length;e++){const s=n.subRoleIDs[e].key;if(!t[s]||t[s].isTeam)continue;const r=t[s];i+=1,t[i]=new hC,t[i].uid=s,t[i].calcid=i,t[i].type=2,t[i].pid=n.uid,t[i].name=r.name,t[i].parent=n.name,r.employeeNr&&(t[i].employeeNr=r.employeeNr),r.isExternRole&&(t[i].isExternRole=r.isExternRole),r.defaultDayCapa>=0&&(t[i].defaultDayCapa=r.defaultDayCapa),r.defaultKapa>=0&&(t[i].defaultKapa=r.defaultKapa),r.tagessatz>=0&&(t[i].tagessatz=r.tagessatz),r.entryDate&&(t[i].entryDate=r.entryDate),r.exitDate&&(t[i].exitDate=r.exitDate),r.aliases&&(t[i].aliases=r.aliases),t[i].percent=Number(n.subRoleIDs[e].value)||0}}t.forEach(e=>this.calcFullPath(e.calcid,t)),t.sort((function(t,e){return t.type!=e.type?t.type-e.type:xh(t.path,e.path)}));const n=[];for(let h=0;e.value.allCosts&&h<e.value.allCosts.length;h++){const t=e.value.allCosts[h],i=t.uid;n[i]||(n[i]=new hC,n[i].uid=i,n[i].calcid=i,n[i].pid=void 0),n[i].name=t.name,n[i].type=3;for(let e=0;t.subCostIDs&&e<t.subCostIDs.length;e++){const s=Number(t.subCostIDs[e].key);if(s<0){this.log(`Inconsistent Org Structure Cost ${i} SubCost ${t.subCostIDs[e].key}`);break}n[s]?this.log(`listCost already exists ${i} listCost ${s}`):(n[s]=new hC,n[s].uid=s,n[s].calcid=s),n[s].pid=i}}n.forEach(t=>this.calcFullPath(t.calcid,n)),n.sort((function(t,e){return t.type!=e.type?t.type-e.type:xh(t.path,e.path)})),n.forEach(e=>t.push(e)),this.log("Orga Structure "+JSON.stringify(t));let s="";const r="\t";s="sep="+r+"\n",s=s+"name"+r+"uid"+r+"type"+r+"organisation"+r+"isExternal"+r+"isTeam"+r+"defaultKapa"+r+"tagessatz"+r+"employeeNr"+r+"defaultDayCapa"+r+"entryDate"+r+"exitDate"+r+"percent"+r+"aliases\n";for(let e=0;e<t.length;e++){const i=t[e];if(!i)continue;const n='"'+i.name.padStart(i.name.length+i.level," ")+'"'+r+i.uid+r+(i.type||"")+r+(i.parent||"")+r+(i.isExternRole?"1":"")+r+(i.isTeam?"1":"")+r+(i.defaultKapa||"").toLocaleString()+r+(i.tagessatz||"").toLocaleString()+r+(i.employeeNr||"")+r+(i.defaultDayCapa||"").toLocaleString()+r+(i.entryDate?new Date(i.entryDate).toLocaleDateString():"")+r+(i.exitDate?new Date(i.exitDate).toLocaleDateString():"")+r+(i.percent?i.percent.toLocaleString():"")+r+(i.aliases&&i.aliases.length>0?i.aliases.join("#"):"")+"\n";s=s.concat(n)}this.log(`VC Setting Orga CSV Len ${s.length} `);const o=new Blob([s],{type:"text/csv;charset=utf-8"});s="\ufeff"+s;const a=window.URL.createObjectURL(o);this.log("Open URL "+a);const l=document.createElement("a");document.body.appendChild(l),l.href=a;const c=new Date(e.timestamp),d=(c.getMonth()+1).toString(),u=c.getFullYear()+"-"+d.padStart(2,"0");l.download=`VisboCenterOrganisation_${u}.csv`,this.log(`Open URL ${a} doc ${JSON.stringify(l)}`),l.click(),window.URL.revokeObjectURL(a)}else{const t=JSON.stringify(e.value);this.log(`VC Setting JSON Len ${t.length} `);const i=new Blob([t],{type:"text/plain"}),n=window.URL.createObjectURL(i);this.log("Open URL "+n);const s=document.createElement("a");document.body.appendChild(s),s.href=n,s.download=`VisboCenterSetting_${e.name}.json`,this.log(`Open URL ${n} doc ${JSON.stringify(s)}`),s.click(),window.URL.revokeObjectURL(n)}}sortUserTable(t){this.vgUsers&&(void 0===t&&void 0!==this.sortUserColumn||(t!==this.sortUserColumn&&(this.sortUserColumn=t,this.sortUserAscending=void 0),this.sortUserAscending=void 0===this.sortUserAscending?1===t||2===t:!this.sortUserAscending),1===this.sortUserColumn?this.vgUsers.sort((function(t,e){return xh(t.email,e.email)})):2===this.sortUserColumn&&this.vgUsers.sort((function(t,e){return xh(t.groupName.toLowerCase(),e.groupName.toLowerCase())})),this.sortUserAscending||this.vgUsers.reverse())}sortVPUserTable(t){this.vgVPUsers&&(void 0===t&&void 0!==this.sortVPUserColumn||(t!==this.sortVPUserColumn&&(this.sortVPUserColumn=t,this.sortVPUserAscending=void 0),this.sortVPUserAscending=void 0===this.sortVPUserAscending?1===t||2===t:!this.sortVPUserAscending),1===this.sortVPUserColumn?this.vgVPUsers.sort((function(t,e){return xh(t.users.email,e.users.email)})):2===this.sortVPUserColumn&&this.vgVPUsers.sort((function(t,e){return xh(t.vp.name.toLowerCase(),e.vp.name.toLowerCase())})),this.log(`Sort VP Users Column ${this.sortVPUserColumn} Reverse: ${this.sortVPUserAscending}`),this.sortVPUserAscending||this.vgVPUsers.reverse())}sortGroupTable(t){this.vgGroups&&(void 0===t&&void 0!==this.sortGroupColumn||(t!==this.sortGroupColumn&&(this.sortGroupColumn=t,this.sortGroupAscending=void 0),this.sortGroupAscending=void 0===this.sortGroupAscending?1===t:!this.sortGroupAscending),1===this.sortGroupColumn?this.vgGroups.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortGroupColumn&&this.vgGroups.sort((function(t,e){return e.users.length-t.users.length})),this.sortGroupAscending||this.vgGroups.reverse())}sortSettingTable(t){this.vcSettings&&(void 0===t&&void 0!==this.sortSettingColumn||(t!==this.sortSettingColumn&&(this.sortSettingColumn=t,this.sortSettingAscending=void 0),this.sortSettingAscending=void 0===this.sortSettingAscending?1===t:!this.sortSettingAscending),1===this.sortSettingColumn?this.vcSettings.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortSettingColumn?this.vcSettings.sort((function(t,e){return Th(t.timestamp,e.timestamp)})):3===this.sortSettingColumn&&this.vcSettings.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})),this.sortSettingAscending||this.vcSettings.reverse())}isToday(t){return this.today||(this.today=new Date,this.today.setHours(0,0,0,0)),new Date(t)>=this.today}log(t){this.messageService.add("VisboCenter Details: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(Ev),Rr(Eb),Rr(Bg),Rr(Xl),Rr(rf),Rr(Mf),Rr(av),Rr(Md))},t.\u0275cmp=le({type:t,selectors:[["app-visbocenter-detail"]],inputs:{visbocenter:"visbocenter"},decls:2,vars:1,consts:[[4,"ngIf"],[3,"click"],[1,"form-group","row"],["for","vcName",1,"col-3","col-md-2","col-form-label"],["id","VCName","type","text","name","vcName","class","col-8 form-control","placeholder","Name",3,"ngModel","ngModelChange",4,"ngIf"],["id","VCName","class","col-8 form-control-static",4,"ngIf"],["for","vcDescription",1,"col-3","col-md-2","col-form-label"],["id","VCDesc","name","vcDescription","class","col-8 form-control","placeholder","Type in your description",3,"ngModel","ngModelChange",4,"ngIf"],["id","VCDesc","class","col-8 form-control-static",4,"ngIf"],[1,"form-group","row","d-none","d-md-block"],["for","Created",1,"col-3","col-md-2","col-form-label"],["id","VCCreated",1,"col-4","form-control-static","col-form-label"],["id","VCUpdated",1,"col-4","form-control-static","col-form-label"],[1,"mb-3"],["id","Save","class","btn btn-primary mx-1",3,"click",4,"ngIf"],[1,"btn","btn-secondary","mx-1",3,"click"],["id","VcUserModalCreate","tabindex","-1","role","dialog","aria-labelledby","VcUserModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VcUserModalCenterTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["name","newUserInvite","novalidate",""],["f1","ngForm"],[1,"form-group",3,"ngClass"],["for","email",1,"col-form-label"],["id","AddUserName","type","email","name","email","required","","pattern","[^@\\s]+@[^@\\s]+\\.[^@\\s]+","autocomplete","email",1,"form-control",3,"ngModel","ngModelChange"],["email","ngModel"],["class","help-block",4,"ngIf"],["for","group",1,"col-form-label"],["id","AddUserGroupName","name","group","required","",1,"form-control",3,"ngModel","ngModelChange"],["group","ngModel"],[4,"ngFor","ngForOf"],["for","inviteMessage",1,"col-form-label"],["id","AddUserMessage","name","inviteMessage",1,"form-control",3,"ngModel","ngModelChange"],["inviteMessage","ngModel"],[1,"modal-footer","align-items-end"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-secondary","mx-1"],["id","AddUserConfirm","type","submit","class","btn btn-primary mx-1",4,"ngIf"],["id","AddUserConfirm","type","submit","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","VcUserRemove","tabindex","-1","role","dialog","aria-labelledby","VcUserModalRemoveTitle","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-dialog-centered","role","document",4,"ngIf"],["id","VcGroupModalCreate","tabindex","-1","role","dialog","aria-labelledby","VcGroupModalCreateTitle","aria-hidden","true",1,"modal","fade"],["id","VcGroupRemove","tabindex","-1","role","dialog","aria-labelledby","VcGroupModalRemoveTitle","aria-hidden","true",1,"modal","fade"],["class","modal fade","id","VCUserDetail","tabindex","-1","role","dialog","aria-labelledby","VCUserDetailTitle","aria-hidden","true",4,"ngIf"],["id","VcSettingDetail","tabindex","-1","role","dialog","aria-labelledby","VcSettingDetailTitle","aria-hidden","true",1,"modal","fade"],["id","VcSettingRemove","tabindex","-1","role","dialog","aria-labelledby","VcSettingRemoveTitle","aria-hidden","true",1,"modal","fade"],["id","VCName","type","text","name","vcName","placeholder","Name",1,"col-8","form-control",3,"ngModel","ngModelChange"],["id","VCName",1,"col-8","form-control-static"],["id","VCDesc","name","vcDescription","placeholder","Type in your description",1,"col-8","form-control",3,"ngModel","ngModelChange"],["id","VCDesc",1,"col-8","form-control-static"],[1,"btn-toolbar"],["id","ViewAudit","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["id","ViewGroup","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewUser","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewProjectUser","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewSetting","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewAudit","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["id","ViewGroup","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],["id","ViewUser","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],["id","ViewProjectUser","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],["id","ViewSetting","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],[1,"row"],[1,"col"],[1,"panel-heading","mt-2"],["class","col",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover"],["id","UserHead"],["id","UserList"],["id","AddUser","type","button","data-toggle","modal","data-target","#VcUserModalCreate",1,"my-1","btn","btn-primary","float-right"],["id","ColUser","data-toggle","modal","data-target","#VCUserDetail",3,"click"],["id","ColGroup",3,"click"],["id","ColDeleteUser","data-toggle","modal","data-target","#VcUserRemove",1,"Detail",3,"title","click"],[1,"panel-heading","mt-3"],["id","GroupHead"],["id","GroupList"],["id","AddGroup","type","button","data-toggle","modal","data-target","#VcGroupModalCreate",1,"btn","btn-primary","float-right",3,"click"],["id","ColGroup","data-toggle","modal","data-target","#VcGroupModalCreate",3,"click"],["id","ColMembers",3,"click"],["id","ColGlobal",4,"ngIf"],["id","ColDetail","data-toggle","modal","data-target","#VcGroupModalCreate",1,"Detail",3,"title","click"],["id","ColGlobal"],["id","ColDeleteGroup","data-toggle","modal","data-target","#VcGroupRemove",1,"Detail",3,"title","click"],[1,"panel-heading"],[3,"click",4,"ngFor","ngForOf"],["id","SettingHead"],["id","SettingList"],["id","ColSettingName","data-toggle","modal","data-target","#VcSettingDetail",3,"click"],["id","ColSettingTimestamp"],["id","ColSettingDate",4,"ngIf"],["id","ColSettingDate"],["id","ColDeleteSetting","data-toggle","modal","data-target","#VcSettingRemove",1,"Detail",3,"title","click"],["id","Save",1,"btn","btn-primary","mx-1",3,"click"],[1,"help-block"],["id","AddUserConfirm","type","submit",1,"btn","btn-primary","mx-1"],["id","AddUserConfirm","type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["id","VcUserRemoveTitle",1,"modal-title"],[1,"bg-warning"],[1,"form-group"],["for","VcName",1,"col-form-label"],[1,"col-8","form-control-static"],[1,"col-form-label"],["type","button","data-dismiss","modal",1,"btn","btn-secondary","mx-1"],["id","DeleteUserConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning","mx-1",3,"click"],["class","modal-title","id","VcGroupModalCenterTitle",4,"ngIf"],["name","actGroup","novalidate",""],["f2","ngForm"],["class","form-group",3,"ngClass",4,"ngIf"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","perm1","name","checkedView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedView","ngModel"],["for","perm1",1,"custom-control-label"],["type","checkbox","id","perm2","name","checkedViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedViewAudit","ngModel"],["for","perm2",1,"custom-control-label"],["type","checkbox","id","perm3","name","checkedModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedModify","ngModel"],["for","perm3",1,"custom-control-label"],["type","checkbox","id","perm4","name","checkedCreateVP",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVP","ngModel"],["for","perm4",1,"custom-control-label"],["type","checkbox","id","perm5","name","checkedManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedManagePerm","ngModel"],["for","perm5",1,"custom-control-label"],["type","checkbox","id","global","name","global",1,"custom-control-input",3,"ngModel","ngModelChange"],["global","ngModel"],["for","global",1,"custom-control-label"],["class","mt-2",4,"ngIf"],["id","AddGroupConfirm","class","btn btn-primary disabled mx-1",4,"ngIf"],["id","AddGroupConfirm","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","VcGroupModalCenterTitle",1,"modal-title"],["for","groupName",1,"col-form-label"],["name","groupName",1,"col-form-label"],["id","AddGroupName","type","text","name","groupName","required","","minlength","3",1,"form-control",3,"ngModel","ngModelChange"],["groupName","ngModel"],[1,"mt-2"],["type","checkbox","id","permVP1","name","checkedVPView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPView","ngModel"],["for","permVP1",1,"custom-control-label"],["type","checkbox","id","permVP2","name","checkedVPViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPViewAudit","ngModel"],["for","permVP2",1,"custom-control-label"],["type","checkbox","id","permVP3","name","checkedVPModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPModify","ngModel"],["for","permVP3",1,"custom-control-label"],["type","checkbox","id","permVP4","name","checkedCreateVariant",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVariant","ngModel"],["for","permVP4",1,"custom-control-label"],["type","checkbox","id","permVP5","name","checkedVPManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPManagePerm","ngModel"],["for","permVP5",1,"custom-control-label"],["type","checkbox","id","permVP6","name","checkedVPDelete",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPDelete","ngModel"],["for","permVP6",1,"custom-control-label"],[1,"form-control-static"],["class","row",4,"ngFor","ngForOf"],["class","col-8 ml-3",4,"ngIf"],[1,"col-8","ml-3"],["data-dismiss","modal","data-toggle","modal","data-target","#VCUserDetail",3,"click"],["id","AddGroupConfirm",1,"btn","btn-primary","disabled","mx-1"],["id","AddGroupConfirm","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["id","DeleteGroupConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning","mx-1",3,"click"],["id","VCUserDetail","tabindex","-1","role","dialog","aria-labelledby","VCUserDetailTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],["id","VCUserDetailTitle",1,"modal-title"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],[1,"form-control-static","mt-2"],["id","ButtonBack","data-dismiss","modal",1,"btn","btn-primary"],["type","checkbox","checked","","disabled","","id","perm1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["data-dismiss","modal","data-toggle","modal","data-target","#VcGroupModalCreate",3,"click"],["id","VcSettingDetailTitle",1,"modal-title"],["name","settingDetail"],["for","SettingName",1,"col-4","col-form-label"],["id","SettingName",1,"col-8","form-control-static"],["for","SettingType",1,"col-4","col-form-label"],["id","SettingType",1,"col-8","form-control-static"],["for","Timestamp",1,"col-4","col-form-label"],["id","Timestamp",1,"col-8","form-control-static"],["for","updatedAt",1,"col-4","col-form-label"],["id","updatedAt",1,"col-8","form-control-static"],["id","SettingDownload","type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["id","VcSettingRemoveTitle",1,"modal-title"],["class","form-group",4,"ngIf"],["for","SettingUpdated",1,"col-4","col-form-label"],["for","SettingTS",1,"col-4","col-form-label"]],template:function(t,e){1&t&&(Br(0,"app-usernavbar"),Lr(1,uC,93,73,"div",0)),2&t&&(_n(1),jr("ngIf",e.visbocenter))},directives:[Pb,jc,Eu,Fd,Tu,Ec,Ed,Ru,Hu,Nd,Ou,cu,du,gu,Gc,_d,Fu],pipes:[lv,Kc,qc],styles:[""]}),t})();class gC{}const mC=new th({"Content-Type":"application/json"});let fC=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.serviceBaseUrl=this.env.restUrl}getVisboAudits(t,e){const i=this.serviceBaseUrl.concat("/audit");let n=new nh;return t&&(n=n.append("sysadmin","1")),e&&(e.from&&(n=n.append("from",e.from.toISOString())),e.to&&(n=n.append("to",e.to.toISOString())),e.text&&(n=n.append("text",e.text)),e.maxcount&&(n=n.append("maxcount",e.maxcount.toString())),e.actionType&&(n=n.append("action",e.actionType)),e.area&&(n=n.append("area",e.area))),this.log(`Calling HTTP Request: ${i} ${t?"as sysadmin":""}`),this.http.get(i,{headers:mC,params:n}).pipe(D(t=>t.audit),qh(t=>this.log(`fetched ${t.length} Audits `)),Fh(this.handleError("getVisboAudit",[])))}getVisboCenterAudits(t,e,i,n){const s=this.serviceBaseUrl.concat("/vc/",t,"/audit");let r=new nh;return e&&(r=r.append("sysadmin","1")),i&&(r=r.append("deleted","1")),n&&(n.from&&(r=r.append("from",n.from.toISOString())),n.to&&(r=r.append("to",n.to.toISOString())),n.text&&(r=r.append("text",n.text)),n.maxcount&&(r=r.append("maxcount",n.maxcount.toString())),n.actionType&&(r=r.append("action",n.actionType)),n.area&&(r=r.append("area",n.area))),this.log(`Calling HTTP Request: ${s} for VC ${t}`),this.http.get(s,{headers:mC,params:r}).pipe(D(t=>t.audit),qh(t=>this.log(`fetched ${t.length} Audits `)),Fh(this.handleError("getVisboAudit",[])))}getVisboProjectAudits(t,e,i,n){const s=this.serviceBaseUrl.concat("/vp/",t,"/audit");let r=new nh;return e&&(r=r.append("sysadmin","1")),i&&(r=r.append("deleted","1")),n&&(n.from&&(r=r.append("from",n.from.toISOString())),n.to&&(r=r.append("to",n.to.toISOString())),n.text&&(r=r.append("text",n.text)),n.maxcount&&(r=r.append("maxcount",n.maxcount.toString())),n.actionType&&(r=r.append("action",n.actionType)),n.area&&(r=r.append("area",n.area))),this.log(`Calling HTTP Request: ${s} for VP ${t}`),this.http.get(s,{headers:mC,params:r}).pipe(D(t=>t.audit),qh(t=>this.log(`fetched ${t.length} Audits `)),Fh(this.handleError("getVisboAudit",[])))}handleError(t="operation",e){return i=>(this.log(`HTTP Request ${t} failed: ${i.error.message} status:${i.status} result: ${JSON.stringify(e)}`),$h(i))}log(t){this.messageService.add("VisboAuditService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(jh),Kt(sp))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function vC(t,e){if(1&t){const t=zr();Nr(0,"li",6),Nr(1,"a",7),Jr("click",(function(){return ei(t),Xr().gotoClickedItem("sysvc")})),mo(2,"Visbo Centers"),Fr(),Fr()}}function bC(t,e){if(1&t){const t=zr();Nr(0,"li",6),Nr(1,"a",7),Jr("click",(function(){return ei(t),Xr().gotoClickedItem("sysaudit")})),mo(2,"Audit"),Fr(),Fr()}}function yC(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"a",13),Jr("click",(function(){return ei(t),Xr().gotoClickedItem("syslog")})),mo(2,"Log Files"),Fr(),Fr()}}let CC=(()=>{class t{constructor(t,e,i,n,s){this.route=t,this.router=e,this.alertService=i,this.messageService=n,this.visbocenterService=s,this.permSystem=Mv,this.permVC=Iv,this.permVP=Sv}ngOnInit(){this.combinedPerm=this.visbocenterService.getSysAdminRole(),this.log(`Navbar Init Sys Role ${JSON.stringify(this.combinedPerm)} ${this.permSystem.View}`)}gotoClickedItem(t){this.router.navigate([t])}hasSystemPerm(t){return(this.combinedPerm.system&t)>0}hasVCPerm(t){return(this.combinedPerm.vc&t)>0}log(t){this.messageService.add("Sys NavBar: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Bg),Rr(rf),Rr(Mf),Rr(jh),Rr(Ev))},t.\u0275cmp=le({type:t,selectors:[["app-sysnavbar"]],decls:29,vars:3,consts:[[1,"navbar","navbar-expand-md","bg-light","sticky-top"],[1,"navbar-brand","bg-light",3,"click"],["type","button","data-toggle","collapse","data-target","#navbarSupportedContent","aria-controls","navbarSupportedContent","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"fas","fa-bars"],["id","navbarSupportedContent",1,"collapse","navbar-collapse"],[1,"navbar-nav","mr-auto"],[1,"nav-item"],[1,"nav-link","bg-light",3,"click"],["class","nav-item",4,"ngIf"],[1,"nav-item","dropdown"],["href","#","id","navbarDropdown","role","button","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"nav-link","dropdown-toggle","bg-light"],["aria-labelledby","navbarDropdown",1,"dropdown-menu"],[4,"ngIf"],[1,"dropdown-item",3,"click"],[1,"nav-link","bg-light","align-right",3,"click"]],template:function(t,e){1&t&&(Nr(0,"nav",0),Nr(1,"a",1),Jr("click",(function(){return e.gotoClickedItem("sysdashboard")})),mo(2,"Overviews"),Fr(),Nr(3,"button",2),Br(4,"i",3),Fr(),Nr(5,"div",4),Nr(6,"ul",5),Nr(7,"li",6),Nr(8,"a",7),Jr("click",(function(){return e.gotoClickedItem("sysadmins")})),mo(9,"Administrators"),Fr(),Fr(),Lr(10,vC,3,0,"li",8),Nr(11,"li",6),Nr(12,"a",7),Jr("click",(function(){return e.gotoClickedItem("sysuser")})),mo(13,"Users"),Fr(),Fr(),Lr(14,bC,3,0,"li",8),Nr(15,"li",9),Nr(16,"a",10),mo(17," Others "),Fr(),Nr(18,"div",11),Lr(19,yC,3,0,"div",12),Nr(20,"div"),Nr(21,"a",13),Jr("click",(function(){return e.gotoClickedItem("systasks")})),mo(22,"Tasks"),Fr(),Fr(),Nr(23,"div"),Nr(24,"a",13),Jr("click",(function(){return e.gotoClickedItem("sysconfig")})),mo(25,"Configuration"),Fr(),Fr(),Fr(),Fr(),Nr(26,"li",6),Nr(27,"a",14),Jr("click",(function(){return e.gotoClickedItem("/")})),mo(28,"Back"),Fr(),Fr(),Fr(),Fr(),Fr()),2&t&&(_n(10),jr("ngIf",e.hasVCPerm(e.permVC.View)),_n(4),jr("ngIf",e.hasSystemPerm(e.permSystem.ViewAudit)),_n(5),jr("ngIf",e.hasSystemPerm(e.permSystem.ViewLog)))},directives:[jc],styles:[".navbar[_ngcontent-%COMP%]{padding:0;margin-bottom:1em;margin-top:1em}"]}),t})();function VC(t,e){1&t&&(Nr(0,"div"),Br(1,"app-usernavbar"),Fr())}function wC(t,e){1&t&&(Nr(0,"div"),Br(1,"app-sysnavbar"),Fr())}function AC(t,e){if(1&t){const t=zr();Nr(0,"div",11),Nr(1,"label",34),mo(2),Ua(3,"translate"),Fr(),Nr(4,"input",35),Jr("ngModelChange",(function(e){return ei(t),Xr(2).auditFrom=e})),Fr(),Nr(5,"label",36),mo(6),Ua(7,"translate"),Fr(),Nr(8,"input",37),Jr("ngModelChange",(function(e){return ei(t),Xr(2).auditTo=e})),Fr(),Fr()}if(2&t){const t=Xr(2);_n(2),vo("",Oa(3,4,"vcAudit.lbl.from"),":"),_n(2),jr("ngModel",t.auditFrom),_n(2),vo("",Oa(7,6,"vcAudit.lbl.to"),":"),_n(2),jr("ngModel",t.auditTo)}}function PC(t,e){if(1&t){const t=zr();Nr(0,"div",11),Nr(1,"label",34),mo(2),Ua(3,"translate"),Fr(),Nr(4,"input",38),Jr("ngModelChange",(function(e){return ei(t),Xr(2).auditFrom=e})),Fr(),Nr(5,"label",36),mo(6),Ua(7,"translate"),Fr(),Nr(8,"input",39),Jr("ngModelChange",(function(e){return ei(t),Xr(2).auditTo=e})),Fr(),Fr()}if(2&t){const t=Xr(2);_n(2),vo("",Oa(3,4,"vcAudit.lbl.from"),":"),_n(2),jr("ngModel",t.auditFrom),_n(2),vo("",Oa(7,6,"vcAudit.lbl.to"),":"),_n(2),jr("ngModel",t.auditTo)}}function kC(t,e){if(1&t&&(Nr(0,"option",40),mo(1),Ua(2,"translate"),Fr()),2&t){const t=e.$implicit;to("value",t.name),_n(1),fo(Oa(2,2,"vcAudit.dropDown."+t.name))}}function DC(t,e){if(1&t&&(Nr(0,"option",40),mo(1),Ua(2,"translate"),Fr()),2&t){const t=e.$implicit;to("value",t.name),_n(1),fo(Oa(2,2,"vcAudit.dropDown."+t.name))}}function MC(t,e){if(1&t&&(Nr(0,"td",49),mo(1),Ua(2,"date"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.createdAt,"HH:mm:ss"))}}function IC(t,e){if(1&t&&(Nr(0,"td",49),mo(1),Ua(2,"date"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.createdAt,"dd.MM HH:mm"))}}function SC(t,e){if(1&t&&(Nr(0,"td",50),mo(1),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(t.user.email)}}function xC(t,e){1&t&&(Nr(0,"td",50),mo(1," Unknown "),Fr())}function TC(t,e){if(1&t){const t=zr();Nr(0,"tr",41),Jr("click",(function(){ei(t);const i=e.index;return Xr(2).helperAuditIndex(i)})),Lr(1,MC,3,4,"td",42),Lr(2,IC,3,4,"td",42),Lr(3,SC,2,1,"td",43),Lr(4,xC,2,0,"td",43),Nr(5,"td",44),mo(6),Fr(),Nr(7,"td",45),mo(8),Fr(),Nr(9,"td",46),mo(10),Fr(),Nr(11,"td",47),mo(12),Fr(),Nr(13,"td"),Nr(14,"button",48),Jr("click",(function(){ei(t);const i=e.index;return Xr(2).helperAuditIndex(i)})),mo(15,"i"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit,i=Xr(2);_n(1),jr("ngIf",i.isToday(t.createdAt)),_n(1),jr("ngIf",!i.isToday(t.createdAt)),_n(1),jr("ngIf",t.user),_n(1),jr("ngIf",!t.user),_n(2),fo(t.actionDescription),_n(2),fo(t.vp?t.vp.name:""),_n(2),fo(i.helperShortenText(t.actionInfo,30)),_n(2),fo(i.helperResponseText(t))}}function _C(t,e){1&t&&(Nr(0,"div"),Nr(1,"h3",51),mo(2),Ua(3,"translate"),Fr(),Fr()),2&t&&(_n(2),vo(" ",Oa(3,1,"vcAudit.msg.noAudit")," "))}function UC(t,e){if(1&t){const t=zr();Nr(0,"div",4),Nr(1,"div",5),Nr(2,"h2",6),mo(3),Ua(4,"translate"),Nr(5,"a",7),Jr("click",(function(){return ei(t),Xr().goBack()})),mo(6),Fr(),Fr(),Fr(),Nr(7,"form",8,9),Jr("ngSubmit",(function(){return ei(t),Xr().getVisboCenterAudits()})),Lr(9,AC,9,8,"div",10),Lr(10,PC,9,8,"div",10),Nr(11,"div",11),Nr(12,"label",12),mo(13),Ua(14,"translate"),Fr(),Nr(15,"input",13),Jr("ngModelChange",(function(e){return ei(t),Xr().auditText=e})),Fr(),Nr(16,"label",14),mo(17),Ua(18,"translate"),Fr(),Nr(19,"select",15),Jr("ngModelChange",(function(e){return ei(t),Xr().auditCount=e})),Nr(20,"option"),mo(21,"50"),Fr(),Nr(22,"option"),mo(23,"100"),Fr(),Nr(24,"option"),mo(25,"500"),Fr(),Nr(26,"option"),mo(27,"2000"),Fr(),Fr(),Nr(28,"select",16),Jr("ngModelChange",(function(e){return ei(t),Xr().auditArea=e})),Lr(29,kC,3,4,"option",17),Fr(),Nr(30,"select",18),Jr("ngModelChange",(function(e){return ei(t),Xr().auditType=e})),Lr(31,DC,3,4,"option",17),Fr(),Nr(32,"div",19),Nr(33,"button",20),Jr("click",(function(){return ei(t),Xr().getVisboCenterAudits()})),mo(34),Ua(35,"translate"),Fr(),Nr(36,"button",21),Jr("click",(function(){return ei(t),Xr().downloadVisboAudit()})),mo(37),Ua(38,"translate"),Fr(),Fr(),Fr(),Fr(),Nr(39,"div",22),Nr(40,"div",23),Nr(41,"table",24),Nr(42,"thead",25),Nr(43,"tr"),Nr(44,"th",26),Jr("click",(function(){return ei(t),Xr().sortTable(1)})),mo(45),Ua(46,"translate"),Fr(),Nr(47,"th",27),Jr("click",(function(){return ei(t),Xr().sortTable(2)})),mo(48),Ua(49,"translate"),Fr(),Nr(50,"th",28),Jr("click",(function(){return ei(t),Xr().sortTable(3)})),mo(51),Ua(52,"translate"),Fr(),Nr(53,"th",29),Jr("click",(function(){return ei(t),Xr().sortTable(8)})),mo(54),Ua(55,"translate"),Fr(),Nr(56,"th",30),Jr("click",(function(){return ei(t),Xr().sortTable(4)})),mo(57),Ua(58,"translate"),Fr(),Nr(59,"th",31),Jr("click",(function(){return ei(t),Xr().sortTable(5)})),mo(60),Ua(61,"translate"),Fr(),Nr(62,"th"),mo(63,"Detail"),Fr(),Fr(),Fr(),Nr(64,"tbody",32),Lr(65,TC,16,8,"tr",33),Fr(),Fr(),Lr(66,_C,4,3,"div",0),Fr(),Fr(),Fr()}if(2&t){const t=Xr();_n(3),vo(" ",Oa(4,22,"vcAudit.title"),": "),_n(3),fo(t.visbocenter.name),_n(3),jr("ngIf",t.sysadmin),_n(1),jr("ngIf",!t.sysadmin),_n(3),vo("",Oa(14,24,"vcAudit.lbl.filter"),":"),_n(2),jr("ngModel",t.auditText),_n(2),vo("",Oa(18,26,"vcAudit.lbl.max"),":"),_n(2),jr("ngModel",t.auditCount),_n(9),jr("ngModel",t.auditArea),_n(1),jr("ngForOf",t.auditAreaList),_n(1),jr("ngModel",t.auditType),_n(1),jr("ngForOf",t.auditTypeList),_n(3),fo(Oa(35,28,"vcAudit.btn.filter")),_n(3),fo(Oa(38,30,"vcAudit.btn.download")),_n(8),fo(Oa(46,32,"vcAudit.lbl.created")),_n(3),fo(Oa(49,34,"vcAudit.lbl.user")),_n(3),vo(" ",Oa(52,36,"vcAudit.lbl.action"),""),_n(3),vo(" ",Oa(55,38,"vcAudit.lbl.vp"),""),_n(3),vo(" ",Oa(58,40,"vcAudit.lbl.info"),""),_n(3),vo(" ",Oa(61,42,"vcAudit.lbl.result"),""),_n(5),jr("ngForOf",t.audit),_n(1),jr("ngIf",t.audit&&0==t.audit.length)}}function OC(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",66),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",75),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vcAudit.lbl.info"),":"),_n(3),vo("",t.audit[t.auditIndex].actionInfo," ")}}function EC(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",66),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",76),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vcAudit.lbl.vc"),":"),_n(3),vo("",t.audit[t.auditIndex].vc.name," ")}}function LC(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",66),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",77),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,3,"vcAudit.lbl.vp"),":"),_n(3),bo("",t.audit[t.auditIndex].vp.name," (",t.audit[t.auditIndex].vp.vpid,") ")}}function GC(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",66),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",78),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,3,"vcAudit.lbl.vpv"),":"),_n(3),bo("",t.audit[t.auditIndex].vpv.name," (",t.audit[t.auditIndex].vpv.vpvid,")")}}function RC(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",66),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",70),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vcAudit.lbl.techAction"),":"),_n(3),vo("",t.audit[t.auditIndex].action," ")}}function jC(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",66),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",79),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vcAudit.lbl.url"),":"),_n(3),vo("",t.audit[t.auditIndex].url," ")}}function $C(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",66),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",70),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vcAudit.lbl.responseTime"),":"),_n(3),vo("",t.audit[t.auditIndex].result.time," ms ")}}function NC(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",66),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",70),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vcAudit.lbl.responseSize"),":"),_n(3),vo("",t.helperFormatBytes(t.audit[t.auditIndex].result.size||0,2)," ")}}function FC(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",66),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",70),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vcAudit.lbl.userAgent"),":"),_n(3),fo(t.audit[t.auditIndex].userAgent)}}function BC(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",66),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",70),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vcAudit.lbl.ip"),":"),_n(3),fo(t.audit[t.auditIndex].ip)}}function HC(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",66),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",70),mo(5),Ua(6,"date"),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vcAudit.lbl.ttl"),":"),_n(3),fo(Ea(6,4,t.audit[t.auditIndex].ttl,"dd.MM HH:mm"))}}function KC(t,e){if(1&t){const t=zr();Nr(0,"button",80),Jr("click",(function(){return ei(t),Xr(2).toggleDetail()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vcAudit.btn.more")))}function qC(t,e){if(1&t){const t=zr();Nr(0,"button",81),Jr("click",(function(){return ei(t),Xr(2).toggleDetail()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vcAudit.btn.less")))}function zC(t,e){if(1&t){const t=zr();Nr(0,"div",52),Nr(1,"div",53),Nr(2,"div",54),Nr(3,"h5",55),mo(4),Ua(5,"translate"),Fr(),Nr(6,"button",56),Nr(7,"span",57),mo(8,"\xd7"),Fr(),Fr(),Fr(),Nr(9,"div",58),Nr(10,"div",5),Nr(11,"div",59),Nr(12,"h3",60),Jr("click",(function(){return ei(t),Xr().pageAuditIndex(-1)})),Br(13,"a",61),Fr(),Fr(),Nr(14,"div",62),Nr(15,"h3",63),Jr("click",(function(){return ei(t),Xr().pageAuditIndex(1)})),Br(16,"a",64),Fr(),Fr(),Fr(),Nr(17,"form",65),Nr(18,"label",66),mo(19),Ua(20,"translate"),Fr(),Nr(21,"label",67),mo(22),Ua(23,"date"),Fr(),Nr(24,"label",66),mo(25),Ua(26,"translate"),Fr(),Nr(27,"label",68),mo(28),Fr(),Nr(29,"label",66),mo(30),Ua(31,"translate"),Fr(),Nr(32,"label",69),mo(33),Fr(),Lr(34,OC,6,4,"div",0),Lr(35,EC,6,4,"div",0),Lr(36,LC,6,5,"div",0),Lr(37,GC,6,5,"div",0),Nr(38,"label",66),mo(39),Ua(40,"translate"),Fr(),Nr(41,"label",70),mo(42),Fr(),Lr(43,RC,6,4,"div",0),Lr(44,jC,6,4,"div",0),Lr(45,$C,6,4,"div",0),Lr(46,NC,6,4,"div",0),Lr(47,FC,6,4,"div",0),Lr(48,BC,6,4,"div",0),Lr(49,HC,7,7,"div",0),Fr(),Fr(),Nr(50,"div",71),Lr(51,KC,3,3,"button",72),Lr(52,qC,3,3,"button",73),Nr(53,"button",74),mo(54),Ua(55,"translate"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr();_n(4),fo(Oa(5,23,"vcAudit.titleDetail")),_n(15),vo("",Oa(20,25,"vcAudit.lbl.created"),":"),_n(3),vo("",Ea(23,27,t.audit[t.auditIndex].createdAt,"dd.MM.yyyy HH:mm:ss.SSS")," "),_n(3),vo("",Oa(26,30,"vcAudit.lbl.user"),":"),_n(3),vo("",t.audit[t.auditIndex].user.email," "),_n(2),vo("",Oa(31,32,"vcAudit.lbl.action"),":"),_n(3),vo("",t.audit[t.auditIndex].actionDescription," "),_n(1),jr("ngIf",t.audit[t.auditIndex].actionInfo),_n(1),jr("ngIf",t.audit[t.auditIndex].vc),_n(1),jr("ngIf",t.audit[t.auditIndex].vp),_n(1),jr("ngIf",t.audit[t.auditIndex].vpv),_n(2),vo("",Oa(40,34,"vcAudit.lbl.result"),":"),_n(3),vo("",t.helperResponseText(t.audit[t.auditIndex])," "),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore&&t.audit[t.auditIndex].ttl),_n(2),jr("ngIf",!t.showMore),_n(1),jr("ngIf",t.showMore),_n(2),fo(Oa(55,36,"vcAudit.btn.back"))}}function QC(t){let e;return t?(e=t.replace(/\t/g," "),"="!==e[0]&&"+"!==e[0]&&"-"!==e[0]||(e="'".concat(e)),e):t}let WC=(()=>{class t{constructor(t,e,i,n,s,r,o,a){this.visboauditService=t,this.visbocenterService=e,this.messageService=i,this.alertService=n,this.route=s,this.location=r,this.router=o,this.translate=a,this.auditTypeList=[{name:"All",action:""},{name:"Read",action:"GET"},{name:"Create",action:"POST"},{name:"Update",action:"PUT"},{name:"Delete",action:"DELETE"}],this.auditAreaList=[{name:"All",action:""},{name:"VC",action:"vc"},{name:"VP",action:"vp"}],this.deleted=!1}ngOnInit(){this.sysadmin=this.route.snapshot.queryParams.sysadmin,this.deleted=!0===this.route.snapshot.queryParams.deleted;const t=this.route.snapshot.paramMap.get("id");this.visbocenterService.getVisboCenter(t,this.sysadmin,this.deleted).subscribe(t=>{this.visbocenter=t,this.combinedPerm=t.perm,this.log(`VisboCenter initialised ${this.visbocenter._id} Perm ${JSON.stringify(this.combinedPerm)} `)},t=>{if(this.log(`Get VC failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vcAudit.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Gh(t))}),this.auditCount=50,this.auditType=this.auditTypeList[0].name,this.auditArea=this.auditAreaList[0].name,this.today=new Date,this.today.setHours(0,0,0,0),this.getVisboCenterAudits(),this.sortTable(void 0)}getVisboCenterAudits(){const t=this.route.snapshot.paramMap.get("id"),e=new gC;this.log(`Audit getVisboCenterAudits from ${this.auditFrom} to ${this.auditTo} Text ${this.auditText} AuditType ${this.auditType}`),this.alertService.clear(),e.to=this.auditTo?new Date(this.auditTo):new Date,this.auditFrom&&(e.from=new Date(this.auditFrom)),this.auditText&&(e.text=this.auditText.trim());for(let i=0;i<this.auditTypeList.length;i++)if(this.auditType===this.auditTypeList[i].name){e.actionType=this.auditTypeList[i].action;break}for(let i=0;i<this.auditAreaList.length;i++)if(this.auditArea===this.auditAreaList[i].name){e.area=this.auditAreaList[i].action;break}e.maxcount=this.auditCount,this.log(`Audit getVisboCenterAudits VC ${t} recalc Query ${JSON.stringify(e)}`),this.visboauditService.getVisboCenterAudits(t,this.sysadmin,this.deleted,e).subscribe(t=>{this.audit=t,this.sortTable(void 0);const e=this.translate.instant("vcAudit.msg.auditSuccess");this.alertService.success(e,!0),this.log("get Audit success")},t=>{this.log(`get Audit failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}downloadVisboAudit(){let t;this.log(`sysAudit Download ${this.audit.length} Items`),t="sep=\t\n",t+="date\ttime UTC\temail\tactiondDescription\taction\turl\tactionInfo\tresponseTime\tresponseStatus\tvcid\tvcname\tvpid\tvpname\tvpvid\tsize\tip\tuserId\tuserAgent\tttl\tVC Details\tVP Details\n";for(let s=0;s<this.audit.length;s++){const e=new Date(this.audit[s].createdAt).toISOString(),i=(this.audit[s].userAgent||"").replace(/,/g,";"),n=e.substr(0,10)+"\t"+e.substr(11,8)+"\t"+QC(this.audit[s].user.email)+"\t"+QC(this.audit[s].actionDescription)+"\t"+this.audit[s].action+"\t"+this.audit[s].url+"\t"+this.audit[s].actionInfo+"\t"+(this.audit[s].result?this.audit[s].result.time:"")+"\t"+(this.audit[s].result?this.audit[s].result.status:"")+"\t"+(this.audit[s].vc?this.audit[s].vc.vcid:"")+"\t"+(this.audit[s].vc?QC(this.audit[s].vc.name):"")+"\t"+(this.audit[s].vp?this.audit[s].vp.vpid:"")+"\t"+(this.audit[s].vp?QC(this.audit[s].vp.name):"")+"\t"+(this.audit[s].vpv?this.audit[s].vpv.vpvid:"")+"\t"+(this.audit[s].result?this.audit[s].result.size:"0")+"\t"+this.audit[s].ip+"\t"+this.audit[s].user.userId+"\t"+QC(i)+"\t"+(this.audit[s].ttl||"")+"\t"+(this.audit[s].vc&&QC(this.audit[s].vc.vcjson)||"")+"\t"+(this.audit[s].vp&&QC(this.audit[s].vp.vpjson)||"")+"\n";t=t.concat(n)}this.log(`VC Audit CSV Len ${t.length} `);const e=new Blob([t],{type:"text/plain"}),i=window.URL.createObjectURL(e);this.log("Open URL "+i);const n=document.createElement("a");document.body.appendChild(n),n.href=i,n.download="auditlog-VC.csv",this.log(`Open URL ${i} doc ${JSON.stringify(n)}`),n.click(),window.URL.revokeObjectURL(i)}helperAuditIndex(t){this.auditIndex=t}helperFormatBytes(t,e=2){if(0===t)return"0 B";const i=e||2,n=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,n)).toFixed(i))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}pageAuditIndex(t){let e=this.auditIndex+t;e<0&&(e=0),e>=this.audit.length&&(e=this.audit.length-1),this.auditIndex=e}helperResponseText(t){const e=t.result.status;switch(e){case"200":case"304":case"400":case"401":case"403":case"404":case"409":case"423":case"500":return this.translate.instant("vcAudit.result.HTTP"+e);default:return t.result.statusText?t.result.statusText:e.toString()}}helperShortenText(t,e){return Lh(t,e)}goBack(){this.location.back()}toggleDetail(){this.log("Toggle ShowMore"),this.showMore=!this.showMore}isToday(t){return new Date(t)>this.today}sortTable(t){this.audit&&(void 0!==t?t!==this.sortColumn?(this.sortColumn=t,this.sortAscending=void 0):void 0!==this.sortAscending&&(this.sortAscending=!this.sortAscending):(this.sortColumn=1,this.sortAscending=void 0),void 0===this.sortAscending&&(this.sortAscending=2===t||3===t||4===t),1===this.sortColumn?this.audit.sort((function(t,e){return Th(t.createdAt,e.createdAt)})):2===this.sortColumn?this.audit.sort((function(t,e){return xh(t.user.email.toLowerCase(),e.user.email.toLowerCase())})):3===this.sortColumn?this.audit.sort((function(t,e){return xh(t.actionDescription,e.actionDescription)})):4===this.sortColumn?this.audit.sort((function(t,e){return xh(t.url,e.url)})):5===this.sortColumn?this.audit.sort((function(t,e){return xh(t.result.status,e.result.status)})):6===this.sortColumn?this.audit.sort((function(t,e){return t.result.time-e.result.time})):7===this.sortColumn?this.audit.sort((function(t,e){return(t.result.size||0)-(e.result.size||0)})):8===this.sortColumn&&this.audit.sort((function(t,e){var i,n;return xh(null===(i=t.vp)||void 0===i?void 0:i.name,null===(n=e.vp)||void 0===n?void 0:n.name)})),this.sortAscending||this.audit.reverse())}log(t){this.messageService.add("VC Audit: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(fC),Rr(Ev),Rr(jh),Rr(Mf),Rr(Bg),Rr(Xl),Rr(rf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-visbocenter-audit"]],inputs:{visbocenter:"visbocenter"},decls:5,vars:4,consts:[[4,"ngIf"],["class","well",4,"ngIf"],["id","AuditDetail","tabindex","-1","role","dialog","aria-labelledby","Audit Detail","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-lg modal-dialog-centered","role","document",4,"ngIf"],[1,"well"],[1,"row"],[1,"panel-heading","ml-0"],[3,"click"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],["class","form-group row",4,"ngIf"],[1,"form-group","row"],["for","auditText",1,"col-1","col-form-label"],["id","auditText","type","text","name","auditText",1,"col-2","col-sm-3","form-control",3,"ngModel","ngModelChange"],["for","auditCount",1,"col-1","col-form-label"],["id","auditCount","name","auditCount",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],["id","auditArea","id","auditType","name","auditArea",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["id","auditType","id","auditType","name","auditType",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],[1,"btn-group"],["type","button",1,"btn","btn-sm","btn-primary","ml-auto","mx-1",3,"click"],["type","button",1,"btn","btn-sm","btn-secondary","ml-auto","mx-1",3,"click"],[1,"container-fluid"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],["id","AuditHead"],["id","SortDate",1,"d-none","d-md-table-cell",3,"click"],["id","SortUser",3,"click"],["id","SortAction",3,"click"],["id","SortVP",1,"d-none","d-lg-table-cell",3,"click"],["id","SortInfo",1,"d-none","d-md-table-cell",3,"click"],["id","SortResult",1,"d-none","d-lg-table-cell",3,"click"],["id","AuditList"],["data-toggle","modal","data-target","#AuditDetail",3,"click",4,"ngFor","ngForOf"],["for","auditFrom",1,"col-1","col-form-label"],["id","auditFrom","type","datetime-local","name","auditFrom",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],["for","auditTo",1,"col-1","col-form-label"],["id","auditTo","type","datetime-local","name","auditTo",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],["id","auditFrom","type","date","name","auditFrom",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],["id","auditTo","type","date","name","auditTo",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],[3,"value"],["data-toggle","modal","data-target","#AuditDetail",3,"click"],["id","ColCreated","class","d-none d-md-table-cell",4,"ngIf"],["id","ColUser",4,"ngIf"],["id","ColAction"],["id","ColVP",1,"d-none","d-lg-table-cell"],["id","ColInfo",1,"d-none","d-md-table-cell"],["id","ColResult",1,"d-none","d-lg-table-cell"],["id","ColDetail","data-toggle","modal","data-target","#AuditDetail",1,"Detail",3,"click"],["id","ColCreated",1,"d-none","d-md-table-cell"],["id","ColUser"],[1,"d-flex","justify-content-center"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","AuditDetailTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"col-11"],["id","ButtonPrev",3,"click"],[1,"px-3","col-1","fas","fa-caret-square-left"],[1,"col-1"],["id","ButtonNext",3,"click"],[1,"px-3","col-1","fas","fa-caret-square-right"],["id","auditEntry"],[1,"v_compact_t","col-4","form-control-static"],["id","auditCreated",1,"v_compact_t","col-7","form-control-static"],["id","auditUser",1,"v_compact_t","col-7","form-control-static"],["id","auditAction",1,"v_compact_t","col-7","form-control-static"],[1,"v_compact_t","col-7","form-control-static"],[1,"modal-footer","align-items-end"],["id","ButtonMore","type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["id","ButtonLess","type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-primary"],["id","auditInfo",1,"v_compact_t","col-7","form-control-static"],["id","auditVC",1,"v_compact_t","col-7","form-control-static"],["id","auditVP",1,"v_compact_t","col-7","form-control-static"],["id","auditVPV",1,"v_compact_t","col-7","form-control-static"],[1,"v_compact_t","col-7","form-control-static",2,"overflow-wrap","break-word"],["id","ButtonMore","type","button",1,"btn","btn-secondary",3,"click"],["id","ButtonLess","type","button",1,"btn","btn-secondary",3,"click"]],template:function(t,e){1&t&&(Lr(0,VC,2,0,"div",0),Lr(1,wC,2,0,"div",0),Lr(2,UC,67,44,"div",1),Nr(3,"div",2),Lr(4,zC,56,38,"div",3),Fr()),2&t&&(jr("ngIf",!e.sysadmin),_n(1),jr("ngIf",e.sysadmin),_n(1),jr("ngIf",e.visbocenter),_n(2),jr("ngIf",e.auditIndex>=0&&e.auditIndex<e.audit.length))},directives:[jc,Pb,CC,Eu,Fd,Tu,Ed,Nd,Ou,cu,du,gu,Gc],pipes:[lv,qc],styles:[".v_compact_t[_ngcontent-%COMP%]{margin:0;padding-top:0}"]}),t})();function JC(t,e){1&t&&(Nr(0,"div"),Br(1,"app-usernavbar"),Fr())}function YC(t,e){1&t&&(Nr(0,"div"),Br(1,"app-sysnavbar"),Fr())}function ZC(t,e){if(1&t){const t=zr();Nr(0,"div",11),Nr(1,"label",32),mo(2),Ua(3,"translate"),Fr(),Nr(4,"input",33),Jr("ngModelChange",(function(e){return ei(t),Xr(2).auditFrom=e})),Fr(),Nr(5,"label",34),mo(6),Ua(7,"translate"),Fr(),Nr(8,"input",35),Jr("ngModelChange",(function(e){return ei(t),Xr(2).auditTo=e})),Fr(),Fr()}if(2&t){const t=Xr(2);_n(2),vo("",Oa(3,4,"vpAudit.lbl.from"),":"),_n(2),jr("ngModel",t.auditFrom),_n(2),vo("",Oa(7,6,"vpAudit.lbl.to"),":"),_n(2),jr("ngModel",t.auditTo)}}function XC(t,e){if(1&t){const t=zr();Nr(0,"div",11),Nr(1,"label",32),mo(2),Ua(3,"translate"),Fr(),Nr(4,"input",36),Jr("ngModelChange",(function(e){return ei(t),Xr(2).auditFrom=e})),Fr(),Nr(5,"label",34),mo(6),Ua(7,"translate"),Fr(),Nr(8,"input",37),Jr("ngModelChange",(function(e){return ei(t),Xr(2).auditTo=e})),Fr(),Fr()}if(2&t){const t=Xr(2);_n(2),vo("",Oa(3,4,"vpAudit.lbl.from"),":"),_n(2),jr("ngModel",t.auditFrom),_n(2),vo("",Oa(7,6,"vpAudit.lbl.to"),":"),_n(2),jr("ngModel",t.auditTo)}}function tV(t,e){if(1&t&&(Nr(0,"option"),mo(1),Fr()),2&t){const t=e.$implicit;_n(1),fo(t.name)}}function eV(t,e){if(1&t&&(Nr(0,"td",45),mo(1),Ua(2,"date"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.createdAt,"HH:mm:ss"))}}function iV(t,e){if(1&t&&(Nr(0,"td",45),mo(1),Ua(2,"date"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.createdAt,"dd.MM HH:mm"))}}function nV(t,e){if(1&t&&(Nr(0,"td",46),mo(1),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(t.user.email)}}function sV(t,e){1&t&&(Nr(0,"td",46),mo(1," Unknown "),Fr())}function rV(t,e){if(1&t){const t=zr();Nr(0,"tr",38),Jr("click",(function(){ei(t);const i=e.index;return Xr(2).helperAuditIndex(i)})),Lr(1,eV,3,4,"td",39),Lr(2,iV,3,4,"td",39),Lr(3,nV,2,1,"td",40),Lr(4,sV,2,0,"td",40),Nr(5,"td",41),mo(6),Fr(),Nr(7,"td",42),mo(8),Fr(),Nr(9,"td",43),mo(10),Fr(),Nr(11,"td"),Nr(12,"button",44),Jr("click",(function(){ei(t);const i=e.index;return Xr(2).helperAuditIndex(i)})),mo(13,"i"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit,i=Xr(2);_n(1),jr("ngIf",i.isToday(t.createdAt)),_n(1),jr("ngIf",!i.isToday(t.createdAt)),_n(1),jr("ngIf",t.user),_n(1),jr("ngIf",!t.user),_n(2),fo(t.actionDescription),_n(2),fo(i.helperShortenText(t.actionInfo,30)),_n(2),fo(i.helperResponseText(t))}}function oV(t,e){1&t&&(Nr(0,"div"),Nr(1,"h3",47),mo(2),Ua(3,"translate"),Fr(),Fr()),2&t&&(_n(2),vo(" ",Oa(3,1,"vpAudit.msg.noAudit")," "))}function aV(t,e){if(1&t){const t=zr();Nr(0,"div",4),Nr(1,"div",5),Nr(2,"h2",6),mo(3),Ua(4,"translate"),Nr(5,"a",7),Jr("click",(function(){return ei(t),Xr().goBack()})),mo(6),Fr(),Fr(),Fr(),Nr(7,"form",8,9),Jr("ngSubmit",(function(){return ei(t),Xr().getVisboProjectAudits()})),Lr(9,ZC,9,8,"div",10),Lr(10,XC,9,8,"div",10),Nr(11,"div",11),Nr(12,"label",12),mo(13),Ua(14,"translate"),Fr(),Nr(15,"input",13),Jr("ngModelChange",(function(e){return ei(t),Xr().auditText=e})),Fr(),Nr(16,"label",14),mo(17),Ua(18,"translate"),Fr(),Nr(19,"select",15),Jr("ngModelChange",(function(e){return ei(t),Xr().auditCount=e})),Nr(20,"option"),mo(21,"50"),Fr(),Nr(22,"option"),mo(23,"100"),Fr(),Nr(24,"option"),mo(25,"500"),Fr(),Nr(26,"option"),mo(27,"2000"),Fr(),Fr(),Nr(28,"select",16),Jr("ngModelChange",(function(e){return ei(t),Xr().auditType=e})),Lr(29,tV,2,1,"option",17),Fr(),Nr(30,"div",18),Nr(31,"button",19),Jr("click",(function(){return ei(t),Xr().getVisboProjectAudits()})),mo(32),Ua(33,"translate"),Fr(),Nr(34,"button",20),Jr("click",(function(){return ei(t),Xr().downloadVisboAudit()})),mo(35),Ua(36,"translate"),Fr(),Fr(),Fr(),Fr(),Nr(37,"div",21),Nr(38,"div",22),Nr(39,"table",23),Nr(40,"thead",24),Nr(41,"tr"),Nr(42,"th",25),Jr("click",(function(){return ei(t),Xr().sortTable(1)})),mo(43),Ua(44,"translate"),Fr(),Nr(45,"th",26),Jr("click",(function(){return ei(t),Xr().sortTable(2)})),mo(46),Ua(47,"translate"),Fr(),Nr(48,"th",27),Jr("click",(function(){return ei(t),Xr().sortTable(3)})),mo(49),Ua(50,"translate"),Fr(),Nr(51,"th",28),Jr("click",(function(){return ei(t),Xr().sortTable(4)})),mo(52),Ua(53,"translate"),Fr(),Nr(54,"th",29),Jr("click",(function(){return ei(t),Xr().sortTable(5)})),mo(55),Ua(56,"translate"),Fr(),Nr(57,"th"),mo(58,"Detail"),Fr(),Fr(),Fr(),Nr(59,"tbody",30),Lr(60,rV,14,7,"tr",31),Fr(),Fr(),Lr(61,oV,4,3,"div",0),Fr(),Fr(),Fr()}if(2&t){const t=Xr();_n(3),vo(" ",Oa(4,19,"vpAudit.title"),": "),_n(3),fo(t.visboproject.name),_n(3),jr("ngIf",t.sysadmin),_n(1),jr("ngIf",!t.sysadmin),_n(3),vo("",Oa(14,21,"vpAudit.lbl.filter"),":"),_n(2),jr("ngModel",t.auditText),_n(2),vo("",Oa(18,23,"vpAudit.lbl.max"),":"),_n(2),jr("ngModel",t.auditCount),_n(9),jr("ngModel",t.auditType),_n(1),jr("ngForOf",t.auditTypeList),_n(3),fo(Oa(33,25,"vpAudit.btn.filter")),_n(3),fo(Oa(36,27,"vpAudit.btn.download")),_n(8),fo(Oa(44,29,"vpAudit.lbl.created")),_n(3),fo(Oa(47,31,"vpAudit.lbl.user")),_n(3),fo(Oa(50,33,"vpAudit.lbl.action")),_n(3),fo(Oa(53,35,"vpAudit.lbl.info")),_n(3),fo(Oa(56,37,"vpAudit.lbl.result")),_n(5),jr("ngForOf",t.audit),_n(1),jr("ngIf",t.audit&&0==t.audit.length)}}function lV(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",71),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpAudit.lbl.info"),":"),_n(3),vo("",t.audit[t.auditIndex].actionInfo," ")}}function cV(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",72),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpAudit.lbl.vc"),":"),_n(3),vo("",t.audit[t.auditIndex].vc.name," ")}}function dV(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",73),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,3,"vpAudit.lbl.vp"),":"),_n(3),bo("",t.audit[t.auditIndex].vp.name," (",t.audit[t.auditIndex].vp.vpid,") ")}}function uV(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",74),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,3,"vpAudit.lbl.vpv"),":"),_n(3),bo("",t.audit[t.auditIndex].vpv.name," (",t.audit[t.auditIndex].vpv.vpvid,")")}}function hV(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",66),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpAudit.lbl.techAction"),":"),_n(3),vo("",t.audit[t.auditIndex].action," ")}}function pV(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",75),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpAudit.lbl.url"),":"),_n(3),vo("",t.audit[t.auditIndex].url," ")}}function gV(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",66),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpAudit.lbl.responseTime"),":"),_n(3),vo("",t.audit[t.auditIndex].result.time," ms ")}}function mV(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",66),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpAudit.lbl.responseSize"),":"),_n(3),vo("",t.helperFormatBytes(t.audit[t.auditIndex].result.size||0,2)," ")}}function fV(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",66),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpAudit.lbl.userAgent"),":"),_n(3),fo(t.audit[t.auditIndex].userAgent)}}function vV(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",66),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpAudit.lbl.ip"),":"),_n(3),fo(t.audit[t.auditIndex].ip)}}function bV(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",66),mo(5),Ua(6,"date"),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpAudit.lbl.ttl"),":"),_n(3),fo(Ea(6,4,t.audit[t.auditIndex].ttl,"dd.MM HH:mm"))}}function yV(t,e){if(1&t){const t=zr();Nr(0,"button",76),Jr("click",(function(){return ei(t),Xr(2).toggleDetail()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpAudit.btn.more")))}function CV(t,e){if(1&t){const t=zr();Nr(0,"button",77),Jr("click",(function(){return ei(t),Xr(2).toggleDetail()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpAudit.btn.less")))}function VV(t,e){if(1&t){const t=zr();Nr(0,"div",48),Nr(1,"div",49),Nr(2,"div",50),Nr(3,"h5",51),mo(4),Ua(5,"translate"),Fr(),Nr(6,"button",52),Nr(7,"span",53),mo(8,"\xd7"),Fr(),Fr(),Fr(),Nr(9,"div",54),Nr(10,"div",5),Nr(11,"div",55),Nr(12,"h3",56),Jr("click",(function(){return ei(t),Xr().pageAuditIndex(-1)})),Br(13,"a",57),Fr(),Fr(),Nr(14,"div",58),Nr(15,"h3",59),Jr("click",(function(){return ei(t),Xr().pageAuditIndex(1)})),Br(16,"a",60),Fr(),Fr(),Fr(),Nr(17,"form",61),Nr(18,"label",62),mo(19),Ua(20,"translate"),Fr(),Nr(21,"label",63),mo(22),Ua(23,"date"),Fr(),Nr(24,"label",62),mo(25),Ua(26,"translate"),Fr(),Nr(27,"label",64),mo(28),Fr(),Nr(29,"label",62),mo(30),Ua(31,"translate"),Fr(),Nr(32,"label",65),mo(33),Fr(),Lr(34,lV,6,4,"div",0),Lr(35,cV,6,4,"div",0),Lr(36,dV,6,5,"div",0),Lr(37,uV,6,5,"div",0),Nr(38,"div"),Nr(39,"label",62),mo(40),Ua(41,"translate"),Fr(),Nr(42,"label",66),mo(43),Fr(),Fr(),Lr(44,hV,6,4,"div",0),Lr(45,pV,6,4,"div",0),Lr(46,gV,6,4,"div",0),Lr(47,mV,6,4,"div",0),Lr(48,fV,6,4,"div",0),Lr(49,vV,6,4,"div",0),Lr(50,bV,7,7,"div",0),Fr(),Fr(),Nr(51,"div",67),Lr(52,yV,3,3,"button",68),Lr(53,CV,3,3,"button",69),Nr(54,"button",70),mo(55),Ua(56,"translate"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr();_n(4),fo(Oa(5,23,"vpAudit.titleDetail")),_n(15),vo("",Oa(20,25,"vpAudit.lbl.created"),":"),_n(3),vo("",Ea(23,27,t.audit[t.auditIndex].createdAt,"dd.MM.yyyy HH:mm:ss.SSS")," "),_n(3),vo("",Oa(26,30,"vpAudit.lbl.user"),":"),_n(3),vo("",t.audit[t.auditIndex].user.email," "),_n(2),vo("",Oa(31,32,"vpAudit.lbl.action"),":"),_n(3),vo("",t.audit[t.auditIndex].actionDescription," "),_n(1),jr("ngIf",t.audit[t.auditIndex].actionInfo),_n(1),jr("ngIf",t.audit[t.auditIndex].vc),_n(1),jr("ngIf",t.audit[t.auditIndex].vp),_n(1),jr("ngIf",t.audit[t.auditIndex].vpv),_n(3),vo("",Oa(41,34,"vpAudit.lbl.result"),":"),_n(3),vo("",t.helperResponseText(t.audit[t.auditIndex])," "),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore&&t.audit[t.auditIndex].ttl),_n(2),jr("ngIf",!t.showMore),_n(1),jr("ngIf",t.showMore),_n(2),fo(Oa(56,36,"vpAudit.btn.back"))}}function wV(t){let e;return t?(e=t.replace(/\t/g," "),"="!==e[0]&&"+"!==e[0]&&"-"!==e[0]||(e="'".concat(e)),e):t}let AV=(()=>{class t{constructor(t,e,i,n,s,r,o,a){this.visboauditService=t,this.visboprojectService=e,this.messageService=i,this.alertService=n,this.location=s,this.route=r,this.router=o,this.translate=a,this.auditTypeList=[{name:"All",action:""},{name:"Read",action:"GET"},{name:"Create",action:"POST"},{name:"Update",action:"PUT"},{name:"Delete",action:"DELETE"}],this.deleted=!1}ngOnInit(){this.sysadmin=this.route.snapshot.queryParams.sysadmin,this.deleted=!!this.route.snapshot.queryParams.deleted,this.getVisboProject(),this.auditCount=50,this.auditType=this.auditTypeList[0].name,this.today=new Date,this.today.setHours(0,0,0,0),this.getVisboProjectAudits(),this.sortTable(void 0)}getVisboProject(){const t=this.route.snapshot.paramMap.get("id");this.log("VisboProject Detail of: "+t),this.visboprojectService.getVisboProject(t,this.sysadmin,this.deleted).subscribe(e=>{this.visboproject=e,this.combinedPerm=e.perm,this.log(`Get VisboProject ${t} ${this.visboproject.name} Perm ${JSON.stringify(this.combinedPerm)}`)},t=>{this.log(`get VPs failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}getVisboProjectAudits(){const t=this.route.snapshot.paramMap.get("id"),e=new gC;this.log(`Audit getVisboProjectAudits from ${this.auditFrom} to ${this.auditTo} Text ${this.auditText} AuditType ${this.auditType}`),this.alertService.clear(),e.to=this.auditTo?new Date(this.auditTo):new Date,this.auditFrom&&(e.from=new Date(this.auditFrom)),this.auditText&&(e.text=this.auditText.trim());for(let i=0;i<this.auditTypeList.length;i++)if(this.auditType===this.auditTypeList[i].name){e.actionType=this.auditTypeList[i].action;break}e.maxcount=this.auditCount,this.log(`Audit getVisboProjectAudits VP ${t} recalc Query ${JSON.stringify(e)}`),this.visboauditService.getVisboProjectAudits(t,this.sysadmin,this.deleted,e).subscribe(t=>{this.audit=t,this.sortTable(void 0);const e=this.translate.instant("vpAudit.msg.auditSuccess");this.alertService.success(e,!0),this.log(`get Audit success ${this.audit.length} for ${this.visboproject.name}`)},t=>{this.log(`get Audit failed: error: ${t.status} message: ${JSON.stringify(t)}`),this.alertService.error(Gh(t))})}downloadVisboAudit(){let t;this.log(`sysAudit Download ${this.audit.length} Items`),t="sep=\t\n",t+="date\ttime UTC\temail\tactiondDescription\taction\turl\tactionInfo\tresponseTime\tresponseStatus\tvcid\tvcname\tvpid\tvpname\tvpvid\tsize\tip\tuserId\tuserAgent\tttl\tVC Details\tVP Details\n";for(let s=0;s<this.audit.length;s++){const e=new Date(this.audit[s].createdAt).toISOString(),i=(this.audit[s].userAgent||"").replace(/,/g,";"),n=e.substr(0,10)+"\t"+e.substr(11,8)+"\t"+wV(this.audit[s].user.email)+"\t"+wV(this.audit[s].actionDescription)+"\t"+this.audit[s].action+"\t"+this.audit[s].url+"\t"+this.audit[s].actionInfo+"\t"+(this.audit[s].result?this.audit[s].result.time:"")+"\t"+(this.audit[s].result?this.audit[s].result.status:"")+"\t"+(this.audit[s].vc?this.audit[s].vc.vcid:"")+"\t"+(this.audit[s].vc?wV(this.audit[s].vc.name):"")+"\t"+(this.audit[s].vp?this.audit[s].vp.vpid:"")+"\t"+(this.audit[s].vp?wV(this.audit[s].vp.name):"")+"\t"+(this.audit[s].vpv?this.audit[s].vpv.vpvid:"")+"\t"+(this.audit[s].result?this.audit[s].result.size:"0")+"\t"+this.audit[s].ip+"\t"+this.audit[s].user.userId+"\t"+wV(i)+"\t"+(this.audit[s].ttl||"")+"\t"+(this.audit[s].vc&&wV(this.audit[s].vc.vcjson)||"")+"\t"+(this.audit[s].vp&&wV(this.audit[s].vp.vpjson)||"")+"\n";t=t.concat(n)}this.log(`sysAudit CSV Len ${t.length} `);const e=new Blob([t],{type:"text/plain"}),i=window.URL.createObjectURL(e);this.log("Open URL "+i);const n=document.createElement("a");document.body.appendChild(n),n.href=i,n.download="auditlog-VP.csv",this.log(`Open URL ${i} doc ${JSON.stringify(n)}`),n.click(),window.URL.revokeObjectURL(i)}goBack(){this.location.back()}helperAuditIndex(t){this.auditIndex=t}helperFormatBytes(t,e=2){if(0===t)return"0 B";const i=e||2,n=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,n)).toFixed(i))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}pageAuditIndex(t){let e;e=this.auditIndex+t,e<0&&(e=0),e>=this.audit.length&&(e=this.audit.length-1),this.auditIndex=e}helperResponseText(t){if(t.result.statusText)return t.result.statusText;const e=t.result.status;return"200"===e||"304"===e?"Success":"400"===e?"Bad Request":"401"===e?"Not Authenticated":"403"===e?"Permission Denied":"404"===e?"URL not found":"409"===e?"Conflict":"423"===e?"Locked":"500"===e?"Server Error":e.toString()}helperShortenText(t,e){return Lh(t,e)}toggleDetail(){this.log("Toggle ShowMore"),this.showMore=!this.showMore}isToday(t){return new Date(t)>this.today}sortTable(t){this.audit&&(this.log("Sort Table Column "+t),void 0!==t?t!==this.sortColumn?(this.sortColumn=t,this.sortAscending=void 0):void 0!==this.sortAscending&&(this.sortAscending=!this.sortAscending):(this.sortColumn=1,this.sortAscending=void 0),void 0===this.sortAscending&&(this.sortAscending=2===t||3===t||4===t),1===this.sortColumn?this.audit.sort((function(t,e){return Th(t.createdAt,e.createdAt)})):2===this.sortColumn?this.audit.sort((function(t,e){return xh(t.user.email.toLowerCase(),e.user.email.toLowerCase())})):3===this.sortColumn?this.audit.sort((function(t,e){return xh(t.actionDescription,e.actionDescription)})):4===this.sortColumn?this.audit.sort((function(t,e){return xh(t.url,e.url)})):5===this.sortColumn?this.audit.sort((function(t,e){return xh(t.result.status,e.result.status)})):6===this.sortColumn?this.audit.sort((function(t,e){return t.result.time-e.result.time})):7===this.sortColumn&&this.audit.sort((function(t,e){return(t.result.size||0)-(e.result.size||0)})),this.sortAscending||this.audit.reverse())}log(t){this.messageService.add("Audit: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(fC),Rr(Vb),Rr(jh),Rr(Mf),Rr(Xl),Rr(Bg),Rr(rf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-visboproject-audit"]],decls:5,vars:4,consts:[[4,"ngIf"],["class","well",4,"ngIf"],["id","AuditDetail","tabindex","-1","role","dialog","aria-labelledby","Audit Detail","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-lg modal-dialog-centered","role","document",4,"ngIf"],[1,"well"],[1,"row"],[1,"panel-heading","ml-0"],[3,"click"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],["class","form-group row",4,"ngIf"],[1,"form-group","row"],["for","auditText",1,"col-1","col-form-label"],["id","auditText","type","text","name","auditText",1,"col-2","col-sm-3","form-control",3,"ngModel","ngModelChange"],["for","auditCount",1,"col-1","col-form-label"],["name","auditCount",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],["id","auditType","id","auditType","name","auditType",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[1,"btn-group"],["type","button",1,"btn","btn-sm","btn-primary","ml-auto","mx-1",3,"click"],["type","button",1,"btn","btn-sm","btn-secondary","ml-auto","mx-1",3,"click"],[1,"container-fluid"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],["id","AuditHead"],["id","SortDate",1,"d-none","d-md-table-cell",3,"click"],["id","SortUser",3,"click"],["id","SortAction",3,"click"],["id","SortInfo",1,"d-none","d-md-table-cell",3,"click"],["id","SortResult",1,"d-none","d-lg-table-cell",3,"click"],["id","AuditList"],["data-toggle","modal","data-target","#AuditDetail",3,"click",4,"ngFor","ngForOf"],["for","auditFrom",1,"col-1","col-form-label"],["id","auditFrom","type","datetime-local","name","auditFrom",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],["for","auditTo",1,"col-1","col-form-label"],["id","auditTo","type","datetime-local","name","auditTo",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],["id","auditFrom","type","date","name","auditFrom",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],["id","auditTo","type","date","name","auditTo",1,"col-2","col-sm-4","form-control",3,"ngModel","ngModelChange"],["data-toggle","modal","data-target","#AuditDetail",3,"click"],["id","ColCreated","class","d-none d-md-table-cell",4,"ngIf"],["id","ColUser",4,"ngIf"],["id","ColAction"],["id","ColInfo",1,"d-none","d-md-table-cell"],["id","ColResult",1,"d-none","d-lg-table-cell"],["id","ColDetail","data-toggle","modal","data-target","#AuditDetail",1,"Detail",3,"click"],["id","ColCreated",1,"d-none","d-md-table-cell"],["id","ColUser"],[1,"d-flex","justify-content-center"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","AuditDetailTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"col-11"],["id","ButtonPrev",3,"click"],[1,"px-3","col-1","fas","fa-caret-square-left"],[1,"col-1"],["id","ButtonNext",3,"click"],[1,"px-3","col-1","fas","fa-caret-square-right"],["id","auditEntry"],[1,"v_compact_t","col-4","form-control-static"],["id","auditCreated",1,"v_compact_t","col-7","form-control-static"],["id","auditUser",1,"v_compact_t","col-7","form-control-static"],["id","auditAction",1,"v_compact_t","col-7","form-control-static"],[1,"v_compact_t","col-7","form-control-static"],[1,"modal-footer","align-items-end"],["id","ButtonMore","type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["id","ButtonLess","type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-primary"],["id","auditInfo",1,"v_compact_t","col-7","form-control-static"],["id","auditVC",1,"v_compact_t","col-7","form-control-static"],["id","auditVP",1,"v_compact_t","col-7","form-control-static"],["id","auditVPV",1,"v_compact_t","col-7","form-control-static"],[1,"v_compact_t","col-7","form-control-static",2,"overflow-wrap","break-word"],["id","ButtonMore","type","button",1,"btn","btn-secondary",3,"click"],["id","ButtonLess","type","button",1,"btn","btn-secondary",3,"click"]],template:function(t,e){1&t&&(Lr(0,JC,2,0,"div",0),Lr(1,YC,2,0,"div",0),Lr(2,aV,62,39,"div",1),Nr(3,"div",2),Lr(4,VV,57,38,"div",3),Fr()),2&t&&(jr("ngIf",!e.sysadmin),_n(1),jr("ngIf",e.sysadmin),_n(1),jr("ngIf",e.visboproject),_n(2),jr("ngIf",e.auditIndex>=0&&e.auditIndex<e.audit.length))},directives:[jc,Pb,CC,Eu,Fd,Tu,Ed,Nd,Ou,cu,du,gu,Gc],pipes:[lv,qc],styles:[".v_compact_t[_ngcontent-%COMP%]{margin:0;padding-top:0}"]}),t})();class PV{}class kV{}class DV{}class MV{}class IV{}const SV={headers:new th({"Content-Type":"application/json"})};let xV=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.vpvUrl=this.env.restUrl.concat("/vpv"),this.vpfUrl=this.env.restUrl.concat("/vp")}getVisboProjectVersions(t,e,i,n){const s=""+this.vpvUrl,r=new th({"Content-Type":"application/json"});let o=new nh;return t&&(o=o.append("vpid",t)),e&&(o=o.append("deleted","1")),void 0!==i&&(o=o.append("variantID",i)),n&&(o=o.append("keyMetrics","1")),this.log(`Calling HTTP Request: ${s} Options: ${o}`),this.http.get(this.vpvUrl,{headers:r,params:o}).pipe(D(t=>t.vpv),qh(t=>this.log(`fetched ${t.length} VisboProjectVersions `)),Fh(this.handleError("getVisboProjectVersions")))}getVisboProjectVersion(t,e=!1){const i=`${this.vpvUrl}/${t}`,n=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("deleted","1")),this.log(`Calling HTTP Request for a specific entry: ${i} Params ${s}`),this.http.get(i,{headers:n,params:s}).pipe(D(t=>(t.vpv[0].perm=t.perm,t.vpv[0])),qh(()=>this.log("fetched Specific Version ")),Fh(this.handleError("getVisboProjectVersion id="+t)))}addVisboProjectVersion(t){return(new IV).name=t.name,this.http.post(this.vpvUrl,t,SV).pipe(D(t=>JSON.parse(JSON.stringify(t)).vpv),qh(t=>this.log("added VisboProjectVersion w/ id="+t._id)),Fh(this.handleError("addVisboProjectVersion")))}deleteVisboProjectVersion(t,e=!1){const i=t._id,n=`${this.vpvUrl}/${i}`,s=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("deleted","1")),this.log(`Calling HTTP Request Delete: ${n} Params ${r}`),this.http.delete(n,{headers:s,params:r}).pipe(qh(()=>this.log("deleted VisboProjectVersion id="+i)),Fh(this.handleError("deleteVisboProjectVersion")))}updateVisboProjectVersion(t,e=!1){const i=`${this.vpvUrl}/${t._id}`,n=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("deleted","1")),this.log(`Calling HTTP Request PUT: ${i} Params ${s}`),this.http.put(i,t,{headers:n,params:s}).pipe(D(t=>t.vpv[0]),qh(()=>this.log(`updated VisboProjectVersion id=${t._id} url=${this.vpvUrl}`)),Fh(this.handleError("updateVisboProjectVersion")))}getVisboPortfolioVersions(t,e=!1){const i=`${this.vpfUrl}/${t}/portfolio`,n=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("deleted","1")),this.log(`Calling HTTP Request: ${i} Options: ${s}`),this.http.get(i,{headers:n,params:s}).pipe(D(t=>(t.vpf&&t.vpf.length>0&&(t.vpf[0].perm=t.perm),t.vpf)),qh(t=>this.log(`fetched ${t.length} VisboPortfolioVersion `)),Fh(this.handleError("getVisboPortfolioVersions")))}addVisboPortfolioVersion(t,e){const i=`${this.vpfUrl}/${t._id}/portfolio`,n=new th({"Content-Type":"application/json"}),s=new nh;return this.http.post(i,e,{headers:n,params:s}).pipe(D(t=>t.vpf[0]),qh(t=>this.log("added VisboPortfolioVersion w/ id="+t._id)),Fh(this.handleError("addVisboPortfolioVersion")))}updateVisboPortfolioVersion(t,e){const i=`${this.vpfUrl}/${t._id}/portfolio/${e._id}`,n=new th({"Content-Type":"application/json"}),s=new nh;return this.http.put(i,e,{headers:n,params:s}).pipe(D(t=>t.vpf[0]),qh(t=>this.log("updated VisboPortfolioVersion w/ id="+t._id)),Fh(this.handleError("updateVisboPortfolioVersion")))}deleteVisboPortfolioVersion(t,e=!1){const i=t._id,n=`${this.vpfUrl}/${t.vpid}/portfolio/${i}`,s=new th({"Content-Type":"application/json"});let r=new nh;return e&&(r=r.append("deleted","1")),this.log(`Calling HTTP Request Delete: ${n} Params ${r}`),this.http.delete(n,{headers:s,params:r}).pipe(qh(()=>this.log("deleted VisboPortfolioVersion id="+i)),Fh(this.handleError("deleteVisboPortfolioVersion")))}getVisboPortfolioKeyMetrics(t,e=new Date,i=!1){const n=""+this.vpvUrl,s=new th({"Content-Type":"application/json"});let r=new nh;return r=r.append("vpfid",t),r=r.append("refDate",e.toISOString()),r=r.append("keyMetrics","1"),i&&(r=r.append("deleted","1")),this.log(`Calling HTTP Request: ${n} Options: ${r}`),this.http.get(n,{headers:s,params:r}).pipe(D(t=>t.vpv),qh(t=>this.log(`fetched ${t.length} VisboPortfolio Project Versions `)),Fh(this.handleError("getVisboPortfoliokeyMetrics")))}getVisboCenterProjectVersions(t,e=new Date,i=!1){const n=""+this.vpvUrl,s=new th({"Content-Type":"application/json"});let r=new nh;return r=r.append("vcid",t),r=r.append("refDate",e.toISOString()),r=r.append("keyMetrics","1"),r=r.append("variantID",""),i&&(r=r.append("deleted","1")),this.log(`Calling HTTP Request: ${n} Options: ${r}`),this.http.get(n,{headers:s,params:r}).pipe(D(t=>t.vpv),qh(t=>this.log(`fetched ${t.length} VisboCenter Project Versions `)),Fh(this.handleError("getVisboCenterProjectkeyMetrics")))}getVisboPortfolioVersion(t,e=!1){const i=`${this.vpfUrl}/${t}/portfolio`,n=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("deleted","1")),this.log(`Calling HTTP Request for a specific entry: ${i} Params ${s}`),this.http.get(i,{headers:n,params:s}).pipe(D(t=>t.vpf[0]),qh(()=>this.log("fetched Specific Portfolio Version ")),Fh(this.handleError("getVisboPortfolioVersion id="+t)))}getCapacity(t,e,i=!1,n=!1){const s=`${this.vpvUrl}/${t}/capacity`,r=new th({"Content-Type":"application/json"});let o=new nh;return i&&(o=o.append("hierarchy","1")),n&&(o=o.append("pfv","1")),e&&(this.log("Calling RoleID: "+e),o=o.append("roleID",e)),this.log(`Calling HTTP Request: ${s} Options: ${o}`),this.http.get(s,{headers:r,params:o}).pipe(D(t=>t.vpv),qh(()=>this.log("fetched Capacity Calculation for "+t)),Fh(this.handleError("getVisboProjectVersions")))}getCost(t){const e=`${this.vpvUrl}/${t}/cost`,i=new th({"Content-Type":"application/json"}),n=new nh;return this.log(`Calling HTTP Request: ${e} Options: ${n}`),this.http.get(e,{headers:i,params:n}).pipe(D(t=>t.vpv),qh(()=>this.log("fetched Cost Calc for "+t)),Fh(this.handleError("getVisboProjectVersions")))}getDelivery(t,e){const i=`${this.vpvUrl}/${t}/delivery`,n=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("ref",e)),this.log(`Calling HTTP Request: ${i} Options: ${s}`),this.http.get(i,{headers:n,params:s}).pipe(D(t=>t.vpv),qh(()=>this.log("fetched Delivery Calc for "+t)),Fh(this.handleError("getVisboProjectVersions")))}getDeadline(t,e){const i=`${this.vpvUrl}/${t}/deadline`,n=new th({"Content-Type":"application/json"});let s=new nh;return e&&(s=s.append("ref",e)),this.log(`Calling HTTP Request: ${i} Options: ${s}`),this.http.get(i,{headers:n,params:s}).pipe(D(t=>t.vpv),qh(()=>this.log("fetched Deadline Calc for "+t)),Fh(this.handleError("getVisboProjectVersions")))}handleError(t="operation"){return e=>(this.log(`HTTP Request ${t} failed: ${e.message} ${e.status}`),$h(e))}log(t){this.messageService.add("VisboProjectVersionService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(jh),Kt(sp))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class TV{}var _V=function(t){return t.SELECTED="SELECTED",t.NOT_SELECTED="NOT_SELECTED",t.PARENT_SELECTED="PARENT_SELECTED",t}({}),UV=i("h9Sk");class OV{constructor(t,e,i,n,s){this.element=t,this.newWidth=e,this.newHeight=i,this.oldWidth=n,this.oldHeight=s}}let EV=(()=>{class t{constructor(t){this.element=t,this.resized=new Ra}ngOnInit(){UV.ResizeSensor&&(this.resizeSensor=new UV.ResizeSensor(this.element.nativeElement,()=>this.onResized()))}ngOnDestroy(){this.resizeSensor&&this.resizeSensor.detach()}onResized(){const t=this.element.nativeElement.clientWidth,e=this.element.nativeElement.clientHeight;if(t===this.oldWidth&&e===this.oldHeight)return;const i=new OV(this.element,t,e,this.oldWidth,this.oldHeight);this.oldWidth=this.element.nativeElement.clientWidth,this.oldHeight=this.element.nativeElement.clientHeight,this.resized.emit(i)}}return t.\u0275fac=function(e){return new(e||t)(Rr(No))},t.\u0275dir=ge({type:t,selectors:[["","resized",""]],outputs:{resized:"resized"}}),t})(),LV=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[]]}),t})(),GV=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[Qc]]}),t})(),RV=(()=>{class t{constructor(){this.google=google}getGoogle(){return this.google}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:GV}),t})(),jV=(()=>{class t{constructor(t){this.gChartService=t}ngOnInit(){this.language||(this.language="de"),this.gLib=this.gChartService.getGoogle(),this.gLib.charts.load("current",{packages:["corechart","table"],language:this.language}),this.gLib.charts.setOnLoadCallback(this.drawChart.bind(this))}ngOnChanges(){this.initialised&&this.drawChart()}drawChart(){const t=new this.gLib.visualization.ComboChart(document.getElementById("divComboChart")),e=new this.gLib.visualization.arrayToDataTable(this.graphData),i=this.parentThis;this.gLib.visualization.events.addListener(t,"select",(function(){const n=t.getSelection();if(n&&0!==n.length){const t=n[0];if(void 0===i)console.log("Chart Combo: The user clicked and this is undefined");else if(t){const n=t.row,s=t.column;if(null!=n&&n>=0){const t=e.getValue(n,0);i.chartSelectRow(n,s,t)}}}else console.log("Chart Combo: chartGetSelection is undefined",n||n.length)})),t.draw(e,this.graphOptions||{title:"Combo Chart"}),this.initialised=!0}}return t.\u0275fac=function(e){return new(e||t)(Rr(RV))},t.\u0275cmp=le({type:t,selectors:[["app-combo-chart"]],inputs:{graphData:"graphData",language:"language",graphOptions:"graphOptions",parentThis:"parentThis"},features:[_e],decls:1,vars:0,consts:[["id","divComboChart"]],template:function(t,e){1&t&&Br(0,"div",0)},styles:["#divComboChart[_ngcontent-%COMP%]{width:100%;height:500px}"]}),t})();function $V(t,e){1&t&&(Nr(0,"span",22),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"ViewCapacity.title2")))}function NV(t,e){if(1&t){const t=zr();Nr(0,"span",23),Nr(1,"a",24),mo(2),Fr(),Nr(3,"div",25),Nr(4,"a",26),Jr("click",(function(){return ei(t),Xr(2).updateShowUnit("PD")})),mo(5),Ua(6,"translate"),Fr(),Nr(7,"a",26),Jr("click",(function(){return ei(t),Xr(2).updateShowUnit("Euro")})),mo(8),Ua(9,"translate"),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(2),vo(" ",t.showUnitText," "),_n(3),fo(Oa(6,3,"ViewCapacity.lbl.pd")),_n(3),fo(Oa(9,5,"ViewCapacity.lbl.euro"))}}function FV(t,e){if(1&t){const t=zr();Nr(0,"div",15),Nr(1,"span"),Nr(2,"label",16),mo(3),Ua(4,"translate"),Fr(),Fr(),Nr(5,"span"),Nr(6,"input",17),Jr("input",(function(e){ei(t);const i=Xr();return i.capacityFrom=i.parseDate(e.target.value)}))("change",(function(){return ei(t),Xr().updateDateRange()})),Ua(7,"date"),Fr(),Fr(),Nr(8,"span"),Nr(9,"label",18),mo(10),Ua(11,"translate"),Fr(),Nr(12,"input",19),Jr("input",(function(e){ei(t);const i=Xr();return i.capacityTo=i.parseDate(e.target.value)}))("change",(function(){return ei(t),Xr().updateDateRange()})),Ua(13,"date"),Fr(),Fr(),Nr(14,"div",18),Lr(15,$V,3,3,"span",20),Lr(16,NV,10,7,"span",21),Fr(),Fr()}if(2&t){const t=Xr();_n(3),fo(Oa(4,6,"ViewCapacity.titleCapacity")),_n(3),jr("ngModel",Ea(7,8,t.capacityFrom,"yyyy-MM-dd")),_n(4),fo(Oa(11,11,"ViewCapacity.titleTimeTo")),_n(2),jr("ngModel",Ea(13,13,t.capacityTo,"yyyy-MM-dd")),_n(3),jr("ngIf",t.hasCost),_n(1),jr("ngIf",t.hasCost)}}function BV(t,e){if(1&t){const t=zr();Nr(0,"div",30),Nr(1,"input",31),Jr("change",(function(){return ei(t),Xr(2).updateRef()}))("ngModelChange",(function(e){return ei(t),Xr(2).refPFV=e})),Fr(),Nr(2,"label",32),mo(3),Ua(4,"translate"),Fr(),Fr()}if(2&t){const t=Xr(2);_n(1),jr("ngModel",t.refPFV),_n(2),fo(Oa(4,2,"ViewCapacity.lbl.refPFV"))}}function HV(t,e){if(1&t&&(Nr(0,"option",37),mo(1),Fr()),2&t){const t=e.$implicit;to("value",t.id),_n(1),fo(t.localName)}}function KV(t,e){if(1&t){const t=zr();Nr(0,"div",33),Nr(1,"label",34),mo(2),Ua(3,"translate"),Fr(),Nr(4,"select",35),Jr("change",(function(){return ei(t),Xr(2).updateDrillDown()}))("ngModelChange",(function(e){return ei(t),Xr(2).drillDown=e})),Lr(5,HV,2,2,"option",36),Fr(),Fr()}if(2&t){const t=Xr(2);_n(2),vo("",Oa(3,3,"ViewCapacity.lbl.showDrill"),":"),_n(2),jr("ngModel",t.drillDown),_n(1),jr("ngForOf",t.drillDownCapaFiltered)}}function qV(t,e){if(1&t&&(Nr(0,"div",27),Lr(1,BV,5,4,"div",28),Lr(2,KV,6,5,"div",29),Fr()),2&t){const t=Xr();_n(1),jr("ngIf",!t.vpvActive),_n(1),jr("ngIf",!t.getPreView())}}function zV(t,e){1&t&&qr(0)}function QV(t,e){1&t&&(Nr(0,"div"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),vo(" ",Oa(2,1,"ViewCapacity.lbl.totalCost")," "))}function WV(t,e){1&t&&(Nr(0,"div"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),vo(" ",Oa(2,1,"ViewCapacity.lbl.totalCostPT")," "))}function JV(t,e){1&t&&qr(0)}function YV(t,e){1&t&&(Nr(0,"span"),mo(1,"T\u20ac"),Fr())}function ZV(t,e){1&t&&(Nr(0,"span"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"ViewCapacity.lbl.pd")))}function XV(t,e){1&t&&(Nr(0,"div"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),vo(" ",Oa(2,1,"ViewCapacity.lbl.budget")," "))}function tw(t,e){1&t&&(Nr(0,"div"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),vo(" ",Oa(2,1,"ViewCapacity.lbl.totalCapa")," "))}function ew(t,e){1&t&&(Nr(0,"span"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"ViewCapacity.lbl.keuro")))}function iw(t,e){1&t&&(Nr(0,"span"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"ViewCapacity.lbl.pd")))}const nw=function(t){return{level:t}};function sw(t,e){if(1&t&&(Nr(0,"div",38),Nr(1,"h5",39),Nr(2,"strong",40),Lr(3,zV,1,0,"ng-container",41),Fr(),mo(4),Ua(5,"translate"),Fr(),Nr(6,"div",42),Nr(7,"div",8),Nr(8,"div",43),Lr(9,QV,3,3,"div",12),Lr(10,WV,3,3,"div",12),Fr(),Nr(11,"div",44),Nr(12,"strong",40),Lr(13,JV,1,0,"ng-container",41),Fr(),mo(14),Ua(15,"number"),Lr(16,YV,2,0,"span",12),Lr(17,ZV,3,3,"span",12),Fr(),Fr(),Nr(18,"div",8),Nr(19,"div",45),Ua(20,"translate"),Lr(21,XV,3,3,"div",12),Lr(22,tw,3,3,"div",12),Fr(),Nr(23,"div",44),mo(24),Ua(25,"number"),Lr(26,ew,3,3,"span",12),Lr(27,iw,3,3,"span",12),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr(),e=Gr(17);_n(3),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(26,nw,t.getLevel(t.sumCost,t.sumBudget))),_n(1),vo(" ",Oa(5,16,"ViewCapacity.titleBox"),""),_n(5),jr("ngIf","PD"!=t.showUnit),_n(1),jr("ngIf","PD"==t.showUnit),_n(3),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(28,nw,t.getLevel(t.sumCost,t.sumBudget))),_n(1),vo(" ",Ea(15,18,t.sumCost,"1.0-0")," "),_n(2),jr("ngIf","PD"!=t.showUnit),_n(1),jr("ngIf","PD"==t.showUnit),_n(2),to("title",Oa(20,21,"keyMetrics.longBAC")),_n(2),jr("ngIf",t.refPFV),_n(1),jr("ngIf",!t.refPFV),_n(2),vo(" ",Ea(25,23,t.sumBudget,"1.0-0")," "),_n(2),jr("ngIf","PD"!=t.showUnit),_n(1),jr("ngIf","PD"==t.showUnit)}}function rw(t,e){1&t&&qr(0)}const ow=function(t){return{$implicit:t,level:0}};function aw(t,e){if(1&t&&(Nr(0,"div",46),Nr(1,"span",47),mo(2),Ua(3,"translate"),Fr(),Lr(4,rw,1,0,"ng-container",41),Fr()),2&t){const t=Xr(),e=Gr(15);_n(2),fo(Oa(3,3,"ViewCapacity.title1")),_n(2),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(5,ow,t.orgaTreeData.children))}}function lw(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-combo-chart",49),Fr()),2&t){const t=Xr(3);_n(1),jr("graphData",t.graphDataComboChart)("graphOptions",t.graphOptionsComboChart)("parentThis",t.parentThis)("language",t.currentLang)}}function cw(t,e){1&t&&(Nr(0,"div"),Nr(1,"span",47),mo(2),Ua(3,"translate"),Fr(),Fr()),2&t&&(_n(2),fo(Oa(3,1,"ViewCapacity.msg.noCapacity")))}function dw(t,e){if(1&t&&(Nr(0,"div"),Lr(1,lw,2,4,"div",12),Lr(2,cw,4,3,"div",12),Fr()),2&t){const t=Xr(2);_n(1),jr("ngIf",t.graphDataComboChart.length>2),_n(1),jr("ngIf",t.graphDataComboChart.length<2)}}function uw(t,e){if(1&t&&(Nr(0,"div",48),Lr(1,dw,3,2,"div",12),Fr()),2&t){const t=Xr();_n(1),jr("ngIf",t.displayCapacity()>0)}}function hw(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-combo-chart",49),Fr()),2&t){const t=Xr(3);_n(1),jr("graphData",t.graphDataComboChart)("graphOptions",t.graphOptionsComboChart)("parentThis",t.parentThis)("language",t.currentLang)}}function pw(t,e){1&t&&(Nr(0,"div"),Nr(1,"span",47),mo(2),Ua(3,"translate"),Fr(),Fr()),2&t&&(_n(2),fo(Oa(3,1,"ViewCapacity.msg.noCapacity")))}function gw(t,e){if(1&t&&(Nr(0,"div"),Lr(1,hw,2,4,"div",12),Lr(2,pw,4,3,"div",12),Fr()),2&t){const t=Xr(2);_n(1),jr("ngIf",t.graphDataComboChart.length>2),_n(1),jr("ngIf",t.graphDataComboChart.length<2)}}function mw(t,e){if(1&t&&(Nr(0,"div",50),Lr(1,gw,3,2,"div",12),Fr()),2&t){const t=Xr();_n(1),jr("ngIf",t.displayCapacity()>0)}}function fw(t,e){1&t&&(Nr(0,"div"),Nr(1,"span",47),mo(2),Ua(3,"translate"),Fr(),Fr()),2&t&&(_n(2),fo(Oa(3,1,"ViewCapacity.msg.noCapacity")))}function vw(t,e){1&t&&(Nr(0,"span",56),Br(1,"strong",59),Fr())}function bw(t,e){1&t&&(Nr(0,"span",56),Br(1,"strong",60),Fr())}function yw(t,e){1&t&&qr(0)}const Cw=function(){return{"list-style-type":"none"}},Vw=function(t,e){return{$implicit:t,level:e}};function ww(t,e){if(1&t&&(Nr(0,"div",61),Lr(1,yw,1,0,"ng-container",41),Fr()),2&t){const t=Xr().$implicit,e=Xr().level;Xr();const i=Gr(15);jr("ngStyle",Pa(3,Cw)),_n(1),jr("ngTemplateOutlet",i)("ngTemplateOutletContext",Da(4,Vw,t.children,e+1))}}const Aw=function(t,e){return{"tree-item__selected":t,"tree-item__parent-selected":e}},Pw=function(t,e){return{"fa-chevron-right":t,"fa-chevron-down":e}};function kw(t,e){if(1&t){const t=zr();Nr(0,"div",52),Nr(1,"div",53),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(2).selectLeaf(i)})),Nr(2,"span"),Nr(3,"a",54),Jr("click",(function(i){ei(t);const n=e.$implicit,s=Xr(2);return i.stopPropagation(),s.switchLeaf(n)})),Br(4,"i",55),Fr(),Nr(5,"span",56),mo(6),Fr(),Lr(7,vw,2,0,"span",57),Lr(8,bw,2,0,"span",57),Fr(),Fr(),Lr(9,ww,2,7,"div",58),Fr()}if(2&t){const t=e.$implicit,i=Xr().level,n=Xr();_n(1),jr("ngClass",Da(8,Aw,"SELECTED"===t.isSelected,"PARENT_SELECTED"===t.isSelected)),_n(1),ao("margin-left",20*i+"px"),_n(2),jr("ngClass",Da(11,Pw,!t.showChildren,t.showChildren)),_n(2),vo(" ",t.name," "),_n(1),jr("ngIf",n.capaLoad[t.uid]&&n.capaLoad[t.uid].rankOver>0),_n(1),jr("ngIf",n.capaLoad[t.uid]&&n.capaLoad[t.uid].rankUnder>0),_n(1),jr("ngIf",(null==t.children?null:t.children.length)>0&&t.showChildren)}}function Dw(t,e){1&t&&Lr(0,kw,10,14,"div",51),2&t&&jr("ngForOf",e.$implicit)}const Mw=function(t,e,i){return{"fa-check-circle text-success":t,"fa-exclamation-triangle text-warning":e,"fa-exclamation-circle text-danger":i}};function Iw(t,e){if(1&t&&Br(0,"i",55),2&t){const t=e.level;jr("ngClass",Ma(1,Mw,1==t,2==t,3==t))}}function Sw(t,e){1&t&&(Nr(0,"div"),Br(1,"div",62),Nr(2,"span"),mo(3),Ua(4,"translate"),Fr(),Fr()),2&t&&(_n(3),vo(" ",Oa(4,1,"ViewCapacity.msg.calculating"),""))}class xw{}class Tw{}let _w=(()=>{class t{constructor(t,e,i,n,s,r,o,a,l){this.visbocenterService=t,this.visboprojectService=e,this.visboprojectversionService=i,this.visbosettingService=n,this.messageService=s,this.alertService=r,this.route=o,this.router=a,this.translate=l,this.printView=!1,this.sumCost=0,this.sumBudget=0,this.refPFV=!1,this.parentThis=this,this.colorsPFV=["#F7941E","#BDBDBD","#458CCB"],this.colorsOrga=["#F7941E","#F7941E","#BDBDBD","#458CCB"],this.seriesPFV=[{type:"line",lineWidth:4,pointSize:0}],this.seriesOrga=[{type:"line",lineWidth:4,pointSize:0},{type:"line",lineWidth:2,lineDashStyle:[4,4],pointSize:1}],this.graphDataComboChart=[],this.graphOptionsComboChart={chartArea:{left:100,top:100,width:"90%"},width:"100%",height:"600",title:"Monthly Capacity comparison",animation:{startup:!0,duration:200},legend:{position:"top"},explorer:{actions:["dragToZoom","rightClickToReset"],maxZoomIn:.01},annotations:{textStyle:{fontSize:10}},colors:this.colorsOrga,series:this.seriesOrga,seriesType:"bars",isStacked:!0,tooltip:{isHtml:!0},vAxis:{title:"Monthly Capacity",format:"###,###.## ",minorGridlines:{count:0,color:"none"}},hAxis:{format:"MMM yy",gridlines:{color:"#FFF",count:-1},minorGridlines:{count:0,color:"none"}}},this.permVC=Iv,this.permVP=Sv}ngOnInit(){this.currentLang=this.translate.currentLang,this.drillDownCapa=[{id:0,name:"drillNone",localName:this.translate.instant("ViewCapacity.lbl.drillNone")},{id:1,name:"drillOrga",localName:this.translate.instant("ViewCapacity.lbl.drillOrga")},{id:2,name:"drillProject",localName:this.translate.instant("ViewCapacity.lbl.drillProject")}],this.drillDownCapaFiltered=this.drillDownCapa,this.initSetting(),this.refDate||(this.refDate=new Date),this.currentRefDate=this.refDate,this.showUnitText=this.translate.instant("PD"==this.showUnit?"ViewCapacity.lbl.pd":"ViewCapacity.lbl.euro"),this.log(`Capacity Init  RefDate ${this.refDate} Current RefDate ${this.currentRefDate}`),this.capaLoad=[],this.vpfActive?this.lastTimestampVPF=this.vpfActive.timestamp:this.vpvActive&&(this.drillDownCapaFiltered=this.drillDownCapa.filter(t=>2!=t.id),this.lastTimestampVPF=this.vpvActive.timestamp),this.visboGetOrganisation()}ngOnChanges(t){var e,i,n,s,r,o,a,l,c,d,u,h;this.log(`Capacity Changes  RefDate ${this.refDate} Current RefDate ${this.currentRefDate}`);let p=!1;(null===(i=null===(e=t.vpvActive)||void 0===e?void 0:e.currentValue)||void 0===i?void 0:i.timestamp)&&(null===(s=null===(n=t.vpvActive)||void 0===n?void 0:n.currentValue)||void 0===s?void 0:s.timestamp)!=(null===(o=null===(r=t.vpvActive)||void 0===r?void 0:r.previousValue)||void 0===o?void 0:o.timestamp)&&(p=!0),(null===(l=null===(a=t.vpfActive)||void 0===a?void 0:a.currentValue)||void 0===l?void 0:l.timestamp)&&(null===(d=null===(c=t.vpfActive)||void 0===c?void 0:c.currentValue)||void 0===d?void 0:d.timestamp)!=(null===(h=null===(u=t.vpfActive)||void 0===u?void 0:u.previousValue)||void 0===h?void 0:h.timestamp)&&(p=!0),(p||void 0!==this.currentRefDate&&this.refDate.getTime()!==this.currentRefDate.getTime()||this.vpfActive&&this.lastTimestampVPF!==this.vpfActive.timestamp)&&(this.initSetting(),this.getCapacity())}onResized(t){t||this.log("No event in Resize");let e=0;this.chartActive&&(e=(new Date).getTime()-this.chartActive.getTime()),e<1e3||Math.abs(t.newWidth-t.oldWidth)<5||(this.log(`Capacity Resize ${e} ${Math.abs(t.newHeight-t.oldHeight)} ${Math.abs(t.newWidth-t.oldWidth)}`),this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(()=>{this.visboViewCapacityOverTime(),this.timeoutID=void 0},500))}initSetting(){this.chartActive=void 0,this.roleID=this.route.snapshot.queryParams.roleID;const t=this.route.snapshot.queryParams.pfv;this.refPFV=!(!t||!Number(t)),this.drillDown=Number(this.route.snapshot.queryParams.drillDown)||0,this.initShowUnit(this.route.snapshot.queryParams.unit);const e=this.route.snapshot.queryParams.from,i=this.route.snapshot.queryParams.to;e&&Uh(e,!1)?this.capacityFrom=new Date(Uh(e,!1)):this.vpvActive?this.capacityFrom=new Date(this.vpvActive.startDate):(this.capacityFrom=new Date,this.capacityFrom.setMonth(this.capacityFrom.getMonth()-3)),this.capacityFrom.setDate(1),this.capacityFrom.setHours(0,0,0,0),i&&Uh(i,!1)?this.capacityTo=new Date(Uh(i,!1)):this.vpvActive?this.capacityTo=new Date(this.vpvActive.endDate):(this.capacityTo=new Date,this.capacityTo.setMonth(this.capacityTo.getMonth()+9)),this.capacityTo.setDate(1),this.capacityTo.setHours(0,0,0,0),this.vcActive?this.currentName=this.vcActive.name:this.vpfActive?this.currentName=this.vpfActive.name:this.vpActive&&(this.currentName=this.vpActive.name),this.log(`Capacity From / To ${this.capacityFrom} / ${this.capacityTo}`)}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}hasVCPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vc&t)>0}visboGetOrganisation(){let t;this.vcActive?t=this.vcActive._id:this.vpActive&&(t=this.vpActive.vcid),t&&(this.log("Organisaions for CapacityCalc for Object  "+t),this.visbosettingService.getVCOrganisations(t,!1,(new Date).toISOString()).subscribe(t=>{0===t.length?(this.log("get VCOrganisations - result is empty "),this.vcorganisation=[]):(this.log("Store Organisation for Len "+t.length),this.vcorganisation=t,this.vcorganisation.sort((function(t,e){return Th(t.timestamp,e.timestamp)})),this.actOrga=this.vcorganisation[this.vcorganisation.length-1].value),this.visboViewOrganisationTree(),this.getCapacity()},t=>{if(this.log(`get VCOrganisations failed: error: ${t.status} message: ${t.error.message}`),403===t.status){let t;this.vpActive?t=this.vpActive.name:this.vcActive&&(t=this.vcActive.name);const e=this.translate.instant("ViewCapacity.msg.errorPermCapacity",{name:t});this.log("Alert: "+e),this.alertService.error(e,!0)}else this.alertService.error(Gh(t),!0)}))}getCapacity(){2==this.drillDown?this.getProjectCapacity():this.getCapacityOrga()}getProjectCapacity(){this.visboCapacity=void 0,this.vcActive?(this.log(`Capacity Calc for VC ${this.vcActive._id} role ${this.currentLeaf.name}`),this.visbocenterService.getCapacity(this.vcActive._id,this.refDate,this.currentLeaf.uid.toString(),!0,this.refPFV,!1,!1,!0).subscribe(t=>{t.capacity&&0!==t.capacity.length?(this.log("Store VC Project Capacity for Len "+t.capacity.length),this.visboCapacity=t.capacity.filter(t=>null==t.vpid),this.visboCapacityChild=t.capacity.filter(t=>null!=t.vpid)):(this.log("get VPV Calc: Reset Capacity to empty "),this.visboCapacity=[],this.visboCapacityChild=[]),this.checkCostAvailable(this.visboCapacity),this.visboViewCapacityOverTime()},t=>{if(this.log(`get VC Capacity failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("ViewCapacity.msg.errorPermCapacity",{name:this.vcActive.name});this.alertService.error(t,!0)}else if(409===t.status){const t=this.translate.instant("ViewCapacity.msg.errorPermOrganisation",{name:this.vcActive.name});this.alertService.error(t,!0)}else this.alertService.error(Gh(t),!0)})):this.vpActive&&this.vpfActive&&this.currentLeaf&&(this.log(`Capacity Calc for VP ${this.vpActive._id} VPF ${this.vpfActive._id} role ${this.currentLeaf.name} DrillDown Project`),this.visboprojectService.getCapacity(this.vpActive._id,this.vpfActive._id,this.refDate,this.currentLeaf.uid.toString(),!0,this.refPFV,!1,!1,!0).subscribe(t=>{t.capacity&&0!==t.capacity.length?(this.log("Store VPF Project Capacity for Len "+t.capacity.length),this.visboCapacity=t.capacity.filter(t=>null==t.vpid),this.visboCapacityChild=t.capacity.filter(t=>null!=t.vpid)):(this.log("get VPF Calc: Reset Capacity to empty "),this.visboCapacity=[]),this.checkCostAvailable(this.visboCapacity),this.visboViewCapacityOverTime()},t=>{if(this.log(`get VPF Capacity Project failed: error: ${t.status} message: ${t.error&&t.error.message}`),403===t.status){const t=this.translate.instant("ViewCapacity.msg.errorPermCapacity",{name:this.vpActive.name});this.alertService.error(t,!0)}else this.alertService.error(Gh(t),!0)}))}getCapacityOrga(){this.visboCapacity=void 0,this.vcActive?(this.log(`Capacity Calc for VC ${this.vcActive._id} role ${this.roleID}`),this.visbocenterService.getCapacity(this.vcActive._id,this.refDate,this.currentLeaf.uid.toString(),!0,this.refPFV).subscribe(t=>{t.capacity&&0!==t.capacity.length?(this.log("Store Capacity for Len "+t.capacity.length),this.visboCapacity=t.capacity.filter(t=>t.roleID==this.currentLeaf.uid.toString()),this.visboCapacityChild=t.capacity.filter(t=>t.roleID!=this.currentLeaf.uid.toString())):(this.log("get VPV Calc: Reset Capacity to empty "),this.visboCapacity=[],this.visboCapacityChild=[]),this.topLevelNodes.findIndex(t=>t.uid==this.currentLeaf.uid)>=0&&this.calcLoad(this.visboCapacity,this.refPFV),this.calcLoad(this.visboCapacityChild,this.refPFV),this.visboViewCapacityOverTime()},t=>{if(this.log(`get VC Capacity failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("ViewCapacity.msg.errorPermCapacity",{name:this.vcActive.name});this.alertService.error(t,!0)}else if(409===t.status){const t=this.translate.instant("ViewCapacity.msg.errorPermOrganisation",{name:this.vcActive.name});this.alertService.error(t,!0)}else this.alertService.error(Gh(t),!0)})):this.vpActive&&this.vpfActive&&this.currentLeaf?(this.log(`Capacity Calc for VP ${this.vpActive._id} VPF ${this.vpfActive._id} role ${this.roleID}`),this.visboprojectService.getCapacity(this.vpActive._id,this.vpfActive._id,this.refDate,this.currentLeaf.uid.toString(),!0,this.refPFV).subscribe(t=>{t.capacity&&0!==t.capacity.length?(this.log("Store Capacity for Len "+t.capacity.length),this.visboCapacity=t.capacity.filter(t=>t.roleID==this.currentLeaf.uid.toString()),this.visboCapacityChild=t.capacity.filter(t=>t.roleID!=this.currentLeaf.uid.toString())):(this.log("get VPF Calc: Reset Capacity to empty "),this.visboCapacity=[]),this.topLevelNodes.findIndex(t=>t.uid==this.currentLeaf.uid)>=0&&this.calcLoad(this.visboCapacity,this.refPFV),this.calcLoad(this.visboCapacityChild,this.refPFV),this.visboViewCapacityOverTime()},t=>{if(this.log(`get VPF Capacity failed: error: ${t.status} message: ${t.error&&t.error.message}`),403===t.status){const t=this.translate.instant("ViewCapacity.msg.errorPermCapacity",{name:this.vpActive.name});this.alertService.error(t,!0)}else this.alertService.error(Gh(t),!0)})):this.vpActive&&this.vpvActive&&this.currentLeaf&&(this.refPFV=!0,this.log(`Capacity Calc for VPV ${this.vpvActive.vpid} role ${this.roleID}`),this.visboprojectversionService.getCapacity(this.vpvActive._id,this.currentLeaf.uid.toString(),!0,this.refPFV).subscribe(t=>{if(t&&1==t.length&&t[0].capacity&&0!==t[0].capacity.length){const e=t[0];this.log("Store Capacity for Len "+e.capacity.length),this.visboCapacity=e.capacity.filter(t=>t.roleID==this.currentLeaf.uid),this.visboCapacityChild=e.capacity.filter(t=>t.roleID!=this.currentLeaf.uid)}else this.log("get VPF Calc: Reset Capacity to empty "),this.visboCapacity=[];this.topLevelNodes.findIndex(t=>t.uid==this.currentLeaf.uid)>=0&&this.calcLoad(this.visboCapacity,this.refPFV),this.calcLoad(this.visboCapacityChild,this.refPFV),this.visboViewCapacityOverTime()},t=>{if(this.log(`get VPF Capacity failed: error: ${t.status} message: ${t.error&&t.error.message}`),403===t.status){const t=this.translate.instant("ViewCapacity.msg.errorPermCapacity",{name:this.vpActive.name});this.alertService.error(t,!0)}else this.alertService.error(Gh(t),!0)}))}checkCostAvailable(t){let e=!1;t&&t.length>0&&(e=null!=t[0].actualCost||null!=t[0].plannedCost||null!=t[0].baselineCost),this.hasCost=e}calcLoad(t,e=!1){if(!t||0==t.length)return;function i(t,e,i,n=!1){const s=new Date(t.month);if(s.getTime()<e.getTime()||s.getTime()>i.getTime())return 0;let r=0,o=0;return r=n?(null==t?void 0:t.baselineCost_PT)||0:((null==t?void 0:t.internCapa_PT)||0)+((null==t?void 0:t.externCapa_PT)||0),o=((null==t?void 0:t.actualCost_PT)||0)+((null==t?void 0:t.plannedCost_PT)||0),o>0&&0===r&&(r=1),o/r-1}this.checkCostAvailable(t);let n=[];for(let r=0;r<t.length;r++){const s=i(t[r],this.capacityFrom,this.capacityTo,e),o=t[r].roleID;if(!n[o]){const t=new xw;t.uid=o,t.percentOver=0,t.percentUnder=0,n[o]=t}s>0?n[o].percentOver+=s:s<0&&(n[o].percentUnder+=s)}n=n.filter(t=>t.uid>=0);let s=Math.round(n.length/4);s<3&&(s=Math.min(3,n.length)),n.sort((function(t,e){return e.percentOver-t.percentOver}));for(let r=0;r<s&&!(n[r].percentOver<=0);r++)n[r].rankOver=s-r;n.sort((function(t,e){return t.percentUnder-e.percentUnder}));for(let r=0;r<s&&!(n[r].percentUnder>=0);r++)n[r].rankOver>0||(n[r].rankUnder=s-r);for(let r=0;r<n.length;r++)this.capaLoad[n[r].uid]=n[r]}visboViewOrganisationTree(){this.log("Show the OrgaTree of the VC ");const t=this.actOrga,e=[],i=[];this.log("get all roles of the organisation, prepared for direct access");for(let n=0;t&&t.allRoles&&t.allRoles&&n<t.allRoles.length;n++)e[t.allRoles[n].uid]=t.allRoles[n],i[t.allRoles[n].name]=t.allRoles[n];this.log("get all roles of the organisation, prepared for the TreeView"),this.topLevelNodes=this.buildTopNodes(e),this.orgaTreeData=this.buildOrgaTree(this.topLevelNodes,e),this.log("initialize the orgaTreeData with one of the topLevel"),this.roleID>=0&&this.roleID<e.length&&(this.currentLeaf=this.getMappingLeaf(e[this.roleID].name)),this.currentLeaf||(this.currentLeaf=this.orgaTreeData.children[0]),this.expandParentTree(this.currentLeaf),this.setTreeLeafSelection(this.currentLeaf,_V.SELECTED)}initShowUnit(t){const e="1"==t||"PD"==t?"PD":void 0;this.showUnit=e,this.updateUrlParam("unit","PD"==e?"1":"0"),this.showUnitText=this.translate.instant("PD"===t?"ViewCapacity.lbl.pd":"ViewCapacity.lbl.euro")}updateShowUnit(t){this.initShowUnit(t),this.visboViewCapacityOverTime()}updateDateRange(){this.updateUrlParam("from",void 0),this.visboViewCapacityOverTime()}updateRef(){this.log("Show Ref change to "+this.refPFV),this.updateUrlParam("pfv",this.refPFV?"1":"0"),this.capaLoad=[],this.getCapacity()}updateDrillDown(){this.log("Show Drilldown change to "+this.drillDown),this.updateUrlParam("drillDown",this.drillDown.toString()),this.capaLoad=[],this.getCapacity()}updateUrlParam(t,e,i=!1){const n=this.route.snapshot.url.join("/");void 0===e&&(e=null);const s=new DV;"roleID"==t?s.roleID=Number(e):"from"==t||"to"==t?(s.from=this.capacityFrom.toISOString(),s.to=this.capacityTo.toISOString()):"unit"==t?s.unit=e:"pfv"==t?s.pfv=e:"drillDown"==t&&(s.drillDown="0"==e?void 0:e),this.router.navigate([n],{queryParams:s,replaceUrl:!i,queryParamsHandling:"merge"})}visboViewCapacityOverTime(){if(!this.visboCapacity||0===this.visboCapacity.length)return void(this.graphDataComboChart=[]);let t;t="PD"===this.showUnit?"# "+this.translate.instant("ViewCapacity.lbl.pd"):"###,###.## "+this.translate.instant("ViewCapacity.lbl.keuro"),this.graphOptionsComboChart.title=this.translate.instant(this.refPFV?"ViewCapacity.titleCapaOverTimeBL":"ViewCapacity.titleCapaOverTime",{name:this.currentName,roleName:this.currentLeaf.name}),this.graphOptionsComboChart.vAxis.title=this.translate.instant("ViewCapacity.yAxisCapaOverTime"),this.graphOptionsComboChart.vAxis.format=t,this.drillDown>0?(delete this.graphOptionsComboChart.colors,this.graphOptionsComboChart.series=this.seriesPFV):this.refPFV?(this.graphOptionsComboChart.colors=this.colorsPFV,this.graphOptionsComboChart.series=this.seriesPFV):(this.graphOptionsComboChart.colors=this.colorsOrga,this.graphOptionsComboChart.series=this.seriesOrga),this.log(`ViewCapacityOverTime Type ${this.drillDown?"DrillDown":"Plan/Ist"} resource ${this.currentLeaf.name}`),2==this.drillDown?this.visboViewProjectCapacityDrillDown():1==this.drillDown?this.visboViewCapacityDrillDown():this.visboViewCapacity()}calcChildNode(t,e="roleName"){const i=[];let n=[];return t?(t.forEach(t=>{i.push(t[e]||"")}),i.sort((function(t,e){return xh(t.toString(),e.toString())})),n=i.filter((t,e)=>i.indexOf(t)===e),n):i}mapChildNode(t){const e=[];if(!t)return e;for(let i=0;i<t.length;i++)e[t[i]]=i;return e}visboViewProjectCapacityDrillDown(){const t=[];this.log("visboViewProjectCapacityDrillDown resource "+this.currentLeaf.name),this.sumCost=0,this.sumBudget=0;const e=this.calcChildNode(this.visboCapacityChild,"name"),i=this.mapChildNode(e),n=[];this.visboCapacity.forEach(t=>{const i=new Date(t.month);if(i.getTime()>=this.capacityFrom.getTime()&&i.getTime()<=this.capacityTo.getTime()){let s=0,r=0;r="PD"===this.showUnit?(t.actualCost_PT||0)+(t.plannedCost_PT||0):(t.actualCost||0)+(t.plannedCost||0),s=this.refPFV?"PD"===this.showUnit?t.baselineCost_PT||0:t.baselineCost||0:"PD"===this.showUnit?(t.internCapa_PT||0)+(t.externCapa_PT||0):(t.internCapa||0)+(t.externCapa||0),this.sumCost+=r,this.sumBudget+=s;const o=[],a=new Tw;a.currentDate=i,a.name="All",a.plan=r,a.planTotal=r,a.budget=s,o.push(a),e.forEach(t=>{o.push({currentDate:i,name:t,variantName:"",plan:0,planTotal:0,budget:0})}),n.push(o)}}),this.visboCapacityChild.forEach(t=>{const e=new Date(t.month),s=n.find(t=>t[0].currentDate.getTime()==e.getTime());if(s){const e=i[t.name];if(e>=0){let i=0,n=0;i="PD"===this.showUnit?(t.actualCost_PT||0)+(t.plannedCost_PT||0):(t.actualCost||0)+(t.plannedCost||0),n=this.refPFV?"PD"===this.showUnit?t.baselineCost_PT||0:t.baselineCost||0:"PD"===this.showUnit?(t.internCapa_PT||0)+(t.externCapa_PT||0):(t.internCapa||0)+(t.externCapa||0),s[e+1].plan=i,s[e+1].budget=n,s[e+1].variantName=t.variantName}}});for(let l=0;l<n.length;l++){const i=n[l],s=i[0].currentDate;if(s.getTime()>=this.capacityFrom.getTime()&&s.getTime()<=this.capacityTo.getTime()){const n=[];n.push(s),n.push(i[0].budget||0);const r=this.createTooltipProjectDrillDown(i[0],"PD"===this.showUnit,this.refPFV);n.push(r),e.forEach((t,e)=>{n.push(i[e+1].plan),n.push(this.createTooltipProjectDrillDown(i[e+1],"PD"===this.showUnit,this.refPFV));const s=this.calcLoadDiff(i[e+1],!0);if(null==s)n.push("> 999 %");else if(s>100){const t=Math.round(100*s);n.push(t+" %")}else n.push(void 0)}),t.push(n)}}const s=t.length;if(s<1&&this.log("visboCapacity Empty"),1===s){const i=new Date(t[0][0]);i.setMonth(i.getMonth()+1);const n=[];n.push(i),n.push(void 0),n.push(void 0),e.forEach(()=>{n.push(void 0),n.push(void 0),n.push(void 0)}),t.push(n)}const r={type:"string",role:"tooltip",p:{html:!0}},o={type:"string",role:"annotation"},a=[];a.push("Month"),a.push(this.translate.instant(this.refPFV?"ViewCapacity.lbl.budget":"ViewCapacity.lbl.totalCapa")),a.push(r),e.forEach(t=>{a.push(t),a.push(r),a.push(o)}),t.unshift(a),this.graphDataComboChart=t,this.chartActive=new Date}visboViewCapacityDrillDown(){const t=[];this.log("ViewCapacityDrillDown resource "+this.currentLeaf.name),this.sumCost=0,this.sumBudget=0;const e=this.calcChildNode(this.visboCapacityChild),i=this.mapChildNode(e),n=[];this.visboCapacity.forEach(t=>{const i=new Date(t.month);if(i.getTime()>=this.capacityFrom.getTime()&&i.getTime()<=this.capacityTo.getTime()){let s=0,r=0;r="PD"===this.showUnit?(t.actualCost_PT||0)+(t.plannedCost_PT||0):(t.actualCost||0)+(t.plannedCost||0),s=this.refPFV?"PD"===this.showUnit?t.baselineCost_PT||0:t.baselineCost||0:"PD"===this.showUnit?(t.internCapa_PT||0)+(t.externCapa_PT||0):(t.internCapa||0)+(t.externCapa||0),this.sumCost+=r,this.sumBudget+=s;const o=[],a=new Tw;a.currentDate=i,a.name=this.currentLeaf.name,a.plan=r,a.planTotal=r,a.budget=s,o.push(a),e.forEach(t=>{o.push({currentDate:i,name:t,variantName:"",plan:0,planTotal:void 0,budget:0})}),n.push(o)}}),this.visboCapacityChild.forEach(t=>{const e=new Date(t.month),s=n.find(t=>t[0].currentDate.getTime()==e.getTime());if(s){const e=i[t.roleName];if(e>=0){let i=0,n=0;i="PD"===this.showUnit?(t.actualCost_PT||0)+(t.plannedCost_PT||0):(t.actualCost||0)+(t.plannedCost||0),n=this.refPFV?"PD"===this.showUnit?t.baselineCost_PT||0:t.baselineCost||0:"PD"===this.showUnit?(t.internCapa_PT||0)+(t.externCapa_PT||0):(t.internCapa||0)+(t.externCapa||0),s[e+1].plan=i,s[e+1].budget=n,s[0].plan>=i?s[0].plan-=i:s[0].plan=0}}});for(let l=0;l<n.length;l++){const i=n[l],s=i[0].currentDate;if(s.getTime()>=this.capacityFrom.getTime()&&s.getTime()<=this.capacityTo.getTime()){const n=[];n.push(s),n.push(i[0].budget||0);const r=this.createTooltipOrgaDrillDown(i[0],"PD"===this.showUnit,this.refPFV);n.push(r),n.push(i[0].plan||0),n.push(r),e.forEach((t,e)=>{n.push(i[e+1].plan),n.push(this.createTooltipOrgaDrillDown(i[e+1],"PD"===this.showUnit,this.refPFV));const s=Math.round(100*this.calcLoadDiff(i[e+1],!0));n.push(s>100?s+" %":void 0)}),t.push(n)}}const s=t.length;if(s<1&&this.log("visboCapacity Empty"),1===s){const i=new Date(t[0][0]);i.setMonth(i.getMonth()+1);const n=[];n.push(i),n.push(void 0),n.push(void 0),n.push(void 0),n.push(void 0),e.forEach(()=>{n.push(void 0),n.push(void 0),n.push(void 0)}),t.push(n)}const r={type:"string",role:"tooltip",p:{html:!0}},o={type:"string",role:"annotation"},a=[];a.push("Month"),a.push(this.translate.instant(this.refPFV?"ViewCapacity.lbl.budget":"ViewCapacity.lbl.totalCapa")),a.push(r),a.push(this.currentLeaf.name),a.push(r),e.forEach(t=>{a.push(t),a.push(r),a.push(o)}),t.unshift(a),this.graphDataComboChart=t,this.chartActive=new Date}visboViewCapacity(){const t=[],e=this.visboCapacity;this.sumCost=0,this.sumBudget=0;for(let n=0;n<e.length;n++){const i=new Date(e[n].month);if(i.getTime()>=this.capacityFrom.getTime()&&i.getTime()<=this.capacityTo.getTime()){const s=this.currentLeaf.uid;if(this.refPFV)if("PD"===this.showUnit){const r=Math.round(10*e[n].baselineCost_PT)/10||0,o=Math.round(10*e[n].actualCost_PT)/10||0,a=Math.round(10*e[n].plannedCost_PT)/10||0;this.sumCost+=o+a,this.sumBudget+=r;const l=this.createTooltipPlanActual(e[n],!0,this.refPFV);t.push([i,e[n].roleID==s?r:void 0,e[n].roleID==s?l:void 0,o,l,a,l])}else{const r=Math.round(10*e[n].baselineCost/10||0),o=Math.round(10*e[n].actualCost/10||0),a=Math.round(10*e[n].plannedCost/10||0);this.sumCost+=o+a,this.sumBudget+=r;const l=this.createTooltipPlanActual(e[n],!1,this.refPFV);t.push([i,e[n].roleID==s?r:void 0,e[n].roleID==s?l:void 0,o,l,a,l])}else if("PD"===this.showUnit){const r=Math.round(10*e[n].internCapa_PT)/10||0,o=Math.round(10*e[n].externCapa_PT)/10||0,a=Math.round(10*e[n].actualCost_PT)/10||0,l=Math.round(10*e[n].plannedCost_PT)/10||0;this.sumCost+=a+l,this.sumBudget+=r+o;const c=this.createTooltipPlanActual(e[n],!0);t.push([i,e[n].roleID==s?r+o:void 0,e[n].roleID==s?c:void 0,e[n].roleID==s?r:void 0,e[n].roleID==s?c:void 0,a,c,l,c])}else{const r=Math.round(10*e[n].internCapa/10||0),o=Math.round(10*e[n].externCapa/10||0),a=Math.round(10*e[n].actualCost/10||0),l=Math.round(10*e[n].plannedCost/10||0);this.sumCost+=a+l,this.sumBudget+=r+o;const c=this.createTooltipPlanActual(e[n],!1);t.push([i,e[n].roleID==s?r+o:void 0,e[n].roleID==s?c:void 0,e[n].roleID==s?r:void 0,e[n].roleID==s?c:void 0,a,c,l,c])}}}const i=t.length;if(i<1&&this.log("visboCapacity Empty"),1===i){const e=new Date(t[0][0]);e.setMonth(e.getMonth()+1),t.push(this.refPFV?[e,void 0,void 0,void 0,void 0,void 0,void 0]:[e,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0])}t.unshift(this.refPFV?["Month",this.translate.instant("ViewCapacity.lbl.budget"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("ViewCapacity.lbl.actualCost"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("ViewCapacity.lbl.cost"),{type:"string",role:"tooltip",p:{html:!0}}]:["Month",this.translate.instant("ViewCapacity.lbl.totalCapa"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("ViewCapacity.lbl.internCapa"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("ViewCapacity.lbl.actualCost"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("ViewCapacity.lbl.cost"),{type:"string",role:"tooltip",p:{html:!0}}]),this.graphDataComboChart=t,this.chartActive=new Date}chartSelectRow(t,e,i){if(this.log(`chart Select Row ${t} ${e} ${i} `),this.graphDataComboChart&&t<this.graphDataComboChart.length)if(2==this.drillDown){const i=this.graphDataComboChart[0][e];this.log(`chart identified Row ${this.graphDataComboChart[t+1][0]} Project: ${i}`),this.gotoClickedRow(i)}else{const i=this.graphDataComboChart[0][e];this.log(`chart identified Row ${this.graphDataComboChart[t+1][0]} Role: ${i}`);const n=this.getMappingLeaf(i);n&&this.selectLeaf(n,!0)}}gotoClickedRow(t){this.log("goto VP "+t);const e=this.visboCapacityChild.find(e=>e.name==t);if(e){const t=new yb;e.variantName&&(t.variantName=e.variantName),this.refDate&&!Oh(this.refDate)&&(t.refDate=this.refDate.toISOString()),t.unit="PD"===this.showUnit?"1":"0",this.roleID&&(t.roleID=this.roleID),this.capacityFrom&&(t.from=this.capacityFrom.toISOString()),this.capacityTo&&(t.to=this.capacityTo.toISOString()),this.refDate&&(t.refDate=this.refDate.toISOString()),t.view="Capacity",t.drillDown="1",this.log(`Goto vpid ${e.vpid} QueryParams ${JSON.stringify(t)}`),this.router.navigate(["vpKeyMetrics/".concat(e.vpid)],{queryParams:t})}else this.log(`Project ${t} not found`)}createTooltipPlanActual(t,e,i=!1){let n='<div style="padding:5px 5px 5px 5px;color:black;width:250px;"><div><b>'+_h(new Date(t.month),"fullMonthYear",this.currentLang)+"</b></div>";const s=this.translate.instant("ViewCapacity.lbl.totalCapa"),r=this.translate.instant("ViewCapacity.lbl.internCapa"),o=this.translate.instant("ViewCapacity.lbl.actualCost"),a=this.translate.instant("ViewCapacity.lbl.cost"),l=this.translate.instant("ViewCapacity.lbl.roleName"),c=this.translate.instant("ViewCapacity.lbl.budget"),d=this.translate.instant("ViewCapacity.lbl.diffCost");let u,h,p,g;const m=" "+this.translate.instant(e?"ViewCapacity.lbl.pd":"ViewCapacity.lbl.keuro");e?(p=t.actualCost_PT||0,g=t.plannedCost_PT||0):(p=t.actualCost||0,g=t.plannedCost||0),i?u=e?t.baselineCost_PT||0:t.baselineCost||0:e?(h=t.internCapa_PT||0,u=(t.internCapa_PT||0)+(t.externCapa_PT||0)):(h=t.internCapa||0,u=(t.internCapa||0)+(t.externCapa||0)),n+=this.addTooltipRowString(l+":",t.roleName,!1),n+=this.addTooltipRowNumber(i?c:s,u,e?0:1,m,!1),i||(n+=this.addTooltipRowNumber(r,h,e?0:1,m,!1)),0!==p&&(n+=this.addTooltipRowNumber(o,p,e?0:1,m,!1)),n+=this.addTooltipRowNumber(a,g,e?0:1,m,!1);const f=p+g-u;return 0!=f&&(n+=this.addTooltipRowNumber(d,f,e?0:1,m,!0)),n+="</div>",n}addTooltipRowNumber(t,e,i,n,s){let r;return r='<div class="row"><div class="col-8">'+t,!0===s&&0!==e?e<0?r+='</div><div  class="col-4 text-right text-success font-weight-bold">':e>0&&(r+='</div><div  class="col-4 text-right text-danger font-weight-bold">'):r+='</div><div  class="col-4 text-right font-weight-bold">',r+=this.visboRoundToString(e,i)+n+"</div>",r+="</div>",r}addTooltipRowString(t,e,i){let n;return n='<div class="row"><div class="col-4">'+t,n+='</div><div  class="col-8 text-right font-weight-bold">',n+=e+"</div>",n+="</div>",n}createTooltipProjectDrillDown(t,e,i=!1){let n='<div style="padding:5px 5px 5px 5px;color:black;width:250px;"><div><b>'+_h(t.currentDate,"fullMonthYear",this.currentLang)+"</b></div>";const s=this.translate.instant("ViewCapacity.lbl.project");let r,o;const a=this.translate.instant("ViewCapacity.lbl.fractionCost"),l=this.translate.instant("ViewCapacity.lbl.cost");r=e?" "+this.translate.instant("ViewCapacity.lbl.pd"):" "+this.translate.instant("ViewCapacity.lbl.keuro"),i&&(o=this.translate.instant("ViewCapacity.lbl.budget"));let c=t.name;t.variantName&&(c=c.concat(" (",t.variantName,")")),n+=this.addTooltipRowString(s,c,!1);const d=t.planTotal>0?t.planTotal:t.plan;if(i&&(n+=this.addTooltipRowNumber(o,t.budget,e?0:1,r,!1)),n+=this.addTooltipRowNumber(l,d,e?0:1,r,!1),this.calcLoadDiff(t,!1)){const e=Math.round(100*this.calcLoadDiff(t,!0))+" %";n+=void 0!==e?this.addTooltipRowString(a,e,!0):this.addTooltipRowString(a,"Unknown",!1)}return n+="</div>",n}createTooltipOrgaDrillDown(t,e,i=!1){let n='<div style="padding:5px 5px 5px 5px;color:black;width:250px;"><div><b>'+_h(t.currentDate,"fullMonthYear",this.currentLang)+"</b></div>";const s=this.translate.instant("ViewCapacity.lbl.roleName");let r,o;const a=this.translate.instant("ViewCapacity.lbl.diffCost"),l=this.translate.instant("ViewCapacity.lbl.cost");r=e?" "+this.translate.instant("ViewCapacity.lbl.pd"):" "+this.translate.instant("ViewCapacity.lbl.keuro"),o=this.translate.instant(i?"ViewCapacity.lbl.budget":"ViewCapacity.lbl.totalCapa"),n+=this.addTooltipRowString(s,t.name,!1);const c=t.planTotal>0?t.planTotal:t.plan;n+=this.addTooltipRowNumber(o,t.budget,e?0:1,r,!1),n+=this.addTooltipRowNumber(l,c,e?0:1,r,!1);const d=this.calcLoadDiff(t,!1);if(0!=d){n+=this.addTooltipRowNumber(a,d,e?0:1,r,!0);const i=this.calcLoadDiff(t,!0);if(null==i)n+=this.addTooltipRowString(a,"> 999 %",!0);else{const t=Math.round(100*i)+" %";n+=this.addTooltipRowString(a,t,!0)}}return n+="</div>",n}calcLoadDiff(t,e=!1){const i=t.planTotal>0?t.planTotal:t.plan;return e?t.budget?i/t.budget:i?void 0:1:i-t.budget}visboRoundToString(t,e=1){return(t||0).toLocaleString(this.currentLang,{minimumFractionDigits:e,maximumFractionDigits:e})}displayCapacity(){let t=-1;return 2!=this.drillDown&&this.actOrga&&this.visboCapacity?t=this.visboCapacity.length:2==this.drillDown&&this.actOrga&&this.visboCapacityChild&&(t=this.visboCapacityChild.length),t}getLevel(t,e){let i=1;return e&&(i=t/e),i<=1?1:i<=1.05?2:3}getSummaryRoles(t,e){this.log("get all summary roles of the organisation roleID "+{roleID:e});const i=[];if(void 0===e&&t){let e=0;for(e=0;t&&e<=t.length;e++){const n=t[e];n&&n.subRoleIDs.length>0&&(i[t[e].uid]=t[e])}return i}if(e&&t){const n=t[e];if(n.subRoleIDs&&n.subRoleIDs.length>0){const e=n.subRoleIDs;e.length>0&&(i[n.uid]=n,e.forEach((function e(n){const s=n.key,r=t[s];r.subRoleIDs.length>0&&(i[s]=r,r.subRoleIDs.forEach(e))})))}return i}}getParentOfRole(t,e,i){let n;if(e[t]){let e=!0;for(let s=0;i&&s<i.length;s++){const r=i[s];if(r)for(let i=0;e&&r&&r.subRoleIDs&&i<r.subRoleIDs.length;i++)r.subRoleIDs[i]&&1*r.subRoleIDs[i].key===t&&(n=r,e=!1)}return n}}buildTopNodes(t){const e=[],i=[];let n=1;this.log("get all TopNodes of the organisation");const s=this.getSummaryRoles(t,void 0);for(;n<=t.length;){const r=t[n];r&&(this.getParentOfRole(r.uid,t,s)||i[r.uid]||(i[r.uid]=r,e.push(r))),n++}return e}buildOrgaTree(t,e){this.log("build the OrgaTree used for the selectionTree of the organisation");const i=new TV;function n(t,i){const s=new TV,r=t.key,o=e[r],a=null==o?void 0:o.name;return s.children=[],s.uid=r,s.name=a,s.parent=i,o.subRoleIDs.forEach((function(t){s.children.push(n(t,s))})),s}i.uid=0,i.name="root",i.parent=null,i.children=[],i.showChildren=!0;for(let s=0;t&&s<t.length;s++){const e=new TV;e.parent=i,e.children=[],e.uid=t[s].uid,e.name=t[s].name,e.showChildren=!1,t&&t[s].subRoleIDs&&t[s].subRoleIDs.length>0&&t[s].subRoleIDs.forEach((function(t){e.children.push(n(t,e))})),i.children.push(e)}return i}setTreeLeafSelection(t,e){t.isSelected=e,t.children&&0!==t.children.length&&t.children.forEach(t=>{this.setTreeLeafSelection(t,e===_V.SELECTED?_V.PARENT_SELECTED:e)})}selectLeaf(t,e=!0){t.name!==this.currentLeaf.name&&(this.setTreeLeafSelection(this.currentLeaf,_V.NOT_SELECTED),this.currentLeaf=t,this.updateUrlParam("roleID",t.uid.toString()),this.getCapacity()),e&&(t.showChildren=!0),this.setTreeLeafSelection(t,_V.SELECTED)}switchLeaf(t){t.showChildren=!t.showChildren,this.selectLeaf(t,t.showChildren)}expandParentTree(t){null!==t.parent&&(t.parent.showChildren=!0,this.expandParentTree(t.parent))}getMappingLeaf(t){let e;const i=this.orgaTreeData;let n=!1;function s(i){const r=i;if(r.name===t)r&&r.children&&r.children.length>0&&(r.showChildren=!0),e=r,n=!0;else{const t=r.children;for(let e=0;!n&&t&&e<t.length;e++)s(t[e])}}for(let r=0;!n&&i&&i.children&&r<i.children.length;r++)s(i.children[r]);return e}parseDate(t){if(t){const e=new Date(t);return e.setDate(1),e.setHours(0,0,0,0),e}return null}getPreView(){return Rh()}log(t){this.messageService.add("CompVisboViewCapcity: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Ev),Rr(Vb),Rr(xV),Rr(Eb),Rr(jh),Rr(Mf),Rr(Bg),Rr(rf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-comp-viewcapacity"]],inputs:{vcActive:"vcActive",vpActive:"vpActive",vpfActive:"vpfActive",vpvActive:"vpvActive",vcOrganisation:"vcOrganisation",refDate:"refDate",combinedPerm:"combinedPerm"},features:[_e],decls:19,vars:8,consts:[[1,"well",3,"resized"],[1,"container-fluid","mb-2"],[1,"row","row-cols-1","row-cols-lg-2"],[1,"col","col-sm-12","col-lg-8"],[1,"text-dark"],["class","row ml-1 pt-2 d-print-none",4,"ngIf"],["class","d-flex flex-wrap d-print-none mt-1",4,"ngIf"],["class","col-sm-12 col-md-10 col-lg-4 card align-right px-0",4,"ngIf"],[1,"row"],["class","pl-3 col-3 border-right scroll d-print-none",4,"ngIf"],["class","col-9",4,"ngIf"],["class","col-12",4,"ngIf"],[4,"ngIf"],["recursiveList",""],["indicator",""],[1,"row","ml-1","pt-2","d-print-none"],[1,"mr-2","pt-1"],["id","capacityFrom","type","date","name","capacityFrom",1,"border-1","font-weight-bold",3,"ngModel","input","change"],[1,"mx-2","pt-1"],["id","capacityTo","type","date","name","capacityTo",1,"border-1","font-weight-bold",3,"ngModel","input","change"],["class","mr-auto",4,"ngIf"],["class","mr-auto dropdown",4,"ngIf"],[1,"mr-auto"],[1,"mr-auto","dropdown"],["data-toggle","dropdown",1,"pl-2","font-weight-bold","dropdown-toggle"],[1,"dropdown-menu"],[1,"dropdown-item",3,"click"],[1,"d-flex","flex-wrap","d-print-none","mt-1"],["class","custom-control custom-checkbox m-2",4,"ngIf"],["class","d-flex flex-wrap d-print-none",4,"ngIf"],[1,"custom-control","custom-checkbox","m-2"],["type","checkbox","id","idRefPFV",1,"custom-control-input",3,"ngModel","change","ngModelChange"],["for","idRefPFV",1,"custom-control-label"],[1,"d-flex","flex-wrap","d-print-none"],["for","drillDownOpt",1,"col-3","col-form-label"],["id","drillDownOpt","name","drillDown",1,"col-9","form-control",3,"ngModel","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"col-sm-12","col-md-10","col-lg-4","card","align-right","px-0"],[1,"card-header","p-2"],[1,"mr-1"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"card-body","p-2"],[1,"col","col-sm-6"],[1,"col","col-sm-6","text-right"],[1,"col","col-sm-6",3,"title"],[1,"pl-3","col-3","border-right","scroll","d-print-none"],[1,"pt-2","text-dark","font-weight-bold"],[1,"col-9"],[3,"graphData","graphOptions","parentThis","language"],[1,"col-12"],["style","white-space: nowrap;",4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[1,"dropdown-item","tree-item",3,"ngClass","click"],[3,"click"],[1,"fa",3,"ngClass"],[1,"ml-sm-1"],["class","ml-sm-1",4,"ngIf"],[3,"ngStyle",4,"ngIf"],[1,"fas","fa-arrow-up",2,"color","red"],[1,"fas","fa-arrow-down",2,"color","green"],[3,"ngStyle"],["role","status",1,"spinner-border"]],template:function(t,e){1&t&&(Nr(0,"div",0),Jr("resized",(function(t){return e.onResized(t)})),Nr(1,"div",1),Nr(2,"div",2),Nr(3,"div",3),Nr(4,"div",4),Lr(5,FV,17,16,"div",5),Lr(6,qV,3,2,"div",6),Fr(),Fr(),Lr(7,sw,28,30,"div",7),Fr(),Fr(),Nr(8,"div"),Nr(9,"div",8),Lr(10,aw,5,7,"div",9),Lr(11,uw,2,1,"div",10),Lr(12,mw,2,1,"div",11),Lr(13,fw,4,3,"div",12),Fr(),Fr(),Lr(14,Dw,1,1,"ng-template",null,13,ja),Lr(16,Iw,1,5,"ng-template",null,14,ja),Lr(18,Sw,5,3,"div",12),Fr()),2&t&&(_n(5),jr("ngIf",!e.getPreView()),_n(1),jr("ngIf",!e.getPreView()),_n(1),jr("ngIf",e.visboCapacity&&e.visboCapacity.length>0),_n(3),jr("ngIf",e.orgaTreeData&&!e.getPreView()),_n(1),jr("ngIf",!e.getPreView()),_n(1),jr("ngIf",e.getPreView()),_n(1),jr("ngIf",0==e.displayCapacity()),_n(5),jr("ngIf",e.displayCapacity()<0))},directives:[EV,jc,Ed,Nd,Ou,_d,cu,Gc,du,gu,Bc,jV,Ec,Fc],pipes:[lv,qc,zc],styles:[".dropdown-item.tree-item[_ngcontent-%COMP%]{opacity:.7;cursor:pointer}.dropdown-item.tree-item.tree-item__selected[_ngcontent-%COMP%]{background-color:#afb9c0}.dropdown-item.tree-item.tree-item__parent-selected[_ngcontent-%COMP%]{background-color:#d8dadb}.dropdown-item.tree-item[_ngcontent-%COMP%]:hover{opacity:1}.scroll[_ngcontent-%COMP%]{background:#fcfdfd;height:645px;overflow-y:scroll;padding:1px}"]}),t})(),Uw=(()=>{class t{constructor(t){this.gChartService=t}ngOnInit(){this.language||(this.language="de"),this.gLib=this.gChartService.getGoogle(),this.gLib.charts.load("current",{packages:["corechart","table"],language:this.language}),this.gLib.charts.setOnLoadCallback(this.drawChart.bind(this))}ngOnChanges(){this.initialised&&this.drawChart()}drawChart(){const t=new this.gLib.visualization.BubbleChart(document.getElementById("divBubbleChart")),e=new this.gLib.visualization.arrayToDataTable(this.graphData),i=this.parentThis;this.gLib.visualization.events.addListener(t,"select",(function(){const n=t.getSelection()[0];if(void 0===i)console.log("Bubble: The user clicked and this is undefined");else if(n){const t=n.row,s=e.getValue(n.row,0);i.chartSelectRow(t,s)}})),this.gLib.visualization.events.addListener(t,"click",(function(t){void 0===i?console.log("Bubble: The user clicked and this is undefined"):t||console.log("Bubble: The user clicked somewhere")})),t.draw(e,this.graphOptions||{title:"Bubble Chart"}),this.initialised=!0}}return t.\u0275fac=function(e){return new(e||t)(Rr(RV))},t.\u0275cmp=le({type:t,selectors:[["app-bubble-chart"]],inputs:{graphData:"graphData",language:"language",graphOptions:"graphOptions",parentThis:"parentThis"},features:[_e],decls:1,vars:0,consts:[["id","divBubbleChart"]],template:function(t,e){1&t&&Br(0,"div",0)},styles:["#divBubbleChart[_ngcontent-%COMP%]{width:100%;height:400px}"]}),t})();function Ow(t,e){if(1&t&&(Nr(0,"div",30),Nr(1,"div",31),Nr(2,"div",32),Nr(3,"span"),mo(4),Ua(5,"translate"),Fr(),Nr(6,"span",33),Nr(7,"a",34),mo(8),Fr(),Fr(),Nr(9,"span"),mo(10),Ua(11,"translate"),Fr(),Nr(12,"span",33),Nr(13,"a",34),mo(14),Fr(),Fr(),Nr(15,"span"),mo(16),Ua(17,"translate"),Fr(),Nr(18,"span",35),Nr(19,"a",34),Br(20,"i",36),Fr(),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr(2);_n(4),vo("",Oa(5,5,"compViewBubble.lbl.show")," "),_n(4),fo(t.getMetric(t.metricX).name),_n(2),vo(" ",Oa(11,7,"compViewBubble.lbl.and")," "),_n(4),fo(t.getMetric(t.metricY).name),_n(2),vo(" ",Oa(17,9,"compViewBubble.lbl.planVsBase"),"")}}function Ew(t,e){if(1&t){const t=zr();Nr(0,"div",37),Nr(1,"div",38),Nr(2,"div",32),Nr(3,"span"),mo(4),Ua(5,"translate"),Fr(),Nr(6,"input",39),Jr("keyup",(function(e){return ei(t),Xr(2).filterKeyBoardEvent(e)}))("ngModelChange",(function(e){return ei(t),Xr(2).filter=e})),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(4),vo(" ",Oa(5,2,"compViewBubble.lbl.filter"),":"),_n(2),jr("ngModel",t.filter)}}function Lw(t,e){1&t&&qr(0)}function Gw(t,e){1&t&&qr(0)}function Rw(t,e){1&t&&qr(0)}const jw=function(t){return{level:t}};function $w(t,e){if(1&t&&(Nr(0,"div",40),Nr(1,"h5",41),Nr(2,"strong",42),Lr(3,Lw,1,0,"ng-container",43),Fr(),mo(4),Ua(5,"translate"),Fr(),Nr(6,"div",44),Nr(7,"div",45),Nr(8,"div",46),mo(9),Ua(10,"translate"),Fr(),Nr(11,"div",47),Nr(12,"strong",42),Lr(13,Gw,1,0,"ng-container",43),Fr(),mo(14),Fr(),Fr(),Nr(15,"div",45),Nr(16,"div",48),Ua(17,"translate"),mo(18),Ua(19,"translate"),Ua(20,"translate"),Fr(),Nr(21,"div",47),Nr(22,"strong",42),Lr(23,Rw,1,0,"ng-container",43),Fr(),mo(24),Ua(25,"number"),Fr(),Fr(),Nr(26,"div",45),Nr(27,"div",48),Ua(28,"translate"),mo(29),Ua(30,"translate"),Ua(31,"translate"),Fr(),Nr(32,"div",47),mo(33),Ua(34,"number"),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr(2),e=Gr(4);_n(3),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(40,jw,t.getLevel(t.estimateAtCompletion,t.budgetAtCompletion))),_n(1),vo(" ",Oa(5,18,"compViewBubble.metric.costName")," "),_n(5),vo(" ",Oa(10,20,"compViewBubble.lbl.nrProjects")," "),_n(4),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(42,jw,t.countKM<t.visbokeymetrics.length?2:1)),_n(1),bo(" ",t.countKM," / ",t.visbokeymetrics.length," "),_n(2),to("title",Oa(17,22,"keyMetrics.longEAC")),_n(2),bo(" ",Oa(19,24,"keyMetrics.shortEAC")," (",Oa(20,26,"keyMetrics.longEAC"),") "),_n(5),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(44,jw,t.getLevel(t.estimateAtCompletion,t.budgetAtCompletion))),_n(1),vo(" ",Ea(25,28,t.estimateAtCompletion,"1.0-0")," T\u20ac "),_n(3),to("title",Oa(28,31,"keyMetrics.longBAC")),_n(2),bo(" ",Oa(30,33,"keyMetrics.shortBAC")," (",Oa(31,35,"keyMetrics.longBAC"),") "),_n(4),vo(" ",Ea(34,37,t.budgetAtCompletion,"1.0-0")," T\u20ac ")}}function Nw(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-bubble-chart",49),Fr()),2&t){const t=Xr(3);_n(1),jr("graphData",t.graphBubbleData)("graphOptions",t.graphBubbleOptions)("parentThis",t.parentThis)("language",t.currentLang)}}function Fw(t,e){if(1&t&&(Nr(0,"div",37),Lr(1,Nw,2,4,"div",29),Fr()),2&t){const t=Xr(2);_n(1),jr("ngIf",t.countKM>0&&t.graphBubbleData)}}function Bw(t,e){if(1&t){const t=zr();Nr(0,"th",60),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(12)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"compViewBubble.lbl.variant")))}function Hw(t,e){if(1&t){const t=zr();Nr(0,"th",61),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(16)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"compViewBubble.lbl.pv")))}function Kw(t,e){if(1&t){const t=zr();Nr(0,"th",62),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(15)})),mo(1),Fr()}if(2&t){const t=Xr(3);_n(1),fo(t.getMetric("ActualCost").table)}}function qw(t,e){if(1&t){const t=zr();Nr(0,"th",61),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(3)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"compViewBubble.lbl.bac")))}function zw(t,e){if(1&t){const t=zr();Nr(0,"th",62),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(2)})),mo(1),Fr()}if(2&t){const t=Xr(3);_n(1),fo(t.getMetric("Cost").table)}}function Qw(t,e){if(1&t){const t=zr();Nr(0,"th",61),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(5)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"compViewBubble.lbl.endDate")))}function Ww(t,e){if(1&t){const t=zr();Nr(0,"th",62),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(4)})),mo(1),Fr()}if(2&t){const t=Xr(3);_n(1),fo(t.getMetric("EndDate").table)}}function Jw(t,e){if(1&t){const t=zr();Nr(0,"th",61),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(7)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"compViewBubble.lbl.deadlines")))}function Yw(t,e){if(1&t){const t=zr();Nr(0,"th",62),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(6)})),mo(1),Fr()}if(2&t){const t=Xr(3);_n(1),fo(t.getMetric("Deadline").table)}}function Zw(t,e){if(1&t){const t=zr();Nr(0,"th",62),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(11)})),mo(1),Fr()}if(2&t){const t=Xr(3);_n(1),fo(t.getMetric("DeadlineUnFinishedDelay").table)}}function Xw(t,e){if(1&t){const t=zr();Nr(0,"th",62),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(10)})),mo(1),Fr()}if(2&t){const t=Xr(3);_n(1),fo(t.getMetric("DeadlineFinishedDelay").table)}}function tA(t,e){if(1&t){const t=zr();Nr(0,"th",61),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(9)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"compViewBubble.lbl.deliveries")))}function eA(t,e){if(1&t){const t=zr();Nr(0,"th",62),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(8)})),mo(1),Fr()}if(2&t){const t=Xr(3);_n(1),fo(t.getMetric("Delivery").table)}}function iA(t,e){if(1&t&&(Nr(0,"td",53),mo(1),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(t.variantName)}}function nA(t,e){1&t&&qr(0)}function sA(t,e){if(1&t&&(Nr(0,"td",70),mo(1),Ua(2,"number"),Fr()),2&t){const t=Xr().$implicit;_n(1),vo("",Ea(2,1,t.keyMetrics.costBaseLastActual||0,"1.0-0")," k\u20ac")}}function rA(t,e){1&t&&qr(0)}function oA(t,e){if(1&t&&(Nr(0,"td",71),Ua(1,"number"),Lr(2,rA,1,0,"ng-container",43),mo(3),Ua(4,"number"),Fr()),2&t){const t=Xr().$implicit,e=Xr(3),i=Gr(4);eo("title","",Ea(1,4,t.keyMetrics.costCurrentActual||0,"1.0-0")," k\u20ac"),_n(2),jr("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(10,jw,e.calcLevel(t.savingCostActual,"percentOver"))),_n(1),vo(" ",Ea(4,7,100*t.savingCostActual,"1.0-0")," % ")}}function aA(t,e){1&t&&Br(0,"td",70)}function lA(t,e){1&t&&Br(0,"td")}function cA(t,e){if(1&t&&(Nr(0,"td",70),mo(1),Ua(2,"number"),Fr()),2&t){const t=Xr().$implicit;_n(1),vo("",Ea(2,1,t.keyMetrics.costBaseLastTotal,"1.0-0")," k\u20ac")}}function dA(t,e){1&t&&qr(0)}function uA(t,e){if(1&t&&(Nr(0,"td",71),Ua(1,"number"),Lr(2,dA,1,0,"ng-container",43),mo(3),Ua(4,"number"),Fr()),2&t){const t=Xr().$implicit,e=Xr(3),i=Gr(4);eo("title","",Ea(1,4,t.keyMetrics.costCurrentTotal,"1.0-0")," k\u20ac"),_n(2),jr("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(10,jw,e.calcLevel(t.savingCostTotal,"percentOver"))),_n(1),vo(" ",Ea(4,7,100*t.savingCostTotal,"1.0-0")," % ")}}function hA(t,e){1&t&&Br(0,"td",70)}function pA(t,e){1&t&&Br(0,"td")}function gA(t,e){if(1&t&&(Nr(0,"td",70),mo(1),Ua(2,"date"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.keyMetrics.endDateBaseLast,"dd.MM.yyyy"))}}function mA(t,e){1&t&&qr(0)}function fA(t,e){if(1&t&&(Nr(0,"td",71),Ua(1,"date"),Lr(2,mA,1,0,"ng-container",43),mo(3),Ua(4,"number"),Fr()),2&t){const t=Xr().$implicit,e=Xr(3),i=Gr(4);to("title",Ea(1,4,t.keyMetrics.endDateCurrent,"dd.MM.yyyy")),_n(2),jr("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(10,jw,e.calcLevel(t.savingEndDate,"delay"))),_n(1),vo(" ",Ea(4,7,t.savingEndDate,"1.0-0")," weeks ")}}function vA(t,e){if(1&t&&(Nr(0,"td",70),mo(1),Ua(2,"date"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.endDate,"dd.MM.yyyy"))}}function bA(t,e){1&t&&Br(0,"td",72)}function yA(t,e){if(1&t&&(Nr(0,"td",70),mo(1),Ua(2,"number"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.keyMetrics.timeCompletionBaseLastActual,"1.0-0"))}}function CA(t,e){1&t&&qr(0)}function VA(t,e){if(1&t&&(Nr(0,"td",71),Ua(1,"number"),Lr(2,CA,1,0,"ng-container",43),mo(3),Ua(4,"number"),Fr()),2&t){const t=Xr().$implicit,e=Xr(3),i=Gr(4);to("title",Ea(1,4,t.keyMetrics.timeCompletionCurrentActual,"1.0-0")),_n(2),jr("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(10,jw,e.calcLevel(t.timeCompletionActual,"percentUnder"))),_n(1),vo(" ",Ea(4,7,100*t.timeCompletionActual,"1.0-0")," % ")}}function wA(t,e){1&t&&Br(0,"td",70)}function AA(t,e){1&t&&Br(0,"td",72)}function PA(t,e){if(1&t&&(Nr(0,"td",72),mo(1),Ua(2,"number"),Ua(3,"translate"),Fr()),2&t){const t=Xr().$implicit;_n(1),bo("",Ea(2,2,t.keyMetrics.timeDelayUnFinished||0,"1.0-0")," ",Oa(3,5,"compViewBubble.lbl.days"),"")}}function kA(t,e){if(1&t&&(Nr(0,"td",72),mo(1),Ua(2,"number"),Ua(3,"translate"),Fr()),2&t){const t=Xr().$implicit;_n(1),bo("",Ea(2,2,t.keyMetrics.timeDelayFinished||0,"1.0-0")," ",Oa(3,5,"compViewBubble.lbl.days"),"")}}function DA(t,e){1&t&&Br(0,"td",72)}function MA(t,e){1&t&&Br(0,"td",72)}function IA(t,e){if(1&t&&(Nr(0,"td",70),mo(1),Ua(2,"number"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.keyMetrics.deliverableCompletionBaseLastActual,"1.0-0"))}}function SA(t,e){1&t&&qr(0)}function xA(t,e){if(1&t&&(Nr(0,"td",71),Ua(1,"number"),Lr(2,SA,1,0,"ng-container",43),mo(3),Ua(4,"number"),Fr()),2&t){const t=Xr().$implicit,e=Xr(3),i=Gr(4);to("title",Ea(1,4,t.keyMetrics.deliverableCompletionCurrentActual,"1.0-0")),_n(2),jr("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(10,jw,e.calcLevel(t.deliveryCompletionActual,"percentUnder"))),_n(1),vo(" ",Ea(4,7,100*t.deliveryCompletionActual,"1.0-0")," % ")}}function TA(t,e){1&t&&Br(0,"td",70)}function _A(t,e){1&t&&Br(0,"td")}function UA(t,e){if(1&t){const t=zr();Nr(0,"tr",63),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(3).gotoClickedRow(i)})),Nr(1,"td",53),mo(2),Fr(),Nr(3,"td"),mo(4),Fr(),Lr(5,iA,2,1,"td",64),Nr(6,"td",65),Ua(7,"date"),mo(8),Ua(9,"date"),Fr(),Nr(10,"td",66),Lr(11,nA,1,0,"ng-container",43),Fr(),Lr(12,sA,3,4,"td",67),Lr(13,oA,5,12,"td",68),Lr(14,aA,1,0,"td",67),Lr(15,lA,1,0,"td",29),Lr(16,cA,3,4,"td",67),Lr(17,uA,5,12,"td",68),Lr(18,hA,1,0,"td",67),Lr(19,pA,1,0,"td",29),Lr(20,gA,3,4,"td",67),Lr(21,fA,5,12,"td",68),Lr(22,vA,3,4,"td",67),Lr(23,bA,1,0,"td",69),Lr(24,yA,3,4,"td",67),Lr(25,VA,5,12,"td",68),Lr(26,wA,1,0,"td",67),Lr(27,AA,1,0,"td",69),Lr(28,PA,4,7,"td",69),Lr(29,kA,4,7,"td",69),Lr(30,DA,1,0,"td",69),Lr(31,MA,1,0,"td",69),Lr(32,IA,3,4,"td",67),Lr(33,xA,5,12,"td",68),Lr(34,TA,1,0,"td",67),Lr(35,_A,1,0,"td",29),Fr()}if(2&t){const t=e.$implicit,i=e.index,n=Xr(3),s=Gr(6);_n(2),fo(i+1),_n(2),fo(t.name),_n(1),jr("ngIf",n.hasVariant),_n(1),to("title",Ea(7,32,t.timestamp,"dd.MM.yy HH:MM")),_n(2),fo(Ea(9,35,t.timestamp,"dd.MM.yy")),_n(2),to("title",t.ampelErlaeuterung),_n(1),jr("ngTemplateOutlet",s)("ngTemplateOutletContext",ka(38,jw,t.ampelStatus)),_n(1),jr("ngIf",n.selectedMetric("ActualCost")&&t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("ActualCost")&&t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("Cost")&&!t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("Cost")&&!t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("Cost")&&t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("Cost")&&t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("Cost")&&!t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("Cost")&&!t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("EndDate")&&t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("EndDate")&&t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("EndDate")&&!t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("EndDate")&&!t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("Deadline")&&t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("Deadline")&&t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("Deadline")&&!t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("Deadline")&&!t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("DeadlineUnFinishedDelay")&&t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("DeadlineFinishedDelay")&&t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("DeadlineUnFinishedDelay")&&!t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("DeadlineFinishedDelay")&&!t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("Delivery")&&t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("Delivery")&&t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("Delivery")&&!t.keyMetrics),_n(1),jr("ngIf",n.selectedMetric("Delivery")&&!t.keyMetrics)}}function OA(t,e){if(1&t){const t=zr();Nr(0,"div",50),Nr(1,"div",51),Nr(2,"table",52),Nr(3,"thead"),Nr(4,"tr"),Nr(5,"th",53),mo(6),Ua(7,"translate"),Fr(),Nr(8,"th",54),Jr("click",(function(){return ei(t),Xr(2).sortKeyMetricsTable(1)})),mo(9),Ua(10,"translate"),Fr(),Lr(11,Bw,3,3,"th",55),Nr(12,"th",56),Jr("click",(function(){return ei(t),Xr(2).sortKeyMetricsTable(13)})),mo(13),Ua(14,"translate"),Fr(),Nr(15,"th",54),Jr("click",(function(){return ei(t),Xr(2).sortKeyMetricsTable(14)})),mo(16),Ua(17,"translate"),Fr(),Lr(18,Hw,3,3,"th",57),Lr(19,Kw,2,1,"th",58),Lr(20,qw,3,3,"th",57),Lr(21,zw,2,1,"th",58),Lr(22,Qw,3,3,"th",57),Lr(23,Ww,2,1,"th",58),Lr(24,Jw,3,3,"th",57),Lr(25,Yw,2,1,"th",58),Lr(26,Zw,2,1,"th",58),Lr(27,Xw,2,1,"th",58),Lr(28,tA,3,3,"th",57),Lr(29,eA,2,1,"th",58),Fr(),Fr(),Nr(30,"tbody"),Lr(31,UA,36,40,"tr",59),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(6),fo(Oa(7,18,"compViewBubble.lbl.nr")),_n(3),fo(Oa(10,20,"compViewBubble.lbl.project")),_n(2),jr("ngIf",t.hasVariant),_n(2),fo(Oa(14,22,"compViewBubble.lbl.timestamp")),_n(3),fo(Oa(17,24,"keyMetrics.lbl.trafficLight")),_n(2),jr("ngIf",t.selectedMetric("ActualCost")),_n(1),jr("ngIf",t.selectedMetric("ActualCost")),_n(1),jr("ngIf",t.selectedMetric("Cost")),_n(1),jr("ngIf",t.selectedMetric("Cost")),_n(1),jr("ngIf",t.selectedMetric("EndDate")),_n(1),jr("ngIf",t.selectedMetric("EndDate")),_n(1),jr("ngIf",t.selectedMetric("Deadline")),_n(1),jr("ngIf",t.selectedMetric("Deadline")),_n(1),jr("ngIf",t.selectedMetric("DeadlineUnFinishedDelay")),_n(1),jr("ngIf",t.selectedMetric("DeadlineFinishedDelay")),_n(1),jr("ngIf",t.selectedMetric("Delivery")),_n(1),jr("ngIf",t.selectedMetric("Delivery")),_n(2),jr("ngForOf",t.visbokeymetrics)}}function EA(t,e){1&t&&(Nr(0,"div"),Nr(1,"h3",73),mo(2),Ua(3,"translate"),Fr(),Fr()),2&t&&(_n(2),vo(" ",Oa(3,1,"compViewBubble.msg.noVersions")," "))}function LA(t,e){if(1&t){const t=zr();Nr(0,"div",22),Jr("resized",(function(e){return ei(t),Xr().onResized(e)})),Nr(1,"div",23),Nr(2,"div",24),Lr(3,Ow,21,11,"div",25),Lr(4,Ew,7,4,"div",26),Fr(),Lr(5,$w,35,46,"div",27),Fr(),Nr(6,"div"),Lr(7,Fw,2,1,"div",26),Lr(8,OA,32,26,"div",28),Fr(),Lr(9,EA,4,3,"div",29),Fr()}if(2&t){const t=Xr();_n(3),jr("ngIf",t.metricListFiltered&&t.metricListFiltered.length>=2&&!t.getPreView()),_n(1),jr("ngIf",t.filter||!t.getPreView()),_n(1),jr("ngIf",t.visbokeymetrics.length>0&&t.hasKMCost),_n(2),jr("ngIf",t.chart),_n(1),jr("ngIf",0==t.chart),_n(1),jr("ngIf",0==t.visbokeymetrics.length)}}function GA(t,e){if(1&t&&(Nr(0,"div",45),Nr(1,"div",48),Ua(2,"translate"),mo(3),Ua(4,"translate"),Fr(),Nr(5,"div",47),mo(6),Fr(),Fr()),2&t){const t=e.label,i=e.title,n=e.value;_n(1),to("title",Oa(2,3,i)),_n(2),vo(" ",Oa(4,5,t)," "),_n(3),vo(" ",n," ")}}const RA=function(t,e,i){return{"fa-check-circle text-success":t,"fa-exclamation-triangle text-warning":e,"fa-exclamation-circle text-danger":i}};function jA(t,e){if(1&t&&Br(0,"i",74),2&t){const t=e.level;jr("ngClass",Ma(1,RA,1==t,2==t,3==t))}}const $A=function(t,e,i,n){return{"text-secondary":t,"text-success":e,"text-warning":i,"text-danger":n}};function NA(t,e){if(1&t&&Br(0,"i",75),2&t){const t=e.level;jr("ngClass",Ia(1,$A,0==t,1==t,2==t,3==t))}}function FA(t,e){if(1&t&&(Nr(0,"option",76),mo(1),Fr()),2&t){const t=e.$implicit;to("value",t.metric),_n(1),fo(t.name)}}function BA(t,e){if(1&t&&(Nr(0,"option",76),mo(1),Fr()),2&t){const t=e.$implicit;to("value",t.metric),_n(1),fo(t.name)}}let HA=(()=>{class t{constructor(t,e,i,n,s){this.messageService=t,this.alertService=e,this.route=i,this.router=n,this.translate=s,this.visbokeymetrics=[],this.colorMetric=[{name:"Critical",color:"red"},{name:"Warning",color:"yellow"},{name:"Good",color:"green"}],this.hasKMCost=!1,this.hasKMDelivery=!1,this.hasKMDeadline=!1,this.hasKMEndDate=!1,this.hasKMDeadlineDelay=!1,this.hasKMDeliveryDelay=!1,this.estimateAtCompletion=0,this.budgetAtCompletion=0,this.chart=!0,this.parentThis=this,this.graphBubbleData=[],this.graphBubbleOptions={width:"100%",vAxis:{baseline:0,minValue:20,maxValue:200,direction:-1,format:"",title:"Change in End Date (weeks)",baselineColor:"blue"},hAxis:{minValue:20,maxValue:200,baseline:1,direction:-1,format:"# '%'",title:"Total Cost",baselineColor:"blue"},sizeAxis:{minValue:20,maxValue:200},explorer:{actions:["dragToZoom","rightClickToReset"],maxZoomIn:.01},bubble:{textStyle:{auraColor:"none",fontSize:13}},tooltip:{showColorCode:!1},series:{Critical:{color:this.colorMetric[0].color},Warning:{color:this.colorMetric[1].color},Good:{color:this.colorMetric[2].color}}},this.sortColumn=6,this.permVC=Iv,this.permVP=Sv}ngOnInit(){this.currentLang=this.translate.currentLang,this.log("Init KeyMetrics"),this.metricList=[{name:this.translate.instant("compViewBubble.metric.costName"),metric:"Cost",axis:this.translate.instant("compViewBubble.metric.costAxis"),bubble:this.translate.instant("compViewBubble.metric.costBubble"),table:this.translate.instant("compViewBubble.metric.costTable")},{name:this.translate.instant("compViewBubble.metric.endDateName"),metric:"EndDate",axis:this.translate.instant("compViewBubble.metric.endDateAxis"),bubble:this.translate.instant("compViewBubble.metric.endDateBubble"),table:this.translate.instant("compViewBubble.metric.endDateTable")},{name:this.translate.instant("compViewBubble.metric.costActualName"),metric:"ActualCost",axis:this.translate.instant("compViewBubble.metric.costActualAxis"),bubble:this.translate.instant("compViewBubble.metric.costActualBubble"),table:this.translate.instant("compViewBubble.metric.costActualTable")},{name:this.translate.instant("compViewBubble.metric.deadlineName"),metric:"Deadline",axis:this.translate.instant("compViewBubble.metric.deadlineAxis"),bubble:this.translate.instant("compViewBubble.metric.deadlineBubble"),table:this.translate.instant("compViewBubble.metric.deadlineTable")},{name:this.translate.instant("compViewBubble.metric.deadlineFinishedDelayName"),metric:"DeadlineFinishedDelay",axis:this.translate.instant("compViewBubble.metric.deadlineFinishedDelayAxis"),bubble:this.translate.instant("compViewBubble.metric.deadlineFinishedDelayBubble"),table:this.translate.instant("compViewBubble.metric.deadlineFinishedDelayTable")},{name:this.translate.instant("compViewBubble.metric.deadlineUnFinishedDelayName"),metric:"DeadlineUnFinishedDelay",axis:this.translate.instant("compViewBubble.metric.deadlineUnFinishedDelayAxis"),bubble:this.translate.instant("compViewBubble.metric.deadlineUnFinishedDelayBubble"),table:this.translate.instant("compViewBubble.metric.deadlineUnFinishedDelayTable")},{name:this.translate.instant("compViewBubble.metric.deliveryName"),metric:"Delivery",axis:this.translate.instant("compViewBubble.metric.deliveryAxis"),bubble:this.translate.instant("compViewBubble.metric.deliveryBubble"),table:this.translate.instant("compViewBubble.metric.deliveryTable")},{name:this.translate.instant("compViewBubble.metric.deliveryFinishedDelayName"),metric:"DeliveryFinishedDelay",axis:this.translate.instant("compViewBubble.metric.deliveryFinishedDelayAxis"),bubble:this.translate.instant("compViewBubble.metric.deliveryFinishedDelayBubble"),table:this.translate.instant("compViewBubble.metric.deliveryFinishedDelayTable")},{name:this.translate.instant("compViewBubble.metric.deliveryUnFinishedDelayName"),metric:"DeliveryUnFinishedDelay",axis:this.translate.instant("compViewBubble.metric.deliveryUnFinishedDelayAxis"),bubble:this.translate.instant("compViewBubble.metric.deliveryUnFinishedDelayBubble"),table:this.translate.instant("compViewBubble.metric.deliveryUnFinishedDelayTable")}],this.initSetting(),this.chart!=this.bubbleMode&&this.toggleVisboChart(),this.visboKeyMetricsCalc()}ngOnChanges(t){this.log(`Delivery on Changes  ${this.activeID}, Changes: ${JSON.stringify(t)}`),this.metricList&&(this.initSetting(),this.visboKeyMetricsCalc())}onResized(t){t||this.log("No event in Resize"),this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(()=>{this.visboKeyMetricsCalc(),this.timeoutID=void 0},500)}initSetting(){this.activeID=this.route.snapshot.paramMap.get("id");const t=this.route.snapshot.queryParams.refDate,e=this.route.snapshot.queryParams.filter||void 0,i=this.route.snapshot.queryParams.metricX||void 0;let n=this.route.snapshot.queryParams.metricY||void 0;i===n&&(n=void 0),this.metricX=this.getMetric(i,n,!1).metric,this.metricY=this.getMetric(n,this.metricX,!1).metric,this.refDate=t?new Date(t):new Date,e&&(this.filter=e)}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}filterKeyBoardEvent(t){t||this.log("No Keyboard Event"),this.updateUrlParam("filter",this.filter),this.visboKeyMetricsCalc()}updateUrlParam(t,e){const i=this.route.snapshot.url.join("/");void 0===e&&(e=null);const n=new DV;"filter"==t?(n.filter=e,localStorage.setItem("vpfFilter",e||"")):"metricX"!=t&&"metricY"!=t||(n.metricX=this.metricX,n.metricY=this.metricY),this.router.navigate([i],{queryParams:n,replaceUrl:!0,queryParamsHandling:"merge"})}visboKeyMetricsCalc(){if(this.visbokeymetrics=[],this.countKM=0,this.budgetAtCompletion=0,this.estimateAtCompletion=0,this.hasKMCost=!1,this.hasKMDelivery=!1,this.hasKMDeadline=!1,this.hasKMDeadlineDelay=!1,this.hasKMDeliveryDelay=!1,this.hasKMEndDate=!1,this.hasVariant=!1,!this.visboprojectversions)return;const t=(this.filter||"").toLowerCase();for(let e=0;e<this.visboprojectversions.length;e++)if(!t||this.visboprojectversions[e].name.toLowerCase().indexOf(t)>=0||(this.visboprojectversions[e].VorlagenName||"").toLowerCase().indexOf(t)>=0||(this.visboprojectversions[e].businessUnit||"").toLowerCase().indexOf(t)>=0||(this.visboprojectversions[e].leadPerson||"").toLowerCase().indexOf(t)>=0||(this.visboprojectversions[e].description||"").toLowerCase().indexOf(t)>=0||(this.visboprojectversions[e].status||"").toLowerCase().indexOf(t)>=0){const t=new MV;if(t.name=this.visboprojectversions[e].name,t.variantName=this.visboprojectversions[e].variantName,t.ampelStatus=this.visboprojectversions[e].ampelStatus,t.ampelErlaeuterung=this.visboprojectversions[e].ampelErlaeuterung,t._id=this.visboprojectversions[e]._id,t.vpid=this.visboprojectversions[e].vpid,t.timestamp=this.visboprojectversions[e].timestamp,this.visboprojectversions[e].keyMetrics){this.countKM+=1,t.keyMetrics=this.visboprojectversions[e].keyMetrics,this.hasKMCost=this.hasKMCost||t.keyMetrics.costBaseLastTotal>=0,this.hasKMDelivery=this.hasKMDelivery||t.keyMetrics.deliverableCompletionBaseLastTotal>0,this.hasKMDeadline=this.hasKMDeadline||t.keyMetrics.timeCompletionBaseLastTotal>1,this.hasKMDeadlineDelay=(this.hasKMDeadline||t.keyMetrics.timeCompletionBaseLastTotal>1)&&(this.hasKMDeadlineDelay||null!=t.keyMetrics.timeDelayFinished||null!=t.keyMetrics.timeDelayUnFinished),this.hasKMDeliveryDelay=this.hasKMDeliveryDelay||null!=t.keyMetrics.deliverableDelayFinished||null!=t.keyMetrics.deliverableDelayUnFinished,this.hasKMEndDate=this.hasKMEndDate||t.keyMetrics.endDateBaseLast.toString().length>0,this.budgetAtCompletion+=t.keyMetrics.costBaseLastTotal||0,this.estimateAtCompletion+=t.keyMetrics.costCurrentTotal||0,t.savingCostTotal=t.keyMetrics.costBaseLastTotal>0?(t.keyMetrics.costCurrentTotal||0)/t.keyMetrics.costBaseLastTotal:1,t.savingCostActual=t.keyMetrics.costBaseLastActual>0?(t.keyMetrics.costCurrentActual||0)/t.keyMetrics.costBaseLastActual:1,t.keyMetrics.endDateCurrent&&t.keyMetrics.endDateBaseLast?(t.savingEndDate=this.helperDateDiff(new Date(t.keyMetrics.endDateCurrent).toISOString(),new Date(t.keyMetrics.endDateBaseLast).toISOString(),"d")||0,t.savingEndDate=Math.round(t.savingEndDate/7*10)/10):t.savingEndDate=0;const i=t.keyMetrics;t.timeCompletionTotal=this.calcPercent(i.timeCompletionCurrentTotal,t.keyMetrics.timeCompletionBaseLastTotal),t.timeCompletionActual=this.calcPercent(i.timeCompletionCurrentActual,t.keyMetrics.timeCompletionBaseLastActual),t.deliveryCompletionTotal=this.calcPercent(i.deliverableCompletionCurrentTotal,i.deliverableCompletionBaseLastTotal),t.deliveryCompletionActual=this.calcPercent(i.deliverableCompletionCurrentActual,i.deliverableCompletionBaseLastActual)}this.visbokeymetrics.push(t),this.visboprojectversions[e].variantName&&(this.hasVariant=!0)}this.sortKeyMetricsTable(void 0),this.thinDownMetricList(),this.visboKeyMetricsCalcBubble()}thinDownMetricList(){if(!this.metricListFiltered){if(this.metricListFiltered=[],this.hasKMCost){let t=this.metricList.find(t=>"Cost"===t.metric);this.metricListFiltered.push(t),t=this.metricList.find(t=>"ActualCost"===t.metric),this.metricListFiltered.push(t)}if(this.hasKMEndDate){const t=this.metricList.find(t=>"EndDate"===t.metric);this.metricListFiltered.push(t)}if(this.hasKMDelivery){const t=this.metricList.find(t=>"Delivery"===t.metric);this.metricListFiltered.push(t)}if(this.hasKMDeadline){const t=this.metricList.find(t=>"Deadline"===t.metric);this.metricListFiltered.push(t)}if(this.hasKMDeadlineDelay){let t=this.metricList&&this.metricList.find(t=>"DeadlineFinishedDelay"===t.metric);this.metricListFiltered.push(t),t=this.metricList&&this.metricList.find(t=>"DeadlineUnFinishedDelay"===t.metric),this.metricListFiltered.push(t)}if(this.hasKMDeliveryDelay){let t=this.metricList&&this.metricList.find(t=>"DeliveryFinishedDelay"===t.metric);this.metricListFiltered.push(t),t=this.metricList&&this.metricList.find(t=>"DeliveryUnFinishedDelay"===t.metric),this.metricListFiltered.push(t)}this.metricListFiltered.length<2&&(this.chart=!1),this.metricListSorted=[],this.metricListFiltered.forEach(t=>this.metricListSorted.push(t)),this.metricListSorted.sort((function(t,e){return xh(t.name,e.name)})),this.metricX=this.getMetric(this.metricX,this.metricY,!0).metric,this.metricY=this.getMetric(this.metricY,this.metricX,!0).metric}}getMetric(t,e,i=!1){const n=i?this.metricListFiltered:this.metricList;if(!n)return this.metricList[0];let s=n.find(i=>i.metric===t&&i.metric!==e);return s||(s=n.find(t=>t.metric!==e)),s||(s=n[0]),s}calcPercent(t,e){return void 0===e?void 0:0===e?1:(t||0)/e}toggleVisboChart(){this.chart=!this.chart}changeChart(){this.log(`Switch Chart to ${this.metricX} vs  ${this.metricY}`),this.metricY=this.getMetric(this.metricY,this.metricX,!1).metric,this.updateUrlParam("metricX",void 0),this.visboKeyMetricsCalc()}calcLevel(t,e){let i=0;return"percentOver"==e?i=t<=1?1:t>1.05?3:2:"percentUnder"==e?i=t>=1?1:t<.8?3:2:"delay"==e&&(i=t<=0?1:t>4?3:2),i}visboKeyMetricsCalcBubble(){this.graphBubbleAxis();const t=[];if(this.visbokeymetrics){this.visbokeymetrics.length>10&&(this.graphBubbleOptions.bubble.textStyle.fontSize=1),t.push(["ID",this.getMetric(this.metricX).bubble,this.getMetric(this.metricY).bubble,"Key Metrics Status","Total Cost (Base Line) in k\u20ac"]);for(let e=0;e<this.visbokeymetrics.length;e++){if(!this.visbokeymetrics[e].keyMetrics)continue;let i,n,s=0;switch(this.metricX){case"Cost":i=Math.round(100*this.visbokeymetrics[e].savingCostTotal),s+=i<=100?1:0;break;case"ActualCost":i=Math.round(100*this.visbokeymetrics[e].savingCostActual),s+=i<=100?1:0;break;case"EndDate":i=Math.round(this.visbokeymetrics[e].savingEndDate/7*10)/10,s+=i<=0?1:0;break;case"Deadline":i=Math.round(100*this.visbokeymetrics[e].timeCompletionActual),s+=i>=100?1:0;break;case"DeadlineFinishedDelay":i=Math.round((this.visbokeymetrics[e].keyMetrics.timeDelayFinished||0)/7*10)/10,s+=i<=0?1:0;break;case"DeadlineUnFinishedDelay":i=Math.round((this.visbokeymetrics[e].keyMetrics.timeDelayUnFinished||0)/7*10)/10,s+=i<=0?1:0;break;case"Delivery":i=Math.round(100*this.visbokeymetrics[e].deliveryCompletionActual),s+=i>=100?1:0}switch(this.metricY){case"Cost":n=Math.round(100*this.visbokeymetrics[e].savingCostTotal),s+=n<=100?1:0;break;case"ActualCost":n=Math.round(100*this.visbokeymetrics[e].savingCostActual),s+=n<=100?1:0;break;case"EndDate":n=Math.round(this.visbokeymetrics[e].savingEndDate/7*10)/10,s+=n<=0?1:0;break;case"Deadline":n=Math.round(100*this.visbokeymetrics[e].timeCompletionActual),s+=n>=100?1:0;break;case"DeadlineFinishedDelay":n=Math.round((this.visbokeymetrics[e].keyMetrics.timeDelayFinished||0)/7*10)/10,s+=n<=0?1:0;break;case"DeadlineUnFinishedDelay":n=Math.round((this.visbokeymetrics[e].keyMetrics.timeDelayUnFinished||0)/7*10)/10,s+=n<=0?1:0;break;case"Delivery":n=Math.round(100*this.visbokeymetrics[e].deliveryCompletionActual),s+=n>=100?1:0}t.push([this.combineName(this.visbokeymetrics[e].name,this.visbokeymetrics[e].variantName),i,n,this.colorMetric[s].name,Math.round(this.visbokeymetrics[e].keyMetrics.costBaseLastTotal||1)])}this.calcRangeAxis(),this.graphBubbleData=t}}calcRangeAxis(){let t=0,e=1/0,i=0;for(let n=0;n<this.visbokeymetrics.length;n++)if(this.visbokeymetrics[n].keyMetrics)switch(e=Math.min(e,this.visbokeymetrics[n].keyMetrics.costBaseLastTotal),i=Math.max(i,this.visbokeymetrics[n].keyMetrics.costBaseLastTotal),this.metricX){case"Cost":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].savingCostTotal-1)));break;case"ActualCost":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].savingCostActual-1)));break;case"EndDate":t=Math.max(t,Math.abs(this.visbokeymetrics[n].savingEndDate)/7);break;case"Deadline":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].timeCompletionActual-1)));break;case"DeadlineFinishedDelay":t=Math.max(t,Math.abs((this.visbokeymetrics[n].keyMetrics.timeDelayFinished||0)/7));break;case"DeadlineUnFinishedDelay":t=Math.max(t,Math.abs((this.visbokeymetrics[n].keyMetrics.timeDelayUnFinished||0)/7));break;case"Delivery":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].deliveryCompletionActual-1)))}e*=.8,i*=1.2,this.graphBubbleOptions.sizeAxis.minValue=e,this.graphBubbleOptions.sizeAxis.maxValue=i,"EndDate"===this.metricX||"DeadlineFinishedDelay"===this.metricX||"DeadlineUnFinishedDelay"===this.metricX?(t*=1.1,this.graphBubbleOptions.hAxis.minValue=-t,this.graphBubbleOptions.hAxis.maxValue=t):(t*=1.1,this.graphBubbleOptions.hAxis.minValue=100-t,this.graphBubbleOptions.hAxis.maxValue=100+t),t=0;for(let n=0;n<this.visbokeymetrics.length;n++)if(this.visbokeymetrics[n].keyMetrics)switch(this.metricY){case"Cost":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].savingCostTotal-1)));break;case"ActualCost":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].savingCostActual-1)));break;case"EndDate":t=Math.max(t,Math.abs(this.visbokeymetrics[n].savingEndDate)/7);break;case"Deadline":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].timeCompletionActual-1)));break;case"DeadlineFinishedDelay":t=Math.max(t,Math.abs((this.visbokeymetrics[n].keyMetrics.timeDelayFinished||0)/7));break;case"DeadlineUnFinishedDelay":t=Math.max(t,Math.abs((this.visbokeymetrics[n].keyMetrics.timeDelayUnFinished||0)/7));break;case"Delivery":t=Math.max(t,Math.abs(100*(this.visbokeymetrics[n].deliveryCompletionActual-1)))}"EndDate"===this.metricY||"DeadlineFinishedDelay"===this.metricY||"DeadlineUnFinishedDelay"===this.metricY?(t*=1.1,this.graphBubbleOptions.vAxis.minValue=-t,this.graphBubbleOptions.vAxis.maxValue=t):(t*=1.1,this.graphBubbleOptions.vAxis.minValue=100-t,this.graphBubbleOptions.vAxis.maxValue=100+t)}graphBubbleAxis(){if(!this.chart)return;const t="# "+this.translate.instant("compViewBubble.lbl.weeks");switch(this.graphBubbleOptions.hAxis.title=this.getMetric(this.metricX).axis,this.metricX){case"Cost":case"ActualCost":this.graphBubbleOptions.hAxis.baseline=100,this.graphBubbleOptions.hAxis.direction=-1,this.graphBubbleOptions.hAxis.format="# '%'";break;case"EndDate":this.graphBubbleOptions.hAxis.baseline=0,this.graphBubbleOptions.hAxis.direction=-1,this.graphBubbleOptions.hAxis.format=t;break;case"Deadline":this.graphBubbleOptions.hAxis.baseline=100,this.graphBubbleOptions.hAxis.direction=1,this.graphBubbleOptions.hAxis.format="# '%'";break;case"DeadlineFinishedDelay":case"DeadlineUnFinishedDelay":this.graphBubbleOptions.hAxis.baseline=0,this.graphBubbleOptions.hAxis.direction=-1,this.graphBubbleOptions.hAxis.format=t;break;case"Delivery":this.graphBubbleOptions.hAxis.baseline=100,this.graphBubbleOptions.hAxis.direction=1,this.graphBubbleOptions.hAxis.format="# '%'"}switch(this.graphBubbleOptions.vAxis.title=this.getMetric(this.metricY).axis,this.metricY){case"Cost":case"ActualCost":this.graphBubbleOptions.vAxis.baseline=100,this.graphBubbleOptions.vAxis.direction=-1,this.graphBubbleOptions.vAxis.format="# '%'";break;case"EndDate":this.graphBubbleOptions.vAxis.baseline=0,this.graphBubbleOptions.vAxis.direction=-1,this.graphBubbleOptions.vAxis.format=t;break;case"Deadline":this.graphBubbleOptions.vAxis.baseline=100,this.graphBubbleOptions.vAxis.direction=1,this.graphBubbleOptions.vAxis.format="# '%'";break;case"DeadlineFinishedDelay":case"DeadlineUnFinishedDelay":this.graphBubbleOptions.vAxis.baseline=0,this.graphBubbleOptions.vAxis.direction=-1,this.graphBubbleOptions.vAxis.format=t;break;case"Delivery":this.graphBubbleOptions.vAxis.baseline=100,this.graphBubbleOptions.vAxis.direction=1,this.graphBubbleOptions.vAxis.format="# '%'"}}gotoClickedRow(t){this.log(`goto VP ${t.name} (${t.vpid}) Deleted? ${this.deleted}`);const e=new yb;this.deleted&&(e.deleted="1"),t.variantName&&(e.variantName=t.variantName),this.refDate&&!Oh(this.refDate)&&(e.refDate=this.refDate.toISOString()),this.router.navigate(["vpKeyMetrics/".concat(t.vpid)],{queryParams:e})}chartSelectRow(t,e){this.log(`Bubble Chart: ${t} ${e} ${this.visbokeymetrics[t].name}`);let i=this.visbokeymetrics.find(t=>t.name===e);if(!i){const t=e.lastIndexOf(" ( ");if(t){const n=e.substr(0,t);i=this.visbokeymetrics.find(t=>t.name===n)}}i?this.gotoClickedRow(i):this.log("VP not found "+e)}selectedMetric(t){let e=!1;return this.metricX!==t&&this.metricY!==t||(e=!0),e}getLevel(t,e){let i=1;return e&&(i=t/e),i<=1?1:i<=1.05?2:3}combineName(t,e){let i=t||"";return e&&(i=i.concat(" ( ",e," ) ")),i}helperDateDiff(t,e,i){const n=new Date(t),s=new Date(e);let r=n.getTime()-s.getTime();return"w"===i?r=r/1e3/60/60/24/7:"d"===i?r=r/1e3/60/60/24:r/=1e3,r}sortKeyMetricsTable(t){this.visbokeymetrics&&(void 0!==t?(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t:!this.sortAscending):(this.sortColumn=1,this.sortAscending=!0),1===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return xh(t.name,e.name)})):2===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.savingCostTotal-e.savingCostTotal})):3===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.costBaseLastTotal)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.costBaseLastTotal)||0)})):4===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.savingEndDate-e.savingEndDate})):5===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return Th(null===(i=t.keyMetrics)||void 0===i?void 0:i.endDateBaseLast,null===(n=e.keyMetrics)||void 0===n?void 0:n.endDateBaseLast)})):6===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.timeCompletionActual-e.timeCompletionActual})):7===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.timeCompletionBaseLastActual)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.timeCompletionBaseLastActual)||0)})):8===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.deliveryCompletionActual-e.deliveryCompletionActual})):9===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.deliverableCompletionBaseLastActual)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.deliverableCompletionBaseLastActual)||0)})):10===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.timeDelayFinished)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.timeDelayFinished)||0)})):11===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.timeDelayUnFinished)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.timeDelayUnFinished)||0)})):12===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return xh(t.variantName,e.variantName)})):13===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return Th(t.timestamp,e.timestamp)})):14===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return(t.ampelStatus||0)-(e.ampelStatus||0)})):15===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.savingCostActual-e.savingCostActual})):16===this.sortColumn&&this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.costBaseLastActual)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.costBaseLastActual)||0)})),this.sortAscending||this.visbokeymetrics.reverse())}getPreView(){return Rh()}log(t){this.messageService.add("CompViewKeyMetrics: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(Mf),Rr(Bg),Rr(rf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-comp-viewbubble"]],inputs:{visboprojectversions:"visboprojectversions",bubbleMode:"bubbleMode",combinedPerm:"combinedPerm"},features:[_e],decls:36,vars:17,consts:[["class","well",3,"resized",4,"ngIf"],["cardRow",""],["indicator",""],["trafficLight",""],["id","VpfMetricSelector","tabindex","-1","role","dialog","aria-labelledby","VpfMetricSelectorTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VpfMetricSelectorTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],["novalidate",""],["f","ngForm"],[1,"form-group"],["for","XLabel",1,"col-form-label"],["id","XLabel","name","metricX",1,"form-control",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","YLabel",1,"col-form-label"],["id","YLabel","name","metricY",1,"form-control",3,"ngModel","ngModelChange"],[1,"modal-footer","align-items-end"],["type","submit","data-dismiss","modal",1,"btn","btn-primary",3,"click"],[1,"well",3,"resized"],[1,"row","row-cols-1","row-cols-lg-2"],[1,"col","col-sm-12","col-lg-8"],["class","container-fluid d-print-none",4,"ngIf"],["class","container-fluid",4,"ngIf"],["class","col-sm-12 col-md-10 col-lg-4 card align-right px-0",4,"ngIf"],["class","mt-3 container-fluid",4,"ngIf"],[4,"ngIf"],[1,"container-fluid","d-print-none"],[1,"row","text-dark","hidden-print"],[1,"my-1","pl-0","col-11"],[1,"font-weight-bold"],["data-toggle","modal","data-target","#VpfMetricSelector"],[1,"ml-2"],["aria-hidden","true",1,"fa","fa-cog"],[1,"container-fluid"],[1,"row","text-dark"],["type","text","placeholder","Filter",1,"ml-2",3,"ngModel","keyup","ngModelChange"],[1,"col-sm-12","col-md-10","col-lg-4","card","align-right","px-0"],[1,"card-header","p-2"],[1,"mr-1"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"card-body","p-2"],[1,"row"],[1,"col","col-sm-8"],[1,"col","col-sm-4","text-right"],[1,"col","col-sm-8",3,"title"],[3,"graphData","graphOptions","parentThis","language"],[1,"mt-3","container-fluid"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[1,"d-none","d-lg-table-cell"],[3,"click"],["class","d-none d-lg-table-cell",3,"click",4,"ngIf"],[1,"d-none","d-xl-table-cell",3,"click"],["class","text-right d-none d-md-table-cell",3,"click",4,"ngIf"],["class","text-right",3,"click",4,"ngIf"],["data-toggle","modal","data-target","#ProjectDetail",3,"click",4,"ngFor","ngForOf"],[1,"d-none","d-lg-table-cell",3,"click"],[1,"text-right","d-none","d-md-table-cell",3,"click"],[1,"text-right",3,"click"],["data-toggle","modal","data-target","#ProjectDetail",3,"click"],["class","d-none d-lg-table-cell",4,"ngIf"],[1,"d-none","d-xl-table-cell",3,"title"],[3,"title"],["class","text-right d-none d-md-table-cell",4,"ngIf"],["class","text-right",3,"title",4,"ngIf"],["class","text-right",4,"ngIf"],[1,"text-right","d-none","d-md-table-cell"],[1,"text-right",3,"title"],[1,"text-right"],[1,"d-flex","justify-content-center"],[1,"fa",3,"ngClass"],[1,"fas","fa-lightbulb",3,"ngClass"],[3,"value"]],template:function(t,e){1&t&&(Lr(0,LA,10,6,"div",0),Lr(1,GA,7,7,"ng-template",null,1,ja),Lr(3,jA,1,5,"ng-template",null,2,ja),Lr(5,NA,1,6,"ng-template",null,3,ja),Nr(7,"div",4),Nr(8,"div",5),Nr(9,"div",6),Nr(10,"div",7),Nr(11,"h5",8),mo(12),Ua(13,"translate"),Fr(),Nr(14,"button",9),Jr("click",(function(){return e.changeChart()})),Nr(15,"span",10),mo(16,"\xd7"),Fr(),Fr(),Fr(),Nr(17,"div",11),Nr(18,"form",12,13),Nr(20,"div",14),Nr(21,"label",15),mo(22),Ua(23,"translate"),Fr(),Nr(24,"select",16),Jr("ngModelChange",(function(t){return e.metricX=t})),Lr(25,FA,2,2,"option",17),Fr(),Fr(),Nr(26,"div",14),Nr(27,"label",18),mo(28),Ua(29,"translate"),Fr(),Nr(30,"select",19),Jr("ngModelChange",(function(t){return e.metricY=t})),Lr(31,BA,2,2,"option",17),Fr(),Fr(),Nr(32,"div",20),Nr(33,"button",21),Jr("click",(function(){return e.changeChart()})),mo(34),Ua(35,"translate"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr(),Fr()),2&t&&(jr("ngIf",e.visbokeymetrics),_n(12),fo(Oa(13,9,"compViewBubble.titleChange")),_n(10),vo("",Oa(23,11,"compViewBubble.lbl.xAxis"),":"),_n(2),jr("ngModel",e.metricX),_n(1),jr("ngForOf",e.metricListSorted),_n(3),vo("",Oa(29,13,"compViewBubble.lbl.yAxis"),":"),_n(2),jr("ngModel",e.metricY),_n(1),jr("ngForOf",e.metricListSorted),_n(3),fo(Oa(35,15,"compViewBubble.btn.change")))},directives:[jc,Eu,Fd,Tu,cu,Nd,Ou,Gc,EV,Ed,Bc,Uw,Ec,du,gu],pipes:[lv,zc,qc],encapsulation:2}),t})(),KA=(()=>{class t{constructor(t){this.gChartService=t}ngOnInit(){this.language||(this.language="de"),this.gLib=this.gChartService.getGoogle(),this.gLib.charts.load("current",{packages:["timeline"],language:this.language}),this.gLib.charts.setOnLoadCallback(this.drawChart.bind(this))}ngOnChanges(){this.initialised&&this.drawChart()}drawChart(){const t=new this.gLib.visualization.Timeline(document.getElementById("divTimelineChart")),e=new this.gLib.visualization.arrayToDataTable(this.graphData),i=this.parentThis;this.gLib.visualization.events.addListener(t,"select",(function(){const e=t.getSelection();if(e&&0!==e.length){const t=e[0];if(void 0===i)console.log("Chart Timeline: The user clicked and this is undefined");else if(t){const e=t.row;e>=0&&i.timelineSelectRow(e)}}else console.log("Chart Timeline: chartGetSelection is undefined",e||e.length)})),t.draw(e,this.graphOptions||{title:"Timeline Chart",height:400}),this.initialised=!0}}return t.\u0275fac=function(e){return new(e||t)(Rr(RV))},t.\u0275cmp=le({type:t,selectors:[["app-timeline-chart"]],inputs:{graphData:"graphData",language:"language",graphOptions:"graphOptions",parentThis:"parentThis"},features:[_e],decls:1,vars:0,consts:[["id","divTimelineChart"]],template:function(t,e){1&t&&Br(0,"div",0)},styles:["#divTimelineChart[_ngcontent-%COMP%]{width:100%}"]}),t})();function qA(t,e){if(1&t){const t=zr();Nr(0,"div",5),Nr(1,"div",6),Nr(2,"span"),mo(3),Ua(4,"translate"),Fr(),Nr(5,"span"),mo(6),Ua(7,"translate"),Fr(),Nr(8,"input",7),Jr("keyup",(function(e){return ei(t),Xr(2).filterKeyBoardEvent(e)}))("ngModelChange",(function(e){return ei(t),Xr(2).filter=e})),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(3),vo("",Oa(4,3,"compViewBoard.lbl.timeline"),", "),_n(3),vo(" ",Oa(7,5,"compViewBoard.lbl.filter"),":"),_n(2),jr("ngModel",t.filter)}}function zA(t,e){if(1&t&&(Nr(0,"div",3),Lr(1,qA,9,7,"div",4),Fr()),2&t){const t=Xr();_n(1),jr("ngIf",t.filter||!t.getPreView())}}function QA(t,e){if(1&t&&(Nr(0,"div",8),Br(1,"app-timeline-chart",9),Fr()),2&t){const t=Xr();_n(1),jr("graphData",t.graphDataTimeline)("graphOptions",t.graphOptionsTimeline)("parentThis",t.parentThis)("language",t.currentLang)}}function WA(t,e){1&t&&(Nr(0,"h5",8),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),vo(" ",Oa(2,1,"compViewBoard.msg.errorNoMatchingProjects")," "))}let JA=(()=>{class t{constructor(t,e,i,n,s){this.messageService=t,this.alertService=e,this.route=i,this.router=n,this.translate=s,this.parentThis=this,this.graphDataTimeline=[],this.graphOptionsTimeline={width:"100%",height:500,timeline:{showBarLabels:!0},tooltip:{isHtml:!0},animation:{startup:!0,duration:200}}}ngOnInit(){this.currentLang=this.translate.currentLang,this.log(`ProjectBoard Init  ${this.refDate.toISOString()} `),this.initSetting(),this.visboViewBoardOverTime()}ngOnChanges(t){var e;this.log(`ProjectBoard Changes  ${null===(e=this.refDate)||void 0===e?void 0:e.toISOString()}, Changes ${JSON.stringify(t)}`),this.initSetting(),this.visboViewBoardOverTime()}onResized(t){t||this.log("No event in Resize"),this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(()=>{this.visboViewBoardOverTime(),this.timeoutID=void 0},500)}initSetting(){this.activeID=this.route.snapshot.paramMap.get("id");const t=this.route.snapshot.queryParams.refDate,e=this.route.snapshot.queryParams.filter||void 0;this.refDate=t?new Date(t):new Date,this.filter=e}filterKeyBoardEvent(t){t||this.log("No Keyboard Event"),this.updateUrlParam("filter",this.filter),this.visboViewBoardOverTime()}updateUrlParam(t,e){const i=this.route.snapshot.url.join("/");void 0===e&&(e=null);const n=new DV;"filter"==t&&(n.filter=e,localStorage.setItem("vpfFilter",e||"")),this.router.navigate([i],{queryParams:n,replaceUrl:!0,queryParamsHandling:"merge"})}visboViewBoardOverTime(){var t,e,i,n;const s=[];if(!this.vps||0===this.vps.length)return void(this.graphDataTimeline=[]);this.vps.sort((function(t,e){return xh(e.name.toLowerCase(),t.name.toLowerCase())}));const r=this.filter?this.filter.toLowerCase():void 0;for(let c=0;c<this.vps.length;c++){if(r&&!(this.vps[c].name.toLowerCase().indexOf(r)>=0||(null===(t=this.vps[c].businessUnit)||void 0===t?void 0:t.toLowerCase().indexOf(r))>=0||(null===(e=this.vps[c].leadPerson)||void 0===e?void 0:e.toLowerCase().indexOf(r))>=0||(null===(i=this.vps[c].VorlagenName)||void 0===i?void 0:i.toLowerCase().indexOf(r))>=0||(null===(n=this.vps[c].status)||void 0===n?void 0:n.toLowerCase().indexOf(r))>=0))continue;const o=this.vps[c].startDate,a=this.vps[c].endDate;o&&a&&o<=a&&s.push([(this.vps.length-c).toString(),this.combineName(this.vps[c].name,this.vps[c].variantName),this.createCustomHTMLContent(this.vps[c]),new Date(this.vps[c].startDate),new Date(this.vps[c].endDate)])}this.graphOptionsTimeline.height=50+41*s.length;const o=this.translate.instant("compViewBoard.lbl.project"),a=this.translate.instant("compViewBoard.lbl.startDate"),l=this.translate.instant("compViewBoard.lbl.endDate");s.push(["ID",o,{type:"string",role:"tooltip",p:{html:!0}},a,l]),s.reverse(),this.graphDataTimeline=s}createCustomHTMLContent(t){const e=_h(new Date(t.startDate),"fullDate",this.currentLang),i=_h(new Date(t.endDate),"fullDate",this.currentLang);let n='<div style="padding:5px 5px 5px 5px;"><div><b>'+this.combineName(t.name,t.variantName)+"</b></div><div><table>";const s=this.translate.instant("compViewBoard.lbl.bu"),r=this.translate.instant("compViewBoard.lbl.lead"),o=this.translate.instant("compViewBoard.lbl.template"),a=this.translate.instant("compViewBoard.lbl.startDate"),l=this.translate.instant("compViewBoard.lbl.endDate");return t.businessUnit&&(n=n+"<tr><td>"+s+":</td><td><b>"+t.businessUnit+"</b></td></tr>"),t.leadPerson&&(n=n+"<tr><td>"+r+":</td><td><b>"+t.leadPerson+"</b></td></tr>"),t.VorlagenName&&(n=n+"<tr><td>"+o+":</td><td><b>"+t.VorlagenName+"</b></td></tr>"),n=n+"<tr><td>"+a+":</td><td><b>"+e+"</b></td></tr>",n=n+"<tr><td>"+l+":</td><td><b>"+i+"</b></td></tr>",n+="</table></div></div>",n}timelineSelectRow(t){this.log(`timeline Select Row ${t} ${JSON.stringify(this.graphDataTimeline[t+1])} `);const e=this.graphDataTimeline[t+1][1],i=this.findProject(e);if(i){this.log(`Navigate to: ${i.vpid} ${i.name} ${i.variantName}`);const t=new yb;t.variantName=i.variantName||null,this.refDate&&!Oh(this.refDate)&&(t.refDate=this.refDate.toISOString()),this.router.navigate(["vpKeyMetrics/".concat(i.vpid)],{queryParams:t})}else this.log("VP not found: "+e)}getvps(){return JSON.stringify(this.vps)}combineName(t,e){let i=t||"";return e&&(i=i.concat(" ( ",e," ) ")),i}findProject(t){let e=this.vps.find(e=>e.name===t);if(!e&&t.lastIndexOf(" ) ")===t.length-3){const i=t.lastIndexOf(" ( "),n=t.substring(0,i),s=t.substring(i+3,t.length-3);e=this.vps.find(t=>t.name===n&&t.variantName===s)}return e}getPreView(){return Rh()}log(t){this.messageService.add("CompVisboViewBoard: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(Mf),Rr(Bg),Rr(rf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-comp-viewboard"]],inputs:{vps:"vps"},features:[_e],decls:4,vars:3,consts:[[1,"well",3,"resized"],["class","container-fluid",4,"ngIf"],["class","mt-2",4,"ngIf"],[1,"container-fluid"],["class","row text-dark d-print-none",4,"ngIf"],[1,"row","text-dark","d-print-none"],[1,"my-1","pl-0","col-11"],["type","text","placeholder","Filter",1,"ml-2",3,"ngModel","keyup","ngModelChange"],[1,"mt-2"],[3,"graphData","graphOptions","parentThis","language"]],template:function(t,e){1&t&&(Nr(0,"div",0),Jr("resized",(function(t){return e.onResized(t)})),Lr(1,zA,2,1,"div",1),Lr(2,QA,2,4,"div",2),Lr(3,WA,3,3,"h5",2),Fr()),2&t&&(_n(1),jr("ngIf",e.graphDataTimeline.length>0),_n(1),jr("ngIf",e.graphDataTimeline.length>1),_n(1),jr("ngIf",1==e.graphDataTimeline.length))},directives:[EV,jc,Ed,Nd,Ou,KA],pipes:[lv],encapsulation:2}),t})();function YA(t,e){1&t&&(Nr(0,"h2",33),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),vo(" ",Oa(2,1,"vp.title")," "))}function ZA(t,e){if(1&t){const t=zr();Nr(0,"h2",33),mo(1),Ua(2,"translate"),Nr(3,"a",34),Jr("click",(function(){ei(t);const e=Xr(2);return e.gotoVCDetail(e.vcActive)})),mo(4),Fr(),Fr()}if(2&t){const t=Xr(2);_n(1),vo(" ",Oa(2,2,"vp.titleVC"),": "),_n(3),fo(t.vcActive.name)}}function XA(t,e){if(1&t){const t=zr();Nr(0,"i",37),Jr("click",(function(){return ei(t),Xr(3).toggleVisboChart()})),Fr()}}function tP(t,e){if(1&t){const t=zr();Nr(0,"i",38),Jr("click",(function(){return ei(t),Xr(3).toggleVisboChart()})),Fr()}}function eP(t,e){if(1&t&&(Nr(0,"div"),Lr(1,XA,1,0,"i",35),Lr(2,tP,1,0,"i",36),Fr()),2&t){const t=Xr(2);_n(1),jr("ngIf",!t.chart),_n(1),jr("ngIf",t.chart)}}function iP(t,e){if(1&t){const t=zr();Nr(0,"button",41),Jr("click",(function(){return ei(t),Xr(3).toggleVisboProjects()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vp.btn.showDeleted")))}function nP(t,e){if(1&t){const t=zr();Nr(0,"button",42),Jr("click",(function(){return ei(t),Xr(3).toggleVisboProjects()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vp.btn.showExisting")))}function sP(t,e){if(1&t&&(Nr(0,"div"),Lr(1,iP,3,3,"button",39),Lr(2,nP,3,3,"button",40),Fr()),2&t){const t=Xr(2);_n(1),jr("ngIf",!t.deleted),_n(1),jr("ngIf",t.deleted)}}function rP(t,e){1&t&&(Nr(0,"div"),Nr(1,"button",43),mo(2),Ua(3,"translate"),Fr(),Fr()),2&t&&(_n(2),fo(Oa(3,1,"vp.btn.create")))}function oP(t,e){if(1&t){const t=zr();Nr(0,"button",47),Jr("click",(function(){return ei(t),Xr(3).changeView("Capacity")})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vp.btn.viewCapacity")))}function aP(t,e){if(1&t){const t=zr();Nr(0,"div",44),Nr(1,"button",45),Jr("click",(function(){return ei(t),Xr(2).changeView("KeyMetric")})),mo(2),Ua(3,"translate"),Fr(),Nr(4,"button",45),Jr("click",(function(){return ei(t),Xr(2).changeView("List")})),mo(5),Ua(6,"translate"),Fr(),Lr(7,oP,3,3,"button",46),Nr(8,"button",45),Jr("click",(function(){return ei(t),Xr(2).changeView("ProjectBoard")})),mo(9),Ua(10,"translate"),Fr(),Fr()}if(2&t){const t=Xr(2);_n(2),fo(Oa(3,4,"vp.btn.viewKeyMetrics")),_n(3),fo(Oa(6,6,"vp.btn.viewList")),_n(2),jr("ngIf",t.hasVCPerm(t.permVC.ViewAudit+t.permVC.Modify)&&t.hasOrga),_n(2),fo(Oa(10,8,"vp.btn.viewProjectBoard"))}}function lP(t,e){if(1&t&&(Nr(0,"td",68),mo(1),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(t.vc.name)}}function cP(t,e){1&t&&Br(0,"td",68)}function dP(t,e){if(1&t){const t=zr();Nr(0,"tr",34),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(4).gotoClickedRow(i)})),Nr(1,"td",51),mo(2),Fr(),Nr(3,"td",60),Nr(4,"a"),mo(5),Fr(),Fr(),Nr(6,"td",61),mo(7),Fr(),Nr(8,"td",62),mo(9),Ua(10,"date"),Fr(),Nr(11,"td",63),mo(12),Ua(13,"date"),Fr(),Nr(14,"td",64),mo(15),Fr(),Lr(16,lP,2,1,"td",65),Lr(17,cP,1,0,"td",65),Nr(18,"td",66),Nr(19,"button",67),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(4).gotoDetail(i)})),mo(20,"i"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit,i=e.index,n=Xr(4);_n(2),fo(i+1),_n(3),fo(t.name),_n(2),fo(n.getVPType(t.vpType)),_n(2),fo(Ea(10,8,t.updatedAt,"dd.MM.yyyy HH:mm")),_n(3),fo(Ea(13,11,t.updatedAt,"dd.MM.yy")),_n(3),fo(t.vpfCount||t.vpvCount),_n(1),jr("ngIf",t.vc),_n(1),jr("ngIf",!t.vc)}}function uP(t,e){if(1&t&&(Nr(0,"tbody",58),Lr(1,dP,21,14,"tr",59),Fr()),2&t){const t=Xr(3);_n(1),jr("ngForOf",t.visboprojects)}}function hP(t,e){1&t&&(Nr(0,"div"),Nr(1,"h3",69),mo(2),Ua(3,"translate"),Fr(),Fr()),2&t&&(_n(2),vo(" ",Oa(3,1,"vp.msg.noVP")," "))}function pP(t,e){if(1&t){const t=zr();Nr(0,"div",48),Nr(1,"table",49),Nr(2,"thead",50),Nr(3,"tr"),Nr(4,"th",51),mo(5),Ua(6,"translate"),Fr(),Nr(7,"th",52),Jr("click",(function(){return ei(t),Xr(2).sortVPTable(1)})),mo(8),Ua(9,"translate"),Fr(),Nr(10,"th",53),Jr("click",(function(){return ei(t),Xr(2).sortVPTable(5)})),mo(11),Ua(12,"translate"),Fr(),Nr(13,"th",54),Jr("click",(function(){return ei(t),Xr(2).sortVPTable(2)})),mo(14),Ua(15,"translate"),Fr(),Nr(16,"th",55),Jr("click",(function(){return ei(t),Xr(2).sortVPTable(4)})),mo(17),Ua(18,"translate"),Fr(),Nr(19,"th",56),Jr("click",(function(){return ei(t),Xr(2).sortVPTable(3)})),mo(20),Ua(21,"translate"),Fr(),Nr(22,"th"),mo(23,"Info"),Fr(),Fr(),Fr(),Lr(24,uP,2,1,"tbody",57),Fr(),Lr(25,hP,4,3,"div",6),Fr()}if(2&t){const t=Xr(2);_n(5),fo(Oa(6,8,"vp.lbl.nr")),_n(3),fo(Oa(9,10,"vp.lbl.name")),_n(3),fo(Oa(12,12,"vp.lbl.type")),_n(3),fo(Oa(15,14,"vp.lbl.modified")),_n(3),fo(Oa(18,16,"vp.lbl.versions")),_n(3),fo(Oa(21,18,"vp.lbl.vc")),_n(4),jr("ngIf",t.visboprojects.length>0),_n(1),jr("ngIf",0==t.visboprojects.length)}}function gP(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-comp-viewcapacity",70),Fr()),2&t){const t=Xr(3);_n(1),jr("vcActive",t.vcActive)("combinedPerm",t.combinedPerm)}}function mP(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-comp-viewbubble",71),Fr()),2&t){const t=Xr(3);_n(1),jr("bubbleMode",!0)("visboprojectversions",t.visboprojectversions)("combinedPerm",t.combinedPerm)}}function fP(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-comp-viewbubble",71),Fr()),2&t){const t=Xr(3);_n(1),jr("bubbleMode",!1)("visboprojectversions",t.visboprojectversions)("combinedPerm",t.combinedPerm)}}function vP(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-comp-viewboard",72),Fr()),2&t){const t=Xr(3);_n(1),jr("vps",t.visboprojectversions)}}function bP(t,e){if(1&t&&(Nr(0,"div"),Br(1,"hr"),Lr(2,gP,2,2,"div",6),Lr(3,mP,2,3,"div",6),Lr(4,fP,2,3,"div",6),Lr(5,vP,2,1,"div",6),Fr()),2&t){const t=Xr(2);_n(2),jr("ngIf","Capacity"==t.currentView&&t.vcActive),_n(1),jr("ngIf","KeyMetrics"==t.currentView&&t.visboprojectversions&&t.vcActive),_n(1),jr("ngIf","List"==t.currentView&&t.visboprojectversions),_n(1),jr("ngIf","ProjectBoard"==t.currentView&&t.visboprojectversions)}}function yP(t,e){if(1&t){const t=zr();Nr(0,"div",19),Nr(1,"label",73),mo(2),Ua(3,"translate"),Fr(),Nr(4,"select",74),Jr("ngModelChange",(function(e){return ei(t),Xr(2).vpType=e})),Nr(5,"option",75),mo(6),Ua(7,"translate"),Fr(),Nr(8,"option",76),mo(9),Ua(10,"translate"),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(2),vo("",Oa(3,4,"vp.lbl.type"),":"),_n(2),jr("ngModel",t.vpType),_n(2),fo(Oa(7,6,"vp.type.vpType0")),_n(3),fo(Oa(10,8,"vp.type.vpType1"))}}function CP(t,e){if(1&t){const t=zr();Nr(0,"div",1),Nr(1,"div",2),Nr(2,"div",3),Lr(3,YA,3,3,"h2",4),Lr(4,ZA,5,4,"h2",4),Fr(),Nr(5,"div",5),Lr(6,eP,3,2,"div",6),Lr(7,sP,3,2,"div",6),Lr(8,rP,4,3,"div",6),Fr(),Br(9,"div",7),Lr(10,aP,11,10,"div",8),Fr(),Lr(11,pP,26,20,"div",9),Lr(12,bP,6,4,"div",6),Nr(13,"div",10),Nr(14,"div",11),Nr(15,"div",12),Nr(16,"div",13),Nr(17,"h5",14),mo(18),Ua(19,"translate"),Fr(),Nr(20,"button",15),Nr(21,"span",16),mo(22,"\xd7"),Fr(),Fr(),Fr(),Nr(23,"div",17),Nr(24,"form"),Lr(25,yP,11,10,"div",18),Nr(26,"div",19),Nr(27,"label",20),mo(28),Ua(29,"translate"),Fr(),Br(30,"input",21,22),Fr(),Nr(32,"div",19),Nr(33,"label",23),mo(34),Ua(35,"translate"),Fr(),Br(36,"textarea",24,25),Fr(),Fr(),Fr(),Nr(38,"div",26),Nr(39,"button",27),mo(40),Ua(41,"translate"),Fr(),Nr(42,"button",28),Jr("click",(function(){ei(t);const e=Gr(31),i=Gr(37),n=Xr();return n.addproject(e.value,n.vcActive._id,i.value,n.vpType),e.value="",i.value=""})),mo(43),Ua(44,"translate"),Fr(),Fr(),Fr(),Fr(),Fr(),Nr(45,"div",29),Nr(46,"div",11),Nr(47,"div",12),Nr(48,"div",13),Nr(49,"h5",30),mo(50),Ua(51,"translate"),Fr(),Nr(52,"button",15),Nr(53,"span",16),mo(54,"\xd7"),Fr(),Fr(),Fr(),Br(55,"div",17),Nr(56,"div",26),Nr(57,"button",31),mo(58),Ua(59,"translate"),Fr(),Nr(60,"button",32),mo(61),Ua(62,"translate"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr();_n(3),jr("ngIf",!t.vcActive),_n(1),jr("ngIf",t.vcActive),_n(2),jr("ngIf",t.vcActive&&t.visboprojects.length>0),_n(1),jr("ngIf",t.hasVPPerm(t.permVP.DeleteVP)),_n(1),jr("ngIf",t.vcActive&&t.hasVCPerm(t.permVC.CreateVP)),_n(2),jr("ngIf",t.chart),_n(1),jr("ngIf",!t.chart),_n(1),jr("ngIf",t.chart),_n(6),fo(Oa(19,17,"vp.titleCreate")),_n(7),jr("ngIf",t.hasVCPerm(t.permVC.Modify)),_n(3),vo("",Oa(29,19,"vp.lbl.name"),":"),_n(6),vo("",Oa(35,21,"vp.lbl.description"),":"),_n(6),fo(Oa(41,23,"vp.btn.cancel")),_n(3),vo(" ",Oa(44,25,"vp.btn.save")," "),_n(7),fo(Oa(51,27,"vp.titleCreateVPFList")),_n(8),fo(Oa(59,29,"vp.btn.cancel")),_n(3),vo(" ",Oa(62,31,"vp.btn.save")," ")}}let VP=(()=>{class t{constructor(t,e,i,n,s,r,o,a,l,c){this.messageService=t,this.alertService=e,this.visbocenterService=i,this.visbosettingService=n,this.visboprojectService=s,this.visboprojectversionService=r,this.route=o,this.router=a,this.translate=l,this.titleService=c,this.vpType=0,this.vpvRefDate=new Date,this.hasOrga=!1,this.chart=!1,this.modalChart=!0,this.deleted=!1,this.combinedPerm=void 0,this.permVC=Iv,this.permVP=Sv}ngOnInit(){this.currentLang=this.translate.currentLang,this.titleService.setTitle(this.translate.instant("vp.title")),this.log("Init GetVisboProjects "+JSON.stringify(this.route.snapshot.queryParams)),this.deleted=!!this.route.snapshot.queryParams.deleted;const t=this.route.snapshot.queryParams.view;t&&(this.chart=!0),this.currentView=t||"KeyMetrics",this.log(`Init VP View: ${this.currentView} Deleted: ${this.deleted}`),this.getVisboProjects(this.deleted)}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}hasVCPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vc&t)>0}getVPType(t){return this.translate.instant("vp.type.vpType"+t)}changeView(t,e){this.currentView="Capacity"===t||"KeyMetrics"===t||"ProjectBoard"===t||"List"===t?t:"KeyMetrics",this.updateUrlParam("view",this.currentView),e&&this.updateUrlParam("filter",e.trim())}toggleVisboChart(){this.chart=!this.chart,this.chart&&!this.visboprojectversions&&this.getVisboProjectKeyMetrics()}updateUrlParam(t,e){const i=this.route.snapshot.url.join("/");void 0===e&&(e=null);const n=new DV;"filter"==t?n.filter=e:"refDate"==t?n.refDate=e:"view"==t&&(n.view=e),this.router.navigate([i],{queryParams:n,replaceUrl:!0,queryParamsHandling:"merge"})}toggleVisboProjects(){this.chart=!1,this.deleted=!this.deleted;const t=this.route.snapshot.url.join("/");this.log(`VP toggleVisboProjects ${this.deleted} URL ${t}`),this.getVisboProjects(this.deleted),this.router.navigate([t],this.deleted?{queryParams:{deleted:this.deleted}}:{})}getVisboProjects(t){const e=this.route.snapshot.paramMap.get("id");this.vcSelected=e,e?this.visbocenterService.getVisboCenter(e).subscribe(i=>{this.vcActive=i,this.combinedPerm=i.perm,this.titleService.setTitle(this.translate.instant("vp.titleName",{name:this.vcActive.name})),this.getVisboCenterOrga(),this.visboprojectService.getVisboProjects(e,!1,t).subscribe(t=>{this.visboprojects=t,this.sortVPTable(1),this.chart&&this.getVisboProjectKeyMetrics()},t=>{this.log(`get VPs failed: error:  ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})},t=>{this.log(`get VC failed: error:  ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))}):(this.vcSelected=null,this.vcActive=null,this.visboprojectService.getVisboProjects(null,!1,t).subscribe(t=>{this.visboprojects=t,this.sortVPTable(1)},t=>{this.log(`get VPs all failed: error:  ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))}))}addproject(t,e,i,n){t=t.trim(),this.log(`call create VP ${t} with VCID ${e} Desc ${i} `),t&&(1!=n&&2!=n&&(n=0),this.visboprojectService.addVisboProject({name:t,description:i,vcid:e,vpType:n}).subscribe(t=>{this.visboprojects.push(t),this.sortVPTable(void 0);const e=this.translate.instant("vp.type.vpType".concat(n.toString())),i=this.translate.instant("vp.msg.createSuccess",{name:t.name,vpType:e});this.alertService.success(i,!0),this.gotoClickedRow(t)},e=>{if(this.log(`add VP failed: error: ${e.status} messages: ${e.error.message}`),403===e.status){const e=this.translate.instant("vp.msg.errorPerm",{name:t});this.alertService.error(e)}else if(409===e.status){const e=this.translate.instant("vp.msg.errorConflict",{name:t});this.alertService.error(e)}else this.alertService.error(Gh(e))}),this.vpType=0)}getVisboProjectKeyMetrics(){this.log(`get VC keyMetrics ${this.vcActive.name} ${this.vcActive._id}`),this.visboprojectversionService.getVisboCenterProjectVersions(this.vcActive._id,this.vpvRefDate).subscribe(t=>{this.visboprojectversions=t,this.calcVPVList(),this.log(`get VC Key metrics: Get ${t.length} Project Versions`),0===this.visboprojectversions.length&&(this.chart=!1)},t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vp.msg.errorPermVC");this.alertService.error(t)}else this.alertService.error(Gh(t))})}calcVPVList(){var t,e;if(null===(t=this.visboprojectversions)||void 0===t?void 0:t.length){this.vpvWithKM=0;for(let t=0;t<this.visboprojectversions.length;t++){const i=this.visboprojectversions[t];i.endDate=(null===(e=i.keyMetrics)||void 0===e?void 0:e.endDateCurrent)||i.endDate,this.vpvWithKM+=this.visboprojectversions[t].keyMetrics?1:0}}}getVisboCenterOrga(){this.vcActive&&(this.log("get VC Orga "+this.vcActive._id),this.visbosettingService.getVCOrganisations(this.vcActive._id,!1,void 0,!0).subscribe(t=>{this.hasOrga=t.length>0},t=>{if(403===t.status){const t=this.translate.instant("vp.msg.errorPermVC");this.alertService.error(t)}else this.alertService.error(Gh(t))}))}gotoClickedRow(t){const e=!!t.deletedAt;1===t.vpType?(this.log(`goto VPF for VP ${t._id} Deleted ${e}`),this.router.navigate(["vpf/".concat(t._id)],e?{queryParams:{deleted:e}}:{})):(this.log(`goto VPV for VP ${t._id} Deleted ${e}`),this.router.navigate(["vpKeyMetrics/".concat(t._id)],e?{queryParams:{deleted:e}}:{}))}gotoDetail(t){const e=!!t.deletedAt;this.log("goto Detail for VP "+t._id),this.router.navigate(["vpDetail/".concat(t._id)],e?{queryParams:{deleted:e}}:{})}gotoVCDetail(t){this.router.navigate(["vcDetail/".concat(t._id)])}sortVPTable(t){if(void 0!==t){if(!this.visboprojects)return;t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t||3===t:!this.sortAscending}1===this.sortColumn?this.visboprojects.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortColumn?this.visboprojects.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})):3===this.sortColumn?this.visboprojects.sort((function(t,e){return xh(t.vc.name.toLowerCase(),e.vc.name.toLowerCase())})):4===this.sortColumn?this.visboprojects.sort((function(t,e){return t.vpvCount-e.vpvCount})):5===this.sortColumn&&this.visboprojects.sort((function(t,e){return t.vpType-e.vpType})),this.sortAscending||this.visboprojects.reverse()}log(t){this.messageService.add("VisboProject: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(Mf),Rr(Ev),Rr(Eb),Rr(Vb),Rr(xV),Rr(Bg),Rr(rf),Rr(av),Rr(Md))},t.\u0275cmp=le({type:t,selectors:[["app-visboprojects"]],decls:2,vars:1,consts:[["class","well",4,"ngIf"],[1,"well"],[1,"row"],[1,"col"],["class","panel-heading ml-0",4,"ngIf"],[1,"btn-group"],[4,"ngIf"],[1,"container-fluid"],["class","btn-toolbar",4,"ngIf"],["class","panel-body",4,"ngIf"],["id","VpModalCreate","tabindex","-1","role","dialog","aria-labelledby","VpModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VpModalCenterTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["class","form-group",4,"ngIf"],[1,"form-group"],["for","vpName",1,"col-form-label"],["id","CreateVPName","type","text",1,"form-control"],["vpName",""],[1,"col-form-label"],["id","CreateVPDesc",1,"form-control"],["vpDescription",""],[1,"modal-footer","align-items-end"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-secondary"],["id","CreateVPConfirm","type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"],["id","VPFListCreate","tabindex","-1","role","dialog","aria-labelledby","VPFListCreateTitle","aria-hidden","true",1,"modal","fade"],["id","VPFListCenterTitle",1,"modal-title"],["id","ButtonVPFBack","type","button","data-dismiss","modal",1,"btn","btn-secondary"],["id","CreateVPFConfirm","type","button","data-dismiss","modal",1,"btn","btn-primary"],[1,"panel-heading","ml-0"],[3,"click"],["class","mt-3 fa fa-signal","aria-hidden","true",3,"click",4,"ngIf"],["class","mt-3 fa fa-list","aria-hidden","true",3,"click",4,"ngIf"],["aria-hidden","true",1,"mt-3","fa","fa-signal",3,"click"],["aria-hidden","true",1,"mt-3","fa","fa-list",3,"click"],["id","DeletedVP","type","button","class","m-2 btn btn-secondary",3,"click",4,"ngIf"],["id","UnDeletedVP","type","button","class","m-2 btn btn-secondary",3,"click",4,"ngIf"],["id","DeletedVP","type","button",1,"m-2","btn","btn-secondary",3,"click"],["id","UnDeletedVP","type","button",1,"m-2","btn","btn-secondary",3,"click"],["id","CreateVP","type","button","data-toggle","modal","data-target","#VpModalCreate",1,"m-2","btn","btn-primary"],[1,"btn-toolbar"],["type","button",1,"ml-2","btn","btn-md","btn-light",3,"click"],["type","button","class","btn btn-md btn-light ml-2",3,"click",4,"ngIf"],["type","button",1,"btn","btn-md","btn-light","ml-2",3,"click"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],["id","VPHead"],[1,"d-none","d-md-table-cell"],["id","SortName",3,"click"],["id","SortType",1,"d-none","d-md-table-cell",3,"click"],["id","SortDate",1,"d-none","d-md-table-cell",3,"click"],["id","SortVersions",1,"d-none","d-md-table-cell",3,"click"],["id","SortVC",1,"d-none","d-lg-table-cell",3,"click"],["id","VPList",4,"ngIf"],["id","VPList"],[3,"click",4,"ngFor","ngForOf"],["id","ColName"],["id","ColType",1,"d-none","d-md-table-cell"],["id","ColDate",1,"d-none","d-lg-table-cell"],["id","ColDate",1,"d-none","d-md-table-cell","d-lg-none"],["id","ColVersions",1,"d-none","d-md-table-cell"],["id","ColVC","class","d-none d-lg-table-cell",4,"ngIf"],["id","ColDetail"],["title","Detail of Visbo Project",1,"Detail",3,"click"],["id","ColVC",1,"d-none","d-lg-table-cell"],[1,"d-flex","justify-content-center"],[3,"vcActive","combinedPerm"],[3,"bubbleMode","visboprojectversions","combinedPerm"],[3,"vps"],["for","type",1,"col-form-label"],["id","vpType","name","vpType",1,"form-control",3,"ngModel","ngModelChange"],["value","0"],["value","1"]],template:function(t,e){1&t&&(Br(0,"app-usernavbar"),Lr(1,CP,63,33,"div",0)),2&t&&(_n(1),jr("ngIf",e.visboprojects))},directives:[Pb,jc,Eu,Fd,Tu,Gc,_w,HA,JA,cu,Nd,Ou,du,gu],pipes:[lv,qc],encapsulation:2}),t})();function wP(t,e){if(1&t){const t=zr();Nr(0,"a",1),Jr("click",(function(){ei(t);const e=Xr(2);return e.gotoVCDetail(e.visboproject)})),mo(1),Fr()}if(2&t){const t=Xr(2);_n(1),fo(t.visboproject.vc.name)}}function AP(t,e){if(1&t&&(Nr(0,"span"),mo(1),Fr()),2&t){const t=Xr(2);_n(1),fo(t.visboproject.vc.name)}}function PP(t,e){if(1&t){const t=zr();Nr(0,"input",73),Jr("ngModelChange",(function(e){return ei(t),Xr(2).visboproject.name=e})),Fr()}2&t&&jr("ngModel",Xr(2).visboproject.name)}function kP(t,e){if(1&t&&(Nr(0,"label",74),mo(1),Fr()),2&t){const t=Xr(2);_n(1),vo("",t.visboproject.name," ")}}function DP(t,e){if(1&t){const t=zr();Nr(0,"textarea",78),Jr("ngModelChange",(function(e){return ei(t),Xr(3).visboproject.description=e})),Fr()}2&t&&jr("ngModel",Xr(3).visboproject.description)}function MP(t,e){if(1&t&&(Nr(0,"label",79),mo(1),Fr()),2&t){const t=Xr(3);_n(1),vo("",t.visboproject.description," ")}}function IP(t,e){if(1&t&&(Nr(0,"div",3),Nr(1,"label",75),mo(2),Ua(3,"translate"),Fr(),Lr(4,DP,1,1,"textarea",76),Lr(5,MP,2,1,"label",77),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,3,"vpDetail.lbl.description"),":"),_n(2),jr("ngIf",t.hasVPPerm(t.permVP.Modify)),_n(1),jr("ngIf",!t.hasVPPerm(t.permVP.Modify))}}function SP(t,e){if(1&t){const t=zr();Nr(0,"div",3),Nr(1,"label",80),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",81),Nr(5,"a",1),Jr("click",(function(){ei(t);const e=Xr(2);return e.gotoVPView(e.visboproject)})),mo(6),Ua(7,"translate"),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(2),vo("",Oa(3,4,"vpDetail.lbl.versions"),":"),_n(4),yo("",t.visboproject.vpvCount," ",Oa(7,6,"vpDetail.lbl.ofTotal")," ",t.getVPVersionsTotal(),"")}}function xP(t,e){if(1&t){const t=zr();Nr(0,"button",90),Jr("click",(function(){ei(t);const e=Xr(3);return e.gotoVPAudit(e.visboproject)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpDetail.btn.viewAudit")))}function TP(t,e){if(1&t){const t=zr();Nr(0,"button",91),Jr("click",(function(){return ei(t),Xr(3).toggleView("Group")})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpDetail.btn.viewGroups")))}function _P(t,e){if(1&t){const t=zr();Nr(0,"button",92),Jr("click",(function(){return ei(t),Xr(3).toggleView("User")})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpDetail.btn.viewUsers")))}function UP(t,e){if(1&t){const t=zr();Nr(0,"button",93),Jr("click",(function(){ei(t);const e=Xr(3);return e.gotoVPRestriction(e.visboproject)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpDetail.btn.viewRestriction")))}function OP(t,e){if(1&t){const t=zr();Nr(0,"button",94),Jr("click",(function(){return ei(t),Xr(3).toggleView("Variant")})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpDetail.btn.viewVariant")))}function EP(t,e){if(1&t){const t=zr();Nr(0,"button",95),Jr("click",(function(){return ei(t),Xr(3).toggleView("Lock")})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpDetail.btn.viewLock")))}function LP(t,e){1&t&&(Nr(0,"div",97),Nr(1,"button",105),mo(2),Ua(3,"translate"),Fr(),Fr()),2&t&&(_n(2),vo(" ",Oa(3,1,"vpDetail.btn.addUser")," "))}function GP(t,e){1&t&&(Nr(0,"th"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.lbl.delete")))}function RP(t,e){if(1&t){const t=zr();Nr(0,"td"),Nr(1,"button",108),Jr("click",(function(){ei(t);const e=Xr().index;return Xr(4).helperRemoveUser(e)})),Ua(2,"translate"),mo(3,"\xd7"),Fr(),Fr()}2&t&&(_n(1),to("title",Oa(2,1,"vpDetail.lbl.deleteUser")))}function jP(t,e){1&t&&Br(0,"td")}function $P(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td"),mo(2),Fr(),Nr(3,"td",106),Jr("click",(function(){ei(t);const i=e.index;return Xr(4).calcCombinedPerm(i)})),Nr(4,"a"),mo(5),Fr(),Fr(),Nr(6,"td",107),Jr("click",(function(){return ei(t),Xr(4).toggleView("Group")})),Nr(7,"a"),mo(8),Fr(),Fr(),Nr(9,"td",103),mo(10),Fr(),Lr(11,RP,4,3,"td",0),Lr(12,jP,1,0,"td",0),Fr()}if(2&t){const t=e.$implicit,i=e.index,n=Xr(4);_n(2),fo(i+1),_n(3),fo(t.email),_n(3),fo(t.groupName),_n(2),fo("VP"==t.groupType?"":"Global"),_n(1),jr("ngIf",!n.deleted&&n.hasVPPerm(n.permVP.ManagePerm)&&"VP"==t.groupType),_n(1),jr("ngIf",!(!n.deleted&&n.hasVPPerm(n.permVP.ManagePerm)&&"VP"==t.groupType))}}function NP(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div"),Nr(2,"div",96),Nr(3,"div",97),Nr(4,"h5",98),mo(5),Ua(6,"translate"),Fr(),Fr(),Lr(7,LP,4,3,"div",99),Fr(),Nr(8,"div",100),Nr(9,"table",101),Nr(10,"thead",102),Nr(11,"tr"),Nr(12,"th"),mo(13),Ua(14,"translate"),Fr(),Nr(15,"th",1),Jr("click",(function(){return ei(t),Xr(3).sortUserTable(1)})),mo(16),Ua(17,"translate"),Fr(),Nr(18,"th",1),Jr("click",(function(){return ei(t),Xr(3).sortUserTable(2)})),mo(19),Ua(20,"translate"),Fr(),Nr(21,"th",103),mo(22),Ua(23,"translate"),Fr(),Lr(24,GP,3,3,"th",0),Fr(),Fr(),Nr(25,"tbody",104),Lr(26,$P,13,6,"tr",37),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(3);_n(5),vo(" ",Oa(6,8,"vpDetail.titleUsers")," "),_n(2),jr("ngIf",t.hasVPPerm(t.permVP.ManagePerm)),_n(6),fo(Oa(14,10,"vpDetail.lbl.nr")),_n(3),fo(Oa(17,12,"vpDetail.lbl.email")),_n(3),fo(Oa(20,14,"vpDetail.lbl.group")),_n(3),fo(Oa(23,16,"vpDetail.lbl.type")),_n(2),jr("ngIf",!t.deleted&&t.hasVPPerm(t.permVP.ManagePerm)),_n(2),jr("ngForOf",t.vgUsers)}}function FP(t,e){if(1&t){const t=zr();Nr(0,"div",97),Nr(1,"button",111),Jr("click",(function(){return ei(t),Xr(4).initGroup(null)})),mo(2),Ua(3,"translate"),Fr(),Fr()}2&t&&(_n(2),vo(" ",Oa(3,1,"vpDetail.btn.addGroup")," "))}function BP(t,e){1&t&&(Nr(0,"th"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.lbl.delete")))}function HP(t,e){1&t&&(Nr(0,"td",116),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.lbl.global")))}function KP(t,e){1&t&&Br(0,"td",116)}function qP(t,e){if(1&t){const t=zr();Nr(0,"td"),Nr(1,"button",117),Jr("click",(function(){ei(t);const e=Xr().index;return Xr(4).helperRemoveGroup(e)})),Ua(2,"translate"),mo(3,"\xd7"),Fr(),Fr()}2&t&&(_n(1),to("title",Oa(2,1,"vpDetail.msg.removeGroup")))}function zP(t,e){1&t&&Br(0,"td")}function QP(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td"),mo(2),Fr(),Nr(3,"td",112),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(4).initGroup(i)})),Nr(4,"a"),mo(5),Fr(),Fr(),Nr(6,"td",113),Jr("click",(function(){return ei(t),Xr(4).toggleView("User")})),Nr(7,"a"),mo(8),Fr(),Fr(),Lr(9,HP,3,3,"td",114),Lr(10,KP,1,0,"td",114),Lr(11,qP,4,3,"td",0),Lr(12,zP,1,0,"td",0),Nr(13,"td"),Nr(14,"button",115),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(4).initGroup(i)})),Ua(15,"translate"),mo(16,"i"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit,i=e.index,n=Xr(4);_n(2),fo(i+1),_n(3),fo(t.name),_n(3),fo(t.users.length),_n(1),jr("ngIf",t.global),_n(1),jr("ngIf",!t.global),_n(1),jr("ngIf",!n.deleted&&n.hasVPPerm(n.permVP.ManagePerm)&&"VP"==t.groupType),_n(1),jr("ngIf",!(!n.deleted&&n.hasVPPerm(n.permVP.ManagePerm)&&"VP"==t.groupType)),_n(2),to("title",Oa(15,8,"vpDetail.msg.detailGroup"))}}function WP(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div"),Nr(2,"div",96),Nr(3,"div",97),Nr(4,"h5",98),mo(5),Ua(6,"translate"),Fr(),Fr(),Lr(7,FP,4,3,"div",99),Fr(),Nr(8,"div",100),Nr(9,"table",101),Nr(10,"thead",109),Nr(11,"tr"),Nr(12,"th"),mo(13),Ua(14,"translate"),Fr(),Nr(15,"th",1),Jr("click",(function(){return ei(t),Xr(3).sortGroupTable(1)})),mo(16),Ua(17,"translate"),Fr(),Nr(18,"th",1),Jr("click",(function(){return ei(t),Xr(3).sortGroupTable(2)})),mo(19),Ua(20,"translate"),Fr(),Nr(21,"th",103),mo(22),Ua(23,"translate"),Fr(),Lr(24,BP,3,3,"th",0),Nr(25,"th"),mo(26),Ua(27,"translate"),Fr(),Fr(),Fr(),Nr(28,"tbody",110),Lr(29,QP,17,10,"tr",37),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(3);_n(5),vo(" ",Oa(6,9,"vpDetail.titleGroups")," "),_n(2),jr("ngIf",t.hasVPPerm(t.permVP.ManagePerm)),_n(6),fo(Oa(14,11,"vpDetail.lbl.nr")),_n(3),fo(Oa(17,13,"vpDetail.lbl.group")),_n(3),fo(Oa(20,15,"vpDetail.lbl.members")),_n(3),fo(Oa(23,17,"vpDetail.lbl.type")),_n(2),jr("ngIf",!t.deleted&&t.hasVPPerm(t.permVP.ManagePerm)),_n(2),fo(Oa(27,19,"vpDetail.lbl.info")),_n(3),jr("ngForOf",t.vgGroups)}}function JP(t,e){1&t&&(Nr(0,"div",97),Nr(1,"button",121),mo(2),Ua(3,"translate"),Fr(),Fr()),2&t&&(_n(2),vo(" ",Oa(3,1,"vpDetail.btn.addVariant")," "))}function YP(t,e){1&t&&(Nr(0,"th"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.lbl.delete")))}function ZP(t,e){1&t&&qr(0)}function XP(t,e){if(1&t){const t=zr();Nr(0,"button",127),Jr("click",(function(){ei(t);const e=Xr().index;return Xr(4).helperRemoveVariant(e)})),Ua(1,"translate"),mo(2,"\xd7 "),Fr()}2&t&&to("title",Oa(1,1,"vpDetail.lbl.deleteVariant"))}function tk(t,e){if(1&t){const t=zr();Nr(0,"button",127),Jr("click",(function(){ei(t);const e=Xr().index;return Xr(4).helperRemoveVariant(e)})),Ua(1,"translate"),mo(2,"\xd7 "),Fr()}2&t&&to("title",Oa(1,1,"vpDetail.lbl.deleteVariant"))}const ek=function(t){return{level:t}};function ik(t,e){if(1&t&&(Nr(0,"tr"),Nr(1,"td"),mo(2),Fr(),Nr(3,"td",122),mo(4),Fr(),Nr(5,"td",123),mo(6),Fr(),Nr(7,"td",124),Ua(8,"date"),mo(9),Ua(10,"date"),Fr(),Nr(11,"td",103),mo(12),Fr(),Nr(13,"td",103),Lr(14,ZP,1,0,"ng-container",125),Fr(),Nr(15,"td"),Lr(16,XP,3,3,"button",126),Lr(17,tk,3,3,"button",126),Fr(),Fr()),2&t){const t=e.$implicit,i=e.index;Xr(2);const n=Gr(12),s=Xr(2);_n(2),fo(i+1),_n(2),fo(t.variantName),_n(2),fo(t.email),_n(1),to("title",Ea(8,10,t.createdAt,"dd.MM.yyyy HH:mm:ss")),_n(2),fo(Ea(10,13,t.createdAt,"dd.MM.yy")),_n(3),fo(t.vpvCount),_n(2),jr("ngTemplateOutlet",n)("ngTemplateOutletContext",ka(16,ek,s.getLockStatus(i))),_n(2),jr("ngIf",!t.vpvCount&&s.hasVPPerm(s.permVP.Modify)&&s.getLockStatus(i)<=1),_n(1),jr("ngIf",!t.vpvCount&&!s.hasVPPerm(s.permVP.Modify)&&s.hasVPPerm(s.permVP.CreateVariant)&&s.getLockStatus(i)<=1&&t.email==s.currentUser.email)}}function nk(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div"),Nr(2,"div",96),Nr(3,"div",97),Nr(4,"h5",98),mo(5),Ua(6,"translate"),Fr(),Fr(),Lr(7,JP,4,3,"div",99),Fr(),Nr(8,"div",100),Nr(9,"table",101),Nr(10,"thead",118),Nr(11,"tr"),Nr(12,"th"),mo(13),Ua(14,"translate"),Fr(),Nr(15,"th",1),Jr("click",(function(){return ei(t),Xr(3).sortVariantTable(1)})),mo(16),Ua(17,"translate"),Fr(),Nr(18,"th",1),Jr("click",(function(){return ei(t),Xr(3).sortVariantTable(2)})),mo(19),Ua(20,"translate"),Fr(),Nr(21,"th",119),Jr("click",(function(){return ei(t),Xr(3).sortVariantTable(3)})),mo(22),Ua(23,"translate"),Fr(),Nr(24,"th",119),Jr("click",(function(){return ei(t),Xr(3).sortVariantTable(4)})),mo(25),Ua(26,"translate"),Fr(),Nr(27,"th",103),mo(28),Ua(29,"translate"),Fr(),Lr(30,YP,3,3,"th",0),Fr(),Fr(),Nr(31,"tbody",120),Lr(32,ik,18,18,"tr",37),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(3);_n(5),vo(" ",Oa(6,10,"vpDetail.titleVariants")," "),_n(2),jr("ngIf",t.hasVPPerm(t.permVP.Modify+t.permVP.CreateVariant)),_n(6),fo(Oa(14,12,"vpDetail.lbl.nr")),_n(3),fo(Oa(17,14,"vpDetail.lbl.variant")),_n(3),fo(Oa(20,16,"vpDetail.lbl.email")),_n(3),fo(Oa(23,18,"vpDetail.lbl.createdAt")),_n(3),fo(Oa(26,20,"vpDetail.lbl.versions")),_n(3),fo(Oa(29,22,"vpDetail.lbl.lock")),_n(2),jr("ngIf",t.hasVPPerm(t.permVP.Modify+t.permVP.CreateVariant)),_n(2),jr("ngForOf",t.visboproject.variant)}}const sk=function(t,e){return{"fa-check-circle text-success":t,"fa-ban text-danger":e}};function rk(t,e){if(1&t&&Br(0,"i",128),2&t){const t=e.level;jr("ngClass",Da(1,sk,1==t,2==t))}}function ok(t,e){if(1&t){const t=zr();Nr(0,"td"),Nr(1,"button",131),Jr("click",(function(){ei(t);const e=Xr().index;return Xr(4).unlockVP(e)})),Ua(2,"translate"),mo(3,"\xd7"),Fr(),Fr()}2&t&&(_n(1),to("title",Oa(2,1,"vpDetail.lbl.unlock")))}function ak(t,e){if(1&t&&(Nr(0,"tr"),Nr(1,"td"),mo(2),Fr(),Nr(3,"td"),mo(4),Ua(5,"date"),Fr(),Nr(6,"td"),mo(7),Fr(),Lr(8,ok,4,3,"td",0),Fr()),2&t){const t=e.index,i=Xr(4);_n(2),fo(i.visboproject.lock[t].email),_n(2),fo(Ea(5,4,i.visboproject.lock[t].expiresAt,"dd.MM HH:mm")),_n(3),fo(i.visboproject.lock[t].variantName),_n(1),jr("ngIf",!i.deleted&&i.hasVPPerm(i.permVP.Modify))}}function lk(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"div",129),Nr(2,"div",97),Nr(3,"h5",130),mo(4),Ua(5,"translate"),Fr(),Fr(),Fr(),Nr(6,"div",100),Nr(7,"table",101),Nr(8,"thead"),Nr(9,"tr"),Nr(10,"th"),mo(11),Ua(12,"translate"),Fr(),Nr(13,"th"),mo(14),Ua(15,"translate"),Fr(),Nr(16,"th"),mo(17),Ua(18,"translate"),Fr(),Nr(19,"th"),mo(20),Ua(21,"translate"),Fr(),Fr(),Fr(),Nr(22,"tbody"),Lr(23,ak,9,7,"tr",37),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr(3);_n(4),vo(" ",Oa(5,6,"vpDetail.titleProjectLocks")," "),_n(7),fo(Oa(12,8,"vpDetail.lbl.email")),_n(3),fo(Oa(15,10,"vpDetail.lbl.expires")),_n(3),fo(Oa(18,12,"vpDetail.lbl.variant")),_n(3),fo(Oa(21,14,"vpDetail.lbl.delete")),_n(3),jr("ngForOf",t.visboproject.lock)}}function ck(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"div",82),Lr(2,xP,3,3,"button",83),Lr(3,TP,3,3,"button",84),Lr(4,_P,3,3,"button",85),Lr(5,UP,3,3,"button",86),Lr(6,OP,3,3,"button",87),Lr(7,EP,3,3,"button",88),Fr(),Lr(8,NP,27,18,"div",0),Lr(9,WP,30,21,"div",0),Lr(10,nk,33,24,"div",0),Lr(11,rk,1,4,"ng-template",null,89,ja),Lr(13,lk,24,16,"div",0),Fr()),2&t){const t=Xr(2);_n(2),jr("ngIf",t.hasVPPerm(t.permVP.ViewAudit)),_n(1),jr("ngIf","Group"!=t.actView),_n(1),jr("ngIf","User"!=t.actView),_n(1),jr("ngIf",t.viewRestriction()),_n(1),jr("ngIf","Variant"!=t.actView&&t.hasVPPerm(t.permVP.Modify+t.permVP.CreateVariant)),_n(1),jr("ngIf","Lock"!=t.actView&&t.hasVPPerm(t.permVP.Modify)&&t.visboproject.lock.length&&t.hasVPPerm(t.permVP.Modify+t.permVP.CreateVariant)),_n(1),jr("ngIf","User"==t.actView),_n(1),jr("ngIf","Group"==t.actView),_n(1),jr("ngIf","Variant"==t.actView),_n(3),jr("ngIf","Lock"==t.actView)}}function dk(t,e){if(1&t){const t=zr();Nr(0,"button",132),Jr("click",(function(){return ei(t),Xr(2).save()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpDetail.btn.save")))}function uk(t,e){if(1&t){const t=zr();Nr(0,"button",133),Jr("click",(function(){return ei(t),Xr(2).save()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpDetail.btn.restore")))}function hk(t,e){1&t&&(Nr(0,"button",134),Ua(1,"translate"),mo(2),Ua(3,"translate"),Fr()),2&t&&(to("title",Oa(1,2,"vpDetail.titleDeleteProject")),_n(2),fo(Oa(3,4,"vpDetail.btn.delete")))}function pk(t,e){1&t&&(Nr(0,"button",135),Ua(1,"translate"),mo(2),Ua(3,"translate"),Fr()),2&t&&(to("title",Oa(1,2,"vpDetail.titleDeleteProject")),_n(2),fo(Oa(3,4,"vpDetail.btn.destroy")))}function gk(t,e){1&t&&(Nr(0,"div",136),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.msg.emailRequired")))}function mk(t,e){if(1&t&&(Nr(0,"option"),mo(1),Fr()),2&t){const t=e.$implicit;_n(1),fo(t.name)}}function fk(t,e){1&t&&(Nr(0,"div",136),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.msg.groupRequired")))}function vk(t,e){1&t&&(Nr(0,"div",136),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.msg.invalidMessage")))}function bk(t,e){1&t&&(Nr(0,"button",137),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.btn.invite")))}function yk(t,e){if(1&t){const t=zr();Nr(0,"button",138),Jr("click",(function(){return ei(t),Xr(2).addNewVPUser()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpDetail.btn.invite")))}function Ck(t,e){if(1&t){const t=zr();Nr(0,"div",20),Nr(1,"div",21),Nr(2,"div",22),Nr(3,"h5",139),mo(4),Ua(5,"translate"),Fr(),Nr(6,"button",24),Nr(7,"span",25),mo(8,"\xd7"),Fr(),Fr(),Fr(),Nr(9,"div",26),Nr(10,"div"),Nr(11,"label",140),mo(12),Ua(13,"translate"),Fr(),Fr(),Nr(14,"form"),Nr(15,"div",54),Nr(16,"label",141),mo(17),Ua(18,"translate"),Fr(),Nr(19,"label",56),mo(20),Fr(),Fr(),Nr(21,"div",54),Nr(22,"label",141),mo(23),Ua(24,"translate"),Fr(),Nr(25,"label",56),mo(26),Fr(),Fr(),Nr(27,"div",54),Nr(28,"label",141),mo(29),Ua(30,"translate"),Fr(),Nr(31,"label",56),mo(32),Fr(),Fr(),Fr(),Fr(),Nr(33,"div",41),Nr(34,"button",59),mo(35),Ua(36,"translate"),Fr(),Nr(37,"button",142),Jr("click",(function(){ei(t);const e=Xr(2);return e.removeVPUser(e.vgUsers[e.userIndex],e.visboproject._id)})),mo(38),Ua(39,"translate"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(4),fo(Oa(5,10,"vpDetail.titleRemoveUser")),_n(8),fo(Oa(13,12,"vpDetail.msg.removeUserConfirm")),_n(5),vo("",Oa(18,14,"vpDetail.lbl.vp"),":"),_n(3),vo("",t.visboproject.name," "),_n(3),vo("",Oa(24,16,"vpDetail.lbl.user"),":"),_n(3),fo(t.vgUsers[t.userIndex].email),_n(3),vo("",Oa(30,18,"vpDetail.lbl.group"),":"),_n(3),fo(t.vgUsers[t.userIndex].groupName),_n(3),fo(Oa(36,20,"vpDetail.btn.back")),_n(3),fo(Oa(39,22,"vpDetail.btn.delete"))}}function Vk(t,e){1&t&&(Nr(0,"h5",172),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.titleModifyGroup")))}function wk(t,e){1&t&&(Nr(0,"h5",172),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.titleViewGroup")))}function Ak(t,e){1&t&&(Nr(0,"h5",172),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.titleAddGroup")))}function Pk(t,e){if(1&t&&(Nr(0,"div",54),Nr(1,"label",173),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",141),mo(5),Fr(),Fr()),2&t){const t=Xr(3);_n(2),vo("",Oa(3,2,"vpDetail.lbl.name"),":"),_n(3),fo(t.actGroup.name)}}function kk(t,e){1&t&&(Nr(0,"div",136),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.msg.groupNameRequired")))}const Dk=function(t){return{"has-error":t}};function Mk(t,e){if(1&t){const t=zr();Nr(0,"div",29),Nr(1,"label",174),mo(2),Ua(3,"translate"),Fr(),Nr(4,"input",175,176),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.name=e})),Fr(),Lr(6,kk,3,3,"div",33),Fr()}if(2&t){const t=Gr(5);Xr();const e=Gr(10),i=Xr(2);jr("ngClass",ka(6,Dk,e.submitted&&!t.valid)),_n(2),vo("",Oa(3,4,"vpDetail.lbl.name"),":"),_n(2),jr("ngModel",i.actGroup.name),_n(2),jr("ngIf",e.submitted&&!i.actGroup.name.trim())}}function Ik(t,e){if(1&t){const t=zr();Nr(0,"div",181),Nr(1,"a",182),Jr("click",(function(){ei(t);const e=Xr().$implicit;return Xr(4).activateUser(e)})),mo(2),Fr(),Fr()}if(2&t){const t=Xr().$implicit;_n(2),fo(t.email)}}function Sk(t,e){if(1&t&&(Hr(0,96),Lr(1,Ik,3,1,"div",180),Kr()),2&t){const t=e.$implicit,i=Xr(4);_n(1),jr("ngIf",t.groupId==i.actGroup._id)}}function xk(t,e){if(1&t&&(Nr(0,"div",177),Nr(1,"label",178),mo(2),Ua(3,"translate"),Fr(),Lr(4,Sk,2,1,"ng-container",179),Fr()),2&t){const t=Xr(3);_n(2),fo(Oa(3,2,"perm.lblGroupMembers")),_n(2),jr("ngForOf",t.vgUsers)}}function Tk(t,e){1&t&&(Nr(0,"div",177),Nr(1,"label",178),mo(2),Ua(3,"translate"),Fr(),Fr()),2&t&&(_n(2),fo(Oa(3,1,"perm.lblNoGroupMembers")))}function _k(t,e){if(1&t&&(Nr(0,"button",185),mo(1),Fr()),2&t){const t=Xr(4);_n(1),fo(t.confirm)}}function Uk(t,e){if(1&t){const t=zr();Nr(0,"button",186),Jr("click",(function(){return ei(t),Xr(4).addModifyVPGroup()})),mo(1),Fr()}if(2&t){const t=Xr(4);_n(1),fo(t.confirm)}}function Ok(t,e){if(1&t&&(Nr(0,"div"),Lr(1,_k,2,1,"button",183),Lr(2,Uk,2,1,"button",184),Fr()),2&t){Xr();const t=Gr(10);_n(1),jr("ngIf",!t.form.valid),_n(1),jr("ngIf",t.form.valid)}}function Ek(t,e){if(1&t){const t=zr();Nr(0,"div",21),Nr(1,"div",22),Lr(2,Vk,3,3,"h5",143),Lr(3,wk,3,3,"h5",143),Lr(4,Ak,3,3,"h5",143),Nr(5,"button",24),Nr(6,"span",25),mo(7,"\xd7"),Fr(),Fr(),Fr(),Nr(8,"div",26),Nr(9,"form",144,145),Lr(11,Pk,6,4,"div",146),Lr(12,Mk,7,8,"div",147),Nr(13,"div"),mo(14),Ua(15,"translate"),Fr(),Nr(16,"div",148),Nr(17,"input",149,150),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedVPViewRestricted=e})),Fr(),Nr(19,"label",151),mo(20),Ua(21,"translate"),Fr(),Fr(),Nr(22,"div",148),Nr(23,"input",152,153),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedVPView=e})),Fr(),Nr(25,"label",154),mo(26),Ua(27,"translate"),Fr(),Fr(),Nr(28,"div",148),Nr(29,"input",155,156),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedVPViewAudit=e})),Fr(),Nr(31,"label",157),mo(32),Ua(33,"translate"),Fr(),Fr(),Nr(34,"div",148),Nr(35,"input",158,159),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedVPModify=e})),Fr(),Nr(37,"label",160),mo(38),Ua(39,"translate"),Fr(),Fr(),Nr(40,"div",148),Nr(41,"input",161,162),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedCreateVariant=e})),Fr(),Nr(43,"label",163),mo(44),Ua(45,"translate"),Fr(),Fr(),Nr(46,"div",148),Nr(47,"input",164,165),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedVPManagePerm=e})),Fr(),Nr(49,"label",166),mo(50),Ua(51,"translate"),Fr(),Fr(),Nr(52,"div",148),Nr(53,"input",167,168),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedVPDelete=e})),Fr(),Nr(55,"label",169),mo(56),Ua(57,"translate"),Fr(),Fr(),Lr(58,xk,5,4,"div",170),Lr(59,Tk,4,3,"div",170),Nr(60,"div",41),Nr(61,"button",171),mo(62),Ua(63,"translate"),Fr(),Lr(64,Ok,3,2,"div",0),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(2),jr("ngIf","Modify"==t.confirm),_n(1),jr("ngIf","View"==t.confirm),_n(1),jr("ngIf",!t.actGroup._id),_n(7),jr("ngIf",t.actGroup.internal),_n(1),jr("ngIf",!t.actGroup.internal),_n(2),fo(Oa(15,24,"perm.titleVPPerm")),_n(3),jr("ngModel",t.actGroup.checkedVPViewRestricted),_n(3),fo(Oa(21,26,"perm.vpViewRestricted")),_n(3),jr("ngModel",t.actGroup.checkedVPView),_n(3),fo(Oa(27,28,"perm.vpView")),_n(3),jr("ngModel",t.actGroup.checkedVPViewAudit),_n(3),fo(Oa(33,30,"perm.vpViewAudit")),_n(3),jr("ngModel",t.actGroup.checkedVPModify),_n(3),fo(Oa(39,32,"perm.vpModify")),_n(3),jr("ngModel",t.actGroup.checkedCreateVariant),_n(3),fo(Oa(45,34,"perm.vpCreateVariant")),_n(3),jr("ngModel",t.actGroup.checkedVPManagePerm),_n(3),fo(Oa(51,36,"perm.vpManagePerm")),_n(3),jr("ngModel",t.actGroup.checkedVPDelete),_n(3),fo(Oa(57,38,"perm.vpDelete")),_n(2),jr("ngIf",t.helperUsersPerGroup(t.actGroup._id)),_n(1),jr("ngIf",!t.helperUsersPerGroup(t.actGroup._id)),_n(3),fo(Oa(63,40,"vpDetail.btn.back")),_n(2),jr("ngIf",t.hasVPPerm(t.permVP.ManagePerm)&&!t.actGroup.global&&!t.deleted)}}function Lk(t,e){if(1&t){const t=zr();Nr(0,"div",20),Nr(1,"div",21),Nr(2,"div",22),Nr(3,"h5",139),mo(4),Ua(5,"translate"),Fr(),Nr(6,"button",24),Nr(7,"span",25),mo(8,"\xd7"),Fr(),Fr(),Fr(),Nr(9,"div",26),Nr(10,"div"),Nr(11,"label",140),mo(12),Ua(13,"translate"),Fr(),Fr(),Nr(14,"form"),Nr(15,"div",54),Nr(16,"label",187),mo(17),Ua(18,"translate"),Fr(),Nr(19,"label",56),mo(20),Fr(),Fr(),Nr(21,"div",54),Nr(22,"label",141),mo(23),Ua(24,"translate"),Fr(),Nr(25,"label",56),mo(26),Fr(),Fr(),Nr(27,"div",54),Nr(28,"label",141),mo(29),Ua(30,"translate"),Fr(),Nr(31,"label",56),mo(32),Fr(),Fr(),Fr(),Fr(),Nr(33,"div",41),Nr(34,"button",59),mo(35),Ua(36,"translate"),Fr(),Nr(37,"button",188),Jr("click",(function(){ei(t);const e=Xr(2);return e.removeVPGroup(e.vgGroups[e.groupIndex],e.visboproject._id)})),mo(38),Ua(39,"translate"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(4),fo(Oa(5,10,"vpDetail.titleDeleteGroup")),_n(8),fo(Oa(13,12,"vpDetail.msg.removeGroupConfirm")),_n(5),vo("",Oa(18,14,"vpDetail.lbl.vp"),":"),_n(3),vo("",t.visboproject.name," "),_n(3),vo("",Oa(24,16,"vpDetail.lbl.group"),":"),_n(3),fo(t.vgGroups[t.groupIndex].name),_n(3),vo("",Oa(30,18,"vpDetail.lbl.members"),":"),_n(3),fo(t.vgGroups[t.groupIndex].users.length),_n(3),fo(Oa(36,20,"vpDetail.btn.back")),_n(3),fo(Oa(39,22,"vpDetail.btn.delete"))}}function Gk(t,e){1&t&&(Nr(0,"label",140),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.msg.removeProjectConfirm")))}function Rk(t,e){1&t&&(Nr(0,"label",189),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.msg.destroyProjectConfirm")))}function jk(t,e){if(1&t){const t=zr();Nr(0,"button",190),Jr("click",(function(){ei(t);const e=Xr(2);return e.delete(e.visboproject)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpDetail.btn.delete")))}function $k(t,e){if(1&t){const t=zr();Nr(0,"button",191),Jr("click",(function(){ei(t);const e=Xr(2);return e.delete(e.visboproject)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpDetail.btn.destroy")))}function Nk(t,e){1&t&&Br(0,"input",211)}function Fk(t,e){1&t&&Br(0,"input",212)}function Bk(t,e){1&t&&Br(0,"input",213)}function Hk(t,e){1&t&&Br(0,"input",214)}function Kk(t,e){1&t&&Br(0,"input",215)}function qk(t,e){1&t&&Br(0,"input",216)}function zk(t,e){1&t&&Br(0,"input",217)}function Qk(t,e){1&t&&Br(0,"input",218)}function Wk(t,e){1&t&&Br(0,"input",219)}function Jk(t,e){1&t&&Br(0,"input",220)}function Yk(t,e){1&t&&Br(0,"input",221)}function Zk(t,e){1&t&&Br(0,"input",222)}function Xk(t,e){1&t&&Br(0,"input",223)}function tD(t,e){1&t&&Br(0,"input",224)}function eD(t,e){if(1&t){const t=zr();Nr(0,"div",181),Nr(1,"a",225),Jr("click",(function(){ei(t);const e=Xr().$implicit;return Xr(3).activateGroup(e)})),mo(2),Fr(),Fr()}if(2&t){const t=Xr().$implicit;_n(2),fo(t.groupName)}}function iD(t,e){if(1&t&&(Hr(0,96),Lr(1,eD,3,1,"div",180),Kr()),2&t){const t=e.$implicit,i=Xr(3);_n(1),jr("ngIf",t.email==i.vgUsers[i.userIndex].email)}}const nD=function(t){return{name:t}};function sD(t,e){if(1&t&&(Nr(0,"div",192),Nr(1,"div",193),Nr(2,"div",21),Nr(3,"div",22),Nr(4,"h5",194),mo(5),Ua(6,"translate"),Fr(),Nr(7,"button",24),Nr(8,"span",25),mo(9,"\xd7"),Fr(),Fr(),Fr(),Nr(10,"div",26),Nr(11,"div"),mo(12),Ua(13,"translate"),Fr(),Nr(14,"div",148),Lr(15,Nk,1,0,"input",195),Lr(16,Fk,1,0,"input",196),Nr(17,"label",154),mo(18),Ua(19,"translate"),Fr(),Fr(),Nr(20,"div",148),Lr(21,Bk,1,0,"input",197),Lr(22,Hk,1,0,"input",198),Nr(23,"label",154),mo(24),Ua(25,"translate"),Fr(),Fr(),Nr(26,"div",148),Lr(27,Kk,1,0,"input",199),Lr(28,qk,1,0,"input",200),Nr(29,"label",157),mo(30),Ua(31,"translate"),Fr(),Fr(),Nr(32,"div",148),Lr(33,zk,1,0,"input",201),Lr(34,Qk,1,0,"input",202),Nr(35,"label",160),mo(36),Ua(37,"translate"),Fr(),Fr(),Nr(38,"div",148),Lr(39,Wk,1,0,"input",203),Lr(40,Jk,1,0,"input",204),Nr(41,"label",163),mo(42),Ua(43,"translate"),Fr(),Fr(),Nr(44,"div",148),Lr(45,Yk,1,0,"input",205),Lr(46,Zk,1,0,"input",206),Nr(47,"label",166),mo(48),Ua(49,"translate"),Fr(),Fr(),Nr(50,"div",148),Lr(51,Xk,1,0,"input",207),Lr(52,tD,1,0,"input",208),Nr(53,"label",169),mo(54),Ua(55,"translate"),Fr(),Fr(),Nr(56,"label",209),mo(57),Ua(58,"translate"),Fr(),Lr(59,iD,2,1,"ng-container",179),Nr(60,"div",41),Nr(61,"button",210),mo(62),Ua(63,"translate"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr(2);_n(5),fo(Ea(6,26,"vpDetail.titlePermUser",ka(49,nD,t.vgUsers[t.userIndex].email))),_n(7),fo(Oa(13,29,"perm.titleVPPerm")),_n(3),jr("ngIf",t.hasUserVPPerm(t.permVP.ViewRestricted)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.ViewRestricted)),_n(2),fo(Oa(19,31,"perm.vpViewRestricted")),_n(3),jr("ngIf",t.hasUserVPPerm(t.permVP.View)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.View)),_n(2),fo(Oa(25,33,"perm.vpView")),_n(3),jr("ngIf",t.hasUserVPPerm(t.permVP.ViewAudit)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.ViewAudit)),_n(2),fo(Oa(31,35,"perm.vpViewAudit")),_n(3),jr("ngIf",t.hasUserVPPerm(t.permVP.Modify)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.Modify)),_n(2),fo(Oa(37,37,"perm.vpModify")),_n(3),jr("ngIf",t.hasUserVPPerm(t.permVP.CreateVariant)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.CreateVariant)),_n(2),fo(Oa(43,39,"perm.vpCreateVariant")),_n(3),jr("ngIf",t.hasUserVPPerm(t.permVP.ManagePerm)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.ManagePerm)),_n(2),fo(Oa(49,41,"perm.vpManagePerm")),_n(3),jr("ngIf",t.hasUserVPPerm(t.permVP.DeleteVP)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.DeleteVP)),_n(2),fo(Oa(55,43,"perm.vpDelete")),_n(3),fo(Oa(58,45,"perm.lblGroupMembership")),_n(2),jr("ngForOf",t.vgUsers),_n(3),fo(Oa(63,47,"vpDetail.btn.back"))}}function rD(t,e){1&t&&(Nr(0,"div",136),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.msg.variantRequired")))}function oD(t,e){1&t&&(Nr(0,"button",226),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpDetail.btn.createVariant")))}function aD(t,e){if(1&t){const t=zr();Nr(0,"button",227),Jr("click",(function(){return ei(t),Xr(2).addNewVPVariant()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpDetail.btn.createVariant")))}function lD(t,e){if(1&t){const t=zr();Nr(0,"div",20),Nr(1,"div",21),Nr(2,"div",22),Nr(3,"h5",228),mo(4),Ua(5,"translate"),Fr(),Nr(6,"button",24),Nr(7,"span",25),mo(8,"\xd7"),Fr(),Fr(),Fr(),Nr(9,"div",26),Nr(10,"div"),Nr(11,"label",140),mo(12),Ua(13,"translate"),Fr(),Fr(),Nr(14,"form"),Nr(15,"div",54),Nr(16,"label",229),mo(17),Ua(18,"translate"),Fr(),Nr(19,"label",230),mo(20),Fr(),Fr(),Nr(21,"div",54),Nr(22,"label",229),mo(23),Ua(24,"translate"),Fr(),Nr(25,"label",230),mo(26),Fr(),Fr(),Nr(27,"div",54),Nr(28,"label",229),mo(29),Ua(30,"translate"),Fr(),Nr(31,"label",230),mo(32),Fr(),Fr(),Fr(),Fr(),Nr(33,"div",41),Nr(34,"button",59),mo(35),Ua(36,"translate"),Fr(),Nr(37,"button",231),Jr("click",(function(){ei(t);const e=Xr(2);return e.removeVariant(e.variantIndex,e.visboproject)})),mo(38),Ua(39,"translate"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(4),fo(Oa(5,10,"vpDetail.titleRemoveVariant")),_n(8),fo(Oa(13,12,"vpDetail.msg.removeVariantConfirm")),_n(5),vo("",Oa(18,14,"vpDetail.lbl.vp"),":"),_n(3),vo("",t.visboproject.name," "),_n(3),vo("",Oa(24,16,"vpDetail.lbl.variant"),":"),_n(3),fo(t.visboproject.variant[t.variantIndex].variantName),_n(3),vo("",Oa(30,18,"vpDetail.lbl.user"),":"),_n(3),fo(t.visboproject.variant[t.variantIndex].email),_n(3),fo(Oa(36,20,"vpDetail.btn.back")),_n(3),fo(Oa(39,22,"vpDetail.btn.delete"))}}function cD(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"h3"),mo(2),Ua(3,"translate"),Nr(4,"a",1),Jr("click",(function(){ei(t);const e=Xr();return e.gotoVP(e.visboproject)})),mo(5),Ua(6,"uppercase"),Fr(),Fr(),Nr(7,"h5"),mo(8),Ua(9,"translate"),Lr(10,wP,2,1,"a",2),Lr(11,AP,2,1,"span",0),Fr(),Nr(12,"form"),Nr(13,"div",3),Nr(14,"label",4),mo(15),Ua(16,"translate"),Fr(),Lr(17,PP,1,1,"input",5),Lr(18,kP,2,1,"label",6),Fr(),Lr(19,IP,6,5,"div",7),Nr(20,"div",3),Nr(21,"label",8),mo(22),Ua(23,"translate"),Fr(),Nr(24,"label",9),mo(25),Fr(),Fr(),Lr(26,SP,8,8,"div",7),Nr(27,"div",10),Nr(28,"label",11),mo(29),Ua(30,"translate"),Fr(),Nr(31,"label",12),mo(32),Ua(33,"date"),Fr(),Nr(34,"label",13),mo(35),Ua(36,"date"),Fr(),Fr(),Fr(),Lr(37,ck,14,10,"div",0),Nr(38,"div",14),Lr(39,dk,3,3,"button",15),Lr(40,uk,3,3,"button",16),Nr(41,"button",1),Jr("click",(function(){return ei(t),Xr().goBack()})),mo(42),Ua(43,"translate"),Fr(),Lr(44,hk,4,6,"button",17),Lr(45,pk,4,6,"button",18),Fr(),Nr(46,"div",19),Nr(47,"div",20),Nr(48,"div",21),Nr(49,"div",22),Nr(50,"h5",23),mo(51),Ua(52,"translate"),Fr(),Nr(53,"button",24),Nr(54,"span",25),mo(55,"\xd7"),Fr(),Fr(),Fr(),Nr(56,"div",26),Nr(57,"form",27,28),Nr(59,"div",29),Nr(60,"label",30),mo(61),Ua(62,"translate"),Fr(),Nr(63,"input",31,32),Jr("ngModelChange",(function(e){return ei(t),Xr().newUserInvite.email=e})),Fr(),Lr(65,gk,3,3,"div",33),Fr(),Nr(66,"div",29),Nr(67,"label",34),mo(68),Ua(69,"translate"),Fr(),Nr(70,"select",35,36),Jr("ngModelChange",(function(e){return ei(t),Xr().newUserInvite.groupName=e})),Br(72,"option"),Lr(73,mk,2,1,"option",37),Fr(),Lr(74,fk,3,3,"div",33),Fr(),Nr(75,"div",29),Nr(76,"label",38),mo(77),Ua(78,"translate"),Fr(),Nr(79,"textarea",39,40),Jr("ngModelChange",(function(e){return ei(t),Xr().newUserInvite.inviteMessage=e})),mo(81," "),Fr(),Fr(),Lr(82,vk,3,3,"div",33),Nr(83,"div",41),Nr(84,"button",42),mo(85),Ua(86,"translate"),Fr(),Lr(87,bk,3,3,"button",43),Lr(88,yk,3,3,"button",44),Fr(),Fr(),Fr(),Fr(),Fr(),Fr(),Nr(89,"div",45),Lr(90,Ck,40,24,"div",46),Fr(),Nr(91,"div",47),Nr(92,"div",20),Lr(93,Ek,65,42,"div",48),Fr(),Fr(),Nr(94,"div",49),Lr(95,Lk,40,24,"div",46),Fr(),Nr(96,"div",50),Nr(97,"div",20),Nr(98,"div",21),Nr(99,"div",22),Nr(100,"h5",51),mo(101),Ua(102,"translate"),Fr(),Nr(103,"button",24),Nr(104,"span",25),mo(105,"\xd7"),Fr(),Fr(),Fr(),Nr(106,"div",26),Nr(107,"div"),Lr(108,Gk,3,3,"label",52),Lr(109,Rk,3,3,"label",53),Fr(),Nr(110,"form"),Nr(111,"div",54),Nr(112,"label",55),mo(113),Ua(114,"translate"),Fr(),Nr(115,"label",56),mo(116),Fr(),Fr(),Nr(117,"div",54),Nr(118,"label",57),mo(119),Ua(120,"translate"),Fr(),Nr(121,"label",56),mo(122),Fr(),Fr(),Nr(123,"div",54),Nr(124,"label",58),mo(125),Ua(126,"translate"),Fr(),Nr(127,"label",56),mo(128),Fr(),Fr(),Fr(),Fr(),Nr(129,"div",41),Nr(130,"button",59),mo(131),Ua(132,"translate"),Fr(),Lr(133,jk,3,3,"button",60),Lr(134,$k,3,3,"button",61),Fr(),Fr(),Fr(),Fr(),Lr(135,sD,64,51,"div",62),Nr(136,"div",63),Nr(137,"div",20),Nr(138,"div",21),Nr(139,"div",22),Nr(140,"h5",64),mo(141),Ua(142,"translate"),Fr(),Nr(143,"button",24),Nr(144,"span",25),mo(145,"\xd7"),Fr(),Fr(),Fr(),Nr(146,"div",26),Nr(147,"form",65,66),Nr(149,"div",29),Nr(150,"label",67),mo(151),Ua(152,"translate"),Fr(),Nr(153,"input",68,69),Jr("ngModelChange",(function(e){return ei(t),Xr().newVariant=e})),Fr(),Lr(155,rD,3,3,"div",33),Fr(),Nr(156,"div",41),Nr(157,"button",42),mo(158),Ua(159,"translate"),Fr(),Lr(160,oD,3,3,"button",70),Lr(161,aD,3,3,"button",71),Fr(),Fr(),Fr(),Fr(),Fr(),Fr(),Nr(162,"div",72),Lr(163,lD,40,24,"div",46),Fr(),Fr()}if(2&t){const t=Gr(58),e=Gr(64),i=Gr(71),n=Gr(80),s=Gr(148),r=Gr(154),o=Xr();_n(2),vo("",Oa(3,63,"vpDetail.title"),": "),_n(3),fo(Oa(6,65,o.visboproject.name)),_n(3),vo("",Oa(9,67,"vpDetail.titleVC"),": "),_n(2),jr("ngIf",o.hasVCPerm(o.permVC.View)),_n(1),jr("ngIf",!o.hasVCPerm(o.permVC.View)),_n(4),vo("",Oa(16,69,"vpDetail.lbl.name"),":"),_n(2),jr("ngIf",o.hasVPPerm(o.permVP.Modify)),_n(1),jr("ngIf",!o.hasVPPerm(o.permVP.Modify)),_n(1),jr("ngIf",o.hasVPPerm(o.permVP.Modify)||o.visboproject.description),_n(3),vo("",Oa(23,71,"vpDetail.lbl.type"),":"),_n(3),vo("",o.getVPType(o.visboproject.vpType)," "),_n(1),jr("ngIf",o.hasVPPerm(o.permVP.Modify+o.permVP.CreateVariant)),_n(3),vo("",Oa(30,73,"vpDetail.lbl.createdUpdated"),":"),_n(3),vo("",Ea(33,75,o.visboproject.createdAt,"dd.MM.yyyy HH:mm:ss")," "),_n(3),vo("",Ea(36,78,o.visboproject.updatedAt,"dd.MM.yyyy HH:mm:ss")," "),_n(2),jr("ngIf",o.getVPPerm()!=o.permVP.View),_n(2),jr("ngIf",!o.deleted&&o.hasVPPerm(o.permVP.Modify)),_n(1),jr("ngIf",o.deleted&&o.hasVPPerm(o.permVP.DeleteVP)),_n(2),fo(Oa(43,81,"vpDetail.btn.back")),_n(2),jr("ngIf",!o.deleted&&o.hasVPPerm(o.permVP.DeleteVP)),_n(1),jr("ngIf",o.deleted&&o.hasVPPerm(o.permVP.DeleteVP)),_n(6),fo(Oa(52,83,"vpDetail.titleAddUser")),_n(8),jr("ngClass",ka(109,Dk,t.submitted&&!e.valid)),_n(2),vo("",Oa(62,85,"vpDetail.lbl.email"),":"),_n(2),jr("ngModel",o.newUserInvite.email),_n(2),jr("ngIf",t.submitted&&!e.valid),_n(1),jr("ngClass",ka(111,Dk,t.submitted&&!i.valid)),_n(2),vo("",Oa(69,87,"vpDetail.lbl.group"),":"),_n(2),jr("ngModel",o.newUserInvite.groupName),_n(3),jr("ngForOf",o.vgGroupsInvite),_n(1),jr("ngIf",t.submitted&&!i.valid),_n(1),jr("ngClass",ka(113,Dk,t.submitted&&!n.valid)),_n(2),vo("",Oa(78,89,"vpDetail.lbl.message"),":"),_n(2),jr("ngModel",o.newUserInvite.inviteMessage),_n(3),jr("ngIf",t.submitted&&!n.valid),_n(3),fo(Oa(86,91,"vpDetail.btn.cancel")),_n(2),jr("ngIf",!(e.valid&&i.valid)),_n(1),jr("ngIf",e.valid&&i.valid),_n(2),jr("ngIf",o.userIndex>=0&&o.userIndex<o.vgUsers.length),_n(3),jr("ngIf",o.actGroup),_n(2),jr("ngIf",o.groupIndex>=0&&o.groupIndex<o.vgGroups.length),_n(6),fo(Oa(102,93,"vpDetail.titleDeleteProject")),_n(7),jr("ngIf",!o.deleted),_n(1),jr("ngIf",o.deleted),_n(4),vo("",Oa(114,95,"vpDetail.lbl.vp"),":"),_n(3),vo("",o.visboproject.name," "),_n(3),vo("",Oa(120,97,"vpDetail.lbl.description"),":"),_n(3),vo("",o.visboproject.description," "),_n(3),vo("",Oa(126,99,"vpDetail.lbl.versions"),":"),_n(3),vo("",o.visboproject.vpvCount," "),_n(3),fo(Oa(132,101,"vpDetail.btn.back")),_n(2),jr("ngIf",!o.deleted),_n(1),jr("ngIf",o.deleted),_n(1),jr("ngIf",o.vgUsers&&o.userIndex>=0),_n(6),fo(Oa(142,103,"vpDetail.titleAddVariant")),_n(8),jr("ngClass",ka(115,Dk,s.submitted&&!r.valid)),_n(2),vo("",Oa(152,105,"vpDetail.lbl.variant"),":"),_n(2),jr("ngModel",o.newVariant),_n(2),jr("ngIf",s.submitted&&!r.valid),_n(3),fo(Oa(159,107,"vpDetail.btn.cancel")),_n(2),jr("ngIf",!r.valid),_n(1),jr("ngIf",r.valid),_n(2),jr("ngIf",o.variantIndex>=0&&o.variantIndex<o.visboproject.variant.length)}}let dD=(()=>{class t{constructor(t,e,i,n,s,r,o,a){this.messageService=t,this.route=e,this.visboprojectService=i,this.location=n,this.router=s,this.alertService=r,this.translate=o,this.titleService=a,this.newUserInvite=new Zh,this.actGroup=new Tv,this.actView="User",this.combinedPerm=void 0,this.combinedUserPerm=void 0,this.permVC=Iv,this.permVP=Sv,this.deleted=!1,this.sortUserColumn=1,this.sortUserAscending=!0,this.sortGroupColumn=1,this.sortGroupAscending=!0,this.sortVariantColumn=1,this.sortVariantAscending=!0}ngOnInit(){this.deleted=!!this.route.snapshot.queryParams.deleted,this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.getVisboProject(),this.getVisboProjectUsers()}getVisboProject(){const t=this.route.snapshot.paramMap.get("id");this.log("VisboProject Detail of: "+t),this.visboprojectService.getVisboProject(t,!1,this.deleted).subscribe(e=>{this.visboproject=e,this.combinedPerm=e.perm,this.titleService.setTitle(this.translate.instant("vpDetail.titleName",{name:e.name})),this.log(`Get VisboProject for VP ${t} Perm ${JSON.stringify(this.combinedPerm)} `)},t=>{if(this.log(`get VPs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpDetail.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Gh(t))})}hasVCPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vc&t)>0}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}hasUserVPPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vp&t)>0}getVPPerm(){return void 0===this.combinedPerm?0:this.combinedPerm.vp}viewRestriction(){if(!this.visboproject.restrict||!this.visboproject.restrict.length)return!1;let t=this.combinedPerm.vp||0;return t&=this.permVP.Modify+this.permVP.ManagePerm+this.permVP.DeleteVP,t>0}getVPType(t){return this.translate.instant("vp.type.vpType"+t)}toggleView(t){this.actView=t}getVisboProjectUsers(){const t=this.route.snapshot.paramMap.get("id");this.log(`VisboProject UserList of: ${t} Deleted ${this.deleted}`),this.visboprojectService.getVPUsers(t,!1,this.deleted).subscribe(t=>{this.vgUsers=t.users,this.vgGroups=t.groups,this.vgGroupsInvite=this.vgGroups.filter(t=>"VP"===t.groupType),this.log(`fetched Users ${this.vgUsers.length}, Groups ${this.vgGroups.length}, Invite Groups ${this.vgGroupsInvite.length}`),this.sortUserTable(),this.sortGroupTable()},t=>{if(this.log(`Get VP Users failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpDetail.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Gh(t))})}goBack(){this.location.back()}delete(t){this.visboprojectService.deleteVisboProject(t,this.deleted).subscribe(()=>{const e=this.translate.instant("vpDetail.msg.removeProjectSuccess",{name:this.visboproject.name});this.alertService.success(e,!0),this.log("delete VP success"),this.router.navigate(["vp/".concat(t.vcid)],this.deleted?{queryParams:{deleted:this.deleted}}:{})},e=>{if(this.log(`delete VP failed: error: ${e.status} message: ${e.error.message}`),403===e.status){const e=this.translate.instant("vpDetail.msg.errorPermVP",{name:t.name});this.alertService.error(e)}else this.alertService.error(Gh(e))})}gotoVPRestriction(t){this.log(`goto VP Restriction: ${t._id} Deleted ${this.deleted}`),this.router.navigate(["vpRestrict/".concat(t._id)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}gotoVPAudit(t){this.log(`goto VP Audit: ${t._id} Deleted ${this.deleted}`),this.router.navigate(["vpAudit/".concat(t._id)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}gotoVCDetail(t){this.router.navigate(["vcDetail/".concat(t.vcid)])}gotoVPList(t){this.log(`goto VP List: ${t._id} Deleted ${this.deleted}`),this.router.navigate(["vp/".concat(t.vcid)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}gotoVP(t){this.log(`goto VP: ${t._id} Deleted ${this.deleted}`);let e="vpKeyMetrics/";t.vpType===vb.Portfolio&&(e="vpf/"),this.router.navigate([e.concat(t._id)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}gotoVPView(t){this.log(`goto VP List: ${t._id} Deleted ${this.deleted}`),this.router.navigate(["vpv/".concat(t._id)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}save(){this.visboprojectService.updateVisboProject(this.visboproject,this.deleted).subscribe(()=>{const t=this.translate.instant("vpDetail.msg.updateProjectSuccess",{name:this.visboproject.name});this.alertService.success(t,!0),this.goBack()},t=>{if(this.log(`save VP failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpDetail.msg.errorPermVP",{name:this.visboproject.name});this.alertService.error(t)}else if(409===t.status){const t=this.translate.instant("vpDetail.msg.errorVPConflict",{name:this.visboproject.name});this.alertService.error(t)}else this.alertService.error(Gh(t))})}addNewVPUser(){const t=this.newUserInvite.email.trim(),e=this.newUserInvite.groupName.trim(),i=this.vgGroups.filter(t=>t.name===e)[0],n=i._id;let s="";this.newUserInvite.inviteMessage&&(s=this.newUserInvite.inviteMessage.trim());const r=this.visboproject._id;this.log(`Add VisboProject User: ${t} Group: ${e}/${n} VP: ${r}`),t&&n&&this.visboprojectService.addVPUser(t,n,s,r).subscribe(e=>{const n=new _v;n.userId=e.users.filter(e=>e.email===t)[0].userId,n.email=t,n.groupId=e._id,n.groupName=e.name,n.groupType=i.groupType,n.internal=i.internal,this.log("Add VisboCenter User Push: "+JSON.stringify(n)),this.vgUsers.push(n),this.sortUserTable();for(let t=0;t<this.vgGroups.length;t++)if(this.vgGroups[t]._id===e._id){this.vgGroups[t]=e;break}const s=this.translate.instant("vpDetail.msg.addUserSuccess",{name:t});this.alertService.success(s)},t=>{if(this.log("Add VisboProject User error: "+t.error.message),403===t.status){const t=this.translate.instant("vpDetail.msg.errorAddUserPerm");this.alertService.error(t)}else this.log("Error during add VP user "+t.error.message),this.alertService.error(Gh(t))})}addNewVPVariant(){this.newVariant&&this.newVariant.trim()&&(this.newVariant=this.newVariant.trim(),this.visboprojectService.createVariant(this.newVariant,this.visboproject._id).subscribe(t=>{this.visboproject.variant.push(t);const e=this.translate.instant("vpDetail.msg.createVariantSuccess",{name:t.variantName});this.alertService.success(e)},t=>{if(this.log("Create Variant error: "+t.error.message),403===t.status){const t=this.translate.instant("vpDetail.msg.errorCreateVariantPerm");this.alertService.error(t)}else if(409===t.status){const t=this.translate.instant("vpDetail.msg.errorVariantConflict",{name:this.newVariant});this.alertService.error(t)}else this.log("Error during creating Variant "+t.error.message),this.alertService.error(Gh(t))}))}calcCombinedPerm(t){this.userIndex=t,this.combinedUserPerm={system:0,vc:0,vp:0},this.vgUsers.forEach(this.addUserPerm,this),this.log(`Combined Permission for ${this.vgUsers[t].email}  ${JSON.stringify(this.combinedUserPerm)}`)}addUserPerm(t){if(t.email!==this.vgUsers[this.userIndex].email)return;this.log("Add User Permission for "+t.groupName);const e=this.vgGroups.findIndex(e=>e.name===t.groupName);e>=0?this.vgGroups[e].permission?this.combinedUserPerm.vp=this.combinedUserPerm.vp|(this.vgGroups[e].permission.vp||0):this.log("Permission for Group not set "+t.groupName):this.log("Group not found "+t.groupName)}helperRemoveUser(t){this.userIndex=t}helperRemoveGroup(t){this.groupIndex=t}helperRemoveVariant(t){this.variantIndex=t}helperUsersPerGroup(t){const e=this.vgGroups&&this.vgGroups.find(e=>e._id===t);return e?e.users.length:0}removeVPUser(t,e){this.log(`Remove VisboProject User: ${t.email}/${t.userId} Group: ${t.groupName} VP: ${e}`),this.visboprojectService.deleteVPUser(t,e).subscribe(()=>{this.vgUsers=this.vgUsers.filter(e=>e!==t);for(let i=0;i<this.vgGroups.length;i++)if(this.vgGroups[i]._id===t.groupId){for(let e=0;e<this.vgGroups[i].users.length;e++)if(this.vgGroups[i].users[e].userId===t.userId){this.vgGroups[i].users.splice(e,1);break}break}const e=this.translate.instant("vpDetail.msg.removeUserSuccess",{name:t.email});this.alertService.success(e)},t=>{if(this.log("Remove VisboProject User error: "+t.error.message),403===t.status){const t=this.translate.instant("vpDetail.msg.errorRemoveUserPerm");this.alertService.error(t)}else this.log("Error during remove User from VP user "+t.error.message),this.alertService.error(Gh(t))})}removeVariant(t,e){this.log(`Remove VisboProject Variant: ${e.variant[t].variantName} VP: ${e._id}`),this.visboprojectService.deleteVariant(e.variant[t]._id,e._id).subscribe(()=>{const i=this.translate.instant("vpDetail.msg.removeVariantSuccess",{name:e.variant[t].variantName});this.visboproject.variant.splice(t,1),this.alertService.success(i)},i=>{if(this.log("Remove VisboProject Variant error: "+i.error.message),403===i.status){const i=this.translate.instant("vpDetail.msg.errorRemoveVariantPerm",{name:e.variant[t].variantName});this.alertService.error(i)}else if(409===i.status){const i=this.translate.instant("vpDetail.msg.errorRemoveVariantConflict",{name:e.variant[t].variantName});this.alertService.error(i)}else this.log("Error during remove Variant from VP "+i.error.message),this.alertService.error(Gh(i))})}helperVPPerm(t){let e=0;return t.checkedVPViewRestricted&&(e+=this.permVP.ViewRestricted),t.checkedVPView&&(e+=this.permVP.View),t.checkedVPViewAudit&&(e+=this.permVP.ViewAudit),t.checkedVPModify&&(e+=this.permVP.Modify),t.checkedCreateVariant&&(e+=this.permVP.CreateVariant),t.checkedVPManagePerm&&(e+=this.permVP.ManagePerm),t.checkedVPDelete&&(e+=this.permVP.DeleteVP),e}activateGroup(t){this.log("Activate Group : "+t.groupName);const e=this.vgGroups.find(e=>e.name==t.groupName);this.initGroup(e)}activateUser(t){this.log("Activate User : "+t.email);const e=this.vgUsers.findIndex(e=>e.email==t.email);e>=0&&this.calcCombinedPerm(e)}initGroup(t){this.actGroup=new Tv,t?(this.confirm="VP"===t.groupType?"Modify":"View",this.actGroup._id=t._id,this.log(`Init Group Set GroupID : ${this.actGroup._id} ID ${t._id}`),this.actGroup.name=t.name,this.actGroup.groupType=t.groupType,this.actGroup.internal=t.internal,this.actGroup.global=t.global,this.actGroup.checkedView=(t.permission.vc&this.permVC.View)>0,this.actGroup.checkedViewAudit=(t.permission.vc&this.permVC.ViewAudit)>0,this.actGroup.checkedModify=(t.permission.vc&this.permVC.Modify)>0,this.actGroup.checkedCreateVP=(t.permission.vc&this.permVC.CreateVP)>0,this.actGroup.checkedManagePerm=(t.permission.vc&this.permVC.ManagePerm)>0,this.actGroup.checkedVPViewRestricted=(t.permission.vp&this.permVP.ViewRestricted)>0,this.actGroup.checkedVPView=(t.permission.vp&this.permVP.View)>0,this.actGroup.checkedVPViewAudit=(t.permission.vp&this.permVP.ViewAudit)>0,this.actGroup.checkedVPModify=(t.permission.vp&this.permVP.Modify)>0,this.actGroup.checkedCreateVariant=(t.permission.vp&this.permVP.CreateVariant)>0,this.actGroup.checkedVPManagePerm=(t.permission.vp&this.permVP.ManagePerm)>0,this.actGroup.checkedVPDelete=(t.permission.vp&this.permVP.DeleteVP)>0):(this.confirm="Add",this.actGroup._id=void 0,this.actGroup.name="",this.actGroup.groupType="VP",this.actGroup.internal=!1,this.actGroup.global=!1,this.actGroup.checkedView=!0),this.log(`Init Group for Creation / Modification: ${this.actGroup.name} ID ${this.actGroup._id} Action ${this.confirm} `)}addModifyVPGroup(){const t=new xv;!this.actGroup.global&&this.hasVPPerm(this.permVP.ManagePerm)&&(this.log(`Modify VisboProject Group: Group: ${this.actGroup.name} VC: ${this.visboproject.vcid} VP: ${this.visboproject._id} }`),t.name=this.actGroup.name.trim(),t.global=!1,t.vcid=this.visboproject.vcid,t.vpids=[],t.vpids.push(this.visboproject._id),t.permission=new Dv,t.permission.vp=this.helperVPPerm(this.actGroup),this.actGroup._id?(this.log(`Modify VisboProject Group: Group: ${t.name} VC: ${t.vcid} Perm: ${JSON.stringify(t.permission)}`),t._id=this.actGroup._id,this.visboprojectService.modifyVPGroup(t).subscribe(e=>{this.log("Modify VisboProject Group Push: "+JSON.stringify(e)),this.vgGroups=this.vgGroups.filter(e=>e._id!==t._id),this.vgGroups.push(e),this.vgGroupsInvite=this.vgGroups.filter(t=>"VP"===t.groupType);for(let n=0;n<this.vgUsers.length;n++)this.vgUsers[n].groupId===t._id&&(this.vgUsers[n].groupName=e.name);this.sortUserTable(),this.sortGroupTable();const i=this.translate.instant("vpDetail.msg.changeGroupSuccess",{name:e.name});this.alertService.success(i)},t=>{if(this.log("Modify VisboProject Group error: "+t.error.message),403===t.status){const t=this.translate.instant("vpDetail.msg.errorChangeGroupPerm");this.alertService.error(t)}else this.log("Error during modify VP Group "+t.error.message),this.alertService.error(Gh(t))})):(this.log(`Add VisboProject Group: Group: ${t.name} VP: ${t.vpids[0]} Perm: ${JSON.stringify(t.permission)}`),this.visboprojectService.addVPGroup(t).subscribe(t=>{this.vgGroups.push(t),this.vgGroupsInvite=this.vgGroups.filter(t=>"VP"===t.groupType);const e=this.translate.instant("vpDetail.msg.createGroupSuccess",{name:t.name});this.alertService.success(e)},t=>{if(this.log("Add VisboProject Group error: "+t.error.message),403===t.status){const t=this.translate.instant("vpDetail.msg.errorCreateGroupPerm");this.alertService.error(t)}else this.log("Error during add VP Group "+t.error.message),this.alertService.error(Gh(t))})))}removeVPGroup(t,e){this.log(`Remove VisboProject Group: ${t.name}/${t._id} VP: ${e}`),this.visboprojectService.deleteVPGroup(t,e).subscribe(e=>{this.log("Remove VisboProject Group result: "+JSON.stringify(e)),this.vgGroups=this.vgGroups.filter(e=>e!==t),this.vgUsers=this.vgUsers.filter(e=>e.groupId!==t._id),this.vgGroupsInvite=this.vgGroups.filter(t=>"VP"===t.groupType);const i=this.translate.instant("vpDetail.msg.removeGroupSuccess",{name:t.name});this.alertService.success(i)},t=>{if(this.log("Remove VisboProject Group error: "+t.error.message),403===t.status){const t=this.translate.instant("vpDetail.msg.errorRemoveGroupPerm");this.alertService.error(t)}else this.log("Error during remove Group from VP user "+t.error.message),this.alertService.error(Gh(t))})}getLockStatus(t){let e=0;const i=this.visboproject.variant[t].variantName,n=this.visboproject.lock.find(t=>t.variantName==i);return n&&(e=n.email==this.currentUser.email?1:2),e}unlockVP(t){const e=this.visboproject._id,i=this.visboproject.lock[t].variantName,n=this.visboproject.variant.find(t=>t.variantName==i),s=n?n._id.toString():"";this.log(`Remove VisboProject Lock: ${this.visboproject.name} Variant ${i} ${this.visboproject.lock[t].expiresAt} VPID: ${e}`),this.visboprojectService.unlockVP(s,e).subscribe(t=>{this.log("Remove VisboProject Lock result: "+JSON.stringify(t));for(let n=0;n<this.visboproject.lock.length;n++)if(this.visboproject.lock[n].variantName===i){this.visboproject.lock.splice(n,1);break}const e=this.translate.instant("vpDetail.msg.removeLockSuccess");this.alertService.success(e)},t=>{if(this.log("Remove VisboProject Lock error: "+t.error.message),403===t.status){const t=this.translate.instant("vpDetail.msg.errorRemoveLockPerm");this.alertService.error(t)}else this.log("Error during remove Lock from VP  "+t.error.message),this.alertService.error(Gh(t))})}getVPVersionsTotal(){let t=this.visboproject.vpvCount||0;return this.visboproject.variant&&this.visboproject.variant.forEach(e=>t+=e.vpvCount||0),t}sortUserTable(t){this.vgUsers&&(void 0===t&&void 0!==this.sortUserColumn||(t!==this.sortUserColumn&&(this.sortUserColumn=t,this.sortUserAscending=void 0),this.sortUserAscending=void 0===this.sortUserAscending?1===t||2===t:!this.sortUserAscending),1===this.sortUserColumn?this.vgUsers.sort((function(t,e){return xh(t.email,e.email)})):2===this.sortUserColumn&&this.vgUsers.sort((function(t,e){return xh(t.groupName.toLowerCase(),e.groupName.toLowerCase())})),this.sortUserAscending||this.vgUsers.reverse())}sortGroupTable(t){this.vgGroups&&(void 0===t&&void 0!==this.sortGroupColumn||(t!==this.sortGroupColumn&&(this.sortGroupColumn=t,this.sortGroupAscending=void 0),this.sortGroupAscending=void 0===this.sortGroupAscending?1===t:!this.sortGroupAscending),1===this.sortGroupColumn?this.vgGroups.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortGroupColumn&&this.vgGroups.sort((function(t,e){return e.users.length-t.users.length})),this.sortGroupAscending||this.vgGroups.reverse())}sortVariantTable(t){if(!this.visboproject.variant)return;const e=this.visboproject.variant;void 0===t&&void 0!==this.sortVariantColumn||(t!==this.sortVariantColumn&&(this.sortVariantColumn=t,this.sortVariantAscending=void 0),this.sortVariantAscending=void 0===this.sortVariantAscending?1===t||2===t:!this.sortVariantAscending),1===this.sortVariantColumn?e.sort((function(t,e){return xh(t.variantName.toLowerCase(),e.variantName.toLowerCase())})):2===this.sortVariantColumn?e.sort((function(t,e){return xh(t.email.toLowerCase(),e.email.toLowerCase())})):3===this.sortVariantColumn?e.sort((function(t,e){return Th(t.createdAt,e.createdAt)})):4===this.sortVariantColumn&&e.sort((function(t,e){return e.vpvCount-t.vpvCount})),this.sortVariantAscending||e.reverse()}log(t){this.messageService.add("VisboProjectDetail: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(Bg),Rr(Vb),Rr(Xl),Rr(rf),Rr(Mf),Rr(av),Rr(Md))},t.\u0275cmp=le({type:t,selectors:[["app-visboproject-detail"]],inputs:{visboproject:"visboproject"},decls:2,vars:1,consts:[[4,"ngIf"],[3,"click"],[3,"click",4,"ngIf"],[1,"form-group","row"],["for","vpName",1,"col-3","col-md-2","col-form-label"],["id","VPName","type","text","name","vpName","class","col-sm-8 form-control","placeholder","Name",3,"ngModel","ngModelChange",4,"ngIf"],["id","VPName","class","col-8 form-control-static",4,"ngIf"],["class","form-group row",4,"ngIf"],["for","vpType",1,"col-3","col-md-2","col-form-label"],["name","vpType",1,"col","form-control-static","col-form-label"],[1,"form-group","row","d-none","d-md-block"],["for","Created",1,"col-3","col-md-2","col-form-label"],["id","VPCreated",1,"col-4","form-control-static","col-form-label"],["id","VPUpdated",1,"col-4","form-control-static","col-form-label"],[1,"mb-3"],["id","Save","class","btn btn-primary mr-1",3,"click",4,"ngIf"],["id","Save","class","btn btn-primary mx-1",3,"click",4,"ngIf"],["id","DeleteVP","class","btn bg-warning mx-1","style","float: right","data-toggle","modal","data-target","#VpDelete",3,"title",4,"ngIf"],["id","DestroyVP","class","btn bg-danger text-white mx-1","style","float: right","data-toggle","modal","data-target","#VpDelete",3,"title",4,"ngIf"],["id","VpUserModalCreate","tabindex","-1","role","dialog","aria-labelledby","VpUserModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VpUserModalCenterTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["name","newUserInvite","novalidate",""],["f1","ngForm"],[1,"form-group",3,"ngClass"],["for","email",1,"col-form-label"],["id","AddUserName","type","email","name","email","required","","pattern","[^@\\s]+@[^@\\s]+\\.[^@\\s]+","autocomplete","email",1,"form-control",3,"ngModel","ngModelChange"],["email","ngModel"],["class","help-block",4,"ngIf"],["for","group",1,"col-form-label"],["id","AddUserGroupName","name","group","required","",1,"form-control",3,"ngModel","ngModelChange"],["group","ngModel"],[4,"ngFor","ngForOf"],["for","inviteMessage",1,"col-form-label"],["id","AddUserMessage","name","inviteMessage",1,"form-control",3,"ngModel","ngModelChange"],["inviteMessage","ngModel"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary","mx-1"],["id","AddUserConfirm","type","submit","class","btn btn-primary mx-1",4,"ngIf"],["id","AddUserConfirm","type","submit","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","VpUserRemove","tabindex","-1","role","dialog","aria-labelledby","Remove User","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-dialog-centered","role","document",4,"ngIf"],["id","VpGroupModalCreate","tabindex","-1","role","dialog","aria-labelledby","VpGroupModalCreateTitle","aria-hidden","true",1,"modal","fade"],["class","modal-content",4,"ngIf"],["id","VpGroupRemove","tabindex","-1","role","dialog","aria-labelledby","VpGroupModalRemoveTitle","aria-hidden","true",1,"modal","fade"],["id","VpDelete","tabindex","-1","role","dialog","aria-labelledby","Delete Project","aria-hidden","true",1,"modal","fade"],["id","VpDeleteTitle",1,"modal-title"],["class","bg-warning",4,"ngIf"],["class","bg-danger text-white",4,"ngIf"],[1,"form-group"],["for","VpName",1,"col-form-label"],[1,"col-8","form-control-static"],["for","VpDescription",1,"col-form-label"],["for","VpVersions",1,"col-form-label"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["id","DeleteVPConfirm","type","button","class","btn btn-warning text-white","data-dismiss","modal",3,"click",4,"ngIf"],["id","DeleteVPConfirm","type","button","class","btn btn-danger text-white","data-dismiss","modal",3,"click",4,"ngIf"],["class","modal fade","id","VPUserDetail","tabindex","-1","role","dialog","aria-labelledby","VPUserDetailTitle","aria-hidden","true",4,"ngIf"],["id","VpVariantModalCreate","tabindex","-1","role","dialog","aria-labelledby","VpVariantModalCreateTitle","aria-hidden","true",1,"modal","fade"],["id","VpVariantModalCreateTitle",1,"modal-title"],["name","newVariant","novalidate",""],["f3","ngForm"],["for","variant",1,"col-form-label"],["id","AddVariant","type","text","name","variant","required","",1,"form-control",3,"ngModel","ngModelChange"],["variant","ngModel"],["id","AddVariantConfirm","type","submit","class","btn btn-primary mx-1",4,"ngIf"],["id","AddVariantConfirm","type","submit","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","VpVariantRemove","tabindex","-1","role","dialog","aria-labelledby","Remove Variant","aria-hidden","true",1,"modal","fade"],["id","VPName","type","text","name","vpName","placeholder","Name",1,"col-sm-8","form-control",3,"ngModel","ngModelChange"],["id","VPName",1,"col-8","form-control-static"],["for","vpDescription",1,"col-3","col-md-2","col-form-label"],["id","VPDesc","name","vpDescription","class","col-8 form-control","placeholder","Type in your description",3,"ngModel","ngModelChange",4,"ngIf"],["id","VPDesc","class","col-8 form-control-static",4,"ngIf"],["id","VPDesc","name","vpDescription","placeholder","Type in your description",1,"col-8","form-control",3,"ngModel","ngModelChange"],["id","VPDesc",1,"col-8","form-control-static"],["for","vpVersion",1,"col-3","col-md-2","col-form-label"],["name","vpVersion",1,"col","form-control-static","col-form-label"],[1,"btn-toolbar"],["id","ViewAudit","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["id","ViewGroup","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["id","ViewUser","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["id","ViewRestrictUser","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["id","ViewVariant","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["id","ViewLock","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["lockIndicator",""],["id","ViewAudit","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["id","ViewGroup","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["id","ViewUser","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["id","ViewRestrictUser","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["id","ViewVariant","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["id","ViewLock","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],[1,"row"],[1,"col"],[1,"panel-heading","mt-3"],["class","col",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover"],["id","UserHead"],[1,"d-none","d-md-table-cell"],["id","UserList"],["id","AddUser","type","button","data-toggle","modal","data-target","#VpUserModalCreate",1,"my-1","btn","btn-primary","float-right"],["id","ColUser","data-toggle","modal","data-target","#VPUserDetail",3,"click"],["id","ColGroup",3,"click"],["id","ColDeleteUser","data-toggle","modal","data-target","#VpUserRemove",1,"Detail",3,"title","click"],["id","GroupHead"],["id","GroupList"],["id","AddGroup","type","button","data-toggle","modal","data-target","#VpGroupModalCreate",1,"btn","btn-primary","float-right",3,"click"],["id","ColGroup","data-toggle","modal","data-target","#VpGroupModalCreate",3,"click"],["id","ColMembers",3,"click"],["id","ColGlobal","class","d-none d-md-table-cell",4,"ngIf"],["id","ColDetail","data-toggle","modal","data-target","#VpGroupModalCreate",1,"Detail",3,"title","click"],["id","ColGlobal",1,"d-none","d-md-table-cell"],["id","ColDeleteGroup","data-toggle","modal","data-target","#VpGroupRemove",1,"Detail",3,"title","click"],["id","VariantHead"],[1,"d-none","d-md-table-cell",3,"click"],["id","VariantList"],["id","AddVariant","type","button","data-toggle","modal","data-target","#VpVariantModalCreate",1,"my-1","btn","btn-primary","float-right"],["id","ColName"],["id","ColEmail"],[1,"d-none","d-md-table-cell",3,"title"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["id","ColDeleteVariant","class","Detail","data-toggle","modal","data-target","#VpVariantRemove",3,"title","click",4,"ngIf"],["id","ColDeleteVariant","data-toggle","modal","data-target","#VpVariantRemove",1,"Detail",3,"title","click"],[1,"fa",3,"ngClass"],[1,"row","mt-2"],[1,"panel-heading"],["data-toggle","modal","data-target","#VpUnlock",1,"btn","btn-md",3,"title","click"],["id","Save",1,"btn","btn-primary","mr-1",3,"click"],["id","Save",1,"btn","btn-primary","mx-1",3,"click"],["id","DeleteVP","data-toggle","modal","data-target","#VpDelete",1,"btn","bg-warning","mx-1",2,"float","right",3,"title"],["id","DestroyVP","data-toggle","modal","data-target","#VpDelete",1,"btn","bg-danger","text-white","mx-1",2,"float","right",3,"title"],[1,"help-block"],["id","AddUserConfirm","type","submit",1,"btn","btn-primary","mx-1"],["id","AddUserConfirm","type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["id","VpUserRemoveTitle",1,"modal-title"],[1,"bg-warning"],[1,"col-form-label"],["id","DeleteUserConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning",3,"click"],["class","modal-title","id","VpGroupModalCenterTitle",4,"ngIf"],["name","actGroup","novalidate",""],["f2","ngForm"],["class","form-group",4,"ngIf"],["class","form-group",3,"ngClass",4,"ngIf"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","permVP0","name","checkedVPViewRestricted",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPViewRestricted","ngModel"],["for","permVP0",1,"custom-control-label"],["type","checkbox","id","permVP1","name","checkedVPView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPView","ngModel"],["for","permVP1",1,"custom-control-label"],["type","checkbox","id","permVP2","name","checkedVPViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPViewAudit","ngModel"],["for","permVP2",1,"custom-control-label"],["type","checkbox","id","permVP3","name","checkedVPModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPModify","ngModel"],["for","permVP3",1,"custom-control-label"],["type","checkbox","id","permVP4","name","checkedCreateVariant",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVariant","ngModel"],["for","permVP4",1,"custom-control-label"],["type","checkbox","id","permVP5","name","checkedVPManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPManagePerm","ngModel"],["for","permVP5",1,"custom-control-label"],["type","checkbox","id","permVP6","name","checkedVPDelete",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPDelete","ngModel"],["for","permVP6",1,"custom-control-label"],["class","mt-2",4,"ngIf"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-secondary","mx-1"],["id","VpGroupModalCenterTitle",1,"modal-title"],["for","name",1,"col-form-label"],["for","groupName",1,"col-form-label"],["id","AddGroupName","type","text","name","groupName","required","",1,"form-control",3,"ngModel","ngModelChange"],["groupName","ngModel"],[1,"mt-2"],[1,"form-control-static"],["class","row",4,"ngFor","ngForOf"],["class","col-8 ml-3",4,"ngIf"],[1,"col-8","ml-3"],["data-dismiss","modal","data-toggle","modal","data-target","#VPUserDetail",3,"click"],["id","AddGroupConfirm","type","submit","class","btn btn-primary disabled mx-1",4,"ngIf"],["id","AddGroupConfirm","type","submit","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","AddGroupConfirm","type","submit",1,"btn","btn-primary","disabled","mx-1"],["id","AddGroupConfirm","type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["for","VcName",1,"col-form-label"],["id","DeleteGroupConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning",3,"click"],[1,"bg-danger","text-white"],["id","DeleteVPConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning","text-white",3,"click"],["id","DeleteVPConfirm","type","button","data-dismiss","modal",1,"btn","btn-danger","text-white",3,"click"],["id","VPUserDetail","tabindex","-1","role","dialog","aria-labelledby","VPUserDetailTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],["id","VPUserDetailTitle",1,"modal-title"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP0","name","checkedViewRestricted",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP0","name","checkedViewRestricted",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],[1,"form-control-static","mt-2"],["data-dismiss","modal",1,"btn","btn-primary"],["type","checkbox","checked","","disabled","","id","permVP0","name","checkedViewRestricted",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP0","name","checkedViewRestricted",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["data-dismiss","modal","data-toggle","modal","data-target","#VpGroupModalCreate",3,"click"],["id","AddVariantConfirm","type","submit",1,"btn","btn-primary","mx-1"],["id","AddVariantConfirm","type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["id","VpVariantRemoveTitle",1,"modal-title"],[1,"col-sm-4","col-form-label"],[1,"col-sm-8","form-control-static"],["id","DeleteVariantConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning",3,"click"]],template:function(t,e){1&t&&(Br(0,"app-usernavbar"),Lr(1,cD,164,117,"div",0)),2&t&&(_n(1),jr("ngIf",e.visboproject))},directives:[Pb,jc,Eu,Fd,Tu,Ec,Ed,Ru,Hu,Nd,Ou,cu,du,gu,Gc,Bc,_d],pipes:[lv,Kc,qc],styles:[""]}),t})();function uD(t,e){1&t&&(Nr(0,"h2"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),vo(" ",Oa(2,1,"vpv.title")," "))}function hD(t,e){if(1&t){const t=zr();Nr(0,"h2"),mo(1),Ua(2,"translate"),Nr(3,"button",18),Jr("click",(function(){ei(t);const e=Xr();return e.gotoVPDetail(e.vpActive)})),mo(4),Fr(),Fr()}if(2&t){const t=Xr();_n(1),vo(" ",Oa(2,2,"vpv.titleVP"),": "),_n(3),vo(" ",t.vpActive.name," ")}}function pD(t,e){if(1&t){const t=zr();Nr(0,"a",9),Jr("click",(function(){ei(t);const e=Xr(2);return e.gotoVCDetail(e.vpActive)})),mo(1),Fr()}if(2&t){const t=Xr(2);_n(1),fo(t.vpActive.vc.name)}}function gD(t,e){if(1&t&&(Nr(0,"span"),mo(1),Fr()),2&t){const t=Xr(2);_n(1),fo(t.vpActive.vc.name)}}function mD(t,e){if(1&t&&(Nr(0,"h5"),mo(1),Ua(2,"translate"),Lr(3,pD,2,1,"a",12),Lr(4,gD,2,1,"span",2),Fr()),2&t){const t=Xr();_n(1),vo("",Oa(2,3,"vpv.titleVC"),": "),_n(2),jr("ngIf",t.hasVCPerm(t.permVC.View)),_n(1),jr("ngIf",!t.hasVCPerm(t.permVC.View))}}function fD(t,e){if(1&t){const t=zr();Nr(0,"button",21),Jr("click",(function(){return ei(t),Xr(2).toggleVisboProjectVersions()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpv.btn.deleted")))}function vD(t,e){if(1&t){const t=zr();Nr(0,"button",21),Jr("click",(function(){return ei(t),Xr(2).toggleVisboProjectVersions()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpv.btn.undeleted")))}function bD(t,e){if(1&t&&(Nr(0,"div",19),Lr(1,fD,3,3,"button",20),Lr(2,vD,3,3,"button",20),Fr()),2&t){const t=Xr();_n(1),jr("ngIf",!t.deleted),_n(1),jr("ngIf",t.deleted)}}function yD(t,e){if(1&t){const t=zr();Nr(0,"th",9),Jr("click",(function(){return ei(t),Xr().sortVPVTable(3)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpv.lbl.trafficlight")))}function CD(t,e){1&t&&(Nr(0,"th"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpv.lbl.delete")))}function VD(t,e){1&t&&qr(0)}const wD=function(t){return{level:t}};function AD(t,e){if(1&t&&(Nr(0,"td"),Lr(1,VD,1,0,"ng-container",26),Fr()),2&t){const t=Xr().$implicit;Xr();const e=Gr(36);_n(1),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(2,wD,t.ampelStatus))}}function PD(t,e){if(1&t){const t=zr();Nr(0,"button",27),Jr("click",(function(){ei(t);const e=Xr().index;return Xr().helperSetVPV(e)})),Ua(1,"translate"),mo(2,"\xd7"),Fr()}2&t&&to("title",Oa(1,1,"vpv.lbl.deleteVersion"))}function kD(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td",8),mo(2),Fr(),Nr(3,"td",22),Jr("click",(function(){ei(t);const i=e.index;return Xr().helperSetVPV(i)})),Ua(4,"date"),mo(5),Ua(6,"date"),Fr(),Nr(7,"td",23),Jr("click",(function(){ei(t);const i=e.index;return Xr().helperSetVPV(i)})),mo(8),Fr(),Nr(9,"td",23),Jr("click",(function(){ei(t);const i=e.index;return Xr().helperSetVPV(i)})),mo(10),Ua(11,"date"),Fr(),Lr(12,AD,2,4,"td",2),Nr(13,"td",24),Jr("click",(function(){ei(t);const i=e.index;return Xr().helperSetVPV(i)})),mo(14),Fr(),Nr(15,"td",23),Jr("click",(function(){ei(t);const i=e.index;return Xr().helperSetVPV(i)})),Nr(16,"span"),mo(17),Fr(),Fr(),Nr(18,"td"),Lr(19,PD,3,3,"button",25),Fr(),Fr()}if(2&t){const t=e.$implicit,i=e.index,n=Xr();_n(2),fo(i+1),_n(1),to("title",Ea(4,9,t.timestamp,"dd.MM.yyyy HH:mm")),_n(2),fo(Ea(6,12,t.timestamp,"dd.MM.yy")),_n(3),fo(t.status),_n(2),fo(Ea(11,15,t.endDate,"dd.MM.yy")),_n(2),jr("ngIf",n.hasVPPerm(n.permVP.ViewAudit)),_n(2),fo(t.variantName),_n(3),fo(n.checkLocked(t)),_n(2),jr("ngIf",n.hasVPPerm(n.permVP.DeleteVP)&&!n.checkLocked(t,!0))}}const DD=function(t,e,i,n,s){return{"fas fa-lightbulb":t,"text-secondary":e,"text-success":i,"text-warning":n,"text-danger":s}};function MD(t,e){if(1&t&&Br(0,"i",28),2&t){const t=e.level;jr("ngClass",function(t,e,i,n,s,r,o,a){const l=li()+1,c=Xe(),d=Tr(c,l,i,n,s,r);return Ir(c,l+4,o)||d?Dr(c,l+5,e(i,n,s,r,o)):Mr(c,l+5)}(0,DD,t>=0,0==t,1==t,2==t,3==t))}}function ID(t,e){if(1&t&&(Nr(0,"div",37),Nr(1,"label",46),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",39),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpv.lbl.variantName"),":"),_n(3),vo("",t.visboprojectversion.variantName," ")}}function SD(t,e){if(1&t&&(Nr(0,"div",37),Nr(1,"label",47),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",39),mo(5),Ua(6,"date"),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpv.lbl.startDate"),":"),_n(3),vo("",Ea(6,4,t.visboprojectversion.startDate,"dd.MM.yyyy")," ")}}function xD(t,e){if(1&t&&(Nr(0,"div",37),Nr(1,"label",48),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",39),mo(5),Ua(6,"date"),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpv.lbl.endDate"),":"),_n(3),vo("",Ea(6,4,t.visboprojectversion.endDate,"dd.MM.yyyy")," ")}}function TD(t,e){if(1&t&&(Nr(0,"div",37),Nr(1,"label",49),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",39),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpv.lbl.status"),":"),_n(3),vo("",t.visboprojectversion.status," ")}}function _D(t,e){if(1&t&&(Nr(0,"div",37),Nr(1,"label",50),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",39),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpv.lbl.bu"),":"),_n(3),vo("",t.visboprojectversion.businessUnit," ")}}function UD(t,e){if(1&t){const t=zr();Nr(0,"button",51),Jr("click",(function(){return ei(t),Xr(2).restore()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpv.btn.restore")))}function OD(t,e){if(1&t&&(Nr(0,"div",29),Nr(1,"div",30),Nr(2,"div",31),Nr(3,"div",32),Nr(4,"h5",33),mo(5),Ua(6,"translate"),Fr(),Nr(7,"button",34),Nr(8,"span",35),mo(9,"\xd7"),Fr(),Fr(),Fr(),Nr(10,"div",36),Nr(11,"form"),Nr(12,"div",37),Nr(13,"label",38),mo(14),Ua(15,"translate"),Fr(),Nr(16,"label",39),mo(17),Fr(),Fr(),Nr(18,"div",37),Nr(19,"label",40),mo(20),Ua(21,"translate"),Fr(),Nr(22,"label",39),mo(23),Ua(24,"date"),Fr(),Fr(),Nr(25,"div",37),Nr(26,"label",41),mo(27),Ua(28,"translate"),Fr(),Nr(29,"label",39),mo(30),Ua(31,"date"),Fr(),Fr(),Lr(32,ID,6,4,"div",42),Lr(33,SD,7,7,"div",42),Lr(34,xD,7,7,"div",42),Lr(35,TD,6,4,"div",42),Lr(36,_D,6,4,"div",42),Fr(),Fr(),Nr(37,"div",43),Nr(38,"button",44),mo(39),Ua(40,"translate"),Fr(),Lr(41,UD,3,3,"button",45),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr();_n(5),fo(Oa(6,14,"vpv.titleDetailVPV")),_n(9),vo("",Oa(15,16,"vpv.lbl.name"),":"),_n(3),vo("",t.visboprojectversion.name," "),_n(3),vo("",Oa(21,18,"vpv.lbl.timestamp"),":"),_n(3),vo("",Ea(24,20,t.visboprojectversion.timestamp,"dd.MM.yyyy HH:mm:ss")," "),_n(4),vo("",Oa(28,23,"vpv.lbl.updatedAt"),":"),_n(3),vo("",Ea(31,25,t.visboprojectversion.updatedAt,"dd.MM.yyyy HH:mm:ss")," "),_n(2),jr("ngIf",t.visboprojectversion.variantName),_n(1),jr("ngIf",t.visboprojectversion.startDate),_n(1),jr("ngIf",t.visboprojectversion.endDate),_n(1),jr("ngIf",t.visboprojectversion.status),_n(1),jr("ngIf",t.visboprojectversion.businessUnit),_n(3),fo(Oa(40,28,"vpv.btn.back")),_n(2),jr("ngIf",t.deleted&&t.hasVPPerm(t.permVP.DeleteVP))}}function ED(t,e){1&t&&(Nr(0,"label",59),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpv.msg.confirmDelete")))}function LD(t,e){1&t&&(Nr(0,"label",60),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpv.msg.confirmDestroy")))}function GD(t,e){if(1&t){const t=zr();Nr(0,"button",61),Jr("click",(function(){ei(t);const e=Xr(2);return e.delete(e.visboprojectversion)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpv.btn.delete")))}function RD(t,e){if(1&t){const t=zr();Nr(0,"button",62),Jr("click",(function(){ei(t);const e=Xr(2);return e.delete(e.visboprojectversion)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpv.btn.destroy")))}function jD(t,e){if(1&t&&(Nr(0,"div",52),Nr(1,"div",30),Nr(2,"div",31),Nr(3,"div",32),Nr(4,"h5",33),mo(5),Ua(6,"translate"),Fr(),Nr(7,"button",34),Nr(8,"span",35),mo(9,"\xd7"),Fr(),Fr(),Fr(),Nr(10,"div",36),Nr(11,"div"),Lr(12,ED,3,3,"label",53),Lr(13,LD,3,3,"label",54),Fr(),Nr(14,"form"),Nr(15,"div",55),Nr(16,"label",38),mo(17),Ua(18,"translate"),Fr(),Nr(19,"label",56),mo(20),Fr(),Fr(),Nr(21,"div",55),Nr(22,"label",40),mo(23),Ua(24,"translate"),Fr(),Nr(25,"label",56),mo(26),Ua(27,"date"),Fr(),Fr(),Nr(28,"div",55),Nr(29,"label",40),mo(30),Ua(31,"translate"),Fr(),Nr(32,"label",56),mo(33),Ua(34,"date"),Fr(),Fr(),Fr(),Fr(),Nr(35,"div",43),Nr(36,"button",44),mo(37),Ua(38,"translate"),Fr(),Lr(39,GD,3,3,"button",57),Lr(40,RD,3,3,"button",58),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr();_n(5),fo(Oa(6,12,"vpv.titleDeleteVPV")),_n(7),jr("ngIf",!t.deleted),_n(1),jr("ngIf",t.deleted),_n(4),vo("",Oa(18,14,"vpv.lbl.name"),":"),_n(3),vo("",t.visboprojectversion.name," "),_n(3),vo("",Oa(24,16,"vpv.lbl.timestamp"),":"),_n(3),vo("",Ea(27,18,t.visboprojectversion.timestamp,"dd.MM.yyyy HH:mm:ss")," "),_n(4),vo("",Oa(31,21,"vpv.lbl.updatedAt"),":"),_n(3),vo("",Ea(34,23,t.visboprojectversion.updatedAt,"dd.MM.yyyy HH:mm:ss")," "),_n(4),fo(Oa(38,26,"vpv.btn.cancel")),_n(2),jr("ngIf",!t.deleted),_n(1),jr("ngIf",t.deleted)}}let $D=(()=>{class t{constructor(t,e,i,n,s,r,o){this.visboprojectversionService=t,this.visboprojectService=e,this.messageService=i,this.alertService=n,this.route=s,this.router=r,this.translate=o,this.deleted=!1,this.combinedPerm=void 0,this.permVC=Iv,this.permVP=Sv}ngOnInit(){this.getVisboProjectVersions()}hasVPPerm(t){return void 0!==this.combinedPerm&&0!=(this.combinedPerm.vp&t)}hasVCPerm(t){return void 0!==this.combinedPerm&&0!=(this.combinedPerm.vc&t)}getVisboProjectVersions(){const t=this.route.snapshot.paramMap.get("id");this.vpSelected=t,this.log("get VP name if ID is used "+t),t?this.visboprojectService.getVisboProject(t).subscribe(e=>{this.vpActive=e,this.combinedPerm=e.perm,this.log(`get VP name if ID is used ${this.vpActive.name} Perm ${JSON.stringify(this.combinedPerm)}`),this.visboprojectversionService.getVisboProjectVersions(t,this.deleted).subscribe(t=>this.visboprojectversions=t,t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpv.msg.errorPermVersion",{name:this.vpActive.name});this.alertService.error(t)}else this.alertService.error(Gh(t))})},t=>{if(this.log(`get VPV VP failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpv.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Gh(t))}):(this.vpSelected=null,this.vpActive=null,this.visboprojectversionService.getVisboProjectVersions(null).subscribe(t=>this.visboprojectversions=t,t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpv.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Gh(t))}))}toggleVisboProjectVersions(){this.deleted=!this.deleted;const t=this.route.snapshot.url.join("/");this.log(`VP toggleVisboProjectVersions ${this.deleted} URL ${t}`),this.getVisboProjectVersions(),this.router.navigate([t],this.deleted?{queryParams:{deleted:this.deleted}}:{})}checkLocked(t,e=!1){const i=t.variantName||"",n=this.vpActive.lock.find(t=>t.variantName===i);let s=void 0;return n&&(s=e?JSON.parse(localStorage.getItem("currentUser")).email!=n.email?n.email:void 0:n.email),s}helperSetVPV(t){this.visboprojectversion=this.visboprojectversions[t]}delete(t){this.log("delete VPV "+t._id),this.visboprojectversionService.deleteVisboProjectVersion(t,this.deleted).subscribe(()=>{this.alertService.success(`Visbo Project Version ${t._id} deleted successfully`,!0),this.log("delete VPV success");const e=this.visboprojectversions.findIndex(e=>e._id===t._id);e>=0&&this.visboprojectversions.splice(e,1)},e=>{if(this.log(`delete VPV failed: error: ${e.status} message: ${e.error.message}`),403===e.status){const e=this.translate.instant("vpv.msg.errorPermDelete",{name:t.name});this.alertService.error(e)}else if(423===e.status){const e=this.translate.instant("vpv.msg.errorLocked",{name:t.name});this.alertService.error(e)}else this.alertService.error(Gh(e))})}restore(){this.log("update VPV "+this.visboprojectversion._id),this.visboprojectversionService.updateVisboProjectVersion(this.visboprojectversion,this.deleted).subscribe(t=>{this.alertService.success(`Visbo Project Version ${t.name} updated successfully`,!0);const e=this.visboprojectversions.findIndex(e=>e._id===t._id);e>=0&&this.visboprojectversions.splice(e,1)},t=>{if(this.log(`save VPV failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpv.msg.errorPermVersion",{name:this.visboprojectversion.name});this.alertService.error(t)}else if(409===t.status){const t=this.translate.instant("vpv.msg.errorConflict",{name:this.visboprojectversion._id});this.alertService.error(t)}else this.alertService.error(t.error.message)})}gotoVPDetail(t){this.router.navigate(["vpDetail/".concat(t._id)])}gotoVCDetail(t){this.router.navigate(["vcDetail/".concat(t.vcid)])}sortVPVTable(t){this.visboprojectversions&&(void 0!==t&&(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?5===t:!this.sortAscending),1===this.sortColumn?this.visboprojectversions.sort((function(t,e){return Th(t.timestamp,e.timestamp)})):2===this.sortColumn?this.visboprojectversions.sort((function(t,e){return Th(t.endDate,e.endDate)})):3===this.sortColumn?this.visboprojectversions.sort((function(t,e){return t.ampelStatus-e.ampelStatus})):4===this.sortColumn?this.visboprojectversions.sort((function(t,e){return t.Erloes-e.Erloes})):5===this.sortColumn&&this.visboprojectversions.sort((function(t,e){return xh(t.variantName.toLowerCase(),e.variantName.toLowerCase())})),this.sortAscending||this.visboprojectversions.reverse())}log(t){this.messageService.add("VisboProjectVersion: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(xV),Rr(Vb),Rr(jh),Rr(Mf),Rr(Bg),Rr(rf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-visboprojectversions"]],decls:39,vars:27,consts:[[1,"well"],[1,"container"],[4,"ngIf"],[1,"row"],[1,"col","my-2"],["class","btn-group ",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[1,"d-none","d-md-table-cell"],[3,"click"],[1,"d-none","d-lg-table-cell"],[1,"d-none","d-lg-table-cell",3,"click"],[3,"click",4,"ngIf"],[1,"d-none","d-md-table-cell",3,"click"],[4,"ngFor","ngForOf"],["trafficLight",""],["class","modal fade","id","VpvDetails","tabindex","-1","role","dialog","aria-labelledby","Details Project Version","aria-hidden","true",4,"ngIf"],["class","modal fade","id","VpvDelete","tabindex","-1","role","dialog","aria-labelledby","Delete Project Version","aria-hidden","true",4,"ngIf"],[1,"panel-heading","bg-white","btn-white",3,"click"],[1,"btn-group"],["class","btn btn-sm btn-secondary m-2",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-secondary","m-2",3,"click"],["data-toggle","modal","data-target","#VpvDetails",3,"title","click"],["data-toggle","modal","data-target","#VpvDetails",1,"d-none","d-lg-table-cell",3,"click"],["data-toggle","modal","data-target","#VpvDetails",1,"d-none","d-md-table-cell",3,"click"],["id","ColDeleteVPV","class","Detail","data-toggle","modal","data-target","#VpvDelete",3,"title","click",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["id","ColDeleteVPV","data-toggle","modal","data-target","#VpvDelete",1,"Detail",3,"title","click"],[3,"ngClass"],["id","VpvDetails","tabindex","-1","role","dialog","aria-labelledby","Details Project Version","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VpvDeleteTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group","v_compact_t","row"],["for","VpvName",1,"col-sm-4","col-form-label"],[1,"col-sm-8","form-control-static","pt-2"],["for","VpvVersions",1,"col-sm-4","col-form-label"],["for","VpvUpdated",1,"col-sm-4","col-form-label"],["class","form-group v_compact_t row",4,"ngIf"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["class","btn btn-primary","data-dismiss","modal",3,"click",4,"ngIf"],["for","VpvVariant",1,"col-sm-4","col-form-label"],["for","VpvStart",1,"col-sm-4","col-form-label"],["for","VpvEnd",1,"col-sm-4","col-form-label"],["for","VpvStatus",1,"col-sm-4","col-form-label"],["for","VpvBU",1,"col-sm-4","col-form-label"],["data-dismiss","modal",1,"btn","btn-primary",3,"click"],["id","VpvDelete","tabindex","-1","role","dialog","aria-labelledby","Delete Project Version","aria-hidden","true",1,"modal","fade"],["class","bg-warning",4,"ngIf"],["class","bg-danger text-white",4,"ngIf"],[1,"form-group","row"],[1,"col-sm-8","form-control-static"],["type","button","class","btn btn-warning text-white","data-dismiss","modal",3,"click",4,"ngIf"],["type","button","class","btn btn-danger text-white","data-dismiss","modal",3,"click",4,"ngIf"],[1,"bg-warning"],[1,"bg-danger","text-white"],["type","button","data-dismiss","modal",1,"btn","btn-warning","text-white",3,"click"],["type","button","data-dismiss","modal",1,"btn","btn-danger","text-white",3,"click"]],template:function(t,e){1&t&&(Br(0,"app-usernavbar"),Nr(1,"div",0),Nr(2,"div",1),Lr(3,uD,3,3,"h2",2),Lr(4,hD,5,4,"h2",2),Nr(5,"div",3),Nr(6,"div",4),Lr(7,mD,5,5,"h5",2),Fr(),Lr(8,bD,3,2,"div",5),Fr(),Fr(),Nr(9,"div",6),Nr(10,"table",7),Nr(11,"thead"),Nr(12,"tr"),Nr(13,"th",8),mo(14),Ua(15,"translate"),Fr(),Nr(16,"th",9),Jr("click",(function(){return e.sortVPVTable(1)})),mo(17),Ua(18,"translate"),Fr(),Nr(19,"th",10),mo(20),Ua(21,"translate"),Fr(),Nr(22,"th",11),Jr("click",(function(){return e.sortVPVTable(2)})),mo(23),Ua(24,"translate"),Fr(),Lr(25,yD,3,3,"th",12),Nr(26,"th",13),Jr("click",(function(){return e.sortVPVTable(5)})),mo(27),Ua(28,"translate"),Fr(),Nr(29,"th",10),mo(30),Ua(31,"translate"),Fr(),Lr(32,CD,3,3,"th",2),Fr(),Fr(),Nr(33,"tbody"),Lr(34,kD,20,18,"tr",14),Fr(),Fr(),Fr(),Fr(),Lr(35,MD,1,7,"ng-template",null,15,ja),Lr(37,OD,42,30,"div",16),Lr(38,jD,41,28,"div",17)),2&t&&(_n(3),jr("ngIf",!e.vpActive),_n(1),jr("ngIf",e.vpActive),_n(3),jr("ngIf",e.vpActive),_n(1),jr("ngIf",e.hasVPPerm(e.permVP.DeleteVP)),_n(6),fo(Oa(15,15,"vpv.lbl.nr")),_n(3),fo(Oa(18,17,"vpv.lbl.timestamp")),_n(3),fo(Oa(21,19,"vpv.lbl.status")),_n(3),fo(Oa(24,21,"vpv.lbl.endDate")),_n(2),jr("ngIf",e.hasVPPerm(e.permVP.ViewAudit)),_n(2),fo(Oa(28,23,"vpv.lbl.variant")),_n(3),fo(Oa(31,25,"vpv.lbl.locked")),_n(2),jr("ngIf",e.hasVPPerm(e.permVP.DeleteVP)),_n(2),jr("ngForOf",e.visboprojectversions),_n(3),jr("ngIf",e.visboprojectversion),_n(1),jr("ngIf",e.visboprojectversion))},directives:[Pb,jc,Gc,Bc,Ec,Eu,Fd,Tu],pipes:[lv,qc],styles:[".v_compact_t[_ngcontent-%COMP%]{margin:0;padding-top:0}"]}),t})();function ND(t,e){if(1&t){const t=zr();Nr(0,"div",19),Jr("click",(function(){ei(t);const e=Xr().$implicit;return Xr(3).switchPFVersion(e.version)})),mo(1),Fr()}if(2&t){const t=Xr().$implicit;_n(1),vo("",t.name," ")}}function FD(t,e){if(1&t){const t=zr();Nr(0,"div",20),Jr("click",(function(){ei(t);const e=Xr().$implicit;return Xr(3).switchPFVersion(e.version)})),mo(1),Fr()}if(2&t){const t=Xr().$implicit;_n(1),vo("",t.name," ")}}function BD(t,e){if(1&t&&(Nr(0,"a",16),Lr(1,ND,2,1,"div",17),Lr(2,FD,2,1,"div",18),Fr()),2&t){const t=e.$implicit,i=Xr(3);to("title",t.email),_n(1),jr("ngIf",i.checkVPFActive(t)),_n(1),jr("ngIf",!i.checkVPFActive(t))}}function HD(t,e){if(1&t&&(Nr(0,"span",12),Nr(1,"a",13),mo(2),Fr(),Nr(3,"div",14),Lr(4,BD,3,3,"a",15),Fr(),Fr()),2&t){const t=Xr(2);_n(2),fo(t.getVariantName(t.vpfActive,!1,!0)),_n(2),jr("ngForOf",t.dropDown)}}function KD(t,e){if(1&t){const t=zr();Nr(0,"a",10),Jr("click",(function(){ei(t);const e=Xr(3);return e.gotoVC(e.vpActive)})),mo(1),Fr()}if(2&t){const t=Xr(3);_n(1),fo(t.vpActive.vc.name)}}function qD(t,e){if(1&t&&(Nr(0,"span"),mo(1),Fr()),2&t){const t=Xr(3);_n(1),fo(t.vpActive.vc.name)}}function zD(t,e){if(1&t&&(Nr(0,"h5"),mo(1),Ua(2,"translate"),Lr(3,KD,2,1,"a",21),Lr(4,qD,2,1,"span",4),Fr()),2&t){const t=Xr(2);_n(1),vo("",Oa(2,3,"vpfVersion.titleVC"),": "),_n(2),jr("ngIf",t.hasVCPerm(t.permVC.View)),_n(1),jr("ngIf",!t.hasVCPerm(t.permVC.View))}}function QD(t,e){if(1&t){const t=zr();Nr(0,"div",8),Nr(1,"div",9),Nr(2,"h2"),mo(3),Ua(4,"translate"),Nr(5,"a",10),Jr("click",(function(){ei(t);const e=Xr();return e.gotoVPDetail(e.vpActive)})),mo(6),Fr(),Lr(7,HD,5,2,"span",11),Fr(),Lr(8,zD,5,5,"h5",4),Fr(),Fr()}if(2&t){const t=Xr();_n(3),vo(" ",Oa(4,4,"vpfVersion.title"),": "),_n(3),vo(" ",t.vpActive.name,""),_n(1),jr("ngIf",t.dropDown.length>1&&!t.getPreView()),_n(1),jr("ngIf",t.vpActive)}}const WD=function(t){return{refDate:t}};function JD(t,e){if(1&t){const t=zr();Nr(0,"span",33),Jr("click",(function(){return ei(t),Xr(3).getNextVersion(-1)})),Ua(1,"translate"),Ua(2,"date"),Fr()}if(2&t){const t=Xr(3);to("title",Ea(1,1,"vpfVersion.lbl.previousPeriod",ka(7,WD,Ea(2,4,t.vpvRefDate,"dd.MM."))))}}function YD(t,e){if(1&t){const t=zr();Nr(0,"select",34),Jr("ngModelChange",(function(e){return ei(t),Xr(3).refDateInterval=e})),Nr(1,"option",35),mo(2),Ua(3,"translate"),Fr(),Nr(4,"option",36),mo(5),Ua(6,"translate"),Fr(),Nr(7,"option",37),mo(8),Ua(9,"translate"),Fr(),Nr(10,"option",38),mo(11),Ua(12,"translate"),Fr(),Fr()}2&t&&(jr("ngModel",Xr(3).refDateInterval),_n(2),fo(Oa(3,5,"vpfVersion.lbl.day")),_n(3),fo(Oa(6,7,"vpfVersion.lbl.week")),_n(3),fo(Oa(9,9,"vpfVersion.lbl.month")),_n(3),fo(Oa(12,11,"vpfVersion.lbl.quarter")))}function ZD(t,e){if(1&t){const t=zr();Nr(0,"span",39),Jr("click",(function(){return ei(t),Xr(3).getNextVersion(1)})),Ua(1,"translate"),Ua(2,"date"),Fr()}if(2&t){const t=Xr(3);to("title",Ea(1,1,"vpfVersion.lbl.nextPeriod",ka(7,WD,Ea(2,4,t.vpvRefDate,"dd.MM."))))}}function XD(t,e){if(1&t&&(Nr(0,"div",29),Nr(1,"div",8),Lr(2,JD,3,9,"span",30),Lr(3,YD,13,13,"select",31),Lr(4,ZD,3,9,"span",32),Fr(),Fr()),2&t){const t=Xr(2);_n(2),jr("ngIf",t.statusDirection>=0),_n(1),jr("ngIf",null!=t.statusDirection),_n(1),jr("ngIf",t.statusDirection<=0)}}function tM(t,e){if(1&t){const t=zr();Nr(0,"button",42),Jr("click",(function(){return ei(t),Xr(3).changeView("Capacity")})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpfVersion.btn.viewCapacity")))}function eM(t,e){if(1&t){const t=zr();Nr(0,"button",46),Jr("click",(function(){ei(t);const e=Xr(3);return e.initProjectList(e.vpActive)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpfVersion.btn.editPFList")))}function iM(t,e){if(1&t){const t=zr();Nr(0,"div",40),Nr(1,"div",41),Nr(2,"button",42),Jr("click",(function(){return ei(t),Xr(2).changeView("KeyMetrics")})),mo(3),Ua(4,"translate"),Fr(),Nr(5,"button",42),Jr("click",(function(){return ei(t),Xr(2).changeView("List")})),mo(6),Ua(7,"translate"),Fr(),Lr(8,tM,3,3,"button",43),Nr(9,"button",42),Jr("click",(function(){return ei(t),Xr(2).changeView("ProjectBoard")})),mo(10),Ua(11,"translate"),Fr(),Fr(),Nr(12,"div",44),Lr(13,eM,3,3,"button",45),Fr(),Fr()}if(2&t){const t=Xr(2);_n(3),fo(Oa(4,5,"vpfVersion.btn.viewKeyMetrics")),_n(3),fo(Oa(7,7,"vpfVersion.btn.viewList")),_n(2),jr("ngIf",t.hasVPPerm(t.permVP.Modify+t.permVP.ViewAudit)&&t.hasOrga),_n(2),fo(Oa(11,9,"vpfVersion.btn.viewProjectBoard")),_n(3),jr("ngIf",t.hasVPPerm(t.permVP.Modify))}}const nM=function(t,e){return{count:t,total:e}};function sM(t,e){if(1&t&&(Nr(0,"div",47),mo(1),Ua(2,"translate"),Fr()),2&t){const t=Xr(2);_n(1),vo(" ",Ea(2,1,"vpfVersion.msg.warningVersionMismatch",Da(4,nM,t.vpvCount,t.vpList.length))," ")}}function rM(t,e){if(1&t&&(Nr(0,"div",22),Nr(1,"div",8),Nr(2,"h3",23),Nr(3,"div",24),mo(4),Ua(5,"translate"),Ua(6,"date"),Fr(),Nr(7,"div",25),mo(8),Ua(9,"translate"),Ua(10,"date"),Fr(),Fr(),Lr(11,XD,5,3,"div",26),Fr(),Lr(12,iM,14,11,"div",27),Lr(13,sM,3,7,"div",28),Fr()),2&t){const t=Xr();_n(4),bo("",Oa(5,7,"vpfVersion.titleKM")," ",Ea(6,9,t.vpvRefDate,"dd.MM.yyyy"),""),_n(4),bo("",Oa(9,12,"vpfVersion.titleKMShort"),": ",Ea(10,14,t.vpvRefDate,"dd.MM."),""),_n(3),jr("ngIf",!t.getPreView()),_n(1),jr("ngIf",!t.getPreView()),_n(1),jr("ngIf",t.isVersionMismatch())}}function oM(t,e){if(1&t){const t=zr();Nr(0,"div",50),Nr(1,"button",51),Jr("click",(function(){ei(t);const e=Xr(2);return e.initProjectList(e.vpActive)})),mo(2),Ua(3,"translate"),Fr(),Fr()}2&t&&(_n(2),fo(Oa(3,1,"vpfVersion.btn.editPFList")))}function aM(t,e){if(1&t&&(Nr(0,"div",48),mo(1),Ua(2,"translate"),Lr(3,oM,4,3,"div",49),Fr()),2&t){const t=Xr();_n(1),vo(" ",Oa(2,2,"vpfVersion.msg.noProjectList")," "),_n(2),jr("ngIf",t.hasVPPerm(t.permVP.Modify))}}function lM(t,e){if(1&t&&(Nr(0,"div"),Br(1,"hr"),Br(2,"app-comp-viewcapacity",52),Fr()),2&t){const t=Xr();_n(2),jr("vpActive",t.vpActive)("vpfActive",t.vpfActive)("refDate",t.vpvRefDate)("combinedPerm",t.combinedPerm)}}function cM(t,e){if(1&t&&(Nr(0,"div"),Br(1,"hr"),Br(2,"app-comp-viewbubble",53),Fr()),2&t){const t=Xr();_n(2),jr("bubbleMode",!0)("visboprojectversions",t.visboprojectversions)("combinedPerm",t.combinedPerm)}}function dM(t,e){if(1&t&&(Nr(0,"div"),Br(1,"hr"),Br(2,"app-comp-viewbubble",53),Fr()),2&t){const t=Xr();_n(2),jr("bubbleMode",!1)("visboprojectversions",t.visboprojectversions)("combinedPerm",t.combinedPerm)}}function uM(t,e){if(1&t&&(Nr(0,"div"),Br(1,"hr"),Br(2,"app-comp-viewboard",54),Fr()),2&t){const t=Xr();_n(2),jr("vps",t.vpList)}}function hM(t,e){if(1&t){const t=zr();Nr(0,"a",20),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(3).switchEditVariant(i.version)})),mo(1),Ua(2,"translate"),Fr()}if(2&t){const t=e.$implicit;_n(1),fo(Oa(2,1,t.name||"vpfVersion.lbl.defaultVariant"))}}function pM(t,e){if(1&t&&(Nr(0,"div",74),mo(1),Ua(2,"translate"),Nr(3,"a",13),mo(4),Fr(),Nr(5,"div",14),Lr(6,hM,3,3,"a",75),Fr(),Fr()),2&t){const t=Xr(2);_n(1),vo(" ",Oa(2,3,"vpfVersion.lbl.variant"),": "),_n(3),fo(t.getVariantName(void 0,!0,!1)),_n(2),jr("ngForOf",t.dropDownVariant)}}function gM(t,e){1&t&&Br(0,"td",87)}function mM(t,e){if(1&t&&(Nr(0,"option"),mo(1),Fr()),2&t){const t=e.$implicit;_n(1),fo(t)}}function fM(t,e){if(1&t){const t=zr();Nr(0,"td",87),Nr(1,"div",8),Nr(2,"select",90),Jr("ngModelChange",(function(e){return ei(t),Xr().$implicit.variantName=e})),Nr(3,"option",91),mo(4),Ua(5,"translate"),Fr(),Lr(6,mM,2,1,"option",84),Fr(),Nr(7,"span",92),Jr("click",(function(){ei(t);const e=Xr().index;return Xr(3).initVariantChange(e)})),Ua(8,"translate"),Fr(),Fr(),Fr()}if(2&t){const t=Xr().$implicit,e=Xr(3);_n(2),jr("ngModel",t.variantName),_n(2),fo(Oa(5,4,"vpfVersion.lbl.defaultVariant")),_n(2),jr("ngForOf",e.getVariants(t.vp)),_n(1),to("title",Oa(8,6,"vpfVersion.lbl.changeVPVariant"))}}function vM(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td",85),Nr(2,"input",86),Jr("ngModelChange",(function(i){return ei(t),e.$implicit.isChecked=i})),Fr(),Fr(),Nr(3,"td",87),Nr(4,"a"),mo(5),Fr(),Fr(),Lr(6,gM,1,0,"td",88),Lr(7,fM,9,8,"td",88),Nr(8,"td",89),mo(9),Ua(10,"date"),Fr(),Fr()}if(2&t){const t=e.$implicit;_n(2),jr("ngModel",t.isChecked),_n(3),fo(t.vp.name),_n(1),jr("ngIf",!t.hasVariants),_n(1),jr("ngIf",t.hasVariants),_n(2),fo(Ea(10,5,t.vp.updatedAt,"dd.MM.yy"))}}function bM(t,e){if(1&t){const t=zr();Nr(0,"table",76),Nr(1,"thead",77),Nr(2,"tr"),Nr(3,"th",78),Nr(4,"input",79),Jr("ngModelChange",(function(e){return ei(t),Xr(2).isGlobalChecked=e}))("change",(function(){return ei(t),Xr(2).globalChecked()})),Fr(),Nr(5,"span",10),Jr("click",(function(){return ei(t),Xr(2).sortVPTable(3)})),mo(6),Ua(7,"translate"),Fr(),Fr(),Nr(8,"th",80),Jr("click",(function(){return ei(t),Xr(2).sortVPTable(1)})),mo(9),Ua(10,"translate"),Fr(),Nr(11,"th",81),Jr("click",(function(){return ei(t),Xr(2).sortVPTable(4)})),mo(12),Ua(13,"translate"),Fr(),Nr(14,"th",82),Jr("click",(function(){return ei(t),Xr(2).sortVPTable(2)})),mo(15),Ua(16,"translate"),Fr(),Fr(),Fr(),Nr(17,"tbody",83),Lr(18,vM,11,8,"tr",84),Fr(),Fr()}if(2&t){const t=Xr(2);_n(4),jr("ngModel",t.isGlobalChecked),_n(2),vo(" ",Oa(7,6,"vpfVersion.lbl.isChecked"),""),_n(3),fo(Oa(10,8,"vpfVersion.lbl.name")),_n(3),fo(Oa(13,10,"vpfVersion.lbl.variant")),_n(3),fo(Oa(16,12,"vpfVersion.lbl.modified")),_n(3),jr("ngForOf",t.vpCheckListFiltered)}}function yM(t,e){1&t&&(Nr(0,"button",93),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpfVersion.btn.delete")))}const CM=function(t,e){return{name:t,from:e}};function VM(t,e){if(1&t){const t=zr();Nr(0,"div",55),Nr(1,"div",56),Nr(2,"div",57),Nr(3,"div",58),Nr(4,"h5",59),mo(5),Ua(6,"translate"),Ua(7,"date"),Fr(),Nr(8,"button",60),Nr(9,"span",61),mo(10,"\xd7"),Fr(),Fr(),Fr(),Nr(11,"div",62),Nr(12,"div",63),Lr(13,pM,7,5,"div",64),Nr(14,"div",65),Nr(15,"span"),mo(16),Ua(17,"translate"),Fr(),Nr(18,"input",66),Jr("keyup",(function(e){return ei(t),Xr().filterKeyBoardEvent(e)}))("ngModelChange",(function(e){return ei(t),Xr().vpfListFilter=e})),Fr(),Nr(19,"a",67),Jr("click",(function(){return ei(t),Xr().filterVPList(!0)})),Br(20,"i",68),Fr(),Fr(),Fr(),Lr(21,bM,19,14,"table",69),Fr(),Nr(22,"div",70),Nr(23,"button",71),mo(24),Ua(25,"translate"),Fr(),Lr(26,yM,3,3,"button",72),Nr(27,"button",73),Jr("click",(function(){return ei(t),Xr().updateVPF()})),mo(28),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr();_n(5),fo(Ea(6,8,"vpfVersion.titleVPList",Da(18,CM,t.vpActive.name,Ea(7,11,t.vpfActive?t.vpfActive.timestamp:t.vpActive.updatedAt,"dd.MM.yyyy")))),_n(8),jr("ngIf",t.dropDownVariant.length>1),_n(3),vo(" ",Oa(17,14,"vpfVersion.lbl.filter"),":"),_n(2),jr("ngModel",t.vpfListFilter),_n(3),jr("ngIf",t.vpCheckListFiltered.length>0),_n(3),fo(Oa(25,16,"vpfVersion.btn.back")),_n(2),jr("ngIf",t.hasVPPerm(t.permVP.DeleteVP)),_n(2),fo(t.saveVPFString())}}function wM(t,e){if(1&t&&(Nr(0,"div",97),Nr(1,"label",98),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",99),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpfVersion.lbl.variant"),":"),_n(3),fo(t.vpfActive.variantName)}}function AM(t,e){if(1&t&&(Nr(0,"div",97),Nr(1,"label",98),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",99),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpfVersion.lbl.nrOfItems"),":"),_n(3),fo(t.vpfActive.allItems.length)}}function PM(t,e){if(1&t&&(Nr(0,"div",97),Nr(1,"label",98),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",99),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpfVersion.lbl.user"),":"),_n(3),fo(t.vpfActive.updatedFrom.email)}}function kM(t,e){if(1&t){const t=zr();Nr(0,"button",102),Jr("click",(function(){ei(t);const e=Xr(2);return e.deleteVPF(e.vpfActive)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpfVersion.btn.delete")))}function DM(t,e){if(1&t&&(Nr(0,"div",94),Nr(1,"div",56),Nr(2,"div",57),Nr(3,"div",58),Nr(4,"h5",95),mo(5),Ua(6,"translate"),Ua(7,"date"),Fr(),Nr(8,"button",60),Nr(9,"span",61),mo(10,"\xd7"),Fr(),Fr(),Fr(),Nr(11,"div",62),Nr(12,"div"),Nr(13,"label",96),mo(14),Ua(15,"translate"),Fr(),Fr(),Nr(16,"form"),Nr(17,"div",97),Nr(18,"label",98),mo(19),Ua(20,"translate"),Fr(),Nr(21,"label",99),mo(22),Fr(),Fr(),Lr(23,wM,6,4,"div",100),Nr(24,"div",97),Nr(25,"label",98),mo(26),Ua(27,"translate"),Fr(),Nr(28,"label",99),mo(29),Ua(30,"date"),Fr(),Fr(),Lr(31,AM,6,4,"div",100),Lr(32,PM,6,4,"div",100),Fr(),Fr(),Nr(33,"div",70),Nr(34,"button",71),mo(35),Ua(36,"translate"),Fr(),Lr(37,kM,3,3,"button",101),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr();_n(5),fo(Ea(6,11,"vpfVersion.titleVPList",Da(28,CM,t.vpfActive.name,Ea(7,14,t.vpfActive.timestamp,"dd.MM.yyyy")))),_n(9),fo(Oa(15,17,"vpfVersion.msg.removeVPFConfirm")),_n(5),vo("",Oa(20,19,"vpfVersion.lbl.name"),":"),_n(3),vo("",t.vpfActive.name," "),_n(1),jr("ngIf",t.vpfActive.variantName),_n(3),vo("",Oa(27,21,"vpfVersion.lbl.from"),":"),_n(3),vo("",Ea(30,23,t.vpfActive.timestamp,"dd.MM.yyyy")," "),_n(2),jr("ngIf",t.vpfActive.allItems.length>0),_n(1),jr("ngIf",t.vpfActive.updatedFrom),_n(3),fo(Oa(36,26,"vpfVersion.btn.back")),_n(2),jr("ngIf",t.hasVPPerm(t.permVP.DeleteVP))}}const MM=function(t,e){return{name:t,count:e}};function IM(t,e){if(1&t&&(Nr(0,"label",96),mo(1),Ua(2,"translate"),Fr()),2&t){const t=Xr(2);_n(1),fo(Ea(2,1,"vpfVersion.msg.changeVPVariant",Da(4,MM,t.switchVariant,t.switchVariantCount)))}}const SM=function(t){return{count:t}};function xM(t,e){if(1&t&&(Nr(0,"label",96),mo(1),Ua(2,"translate"),Fr()),2&t){const t=Xr(2);_n(1),fo(Ea(2,1,"vpfVersion.msg.changeVPVariantStandard",ka(4,SM,t.switchVariantCount)))}}const TM=function(t){return{name:t}};function _M(t,e){if(1&t){const t=zr();Nr(0,"div",103),Nr(1,"div",104),Nr(2,"div",57),Nr(3,"div",58),Nr(4,"h5",105),mo(5),Ua(6,"translate"),Fr(),Nr(7,"button",60),Nr(8,"span",61),mo(9,"\xd7"),Fr(),Fr(),Fr(),Nr(10,"div",62),Nr(11,"div"),Lr(12,IM,3,7,"label",106),Lr(13,xM,3,6,"label",106),Fr(),Fr(),Nr(14,"div",70),Nr(15,"button",107),mo(16),Ua(17,"translate"),Fr(),Nr(18,"button",108),Jr("click",(function(){return ei(t),Xr().changeVPVariant()})),mo(19),Ua(20,"translate"),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr();_n(5),fo(Ea(6,5,"vpfVersion.titleChangeVPVariant",ka(12,TM,t.vpfActive.name))),_n(7),jr("ngIf",t.switchVariant),_n(1),jr("ngIf",!t.switchVariant),_n(3),fo(Oa(17,8,"vpfVersion.btn.back")),_n(3),fo(Oa(20,10,"vpfVersion.btn.update"))}}class UM{}let OM=(()=>{class t{constructor(t,e,i,n,s,r,o,a,l,c,d){this.visboprojectversionService=t,this.visboprojectService=e,this.visbosettingService=i,this.messageService=n,this.alertService=s,this.route=r,this.authenticationService=o,this.router=a,this.translate=l,this.datePipe=c,this.titleService=d,this.dropDown=[],this.dropDownVariant=[],this.views=["KeyMetrics","Capacity","ProjectBoard","List"],this.vpvRefDate=new Date,this.refDateInterval="month",this.deleted=!1,this.vpCheckListAll=[],this.vpCheckListFiltered=[],this.hasOrga=!1,this.pageParams=new DV,this.isGlobalChecked=!1,this.combinedPerm=void 0,this.permVC=Iv,this.permVP=Sv}ngOnInit(){this.currentLang=this.translate.currentLang,this.user=this.authenticationService.getActiveUser(),this.titleService.setTitle(this.translate.instant("vpfVersion.title")),this.log("Init VPF with Transaltion: "+this.translate.instant("vpfVersion.title")),localStorage.removeItem("vpfFilter");const t=this.route.snapshot.queryParams.refDate,e=this.route.snapshot.queryParams.view||"KeyMetrics",i=this.route.snapshot.queryParams.vpfid||void 0,n=this.route.snapshot.queryParams.filter||null;this.vpfid=i,this.vpvRefDate=Date.parse(t)>0?new Date(t):new Date,this.changeView(e,t?this.vpvRefDate:void 0,n,i,!1),this.getVisboProject()}ngOnChanges(t){this.log("Portfolio Changes "+JSON.stringify(t))}hasVPPerm(t){var e;return((null===(e=this.combinedPerm)||void 0===e?void 0:e.vp)&t)>0}hasVCPerm(t){var e;let i=!1;return((null===(e=this.combinedPerm)||void 0===e?void 0:e.vc)&t)>0&&(i=!0),i}getVisboProject(){const t=this.route.snapshot.paramMap.get("id");this.vpSelected=t,this.log("get VP name if ID is used "+t),this.visboprojectService.getVisboProject(t).subscribe(t=>{this.vpActive=t,this.deleted=!!t.deletedAt,this.combinedPerm=t.perm,this.titleService.setTitle(this.translate.instant("vpfVersion.titleName",{name:t.name})),this.getVisboPortfolioVersions(),this.getVisboCenterOrga()},t=>{if(this.log(`get Portfolio VP failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpfVersion.msg.errorPermVP");this.alertService.error(t)}else this.alertService.error(Gh(t))})}initProjectList(t){this.vpfListFilter=void 0,t||t.vcid?this.visboprojectService.getVisboProjects(t.vcid,!1,!1).subscribe(t=>{this.initVPF(t)},t=>{this.log(`get VPs failed: error:  ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))}):this.log("No Portfolio found")}getVisboCenterOrga(){this.vpActive&&this.combinedPerm&&(this.combinedPerm.vc&this.permVC.View)>0&&(this.log("get VC Orga "+this.vpActive.vcid),this.visbosettingService.getVCOrganisations(this.vpActive.vcid,!1,void 0,!0).subscribe(t=>{this.hasOrga=t.length>0},t=>{if(403===t.status){const t=this.translate.instant("vpfVersion.msg.errorPermVP");this.alertService.error(t)}else this.alertService.error(Gh(t))}))}getVisboPortfolioVersions(){this.log(`get Portfolio Versions ${this.vpActive.name} Perm ${JSON.stringify(this.combinedPerm)}`),this.visboprojectversionService.getVisboPortfolioVersions(this.vpActive._id,this.deleted).subscribe(t=>{this.visboportfolioversions=t;let e=0;this.vpfid&&(e=t.findIndex(t=>t._id.toString()===this.vpfid),e<0&&(e=0)),t.length>0&&(this.vpfActive=t[e],this.dropDownInit(),this.getVisboPortfolioKeyMetrics(),this.log("get VPF Length "+this.visboportfolioversions.length))},t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpfVersion.msg.errorPermVersion",{name:this.vpActive.name});this.alertService.error(t)}else this.alertService.error(Gh(t))})}getVisboPortfolioKeyMetrics(){this.log(`get VPF keyMetrics ${this.vpfActive.name} ${this.vpfActive._id}`),this.visboprojectversionService.getVisboPortfolioKeyMetrics(this.vpfActive._id,this.vpvRefDate).subscribe(t=>{var e;this.visboprojectversions=t,this.calcVPList(),this.log(`get VPF Key metrics: Get ${t.length} Project Versions`),t.length>0&&this.log(`First VPV: ${t[0]._id} ${t[0].timestamp} ${null===(e=t[0].keyMetrics)||void 0===e?void 0:e.endDateCurrent} `),this.evaluateDirection()},t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpfVersion.msg.errorPermVP");this.alertService.error(t)}else this.alertService.error(Gh(t))})}getRefDateVersions(t){this.log(`get getRefDateVersions ${this.vpvRefDate.toISOString()} ${this.refDateInterval} ${t}`);let e=new Date(this.vpvRefDate.getTime()),i=0;switch(this.refDateInterval){case"day":e.setHours(0,0,0,0),(t>0||e.getTime()===this.vpvRefDate.getTime())&&e.setDate(e.getDate()+t);break;case"week":e.setHours(0,0,0,0),e.setDate(e.getDate()+7*t);break;case"month":e.setHours(0,0,0,0),e.setDate(1),(t>0||e.getTime()===this.vpvRefDate.getTime())&&e.setMonth(e.getMonth()+t);break;case"quarter":i=Math.trunc(e.getMonth()/3),t>0&&(i+=t),e.setMonth(3*i),e.setDate(1),e.setHours(0,0,0,0),e.getTime()===this.vpvRefDate.getTime()&&e.setMonth(e.getMonth()+3*t)}const n=new Date;e>n&&(e=n),this.log("get getRefDateVersions "+e.toISOString()),this.vpvRefDate=new Date(e.toISOString()),this.changeView(void 0,this.vpvRefDate),this.getVisboPortfolioKeyMetrics()}initVPF(t){this.dropDownVariantSelected=this.vpfActive?this.vpfActive.variantName:"",this.isGlobalChecked=!1,this.vpCheckListAll=[],t.forEach(t=>{if(0==t.vpType){const e=new UM,i=this.getVPFMember(t);i?(e.isChecked=!0,e.variantName=i.variantName):(e.isChecked=!1,e.variantName=""),e.vp=t,this.getVariants(t).length>0&&(e.hasVariants=!0),this.vpCheckListAll.push(e)}}),this.vpCheckListAll.sort((function(t,e){return xh(t.vp.name.toLowerCase(),e.vp.name.toLowerCase())})),this.filterVPList()}getVariants(t){const e=[];return t&&t.variant&&(t.variant.forEach(t=>{"pfv"!=t.variantName&&t.vpvCount>0&&e.push(t.variantName)}),e.sort((function(t,e){return xh(t.toLowerCase(),e.toLowerCase())}))),e}getVPFMember(t){let e;return this.vpfActive&&this.vpfActive.allItems&&(e=this.vpfActive.allItems.find(e=>e.vpid.toString()==t._id.toString())),e}globalChecked(){this.log("Switch Global Check "+this.isGlobalChecked),this.vpCheckListFiltered.forEach(t=>{t.isChecked=this.isGlobalChecked})}filterKeyBoardEvent(t){t||this.log("No Keyboard Event"),this.filterVPList()}filterVPList(t=!1){t&&(this.vpfListFilter=void 0);let e=!0;const i=[],n=this.vpfListFilter?this.vpfListFilter.toLowerCase():void 0;this.vpCheckListAll.forEach(t=>{(!n||t.vp.name.toLowerCase().indexOf(n)>=0||t.vp.variant.findIndex(t=>t.variantName.toLowerCase().indexOf(n)>=0)>=0)&&(t.isChecked||(e=!1),i.push(t))}),this.vpCheckListFiltered=i,this.isGlobalChecked=e}initVariantChange(t){if(this.log("init Change Variant of VPs "+t),t>=0&&t<this.vpCheckListFiltered.length){const e=this.vpCheckListFiltered[t];this.vpFilterIndex=t,this.log(`Found VP ${e.vp.name} Variant Selected ${e.variantName}`),this.switchVariantCount=0,this.switchVariant=e.variantName||"",e.variantName?(this.vpCheckListFiltered.forEach(t=>{t.vp&&t.vp.variant&&t.vp.variant.length>0&&t.vp.variant.forEach(t=>{t.variantName==e.variantName&&t.vpvCount>0&&(this.switchVariantCount+=1)})}),this.log(`Change to Variant ${e.variantName} for count ${this.switchVariantCount} VPs`)):(this.vpCheckListFiltered.forEach(t=>{t.variantName&&(this.switchVariantCount+=1)}),this.log(`Change to Standard for count ${this.switchVariantCount} VPs`))}}changeVPVariant(){this.log(`Change Variant ${this.switchVariant||"Standard"} of ${this.switchVariantCount} VPs`),this.vpCheckListFiltered.forEach(this.switchVariant?t=>{t.vp&&t.vp.variant&&t.vp.variant.length>0&&t.vp.variant.forEach(e=>{e.variantName==this.switchVariant&&(t.variantName=this.switchVariant)})}:t=>{t.variantName&&(t.variantName="")})}checkUpdateVPF(){var t;let e=!1;return this.vpfActive&&this.vpfActive.variantName==this.dropDownVariantSelected&&this.user._id==(null===(t=this.vpfActive.updatedFrom)||void 0===t?void 0:t.userId)&&Oh(new Date(this.vpfActive.timestamp))&&(e=!0),e}saveVPFString(){let t;return t=this.checkUpdateVPF()?this.translate.instant("vpfVersion.btn.update"):this.translate.instant("vpfVersion.btn.create"),t}updateVPF(){this.log("init VPF Item List");const t=new kV;t.allItems=[new PV],t.allItems.pop();let e=0;this.vpCheckListAll.forEach(i=>{if(i.isChecked){const n=new PV;n.vpid=i.vp._id,n.name=i.vp.name,n.variantName=i.variantName,n.show=!0,n.zeile=++e,t.allItems.push(n)}}),t.variantName=this.dropDownVariantSelected,this.checkUpdateVPF()?(this.log("update VPF List "+this.vpCheckListAll.length),t._id=this.vpfActive._id,this.visboprojectversionService.updateVisboPortfolioVersion(this.vpActive,t).subscribe(t=>{console.log("update VPF %s with ID %s VPF Len %s",t.name,t._id,t.allItems.length);const e=this.translate.instant("vpfVersion.msg.createVPFSuccess",{name:this.vpActive.name});this.alertService.success(e,!0),this.visboportfolioversions.findIndex(e=>e._id==t._id)>=0&&(this.vpfActive=t,this.getVisboPortfolioKeyMetrics())},t=>{if(this.log(`add VPF failed: error: ${t.status} messages: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpfVersion.msg.errorVPFPerm",{name});this.alertService.error(t)}else this.alertService.error(Gh(t))})):(this.log("create VPF List "+this.vpCheckListAll.length),this.visboprojectversionService.addVisboPortfolioVersion(this.vpActive,t).subscribe(t=>{console.log("add VPF %s with ID %s VPF Len %s",t.name,t._id,t.allItems.length);const e=this.translate.instant("vpfVersion.msg.createVPFSuccess",{name:this.vpActive.name});this.alertService.success(e,!0),this.visboportfolioversions.push(t),this.vpfActive=t,this.dropDownInit(),this.getVisboPortfolioKeyMetrics()},t=>{if(this.log(`add VPF failed: error: ${t.status} messages: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpfVersion.msg.errorVPFPerm",{name});this.alertService.error(t)}else this.alertService.error(Gh(t))}))}deleteVPF(t){this.log(`Remove VisboPortfolioVersion: ${t.name} from:  ${t.timestamp}`),this.visboprojectversionService.deleteVisboPortfolioVersion(t).subscribe(()=>{const e=this.datePipe.transform(t.timestamp,"dd.MM.yy"),i=this.translate.instant("vpfVersion.msg.removeVPFSuccess",{name:t.name,from:e});let n=this.visboportfolioversions.findIndex(e=>e._id==t._id);this.visboportfolioversions.splice(n,1),n>=this.visboportfolioversions.length&&(n=this.visboportfolioversions.length-1),n>=0&&(this.dropDownInit(),this.switchPFVersion(n)),this.alertService.success(i)},e=>{if(this.log("Remove VisboPortfolioVersion error: "+e.error.message),403===e.status){const e=this.translate.instant("vpfVersion.msg.errorPerm",{name:t.name});this.alertService.error(e)}else this.log("Error during VisboPortfolioVersion "+e.error.message),this.alertService.error(Gh(e))})}getVariantName(t,e=!1,i=!1){let n="";return n=t?t.variantName||"":this.dropDownVariantSelected||"",""==n&&e&&(n=this.translate.instant("vpfVersion.lbl.defaultVariant")),n&&i&&(n="(".concat(n,")")),n}evaluateDirection(){this.statusDirection=0===this.visboprojectversions.length?Eh(this.vpvRefDate,new Date)?void 0:-1:Eh(this.vpvRefDate,new Date)?1:0}changeView(t,e,i,n,s=!0){t&&(this.views.findIndex(e=>e===t)<0&&(t=this.views[0]),this.pageParams.view=t),i?this.pageParams.filter=i.trim():null===i?delete this.pageParams.filter:this.pageParams.filter=localStorage.getItem("vpfFilter")||void 0,e&&(this.pageParams.refDate=Oh(e)?void 0:e.toISOString()),n&&(this.pageParams.vpfid=n),s&&this.updateUrlParam()}updateUrlParam(){const t=this.route.snapshot.url.join("/"),e=new DV;e.filter=this.pageParams.filter||null,e.vpfid=this.pageParams.vpfid||null,e.vpfid=this.pageParams.vpfid||null,e.refDate=this.pageParams.refDate||null,e.view=this.pageParams.view||null,this.router.navigate([t],{queryParams:e,replaceUrl:!0,queryParamsHandling:"merge"})}isVersionMismatch(){let t=!1;return this.vpList&&this.vpfActive&&this.vpfActive.allItems?(this.vpfActive.allItems.length!==this.vpvCount&&(t=!0),t):t}calcVPList(){var t;if(this.vpfActive||this.vpfActive.allItems){this.vpList=[],this.vpvCount=0;for(let e=0;e<this.vpfActive.allItems.length;e++){const i=new IV,n=this.vpfActive.allItems[e];i.vpid=n.vpid,i.name=n.name,i.variantName=n.variantName;const s=this.visboprojectversions.findIndex(t=>t.vpid===i.vpid);s>=0&&(i.timestamp=new Date(this.visboprojectversions[s].timestamp),i.startDate=this.visboprojectversions[s].startDate,i.endDate=(null===(t=this.visboprojectversions[s].keyMetrics)||void 0===t?void 0:t.endDateCurrent)||this.visboprojectversions[s].endDate,i.leadPerson=this.visboprojectversions[s].leadPerson,i.VorlagenName=this.visboprojectversions[s].VorlagenName,i.businessUnit=this.visboprojectversions[s].businessUnit,i.status=this.visboprojectversions[s].status,i.ampelStatus=this.visboprojectversions[s].ampelStatus,i.ampelErlaeuterung=this.visboprojectversions[s].ampelErlaeuterung,i.keyMetrics=this.visboprojectversions[s].keyMetrics,this.vpvCount+=1),this.vpList.push(i)}}}getNextVersion(t){this.getRefDateVersions(t),this.changeView(void 0,this.vpvRefDate)}gotoVPDetail(t){const e=!!t.deletedAt;this.log("goto Detail for VP "+t._id),this.router.navigate(["vpDetail/".concat(t._id)],e?{queryParams:{deleted:e}}:{})}gotoVC(t){this.router.navigate(["vp/".concat(t.vcid)])}dropDownInit(){this.log("Init Drop Down List "+this.visboportfolioversions.length),this.dropDown=[];const t=this.visboportfolioversions.length;for(let e=0;e<t;e++){const t=new Date(this.visboportfolioversions[e].timestamp);let i="Version ".concat("from ",_h(new Date(t),"fullDate",this.currentLang));this.visboportfolioversions[e].variantName&&(i=i.concat(" ( ",this.visboportfolioversions[e].variantName," )")),this.dropDown.push({name:i,version:e,variantName:this.visboportfolioversions[e].variantName,timestamp:t,email:this.visboportfolioversions[e].updatedFrom&&this.visboportfolioversions[e].updatedFrom.email||""})}this.dropDown.sort((function(t,e){return e.timestamp.getTime()-t.timestamp.getTime()})),t>0&&(this.dropDownSelected=this.dropDown[0].name),this.dropDownVariantInit()}checkVPFActive(t){let e=!1;return this.vpfActive&&t.variantName==this.vpfActive.variantName&&t.timestamp.getTime()==new Date(this.vpfActive.timestamp).getTime()&&(e=!0),e}dropDownVariantInit(){this.log("Init Variant Drop Down List "+this.vpActive.variant.length),this.dropDownVariant=[];let t=1;if(this.vpActive.variant.forEach(e=>{"pfv"!=e.variantName&&this.dropDownVariant.push({name:e.variantName,variantName:e.variantName,version:t++,timestamp:void 0,email:void 0})}),this.dropDownVariant.splice(0,0,{name:"",variantName:"",version:0,timestamp:void 0,email:void 0}),t=0,this.vpfActive.variantName){const e=this.dropDownVariant.findIndex(t=>t.name===this.vpfActive.variantName);e>=0&&(t=e)}this.dropDownVariantSelected=this.dropDownVariant[t].name}switchEditVariant(t){this.log(`Change Variant Drop Down ${t} `),t>=0&&t<this.dropDownVariant.length&&(this.dropDownVariantSelected=this.dropDownVariant[t].name)}switchPFVersion(t){this.log(`Change Drop Down ${t} `),this.vpfActive=this.visboportfolioversions[t],this.dropDownVariantSelected=this.vpfActive.variantName,this.getVisboPortfolioKeyMetrics(),this.changeView(void 0,void 0,void 0,this.vpfActive._id)}sortVPTable(t){if(void 0!==t){if(!this.vpCheckListAll)return;t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t||3===t:!this.sortAscending}1===this.sortColumn?this.vpCheckListFiltered.sort((function(t,e){return xh(t.vp.name.toLowerCase(),e.vp.name.toLowerCase())})):2===this.sortColumn?this.vpCheckListFiltered.sort((function(t,e){return Th(t.vp.updatedAt,e.vp.updatedAt)})):3===this.sortColumn?this.vpCheckListFiltered.sort((function(t,e){return(t.isChecked?0:1)-(e.isChecked?0:1)})):4===this.sortColumn&&this.vpCheckListFiltered.sort((function(t,e){const i=(e.hasVariants?"1":"0")+(e.variantName||"");return xh(((t.hasVariants?"1":"0")+(t.variantName||"")).toLowerCase(),i.toLowerCase())})),this.sortAscending||this.vpCheckListFiltered.reverse()}getPreView(){return Rh()}log(t){this.messageService.add("VisboPortfolioVersion: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(xV),Rr(Vb),Rr(Eb),Rr(jh),Rr(Mf),Rr(Bg),Rr(op),Rr(rf),Rr(av),Rr(qc),Rr(Md))},t.\u0275cmp=le({type:t,selectors:[["app-visboportfolio-versions"]],features:[_e],decls:12,vars:10,consts:[[1,"well"],["class","row",4,"ngIf"],["class","container-fluid",4,"ngIf"],["class","container-fluid text-danger",4,"ngIf"],[4,"ngIf"],["class","modal fade","id","VPFList","role","dialog","aria-labelledby","VPFListTitle","aria-hidden","true",4,"ngIf"],["class","modal fade","id","DeleteVPFList","role","dialog","aria-labelledby","DeleteVPFListTitle","aria-hidden","true",4,"ngIf"],["class","modal fade","id","ChangeVPVariant","role","dialog","aria-labelledby","ChangeVPVariantTitle","aria-hidden","true",4,"ngIf"],[1,"row"],[1,"col"],[3,"click"],["class","dropdown ml-2 d-print-none",4,"ngIf"],[1,"dropdown","ml-2","d-print-none"],["data-toggle","dropdown",1,"dropdown-toggle"],[1,"dropdown-menu"],[3,"title",4,"ngFor","ngForOf"],[3,"title"],["class","dropdown-item font-weight-bold",3,"click",4,"ngIf"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"dropdown-item","font-weight-bold",3,"click"],[1,"dropdown-item",3,"click"],[3,"click",4,"ngIf"],[1,"container-fluid"],[1,"col-6","px-0"],[1,"d-none","d-lg-block"],[1,"d-block","d-lg-none"],["class","col-4 d-print-none",4,"ngIf"],["class","row d-print-none",4,"ngIf"],["class","align-items-end text-warning text-right",4,"ngIf"],[1,"col-4","d-print-none"],["style","font-size: 2.2em","class","mx-1 fas fa-caret-square-left",3,"title","click",4,"ngIf"],["class","col-4 form-control","name","refDateInterval",3,"ngModel","ngModelChange",4,"ngIf"],["style","font-size: 2.2em","class","mx-1 fas fa-caret-square-right",3,"title","click",4,"ngIf"],[1,"mx-1","fas","fa-caret-square-left",2,"font-size","2.2em",3,"title","click"],["name","refDateInterval",1,"col-4","form-control",3,"ngModel","ngModelChange"],["value","day"],["value","week"],["value","month"],["value","quarter"],[1,"mx-1","fas","fa-caret-square-right",2,"font-size","2.2em",3,"title","click"],[1,"row","d-print-none"],[1,"col","btn-toolbar",2,"padding","unset"],["type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],[1,"align-items-end","btn-toolbar",2,"padding","unset"],["type","button","class","align-items-end btn btn-md btn-primary","data-toggle","modal","data-target","#VPFList",3,"click",4,"ngIf"],["type","button","data-toggle","modal","data-target","#VPFList",1,"align-items-end","btn","btn-md","btn-primary",3,"click"],[1,"align-items-end","text-warning","text-right"],[1,"container-fluid","text-danger"],["class","btn-toolbar my-3","style","padding: unset;",4,"ngIf"],[1,"btn-toolbar","my-3",2,"padding","unset"],["type","button","data-toggle","modal","data-target","#VPFList",1,"btn","btn-primary",3,"click"],[3,"vpActive","vpfActive","refDate","combinedPerm"],[3,"bubbleMode","visboprojectversions","combinedPerm"],[3,"vps"],["id","VPFList","role","dialog","aria-labelledby","VPFListTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VPFListTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"d-flex"],["class","dropdown","class","ml-2",4,"ngIf"],[1,"ml-auto"],["type","text","placeholder","Filter",1,"mb-2","ml-2",3,"ngModel","keyup","ngModelChange"],[1,"ml-2",3,"click"],[1,"far","fa-times-circle"],["class","table table-hover table-sortable",4,"ngIf"],[1,"modal-footer","align-items-end"],["data-dismiss","modal",1,"btn","btn-secondary"],["id","Delete","type","submit","class","btn btn-warning mx-1","data-dismiss","modal","data-toggle","modal","id","DeleteVPFListID","data-target","#DeleteVPFList",4,"ngIf"],["id","Save","type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],[1,"ml-2"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],[1,"table","table-hover","table-sortable"],["id","VPHead"],["id","SorChecked"],["type","checkbox",3,"ngModel","ngModelChange","change"],["id","SortName",3,"click"],["id","SortVariant",3,"click"],["id","SortDate",1,"d-none","d-md-table-cell",3,"click"],["id","VPList"],[4,"ngFor","ngForOf"],["id","ColChecked"],["type","checkbox",3,"ngModel","ngModelChange"],["id","ColName"],["id","ColName",4,"ngIf"],["id","ColDate"],["name","variantName",1,"form-select",2,"border-width","0px",3,"ngModel","ngModelChange"],["value",""],["data-dismiss","modal","data-toggle","modal","data-target","#ChangeVPVariant",1,"mx-1","fas","fa-cog",2,"font-size","1em",3,"title","click"],["id","Delete","type","submit","data-dismiss","modal","data-toggle","modal","id","DeleteVPFListID","data-target","#DeleteVPFList",1,"btn","btn-warning","mx-1"],["id","DeleteVPFList","role","dialog","aria-labelledby","DeleteVPFListTitle","aria-hidden","true",1,"modal","fade"],["id","DeleteVPFListTitle",1,"modal-title"],[1,"bg-warning","text-dark"],[1,"form-group"],[1,"col-sm-4","col-form-label"],[1,"col-sm-8","form-control-static","text-dark"],["class","form-group",4,"ngIf"],["id","Delete","type","submit","class","btn btn-warning mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","Delete","type","submit","data-dismiss","modal",1,"btn","btn-warning","mx-1",3,"click"],["id","ChangeVPVariant","role","dialog","aria-labelledby","ChangeVPVariantTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-md","modal-dialog-centered"],["id","ChangeVPVariantTitle",1,"modal-title"],["class","bg-warning text-dark",4,"ngIf"],["data-dismiss","modal","data-toggle","modal","data-target","#VPFList",1,"btn","btn-secondary"],["id","Change","type","submit","data-dismiss","modal","data-toggle","modal","data-target","#VPFList",1,"btn","btn-warning","mx-1",3,"click"]],template:function(t,e){1&t&&(Br(0,"app-usernavbar"),Nr(1,"div",0),Lr(2,QD,9,6,"div",1),Lr(3,rM,14,17,"div",2),Lr(4,aM,4,4,"div",3),Lr(5,lM,3,4,"div",4),Lr(6,cM,3,3,"div",4),Lr(7,dM,3,3,"div",4),Lr(8,uM,3,1,"div",4),Lr(9,VM,29,21,"div",5),Lr(10,DM,38,31,"div",6),Lr(11,_M,21,14,"div",7),Fr()),2&t&&(_n(2),jr("ngIf",e.vpActive),_n(1),jr("ngIf",e.vpfActive),_n(1),jr("ngIf",!e.vpfActive),_n(1),jr("ngIf","Capacity"==e.pageParams.view&&e.vpActive&&e.vpfActive),_n(1),jr("ngIf","KeyMetrics"==e.pageParams.view&&e.visboprojectversions),_n(1),jr("ngIf","List"==e.pageParams.view&&e.vpList),_n(1),jr("ngIf","ProjectBoard"==e.pageParams.view&&e.vpList),_n(1),jr("ngIf",e.vpActive),_n(1),jr("ngIf",e.vpfActive),_n(1),jr("ngIf",e.vpfActive))},directives:[Pb,jc,Gc,cu,Nd,Ou,du,gu,_w,HA,JA,Ed,_d,Eu,Fd,Tu],pipes:[lv,qc],styles:[".modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto;max-height:75vH}"]}),t})(),EM=(()=>{class t{constructor(t){this.gChartService=t}ngOnInit(){this.language||(this.language="de"),this.gLib=this.gChartService.getGoogle(),this.gLib.charts.load("current",{packages:["corechart","table"],language:this.language}),this.gLib.charts.setOnLoadCallback(this.drawChart.bind(this))}ngOnChanges(){this.initialised&&this.drawChart()}drawChart(){const t=new this.gLib.visualization.LineChart(document.getElementById("divLineChart")),e=new this.gLib.visualization.arrayToDataTable(this.graphData),i=this.parentThis;this.gLib.visualization.events.addListener(t,"select",(function(){const n=t.getSelection();if(n&&0!==n.length){const t=n[0];if(void 0===i)console.log("Chart Line: The user clicked and this is undefined");else if(t){const n=t.row,s=t.column;if(null!=n&&n>=0){const t=e.getValue(n,0);i.chartSelectRow(n,s,t)}}}else console.log("Chart Line: chartGetSelection is undefined",n||n.length)})),t.draw(e,this.graphOptions||{title:"Line Chart"}),this.initialised=!0}}return t.\u0275fac=function(e){return new(e||t)(Rr(RV))},t.\u0275cmp=le({type:t,selectors:[["app-line-chart"]],inputs:{graphData:"graphData",language:"language",graphOptions:"graphOptions",parentThis:"parentThis"},features:[_e],decls:1,vars:0,consts:[["id","divLineChart"]],template:function(t,e){1&t&&Br(0,"div",0)},styles:["#divLineChart[_ngcontent-%COMP%]{width:100%;height:500px}"]}),t})();function LM(t,e){1&t&&(Nr(0,"th",15),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpKeyMetric.lbl.trend")))}function GM(t,e){1&t&&qr(0)}function RM(t,e){1&t&&qr(0)}function jM(t,e){1&t&&qr(0)}function $M(t,e){if(1&t){const t=zr();Nr(0,"td",20),Nr(1,"a"),Nr(2,"button",21),Jr("click",(function(){return ei(t),Xr(3).switchToHistory("Cost")})),mo(3,"i"),Fr(),Fr(),Fr()}if(2&t){const t=Xr(3);_n(2),to("title",t.historyButton)}}const NM=function(t,e){return{selected:t,text:e}},FM=function(t){return{level:t}};function BM(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td",16),Jr("click",(function(){return ei(t),Xr(2).switchView("Cost",!0)})),Nr(2,"a"),Lr(3,GM,1,0,"ng-container",17),Ua(4,"translate"),Fr(),Fr(),Nr(5,"td",18),Jr("click",(function(){return ei(t),Xr(2).switchView("Cost",!0)})),Ua(6,"translate"),Ua(7,"number"),Ua(8,"number"),Nr(9,"a"),Lr(10,RM,1,0,"ng-container",17),Nr(11,"span"),mo(12),Ua(13,"number"),Ua(14,"number"),Fr(),Fr(),Fr(),Nr(15,"td",18),Jr("click",(function(){return ei(t),Xr(2).switchView("Cost",!0)})),Ua(16,"translate"),Ua(17,"number"),Ua(18,"number"),Nr(19,"a"),Lr(20,jM,1,0,"ng-container",17),Nr(21,"span"),mo(22),Ua(23,"number"),Ua(24,"number"),Fr(),Fr(),Fr(),Lr(25,$M,4,1,"td",19),Fr()}if(2&t){const t=Xr(2),e=Gr(10),i=Gr(6);_n(3),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",Da(47,NM,"Cost"==t.typeMetricChart,Oa(4,17,"vpKeyMetric.lbl.metricCost"))),_n(2),no("title","",Oa(6,19,"vpKeyMetric.lbl.actualCost"),": ",Ea(7,21,t.vpvKeyMetricActive.keyMetrics.costCurrentActual,"1.0-0")," T\u20ac / ",Ea(8,24,t.vpvKeyMetricActive.keyMetrics.costBaseLastActual,"1.0-0")," T\u20ac"),_n(5),jr("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(50,FM,t.qualityCost)),_n(2),bo(" ",Ea(13,27,t.vpvKeyMetricActive.keyMetrics.costCurrentActual,"1.0-0")," T\u20ac (",Ea(14,30,100-t.vpvKeyMetricActive.savingCostActual,"1.0-0")," %) "),_n(3),no("title","",Oa(16,33,"vpKeyMetric.lbl.totalCost"),": ",Ea(17,35,t.vpvKeyMetricActive.keyMetrics.costCurrentTotal,"1.0-0")," T\u20ac / ",Ea(18,38,t.vpvKeyMetricActive.keyMetrics.costBaseLastTotal,"1.0-0")," T\u20ac"),_n(5),jr("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(52,FM,t.qualityTotalCost)),_n(2),bo(" ",Ea(23,41,t.vpvKeyMetricActive.keyMetrics.costCurrentTotal,"1.0-0")," T\u20ac (",Ea(24,44,100-t.vpvKeyMetricActive.savingCostTotal,"1.0-0")," %) "),_n(3),jr("ngIf",!t.getPreView())}}function HM(t,e){1&t&&qr(0)}function KM(t,e){1&t&&qr(0)}function qM(t,e){if(1&t&&(Nr(0,"span",23),mo(1),Ua(2,"number"),Fr()),2&t){const t=Xr(3);_n(1),vo("(",Ea(2,1,t.qualityEndDiffWeeks,"1.1-1")," W)")}}function zM(t,e){if(1&t){const t=zr();Nr(0,"td",20),Nr(1,"button",21),Jr("click",(function(){return ei(t),Xr(3).switchToHistory("EndDate")})),mo(2,"i"),Fr(),Fr()}if(2&t){const t=Xr(3);_n(1),to("title",t.historyButton)}}function QM(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td",16),Jr("click",(function(){return ei(t),Xr(2).switchToHistory("EndDate")})),Nr(2,"a"),Lr(3,HM,1,0,"ng-container",17),Ua(4,"translate"),Fr(),Fr(),Br(5,"td"),Nr(6,"td",22),Ua(7,"translate"),Ua(8,"date"),Nr(9,"a",16),Jr("click",(function(){return ei(t),Xr(2).switchToHistory("EndDate")})),Lr(10,KM,1,0,"ng-container",17),Nr(11,"span",23),mo(12),Ua(13,"date"),Fr(),Lr(14,qM,3,4,"span",24),Fr(),Fr(),Lr(15,zM,3,1,"td",19),Fr()}if(2&t){const t=Xr(2),e=Gr(10),i=Gr(6);_n(3),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",Da(19,NM,"EndDate"==t.typeMetricChart,Oa(4,9,"vpKeyMetric.lbl.metricEndDate"))),_n(3),io("title","",Oa(7,11,"vpKeyMetric.lbl.baselineEndDate"),": ",Ea(8,13,t.vpvKeyMetricActive.keyMetrics.endDateBaseLast,"dd.MM.yy"),""),_n(4),jr("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(22,FM,t.qualityEndDate)),_n(2),vo("",Ea(13,16,t.vpvKeyMetricActive.keyMetrics.endDateCurrent,"dd.MM.yy")," "),_n(2),jr("ngIf",t.qualityEndDiffWeeks),_n(1),jr("ngIf",!t.getPreView())}}function WM(t,e){1&t&&qr(0)}function JM(t,e){1&t&&qr(0)}function YM(t,e){if(1&t&&(Nr(0,"span",26),mo(1),Ua(2,"number"),Ua(3,"translate"),Fr()),2&t){const t=Xr(3);_n(1),bo(" (",Ea(2,2,t.vpvKeyMetricActive.keyMetrics.timeCompletionBaseLastTotal-t.vpvKeyMetricActive.keyMetrics.timeCompletionCurrentTotal,"1.0-0")," ",Oa(3,5,"vpKeyMetric.lbl.missing"),") ")}}function ZM(t,e){if(1&t){const t=zr();Nr(0,"td",20),Nr(1,"button",21),Jr("click",(function(){return ei(t),Xr(3).switchToHistory("Deadline")})),mo(2,"i"),Fr(),Fr()}if(2&t){const t=Xr(3);_n(1),to("title",t.historyButton)}}function XM(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td",16),Jr("click",(function(){return ei(t),Xr(2).switchView("Deadline",!0)})),Nr(2,"a"),Lr(3,WM,1,0,"ng-container",17),Ua(4,"translate"),Fr(),Fr(),Nr(5,"td",16),Jr("click",(function(){return ei(t),Xr(2).switchView("Deadline",!0)})),Nr(6,"a",22),Ua(7,"translate"),Lr(8,JM,1,0,"ng-container",17),Nr(9,"span"),mo(10),Ua(11,"number"),Ua(12,"translate"),Ua(13,"number"),Ua(14,"number"),Fr(),Fr(),Fr(),Nr(15,"td",16),Jr("click",(function(){return ei(t),Xr(2).switchView("Deadline",!0)})),Nr(16,"a"),Nr(17,"span"),mo(18),Ua(19,"number"),Fr(),Lr(20,YM,4,7,"span",25),Fr(),Fr(),Lr(21,ZM,3,1,"td",19),Fr()}if(2&t){const t=Xr(2),e=Gr(10),i=Gr(6);_n(3),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",Da(30,NM,"Deadline"==t.typeMetricChart,Oa(4,12,"vpKeyMetric.lbl.metricDeadline"))),_n(3),to("title",Oa(7,14,"vpKeyMetric.lbl.actualDeadline")),_n(2),jr("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(33,FM,t.qualityDeadline)),_n(2),Co(" ",Ea(11,16,t.vpvKeyMetricActive.keyMetrics.timeCompletionCurrentActual,"1.0-0")," ",Oa(12,19,"vpKeyMetric.lbl.of")," ",Ea(13,21,t.vpvKeyMetricActive.keyMetrics.timeCompletionBaseLastActual,"1.0-0")," (",Ea(14,24,t.vpvKeyMetricActive.timeCompletionActual,"1.0-0")," %) "),_n(8),vo(" ",Ea(19,27,t.vpvKeyMetricActive.keyMetrics.timeCompletionCurrentTotal,"1.0-0")," "),_n(2),jr("ngIf",t.vpvKeyMetricActive.keyMetrics.timeCompletionCurrentTotal<t.vpvKeyMetricActive.keyMetrics.timeCompletionBaseLastTotal),_n(1),jr("ngIf",!t.getPreView())}}function tI(t,e){1&t&&qr(0)}function eI(t,e){1&t&&qr(0)}function iI(t,e){if(1&t&&(Nr(0,"span",26),mo(1),Ua(2,"number"),Fr()),2&t){const t=Xr(3);_n(1),vo("(",Ea(2,1,t.vpvKeyMetricActive.keyMetrics.deliverableCompletionBaseLastTotal-t.vpvKeyMetricActive.keyMetrics.deliverableCompletionCurrentTotal,"1.0-2")," Missing)")}}function nI(t,e){if(1&t){const t=zr();Nr(0,"td",20),Nr(1,"button",21),Jr("click",(function(){return ei(t),Xr(3).switchToHistory("Delivery")})),mo(2,"i"),Fr(),Fr()}if(2&t){const t=Xr(3);_n(1),to("title",t.historyButton)}}function sI(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td",16),Jr("click",(function(){return ei(t),Xr(2).switchView("Delivery",!0)})),Nr(2,"a"),Lr(3,tI,1,0,"ng-container",17),Ua(4,"translate"),Fr(),Fr(),Nr(5,"td",18),Jr("click",(function(){return ei(t),Xr(2).switchView("Delivery",!0)})),Ua(6,"translate"),Nr(7,"a"),Lr(8,eI,1,0,"ng-container",17),Nr(9,"span"),mo(10),Ua(11,"number"),Ua(12,"translate"),Ua(13,"number"),Ua(14,"number"),Fr(),Fr(),Fr(),Nr(15,"td",16),Jr("click",(function(){return ei(t),Xr(2).switchView("Delivery",!0)})),Nr(16,"a"),Nr(17,"span"),mo(18),Ua(19,"number"),Fr(),Lr(20,iI,3,4,"span",25),Fr(),Fr(),Lr(21,nI,3,1,"td",19),Fr()}if(2&t){const t=Xr(2),e=Gr(10),i=Gr(6);_n(3),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",Da(30,NM,"Delivery"==t.typeMetricChart,Oa(4,12,"vpKeyMetric.lbl.metricDelivery"))),_n(2),to("title",Oa(6,14,"vpKeyMetric.lbl.actualDelivery")),_n(3),jr("ngTemplateOutlet",i)("ngTemplateOutletContext",ka(33,FM,t.qualityDelivery)),_n(2),Co(" ",Ea(11,16,t.vpvKeyMetricActive.keyMetrics.deliverableCompletionCurrentActual,"1.0-0")," ",Oa(12,19,"vpKeyMetric.lbl.of")," ",Ea(13,21,t.vpvKeyMetricActive.keyMetrics.deliverableCompletionBaseLastActual,"1.0-0")," (",Ea(14,24,t.vpvKeyMetricActive.deliveryCompletionActual,"1.0-0")," %) "),_n(8),vo("",Ea(19,27,t.vpvKeyMetricActive.keyMetrics.deliverableCompletionCurrentTotal,"1.0-0")," "),_n(2),jr("ngIf",t.vpvKeyMetricActive.keyMetrics.deliverableCompletionCurrentTotal<t.vpvKeyMetricActive.keyMetrics.deliverableCompletionBaseLastTotal),_n(1),jr("ngIf",!t.getPreView())}}function rI(t,e){1&t&&Br(0,"th",20)}function oI(t,e){if(1&t&&(Nr(0,"tr"),Br(1,"th"),Nr(2,"th"),mo(3),Ua(4,"translate"),Fr(),Nr(5,"th"),mo(6),Ua(7,"translate"),Fr(),Lr(8,rI,1,0,"th",19),Fr()),2&t){const t=Xr(2);_n(3),fo(Oa(4,3,"vpKeyMetric.lbl.finished")),_n(3),fo(Oa(7,5,"vpKeyMetric.lbl.unfinished")),_n(2),jr("ngIf",!t.getPreView())}}function aI(t,e){1&t&&qr(0)}function lI(t,e){1&t&&qr(0)}function cI(t,e){if(1&t&&(Nr(0,"div"),Lr(1,lI,1,0,"ng-container",17),Nr(2,"span"),mo(3),Ua(4,"number"),Ua(5,"translate"),Fr(),Fr()),2&t){const t=Xr(3),e=Gr(6);_n(1),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(9,FM,t.delayActualDeadline)),_n(2),bo(" ",Ea(4,4,t.vpvKeyMetricActive.keyMetrics.timeDelayFinished,"1.0-0")," ",Oa(5,7,"vpKeyMetric.lbl.unitsDelay"),"")}}function dI(t,e){1&t&&qr(0)}function uI(t,e){if(1&t&&(Nr(0,"div"),Lr(1,dI,1,0,"ng-container",17),Nr(2,"span"),mo(3),Ua(4,"number"),Ua(5,"translate"),Fr(),Fr()),2&t){const t=Xr(3),e=Gr(6);_n(1),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(9,FM,t.delayTotalDeadline)),_n(2),bo(" ",Ea(4,4,t.vpvKeyMetricActive.keyMetrics.timeDelayUnFinished,"1.0-0")," ",Oa(5,7,"vpKeyMetric.lbl.unitsDelay"),"")}}function hI(t,e){if(1&t){const t=zr();Nr(0,"td",20),Nr(1,"button",21),Jr("click",(function(){return ei(t),Xr(3).switchToHistory("DeadlineDelay")})),mo(2,"i"),Fr(),Fr()}if(2&t){const t=Xr(3);_n(1),to("title",t.historyButton)}}function pI(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td",16),Jr("click",(function(){return ei(t),Xr(2).switchView("Deadline",!0)})),Nr(2,"a"),Lr(3,aI,1,0,"ng-container",17),Ua(4,"translate"),Fr(),Fr(),Nr(5,"td",18),Jr("click",(function(){return ei(t),Xr(2).switchView("Deadline",!0)})),Ua(6,"translate"),Nr(7,"a"),Lr(8,cI,6,11,"div",2),Fr(),Fr(),Nr(9,"td",18),Jr("click",(function(){return ei(t),Xr(2).switchView("Deadline",!0)})),Ua(10,"translate"),Nr(11,"a"),Lr(12,uI,6,11,"div",2),Fr(),Fr(),Lr(13,hI,3,1,"td",19),Fr()}if(2&t){const t=Xr(2),e=Gr(10);_n(3),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",Da(13,NM,"DeadlineDelay"==t.typeMetricChart,Oa(4,7,"vpKeyMetric.lbl.metricDeadlineDelay"))),_n(2),to("title",Oa(6,9,"vpKeyMetric.lbl.finishedDeadlineDelay")),_n(3),jr("ngIf",null!=t.vpvKeyMetricActive.keyMetrics.timeDelayFinished),_n(1),to("title",Oa(10,11,"vpKeyMetric.lbl.unfinishedDeadlineDelay")),_n(3),jr("ngIf",null!=t.vpvKeyMetricActive.keyMetrics.timeDelayUnFinished),_n(1),jr("ngIf",!t.getPreView())}}function gI(t,e){1&t&&qr(0)}function mI(t,e){1&t&&qr(0)}function fI(t,e){if(1&t&&(Nr(0,"div"),Lr(1,mI,1,0,"ng-container",17),Nr(2,"span"),mo(3),Ua(4,"number"),Ua(5,"translate"),Fr(),Fr()),2&t){const t=Xr(3),e=Gr(6);_n(1),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(9,FM,t.delayActualDelivery)),_n(2),bo(" ",Ea(4,4,t.vpvKeyMetricActive.keyMetrics.deliverableDelayFinished,"1.0-0")," ",Oa(5,7,"vpKeyMetric.lbl.unitsDelay"),"")}}function vI(t,e){1&t&&qr(0)}function bI(t,e){if(1&t&&(Nr(0,"div"),Lr(1,vI,1,0,"ng-container",17),Nr(2,"span"),mo(3),Ua(4,"number"),Ua(5,"translate"),Fr(),Fr()),2&t){const t=Xr(3),e=Gr(6);_n(1),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(9,FM,t.delayTotalDelivery)),_n(2),bo(" ",Ea(4,4,t.vpvKeyMetricActive.keyMetrics.deliverableDelayUnFinished,"1.0-0")," ",Oa(5,7,"vpKeyMetric.lbl.unitsDelay"),"")}}function yI(t,e){if(1&t){const t=zr();Nr(0,"td",20),Nr(1,"button",21),Jr("click",(function(){return ei(t),Xr(3).switchToHistory("DeliveryDelay")})),mo(2,"i"),Fr(),Fr()}if(2&t){const t=Xr(3);_n(1),to("title",t.historyButton)}}function CI(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td",16),Jr("click",(function(){return ei(t),Xr(2).switchView("Delivery",!0)})),Nr(2,"a"),Lr(3,gI,1,0,"ng-container",17),Ua(4,"translate"),Fr(),Fr(),Nr(5,"td",18),Jr("click",(function(){return ei(t),Xr(2).switchView("Delivery",!0)})),Ua(6,"translate"),Nr(7,"a"),Lr(8,fI,6,11,"div",2),Fr(),Fr(),Nr(9,"td",18),Jr("click",(function(){return ei(t),Xr(2).switchView("Deadline",!0)})),Ua(10,"translate"),Nr(11,"a"),Lr(12,bI,6,11,"div",2),Fr(),Fr(),Lr(13,yI,3,1,"td",19),Fr()}if(2&t){const t=Xr(2),e=Gr(10);_n(3),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",Da(13,NM,"DeliveryDelay"==t.typeMetricChart,Oa(4,7,"vpKeyMetric.lbl.metricDeliveryDelay"))),_n(2),to("title",Oa(6,9,"vpKeyMetric.lbl.finishedDeliveryDelay")),_n(3),jr("ngIf",null!=t.vpvKeyMetricActive.keyMetrics.timeDelayFinished),_n(1),to("title",Oa(10,11,"vpKeyMetric.lbl.unfinishedDeliveryDelay")),_n(3),jr("ngIf",null!=t.vpvKeyMetricActive.keyMetrics.timeDelayUnFinished),_n(1),jr("ngIf",!t.getPreView())}}function VI(t,e){if(1&t&&(Nr(0,"table",13),Nr(1,"thead"),Nr(2,"tr"),Nr(3,"th"),mo(4),Ua(5,"translate"),Fr(),Nr(6,"th"),mo(7),Ua(8,"translate"),Fr(),Nr(9,"th"),mo(10),Ua(11,"translate"),Fr(),Lr(12,LM,3,3,"th",14),Fr(),Fr(),Nr(13,"tbody"),Lr(14,BM,26,54,"tr",2),Lr(15,QM,16,24,"tr",2),Lr(16,XM,22,35,"tr",2),Lr(17,sI,22,35,"tr",2),Lr(18,oI,9,7,"tr",2),Lr(19,pI,14,16,"tr",2),Lr(20,CI,14,16,"tr",2),Fr(),Fr()),2&t){const t=Xr();_n(4),fo(Oa(5,11,"vpKeyMetric.lbl.keyMetric")),_n(3),fo(Oa(8,13,"vpKeyMetric.lbl.planToDate")),_n(3),fo(Oa(11,15,"vpKeyMetric.lbl.total")),_n(2),jr("ngIf",!t.getPreView()),_n(2),jr("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"Cost")),_n(1),jr("ngIf",null!=t.vpvKeyMetricActive.keyMetrics.endDateBaseLast),_n(1),jr("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"Deadline")),_n(1),jr("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"Delivery")),_n(1),jr("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"DeadlineDelay")||t.hasKM(t.vpvKeyMetricActive.keyMetrics,"DeliveryDelay")),_n(1),jr("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"DeadlineDelay")),_n(1),jr("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"DeliveryDelay"))}}function wI(t,e){1&t&&(Nr(0,"h3"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),vo(" ",Oa(2,1,"vpKeyMetric.msg.noKeyMetric")," "))}const AI=function(t,e,i){return{"fa-check-circle text-success":t,"fa-exclamation-triangle text-warning":e,"fa-exclamation-circle text-danger":i}};function PI(t,e){if(1&t&&Br(0,"i",27),2&t){const t=e.level;jr("ngClass",Ma(1,AI,1==t,2==t,3==t))}}const kI=function(t,e,i,n){return{"text-secondary":t,"text-success":e,"text-warning":i,"text-danger":n}};function DI(t,e){if(1&t&&Br(0,"i",28),2&t){const t=e.level;jr("ngClass",Ia(1,kI,0==t,1==t,2==t,3==t))}}const MI=function(t,e){return{"font-weight-bold":t,"font-weight-normal":e}};function II(t,e){if(1&t&&(Nr(0,"span",29),mo(1),Fr()),2&t){const t=e.selected,i=e.text;jr("ngClass",Da(2,MI,1==t,0==t)),_n(1),fo(i)}}function SI(t,e){if(1&t){const t=zr();Nr(0,"button",35),Jr("click",(function(){return ei(t),Xr(2).gotoVisboProjectVersions()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpKeyMetric.btn.allVersions")))}function xI(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-line-chart",37),Fr()),2&t){const t=Xr(3);_n(1),jr("graphData",t.graphDataLineChart)("graphOptions",t.graphOptionsLineChart)("parentThis",t.parentThis)("language",t.currentLang)}}function TI(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-line-chart",37),Fr()),2&t){const t=Xr(3);_n(1),jr("graphData",t.graphDataLineChart)("graphOptions",t.graphOptionsLineChartEndDate)("parentThis",t.parentThis)("language",t.currentLang)}}function _I(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-line-chart",37),Fr()),2&t){const t=Xr(3);_n(1),jr("graphData",t.graphDataLineChart)("graphOptions",t.graphOptionsLineChart)("parentThis",t.parentThis)("language",t.currentLang)}}function UI(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-line-chart",37),Fr()),2&t){const t=Xr(3);_n(1),jr("graphData",t.graphDataLineChart)("graphOptions",t.graphOptionsLineChart)("parentThis",t.parentThis)("language",t.currentLang)}}function OI(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-line-chart",37),Fr()),2&t){const t=Xr(3);_n(1),jr("graphData",t.graphDataLineChart)("graphOptions",t.graphOptionsLineChart)("parentThis",t.parentThis)("language",t.currentLang)}}function EI(t,e){if(1&t&&(Nr(0,"div",36),Lr(1,xI,2,4,"div",2),Lr(2,TI,2,4,"div",2),Lr(3,_I,2,4,"div",2),Lr(4,UI,2,4,"div",2),Lr(5,OI,2,4,"div",2),Fr()),2&t){const t=Xr(2);_n(1),jr("ngIf","Cost"==t.typeMetricChart),_n(1),jr("ngIf","EndDate"==t.typeMetricChart),_n(1),jr("ngIf","Deadline"==t.typeMetricChart),_n(1),jr("ngIf","DeadlineDelay"==t.typeMetricChart),_n(1),jr("ngIf","Delivery"==t.typeMetricChart)}}function LI(t,e){1&t&&qr(0)}function GI(t,e){1&t&&qr(0)}function RI(t,e){if(1&t){const t=zr();Nr(0,"tr",42),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(4).listSelectRow(i)})),Nr(1,"td"),Nr(2,"a"),Lr(3,LI,1,0,"ng-container",17),Ua(4,"date"),Fr(),Fr(),Nr(5,"td",43),mo(6),Ua(7,"number"),Fr(),Nr(8,"td",44),Ua(9,"translate"),Ua(10,"number"),mo(11),Ua(12,"number"),Fr(),Nr(13,"td",43),mo(14),Ua(15,"number"),Fr(),Nr(16,"td",44),Ua(17,"translate"),Ua(18,"number"),mo(19),Ua(20,"number"),Fr(),Nr(21,"td",44),Lr(22,GI,1,0,"ng-container",17),Fr(),Fr()}if(2&t){const t=e.$implicit,i=Xr(4),n=Gr(10),s=Gr(8);_n(3),jr("ngTemplateOutlet",n)("ngTemplateOutletContext",Da(38,NM,t.timestamp==i.vpvKeyMetricActive.timestamp,Ea(4,13,t.timestamp,"dd.MM.yyyy HH:mm"))),_n(3),vo("",Ea(7,16,t.keyMetrics.costCurrentActual,"1.0-0")," k\u20ac"),_n(2),io("title","",Oa(9,19,"keyMetrics.shortPV"),": ",Ea(10,21,t.keyMetrics.costBaseLastActual,"1.0-0")," k\u20ac"),_n(3),vo("",Ea(12,24,100-t.savingCostActual,"1.0-0")," %"),_n(3),vo("",Ea(15,27,t.keyMetrics.costCurrentTotal,"1.0-0")," k\u20ac"),_n(2),io("title","",Oa(17,30,"keyMetrics.shortBAC"),": ",Ea(18,32,t.keyMetrics.costBaseLastTotal,"1.0-0")," k\u20ac"),_n(3),vo("",Ea(20,35,100-t.savingCostTotal,"1.0-0")," %"),_n(2),to("title",t.ampelErlaeuterung),_n(1),jr("ngTemplateOutlet",s)("ngTemplateOutletContext",ka(41,FM,t.ampelStatus))}}function jI(t,e){if(1&t){const t=zr();Nr(0,"table",13),Nr(1,"thead"),Nr(2,"tr"),Nr(3,"th",16),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(1)})),mo(4),Ua(5,"translate"),Fr(),Nr(6,"th",38),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(7)})),Ua(7,"translate"),mo(8),Ua(9,"translate"),Fr(),Nr(10,"th",39),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(2)})),Ua(11,"translate"),mo(12),Ua(13,"translate"),Fr(),Nr(14,"th",38),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(8)})),Ua(15,"translate"),mo(16),Ua(17,"translate"),Fr(),Nr(18,"th",39),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(5)})),Ua(19,"translate"),mo(20),Ua(21,"translate"),Fr(),Nr(22,"th",40),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(6)})),mo(23),Ua(24,"translate"),Fr(),Fr(),Fr(),Nr(25,"tbody"),Lr(26,RI,23,43,"tr",41),Fr(),Fr()}if(2&t){const t=Xr(3);_n(4),fo(Oa(5,11,"keyMetrics.lbl.timeStamp")),_n(2),to("title",Oa(7,13,"keyMetrics.longAC")),_n(2),fo(Oa(9,15,"keyMetrics.shortAC")),_n(2),to("title",Oa(11,17,"keyMetrics.longPV")),_n(2),fo(Oa(13,19,"keyMetrics.relativPV")),_n(2),to("title",Oa(15,21,"keyMetrics.longEAC")),_n(2),fo(Oa(17,23,"keyMetrics.shortEAC")),_n(2),to("title",Oa(19,25,"keyMetrics.longBAC")),_n(2),fo(Oa(21,27,"keyMetrics.baselineBAC")),_n(3),fo(Oa(24,29,"keyMetrics.lbl.trafficLight")),_n(3),jr("ngForOf",t.visbokeymetrics)}}function $I(t,e){1&t&&qr(0)}function NI(t,e){1&t&&qr(0)}function FI(t,e){if(1&t){const t=zr();Nr(0,"tr",42),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(4).listSelectRow(i)})),Nr(1,"td"),Nr(2,"a"),Lr(3,$I,1,0,"ng-container",17),Ua(4,"date"),Fr(),Fr(),Nr(5,"td",43),mo(6),Ua(7,"date"),Fr(),Nr(8,"td",43),mo(9),Ua(10,"date"),Fr(),Nr(11,"td",43),mo(12),Ua(13,"number"),Fr(),Nr(14,"td",44),Lr(15,NI,1,0,"ng-container",17),Fr(),Fr()}if(2&t){const t=e.$implicit,i=Xr(4),n=Gr(10),s=Gr(8);_n(3),jr("ngTemplateOutlet",n)("ngTemplateOutletContext",Da(20,NM,t.timestamp==i.vpvKeyMetricActive.timestamp,Ea(4,8,t.timestamp,"dd.MM.yyyy HH:mm"))),_n(3),fo(Ea(7,11,t.keyMetrics.endDateCurrent,"dd.MM.yyyy")),_n(3),fo(Ea(10,14,t.keyMetrics.endDateBaseLast,"dd.MM.yyyy")),_n(3),vo("",Ea(13,17,t.savingEndDate,"1.0-1")," W"),_n(2),to("title",t.ampelErlaeuterung),_n(1),jr("ngTemplateOutlet",s)("ngTemplateOutletContext",ka(23,FM,t.ampelStatus))}}function BI(t,e){if(1&t){const t=zr();Nr(0,"table",13),Nr(1,"thead"),Nr(2,"tr"),Nr(3,"th",16),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(1)})),mo(4),Ua(5,"translate"),Fr(),Nr(6,"th",38),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(31)})),Ua(7,"translate"),mo(8),Ua(9,"translate"),Fr(),Nr(10,"th",38),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(32)})),Ua(11,"translate"),mo(12),Ua(13,"translate"),Fr(),Nr(14,"th",45),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(33)})),mo(15),Ua(16,"translate"),Fr(),Nr(17,"th",40),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(6)})),mo(18),Ua(19,"translate"),Fr(),Fr(),Fr(),Nr(20,"tbody"),Lr(21,FI,16,25,"tr",41),Fr(),Fr()}if(2&t){const t=Xr(3);_n(4),fo(Oa(5,8,"keyMetrics.lbl.timeStamp")),_n(2),to("title",Oa(7,10,"keyMetrics.longEED")),_n(2),fo(Oa(9,12,"keyMetrics.shortEED")),_n(2),to("title",Oa(11,14,"keyMetrics.longBED")),_n(2),fo(Oa(13,16,"keyMetrics.shortBED")),_n(3),fo(Oa(16,18,"vpKeyMetric.lbl.savingED")),_n(3),fo(Oa(19,20,"keyMetrics.lbl.trafficLight")),_n(3),jr("ngForOf",t.visbokeymetrics)}}function HI(t,e){if(1&t){const t=zr();Nr(0,"th",40),Jr("click",(function(){return ei(t),Xr(4).sortKeyMetricsTable(13)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"keyMetrics.lbl.actualDelay")))}function KI(t,e){if(1&t){const t=zr();Nr(0,"th",40),Jr("click",(function(){return ei(t),Xr(4).sortKeyMetricsTable(14)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"keyMetrics.lbl.totalDelay")))}function qI(t,e){1&t&&qr(0)}function zI(t,e){if(1&t&&(Nr(0,"td",43),mo(1),Ua(2,"number"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.keyMetrics.timeDelayFinished,"1.0-0"))}}function QI(t,e){if(1&t&&(Nr(0,"td",43),mo(1),Ua(2,"number"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.keyMetrics.timeDelayUnFinished,"1.0-0"))}}function WI(t,e){1&t&&qr(0)}function JI(t,e){if(1&t){const t=zr();Nr(0,"tr",42),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(4).listSelectRow(i)})),Nr(1,"td"),Nr(2,"a"),Lr(3,qI,1,0,"ng-container",17),Ua(4,"date"),Fr(),Fr(),Nr(5,"td",43),mo(6),Ua(7,"number"),Fr(),Nr(8,"td",44),Ua(9,"translate"),Ua(10,"number"),mo(11),Ua(12,"number"),Fr(),Nr(13,"td",43),mo(14),Ua(15,"number"),Fr(),Nr(16,"td",44),Ua(17,"translate"),Ua(18,"number"),mo(19),Ua(20,"number"),Fr(),Lr(21,zI,3,4,"td",47),Lr(22,QI,3,4,"td",47),Nr(23,"td",44),Lr(24,WI,1,0,"ng-container",17),Fr(),Fr()}if(2&t){const t=e.$implicit,i=Xr(4),n=Gr(10),s=Gr(8);_n(3),jr("ngTemplateOutlet",n)("ngTemplateOutletContext",Da(40,NM,t.timestamp==i.vpvKeyMetricActive.timestamp,Ea(4,15,t.timestamp,"dd.MM.yyyy HH:mm"))),_n(3),fo(Ea(7,18,t.keyMetrics.timeCompletionCurrentActual,"1.0-1")),_n(2),io("title","",Oa(9,21,"keyMetrics.shortPD"),": ",Ea(10,23,t.keyMetrics.timeCompletionBaseLastActual,"1.0-0"),""),_n(3),vo("",Ea(12,26,t.timeCompletionActual,"1.0-0")," %"),_n(3),fo(Ea(15,29,t.keyMetrics.timeCompletionCurrentTotal,"1.0-1")),_n(2),io("title","",Oa(17,32,"keyMetrics.shortDAC"),": ",Ea(18,34,t.keyMetrics.timeCompletionBaseLastTotal,"1.0-0"),""),_n(3),vo("",Ea(20,37,t.timeCompletionTotal,"1.0-0")," %"),_n(2),jr("ngIf",i.hasKM(i.vpvKeyMetricActive.keyMetrics,"DeadlineDelay")),_n(1),jr("ngIf",i.hasKM(i.vpvKeyMetricActive.keyMetrics,"DeadlineDelay")),_n(1),to("title",t.ampelErlaeuterung),_n(1),jr("ngTemplateOutlet",s)("ngTemplateOutletContext",ka(43,FM,t.ampelStatus))}}function YI(t,e){if(1&t){const t=zr();Nr(0,"table",13),Nr(1,"thead"),Nr(2,"tr"),Nr(3,"th",16),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(1)})),mo(4),Ua(5,"translate"),Fr(),Nr(6,"th",38),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(10)})),Ua(7,"translate"),mo(8),Ua(9,"translate"),Fr(),Nr(10,"th",38),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(11)})),Ua(11,"translate"),mo(12),Ua(13,"translate"),Fr(),Nr(14,"th",39),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(12)})),Ua(15,"translate"),mo(16),Ua(17,"translate"),Fr(),Nr(18,"th",39),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(12)})),Ua(19,"translate"),mo(20),Ua(21,"translate"),Fr(),Lr(22,HI,3,3,"th",46),Lr(23,KI,3,3,"th",46),Nr(24,"th",40),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(6)})),mo(25),Ua(26,"translate"),Fr(),Fr(),Fr(),Nr(27,"tbody"),Lr(28,JI,25,45,"tr",41),Fr(),Fr()}if(2&t){const t=Xr(3);_n(4),fo(Oa(5,13,"keyMetrics.lbl.timeStamp")),_n(2),to("title",Oa(7,15,"keyMetrics.longAD")),_n(2),fo(Oa(9,17,"keyMetrics.shortAD")),_n(2),to("title",Oa(11,19,"keyMetrics.longPD")),_n(2),fo(Oa(13,21,"keyMetrics.shortPD")),_n(2),to("title",Oa(15,23,"keyMetrics.longEDC")),_n(2),fo(Oa(17,25,"keyMetrics.shortEDC")),_n(2),to("title",Oa(19,27,"keyMetrics.longDAC")),_n(2),fo(Oa(21,29,"keyMetrics.shortDAC")),_n(2),jr("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"DeadlineDelay")),_n(1),jr("ngIf",t.hasKM(t.vpvKeyMetricActive.keyMetrics,"DeadlineDelay")),_n(2),fo(Oa(26,31,"keyMetrics.lbl.trafficLight")),_n(3),jr("ngForOf",t.visbokeymetrics)}}function ZI(t,e){1&t&&qr(0)}function XI(t,e){1&t&&qr(0)}function tS(t,e){if(1&t){const t=zr();Nr(0,"tr",42),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(4).listSelectRow(i)})),Nr(1,"td"),Nr(2,"a"),Lr(3,ZI,1,0,"ng-container",17),Ua(4,"date"),Fr(),Fr(),Nr(5,"td",43),mo(6),Ua(7,"number"),Fr(),Nr(8,"td",44),Ua(9,"translate"),Ua(10,"number"),mo(11),Ua(12,"number"),Fr(),Nr(13,"td",43),mo(14),Ua(15,"number"),Fr(),Nr(16,"td",44),Ua(17,"translate"),Ua(18,"number"),mo(19),Ua(20,"number"),Fr(),Nr(21,"td",44),Lr(22,XI,1,0,"ng-container",17),Fr(),Fr()}if(2&t){const t=e.$implicit,i=Xr(4),n=Gr(10),s=Gr(8);_n(3),jr("ngTemplateOutlet",n)("ngTemplateOutletContext",Da(38,NM,t.timestamp==i.vpvKeyMetricActive.timestamp,Ea(4,13,t.timestamp,"dd.MM.yyyy HH:mm"))),_n(3),fo(Ea(7,16,t.keyMetrics.deliverableCompletionCurrentActual,"1.0-1")),_n(2),io("title","",Oa(9,19,"keyMetrics.shortPDV"),": ",Ea(10,21,t.keyMetrics.deliverableCompletionBaseLastActual,"1.0-0"),""),_n(3),vo("",Ea(12,24,t.deliveryCompletionActual,"1.0-0")," %"),_n(3),fo(Ea(15,27,t.keyMetrics.deliverableCompletionCurrentTotal,"1.0-1")),_n(2),io("title","",Oa(17,30,"keyMetrics.shortDVAC"),": ",Ea(18,32,t.keyMetrics.deliverableCompletionBaseLastTotal,"1.0-0"),""),_n(3),vo("",Ea(20,35,t.deliveryCompletionTotal,"1.0-0")," %"),_n(2),to("title",t.ampelErlaeuterung),_n(1),jr("ngTemplateOutlet",s)("ngTemplateOutletContext",ka(41,FM,t.ampelStatus))}}function eS(t,e){if(1&t){const t=zr();Nr(0,"table",13),Nr(1,"thead"),Nr(2,"tr"),Nr(3,"th",16),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(1)})),mo(4),Ua(5,"translate"),Fr(),Nr(6,"th",38),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(21)})),Ua(7,"translate"),mo(8),Ua(9,"translate"),Fr(),Nr(10,"th",38),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(20)})),Ua(11,"translate"),mo(12),Ua(13,"translate"),Fr(),Nr(14,"th",39),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(26)})),Ua(15,"translate"),mo(16),Ua(17,"translate"),Fr(),Nr(18,"th",39),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(22)})),Ua(19,"translate"),mo(20),Ua(21,"translate"),Fr(),Nr(22,"th",40),Jr("click",(function(){return ei(t),Xr(3).sortKeyMetricsTable(6)})),mo(23),Ua(24,"translate"),Fr(),Fr(),Fr(),Nr(25,"tbody"),Lr(26,tS,23,43,"tr",41),Fr(),Fr()}if(2&t){const t=Xr(3);_n(4),fo(Oa(5,11,"keyMetrics.lbl.timeStamp")),_n(2),to("title",Oa(7,13,"keyMetrics.longADV")),_n(2),fo(Oa(9,15,"keyMetrics.shortADV")),_n(2),to("title",Oa(11,17,"keyMetrics.longPDV")),_n(2),fo(Oa(13,19,"keyMetrics.shortPDV")),_n(2),to("title",Oa(15,21,"keyMetrics.longEDVC")),_n(2),fo(Oa(17,23,"keyMetrics.shortEDVC")),_n(2),to("title",Oa(19,25,"keyMetrics.longDVAC")),_n(2),fo(Oa(21,27,"keyMetrics.shortDVAC")),_n(3),fo(Oa(24,29,"keyMetrics.lbl.trafficLight")),_n(3),jr("ngForOf",t.visbokeymetrics)}}function iS(t,e){if(1&t&&(Nr(0,"div"),Lr(1,jI,27,31,"table",1),Lr(2,BI,22,22,"table",1),Lr(3,YI,29,33,"table",1),Lr(4,eS,27,31,"table",1),Fr()),2&t){const t=Xr(2);_n(1),jr("ngIf","Cost"==t.typeMetricChart),_n(1),jr("ngIf","EndDate"==t.typeMetricChart),_n(1),jr("ngIf","Deadline"==t.typeMetricChart||"DeadlineDelay"==t.typeMetricChart),_n(1),jr("ngIf","Delivery"==t.typeMetricChart)}}function nS(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div",30),Nr(2,"button",31),Jr("click",(function(){return ei(t),Xr().switchChart()})),mo(3),Fr(),Lr(4,SI,3,3,"button",32),Br(5,"h3",33),Ua(6,"translate"),Fr(),Lr(7,EI,6,5,"div",34),Lr(8,iS,5,4,"div",2),Fr()}if(2&t){const t=Xr();_n(3),fo(t.chartButton),_n(1),jr("ngIf",!t.chart),_n(1),to("title",Oa(6,5,"keyMetrics.lbl.showLegend")),_n(2),jr("ngIf",t.chart&&t.graphDataLineChart.length>0),_n(1),jr("ngIf",!t.chart&&t.graphDataLineChart.length>0)}}function sS(t,e){1&t&&(Nr(0,"tbody"),Nr(1,"tr"),Nr(2,"td"),mo(3),Ua(4,"translate"),Fr(),Nr(5,"td"),mo(6),Ua(7,"translate"),Fr(),Fr(),Nr(8,"tr"),Nr(9,"td"),mo(10),Ua(11,"translate"),Fr(),Nr(12,"td"),mo(13),Ua(14,"translate"),Fr(),Fr(),Nr(15,"tr"),Nr(16,"td"),mo(17),Ua(18,"translate"),Fr(),Nr(19,"td"),mo(20),Ua(21,"translate"),Fr(),Fr(),Nr(22,"tr"),Nr(23,"td"),mo(24),Ua(25,"translate"),Fr(),Nr(26,"td"),mo(27),Ua(28,"translate"),Fr(),Fr(),Fr()),2&t&&(_n(3),fo(Oa(4,8,"keyMetrics.shortAC")),_n(3),fo(Oa(7,10,"keyMetrics.longAC")),_n(4),fo(Oa(11,12,"keyMetrics.shortPV")),_n(3),fo(Oa(14,14,"keyMetrics.longPV")),_n(4),fo(Oa(18,16,"keyMetrics.shortEAC")),_n(3),fo(Oa(21,18,"keyMetrics.longEAC")),_n(4),fo(Oa(25,20,"keyMetrics.shortBAC")),_n(3),fo(Oa(28,22,"keyMetrics.longBAC")))}function rS(t,e){1&t&&(Nr(0,"tbody"),Nr(1,"tr"),Nr(2,"td"),mo(3),Ua(4,"translate"),Fr(),Nr(5,"td"),mo(6),Ua(7,"translate"),Fr(),Fr(),Nr(8,"tr"),Nr(9,"td"),mo(10),Ua(11,"translate"),Fr(),Nr(12,"td"),mo(13),Ua(14,"translate"),Fr(),Fr(),Nr(15,"tr"),Nr(16,"td"),mo(17),Ua(18,"translate"),Fr(),Nr(19,"td"),mo(20),Ua(21,"translate"),Fr(),Fr(),Nr(22,"tr"),Nr(23,"td"),mo(24),Ua(25,"translate"),Fr(),Nr(26,"td"),mo(27),Ua(28,"translate"),Fr(),Fr(),Fr()),2&t&&(_n(3),fo(Oa(4,8,"keyMetrics.shortAD")),_n(3),fo(Oa(7,10,"keyMetrics.longAD")),_n(4),fo(Oa(11,12,"keyMetrics.shortPD")),_n(3),fo(Oa(14,14,"keyMetrics.longPD")),_n(4),fo(Oa(18,16,"keyMetrics.shortEDC")),_n(3),fo(Oa(21,18,"keyMetrics.longEDC")),_n(4),fo(Oa(25,20,"keyMetrics.shortDAC")),_n(3),fo(Oa(28,22,"keyMetrics.longDAC")))}function oS(t,e){1&t&&(Nr(0,"tbody"),Nr(1,"tr"),Nr(2,"td"),mo(3),Ua(4,"translate"),Fr(),Nr(5,"td"),mo(6),Ua(7,"translate"),Fr(),Fr(),Nr(8,"tr"),Nr(9,"td"),mo(10),Ua(11,"translate"),Fr(),Nr(12,"td"),mo(13),Ua(14,"translate"),Fr(),Fr(),Fr()),2&t&&(_n(3),fo(Oa(4,4,"keyMetrics.finishedDeadline")),_n(3),fo(Oa(7,6,"keyMetrics.longFinishedDeadline")),_n(4),fo(Oa(11,8,"keyMetrics.unfinishedDeadline")),_n(3),fo(Oa(14,10,"keyMetrics.longUnfinishedDeadline")))}function aS(t,e){1&t&&(Nr(0,"tbody"),Nr(1,"tr"),Nr(2,"td"),mo(3),Ua(4,"translate"),Fr(),Nr(5,"td"),mo(6),Ua(7,"translate"),Fr(),Fr(),Nr(8,"tr"),Nr(9,"td"),mo(10),Ua(11,"translate"),Fr(),Nr(12,"td"),mo(13),Ua(14,"translate"),Fr(),Fr(),Nr(15,"tr"),Nr(16,"td"),mo(17),Ua(18,"translate"),Fr(),Nr(19,"td"),mo(20),Ua(21,"translate"),Fr(),Fr(),Nr(22,"tr"),Nr(23,"td"),mo(24),Ua(25,"translate"),Fr(),Nr(26,"td"),mo(27),Ua(28,"translate"),Fr(),Fr(),Fr()),2&t&&(_n(3),fo(Oa(4,8,"keyMetrics.shortADV")),_n(3),fo(Oa(7,10,"keyMetrics.longADV")),_n(4),fo(Oa(11,12,"keyMetrics.shortPDV")),_n(3),fo(Oa(14,14,"keyMetrics.longPDV")),_n(4),fo(Oa(18,16,"keyMetrics.shortEDVC")),_n(3),fo(Oa(21,18,"keyMetrics.longEDVC")),_n(4),fo(Oa(25,20,"keyMetrics.shortDVAC")),_n(3),fo(Oa(28,22,"keyMetrics.longDVAC")))}let lS=(()=>{class t{constructor(t,e,i,n,s,r){this.visboprojectversionService=t,this.messageService=e,this.alertService=i,this.route=n,this.router=s,this.translate=r,this.switchViewChild=new Ra,this.visbokeymetrics=[],this.allViews=["KeyMetrics","Capacity","Cost","Deadline","Delivery","All"],this.currentView="KeyMetrics",this.currentViewKM=!1,this.refDate=new Date,this.chart=!0,this.history=!1,this.parentThis=this,this.typeMetricList=[{name:"Total & Actual Cost",metric:"Cost"},{name:"Delivery Completion",metric:"Delivery"},{name:"Reached Deadlines",metric:"Deadline"},{name:"Ahead/Delay Deadlines",metric:"DeadlineDelay"},{name:"Ahead/Delay Deliveries",metric:"DeliveryDelay"},{name:"Project End Date",metric:"EndDate"}],this.typeMetric=this.typeMetricList[0].name,this.colors=[],this.colorsDefault=["#458CCB","#F7941E","#458CCB","#F7941E","#996600","#996600"],this.colorsDelay=["#BDBDBD","#458CCB"],this.colorsEndDate=["#458CCB","#F7941E"],this.seriesDefault={0:{lineWidth:4,pointShape:"star",lineDashStyle:void 0,pointSize:void 0},1:{lineWidth:4,pointShape:"triangle",lineDashStyle:void 0,pointSize:void 0},2:{lineWidth:4,pointShape:"star",lineDashStyle:[4,8,8,4],pointSize:void 0},3:{lineWidth:4,pointShape:"triangle",lineDashStyle:[8,4,4,8],pointSize:void 0},4:{lineWidth:1,pointShape:"circle",lineDashStyle:void 0,pointSize:4},5:{lineWidth:1,pointShape:"circle",lineDashStyle:[8,4,4,8],pointSize:4}},this.seriesEndDate={0:{lineWidth:4,pointShape:"star",lineDashStyle:[4,8,8,4],pointSize:void 0},1:{lineWidth:4,pointShape:"triangle",lineDashStyle:[8,4,4,8],pointSize:void 0}},this.graphDataLineChart=[],this.graphOptionsLineChart={width:"100%",title:"Comparison: plan-to-date vs. baseline",animation:{startup:!0,duration:200},legend:{position:"top"},explorer:{actions:["dragToZoom","rightClickToReset"],maxZoomIn:.01},tooltip:{isHtml:!0},vAxis:{minValue:void 0,maxValue:void 0,direction:1,title:"KeyMetrics",minorGridlines:{count:0,color:"none"},ticks:void 0},hAxis:{format:"MMM yy",gridlines:{count:-1},minorGridlines:{count:0,color:"none"}},pointSize:14,curveType:"function",series:this.seriesDefault,colors:this.colorsDefault},this.graphOptionsLineChartEndDate={width:"100%",title:"Comparison: plan-to-date vs. baseline",animation:{startup:!0,duration:200},legend:{position:"top"},explorer:{actions:["dragToZoom","rightClickToReset"],maxZoomIn:.01},tooltip:{isHtml:!0},vAxis:{minValue:void 0,maxValue:void 0,direction:1,title:"KeyMetrics",minorGridlines:{count:0,color:"none"},ticks:void 0},hAxis:{format:"MMM yy",gridlines:{count:-1},minorGridlines:{count:0,color:"none"}},pointSize:14,curveType:"function",series:this.seriesEndDate,colors:this.colorsEndDate},this.sortAscending=!1,this.sortColumn=1,this.permVC=Iv,this.permVP=Sv}ngOnInit(){this.currentLang=this.translate.currentLang,this.chartButton=this.translate.instant("vpKeyMetric.lbl.viewList"),this.historyButton=this.translate.instant("vpKeyMetric.lbl.showTrend"),this.initSettings(),this.visboKeyMetricsCalc()}ngOnChanges(){this.log("KeyMetrics Changes  "+this.vpvid),this.initSettings(),this.visboKeyMetricsCalc()}initSettings(){this.route.snapshot.queryParams.refDate&&(this.refDate=new Date(this.route.snapshot.queryParams.refDate));const t=this.route.snapshot.queryParams.variantID;t!=this.variantID&&(this.typeMetricChart=void 0,this.variantID=t)}hasKM(t,e){let i=!1;return!!t&&("Cost"==e?i=t.costCurrentTotal>0||t.costBaseLastTotal>0:"Deadline"==e?i=t.timeCompletionCurrentTotal>1||t.timeCompletionBaseLastTotal>1:"EndDate"==e?i=null!=t.endDateCurrent||null!=t.endDateBaseLast:"DeadlineDelay"===e?(t.timeCompletionCurrentTotal>1||t.timeCompletionBaseLastTotal>1)&&(i=void 0!==t.timeDelayFinished||void 0!==t.timeDelayUnFinished):"Delivery"==e?i=t.deliverableCompletionCurrentTotal>0||t.deliverableCompletionBaseLastTotal>0:"DeliveryDelay"===e&&(i=void 0!==t.deliverableDelayFinished||void 0!==t.deliverableDelayUnFinished),i)}visboKeyMetricsCalc(){if(this.visbokeymetrics=[],this.visboprojectversions){this.log("calc keyMetrics LEN "+this.visboprojectversions.length);for(let t=0;t<this.visboprojectversions.length;t++)if(this.visboprojectversions[t].keyMetrics){const e=new MV;e.name=this.visboprojectversions[t].name,e._id=this.visboprojectversions[t]._id,e.timestamp=this.visboprojectversions[t].timestamp,e.vpid=this.visboprojectversions[t].vpid,e.variantName=this.visboprojectversions[t].variantName,e.startDate=this.visboprojectversions[t].startDate,e.Risiko=this.visboprojectversions[t].Risiko,e.StrategicFit=this.visboprojectversions[t].StrategicFit,e.leadPerson=this.visboprojectversions[t].leadPerson,e.status=this.visboprojectversions[t].status,e.ampelStatus=this.visboprojectversions[t].ampelStatus,e.ampelErlaeuterung=this.visboprojectversions[t].ampelErlaeuterung,e.VorlagenName=this.visboprojectversions[t].VorlagenName,e.complexity=this.visboprojectversions[t].complexity,e.description=this.visboprojectversions[t].description,e.businessUnit=this.visboprojectversions[t].businessUnit,e.keyMetrics=this.visboprojectversions[t].keyMetrics,e.savingCostTotal=Math.round(100*(1-(e.keyMetrics.costCurrentTotal||0)/(e.keyMetrics.costBaseLastTotal||1)))||0,e.savingCostTotal=Math.round(e.savingCostTotal),e.savingCostActual=100*(1-(e.keyMetrics.costCurrentActual||0)/(e.keyMetrics.costBaseLastActual||1))||0,e.keyMetrics.endDateBaseLast&&e.keyMetrics.endDateCurrent&&(e.savingEndDate=this.helperDateDiff(new Date(e.keyMetrics.endDateBaseLast).toISOString(),new Date(e.keyMetrics.endDateCurrent).toISOString(),"w")||0,e.savingEndDate=Math.round(10*e.savingEndDate)/10),e.deliveryCompletionTotal=e.keyMetrics.deliverableCompletionBaseLastTotal?Math.round((e.keyMetrics.deliverableCompletionCurrentTotal||0)/e.keyMetrics.deliverableCompletionBaseLastTotal*100):100,e.deliveryCompletionActual=e.keyMetrics.deliverableCompletionBaseLastActual?Math.round((e.keyMetrics.deliverableCompletionCurrentActual||0)/e.keyMetrics.deliverableCompletionBaseLastActual*100):100,e.timeCompletionTotal=e.keyMetrics.timeCompletionBaseLastTotal?Math.round((e.keyMetrics.timeCompletionCurrentTotal||0)/e.keyMetrics.timeCompletionBaseLastTotal*100):100,e.timeCompletionActual=e.keyMetrics.timeCompletionBaseLastActual?Math.round((e.keyMetrics.timeCompletionCurrentActual||0)/e.keyMetrics.timeCompletionBaseLastActual*100):100,this.visbokeymetrics.push(e)}if(this.log("calc keyMetrics Result LEN "+this.visbokeymetrics.length),this.visbokeymetrics.length>0){this.sortKeyMetricsTable(void 0);let t=0;if(this.refDate){for(;t<this.visbokeymetrics.length&&!(Th(this.refDate,new Date(this.visbokeymetrics[t].timestamp))>=0);t++);t>=this.visbokeymetrics.length&&(t=this.visbokeymetrics.length-1)}this.setVpvActive(this.visbokeymetrics[t])}else this.switchView("All")}}sameDay(t,e){const i=new Date(t),n=new Date(e);return i.setHours(0,0,0,0),n.setHours(0,0,0,0),i.getTime()===n.getTime()}visboKeyMetricsCostOverTime(){this.graphOptionsLineChart.title=this.translate.instant("keyMetrics.chart.titleCostTrend"),this.graphOptionsLineChart.vAxis.title=this.translate.instant("keyMetrics.chart.yAxisCostTrend"),this.graphOptionsLineChart.colors=this.colorsDefault;const t=[];if(this.visboprojectversions){for(let e=0;e<this.visboprojectversions.length;e++)this.visboprojectversions[e].keyMetrics&&(e<this.visboprojectversions.length-1&&this.sameDay(this.visboprojectversions[e].timestamp,this.visboprojectversions[e+1].timestamp)?this.log(`visboKeyMetrics Skip Same Day ${this.visboprojectversions[e].timestamp}  ${this.visboprojectversions[e+1].timestamp}`):t.push([new Date(this.visboprojectversions[e].timestamp),Math.round(this.visboprojectversions[e].keyMetrics.costCurrentActual||0),Math.round(this.visboprojectversions[e].keyMetrics.costBaseLastActual||0),Math.round(this.visboprojectversions[e].keyMetrics.costCurrentTotal||0),Math.round(this.visboprojectversions[e].keyMetrics.costBaseLastTotal||0)]));if(0===t.length&&(this.log("keyMetricsCost empty"),t.push([new Date,0,0,0,0])),t.sort((function(t,e){return t[0]-e[0]})),1===t.length){const e=new Date(t[0][0]);e.setMonth(e.getMonth()+1),t.push([e,void 0,void 0,void 0,void 0])}t.push(["Timestamp",this.translate.instant("keyMetrics.shortAC"),this.translate.instant("keyMetrics.shortPV"),this.translate.instant("keyMetrics.shortEAC"),this.translate.instant("keyMetrics.shortBAC")]),t.reverse(),this.graphDataLineChart=t}}visboKeyMetricsEndDateOverTime(){this.graphOptionsLineChartEndDate.title=this.translate.instant("keyMetrics.chart.titleEndDateTrend"),this.graphOptionsLineChartEndDate.vAxis.title=this.translate.instant("keyMetrics.chart.yAxisEndDateTrend"),this.graphOptionsLineChartEndDate.colors=this.colorsEndDate;const t=[];if(!this.visboprojectversions)return;let e=Number.MAX_VALUE,i=Number.MIN_VALUE;for(let r=0;r<this.visboprojectversions.length;r++){if(!this.visboprojectversions[r].keyMetrics)continue;if(r<this.visboprojectversions.length-1&&this.sameDay(this.visboprojectversions[r].timestamp,this.visboprojectversions[r+1].timestamp)){this.log(`visboKeyMetrics Skip Same Day ${this.visboprojectversions[r].timestamp}  ${this.visboprojectversions[r+1].timestamp}`);continue}const n=new Date(this.visboprojectversions[r].keyMetrics.endDateCurrent).getTime()||0,s=new Date(this.visboprojectversions[r].keyMetrics.endDateBaseLast).getTime()||0;e=Math.min(e,n),e=Math.min(e,s),i=Math.max(i,n),i=Math.max(i,s);const o=_h(new Date(this.visboprojectversions[r].timestamp),"fullDateTime",this.currentLang),a=_h(new Date(this.visboprojectversions[r].keyMetrics.endDateCurrent),"fullDate",this.currentLang),l=_h(new Date(this.visboprojectversions[r].keyMetrics.endDateBaseLast),"fullDate",this.currentLang);t.push([new Date(this.visboprojectversions[r].timestamp),n,this.createCustomHTMLContent(o,a,l),s,this.createCustomHTMLContent(o,a,l)])}if(0===t.length&&(this.log("keyMetricsEndDate empty"),t.push([new Date,void 0,void 0,void 0,void 0])),t.sort((function(t,e){return t[0]-e[0]})),1===t.length){const e=new Date(t[0][0]);e.setMonth(e.getMonth()+1),t.push([e,void 0,void 0,void 0,void 0])}const n=new Date(e);n.setDate(1),n.setHours(0,0,0,0),n.setMonth(n.getMonth()-1);const s=new Date(i);for(s.setDate(1),s.setHours(0,0,0,0),s.setMonth(s.getMonth()+2),e=n.getTime(),i=s.getTime(),this.graphOptionsLineChartEndDate.vAxis.ticks=[];n.getTime()<=s.getTime();)this.graphOptionsLineChartEndDate.vAxis.ticks.push({v:n.getTime(),f:_h(n,"shortDate",this.currentLang)}),n.setMonth(n.getMonth()+1);t.unshift(["Timestamp",this.translate.instant("keyMetrics.shortEED"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("keyMetrics.shortBED"),{type:"string",role:"tooltip",p:{html:!0}}]),this.graphDataLineChart=t}createCustomHTMLContent(t,e,i){let n='<div style="padding:5px 5px 5px 5px;color:black;width:180px;"><div><b>'+t+"</b></div><div><table>";return n=n+"<tr><td>"+this.translate.instant("keyMetrics.longEED")+':</td><td align="right"><b>'+e+"</b></td></tr>",n=n+"<tr><td>"+this.translate.instant("keyMetrics.longBED")+':</td><td align="right"><b>'+i+"</b></td></tr>",n+="</table></div></div>",n}visboKeyMetricsDeliveryOverTime(){this.graphOptionsLineChart.title=this.translate.instant("keyMetrics.chart.titleDeliveryTrend"),this.graphOptionsLineChart.vAxis.title=this.translate.instant("keyMetrics.chart.yAxisDeliveryTrend"),this.graphOptionsLineChart.colors=this.colorsDefault;const t=[];if(!this.visboprojectversions)return;for(let i=0;i<this.visboprojectversions.length;i++)this.visboprojectversions[i].keyMetrics&&(i<this.visboprojectversions.length-1&&this.sameDay(this.visboprojectversions[i].timestamp,this.visboprojectversions[i+1].timestamp)||t.push([new Date(this.visboprojectversions[i].timestamp),Math.round(100*(this.visboprojectversions[i].keyMetrics.deliverableCompletionCurrentActual||0))/100,Math.round(100*(this.visboprojectversions[i].keyMetrics.deliverableCompletionBaseLastActual||0))/100,Math.round(100*(this.visboprojectversions[i].keyMetrics.deliverableCompletionCurrentTotal||0))/100,Math.round(100*(this.visboprojectversions[i].keyMetrics.deliverableCompletionBaseLastTotal||0))/100]));if(0===t.length&&(this.log("visboKeyMetrics empty"),t.push([new Date,0,0,0,0])),t.sort((function(t,e){return t[0]-e[0]})),1===t.length){const e=new Date(t[0][0]);e.setMonth(e.getMonth()+1),t.push([e,void 0,void 0,void 0,void 0])}const e=this.calcRangeAxis(t,"Delivery");this.graphOptionsLineChart.vAxis.maxValue=e,this.graphOptionsLineChart.vAxis.minValue=-e,t.push(["Timestamp",this.translate.instant("keyMetrics.shortADV"),this.translate.instant("keyMetrics.shortPDV"),this.translate.instant("keyMetrics.shortEDVC"),this.translate.instant("keyMetrics.shortDVAC")]),t.reverse(),this.log("visboKeyMetrics VP Delivery Completion  "+JSON.stringify(this.graphOptionsLineChart)),this.graphDataLineChart=t}visboKeyMetricsDeadlineOverTime(){this.graphOptionsLineChart.title=this.translate.instant("keyMetrics.chart.titleDeadlineTrend"),this.graphOptionsLineChart.vAxis.title=this.translate.instant("keyMetrics.chart.yAxisDeadlineTrend"),this.graphOptionsLineChart.colors=this.colorsDefault;const t=[];if(!this.visboprojectversions)return;for(let n=0;n<this.visboprojectversions.length;n++)this.visboprojectversions[n].keyMetrics&&(n<this.visboprojectversions.length-1&&this.sameDay(this.visboprojectversions[n].timestamp,this.visboprojectversions[n+1].timestamp)?this.log(`visboKeyMetrics Skip Same Day  ${this.visboprojectversions[n].timestamp} ${this.visboprojectversions[n+1].timestamp}`):t.push([new Date(this.visboprojectversions[n].timestamp),Math.round(100*(this.visboprojectversions[n].keyMetrics.timeCompletionCurrentActual||0))/100,Math.round(100*(this.visboprojectversions[n].keyMetrics.timeCompletionBaseLastActual||0))/100,Math.round(100*(this.visboprojectversions[n].keyMetrics.timeCompletionCurrentTotal||0))/100,Math.round(100*(this.visboprojectversions[n].keyMetrics.timeCompletionBaseLastTotal||0))/100]));0===t.length&&(this.log("visboKeyMetrics empty"),t.push([new Date,0,0,0,0])),t.sort((function(t,e){return t[0]-e[0]}));const e=t.length;if(this.log(`visboKeyMetrics duplicate ${e-1} ${JSON.stringify(this.visboprojectversions[e-1])}`),1===e){const e=new Date(t[0][0]);e.setMonth(e.getMonth()+1),t.push([e,void 0,void 0,void 0,void 0])}const i=this.calcRangeAxis(t,"Deadline");this.graphOptionsLineChart.vAxis.maxValue=i,this.graphOptionsLineChart.vAxis.minValue=-i,t.push(["Timestamp",this.translate.instant("keyMetrics.shortAD"),this.translate.instant("keyMetrics.shortPD"),this.translate.instant("keyMetrics.shortEDC"),this.translate.instant("keyMetrics.shortDAC")]),t.reverse(),this.graphDataLineChart=t}visboKeyMetricsDeadlineDelayOverTime(){this.graphOptionsLineChart.title=this.translate.instant("keyMetrics.chart.titleDeadlineDelayTrend"),this.graphOptionsLineChart.vAxis.title=this.translate.instant("keyMetrics.chart.yAxisDeadlineDelayTrend"),this.graphOptionsLineChart.vAxis.direction=-1,this.graphOptionsLineChart.colors=this.colorsDelay;const t=[];if(!this.visboprojectversions)return;for(let n=0;n<this.visboprojectversions.length;n++)this.visboprojectversions[n].keyMetrics&&(n<this.visboprojectversions.length-1&&this.sameDay(this.visboprojectversions[n].timestamp,this.visboprojectversions[n+1].timestamp)?this.log(`visboKeyMetrics Skip Same Day  ${this.visboprojectversions[n].timestamp} ${this.visboprojectversions[n+1].timestamp}`):t.push([new Date(this.visboprojectversions[n].timestamp),this.visboprojectversions[n].keyMetrics.timeDelayFinished,this.visboprojectversions[n].keyMetrics.timeDelayUnFinished]));0===t.length&&(this.log("visboKeyMetrics empty"),t.push([new Date,0,0])),t.sort((function(t,e){return t[0]-e[0]}));const e=t.length;if(this.log(`visboKeyMetrics duplicate ${e-1} ${JSON.stringify(this.visboprojectversions[e-1])}`),1===e){const e=new Date(t[0][0]);e.setMonth(e.getMonth()+1),t.push([e,void 0,void 0])}const i=this.calcRangeAxis(t,"Delay");this.graphOptionsLineChart.vAxis.maxValue=i,this.graphOptionsLineChart.vAxis.minValue=-i,t.push(["Timestamp",this.translate.instant("keyMetrics.finishedDeadlineDelay"),this.translate.instant("keyMetrics.unfinishedDeadlineDelay")]),t.reverse(),this.graphDataLineChart=t}visboKeyMetricsDeliveryDelayOverTime(){this.graphOptionsLineChart.title=this.translate.instant("keyMetrics.chart.titleDeliveryDelayTrend"),this.graphOptionsLineChart.vAxis.title=this.translate.instant("keyMetrics.chart.yAxisDeliveryDelayTrend"),this.graphOptionsLineChart.vAxis.direction=-1,this.graphOptionsLineChart.colors=this.colorsDelay;const t=[];if(!this.visboprojectversions)return;for(let n=0;n<this.visboprojectversions.length;n++)this.visboprojectversions[n].keyMetrics&&(n<this.visboprojectversions.length-1&&this.sameDay(this.visboprojectversions[n].timestamp,this.visboprojectversions[n+1].timestamp)?this.log(`visboKeyMetrics Skip Same Day  ${this.visboprojectversions[n].timestamp} ${this.visboprojectversions[n+1].timestamp}`):t.push([new Date(this.visboprojectversions[n].timestamp),this.visboprojectversions[n].keyMetrics.deliverableDelayFinished,this.visboprojectversions[n].keyMetrics.deliverableDelayUnFinished]));0===t.length&&(this.log("visboKeyMetrics empty"),t.push([new Date,0,0])),t.sort((function(t,e){return t[0]-e[0]}));const e=t.length;if(this.log(`visboKeyMetrics duplicate ${e-1} ${JSON.stringify(this.visboprojectversions[e-1])}`),1===e){const e=new Date(t[0][0]);e.setMonth(e.getMonth()+1),t.push([e,void 0,void 0])}const i=this.calcRangeAxis(t,"Delay");this.graphOptionsLineChart.vAxis.maxValue=i,this.graphOptionsLineChart.vAxis.minValue=-i,t.push(["Timestamp",this.translate.instant("keyMetrics.finishedDeliveryDelay"),this.translate.instant("keyMetrics.unfinishedDeliveryDelay")]),t.reverse(),this.graphDataLineChart=t}calcRangeAxis(t,e){let i=0;i=0;for(let n=0;n<t.length;n++)switch(e){case"Delivery":case"Deadline":i=Math.max(i,Math.abs(t[n][1]))}return i*=1.1,this.log(`RangeAxis for ${e}: ${i}`),i}switchChart(){this.chart=!this.chart,this.chartButton=this.translate.instant(this.chart?"vpKeyMetric.lbl.viewList":"vpKeyMetric.lbl.viewChart")}showHistory(t){this.history=t,this.historyButton=this.translate.instant(this.history?"vpKeyMetric.lbl.hideTrend":"vpKeyMetric.lbl.showTrend")}switchView(t,e=!1){(t=this.allViews.find(e=>e===t))?this.typeMetricChart=t:t=this.allViews[0],this.currentView=t,this.currentViewKM=e,this.showHistory(!1),this.updateUrlParam(e?"viewKM":"view",t)}switchToHistory(t){if(this.log(`Switch Chart from ${this.typeMetricChart} to ${t} `),this.currentView="KeyMetrics",this.updateUrlParam("view",this.currentView),this.typeMetricChart===t)return void this.showHistory(!this.history);const e=this.typeMetricList.find(e=>e.metric===t).name;if(e)switch(this.typeMetricChart=t,this.typeMetric=e,this.showHistory(!0),t){case"Cost":this.visboKeyMetricsCostOverTime();break;case"EndDate":this.visboKeyMetricsEndDateOverTime();break;case"Deadline":this.visboKeyMetricsDeadlineOverTime();break;case"DeadlineDelay":this.visboKeyMetricsDeadlineDelayOverTime();break;case"DeliveryDelay":this.visboKeyMetricsDeliveryDelayOverTime();break;case"Delivery":this.visboKeyMetricsDeliveryOverTime()}}gotoVisboProjectVersions(){let t;this.log("goto VPV All Versions"),this.vpvKeyMetricActive&&(t=this.vpvKeyMetricActive.vpid),t&&this.router.navigate(["vpv/".concat(t)],{})}updateUrlParam(t,e,i=!1){const n=this.route.snapshot.url.join("/");void 0===e&&(e=null);const s=new yb;"view"==t?s.view=e:"viewKM"==t?s.viewKM=e:"refDate"==t&&(s.refDate=e),this.switchViewChild.emit(s),this.router.navigate([n],{queryParams:s,replaceUrl:!i,queryParamsHandling:"merge"})}chartSelectRow(t,e,i){this.log(`Line Chart: User selected row ${t} col ${e} Label ${i} Len ${this.graphDataLineChart.length}`);const n=new Date(i);let s=this.visbokeymetrics.findIndex(t=>t.timestamp.toString()===n.toISOString());s<0&&(s=0),this.setVpvActive(this.visbokeymetrics[s],!0),this.log(`Line Chart: User selected ${t} ${e} ${this.vpvKeyMetricActive._id} ${this.vpvKeyMetricActive.timestamp}`)}listSelectRow(t){this.log(`List: User selected ${t._id} ${t.name}`),this.setVpvActive(t,!0)}setVpvActive(t,e=!1){if(!t)return;this.refDate=new Date(t.timestamp);const i=t.keyMetrics;let n;if(this.vpvKeyMetricActive=t,this.log(`VPV Active: vpv: ${t._id} ${this.vpvKeyMetricActive._id} ${this.vpvKeyMetricActive.timestamp}`),e&&this.updateUrlParam("refDate",t.timestamp.toString()),n=i.costCurrentActual/(i.costBaseLastActual||1),this.qualityCost=n<1.001?1:n<1.05?2:3,n=i.costCurrentTotal/(i.costBaseLastTotal||1),this.qualityTotalCost=n<1.001?1:n<1.05?2:3,i.endDateBaseLast){const t=i.endDateCurrent?new Date(i.endDateCurrent):new Date,e=new Date(i.endDateBaseLast);n=(t.getTime()-e.getTime())/1e3/3600/24/7,this.qualityEndDiffWeeks=n}else n=void 0;this.qualityEndDate=n<=0?1:n<=4?2:n>4?3:void 0,n=i.timeCompletionBaseLastActual?i.timeCompletionCurrentActual/i.timeCompletionBaseLastActual:1,this.qualityDeadline=n>.999?1:n>.95?2:3,n=i.deliverableCompletionBaseLastActual?i.deliverableCompletionCurrentActual/i.deliverableCompletionBaseLastActual:1,this.qualityDelivery=n>.999?1:n>.95?2:3,n=i.deliverableDelayFinished||0,this.delayActualDelivery=n<=0?1:n>7?2:3,n=i.deliverableDelayUnFinished||0,this.delayTotalDelivery=n<=0?1:n>7?2:3,n=i.timeDelayFinished||0,this.delayActualDeadline=n<=0?1:n<=7?2:3,n=i.timeDelayUnFinished||0,this.delayTotalDeadline=n<=0?1:n<=7?2:3,n=new Date(i.endDateCurrent).getTime()-new Date(i.endDateBaseLast).getTime(),this.delayEndDate=Math.round(n/1e3/60/60/24)/7,this.log(`Quality End Date ${i.endDateCurrent} Cost ${this.qualityCost} Del. ${this.qualityDelivery} Dead. ${this.qualityDeadline} EndDate ${this.delayEndDate}, Delay Deadline ${this.delayActualDeadline} / ${this.delayTotalDeadline} Delay Delivery ${this.delayActualDelivery} / ${this.delayTotalDelivery} `)}helperDateDiff(t,e,i){const n=new Date(t),s=new Date(e);let r=n.getTime()-s.getTime();return"w"===i?r=r/1e3/60/60/24/7:"d"===i?r=r/1e3/60/60/24:r/=1e3,r}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}sortKeyMetricsTable(t){this.visbokeymetrics&&(void 0!==t?(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t:!this.sortAscending):(this.sortColumn=1,this.sortAscending=!1),this.log(`Sort Key Metrics: Col ${t} Asc ${this.sortAscending}`),1===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return Th(t.timestamp,e.timestamp)})):2===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.savingCostActual-e.savingCostActual})):3===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.savingCostTotal-e.savingCostTotal})):4===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.costBaseLastActual)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.costBaseLastActual)||0)})):5===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.costBaseLastTotal)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.costBaseLastTotal)||0)})):6===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.ampelStatus-e.ampelStatus})):7===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.costCurrentActual)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.costCurrentActual)||0)})):8===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.costCurrentTotal)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.costCurrentTotal)||0)})):10===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.timeCompletionCurrentActual)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.timeCompletionCurrentActual)||0)})):11===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.timeCompletionActual-e.timeCompletionActual})):12===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.timeCompletionBaseLastTotal)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.timeCompletionBaseLastTotal)||0)})):13===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.timeDelayFinished)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.timeDelayFinished)||0)})):14===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.timeDelayUnFinished)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.timeDelayUnFinished)||0)})):20===this.sortColumn?this.visbokeymetrics.sort((function(t,e){return t.deliveryCompletionActual-e.deliveryCompletionActual})):21===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.deliverableCompletionCurrentActual)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.deliverableCompletionCurrentActual)||0)})):22===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.deliverableCompletionCurrentTotal)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.deliverableCompletionCurrentTotal)||0)})):23===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.deliverableDelayFinished)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.deliverableDelayFinished)||0)})):24===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.deliverableDelayUnFinished)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.deliverableDelayUnFinished)||0)})):25===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.deliverableCompletionBaseLastTotal)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.deliverableCompletionBaseLastTotal)||0)})):26===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return((null===(i=t.keyMetrics)||void 0===i?void 0:i.deliverableCompletionBaseLastActual)||0)-((null===(n=e.keyMetrics)||void 0===n?void 0:n.deliverableCompletionBaseLastActual)||0)})):31===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return Th(null===(i=t.keyMetrics)||void 0===i?void 0:i.endDateCurrent,null===(n=e.keyMetrics)||void 0===n?void 0:n.endDateCurrent)})):32===this.sortColumn?this.visbokeymetrics.sort((function(t,e){var i,n;return Th(null===(i=t.keyMetrics)||void 0===i?void 0:i.endDateBaseLast,null===(n=e.keyMetrics)||void 0===n?void 0:n.endDateBaseLast)})):33===this.sortColumn&&this.visbokeymetrics.sort((function(t,e){return t.savingEndDate-e.savingEndDate})),this.sortAscending||this.visbokeymetrics.reverse())}getPreView(){return Rh()}log(t){this.messageService.add("CompVisboViewCost: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(xV),Rr(jh),Rr(Mf),Rr(Bg),Rr(rf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-comp-viewkeymetrics"]],inputs:{vpvid:"vpvid",visboprojectversions:"visboprojectversions",combinedPerm:"combinedPerm"},outputs:{switchViewChild:"switchViewChild"},features:[_e],decls:33,vars:16,consts:[[1,"container"],["class","table table-hover table-sortable",4,"ngIf"],[4,"ngIf"],["indicator",""],["trafficLight",""],["highlight",""],["id","VpvLegend","tabindex","-1","role","dialog","aria-labelledby","VpvDetailsTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-body"],[1,"table"],[1,"modal-footer","align-items-end"],["data-dismiss","modal",1,"btn","btn-primary"],[1,"table","table-hover","table-sortable"],["class","d-none d-md-table-cell d-print-none",4,"ngIf"],[1,"d-none","d-md-table-cell","d-print-none"],[3,"click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"title","click"],["class","d-print-no",4,"ngIf"],[1,"d-print-no"],["type","button",1,"btn",3,"title","click"],[3,"title"],[1,"ml-1"],["class","ml-1",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[1,"fa",3,"ngClass"],[1,"fas","fa-lightbulb",3,"ngClass"],[3,"ngClass"],[1,"btn-group","row"],[1,"mx-1",3,"click"],["type","button","class","mx-1",3,"click",4,"ngIf"],["data-toggle","modal","data-target","#VpvLegend",1,"fas","fa-info-circle","mx-2","mt-2","text-secondary",3,"title"],["class","mt-1",4,"ngIf"],["type","button",1,"mx-1",3,"click"],[1,"mt-1"],[3,"graphData","graphOptions","parentThis","language"],[1,"text-right",3,"title","click"],[1,"text-right","d-none","d-md-table-cell",3,"title","click"],[1,"text-right","d-none","d-md-table-cell",3,"click"],["data-toggle","modal","data-target","#ProjectDetail",3,"click",4,"ngFor","ngForOf"],["data-toggle","modal","data-target","#ProjectDetail",3,"click"],[1,"text-right"],[1,"text-right",3,"title"],[1,"text-right",3,"click"],["class","text-right d-none d-md-table-cell",3,"click",4,"ngIf"],["class","text-right",4,"ngIf"]],template:function(t,e){1&t&&(Nr(0,"form"),Nr(1,"div",0),Lr(2,VI,21,17,"table",1),Lr(3,wI,3,3,"h3",2),Fr(),Fr(),Br(4,"hr"),Lr(5,PI,1,5,"ng-template",null,3,ja),Lr(7,DI,1,6,"ng-template",null,4,ja),Lr(9,II,2,5,"ng-template",null,5,ja),Lr(11,nS,9,7,"div",2),Nr(12,"div",6),Nr(13,"div",7),Nr(14,"div",8),Nr(15,"div",9),Nr(16,"table",10),Nr(17,"thead"),Nr(18,"tr"),Nr(19,"th"),mo(20),Ua(21,"translate"),Fr(),Nr(22,"th"),mo(23),Ua(24,"translate"),Fr(),Fr(),Fr(),Lr(25,sS,29,24,"tbody",2),Lr(26,rS,29,24,"tbody",2),Lr(27,oS,15,12,"tbody",2),Lr(28,aS,29,24,"tbody",2),Fr(),Nr(29,"div",11),Nr(30,"button",12),mo(31),Ua(32,"translate"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr()),2&t&&(_n(2),jr("ngIf",e.vpvKeyMetricActive),_n(1),jr("ngIf",!e.vpvKeyMetricActive),_n(8),jr("ngIf",e.history&&"KeyMetrics"==e.currentView),_n(9),fo(Oa(21,10,"keyMetrics.lbl.shortcut")),_n(3),fo(Oa(24,12,"keyMetrics.lbl.explanation")),_n(2),jr("ngIf","Cost"==e.typeMetricChart),_n(1),jr("ngIf","Deadline"==e.typeMetricChart),_n(1),jr("ngIf","DeadlineDelay"==e.typeMetricChart),_n(1),jr("ngIf","Delivery"==e.typeMetricChart),_n(3),fo(Oa(32,14,"vpKeyMetric.btn.back")))},directives:[Eu,Fd,Tu,jc,Bc,Ec,EM,Gc],pipes:[lv,zc,qc],encapsulation:2}),t})();function cS(t,e){1&t&&qr(0)}function dS(t,e){1&t&&qr(0)}const uS=function(t){return{level:t}};function hS(t,e){if(1&t&&(Nr(0,"div",16),Nr(1,"h5",17),Nr(2,"strong",18),Lr(3,cS,1,0,"ng-container",19),Fr(),mo(4),Ua(5,"translate"),Fr(),Nr(6,"div",20),Nr(7,"div",21),Nr(8,"div",22),mo(9),Ua(10,"translate"),Ua(11,"translate"),Fr(),Nr(12,"div",23),Nr(13,"strong",18),Lr(14,dS,1,0,"ng-container",19),Fr(),mo(15),Ua(16,"number"),Fr(),Fr(),Nr(17,"div",21),Nr(18,"div",22),mo(19),Ua(20,"translate"),Ua(21,"translate"),Fr(),Nr(22,"div",23),mo(23),Ua(24,"number"),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr(2),e=Gr(2);_n(3),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(27,uS,t.getLevel(t.vpvTotalCostCurrent,t.vpvTotalCostBaseLine))),_n(1),vo(" ",Oa(5,11,"compViewCost.titleBox"),""),_n(5),bo(" ",Oa(10,13,"keyMetrics.shortEAC")," (",Oa(11,15,"keyMetrics.longEAC"),") "),_n(5),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(29,uS,t.getLevel(t.vpvTotalCostCurrent,t.vpvTotalCostBaseLine))),_n(1),vo(" ",Ea(16,17,t.vpvTotalCostCurrent,"1.0-0")," T\u20ac "),_n(4),bo(" ",Oa(20,20,"keyMetrics.shortBAC")," (",Oa(21,22,"keyMetrics.longBAC"),") "),_n(4),vo(" ",Ea(24,24,t.vpvTotalCostBaseLine,"1.0-0")," T\u20ac ")}}function pS(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-combo-chart",24),Fr()),2&t){const t=Xr(2);_n(1),jr("graphData",t.graphDataComboChart)("graphOptions",t.graphOptionsComboChart)("parentThis",t.parentThis)("language",t.currentLang)}}function gS(t,e){1&t&&(Nr(0,"div"),Nr(1,"h3",25),mo(2),Ua(3,"translate"),Fr(),Fr()),2&t&&(_n(2),vo(" ",Oa(3,1,"compViewCost.msg.noCost")," "))}function mS(t,e){if(1&t){const t=zr();Nr(0,"div",9),Jr("resized",(function(e){return ei(t),Xr().onResized(e)})),Nr(1,"div",10),Nr(2,"div",11),Br(3,"div",12),Fr(),Lr(4,hS,25,31,"div",13),Fr(),Lr(5,pS,2,4,"div",14),Lr(6,gS,4,3,"div",14),Br(7,"i",15),Ua(8,"translate"),Fr()}if(2&t){const t=Xr();_n(4),jr("ngIf",t.vpHasCost("")),_n(1),jr("ngIf",t.graphDataComboChart.length>0),_n(1),jr("ngIf",!t.vpHasCost("cost")),_n(1),to("title",Oa(8,4,"keyMetrics.lbl.showLegend"))}}const fS=function(t,e,i){return{"fa-check-circle text-success":t,"fa-exclamation-triangle text-warning":e,"fa-exclamation-circle text-danger":i}};function vS(t,e){if(1&t&&(Nr(0,"strong"),Br(1,"i",26),Fr()),2&t){const t=e.level;_n(1),jr("ngClass",Ma(1,fS,1==t,2==t,3==t))}}let bS=(()=>{class t{constructor(t,e,i,n,s,r){this.visboprojectversionService=t,this.messageService=e,this.alertService=i,this.route=n,this.router=s,this.translate=r,this.parentThis=this,this.colors=["#F7941E","#BDBDBD","#458CCB"],this.graphDataComboChart=[],this.graphOptionsComboChart={width:"100%",title:"Monthly Cost comparison: plan-to-date vs. baseline",animation:{startup:!0,duration:200},legend:{position:"top"},explorer:{actions:["dragToZoom","rightClickToReset"],maxZoomIn:.01},colors:this.colors,seriesType:"bars",series:{0:{type:"line",lineWidth:4,pointSize:0}},isStacked:!0,tooltip:{isHtml:!0},vAxis:{title:"Monthly Cost",format:"# T\u20ac",minorGridlines:{count:0,color:"none"}},hAxis:{format:"MMM yy",gridlines:{color:"#FFF",count:-1}},minorGridlines:{count:0,color:"none"}},this.permVC=Iv,this.permVP=Sv}ngOnInit(){this.currentLang=this.translate.currentLang,this.visboCostCalc()}ngOnChanges(){this.log(`Cost Changes  ${this.vpvActive._id} ${this.vpvActive.timestamp}`),this.chartActive=void 0,void 0!==this.currentVpvId&&this.vpvActive._id!==this.currentVpvId&&this.visboCostCalc()}onResized(t){t||this.log("No event in Resize");let e=0;this.chartActive&&(e=(new Date).getTime()-this.chartActive.getTime()),e<1e3||(this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(()=>{this.visboCostCalc(),this.timeoutID=void 0},500))}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}visboCostCalc(){this.vpvActive&&(this.currentVpvId=this.vpvActive._id,this.log(`Cost Calc for Version  ${this.vpvActive._id} ${this.vpvActive.timestamp}`),this.visboprojectversionService.getCost(this.vpvActive._id).subscribe(t=>{this.log(`get VPV Calc: Get ${t.length} vpvs with ${t[0].cost.length} cost entries`),1===t.length&&t[0].cost?(this.log(`Store Cost for ${t[0]._id} Len ${t[0].cost.length} Actual ${t[0].actualDataUntil}`),this.vpvCost=t[0].cost,this.vpvActualDataUntil=new Date(t[0].actualDataUntil)):(this.log("get VPV Calc: Reset Cost to empty "),this.vpvCost=[]),this.visboViewCostOverTime()},t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("compViewCost.msg.errorPermVersion",{name:this.vpvActive.name});this.alertService.error(t)}else this.alertService.error(Gh(t))}))}visboViewCostOverTime(){this.graphOptionsComboChart.title=this.translate.instant("keyMetrics.chart.titleCostOverTime"),this.graphOptionsComboChart.vAxis.title=this.translate.instant("keyMetrics.chart.yAxisCostOverTime");const t=[];if(!this.vpvCost)return;const e=this.vpvCost,i=this.vpvActualDataUntil.getTime();if(this.log("ViewCostOverTime Actual Until "+this.vpvActualDataUntil),0===e.length)return;this.vpvTotalCostBaseLine=0,this.vpvTotalCostCurrent=0;for(let s=0;s<e.length;s++)new Date(e[s].currentDate).getTime()<i?t.push([new Date(e[s].currentDate),Math.round(10*e[s].baseLineCost)/10||0,this.createCustomHTMLContent(e[s],!0),Math.round(10*e[s].currentCost)/10||0,this.createCustomHTMLContent(e[s],!0),0,""]):t.push([new Date(e[s].currentDate),Math.round(10*e[s].baseLineCost)/10||0,this.createCustomHTMLContent(e[s],!1),0,"",Math.round(10*e[s].currentCost)/10||0,this.createCustomHTMLContent(e[s],!1)]),this.vpvTotalCostBaseLine+=e[s].baseLineCost||0,this.vpvTotalCostCurrent+=e[s].currentCost||0;0===t.length&&(this.log("ViewCostOverTime Result empty"),t.push([new Date,0,"",0,0]));const n=t.length;if(n<1&&this.log("ViewCostOverTime Empty"),1===n){const e=new Date(t[0][0]);e.setMonth(e.getMonth()+1),t.push([e,void 0,void 0,void 0,void 0,void 0,void 0,void 0])}t.unshift(["Timestamp",this.translate.instant("keyMetrics.baselinePV"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("keyMetrics.planAC"),{type:"string",role:"tooltip",p:{html:!0}},this.translate.instant("keyMetrics.planETC"),{type:"string",role:"tooltip",p:{html:!0}}]),this.graphDataComboChart=t,this.chartActive=new Date}chartSelectRow(t,e,i){this.log(`chart Select Row ${t} ${e} ${i} `)}createCustomHTMLContent(t,e){let i='<div style="padding:5px 5px 5px 5px;color:black;width:180px;"><div><b>'+_h(new Date(t.currentDate),"shortDate",this.currentLang)+"</b></div><div><table>";const n=this.translate.instant("keyMetrics.baselinePV"),s=this.translate.instant("keyMetrics.planAC"),r=this.translate.instant("keyMetrics.planETC");return i=i+"<tr><td>"+n+':</td><td align="right"><b>'+Math.round(10*t.baseLineCost)/10+" T\u20ac</b></td></tr>",i=i+"<tr><td>"+(e?s:r)+':</td align="right"><td><b>'+Math.round(10*t.currentCost)/10+" T\u20ac</b></td></tr>",i+="</table></div></div>",i}getLevel(t,e){let i=1;return e&&(i=t/e),i<=1?1:i<=1.05?2:3}vpHasCost(t){let e=!1;return this.vpvActive?("keyMetric"==t?e=this.vpvActive.keyMetrics&&(this.vpvActive.keyMetrics.costBaseLastTotal>0||this.vpvActive.keyMetrics.costCurrentTotal>0):this.vpvCost&&this.vpvCost.length>0&&(e=!0),e):e}log(t){this.messageService.add("CompVisboViewCost: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(xV),Rr(jh),Rr(Mf),Rr(Bg),Rr(rf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-comp-viewcost"]],inputs:{vpvActive:"vpvActive",combinedPerm:"combinedPerm"},features:[_e],decls:42,vars:28,consts:[["class","well",3,"resized",4,"ngIf"],["indicator",""],["id","VpvLegend","tabindex","-1","role","dialog","aria-labelledby","VpvDetailsTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-body"],[1,"table","table-hover"],[1,"modal-footer","align-items-end"],["data-dismiss","modal",1,"btn","btn-primary"],[1,"well",3,"resized"],[1,"row","row-cols-1","row-cols-lg-2"],[1,"col","col-sm-12","col-lg-8"],[1,"row","text-dark"],["class","col-sm-12 col-md-10 col-lg-4 card align-right px-0",4,"ngIf"],[4,"ngIf"],["data-toggle","modal","data-target","#VpvLegend",1,"fas","fa-info-circle","fa-lg","mx-2","mt-2","text-secondary",3,"title"],[1,"col-sm-12","col-md-10","col-lg-4","card","align-right","px-0"],[1,"card-header","p-2"],[1,"mr-1"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"card-body","p-2"],[1,"row"],[1,"col","col-sm-8"],[1,"col","col-sm-4","text-right"],[3,"graphData","graphOptions","parentThis","language"],[1,"d-flex","justify-content-center"],[1,"fa",3,"ngClass"]],template:function(t,e){1&t&&(Lr(0,mS,9,6,"div",0),Lr(1,vS,2,5,"ng-template",null,1,ja),Nr(3,"div",2),Nr(4,"div",3),Nr(5,"div",4),Nr(6,"div",5),Nr(7,"table",6),Nr(8,"thead"),Nr(9,"tr"),Nr(10,"th"),mo(11),Ua(12,"translate"),Fr(),Nr(13,"th"),mo(14),Ua(15,"translate"),Fr(),Fr(),Fr(),Nr(16,"tbody"),Nr(17,"tr"),Nr(18,"td"),mo(19),Ua(20,"translate"),Fr(),Nr(21,"td"),mo(22),Ua(23,"translate"),Fr(),Fr(),Nr(24,"tr"),Nr(25,"td"),mo(26),Ua(27,"translate"),Fr(),Nr(28,"td"),mo(29),Ua(30,"translate"),Fr(),Fr(),Nr(31,"tr"),Nr(32,"td"),mo(33),Ua(34,"translate"),Fr(),Nr(35,"td"),mo(36),Ua(37,"translate"),Fr(),Fr(),Fr(),Fr(),Nr(38,"div",7),Nr(39,"button",8),mo(40),Ua(41,"translate"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr()),2&t&&(jr("ngIf",e.hasVPPerm(e.permVP.ViewAudit)),_n(11),fo(Oa(12,10,"keyMetrics.lbl.shortcut")),_n(3),fo(Oa(15,12,"keyMetrics.lbl.explanation")),_n(5),fo(Oa(20,14,"keyMetrics.shortPV")),_n(3),fo(Oa(23,16,"keyMetrics.longPV")),_n(4),fo(Oa(27,18,"keyMetrics.shortAC")),_n(3),fo(Oa(30,20,"keyMetrics.longAC")),_n(4),fo(Oa(34,22,"keyMetrics.shortETC")),_n(3),fo(Oa(37,24,"keyMetrics.longETC")),_n(4),fo(Oa(41,26,"compViewCost.btn.back")))},directives:[jc,EV,Bc,jV,Ec],pipes:[lv,zc],encapsulation:2}),t})(),yS=(()=>{class t{constructor(t){this.gChartService=t}ngOnInit(){this.language||(this.language="de"),this.gLib=this.gChartService.getGoogle(),this.gLib.charts.load("current",{packages:["corechart","table"],language:this.language}),this.gLib.charts.setOnLoadCallback(this.drawChart.bind(this)),this.elementID&&""!==this.elementID||(this.elementID="divPieChart")}ngOnChanges(){this.initialised&&this.drawChart()}drawChart(){console.log("Google Chart Pie Chart Draw "+this.graphData.length);const t=new this.gLib.visualization.PieChart(document.getElementById(this.elementID)),e=new this.gLib.visualization.DataTable,i=new this.gLib.visualization.DataTable,n=this.parentThis;for(let o=0;o<this.graphLegend.length;o++)e.addColumn(this.graphLegend[o][0],this.graphLegend[o][1]);if(e.addRows(this.graphData),this.graphDataBefore&&this.graphDataBefore.length>0){for(let t=0;t<this.graphLegend.length;t++)i.addColumn(this.graphLegend[t][0],this.graphLegend[t][1]);i.addRows(this.graphDataBefore)}const s={title:"Pie Chart Title",sliceVisibilityThreshold:0};function r(){const i=t.getSelection()[0];if(n)if(i){const t=e.getValue(i.row,0),s=e.getValue(i.row,1);n.chartSelectRow&&n.chartSelectRow(i.row,t,s)}else n.chartSelectRow(void 0,void 0,void 0);else console.log("The user clicked and this is undefined")}if(this.graphDataBefore&&0!==this.graphDataBefore.length){const n=t.computeDiff(i,e);this.gLib.visualization.events.addListener(t,"select",r),t.draw(n,this.graphOptions||s)}else this.gLib.visualization.events.addListener(t,"select",r),t.draw(e,this.graphOptions||s);this.initialised=!0}}return t.\u0275fac=function(e){return new(e||t)(Rr(RV))},t.\u0275cmp=le({type:t,selectors:[["app-pie-chart"]],inputs:{elementID:"elementID",graphData:"graphData",graphDataBefore:"graphDataBefore",language:"language",graphLegend:"graphLegend",graphOptions:"graphOptions",parentThis:"parentThis"},features:[_e],decls:1,vars:1,consts:[[3,"id"]],template:function(t,e){1&t&&Br(0,"div",0),2&t&&to("id",e.elementID)},styles:["#divPieChart[_ngcontent-%COMP%]{width:100%;height:300px}"]}),t})();function CS(t,e){if(1&t){const t=zr();Nr(0,"button",31),Jr("click",(function(){return ei(t),Xr(3).toggleGantt()})),mo(1),Fr()}if(2&t){const t=Xr(3);_n(1),fo(t.buttonGantt)}}function VS(t,e){if(1&t&&(Nr(0,"option",32),mo(1),Fr()),2&t){const t=e.$implicit;to("value",t.name),_n(1),fo(t.localName)}}function wS(t,e){if(1&t){const t=zr();Nr(0,"div",26),Nr(1,"div",27),Lr(2,CS,2,1,"button",28),Nr(3,"select",29),Jr("ngModelChange",(function(e){return ei(t),Xr(2).type=e}))("change",(function(){return ei(t),Xr(2).switchView()})),Lr(4,VS,2,2,"option",30),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(2),jr("ngIf",!t.getPreView()),_n(1),jr("ngModel",t.type),_n(1),jr("ngForOf",t.listType)}}function AS(t,e){if(1&t&&(Nr(0,"div",34),Nr(1,"div",35),Br(2,"app-pie-chart",36),Fr(),Fr()),2&t){const t=Xr(3);_n(2),jr("elementID",t.divAllPieChart)("graphData",t.graphAllDataPieChart)("graphDataBefore",t.graphBeforeAllDataPieChart)("graphLegend",t.graphAllPieLegend)("graphOptions",t.graphAllOptionsPieChart)("parentThis",t.parentThis)("language",t.currentLang)}}function PS(t,e){if(1&t&&(Nr(0,"div",26),Lr(1,AS,3,7,"div",33),Fr()),2&t){const t=Xr(2);_n(1),jr("ngIf",t.graphAllDataPieChart.length>1)}}function kS(t,e){if(1&t){const t=zr();Nr(0,"span"),Nr(1,"a",41),Jr("click",(function(){ei(t);const i=e.$implicit,n=e.index;return Xr(4).ganttSelectPath(i,n)})),mo(2),Fr(),mo(3," / "),Fr()}if(2&t){const t=e.$implicit;_n(2),fo(t)}}function DS(t,e){if(1&t&&(Nr(0,"div",39),Lr(1,kS,4,1,"span",40),Fr()),2&t){const t=Xr(3);_n(1),jr("ngForOf",t.getBreadCrumb())}}function MS(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"div"),Br(2,"app-timeline-chart",42),Fr(),Fr()),2&t){const t=Xr(3);_n(2),jr("graphData",t.graphDataDeadlinesGantt)("graphOptions",t.graphOptionsDeadlinesGantt)("parentThis",t.parentThis)}}function IS(t,e){if(1&t&&(Nr(0,"div",26),Lr(1,DS,2,1,"div",37),Lr(2,MS,3,3,"div",38),Fr()),2&t){const t=Xr(2);_n(1),jr("ngIf",t.showBreadCrumb()),_n(1),jr("ngIf",t.graphDataDeadlinesGantt&&t.graphDataDeadlinesGantt.length>1)}}function SS(t,e){if(1&t){const t=zr();Nr(0,"th",43),Jr("click",(function(){return ei(t),Xr(2).sortDeadlineTable(7)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"compViewDeadline.lbl.endDatePFV")))}function xS(t,e){if(1&t){const t=zr();Nr(0,"th",44),Jr("click",(function(){return ei(t),Xr(2).sortDeadlineTable(5)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"compViewDeadline.lbl.change")))}function TS(t,e){1&t&&qr(0)}function _S(t,e){if(1&t&&(Nr(0,"td",55),mo(1),Ua(2,"date"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.endDatePFV,"dd.MM.yy"))}}function US(t,e){if(1&t&&(Nr(0,"td",56),Ua(1,"date"),mo(2),Ua(3,"number"),Fr()),2&t){const t=Xr().$implicit;eo("title","",Ea(1,2,t.endDatePFV,"dd.MM.yy")," (baseline)"),_n(2),fo(Ea(3,5,t.changeDays/7,"1.0-1"))}}function OS(t,e){if(1&t&&(Nr(0,"td",50),mo(1),Ua(2,"number"),Fr()),2&t){const t=Xr().$implicit;_n(1),vo("",Ea(2,1,100*t.percentDone,"1.0-0")," %")}}function ES(t,e){if(1&t&&(Nr(0,"td",57),mo(1),Ua(2,"number"),Fr()),2&t){const t=Xr().$implicit;_n(1),vo("",Ea(2,1,100*t.percentDone,"1.0-0")," %")}}function LS(t,e){1&t&&qr(0)}const GS=function(t,e){return{level:t,text:e}},RS=function(t){return{level:t}};function jS(t,e){if(1&t){const t=zr();Nr(0,"tr",45),Jr("click",(function(){ei(t);const i=e.index;return Xr(2).helperDeadline(i)})),Nr(1,"td",46),Lr(2,TS,1,0,"ng-container",47),Fr(),Nr(3,"td",48),mo(4),Fr(),Lr(5,_S,3,4,"td",49),Nr(6,"td",50),mo(7),Ua(8,"date"),Fr(),Lr(9,US,4,8,"td",51),Lr(10,OS,3,4,"td",52),Lr(11,ES,3,4,"td",53),Nr(12,"td",54),Lr(13,LS,1,0,"ng-container",47),Fr(),Fr()}if(2&t){const t=e.$implicit;Xr();const i=Gr(27),n=Gr(29),s=Xr();_n(1),to("title",s.getFullName(t)),_n(1),jr("ngTemplateOutlet",i)("ngTemplateOutletContext",Da(15,GS,s.getStatus(t),s.getShortText(s.getFullName(t),100,"right"))),_n(2),fo(t.type),_n(1),jr("ngIf",s.switchType),_n(2),fo(Ea(8,12,t.endDateVPV,"dd.MM.yy")),_n(2),jr("ngIf",s.switchType),_n(1),jr("ngIf",s.inFuture(t.endDateVPV)||1==t.percentDone),_n(1),jr("ngIf",!(s.inFuture(t.endDateVPV)||1==t.percentDone)),_n(1),to("title",t.trafficlightDesc),_n(1),jr("ngTemplateOutlet",n)("ngTemplateOutletContext",ka(18,RS,t.trafficlight))}}const $S=function(t,e,i,n,s,r){return{"font-weight-normal":t,"font-weight-bold":e,my_darkgreen:i,my_green:n,my_orange:s,my_red:r}};function NS(t,e){if(1&t&&(Nr(0,"i",58),mo(1),Fr()),2&t){const t=e.level,i=e.text;jr("ngClass",Sa(2,$S,-1==t,t>=0,0==t,1==t,2==t,3==t)),_n(1),vo(" ",i," ")}}const FS=function(t,e,i,n){return{"d-none":t,"text-success":e,"text-warning":i,"text-danger":n}};function BS(t,e){if(1&t&&Br(0,"i",59),2&t){const t=e.level;jr("ngClass",Ia(1,FS,0==t,1==t,2==t,3==t))}}function HS(t,e){if(1&t&&(Nr(0,"div",61),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",63),mo(5),Ua(6,"date"),Fr(),Fr()),2&t){const t=Xr(3);_n(2),vo("",Oa(3,2,"compViewDeadline.lbl.endDatePFV"),":"),_n(3),fo(Ea(6,4,t.filteredDeadline[t.deadlineIndex].endDatePFV,"dd.MM.yy"))}}function KS(t,e){if(1&t&&(Nr(0,"div",61),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",63),mo(5),Ua(6,"date"),Fr(),Fr()),2&t){const t=Xr(3);_n(2),vo("",Oa(3,2,"compViewDeadline.lbl.endDateVPV"),":"),_n(3),fo(Ea(6,4,t.filteredDeadline[t.deadlineIndex].endDateVPV,"dd.MM.yy"))}}function qS(t,e){if(1&t&&(Nr(0,"div",61),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",63),mo(5),Ua(6,"number"),Fr(),Fr()),2&t){const t=Xr(3);_n(2),vo("",Oa(3,2,"compViewDeadline.lbl.done"),":"),_n(3),vo("",Ea(6,4,100*t.filteredDeadline[t.deadlineIndex].percentDone,"1.0-0")," %")}}function zS(t,e){1&t&&qr(0)}function QS(t,e){if(1&t&&(Nr(0,"div",61),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",63),Nr(5,"span",65),Lr(6,zS,1,0,"ng-container",47),Fr(),Nr(7,"span",66),mo(8),Fr(),Fr(),Fr()),2&t){Xr(2);const t=Gr(29),e=Xr();_n(2),vo("",Oa(3,5,"compViewDeadline.lbl.trafficlight"),":"),_n(3),to("title",e.filteredDeadline[e.deadlineIndex].trafficlightDesc),_n(1),jr("ngTemplateOutlet",t)("ngTemplateOutletContext",ka(7,RS,e.filteredDeadline[e.deadlineIndex].trafficlight)),_n(2),vo(" ",e.filteredDeadline[e.deadlineIndex].trafficlightDesc," ")}}function WS(t,e){if(1&t&&(Nr(0,"div",61),Nr(1,"label",62),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",63),mo(5),Fr(),Fr()),2&t){const t=Xr(3);_n(2),vo("",Oa(3,2,"compViewDeadline.lbl.responsible"),":"),_n(3),fo(t.filteredDeadline[t.deadlineIndex].responsible)}}function JS(t,e){if(1&t&&(Nr(0,"div",60),Nr(1,"form"),Nr(2,"div",61),Nr(3,"label",62),mo(4),Ua(5,"translate"),Fr(),Nr(6,"label",63),mo(7),Fr(),Fr(),Nr(8,"div",61),Nr(9,"label",62),mo(10),Ua(11,"translate"),Fr(),Nr(12,"label",63),mo(13),Fr(),Fr(),Nr(14,"div",61),Nr(15,"label",62),mo(16),Ua(17,"translate"),Fr(),Nr(18,"label",63),mo(19),Fr(),Fr(),Lr(20,HS,7,7,"div",64),Lr(21,KS,7,7,"div",64),Lr(22,qS,7,7,"div",64),Lr(23,QS,9,9,"div",64),Lr(24,WS,6,4,"div",64),Fr(),Fr()),2&t){const t=Xr(2);_n(4),vo("",Oa(5,11,"compViewDeadline.lbl.vp"),":"),_n(3),vo("",t.vpvActive.name," "),_n(3),vo("",Oa(11,13,"compViewDeadline.lbl.planElement"),":"),_n(3),fo(t.getElementPath(t.deadlineIndex)),_n(3),vo("",Oa(17,15,"compViewDeadline.lbl.type"),":"),_n(3),fo(t.filteredDeadline[t.deadlineIndex].type),_n(1),jr("ngIf",t.filteredDeadline[t.deadlineIndex].endDatePFV),_n(1),jr("ngIf",t.filteredDeadline[t.deadlineIndex].endDateVPV),_n(1),jr("ngIf",t.filteredDeadline[t.deadlineIndex].percentDone),_n(1),jr("ngIf",t.filteredDeadline[t.deadlineIndex].trafficlight||t.filteredDeadline[t.deadlineIndex].trafficlightDesc),_n(1),jr("ngIf",t.filteredDeadline[t.deadlineIndex].percentDone)}}function YS(t,e){if(1&t){const t=zr();Nr(0,"button",67),Jr("click",(function(){ei(t);const e=Xr(2);return e.gotoVPRestrict(e.deadlineIndex)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"compViewDeadline.btn.detail")))}function ZS(t,e){if(1&t){const t=zr();Nr(0,"div",1),Jr("resized",(function(e){return ei(t),Xr().onResized(e)})),Lr(1,wS,5,3,"div",2),Lr(2,PS,2,1,"div",2),Lr(3,IS,3,2,"div",2),Nr(4,"div",3),Nr(5,"table",4),Nr(6,"thead"),Nr(7,"tr"),Nr(8,"th",5),Jr("click",(function(){return ei(t),Xr().sortDeadlineTable(2)})),mo(9),Ua(10,"translate"),Fr(),Nr(11,"th",6),Jr("click",(function(){return ei(t),Xr().sortDeadlineTable(3)})),mo(12),Ua(13,"translate"),Fr(),Lr(14,SS,3,3,"th",7),Nr(15,"th",8),Jr("click",(function(){return ei(t),Xr().sortDeadlineTable(4)})),mo(16),Ua(17,"translate"),Fr(),Lr(18,xS,3,3,"th",9),Nr(19,"th",8),Jr("click",(function(){return ei(t),Xr().sortDeadlineTable(6)})),mo(20),Ua(21,"translate"),Fr(),Nr(22,"th",10),Br(23,"i",11),Fr(),Fr(),Fr(),Nr(24,"tbody"),Lr(25,jS,14,20,"tr",12),Fr(),Fr(),Fr(),Lr(26,NS,2,9,"ng-template",null,13,ja),Lr(28,BS,1,6,"ng-template",null,14,ja),Nr(30,"div",15),Nr(31,"div",16),Nr(32,"div",17),Nr(33,"div",18),Nr(34,"h5",19),mo(35),Ua(36,"translate"),Fr(),Nr(37,"button",20),Nr(38,"span",21),mo(39,"\xd7"),Fr(),Fr(),Fr(),Lr(40,JS,25,17,"div",22),Nr(41,"div",23),Nr(42,"button",24),mo(43),Ua(44,"translate"),Fr(),Lr(45,YS,3,3,"button",25),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr();_n(1),jr("ngIf",t.displaySwitch()),_n(1),jr("ngIf",t.fullList&&"vpv"!=t.refType),_n(1),jr("ngIf",t.viewGantt),_n(6),fo(Oa(10,14,"compViewDeadline.lbl.planElement")),_n(3),fo(Oa(13,16,"compViewDeadline.lbl.type")),_n(2),jr("ngIf",t.switchType),_n(2),fo(Oa(17,18,"compViewDeadline.lbl.endDateVPV")),_n(2),jr("ngIf",t.switchType),_n(2),fo(Oa(21,20,"compViewDeadline.lbl.done")),_n(5),jr("ngForOf",t.filteredDeadline),_n(10),fo(Oa(36,22,"compViewDeadline.titleDetailDeadline")),_n(5),jr("ngIf",t.deadlineIndex>=0&&t.deadlineIndex<t.filteredDeadline.length),_n(3),fo(Oa(44,24,"compViewDeadline.btn.back")),_n(2),jr("ngIf",t.canSeeRestriction())}}let XS=(()=>{class t{constructor(t,e,i,n,s,r){this.visboprojectversionService=t,this.messageService=e,this.alertService=i,this.route=n,this.router=s,this.translate=r,this.listType=[{name:"PFV",ref:"pfv",localName:""},{name:"VPV",ref:"vpv",localName:""},{name:"All",ref:void 0,localName:""}],this.type=this.listType[0].name,this.refType=this.listType[0].ref,this.switchType=!0,this.parentThis=this,this.colors=["#005600","green","orange","red"],this.graphAllDataPieChart=[],this.graphBeforeAllDataPieChart=[],this.graphAllPieLegend=[["string",this.translate.instant("compViewDeadline.lbl.status")],["number",this.translate.instant("compViewDeadline.lbl.count")]],this.graphAllOptionsPieChart={title:"View Deadlines",titleTextStyle:{color:"black",fontSize:"16"},tooltip:{trigger:"none"},colors:this.colors},this.divAllPieChart="divAllDeadLinePieChart",this.graphOptionsDeadlinesGantt={width:"100%",timeline:{showRowLabels:!1,showBarLabels:!0},tooltip:{isHtml:!0},animation:{startup:!0,duration:200}},this.graphDataDeadlinesGantt=[],this.permVC=Iv,this.permVP=Sv,this.sortAscending=!1,this.sortColumn=1,this.sortAscendingDeadline=!1,this.sortColumnDeadline=1}ngOnInit(){this.currentLang=this.translate.currentLang,this.statusList=[this.translate.instant("keyMetrics.chart.statusDeadlineAhead"),this.translate.instant("keyMetrics.chart.statusDeadlineInTime"),this.translate.instant("keyMetrics.chart.statusDeadlineDelay"),this.translate.instant("keyMetrics.chart.statusDeadlineNotCompleted"),"Unknown"],this.buttonGantt=this.translate.instant("compViewDelivery.btn.buttonGanttOn"),this.listType.forEach(t=>t.localName=this.translate.instant("compViewDelivery.lbl.".concat(t.name))),this.currentVpvId=this.vpvActive._id,this.visboDeadlineCalc(!1)}ngOnChanges(t){this.log(`Deadlines on Changes  ${this.vpvActive._id} ${this.vpvActive.timestamp}, Changes: ${JSON.stringify(t)}`),void 0!==this.currentVpvId&&this.vpvActive._id!==this.currentVpvId&&this.visboDeadlineCalc(!1)}onResized(t){t||this.log("No event in Resize"),this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(()=>{this.visboViewAllDeadlinePie(!1),this.visboViewDeadlineTimeline(),this.timeoutID=void 0},500)}visboDeadlineCalc(t=!1){this.vpvActive&&(this.fullList=this.hasVPPerm(this.permVP.View),this.fullList||(this.refType=void 0),this.currentVpvId=this.vpvActive._id,this.log(`Deadline Calc for Version  ${this.vpvActive._id} ${this.vpvActive.timestamp} Reference ${this.refType}`),this.visboprojectversionService.getDeadline(this.vpvActive._id,this.refType).subscribe(e=>{this.log(`get VPV Calc: Get ${e.length} vpvs with ${e[0].deadline.length} entries`),1===e.length&&e[0].deadline?(this.log(`Get Deadlines for ${e[0]._id} Len ${e[0].deadline.length} Actual ${e[0].actualDataUntil}`),this.allDeadline=e[0].deadline,"vpv"!=this.refType&&this.allDeadline&&!this.allDeadline[0].fullPathPFV&&(this.refType="vpv",this.switchType=!1)):(this.log("get VPV Calc: Reset Deadlines to empty "),this.allDeadline=void 0),this.initDeadlines(t),this.visboViewAllDeadlinePie(t)},t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("compViewDeadline.msg.errorPermVersion",{name:this.vpvActive.name});this.alertService.error(t)}else this.alertService.error(Gh(t))}))}initDeadlines(t){if(void 0!==this.allDeadline){this.filterPath=["."];for(let t=0;t<this.allDeadline.length;t++)this.allDeadline[t].fullName=this.getFullName(this.allDeadline[t]),this.allDeadline[t].status=this.statusList[this.getStatus(this.allDeadline[t])],this.allDeadline[t].statusID=this.getStatus(this.allDeadline[t]);this.filterDeadlines(t)}else this.hierarchyDeadline=[]}filterDeadlines(t){if(void 0===this.allDeadline||0===this.allDeadline.length)return;const e=this.filterPath.join(" / ");let i=!1;e!==this.filterOldPath&&(i=!0,this.filterStatus=void 0,this.filterOldPath=e),this.hierarchyDeadline=[],this.filteredDeadline=[];for(let n=0;n<this.allDeadline.length;n++)0===this.getFullPath(this.allDeadline[n]).join(" / ").indexOf(e)&&this.hierarchyDeadline.push(this.allDeadline[n]);for(let n=0;n<this.hierarchyDeadline.length;n++)void 0!==this.filterStatus&&this.filterStatus!==this.hierarchyDeadline[n].statusID||this.filteredDeadline.push(this.hierarchyDeadline[n]);this.sortDeadlineTable(),i&&this.visboViewAllDeadlinePie(t),this.visboViewDeadlineTimeline()}helperDeadline(t){this.deadlineIndex=t}getElementPath(t,e){let i=[];"vpv"!==this.refType&&void 0!==this.refType||(i=this.filteredDeadline[t].fullPathVPV),"pfv"===this.refType&&(i=this.filteredDeadline[t].fullPathPFV);let n="";return n=i.length<=1?this.vpvActive.name:i.slice(1).join(" / "),e>0&&(n=Lh(n,e,"right")),n}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}canSeeRestriction(){let t=this.combinedPerm.vp||0;return t&=this.permVP.Modify+this.permVP.ManagePerm,t>0}getStatus(t){const e=this.vpvActive.timestamp;let i=0;return t.endDatePFV?t.endDatePFV<=e&&t.percentDone<1?i=3:t.endDatePFV>e&&1===t.percentDone?i=0:t.endDatePFV<=e&&1===t.percentDone||t.endDatePFV>e&&t.percentDone<1?(t.changeDays<0&&(i=0),0===t.changeDays&&(i=1),t.changeDays>0&&(i=2)):i=4:i=-1,i}visboViewAllDeadlinePie(t){this.graphAllOptionsPieChart.title=this.translate.instant("compViewDeadline.titleAllDeadlines");const e=[],i=[];let n;for(let r=0;r<this.statusList.length;r++)e[r]=0;let s=!1;for(let r=0;r<this.filteredDeadline.length;r++)n=this.getStatus(this.filteredDeadline[r]),e[n]+=1,s=!0;for(let r=0;r<e.length;r++)i.push([this.statusList[r],e[r]]);this.log("PIE Chart change "+t),this.graphAllDataPieChart=s?i:[]}getPhaseName(t){if(!t)return;let e=t.phasePFV||t.name;return"."===e&&(e=this.vpvActive.name),e}visboViewDeadlineTimeline(){const t=[];for(let e=0;e<this.hierarchyDeadline.length;e++){const i=this.hierarchyDeadline[e];if("Phase"===i.type){const n=i.startDateVPV?new Date(i.startDateVPV):new Date,s=new Date(i.endDateVPV),r=this.getPhaseName(i),o=this.getFullPath(i);0===o.join(" / ").indexOf(this.filterPath.join(" / "))&&o.length<=this.filterPath.length+1&&t.push([0===e?"Root":"Children",r,this.createCustomHTMLContent(i),n.getTime(),s.getTime()])}}t.reverse(),t.push(["Task ID","Task Name",{type:"string",role:"tooltip",p:{html:!0}},"Start Date","End Date"]),t.reverse(),this.graphDataDeadlinesGantt=t}createCustomHTMLContent(t){const e=_h(new Date(t.startDateVPV),"fullDate",this.currentLang),i=_h(new Date(t.endDateVPV),"fullDate",this.currentLang);let n=t.fullName;"."===n&&(n=this.vpvActive.name);let s='<div style="padding:5px 5px 5px 5px"><div><b>'+n+"</b></div><div><table>";const r=this.translate.instant("compViewDeadline.lbl.startDateVPV"),o=this.translate.instant("compViewDeadline.lbl.endDateVPV"),a=this.translate.instant("compViewDeadline.lbl.percentDone"),l=this.translate.instant("compViewDeadline.lbl.trafficlight"),c=this.translate.instant("compViewDeadline.lbl.trafficlightDesc");return s=s+'<tr><td width="40%">'+r+":</td><td><b>"+e+"</b></td></tr>",s=s+'<tr><td width="40%">'+o+":</td><td><b>"+i+"</b></td></tr>",s=s+'<tr><td width="40%">'+a+":</td><td><b>"+Math.round(100*t.percentDone)+"%</b></td></tr>",t.trafficlight&&(s=s+'<tr><td width="40%">'+l+":</td><td><b>"+t.trafficlight+"</b></td></tr>"),t.trafficlightDesc&&(s=s+"<tr><td>"+c+":</td><td><b>"+t.trafficlightDesc+"</b></td></tr>"),s+="</table></div></div>",s}chartSelectRow(t,e,i){if(this.log(`chart Select Row ${t} ${e} ${i} for Filter`),void 0===t)this.filterStatus=void 0;else{const t=this.statusList.findIndex(t=>t===e);this.filterStatus=t<0||this.filterStatus===t?void 0:t}this.filterDeadlines(!1)}timelineSelectRow(t){const e=this.graphDataDeadlinesGantt[t+1][1];this.log(`timeline Select Row ${t} Phase ${e}`);let i=this.hierarchyDeadline.findIndex(t=>t.name===e);i<0&&(i=0),this.filterPath=this.getFullPath(this.hierarchyDeadline[i]),this.filterDeadlines(!1)}ganttSelectPath(t,e){this.log(`gantt Select Item ${e} ${t} `);const i=this.getFullPath(this.hierarchyDeadline[0]);e>=0&&e<i.length&&(this.filterPath=i.slice(0,e+1)),this.log(`gantt Select ${t} Full Path ${this.filterPath.join(" / ")}`),this.filterDeadlines(!1)}getFullName(t){let e;return t.fullName&&(e=t.fullName),"vpv"===this.refType||void 0===this.refType?(t.fullPathVPV&&t.fullPathVPV.length>1?e=t.fullPathVPV.slice(1).join(" / "):t.fullPathVPV?e=this.vpvActive.name:t.fullPathPFV&&t.fullPathPFV.length>1&&(e=t.fullPathPFV.slice(1).join(" / ")),e):"pfv"===this.refType?(e=t.fullPathPFV&&t.fullPathPFV.length>1?t.fullPathPFV.slice(1).join(" / "):this.vpvActive.name,e):void 0}getFullPath(t){if(t)return"pfv"===this.refType&&t.fullPathPFV||t.fullPathVPV}getBreadCrumb(){const t=this.getFullPath(this.hierarchyDeadline[0]),e=t.slice(0,t.length);return e.length>=0&&(e[0]=this.vpvActive.name),e}showBreadCrumb(){return this.getFullPath(this.hierarchyDeadline[0]).length>0}inFuture(t){return t>this.vpvActive.timestamp.toString()}getShortText(t,e,i){return Lh(t,e,i)}switchView(){this.log("Switchinig to "+this.type),this.refType=this.listType.find(t=>t.name===this.type).ref,this.visboDeadlineCalc(!1)}toggleGantt(){this.viewGantt=!this.viewGantt,this.buttonGantt=this.translate.instant(this.viewGantt?"compViewDelivery.btn.buttonGanttOff":"compViewDelivery.btn.buttonGanttOn"),this.viewGantt||(this.filterPath=this.getFullPath(this.allDeadline[0]),this.filterDeadlines(!1))}hasDeadlines(){let t=!1;return this.vpvActive&&this.allDeadline&&this.allDeadline.length>0&&(t=!0),t}displaySwitch(){let t=!1;return this.switchType&&this.hasVPPerm(this.permVP.View)&&(t=!0),t}gotoVPRestrict(t){const e=this.getFullPath(this.filteredDeadline[t]),i=this.filteredDeadline[t].nameID;localStorage.setItem("restrict",JSON.stringify({id:i,path:e})),this.log(`goto VP Restrict: ${this.vpvActive.vpid} ID ${i} Path ${e.join(" / ")}`),this.router.navigate(["vpRestrict/".concat(this.vpvActive.vpid)],{queryParams:{id:i}})}sortDeadlineTable(t){this.filteredDeadline&&(void 0!==t?(t!==this.sortColumnDeadline&&(this.sortColumnDeadline=t,this.sortAscendingDeadline=void 0),this.sortAscendingDeadline=void 0===this.sortAscendingDeadline?2===t||3===t||4===t||7===t:!this.sortAscendingDeadline):(this.sortColumnDeadline=2,this.sortAscendingDeadline=!0),2===this.sortColumnDeadline?this.filteredDeadline.sort("pfv"===this.refType?function(t,e){return xh(t.fullPathPFV.join(" / "),e.fullPathPFV.join(" / "))}:function(t,e){return xh(t.fullPathVPV.join(" / "),e.fullPathVPV.join(" / "))}):3===this.sortColumnDeadline?this.filteredDeadline.sort((function(t,e){return xh(t.type.toLowerCase(),e.type.toLowerCase())})):4===this.sortColumnDeadline?this.filteredDeadline.sort((function(t,e){return Th(t.endDateVPV,e.endDateVPV)})):5===this.sortColumnDeadline?this.filteredDeadline.sort((function(t,e){return t.changeDays-e.changeDays})):6===this.sortColumnDeadline?this.filteredDeadline.sort((function(t,e){return t.percentDone-e.percentDone})):7===this.sortColumnDeadline&&this.filteredDeadline.sort((function(t,e){return Th(t.endDatePFV,e.endDatePFV)})),this.sortAscendingDeadline||this.filteredDeadline.reverse())}getPreView(){return Rh()}log(t){this.messageService.add("CompViewDeadline: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(xV),Rr(jh),Rr(Mf),Rr(Bg),Rr(rf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-comp-viewdeadline"]],inputs:{vpvActive:"vpvActive",combinedPerm:"combinedPerm"},features:[_e],decls:1,vars:1,consts:[["class","well",3,"resized",4,"ngIf"],[1,"well",3,"resized"],["class","container",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[1,"text-left",3,"click"],[1,"d-none","d-lg-table-cell",3,"click"],["class","d-none d-xl-table-cell text-right",3,"click",4,"ngIf"],[1,"d-none","d-md-table-cell","text-right",3,"click"],["class","text-right",3,"click",4,"ngIf"],[1,"d-none","d-md-table-cell"],[1,"fas","fa-lightbulb","text-grey"],["data-toggle","modal","data-target","#detailDeadline",3,"click",4,"ngFor","ngForOf"],["fontStyle",""],["trafficLight",""],["id","detailDeadline","tabindex","-1","role","dialog","aria-labelledby","Detail Deadline","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","detailDeadlineTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],["class","modal-body",4,"ngIf"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button","class","btn btn-primary","data-dismiss","modal",3,"click",4,"ngIf"],[1,"container"],[1,"d-flex","justify-content-center","my-1"],["type","button","class","btn btn-md btn-light mx-2 d-print-none",3,"click",4,"ngIf"],["name","type",1,"col-3","form-control","mx-2",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-md","btn-light","mx-2","d-print-none",3,"click"],[3,"value"],["class","d-flex justify-content-center",4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"align-center"],[3,"elementID","graphData","graphDataBefore","graphLegend","graphOptions","parentThis","language"],["class","mb-2",4,"ngIf"],[4,"ngIf"],[1,"mb-2"],[4,"ngFor","ngForOf"],[3,"click"],[3,"graphData","graphOptions","parentThis"],[1,"d-none","d-xl-table-cell","text-right",3,"click"],[1,"text-right",3,"click"],["data-toggle","modal","data-target","#detailDeadline",3,"click"],[3,"title"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"d-none","d-lg-table-cell"],["class","d-none d-xl-table-cell text-right",4,"ngIf"],[1,"d-none","d-md-table-cell","text-right"],["class","text-right",3,"title",4,"ngIf"],["class","d-none d-md-table-cell text-right",4,"ngIf"],["class","d-none d-md-table-cell text-right my_bg_red",4,"ngIf"],[1,"d-none","d-md-table-cell",3,"title"],[1,"d-none","d-xl-table-cell","text-right"],[1,"text-right",3,"title"],[1,"d-none","d-md-table-cell","text-right","my_bg_red"],[3,"ngClass"],[1,"fas","fa-lightbulb",3,"ngClass"],[1,"modal-body"],[1,"v_compact_t","form-group"],[1,"col-4","col-form-label"],[1,"col-8","form-control-static"],["class","v_compact_t form-group",4,"ngIf"],[1,"mx-2",3,"title"],[1,"mx-1"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&Lr(0,ZS,46,26,"div",0),2&t&&jr("ngIf",e.hasDeadlines())},directives:[jc,EV,Gc,cu,Nd,Ou,du,gu,yS,KA,Bc,Ec,Eu,Fd,Tu],pipes:[lv,qc,zc],styles:[".my_darkgreen[_ngcontent-%COMP%]{color:#005600}.my_green[_ngcontent-%COMP%]{color:green}.my_orange[_ngcontent-%COMP%]{color:orange}.my_red[_ngcontent-%COMP%]{color:red}.my_bg_red[_ngcontent-%COMP%]{background-color:red}.v_compact_t[_ngcontent-%COMP%]{margin:0;padding-top:0}"]}),t})();function tx(t,e){if(1&t&&(Nr(0,"option",29),mo(1),Fr()),2&t){const t=e.$implicit;to("value",t.name),_n(1),fo(t.localName)}}function ex(t,e){if(1&t){const t=zr();Nr(0,"div",25),Nr(1,"div",26),Nr(2,"select",27),Jr("ngModelChange",(function(e){return ei(t),Xr(2).type=e}))("change",(function(){return ei(t),Xr(2).switchView()})),Lr(3,tx,2,2,"option",28),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(2),jr("ngModel",t.type),_n(1),jr("ngForOf",t.listType)}}function ix(t,e){if(1&t&&(Nr(0,"div",31),Nr(1,"div",32),Br(2,"app-pie-chart",33),Fr(),Fr()),2&t){const t=Xr(3);_n(2),jr("elementID",t.divAllPieChart)("graphData",t.graphAllDataPieChart)("graphLegend",t.graphAllPieLegend)("graphOptions",t.graphAllOptionsPieChart)("parentThis",t.parentThis)("language",t.currentLang)}}function nx(t,e){if(1&t&&(Nr(0,"div",25),Lr(1,ix,3,6,"div",30),Fr()),2&t){const t=Xr(2);_n(1),jr("ngIf",t.graphAllDataPieChart.length>1)}}function sx(t,e){if(1&t){const t=zr();Nr(0,"th",8),Jr("click",(function(){return ei(t),Xr(2).sortDeliveryTable(4)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"compViewDelivery.lbl.endDatePFV")))}function rx(t,e){if(1&t){const t=zr();Nr(0,"th",34),Jr("click",(function(){return ei(t),Xr(2).sortDeliveryTable(5)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"compViewDelivery.lbl.change")))}function ox(t,e){1&t&&qr(0)}function ax(t,e){if(1&t&&(Nr(0,"td",40),mo(1),Ua(2,"date"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.endDatePFV,"dd.MM.yy"))}}function lx(t,e){if(1&t&&(Nr(0,"td",44),Ua(1,"date"),mo(2),Ua(3,"number"),Fr()),2&t){const t=Xr().$implicit;eo("title","",Ea(1,2,t.endDatePFV,"dd.MM.yy")," (baseline)"),_n(2),fo(Ea(3,5,t.changeDays/7,"1.0-1"))}}function cx(t,e){if(1&t&&(Nr(0,"td",45),mo(1),Ua(2,"number"),Fr()),2&t){const t=Xr().$implicit;_n(1),vo("",Ea(2,1,100*t.percentDone,"1.0-0")," %")}}function dx(t,e){if(1&t&&(Nr(0,"td",46),mo(1),Ua(2,"number"),Fr()),2&t){const t=Xr().$implicit;_n(1),vo("",Ea(2,1,100*t.percentDone,"1.0-0")," %")}}const ux=function(t,e){return{level:t,text:e}};function hx(t,e){if(1&t){const t=zr();Nr(0,"tr",35),Jr("click",(function(){ei(t);const i=e.index;return Xr(2).helperDelivery(i)})),Nr(1,"td",36),Lr(2,ox,1,0,"ng-container",37),Fr(),Nr(3,"td",38),mo(4),Fr(),Lr(5,ax,3,4,"td",39),Nr(6,"td",40),mo(7),Ua(8,"date"),Fr(),Lr(9,lx,4,8,"td",41),Lr(10,cx,3,4,"td",42),Lr(11,dx,3,4,"td",43),Fr()}if(2&t){const t=e.$implicit;Xr();const i=Gr(24),n=Xr();_n(1),to("title",t.description),_n(1),jr("ngTemplateOutlet",i)("ngTemplateOutletContext",Da(13,ux,n.getStatus(t),n.getShortText(t.description,100))),_n(1),to("title",n.getFullName(t)),_n(1),fo(n.getShortText(n.getFullName(t),50,"right")),_n(1),jr("ngIf",!n.reducedList),_n(2),fo(Ea(8,10,t.endDateVPV,"dd.MM.yy")),_n(2),jr("ngIf",!n.reducedList),_n(1),jr("ngIf",n.inFuture(t.endDateVPV)||1==t.percentDone),_n(1),jr("ngIf",!(n.inFuture(t.endDateVPV)||1==t.percentDone))}}const px=function(t,e,i,n,s,r){return{"font-weight-normal":t,"font-weight-bold":e,my_darkgreen:i,my_green:n,my_orange:s,my_red:r}};function gx(t,e){if(1&t&&(Nr(0,"i",47),mo(1),Fr()),2&t){const t=e.level,i=e.text;jr("ngClass",Sa(2,px,-1==t,t>=0,0==t,1==t,2==t,3==t)),_n(1),vo(" ",i," ")}}const mx=function(t,e,i,n){return{"d-none":t,"text-success":e,"text-warning":i,"text-danger":n}};function fx(t,e){if(1&t&&Br(0,"i",48),2&t){const t=e.level;jr("ngClass",Ia(1,mx,0==t,1==t,2==t,3==t))}}function vx(t,e){if(1&t&&(Nr(0,"div",50),Nr(1,"label",51),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",52),mo(5),Ua(6,"date"),Fr(),Fr()),2&t){const t=Xr(3);_n(2),vo("",Oa(3,2,"compViewDelivery.lbl.endDatePFV"),":"),_n(3),fo(Ea(6,4,t.filteredDelivery[t.deliveryIndex].endDatePFV,"dd.MM.yy"))}}function bx(t,e){if(1&t&&(Nr(0,"div",50),Nr(1,"label",51),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",52),mo(5),Ua(6,"date"),Fr(),Fr()),2&t){const t=Xr(3);_n(2),vo("",Oa(3,2,"compViewDelivery.lbl.endDateVPV"),":"),_n(3),fo(Ea(6,4,t.filteredDelivery[t.deliveryIndex].endDateVPV,"dd.MM.yy"))}}function yx(t,e){if(1&t&&(Nr(0,"div",50),Nr(1,"label",51),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",52),mo(5),Ua(6,"number"),Fr(),Fr()),2&t){const t=Xr(3);_n(2),vo("",Oa(3,2,"compViewDelivery.lbl.done"),":"),_n(3),vo("",Ea(6,4,100*t.filteredDelivery[t.deliveryIndex].percentDone,"1.0-0")," %")}}function Cx(t,e){if(1&t&&(Nr(0,"div",49),Nr(1,"form"),Nr(2,"div",50),Nr(3,"label",51),mo(4),Ua(5,"translate"),Fr(),Nr(6,"label",52),mo(7),Fr(),Fr(),Nr(8,"div",50),Nr(9,"label",51),mo(10),Ua(11,"translate"),Fr(),Nr(12,"label",52),mo(13),Fr(),Fr(),Nr(14,"div",50),Nr(15,"label",51),mo(16),Ua(17,"translate"),Fr(),Nr(18,"label",52),mo(19),Fr(),Fr(),Lr(20,vx,7,7,"div",53),Lr(21,bx,7,7,"div",53),Lr(22,yx,7,7,"div",53),Fr(),Fr()),2&t){const t=Xr(2);_n(4),vo("",Oa(5,9,"compViewDelivery.lbl.vp"),":"),_n(3),vo("",t.vpvActive.name," "),_n(3),vo("",Oa(11,11,"compViewDelivery.lbl.planElement"),":"),_n(3),fo(t.getElementPath(t.deliveryIndex)),_n(3),vo("",Oa(17,13,"compViewDelivery.lbl.description"),":"),_n(3),fo(t.filteredDelivery[t.deliveryIndex].description),_n(1),jr("ngIf",t.filteredDelivery[t.deliveryIndex].endDatePFV),_n(1),jr("ngIf",t.filteredDelivery[t.deliveryIndex].endDateVPV),_n(1),jr("ngIf",t.filteredDelivery[t.deliveryIndex].percentDone)}}function Vx(t,e){if(1&t){const t=zr();Nr(0,"button",54),Jr("click",(function(){ei(t);const e=Xr(2);return e.gotoVPRestrict(e.deliveryIndex)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"compViewDelivery.btn.detail")))}function wx(t,e){if(1&t){const t=zr();Nr(0,"div",1),Jr("resized",(function(e){return ei(t),Xr().onResized(e)})),Lr(1,ex,4,2,"div",2),Lr(2,nx,2,1,"div",2),Nr(3,"div",3),Nr(4,"table",4),Nr(5,"thead"),Nr(6,"tr"),Nr(7,"th",5),Jr("click",(function(){return ei(t),Xr().sortDeliveryTable(3)})),mo(8),Ua(9,"translate"),Fr(),Nr(10,"th",6),Jr("click",(function(){return ei(t),Xr().sortDeliveryTable(2)})),mo(11),Ua(12,"translate"),Fr(),Lr(13,sx,3,3,"th",7),Nr(14,"th",8),Jr("click",(function(){return ei(t),Xr().sortDeliveryTable(4)})),mo(15),Ua(16,"translate"),Fr(),Lr(17,rx,3,3,"th",9),Nr(18,"th",10),Jr("click",(function(){return ei(t),Xr().sortDeliveryTable(6)})),mo(19),Ua(20,"translate"),Fr(),Fr(),Fr(),Nr(21,"tbody"),Lr(22,hx,12,16,"tr",11),Fr(),Fr(),Fr(),Lr(23,gx,2,9,"ng-template",null,12,ja),Lr(25,fx,1,6,"ng-template",null,13,ja),Nr(27,"div",14),Nr(28,"div",15),Nr(29,"div",16),Nr(30,"div",17),Nr(31,"h5",18),mo(32),Ua(33,"translate"),Fr(),Nr(34,"button",19),Nr(35,"span",20),mo(36,"\xd7"),Fr(),Fr(),Fr(),Lr(37,Cx,23,15,"div",21),Nr(38,"div",22),Nr(39,"button",23),mo(40),Ua(41,"translate"),Fr(),Lr(42,Vx,3,3,"button",24),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr();_n(1),jr("ngIf",t.displaySwitch()),_n(1),jr("ngIf",!t.reducedList),_n(6),fo(Oa(9,13,"compViewDelivery.lbl.description")),_n(3),fo(Oa(12,15,"compViewDelivery.lbl.planElement")),_n(2),jr("ngIf",!t.reducedList),_n(2),fo(Oa(16,17,"compViewDelivery.lbl.endDateVPV")),_n(2),jr("ngIf",!t.reducedList),_n(2),fo(Oa(20,19,"compViewDelivery.lbl.done")),_n(3),jr("ngForOf",t.filteredDelivery),_n(10),fo(Oa(33,21,"compViewDelivery.titleDetailDelivery")),_n(5),jr("ngIf",t.deliveryIndex>=0&&t.deliveryIndex<t.filteredDelivery.length),_n(3),fo(Oa(41,23,"compViewDelivery.btn.back")),_n(2),jr("ngIf",t.canSeeRestriction())}}let Ax=(()=>{class t{constructor(t,e,i,n,s,r){this.visboprojectversionService=t,this.messageService=e,this.alertService=i,this.route=n,this.router=s,this.translate=r,this.listType=[{name:"PFV",ref:"pfv",localName:""},{name:"VPV",ref:"vpv",localName:""},{name:"All",ref:void 0,localName:""}],this.type=this.listType[0].name,this.refType=this.listType[0].ref,this.switchType=!0,this.parentThis=this,this.colors=["#005600","green","orange","red"],this.graphAllDataPieChart=[],this.graphAllPieLegend=[["string",this.translate.instant("compViewDelivery.lbl.status")],["number",this.translate.instant("compViewDelivery.lbl.count")]],this.graphAllOptionsPieChart={title:"View Delivery Status",titleTextStyle:{color:"black",fontSize:"16"},pieSliceText:"percentage",tooltip:{trigger:"none"},colors:this.colors},this.divAllPieChart="divAllDeliveryPieChart",this.permVC=Iv,this.permVP=Sv}ngOnInit(){this.currentLang=this.translate.currentLang,this.statusList=[this.translate.instant("keyMetrics.chart.statusDeliveryAhead"),this.translate.instant("keyMetrics.chart.statusDeliveryInTime"),this.translate.instant("keyMetrics.chart.statusDeliveryDelay"),this.translate.instant("keyMetrics.chart.statusDeliveryNotCompleted"),"Unknown"],this.listType.forEach(t=>t.localName=this.translate.instant("compViewDelivery.lbl.".concat(t.name))),this.visboDeliveryCalc()}ngOnChanges(t){this.log(`Delivery on Changes  ${this.vpvActive._id} ${this.vpvActive.timestamp}, Changes: ${JSON.stringify(t)}`),void 0!==this.currentVpvId&&this.vpvActive._id!==this.currentVpvId&&this.visboDeliveryCalc()}onResized(t){t||this.log("No event in Resize"),this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(()=>{this.visboViewAllDeliveryPie(),this.timeoutID=void 0},500)}visboDeliveryCalc(){this.vpvActive&&(this.currentVpvId=this.vpvActive._id,this.log(`Delivery Calc for Version  ${this.vpvActive._id} ${this.vpvActive.timestamp} Reference ${this.refType}`),this.visboprojectversionService.getDelivery(this.vpvActive._id,this.refType).subscribe(t=>{this.log(`get VPV Calc: Get ${t.length} vpvs with ${t[0].delivery.length} Delivery entries`),1===t.length&&t[0].delivery?(this.log(`Store Delivery for ${t[0]._id} Len ${t[0].delivery.length} Timestamp ${t[0].timestamp}`),this.allDelivery=t[0].delivery,"vpv"!=this.refType&&this.allDelivery&&!this.allDelivery[0].fullPathPFV&&(this.refType="vpv",this.switchType=!1)):(this.log("get VPV Calc: Reset Delivery to empty "),this.allDelivery=void 0),this.initDeliveries(),this.visboViewAllDeliveryPie()},t=>{if(this.log(`get VPV Deliveries failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("compViewDelivery.msg.errorPermVersion",{name:this.vpvActive.name});this.alertService.error(t)}else this.alertService.error(Gh(t))}))}initDeliveries(){if(void 0!==this.allDelivery){for(let t=0;t<this.allDelivery.length;t++){this.allDelivery[t].fullName=this.getFullName(this.allDelivery[t]);const e=this.getStatus(this.allDelivery[t]);this.allDelivery[t].statusID=e,this.allDelivery[t].status=this.statusList[e]}this.filterDeliveries()}}filterDeliveries(){if(this.filteredDelivery=[],this.reducedList=!0,void 0!==this.allDelivery){for(let t=0;t<this.allDelivery.length;t++)this.allDelivery[t].phasePFV&&(this.reducedList=!1),void 0!==this.filterStatus&&this.filterStatus!==this.allDelivery[t].statusID||this.filteredDelivery.push(this.allDelivery[t]);this.sortDeliveryTable(void 0)}}helperDelivery(t){this.deliveryIndex=t}getElementPath(t,e){const i=this.filteredDelivery[t].fullPathVPV;let n="";return n=i.length<=1?this.vpvActive.name:i.slice(1).join(" / "),e>0&&(n=Lh(n,e,"right")),n}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}canSeeRestriction(){let t=this.combinedPerm.vp||0;return t&=this.permVP.Modify+this.permVP.ManagePerm,t>0}getStatus(t){let e=0;return e=t.endDatePFV?t.endDatePFV<=this.vpvActive.timestamp&&t.percentDone<1?3:t.changeDays<0?0:0===t.changeDays?1:2:-1,e}visboViewAllDeliveryPie(){this.graphAllOptionsPieChart.title=this.translate.instant("compViewDelivery.titleAllDelivery");const t=[],e=[];let i;for(let s=0;s<this.statusList.length;s++)t[s]=0;let n=!1;for(let s=0;s<this.filteredDelivery.length;s++)i=this.getStatus(this.filteredDelivery[s]),t[i]+=1,n=!0;for(let s=0;s<t.length;s++)e.push([this.statusList[s],t[s]]);this.graphAllDataPieChart=n?e:[]}chartSelectRow(t,e,i){if(this.log(`chart Select Row ${t} ${e} ${i} for Filter`),void 0===t)this.filterStatus=void 0;else{const t=this.statusList.findIndex(t=>t===e);this.filterStatus=t<0||this.filterStatus===t?void 0:t}this.filterDeliveries()}getFullName(t){let e;return t.fullName&&(e=t.fullName),"vpv"===this.refType||void 0===this.refType?(t.fullPathVPV&&t.fullPathVPV.length>1?e=t.fullPathVPV.slice(1).join(" / "):t.fullPathVPV?e=this.vpvActive.name:t.fullPathPFV&&t.fullPathPFV.length>1&&(e=t.fullPathPFV.slice(1).join(" / ")),e):"pfv"===this.refType?(e=t.fullPathPFV&&t.fullPathPFV.length>1?t.fullPathPFV.slice(1).join(" / "):this.vpvActive.name,e):void 0}inFuture(t){return t>this.vpvActive.timestamp.toString()}getShortText(t,e,i){return Lh(t,e,i)}switchView(){this.log("Switchinig to "+this.type),this.refType=this.listType.find(t=>t.name===this.type).ref,this.visboDeliveryCalc()}displayDelivery(){let t=!1;return this.vpvActive&&this.allDelivery&&this.allDelivery.length>0&&(t=!0),t}displaySwitch(){let t=!1;return this.switchType&&this.hasVPPerm(this.permVP.View)&&(t=!0),t}gotoVPRestrict(t){const e=this.filteredDelivery[t].fullPathVPV,i=this.filteredDelivery[t].nameID;localStorage.setItem("restrict",JSON.stringify({id:i,path:e})),this.log(`goto VP Restrict: ${this.vpvActive.vpid} ID ${i} Path ${e.join(" / ")}`),this.router.navigate(["vpRestrict/".concat(this.vpvActive.vpid)],{queryParams:{id:i}})}sortDeliveryTable(t){this.filteredDelivery&&(void 0!==t?(t!==this.sortColumnDelivery&&(this.sortColumnDelivery=t,this.sortAscendingDelivery=void 0),this.sortAscendingDelivery=void 0===this.sortAscendingDelivery?2===t||3===t:!this.sortAscendingDelivery):(this.sortColumnDelivery=2,this.sortAscendingDelivery=!0),2===this.sortColumnDelivery?(void 0===this.refType&&this.filteredDelivery.sort((function(t,e){return!t.fullPathVPV&&t.fullPathPFV?xh(t.fullPathPFV.join(" / "),e.fullPathVPV.join(" / ")):!e.fullPathVPV&&e.fullPathPFV?xh(t.fullPathVPV.join(" / "),e.fullPathPFV.join(" / ")):!t.fullPathVPV&&!e.fullPathVPV&&t.fullPathPFV&&e.fullPathPFV?xh(t.fullPathPFV.join(" / "),e.fullPathPFV.join(" / ")):xh(t.fullPathVPV.join(" / "),e.fullPathVPV.join(" / "))})),"vpv"===this.refType&&this.filteredDelivery.sort((function(t,e){return xh(t.fullPathVPV.join(" / "),e.fullPathVPV.join(" / "))})),"pfv"===this.refType&&this.filteredDelivery.sort((function(t,e){return xh(t.fullPathPFV.join(" / "),e.fullPathPFV.join(" / "))}))):3===this.sortColumnDelivery?this.filteredDelivery.sort((function(t,e){return xh(t.description.toLowerCase(),e.description.toLowerCase())})):4===this.sortColumnDelivery?this.filteredDelivery.sort((function(t,e){return Th(t.endDateVPV,e.endDateVPV)})):5===this.sortColumnDelivery?this.filteredDelivery.sort((function(t,e){return t.changeDays-e.changeDays})):6===this.sortColumnDelivery&&this.filteredDelivery.sort((function(t,e){return t.percentDone-e.percentDone})),this.sortAscendingDelivery||this.filteredDelivery.reverse())}log(t){this.messageService.add("CompViewDelivery: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(xV),Rr(jh),Rr(Mf),Rr(Bg),Rr(rf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-comp-viewdelivery"]],inputs:{vpvActive:"vpvActive",combinedPerm:"combinedPerm"},features:[_e],decls:1,vars:1,consts:[["class","well",3,"resized",4,"ngIf"],[1,"well",3,"resized"],["class","container",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[3,"click"],[1,"d-none","d-md-table-cell",3,"click"],["class","d-none d-lg-table-cell text-right",3,"click",4,"ngIf"],[1,"d-none","d-lg-table-cell","text-right",3,"click"],["class"," text-right",3,"click",4,"ngIf"],[1,"d-none","d-md-table-cell","text-right",3,"click"],["data-toggle","modal","data-target","#detailDelivery",3,"click",4,"ngFor","ngForOf"],["fontStyle",""],["trafficLight",""],["id","detailDelivery","tabindex","-1","role","dialog","aria-labelledby","Detail Delivery","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","detailDeliveryTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],["class","modal-body",4,"ngIf"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button","class","btn btn-primary","data-dismiss","modal",3,"click",4,"ngIf"],[1,"container"],[1,"d-flex","justify-content-left"],["name","type",1,"col-3","form-control","mx-1",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","d-flex justify-content-center",4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"align-center"],[3,"elementID","graphData","graphLegend","graphOptions","parentThis","language"],[1,"text-right",3,"click"],["data-toggle","modal","data-target","#detailDelivery",3,"click"],[3,"title"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"d-none","d-md-table-cell",3,"title"],["class","d-none d-lg-table-cell text-right",4,"ngIf"],[1,"d-none","d-lg-table-cell","text-right"],["class","text-right",3,"title",4,"ngIf"],["class","d-none d-md-table-cell text-right",4,"ngIf"],["class","d-none d-md-table-cell text-right my_bg_red",4,"ngIf"],[1,"text-right",3,"title"],[1,"d-none","d-md-table-cell","text-right"],[1,"d-none","d-md-table-cell","text-right","my_bg_red"],[3,"ngClass"],[1,"fas","fa-lightbulb",3,"ngClass"],[1,"modal-body"],[1,"v_compact_t","form-group"],[1,"col-4","col-form-label"],[1,"col-8","form-control-static"],["class","v_compact_t form-group",4,"ngIf"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&Lr(0,wx,43,25,"div",0),2&t&&jr("ngIf",e.displayDelivery())},directives:[jc,EV,Gc,cu,Nd,Ou,du,gu,yS,Bc,Ec,Eu,Fd,Tu],pipes:[lv,qc,zc],styles:[".my_darkgreen[_ngcontent-%COMP%]{color:#005600}.my_green[_ngcontent-%COMP%]{color:green}.my_orange[_ngcontent-%COMP%]{color:orange}.my_red[_ngcontent-%COMP%]{color:red}.my_bg_red[_ngcontent-%COMP%]{background-color:red}.v_compact_t[_ngcontent-%COMP%]{margin:0;padding-top:0}"]}),t})();function Px(t,e){if(1&t&&(Nr(0,"span",16),mo(1),Fr()),2&t){const t=Xr(3);_n(1),vo(" (",t.dropDown[t.dropDownIndex],")")}}function kx(t,e){if(1&t){const t=zr();Nr(0,"a",22),Jr("click",(function(){ei(t);const e=Xr().$implicit;return Xr(4).switchVariant(e)})),mo(1),Fr()}if(2&t){const t=Xr().$implicit;_n(1),fo(t)}}function Dx(t,e){if(1&t&&(Nr(0,"div"),Lr(1,kx,2,1,"a",21),Fr()),2&t){const t=e.$implicit,i=Xr(4);_n(1),jr("ngIf",!i.isActiveVariant(t))}}function Mx(t,e){if(1&t&&(Nr(0,"span",17),Br(1,"a",18),Nr(2,"div",19),Lr(3,Dx,2,1,"div",20),Fr(),Fr()),2&t){const t=Xr(3);_n(3),jr("ngForOf",t.dropDown)}}function Ix(t,e){1&t&&qr(0)}const Sx=function(t){return{level:t}};function xx(t,e){if(1&t&&(Nr(0,"small",23),Lr(1,Ix,1,0,"ng-container",24),Fr()),2&t){const t=Xr(3),e=Gr(8);to("title",t.vpvActive.ampelErlaeuterung),_n(1),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(3,Sx,t.vpvActive.ampelStatus))}}function Tx(t,e){if(1&t){const t=zr();Nr(0,"h2"),mo(1),Ua(2,"translate"),Nr(3,"a",12),Jr("click",(function(){ei(t);const e=Xr(2);return e.gotoVPDetail(e.vpActive)})),mo(4),Fr(),Lr(5,Px,2,1,"span",13),Lr(6,Mx,4,1,"span",14),Lr(7,xx,2,5,"small",15),Fr()}if(2&t){const t=Xr(2);_n(1),vo(" ",Oa(2,5,"vpKeyMetric.title"),": "),_n(3),fo(t.vpActive.name),_n(1),jr("ngIf",t.dropDownIndex>0),_n(1),jr("ngIf",t.dropDown.length>1),_n(1),jr("ngIf",t.vpvActive)}}function _x(t,e){if(1&t){const t=zr();Nr(0,"a",12),Jr("click",(function(){ei(t);const e=Xr(2);return e.gotoVC(e.vpActive)})),mo(1),Fr()}if(2&t){const t=Xr(2);_n(1),fo(t.vpActive.vc.name)}}function Ux(t,e){if(1&t&&(Nr(0,"span"),mo(1),Fr()),2&t){const t=Xr(2);_n(1),fo(t.vpActive.vc.name)}}function Ox(t,e){if(1&t&&(Nr(0,"div",8),Nr(1,"div",9),Lr(2,Tx,8,7,"h2",10),Nr(3,"h5"),mo(4),Ua(5,"translate"),Lr(6,_x,2,1,"a",11),Lr(7,Ux,2,1,"span",10),Fr(),Fr(),Fr()),2&t){const t=Xr();_n(2),jr("ngIf",t.vpActive),_n(2),vo("",Oa(5,4,"vpKeyMetric.lbl.vc"),": "),_n(2),jr("ngIf",t.hasVCPerm(t.permVC.View)),_n(1),jr("ngIf",!t.hasVCPerm(t.permVC.View))}}function Ex(t,e){if(1&t){const t=zr();Nr(0,"span",33),Jr("click",(function(){return ei(t),Xr(2).getNextVersion(-1)})),Ua(1,"date"),Fr()}2&t&&eo("title","Previous Period before ",Ea(1,1,Xr(2).refDate,"dd.MM."),"")}function Lx(t,e){if(1&t){const t=zr();Nr(0,"select",34),Jr("ngModelChange",(function(e){return ei(t),Xr(2).refDateInterval=e})),Nr(1,"option",35),mo(2),Ua(3,"translate"),Fr(),Nr(4,"option",36),mo(5),Ua(6,"translate"),Fr(),Nr(7,"option",37),mo(8),Ua(9,"translate"),Fr(),Nr(10,"option",38),mo(11),Ua(12,"translate"),Fr(),Fr()}2&t&&(jr("ngModel",Xr(2).refDateInterval),_n(2),fo(Oa(3,5,"vpKeyMetric.lbl.day")),_n(3),fo(Oa(6,7,"vpKeyMetric.lbl.week")),_n(3),fo(Oa(9,9,"vpKeyMetric.lbl.month")),_n(3),fo(Oa(12,11,"vpKeyMetric.lbl.quarter")))}function Gx(t,e){if(1&t){const t=zr();Nr(0,"span",39),Jr("click",(function(){return ei(t),Xr(2).getNextVersion(1)})),Ua(1,"date"),Fr()}2&t&&eo("title","Next Period after ",Ea(1,1,Xr(2).refDate,"dd.MM."),"")}function Rx(t,e){if(1&t&&(Nr(0,"div",25),Nr(1,"div",8),Nr(2,"h4",26),Nr(3,"div",27),Ua(4,"date"),mo(5),Ua(6,"translate"),Ua(7,"date"),Fr(),Nr(8,"div",28),mo(9),Ua(10,"date"),Fr(),Fr(),Nr(11,"div",29),Nr(12,"div",8),Lr(13,Ex,2,4,"span",30),Lr(14,Lx,13,13,"select",31),Lr(15,Gx,2,4,"span",32),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr();_n(3),to("title",Ea(4,7,t.vpvActive.timestamp,"dd.MM.yyyy HH:mm")),_n(2),bo("",Oa(6,10,"vpKeyMetric.titleVersion"),": ",Ea(7,12,t.vpvActive.timestamp,"dd.MM.yyyy"),""),_n(4),vo("V.: ",Ea(10,15,t.vpvActive.timestamp,"dd.MM."),""),_n(4),jr("ngIf",t.statusDirection>=0),_n(1),jr("ngIf",null!=t.statusDirection),_n(1),jr("ngIf",t.statusDirection<=0)}}function jx(t,e){if(1&t){const t=zr();Nr(0,"button",48),Jr("click",(function(){return ei(t),Xr(3).switchView("KeyMetrics")})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpKeyMetric.btn.vpKeyMetric")))}function $x(t,e){if(1&t){const t=zr();Nr(0,"button",48),Jr("click",(function(){return ei(t),Xr(3).switchView("Capacity")})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpKeyMetric.btn.vpCapacity")))}function Nx(t,e){if(1&t){const t=zr();Nr(0,"a",22),Jr("click",(function(){return ei(t),Xr(3).switchView("Cost",!1)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpKeyMetric.lbl.metricCost")))}function Fx(t,e){if(1&t){const t=zr();Nr(0,"a",22),Jr("click",(function(){return ei(t),Xr(3).switchView("Deadline",!1)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpKeyMetric.lbl.metricDeadline")))}function Bx(t,e){if(1&t){const t=zr();Nr(0,"a",22),Jr("click",(function(){return ei(t),Xr(3).switchView("Delivery",!1)})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpKeyMetric.lbl.metricDelivery")))}function Hx(t,e){if(1&t){const t=zr();Nr(0,"div",42),Nr(1,"div",43),Lr(2,jx,3,3,"button",44),Lr(3,$x,3,3,"button",44),Nr(4,"div",45),Nr(5,"button",46),mo(6),Ua(7,"translate"),Br(8,"span",47),Fr(),Nr(9,"div",19),Lr(10,Nx,3,3,"a",21),Lr(11,Fx,3,3,"a",21),Lr(12,Bx,3,3,"a",21),Nr(13,"a",22),Jr("click",(function(){return ei(t),Xr(2).switchView("All")})),mo(14),Ua(15,"translate"),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(2),jr("ngIf",t.hasVPPerm(t.permVP.View)),_n(1),jr("ngIf",t.hasVPPerm(t.permVP.Modify+t.permVP.ViewAudit)&&t.hasOrga),_n(3),vo(" ",Oa(7,7,"vpKeyMetric.btn.vpView")," "),_n(4),jr("ngIf",t.hasKM(t.vpvActive.keyMetrics,"Cost")&&t.hasOrga),_n(1),jr("ngIf",t.hasKM(t.vpvActive.keyMetrics,"Deadline")),_n(1),jr("ngIf",t.hasKM(t.vpvActive.keyMetrics,"Delivery")),_n(2),fo(Oa(15,9,"vpKeyMetric.btn.vpViewAll"))}}function Kx(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"app-comp-viewkeymetrics",49),Jr("switchViewChild",(function(e){return ei(t),Xr(2).switchViewParent(e)})),Fr(),Fr()}if(2&t){const t=Xr(2);_n(1),jr("visboprojectversions",t.visboprojectversions)("vpvid",t.vpvActive._id)("combinedPerm",t.combinedPerm)}}function qx(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-comp-viewcapacity",50),Fr()),2&t){const t=Xr(2);_n(1),jr("vpActive",t.vpActive)("vpvActive",t.vpvActive)("combinedPerm",t.combinedPerm)}}function zx(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-comp-viewcost",51),Fr()),2&t){const t=Xr(2);_n(1),jr("vpvActive",t.vpvActive)("combinedPerm",t.combinedPerm)}}function Qx(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-comp-viewdeadline",51),Fr()),2&t){const t=Xr(2);_n(1),jr("vpvActive",t.vpvActive)("combinedPerm",t.combinedPerm)}}function Wx(t,e){if(1&t&&(Nr(0,"div"),Br(1,"app-comp-viewdelivery",51),Fr()),2&t){const t=Xr(2);_n(1),jr("vpvActive",t.vpvActive)("combinedPerm",t.combinedPerm)}}function Jx(t,e){if(1&t&&(Nr(0,"div",53),Nr(1,"div",54),Nr(2,"h5",55),Nr(3,"button",56),mo(4),Ua(5,"translate"),Fr(),Fr(),Fr(),Nr(6,"div",57),Nr(7,"div",58),Br(8,"app-comp-viewcost",51),Fr(),Fr(),Fr()),2&t){const t=Xr(3);_n(4),vo(" ",Oa(5,3,"vpKeyMetric.lbl.metricCost")," "),_n(4),jr("vpvActive",t.vpvActive)("combinedPerm",t.combinedPerm)}}function Yx(t,e){if(1&t&&(Nr(0,"div",53),Nr(1,"div",54),Nr(2,"h5",55),Nr(3,"button",59),mo(4),Ua(5,"translate"),Fr(),Fr(),Fr(),Nr(6,"div",60),Nr(7,"div",58),Br(8,"app-comp-viewdeadline",51),Fr(),Fr(),Fr()),2&t){const t=Xr(3);_n(4),vo(" ",Oa(5,3,"vpKeyMetric.lbl.metricDeadline")," "),_n(4),jr("vpvActive",t.vpvActive)("combinedPerm",t.combinedPerm)}}function Zx(t,e){if(1&t&&(Nr(0,"div",53),Nr(1,"div",61),Nr(2,"h5",55),Nr(3,"button",62),mo(4),Ua(5,"translate"),Fr(),Fr(),Fr(),Nr(6,"div",63),Nr(7,"div",58),Br(8,"app-comp-viewdelivery",51),Fr(),Fr(),Fr()),2&t){const t=Xr(3);_n(4),vo(" ",Oa(5,3,"vpKeyMetric.lbl.metricDelivery")," "),_n(4),jr("vpvActive",t.vpvActive)("combinedPerm",t.combinedPerm)}}function Xx(t,e){if(1&t&&(Nr(0,"div"),Lr(1,Jx,9,5,"div",52),Lr(2,Yx,9,5,"div",52),Lr(3,Zx,9,5,"div",52),Fr()),2&t){const t=Xr(2);_n(1),jr("ngIf",t.hasVPPerm(t.permVP.ViewAudit)&&t.hasKM(t.vpvActive.keyMetrics,"Cost")&&t.hasOrga),_n(1),jr("ngIf",t.hasKM(t.vpvActive.keyMetrics,"Deadline")),_n(1),jr("ngIf",t.hasKM(t.vpvActive.keyMetrics,"Delivery"))}}function tT(t,e){if(1&t&&(Nr(0,"div",40),Lr(1,Hx,16,11,"div",41),Br(2,"hr"),Lr(3,Kx,2,3,"div",10),Lr(4,qx,2,3,"div",10),Lr(5,zx,2,2,"div",10),Lr(6,Qx,2,2,"div",10),Lr(7,Wx,2,2,"div",10),Lr(8,Xx,4,3,"div",10),Fr()),2&t){const t=Xr();_n(1),jr("ngIf",!t.getPreView()),_n(2),jr("ngIf","KeyMetrics"==t.currentView||t.currentViewKM),_n(1),jr("ngIf","Capacity"==t.currentView),_n(1),jr("ngIf","Cost"==t.currentView),_n(1),jr("ngIf","Deadline"==t.currentView),_n(1),jr("ngIf","Delivery"==t.currentView),_n(1),jr("ngIf","All"==t.currentView)}}const eT=function(t,e,i){return{"fa-check-circle text-success":t,"fa-exclamation-triangle text-warning":e,"fa-exclamation-circle text-danger":i}};function iT(t,e){if(1&t&&Br(0,"i",64),2&t){const t=e.level;jr("ngClass",Ma(1,eT,1==t,2==t,3==t))}}const nT=function(t,e,i,n){return{"text-secondary":t,"text-success":e,"text-warning":i,"text-danger":n}};function sT(t,e){if(1&t&&Br(0,"i",65),2&t){const t=e.level;jr("ngClass",Ia(1,nT,0==t,1==t,2==t,3==t))}}const rT=function(t,e){return{"font-weight-bold":t,"font-weight-normal":e}};function oT(t,e){if(1&t&&(Nr(0,"span",66),mo(1),Fr()),2&t){const t=e.selected,i=e.text;jr("ngClass",Da(2,rT,1==t,0==t)),_n(1),fo(i)}}function aT(t,e){if(1&t&&(Nr(0,"tr"),Nr(1,"td"),mo(2),Ua(3,"translate"),Fr(),Nr(4,"td"),mo(5),Ua(6,"date"),Fr(),Br(7,"td",82),Fr()),2&t){const t=Xr(3);_n(2),fo(Oa(3,2,"vpKeyMetric.lbl.startDate")),_n(3),fo(Ea(6,4,t.vpvActive.startDate,"dd.MM.yyyy"))}}function lT(t,e){1&t&&Br(0,"span",87)}function cT(t,e){1&t&&Br(0,"span",88)}function dT(t,e){if(1&t&&(Nr(0,"span",89),mo(1),Ua(2,"number"),Ua(3,"translate"),Fr()),2&t){const t=Xr(4);_n(1),bo(" ",Ea(2,2,t.delayEndDate,"1.1-1")," ",Oa(3,5,"vpKeyMetric.lbl.weeksDelay"),"")}}function uT(t,e){if(1&t&&(Nr(0,"span",90),mo(1),Ua(2,"number"),Ua(3,"translate"),Fr()),2&t){const t=Xr(4);_n(1),bo(" ",Ea(2,2,-t.delayEndDate,"1.1-1")," ",Oa(3,5,"vpKeyMetric.lbl.weeksAhead"),"")}}function hT(t,e){1&t&&(Nr(0,"span"),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),vo(" ",Oa(2,1,"vpKeyMetric.lbl.inTime"),""))}function pT(t,e){if(1&t&&(Nr(0,"tr"),Nr(1,"td"),mo(2),Ua(3,"translate"),Fr(),Nr(4,"td"),Lr(5,lT,1,0,"span",83),Lr(6,cT,1,0,"span",84),Nr(7,"span"),mo(8),Ua(9,"date"),Fr(),Fr(),Nr(10,"td",82),Lr(11,dT,4,7,"span",85),Lr(12,uT,4,7,"span",86),Lr(13,hT,3,3,"span",10),Fr(),Fr()),2&t){const t=Xr(3);_n(2),fo(Oa(3,7,"vpKeyMetric.lbl.endDate")),_n(3),jr("ngIf",t.delayEndDate>0),_n(1),jr("ngIf",t.delayEndDate<=0),_n(2),vo(" ",Ea(9,9,t.vpvActive.keyMetrics.endDateCurrent,"dd.MM.yyyy"),""),_n(3),jr("ngIf",t.delayEndDate>0),_n(1),jr("ngIf",t.delayEndDate<0),_n(1),jr("ngIf",0==t.delayEndDate)}}function gT(t,e){if(1&t&&(Nr(0,"tr"),Nr(1,"td"),mo(2),Ua(3,"translate"),Fr(),Nr(4,"td"),Nr(5,"span"),mo(6),Ua(7,"date"),Fr(),Fr(),Br(8,"td",82),Fr()),2&t){const t=Xr(3);_n(2),fo(Oa(3,2,"vpKeyMetric.lbl.endDate")),_n(4),vo(" ",Ea(7,4,t.vpvActive.endDate,"dd.MM.yyyy"),"")}}function mT(t,e){if(1&t&&(Nr(0,"tr"),Nr(1,"td",80),Ua(2,"translate"),mo(3),Ua(4,"translate"),Fr(),Nr(5,"td"),mo(6),Ua(7,"number"),Fr(),Br(8,"td"),Fr()),2&t){const t=Xr(3);_n(1),to("title",Oa(2,3,"keyMetrics.longRAC")),_n(2),fo(Oa(4,5,"keyMetrics.shortRAC")),_n(3),vo(" ",Ea(7,7,t.vpvActive.Erloes,"1.0-0")," T\u20ac ")}}function fT(t,e){if(1&t&&(Nr(0,"tr"),Nr(1,"td"),mo(2),Ua(3,"translate"),Fr(),Nr(4,"td",80),mo(5),Fr(),Br(6,"td"),Fr()),2&t){const t=Xr(3);_n(2),fo(Oa(3,3,"vpKeyMetric.lbl.status")),_n(2),to("title",t.vpvActive.status),_n(1),vo(" ",t.getShortText(t.vpvActive.status,20)," ")}}function vT(t,e){1&t&&qr(0)}function bT(t,e){if(1&t&&(Nr(0,"tr"),Nr(1,"td"),mo(2),Ua(3,"translate"),Fr(),Nr(4,"td",80),mo(5),Fr(),Br(6,"td"),Fr()),2&t){const t=Xr(3);_n(2),fo(Oa(3,3,"vpKeyMetric.lbl.leadPerson")),_n(2),to("title",t.vpvActive.leadPerson),_n(1),vo(" ",t.getShortText(t.vpvActive.leadPerson,20)," ")}}function yT(t,e){if(1&t&&(Nr(0,"tr"),Nr(1,"td"),mo(2),Ua(3,"translate"),Fr(),Br(4,"td"),Nr(5,"td",80),mo(6),Fr(),Fr()),2&t){const t=Xr(3);_n(2),fo(Oa(3,3,"vpKeyMetric.lbl.description")),_n(3),to("title",t.vpvActive.description),_n(1),vo(" ",t.vpvActive.description," ")}}function CT(t,e){if(1&t&&(Nr(0,"tr"),Nr(1,"td"),mo(2),Ua(3,"translate"),Fr(),Nr(4,"td",80),mo(5),Fr(),Br(6,"td"),Fr()),2&t){const t=Xr(3);_n(2),fo(Oa(3,3,"vpKeyMetric.lbl.template")),_n(2),to("title",t.vpvActive.VorlagenName),_n(1),vo(" ",t.getShortText(t.vpvActive.VorlagenName,20)," ")}}function VT(t,e){if(1&t&&(Nr(0,"tr"),Nr(1,"td"),mo(2),Ua(3,"translate"),Fr(),Nr(4,"td",80),mo(5),Fr(),Br(6,"td"),Fr()),2&t){const t=Xr(3);_n(2),fo(Oa(3,3,"vpKeyMetric.lbl.bu")),_n(2),to("title",t.vpvActive.businessUnit),_n(1),vo(" ",t.getShortText(t.vpvActive.businessUnit,20)," ")}}function wT(t,e){if(1&t&&(Nr(0,"table",79),Nr(1,"thead"),Nr(2,"tr"),Nr(3,"th"),mo(4),Ua(5,"translate"),Fr(),Nr(6,"th"),mo(7),Ua(8,"translate"),Fr(),Nr(9,"th"),mo(10),Ua(11,"translate"),Fr(),Fr(),Fr(),Nr(12,"tbody"),Lr(13,aT,8,7,"tr",10),Lr(14,pT,14,12,"tr",10),Lr(15,gT,9,7,"tr",10),Lr(16,mT,9,10,"tr",10),Lr(17,fT,7,5,"tr",10),Nr(18,"tr"),Nr(19,"td"),mo(20),Ua(21,"translate"),Fr(),Nr(22,"td",80),Lr(23,vT,1,0,"ng-container",24),Fr(),Nr(24,"td",81),mo(25),Fr(),Fr(),Lr(26,bT,7,5,"tr",10),Lr(27,yT,7,5,"tr",10),Lr(28,CT,7,5,"tr",10),Lr(29,VT,7,5,"tr",10),Fr(),Fr()),2&t){const t=Xr(2),e=Gr(8);_n(4),fo(Oa(5,18,"vpKeyMetric.lbl.name")),_n(3),fo(Oa(8,20,"vpKeyMetric.lbl.value")),_n(3),fo(Oa(11,22,"vpKeyMetric.lbl.info")),_n(3),jr("ngIf",t.vpvActive.startDate),_n(1),jr("ngIf",t.vpvActive.keyMetrics&&t.vpvActive.keyMetrics.endDateCurrent),_n(1),jr("ngIf",!(t.vpvActive.keyMetrics&&t.vpvActive.keyMetrics.endDateCurrent)&&t.vpvActive.endDate),_n(1),jr("ngIf",t.vpvActive.Erloes),_n(1),jr("ngIf",t.vpvActive.status),_n(3),fo(Oa(21,24,"keyMetrics.lbl.trafficLight")),_n(2),to("title",t.vpvActive.ampelErlaeuterung),_n(1),jr("ngTemplateOutlet",e)("ngTemplateOutletContext",ka(26,Sx,t.vpvActive.ampelStatus)),_n(1),to("title",t.vpvActive.ampelErlaeuterung),_n(1),vo(" ",t.vpvActive.ampelErlaeuterung," "),_n(1),jr("ngIf",t.vpvActive.leadPerson),_n(1),jr("ngIf",t.vpvActive.description),_n(1),jr("ngIf",t.vpvActive.VorlagenName),_n(1),jr("ngIf",t.vpvActive.businessUnit)}}function AT(t,e){if(1&t&&(Nr(0,"div",67),Nr(1,"div",68),Nr(2,"div",69),Nr(3,"div",70),Nr(4,"h5",71),mo(5),Ua(6,"translate"),Ua(7,"date"),Fr(),Nr(8,"button",72),Nr(9,"span",73),mo(10,"\xd7"),Fr(),Fr(),Fr(),Nr(11,"div",74),Nr(12,"form",75),Lr(13,wT,30,28,"table",76),Nr(14,"div",77),Nr(15,"button",78),mo(16),Ua(17,"translate"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr();_n(5),bo("",Oa(6,4,"vpKeyMetric.titleDetailVersion"),": ",Ea(7,6,t.vpvActive.timestamp,"dd.MM.yy HH:mm")," "),_n(8),jr("ngIf",t.vpvActive),_n(3),fo(Oa(17,9,"vpKeyMetric.btn.back"))}}let PT=(()=>{class t{constructor(t,e,i,n,s,r,o,a,l){this.visboprojectversionService=t,this.visboprojectService=e,this.visbosettingService=i,this.messageService=n,this.alertService=s,this.route=r,this.router=o,this.translate=a,this.titleService=l,this.dropDown=[],this.deleted=!1,this.currentView="KeyMetrics",this.currentViewKM=!1,this.refDate=new Date,this.refDateInterval="month",this.allViews=["KeyMetrics","Capacity","Cost","Deadline","Delivery","All"],this.hasOrga=!1,this.sortAscending=!1,this.sortColumn=1,this.permVC=Iv,this.permVP=Sv}ngOnInit(){this.currentLang=this.translate.currentLang,this.variantID=this.route.snapshot.queryParams.variantID,this.variantName=this.route.snapshot.queryParams.variantName,this.defaultVariant=this.translate.instant("vpKeyMetric.lbl.defaultVariant");let t=this.route.snapshot.queryParams.view;if(!t)switch(this.route.snapshot.url[0].toString()){case"vpViewCost":t="Cost";break;case"vpViewDeadlines":t="Deadline";break;case"vpViewDeliveries":t="Delivery";break;case"vpView":t="All"}this.allViews.find(e=>e===t)&&(this.currentView=t),this.route.snapshot.queryParams.refDate&&(this.refDate=new Date(this.route.snapshot.queryParams.refDate)),this.getVisboProjectVersions()}ngOnChanges(t){this.log("VP KeyMetrics Changes "+JSON.stringify(t)),this.findVPV(new Date(this.refDate))}switchViewParent(t){t&&(t.refDate&&this.findVPV(new Date(t.refDate)),t.view&&(this.currentView=t.view),t.viewKM&&(this.currentView=t.viewKM,this.currentViewKM=!0))}hasVCPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vc&t)>0}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}dropDownInit(){if(this.variantID){const t=this.vpActive.variant.findIndex(t=>t._id.toString()===this.variantID);t>=0?this.variantName=this.vpActive.variant[t].variantName:this.variantID=void 0}else if(this.variantName){const t=this.vpActive.variant.findIndex(t=>t.variantName===this.variantName);t>=0?(this.variantName=this.vpActive.variant[t].variantName,this.variantID=this.vpActive.variant[t]._id):this.variantName=void 0}this.log(`Init Drop Down List ${this.vpActive.variant.length+1} Variant ${this.variantID}/${this.variantName}`),this.dropDown=[],this.dropDownIndex=void 0;const t=this.vpActive.variant.length;for(let e=0;e<t;e++)"pfv"!==this.vpActive.variant[e].variantName&&this.vpActive.variant[e].vpvCount>0&&this.dropDown.push(this.vpActive.variant[e].variantName);this.dropDown.length>0&&(this.dropDown.splice(0,0,this.defaultVariant),this.dropDownIndex=0),this.variantName&&(this.dropDownIndex=this.dropDown.findIndex(t=>t===this.variantName))}findVPV(t){if(this.visboprojectversions.length>0){let e=0;if(t){for(;e<this.visboprojectversions.length&&!(t.toISOString()>=new Date(this.visboprojectversions[e].timestamp).toISOString());e++);e>=this.visboprojectversions.length&&(e=this.visboprojectversions.length-1)}this.vpvActive=this.visboprojectversions[e],this.evaluateDirection(e)}}evaluateDirection(t){this.statusDirection=1===this.visboprojectversions.length?void 0:t<=0?1:t>=this.visboprojectversions.length-1?-1:0}switchView(t,e=!1){(t=this.allViews.find(e=>e===t))||(t=this.allViews[0]),this.currentView=t,this.currentViewKM=e,this.updateUrlParam("view",t)}switchVariant(t){const e=this.dropDown.findIndex(e=>e===t);if(this.dropDownIndex=e<=0?void 0:e,this.log(`switch Variant ${t} index ${this.dropDownIndex}`),this.dropDownIndex>=0){const e=this.vpActive.variant.find(e=>e.variantName==t);e?(this.variantName=e.variantName,this.variantID=e._id):(this.variantName=void 0,this.variantID=void 0),this.updateUrlParam("variantID",e&&e._id)}else this.variantName=void 0,this.variantID=void 0,this.updateUrlParam("variantID",null);this.getVisboProjectVersions()}isActiveVariant(t){let e=!1;return null==this.variantName&&t==this.defaultVariant&&(e=!0),this.variantName===t&&(e=!0),e}updateUrlParam(t,e){const i=this.route.snapshot.url.join("/");void 0===e&&(e=null);const n=new yb;"variantID"==t?(n.variantID=e,n.variantName=null):"refDate"==t?n.refDate=e:"view"==t&&(n.view=e),this.router.navigate([i],{queryParams:n,replaceUrl:!0,queryParamsHandling:"merge"})}hasKM(t,e){let i=!1;return!t||("Cost"==e?i=t.costCurrentTotal>0||t.costBaseLastTotal>0:"Deadline"==e?i=t.timeCompletionCurrentTotal>1||t.timeCompletionBaseLastTotal>1:"EndDate"==e?i=null!=t.endDateCurrent||null!=t.endDateBaseLast:"DeadlineDelay"===e?(t.timeCompletionCurrentTotal>1||t.timeCompletionBaseLastTotal>1)&&(i=void 0!==t.timeDelayFinished&&void 0!==t.timeDelayUnFinished):"Delivery"==e?i=t.deliverableCompletionCurrentTotal>0||t.deliverableCompletionBaseLastTotal>0:"DeliveryDelay"===e&&(i=void 0!==t.timeDelayFinished&&void 0!==t.timeDelayUnFinished),i)}getVisboProjectVersions(){const t=this.route.snapshot.paramMap.get("id");this.vpSelected=t,this.log("get VP name if ID is used "+t),t?this.visboprojectService.getVisboProject(t).subscribe(e=>{this.vpActive&&this.vpActive._id===e._id||(this.vpActive=e,this.combinedPerm=e.perm,this.titleService.setTitle(this.translate.instant("vpKeyMetric.titleName",{name:e.name})),this.dropDownInit(),this.getVisboCenterOrga());const i=this.dropDownIndex>0?this.dropDown[this.dropDownIndex]:"";let n="";if(i){const t=this.vpActive.variant.find(t=>t.variantName===i);n=t?t._id.toString():""}this.log(`get VP name if ID is used ${this.vpActive.name} Variant: ${i}/${n} Perm ${JSON.stringify(this.combinedPerm)}`),this.visboprojectversionService.getVisboProjectVersions(t,this.deleted,n,!0).subscribe(t=>{this.visboprojectversions=t,this.visboprojectversions.sort((function(t,e){return Th(e.timestamp,t.timestamp)})),this.log(`get VPV Key metrics: Get ${t.length} Project Versions`),this.findVPV(this.refDate)},t=>{if(this.log(`get VPVs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpKeyMetric.msg.errorPermVersion",{name:this.vpActive.name});this.alertService.error(t)}else this.alertService.error(Gh(t))})},t=>{if(this.log(`get VPV VP failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpKeyMetric.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Gh(t))}):this.gotoRoot()}sameDay(t,e){const i=new Date(t),n=new Date(e);return i.setHours(0,0,0,0),n.setHours(0,0,0,0),i.getTime()===n.getTime()}getRefDateVersions(t){this.log(`get getRefDateVersions current ${this.refDate} ${t} ${this.refDateInterval}`);const e=new Date(this.refDate);let i,n=0,s=0;switch(this.refDateInterval){case"day":e.setHours(0,0,0,0),(t>0||e.getTime()===this.refDate.getTime())&&e.setDate(e.getDate()+t);break;case"week":e.setHours(0,0,0,0),e.setDate(e.getDate()+7*t);break;case"month":e.setHours(0,0,0,0),e.setDate(1),(t>0||e.getTime()===this.refDate.getTime())&&e.setMonth(e.getMonth()+t);break;case"quarter":s=Math.trunc(e.getMonth()/3),t>0&&(s+=t),e.setMonth(3*s),e.setDate(1),e.setHours(0,0,0,0),e.getTime()===this.refDate.getTime()&&e.setMonth(e.getMonth()+3*t)}if(this.log(`get getRefDateVersions new ${e.toISOString()} ${this.refDate.toISOString()}`),this.refDate=e,t>0){const t=new Date(this.visboprojectversions[0].timestamp);e.getTime()>=t.getTime()&&(i=0,this.refDate=new Date)}else{const t=new Date(this.visboprojectversions[this.visboprojectversions.length-1].timestamp);e.getTime()<=t.getTime()&&(i=this.visboprojectversions.length-1,this.refDate.setTime(t.getTime()))}if(void 0===i){for(this.log("get getRefDateVersions normalised "+new Date(e).toISOString()),n=0;n<this.visboprojectversions.length&&!(new Date(this.visboprojectversions[n].timestamp).getTime()<=e.getTime());n++);i=n}this.log("get getRefDateVersions vpv timestamp "+this.visboprojectversions[i].timestamp),this.setVpvActive(this.visboprojectversions[i]),this.evaluateDirection(i)}getNextVersion(t){this.getRefDateVersions(t),Oh(this.refDate)?this.updateUrlParam("refDate",void 0):this.updateUrlParam("refDate",this.refDate.toISOString())}gotoRoot(){this.log("goto Root as no id is specified"),this.router.navigate(["/"],{})}getVisboCenterOrga(){this.vpActive&&this.combinedPerm&&(this.combinedPerm.vc&this.permVC.View)>0&&(this.log("get VC Orga "+this.vpActive.vcid),this.visbosettingService.getVCOrganisations(this.vpActive.vcid,!1,void 0,!0).subscribe(t=>{this.hasOrga=t.length>0},t=>{if(403===t.status){const t=this.translate.instant("vpKeyMetric.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Gh(t))}))}setVpvActive(t){const e=t.keyMetrics;let i=0;e&&e.endDateCurrent&&e.endDateBaseLast&&(i=new Date(e.endDateCurrent).getTime()-new Date(e.endDateBaseLast).getTime()),this.delayEndDate=Math.round(i/1e3/60/60/24)/7,this.vpvActive=t,this.log(`VPV Active: vpv: ${t._id} ${t.timestamp}`)}gotoVPDetail(t){this.router.navigate(["vpDetail/".concat(t._id)])}gotoVC(t){this.router.navigate(["vp/".concat(t.vcid)])}helperDateDiff(t,e,i){const n=new Date(t),s=new Date(e);let r=n.getTime()-s.getTime();return"w"===i?r=r/1e3/60/60/24/7:"d"===i?r=r/1e3/60/60/24:r/=1e3,r}getShortText(t,e){return Lh(t,e)}sortVPVTable(t){this.visboprojectversions&&(void 0!==t?(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?5===t:!this.sortAscending):(this.sortColumn=1,this.sortAscending=!1),1===this.sortColumn?this.visboprojectversions.sort((function(t,e){return Th(t.timestamp,e.timestamp)})):2===this.sortColumn?this.visboprojectversions.sort((function(t,e){return Th(t.endDate,e.endDate)})):3===this.sortColumn?this.visboprojectversions.sort((function(t,e){return t.ampelStatus-e.ampelStatus})):4===this.sortColumn?this.visboprojectversions.sort((function(t,e){return t.Erloes-e.Erloes})):5===this.sortColumn&&this.visboprojectversions.sort((function(t,e){return xh(t.variantName.toLowerCase(),e.variantName.toLowerCase())})),this.sortAscending||this.visboprojectversions.reverse())}getPreView(){return Rh()}log(t){this.messageService.add("VisboProjectKeyMetrics: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(xV),Rr(Vb),Rr(Eb),Rr(jh),Rr(Mf),Rr(Bg),Rr(rf),Rr(av),Rr(Md))},t.\u0275cmp=le({type:t,selectors:[["app-visboproject-keymetrics"]],features:[_e],decls:12,vars:4,consts:[[1,"well"],["class","row",4,"ngIf"],["class","d-print-none",4,"ngIf"],["class","container-fluid",4,"ngIf"],["indicator",""],["trafficLight",""],["highlight",""],["class","modal fade","id","VpvDetails","tabindex","-1","role","dialog","aria-labelledby","VpvDetailsTitle","aria-hidden","true",4,"ngIf"],[1,"row"],[1,"col"],[4,"ngIf"],[3,"click",4,"ngIf"],[3,"click"],["class","ml-1",4,"ngIf"],["class","dropdown","class","ml-2",4,"ngIf"],["data-toggle","modal","data-target","#VpvDetails","class","mx-2",3,"title",4,"ngIf"],[1,"ml-1"],[1,"ml-2"],["data-toggle","dropdown",1,"dropdown-toggle"],[1,"dropdown-menu"],[4,"ngFor","ngForOf"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"dropdown-item",3,"click"],["data-toggle","modal","data-target","#VpvDetails",1,"mx-2",3,"title"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"d-print-none"],[1,"col-6","text-dark"],[1,"d-none","d-lg-block",3,"title"],[1,"d-block","d-lg-none"],[1,"col-6"],["style","font-size: 2.2em","class","mx-1 fas fa-caret-square-left",3,"title","click",4,"ngIf"],["class","col-4 form-control d-none d-md-block","name","refDateInterval",3,"ngModel","ngModelChange",4,"ngIf"],["style","font-size: 2.2em","class","mx-1 fas fa-caret-square-right",3,"title","click",4,"ngIf"],[1,"mx-1","fas","fa-caret-square-left",2,"font-size","2.2em",3,"title","click"],["name","refDateInterval",1,"col-4","form-control","d-none","d-md-block",3,"ngModel","ngModelChange"],["value","day"],["value","week"],["value","month"],["value","quarter"],[1,"mx-1","fas","fa-caret-square-right",2,"font-size","2.2em",3,"title","click"],[1,"container-fluid"],["class","row d-print-none",4,"ngIf"],[1,"row","d-print-none"],[1,"col-9","btn-toolbar",2,"padding","unset"],["type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],[1,"btn-group"],["data-toggle","dropdown",1,"btn","btn-md","btn-light","dropdown-toggle"],[1,"caret"],["type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],[3,"visboprojectversions","vpvid","combinedPerm","switchViewChild"],[3,"vpActive","vpvActive","combinedPerm"],[3,"vpvActive","combinedPerm"],["class","card",4,"ngIf"],[1,"card"],["id","headingOne",1,"card-header"],[1,"mb-0"],["type","button","data-toggle","collapse","data-target","#collapseThree","aria-expanded","true","aria-controls","collapseThree",1,"btn","btn-primary"],["id","collapseThree","aria-labelledby","headingThree",1,"collapse","show"],[1,"card-body"],["type","button","data-toggle","collapse","data-target","#collapseOne","aria-expanded","true","aria-controls","collapseOne",1,"btn","btn-primary"],["id","collapseOne","aria-labelledby","headingOne",1,"collapse","show"],["id","headingTwo",1,"card-header"],["type","button","data-toggle","collapse","data-target","#collapseTwo","aria-expanded","true","aria-controls","collapseTwo",1,"btn","btn-primary"],["id","collapseTwo","aria-labelledby","headingTwo",1,"collapse","show"],[1,"fa",3,"ngClass"],[1,"fas","fa-lightbulb",3,"ngClass"],[3,"ngClass"],["id","VpvDetails","tabindex","-1","role","dialog","aria-labelledby","VpvDetailsTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VpvDetailsTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["name","VpvDetailsForm"],["class","table table-hover",4,"ngIf"],[1,"modal-footer","align-items-end"],["data-dismiss","modal",1,"btn","btn-primary"],[1,"table","table-hover"],[3,"title"],[1,"d-none","d-md-table-cell",3,"title"],[1,"d-none","d-md-table-cell"],["class","fas fa-exclamation-circle","style","color:red",4,"ngIf"],["class","fas fa-check-circle","style","color:green",4,"ngIf"],["class","text-danger",4,"ngIf"],["class","text-success",4,"ngIf"],[1,"fas","fa-exclamation-circle",2,"color","red"],[1,"fas","fa-check-circle",2,"color","green"],[1,"text-danger"],[1,"text-success"]],template:function(t,e){1&t&&(Br(0,"app-usernavbar"),Nr(1,"div",0),Lr(2,Ox,8,6,"div",1),Lr(3,Rx,16,18,"div",2),Lr(4,tT,9,7,"div",3),Fr(),Lr(5,iT,1,5,"ng-template",null,4,ja),Lr(7,sT,1,6,"ng-template",null,5,ja),Lr(9,oT,2,5,"ng-template",null,6,ja),Lr(11,AT,18,11,"div",7)),2&t&&(_n(2),jr("ngIf",e.vpActive),_n(1),jr("ngIf",e.vpvActive&&!e.getPreView()),_n(1),jr("ngIf",e.vpvActive),_n(7),jr("ngIf",e.vpvActive))},directives:[Pb,jc,Gc,Bc,cu,Nd,Ou,du,gu,lS,_w,bS,XS,Ax,Ec,Eu,Fd,Tu],pipes:[lv,qc,zc],encapsulation:2}),t})();function kT(t,e){if(1&t){const t=zr();Nr(0,"a",1),Jr("click",(function(){ei(t);const e=Xr(2);return e.gotoVCDetail(e.visboproject)})),mo(1),Fr()}if(2&t){const t=Xr(2);_n(1),fo(t.visboproject.vc.name)}}function DT(t,e){if(1&t&&(Nr(0,"span"),mo(1),Fr()),2&t){const t=Xr(2);_n(1),fo(t.visboproject.vc.name)}}function MT(t,e){if(1&t&&(Nr(0,"div",3),Nr(1,"label",44),mo(2),Ua(3,"translate"),Fr(),Nr(4,"label",5),mo(5),Fr(),Fr()),2&t){const t=Xr(2);_n(2),vo("",Oa(3,2,"vpRestrict.lbl.description"),":"),_n(3),vo("",t.visboproject.description," ")}}function IT(t,e){1&t&&Br(0,"i",59)}function ST(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td",55),mo(2),Fr(),Nr(3,"td",52),mo(4),Fr(),Nr(5,"td",52),Lr(6,IT,1,0,"i",56),Fr(),Nr(7,"td",57),mo(8),Fr(),Nr(9,"td",57),mo(10),Ua(11,"date"),Fr(),Nr(12,"td"),Nr(13,"button",58),Jr("click",(function(){ei(t);const i=e.index;return Xr(4).helperRemoveRestriction(i)})),Ua(14,"translate"),mo(15,"\xd7"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit,i=e.index,n=Xr(4);_n(1),to("title",n.getRestrictPath(i)),_n(1),fo(n.getRestrictPath(i,30)),_n(2),fo(n.getGroupName(t.groupid)),_n(2),jr("ngIf",t.inclChildren),_n(2),fo(t.user.email),_n(2),fo(Ea(11,7,t.createdAt,"dd.MM HH:mm")),_n(3),to("title",Oa(14,10,"vpRestrict.lbl.rmRestrict"))}}function xT(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div",46),Nr(2,"div",47),Nr(3,"h5",48),mo(4),Ua(5,"translate"),Fr(),Fr(),Fr(),Nr(6,"div",49),Nr(7,"table",50),Nr(8,"thead"),Nr(9,"tr"),Nr(10,"th",1),Jr("click",(function(){return ei(t),Xr(3).sortRestrictTable(1)})),mo(11),Ua(12,"translate"),Fr(),Nr(13,"th",51),Jr("click",(function(){return ei(t),Xr(3).sortRestrictTable(2)})),mo(14),Ua(15,"translate"),Fr(),Nr(16,"th",52),mo(17),Ua(18,"translate"),Fr(),Nr(19,"th",53),Jr("click",(function(){return ei(t),Xr(3).sortRestrictTable(4)})),mo(20),Ua(21,"translate"),Fr(),Nr(22,"th",53),Jr("click",(function(){return ei(t),Xr(3).sortRestrictTable(5)})),mo(23),Ua(24,"translate"),Fr(),Nr(25,"th"),mo(26),Ua(27,"translate"),Fr(),Fr(),Fr(),Nr(28,"tbody"),Lr(29,ST,16,12,"tr",54),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(3);_n(4),vo(" ",Oa(5,8,"vpRestrict.titleProjectRestrict")," "),_n(7),fo(Oa(12,10,"vpRestrict.lbl.restrictpath")),_n(3),fo(Oa(15,12,"vpRestrict.lbl.restrictgroup")),_n(3),fo(Oa(18,14,"vpRestrict.lbl.inclChildren")),_n(3),fo(Oa(21,16,"vpRestrict.lbl.createdBy")),_n(3),fo(Oa(24,18,"vpRestrict.lbl.createdAt")),_n(3),fo(Oa(27,20,"vpRestrict.lbl.delete")),_n(3),jr("ngForOf",t.visboproject.restrict)}}function TT(t,e){if(1&t&&(Nr(0,"div",46),Nr(1,"label",60),mo(2),Fr(),Nr(3,"button",61),mo(4),Ua(5,"translate"),Fr(),Fr()),2&t){const t=Xr(3);_n(1),to("title",t.getRestrictPath(-1)),_n(1),fo(t.getRestrictPath(-1,30)),_n(2),fo(Oa(5,3,"vpRestrict.btn.add"))}}function _T(t,e){if(1&t&&(Nr(0,"div"),Lr(1,xT,30,22,"div",0),Lr(2,TT,6,5,"div",45),Fr()),2&t){const t=Xr(2);_n(1),jr("ngIf",t.visboproject.restrict.length>0&&t.hasVPPerm(t.permVP.Modify+t.permVP.ManagePerm)),_n(1),jr("ngIf",t.newItemPath&&t.hasVPPerm(t.permVP.ManagePerm))}}function UT(t,e){if(1&t&&(Nr(0,"option",62),mo(1),Fr()),2&t){const t=e.$implicit;to("value",t._id),_n(1),fo(t.name)}}function OT(t,e){1&t&&(Nr(0,"div",63),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpRestrict.msg.groupRequired")))}function ET(t,e){1&t&&(Nr(0,"button",64),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"vpRestrict.btn.add")))}function LT(t,e){if(1&t){const t=zr();Nr(0,"button",65),Jr("click",(function(){return ei(t),Xr(2).addRestriction()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"vpRestrict.btn.add")))}function GT(t,e){if(1&t&&(Nr(0,"div",20),Nr(1,"div"),Nr(2,"label",66),mo(3),Ua(4,"translate"),Fr(),Fr(),Nr(5,"form"),Nr(6,"div",23),Nr(7,"label",67),mo(8),Ua(9,"translate"),Fr(),Nr(10,"label",5),mo(11),Fr(),Fr(),Nr(12,"div",23),Nr(13,"label",67),mo(14),Ua(15,"translate"),Fr(),Nr(16,"label",5),mo(17),Fr(),Fr(),Nr(18,"div",23),Nr(19,"label",67),mo(20),Ua(21,"translate"),Fr(),Nr(22,"label",5),mo(23),Fr(),Fr(),Nr(24,"div",23),Nr(25,"label",67),mo(26),Ua(27,"translate"),Fr(),Nr(28,"label",5),mo(29),Fr(),Fr(),Nr(30,"div",23),Nr(31,"label",67),mo(32),Ua(33,"translate"),Fr(),Nr(34,"label",5),mo(35),Fr(),Fr(),Nr(36,"div",23),Nr(37,"label",67),mo(38),Ua(39,"translate"),Fr(),Nr(40,"label",5),mo(41),Ua(42,"date"),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr(2);_n(3),fo(Oa(4,13,"vpRestrict.msg.removeRestrictionConfirm")),_n(5),vo("",Oa(9,15,"vpRestrict.lbl.vp"),":"),_n(3),vo("",t.visboproject.name," "),_n(3),vo("",Oa(15,17,"vpRestrict.lbl.restrictpath"),":"),_n(3),fo(t.getRestrictPath(t.restrictIndex)),_n(3),vo("",Oa(21,19,"vpRestrict.lbl.group"),":"),_n(3),fo(t.getGroupName(t.visboproject.restrict[t.restrictIndex].groupid)),_n(3),vo("",Oa(27,21,"vpRestrict.lbl.inclChildrenDesc"),":"),_n(3),fo(t.visboproject.restrict[t.restrictIndex].inclChildren),_n(3),vo("",Oa(33,23,"vpRestrict.lbl.createdBy"),":"),_n(3),fo(t.visboproject.restrict[t.restrictIndex].user.email),_n(3),vo("",Oa(39,25,"vpRestrict.lbl.createdAt"),":"),_n(3),fo(Ea(42,27,t.visboproject.restrict[t.restrictIndex].createdAt,"dd.MM HH:mm"))}}const RT=function(t){return{"has-error":t}};function jT(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"h3"),mo(2),Ua(3,"translate"),Nr(4,"a",1),Jr("click",(function(){ei(t);const e=Xr();return e.gotoVP(e.visboproject)})),mo(5),Ua(6,"uppercase"),Fr(),Fr(),Nr(7,"h5"),mo(8),Ua(9,"translate"),Lr(10,kT,2,1,"a",2),Lr(11,DT,2,1,"span",0),Fr(),Nr(12,"form"),Nr(13,"div",3),Nr(14,"label",4),mo(15),Ua(16,"translate"),Fr(),Nr(17,"label",5),mo(18),Fr(),Fr(),Lr(19,MT,6,4,"div",6),Nr(20,"div",3),Nr(21,"label",7),mo(22),Ua(23,"translate"),Fr(),Nr(24,"label",8),mo(25),Fr(),Fr(),Nr(26,"div",9),Nr(27,"label",10),mo(28),Ua(29,"translate"),Fr(),Nr(30,"label",11),mo(31),Ua(32,"date"),Fr(),Nr(33,"label",11),mo(34),Ua(35,"date"),Fr(),Fr(),Fr(),Lr(36,_T,3,2,"div",0),Nr(37,"div",12),Nr(38,"button",1),Jr("click",(function(){return ei(t),Xr().goBack()})),mo(39),Ua(40,"translate"),Fr(),Fr(),Nr(41,"div",13),Nr(42,"div",14),Nr(43,"div",15),Nr(44,"div",16),Nr(45,"h5",17),mo(46),Ua(47,"translate"),Fr(),Nr(48,"button",18),Nr(49,"span",19),mo(50,"\xd7"),Fr(),Fr(),Fr(),Nr(51,"div",20),Nr(52,"form",21,22),Nr(54,"div",23),Nr(55,"label",24),mo(56),Ua(57,"translate"),Fr(),Nr(58,"label"),mo(59),Fr(),Fr(),Nr(60,"div",25),Nr(61,"label",26),mo(62),Ua(63,"translate"),Fr(),Nr(64,"select",27,28),Jr("ngModelChange",(function(e){return ei(t),Xr().newItemGroup=e})),Br(66,"option"),Lr(67,UT,2,2,"option",29),Fr(),Lr(68,OT,3,3,"div",30),Fr(),Nr(69,"div",31),Nr(70,"input",32,33),Jr("ngModelChange",(function(e){return ei(t),Xr().newItemInclChildren=e})),Fr(),Nr(72,"label",34),mo(73),Ua(74,"translate"),Fr(),Fr(),Br(75,"br"),Nr(76,"div",35),Nr(77,"button",36),mo(78),Ua(79,"translate"),Fr(),Lr(80,ET,3,3,"button",37),Lr(81,LT,3,3,"button",38),Fr(),Fr(),Fr(),Fr(),Fr(),Fr(),Nr(82,"div",39),Nr(83,"div",14),Nr(84,"div",15),Nr(85,"div",16),Nr(86,"h5",40),mo(87),Ua(88,"translate"),Fr(),Nr(89,"button",18),Nr(90,"span",19),mo(91,"\xd7"),Fr(),Fr(),Fr(),Lr(92,GT,43,30,"div",41),Nr(93,"div",35),Nr(94,"button",42),mo(95),Ua(96,"translate"),Fr(),Nr(97,"button",43),Jr("click",(function(){ei(t);const e=Xr();return e.removeRestriction(e.restrictIndex)})),mo(98),Ua(99,"translate"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Gr(53),e=Gr(65),i=Xr();_n(2),vo("",Oa(3,32,"vpRestrict.title"),": "),_n(3),fo(Oa(6,34,i.visboproject.name)),_n(3),vo("",Oa(9,36,"vpRestrict.titleVC"),": "),_n(2),jr("ngIf",i.hasVCPerm(i.permVC.View)),_n(1),jr("ngIf",!i.hasVCPerm(i.permVC.View)),_n(4),vo("",Oa(16,38,"vpRestrict.lbl.name"),":"),_n(3),vo("",i.visboproject.name," "),_n(1),jr("ngIf",i.visboproject.description),_n(3),vo("",Oa(23,40,"vpRestrict.lbl.type"),":"),_n(3),vo("",i.getVPType(i.visboproject.vpType)," "),_n(3),vo("",Oa(29,42,"vpRestrict.lbl.createdUpdated"),":"),_n(3),vo("",Ea(32,44,i.visboproject.createdAt,"dd.MM.yyyy HH:mm:ss")," "),_n(3),vo("",Ea(35,47,i.visboproject.updatedAt,"dd.MM.yyyy HH:mm:ss")," "),_n(2),jr("ngIf",i.getVPPerm()!=i.permVP.View),_n(3),fo(Oa(40,50,"vpRestrict.btn.back")),_n(7),fo(Oa(47,52,"vpRestrict.titleAddRestriction")),_n(10),vo("",Oa(57,54,"vpRestrict.lbl.restrictpath"),":"),_n(3),fo(i.getRestrictPath(-1)),_n(1),jr("ngClass",ka(68,RT,t.submitted&&!e.valid)),_n(2),vo("",Oa(63,56,"vpRestrict.lbl.group"),":"),_n(2),jr("ngModel",i.newItemGroup),_n(3),jr("ngForOf",i.vgGroups),_n(1),jr("ngIf",t.submitted&&!e.valid),_n(2),jr("ngModel",i.newItemInclChildren),_n(3),fo(Oa(74,58,"vpRestrict.lbl.inclChildrenDesc")),_n(5),fo(Oa(79,60,"vpRestrict.btn.cancel")),_n(2),jr("ngIf",!e.valid),_n(1),jr("ngIf",e.valid),_n(6),fo(Oa(88,62,"vpRestrict.titleRemoveRestriction")),_n(5),jr("ngIf",i.restrictIndex>=0&&i.restrictIndex<i.visboproject.restrict.length),_n(3),fo(Oa(96,64,"vpRestrict.btn.back")),_n(3),fo(Oa(99,66,"vpRestrict.btn.delete"))}}let $T=(()=>{class t{constructor(t,e,i,n,s,r,o){this.messageService=t,this.route=e,this.visboprojectService=i,this.location=n,this.router=s,this.alertService=r,this.translate=o,this.combinedPerm=void 0,this.combinedUserPerm=void 0,this.permVC=Iv,this.permVP=Sv,this.deleted=!1,this.sortRestrictColumn=1,this.sortRestrictAscending=!0}ngOnInit(){const t=this.route.snapshot.queryParams.id;if(t){const e=JSON.parse(localStorage.getItem("restrict"));e&&e.id===t&&(this.newItemPath=e.path)}this.log("VisboProject Restrict Active Path: "+this.newItemPath),this.getVisboProject(),this.getVisboProjectUsers()}getVisboProject(){const t=this.route.snapshot.paramMap.get("id");this.log("VisboProject Restrict of: "+t),this.visboprojectService.getVisboProject(t,!1,this.deleted).subscribe(e=>{this.visboproject=e,this.combinedPerm=e.perm,this.log(`Get VisboProject for VP ${t} Perm ${JSON.stringify(this.combinedPerm)} `)},t=>{if(this.log(`get VPs failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpRestrict.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Gh(t))})}hasVCPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vc&t)>0}hasVPPerm(t){return void 0!==this.combinedPerm&&(this.combinedPerm.vp&t)>0}hasUserVPPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vp&t)>0}getVPPerm(){return void 0===this.combinedPerm?0:this.combinedPerm.vp}getVPType(t){return this.translate.instant("vp.type.vpType"+t)}getRestrictPath(t,e){const i=t>=0?this.visboproject.restrict[t].elementPath:this.newItemPath||[""];let n="";return n=i.length<=1?this.visboproject.name:i.slice(1).join(" / "),e>0&&(n=Lh(n,e,"right")),n}addRestriction(){this.log(`VisboProject Restrict Add Restriction : ${this.newItemPath.join(" / ")} ${this.newItemGroup} ${this.newItemInclChildren}`);const t=new bb;t.name=this.newItemName||(new Date).toISOString(),t.elementPath=this.newItemPath,t.groupid=this.newItemGroup,this.newItemInclChildren&&(t.inclChildren=this.newItemInclChildren),this.visboprojectService.addRestriction(this.visboproject._id,t).subscribe(t=>{this.log("Add VisboProject Restriction result: "+JSON.stringify(t)),this.visboproject.restrict.push(t);const e=this.translate.instant("vpRestrict.msg.addRestrictionSuccess");localStorage.removeItem("restrict"),this.newItemPath=void 0,this.alertService.success(e)},t=>{if(this.log("Add VisboProject Restriction error: "+t.error.message),403===t.status){const t=this.translate.instant("vpRestrict.msg.errorAddRestrictionPerm");this.alertService.error(t)}else this.log("Error during add Restriction from VP  "+t.error.message),this.alertService.error(Gh(t))})}removeRestriction(t){const e=this.visboproject.restrict[t];this.log(`VisboProject Restrict Remove Restriction : ${t} ${e._id}`),this.visboprojectService.deleteRestriction(this.visboproject._id,e._id).subscribe(t=>{this.log("Remove VisboProject Restriction result: "+JSON.stringify(t));for(let n=0;n<this.visboproject.restrict.length;n++)if(this.visboproject.restrict[n]._id===e._id){this.visboproject.restrict.splice(n,1);break}const i=this.translate.instant("vpRestrict.msg.removeRestrictionSuccess");this.alertService.success(i)},t=>{if(this.log("Remove VisboProject Restriction error: "+t.error.message),403===t.status){const t=this.translate.instant("vpRestrict.msg.errorRemoveRestrictionPerm");this.alertService.error(t)}else this.log("Error during remove Restriction from VP  "+t.error.message),this.alertService.error(Gh(t))})}helperRemoveRestriction(t){this.restrictIndex=t}getGroupName(t){const e=this.vgGroups?this.vgGroups.find(e=>e._id===t):void 0;return e?e.name:"Unknown"}getVisboProjectUsers(){const t=this.route.snapshot.paramMap.get("id");this.log(`VisboProject UserList of: ${t} Deleted ${this.deleted}`),this.visboprojectService.getVPUsers(t,!1,this.deleted).subscribe(t=>{this.filterGroups(t.groups),this.log("fetched Groups "+this.vgGroups.length)},t=>{if(this.log(`Get VP Users failed: error: ${t.status} message: ${t.error.message}`),403===t.status){const t=this.translate.instant("vpRestrict.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Gh(t))})}filterGroups(t){this.vgGroups=[],t.forEach(t=>{"VP"===t.groupType&&this.vgGroups.push(t)})}goBack(){this.location.back()}gotoVPAudit(t){this.log(`goto VP Audit: ${t._id} Deleted ${this.deleted}`),this.router.navigate(["vpAudit/".concat(t._id)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}gotoVCDetail(t){this.router.navigate(["vcDetail/".concat(t.vcid)])}gotoVPList(t){this.log(`goto VP List: ${t._id} Deleted ${this.deleted}`),this.router.navigate(["vp/".concat(t.vcid)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}gotoVP(t){this.log(`goto VP: ${t._id} Deleted ${this.deleted}`);let e="vpKeyMetrics/";t.vpType===vb.Portfolio&&(e="vpf/"),this.router.navigate([e.concat(t._id)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}gotoVPView(t){this.log(`goto VP List: ${t._id} Deleted ${this.deleted}`),this.router.navigate(["vpv/".concat(t._id)],this.deleted?{queryParams:{deleted:this.deleted}}:{})}sortRestrictTable(t){if(this.visboproject||this.visboproject.restrict){if(void 0===t&&void 0!==this.sortRestrictColumn||(t!==this.sortRestrictColumn&&(this.sortRestrictColumn=t,this.sortRestrictAscending=void 0),this.sortRestrictAscending=void 0===this.sortRestrictAscending?5!==t:!this.sortRestrictAscending),1===this.sortRestrictColumn)this.visboproject.restrict.sort((function(t,e){return xh(t.elementPath.join(" / ").toLowerCase(),e.elementPath.join(" / ").toLowerCase())}));else if(2===this.sortRestrictColumn){const t=[];this.vgGroups.forEach(e=>t[e._id]=e.name),this.visboproject.restrict.sort((function(e,i){return xh(t[e.groupid],t[i.groupid])}))}else 4===this.sortRestrictColumn?this.visboproject.restrict.sort((function(t,e){return xh(t.user.email,e.user.email)})):5===this.sortRestrictColumn&&this.visboproject.restrict.sort((function(t,e){return Th(t.createdAt,e.createdAt)}));this.sortRestrictAscending||this.visboproject.restrict.reverse()}}log(t){this.messageService.add("VisboProjectRestrict: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(Bg),Rr(Vb),Rr(Xl),Rr(rf),Rr(Mf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-visboproject-restrict"]],decls:2,vars:1,consts:[[4,"ngIf"],[3,"click"],[3,"click",4,"ngIf"],[1,"form-group","row"],["for","vpName",1,"col-3","col-md-2","col-form-label"],[1,"col-8","form-control-static"],["class","form-group row",4,"ngIf"],["for","vpType",1,"col-3","col-md-2","col-form-label"],["name","vpType",1,"col","form-control-static","col-form-label"],[1,"form-group","row","d-none","d-md-block"],["for","Created",1,"col-3","col-md-2","col-form-label"],[1,"col-4","form-control-static","col-form-label"],[1,"mb-3"],["id","VpRestrictionAdd","tabindex","-1","role","dialog","aria-labelledby","VpRestrictModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["novalidate",""],["f1","ngForm"],[1,"form-group"],["for","path",1,"col-form-label"],[1,"form-group",3,"ngClass"],["for","group",1,"col-form-label"],["name","group","required","",1,"form-control",3,"ngModel","ngModelChange"],["group","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","help-block",4,"ngIf"],[1,"custom-control","custom-checkbox"],["type","checkbox","name","inclChildren","id","inclChildrenID",1,"custom-control-input",3,"ngModel","ngModelChange"],["inclChildren","ngModel"],["for","inclChildrenID",1,"custom-control-label"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary","mx-1"],["type","submit","class","btn btn-primary mx-1",4,"ngIf"],["type","submit","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","VpRestrictionRemove","tabindex","-1","role","dialog","aria-labelledby","Remove Restriction","aria-hidden","true",1,"modal","fade"],["id","VpUserRemoveTitle",1,"modal-title"],["class","modal-body",4,"ngIf"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button","data-dismiss","modal",1,"btn","btn-warning",3,"click"],["for","vpDescription",1,"col-3","col-md-2","col-form-label"],["class","row",4,"ngIf"],[1,"row"],[1,"col"],[1,"panel-heading"],[1,"panel-body"],[1,"table","table-hover"],[1,"d-none","d-md-table-cell",3,"click"],[1,"d-none","d-md-table-cell"],[1,"d-none","d-lg-table-cell",3,"click"],[4,"ngFor","ngForOf"],[3,"title"],["class","fa fa-check","aria-hidden","true",4,"ngIf"],[1,"d-none","d-lg-table-cell"],["data-toggle","modal","data-target","#VpRestrictionRemove",1,"btn","btn-md",3,"title","click"],["aria-hidden","true",1,"fa","fa-check"],[1,"col",3,"title"],["type","button","data-toggle","modal","data-target","#VpRestrictionAdd",1,"col-2","btn","btn-primary"],[3,"value"],[1,"help-block"],["type","submit",1,"btn","btn-primary","mx-1"],["type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],[1,"bg-warning"],[1,"col-form-label"]],template:function(t,e){1&t&&(Br(0,"app-usernavbar"),Lr(1,jT,100,70,"div",0)),2&t&&(_n(1),jr("ngIf",e.visboproject))},directives:[Pb,jc,Eu,Fd,Tu,Ec,cu,Ru,Nd,Ou,du,gu,Gc,_d],pipes:[lv,Kc,qc],styles:[""]}),t})(),NT=(()=>{class t{constructor(t,e,i){this.visbocenterService=t,this.messageService=e,this.alertService=i}ngOnInit(){this.activateMessage=this.messageService.getstatus(),this.combinedPerm=this.visbocenterService.getSysAdminRole()}toggleMessages(){this.activateMessage=this.messageService.toggle()}}return t.\u0275fac=function(e){return new(e||t)(Rr(Ev),Rr(jh),Rr(Mf))},t.\u0275cmp=le({type:t,selectors:[["app-settings"]],decls:6,vars:1,consts:[["type","button",1,"btn","btn-sm","btn-primary","align-self-start",3,"click"]],template:function(t,e){1&t&&(Br(0,"app-usernavbar"),Nr(1,"div"),Nr(2,"a"),mo(3),Fr(),Nr(4,"button",0),Jr("click",(function(){return e.toggleMessages()})),mo(5," Toggle Messages "),Fr(),Fr()),2&t&&(_n(3),vo("Display Debug Messages: ",e.activateMessage," "))},directives:[Pb],encapsulation:2}),t})();const FT={headers:new th({"Content-Type":"application/json"})};let BT=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.profileUrl=this.env.restUrl.concat("/user/profile"),this.pwchangeUrl=this.env.restUrl.concat("/user/passwordchange")}getUserProfile(){return this.log("Calling HTTP Get Request: "+this.profileUrl),this.http.get(this.profileUrl,FT).pipe(D(t=>t.user),qh(t=>this.log(`fetched ${t.email} User Profile `)),Fh(this.handleError("getUserProfile")))}updateUserProfile(t){return this.log("Calling HTTP Put Request: "+this.profileUrl),this.http.put(this.profileUrl,t,FT).pipe(D(t=>t.user),qh(t=>this.log(`updated User Profile ${t.email} `)),Fh(this.handleError("updateUserProfile")))}passwordChange(t,e){return this.log("Calling HTTP Put Request: "+this.pwchangeUrl),this.http.put(this.pwchangeUrl,{oldpassword:t,password:e},FT).pipe(D(t=>t.user),qh(t=>this.log(`Changed User Password ${t.email} `)),Fh(this.handleError("ChangedPassword")))}handleError(t="operation",e){return i=>(this.log(`HTTP Request ${t} failed: ${i.error.message} status:${i.status}, Result ${JSON.stringify(e)}`),$h(i))}log(t){this.messageService.add("VisboUserService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(jh),Kt(sp))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function HT(t,e){1&t&&(Nr(0,"div",25),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"profile.msg.firstNameRequired")))}function KT(t,e){1&t&&(Nr(0,"div",25),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"profile.msg.lastNameRequired")))}function qT(t,e){1&t&&(Nr(0,"div",25),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"profile.msg.companyRequired")))}function zT(t,e){1&t&&Br(0,"img",26)}const QT=function(t){return{"has-error":t}},WT=function(){return["/"]};function JT(t,e){if(1&t){const t=zr();Nr(0,"div",2),Nr(1,"h3",3),mo(2),Ua(3,"translate"),Fr(),Nr(4,"div"),Nr(5,"form",4,5),Jr("ngSubmit",(function(){ei(t);const e=Gr(6),i=Xr();return e.form.valid&&i.saveUserProfile()})),Nr(7,"div",6),Nr(8,"label",7),mo(9),Ua(10,"translate"),Fr(),Nr(11,"input",8,9),Jr("ngModelChange",(function(e){return ei(t),Xr().user.profile.firstName=e})),Fr(),Lr(13,HT,3,3,"div",10),Fr(),Nr(14,"div",6),Nr(15,"label",11),mo(16),Ua(17,"translate"),Fr(),Nr(18,"input",12,13),Jr("ngModelChange",(function(e){return ei(t),Xr().user.profile.lastName=e})),Fr(),Lr(20,KT,3,3,"div",10),Fr(),Nr(21,"div",6),Nr(22,"label",14),mo(23),Ua(24,"translate"),Fr(),Nr(25,"input",15,16),Jr("ngModelChange",(function(e){return ei(t),Xr().user.profile.company=e})),Fr(),Lr(27,qT,3,3,"div",10),Fr(),Nr(28,"div",17),Nr(29,"label",18),mo(30),Ua(31,"translate"),Fr(),Nr(32,"input",19,20),Jr("ngModelChange",(function(e){return ei(t),Xr().user.profile.phone=e})),Fr(),Fr(),Nr(34,"div",17),Nr(35,"button",21),mo(36),Ua(37,"translate"),Fr(),Lr(38,zT,1,0,"img",22),Nr(39,"a",23),mo(40),Ua(41,"translate"),Fr(),Nr(42,"button",24),Jr("click",(function(){return ei(t),Xr().passwordInit()})),mo(43),Ua(44,"translate"),Fr(),Fr(),Fr(),Nr(45,"div"),mo(46),Ua(47,"translate"),Ua(48,"date"),Br(49,"br"),mo(50),Ua(51,"translate"),Ua(52,"date"),Fr(),Fr(),Fr()}if(2&t){const t=Gr(6),e=Gr(12),i=Gr(19),n=Gr(26),s=Xr();_n(2),bo("",Oa(3,25,"profile.title")," ",s.user.email,""),_n(5),jr("ngClass",ka(51,QT,t.submitted&&!e.valid)),_n(2),fo(Oa(10,27,"profile.lbl.firstName")),_n(2),jr("ngModel",s.user.profile.firstName),_n(2),jr("ngIf",t.submitted&&!e.valid),_n(1),jr("ngClass",ka(53,QT,t.submitted&&!i.valid)),_n(2),fo(Oa(17,29,"profile.lbl.lastName")),_n(2),jr("ngModel",s.user.profile.lastName),_n(2),jr("ngIf",t.submitted&&!i.valid),_n(1),jr("ngClass",ka(55,QT,t.submitted&&!n.valid)),_n(2),fo(Oa(24,31,"profile.lbl.company")),_n(2),jr("ngModel",s.user.profile.company),_n(2),jr("ngIf",t.submitted&&!n.valid),_n(3),fo(Oa(31,33,"profile.lbl.phone")),_n(2),jr("ngModel",s.user.profile.phone),_n(4),fo(Oa(37,35,"profile.btn.save")),_n(2),jr("ngIf",s.loading),_n(1),jr("routerLink",Pa(57,WT)),_n(1),fo(Oa(41,37,"profile.btn.cancel")),_n(3),vo(" ",Oa(44,39,"profile.btn.changePW")," "),_n(3),bo(" ",Oa(47,41,"profile.msg.lastLogin")," ",Ea(48,43,s.user.status.lastLoginAt,"dd.MM.yyyy HH:mm:ss")," "),_n(4),bo(" ",Oa(51,46,"profile.msg.lastFailedLogin")," ",Ea(52,48,s.user.status.lastLoginFailedAt,"dd.MM.yyyy HH:mm:ss")," ")}}function YT(t,e){1&t&&(Nr(0,"div",25),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"profile.msg.oldPWRequired")))}function ZT(t,e){1&t&&(Nr(0,"div",48),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"profile.msg.followPolicy")))}function XT(t,e){if(1&t&&(Nr(0,"div",48),mo(1),Fr()),2&t){const t=Xr(2);_n(1),fo(t.PWPolicyDescription)}}function t_(t,e){1&t&&(Nr(0,"button",49),mo(1),Ua(2,"translate"),Fr()),2&t&&(_n(1),fo(Oa(2,1,"profile.btn.change")))}function e_(t,e){if(1&t){const t=zr();Nr(0,"button",50),Jr("click",(function(){return ei(t),Xr(2).passwordChange()})),mo(1),Ua(2,"translate"),Fr()}2&t&&(_n(1),fo(Oa(2,1,"profile.btn.change")))}function i_(t,e){if(1&t){const t=zr();Nr(0,"div",27),Nr(1,"div",28),Nr(2,"div",29),Nr(3,"div",30),Nr(4,"h5",31),mo(5),Ua(6,"translate"),Fr(),Nr(7,"button",32),Nr(8,"span",33),mo(9,"\xd7"),Fr(),Fr(),Fr(),Nr(10,"div",34),Nr(11,"form",35,36),Nr(13,"div",6),Nr(14,"label",37),mo(15),Ua(16,"translate"),Fr(),Nr(17,"input",38,39),Jr("ngModelChange",(function(e){return ei(t),Xr().oldpw=e})),Fr(),Lr(19,YT,3,3,"div",10),Fr(),Nr(20,"div",6),Nr(21,"label",40),Ua(22,"translate"),mo(23),Ua(24,"translate"),Fr(),Nr(25,"input",41,42),Jr("ngModelChange",(function(e){return ei(t),Xr().newpw=e})),Fr(),Lr(27,ZT,3,3,"div",43),Lr(28,XT,2,1,"div",43),Fr(),Nr(29,"div",44),Nr(30,"button",45),mo(31),Ua(32,"translate"),Fr(),Lr(33,t_,3,3,"button",46),Lr(34,e_,3,3,"button",47),Fr(),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Gr(12),e=Gr(18),i=Gr(26),n=Xr();_n(5),fo(Oa(6,16,"profile.titleChangePW")),_n(8),jr("ngClass",ka(26,QT,t.submitted&&!e.valid)),_n(2),vo("",Oa(16,18,"profile.lbl.oldPassword"),"(*):"),_n(2),jr("ngModel",n.oldpw),_n(2),jr("ngIf",t.submitted&&!e.valid),_n(1),jr("ngClass",ka(28,QT,t.submitted&&!i.valid)),_n(1),io("title","",Oa(22,20,"profile.lbl.PWRule"),": ",n.PWPolicyDescription,""),_n(2),vo(" ",Oa(24,22,"profile.lbl.newPassword"),"(*): "),_n(2),to("pattern",n.PWPolicy),jr("ngModel",n.newpw),_n(2),jr("ngIf",!i.valid),_n(1),jr("ngIf",!i.valid),_n(3),fo(Oa(32,24,"profile.btn.cancel")),_n(2),jr("ngIf",!t.form.valid),_n(1),jr("ngIf",t.form.valid)}}let n_=(()=>{class t{constructor(t,e,i,n,s,r,o,a){this.userService=t,this.messageService=e,this.alertService=i,this.route=n,this.authenticationService=s,this.router=r,this.translate=o,this.titleService=a,this.loading=!1}ngOnInit(){this.currentLang=this.translate.currentLang,this.titleService.setTitle(this.translate.instant("profile.titleShort")),this.getPWPolicy(),this.log("Start init User Get Profile"),this.getUserProfile()}getUserProfile(){this.log("User Get Profile"),this.userService.getUserProfile().subscribe(t=>{this.user=t,this.user.profile||(this.user.profile=new Jh),this.log("get User Profile success "+t.email)},t=>{this.log(`get User profile failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}saveUserProfile(){this.loading=!0,this.log("Save profile info now "+this.user.email),this.userService.updateUserProfile(this.user).subscribe(t=>{this.log("Save profile success updatedAt "+t.updatedAt),this.user=t;const e=this.translate.instant("profile.msg.updateSuccess");this.alertService.success(e,!0),this.loading=!1},t=>{if(this.log(`update User profile failed: error: ${t.status} message: ${t.error.message} `),403===t.status){const t=this.translate.instant("profile.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Gh(t));this.loading=!1})}passwordInit(){this.changePW=!0,this.oldpw="",this.newpw=""}passwordChange(){this.log(`Password Change ${this.user.email} Len Old ${this.oldpw.length} New ${this.newpw.length}`),this.changePW=!1,this.userService.passwordChange(this.oldpw,this.newpw).subscribe(t=>{this.log("Change Password success updatedAt "+t.updatedAt),this.user=t;const e=this.translate.instant("profile.msg.changePWSuccess");this.alertService.success(e,!0)},t=>{if(this.log(`change password failed: error: ${t.status} message: ${t.error.message} `),403===t.status){const t=this.translate.instant("profile.msg.errorPerm");this.alertService.error(t)}else this.alertService.error(Gh(t))})}userReset(){this.getUserProfile()}getPWPolicy(){this.authenticationService.initPWPolicy().subscribe(t=>{this.log("Init PW Policy success "+JSON.stringify(t)),this.PWPolicy=t.PWPolicy,this.PWPolicyDescription=t.Description},t=>{this.log(`Init PW Policy Failed: ${t.status} ${t.error.message} `),this.alertService.error(Gh(t))})}log(t){this.messageService.add("UserProfile: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(BT),Rr(jh),Rr(Mf),Rr(Bg),Rr(op),Rr(rf),Rr(av),Rr(Md))},t.\u0275cmp=le({type:t,selectors:[["app-userprofile"]],decls:3,vars:2,consts:[["class","col-md-8 col-md-offset-2",4,"ngIf"],["class","modal fade","id","UserModalChangePassword","tabindex","-1","role","dialog","aria-labelledby","UserPasswordChangeModalTitle","aria-hidden","true",4,"ngIf"],[1,"col-md-8","col-md-offset-2"],["id","profileTitle"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group",3,"ngClass"],["for","firstName"],["id","profileFirstName","type","text","name","firstName","required","",1,"form-control",3,"ngModel","ngModelChange"],["firstName","ngModel"],["class","help-block",4,"ngIf"],["for","lastName"],["id","profileLastName","type","text","name","lastName","required","",1,"form-control",3,"ngModel","ngModelChange"],["lastName","ngModel"],["for","company"],["id","profileCompany","type","text","name","company","required","",1,"form-control",3,"ngModel","ngModelChange"],["company","ngModel"],[1,"form-group"],["for","phone"],["id","profilePhone","type","text","name","phone",1,"form-control",3,"ngModel","ngModelChange"],["phone","ngModel"],["id","ButtonSave",1,"btn","btn-primary"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==",4,"ngIf"],["id","ButtonBack",1,"btn","btn-link",3,"routerLink"],["id","ButtonChangePW","type","button","data-toggle","modal","data-target","#UserModalChangePassword",1,"btn","btn-secondary",2,"float","right",3,"click"],[1,"help-block"],["src","data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="],["id","UserModalChangePassword","tabindex","-1","role","dialog","aria-labelledby","UserPasswordChangeModalTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","UserPasswordChangeModalTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["name","passwordChange","novalidate",""],["fpw","ngForm"],["for","oldpassword",1,"col-form-label"],["id","passwordOld","type","password","name","oldpassword","required","","autocomplete","password",1,"form-control",3,"ngModel","ngModelChange"],["oldpassword","ngModel"],["for","newpassword","data-toggle","tooltip","data-placement","top","data-delay","50",1,"col-form-label",3,"title"],["id","passwordNew","type","password","name","newpassword","required","","autocomplete","off",1,"form-control",3,"ngModel","pattern","ngModelChange"],["newpassword","ngModel"],["id","passwordPolicy","class","help-block",4,"ngIf"],[1,"modal-footer","align-items-end"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-secondary"],["id","ButtonChange","type","submit","class","btn btn-primary",4,"ngIf"],["id","ButtonChange","type","submit","class","btn btn-primary","data-dismiss","modal",3,"click",4,"ngIf"],["id","passwordPolicy",1,"help-block"],["id","ButtonChange","type","submit",1,"btn","btn-primary"],["id","ButtonChange","type","submit","data-dismiss","modal",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(Br(0,"app-usernavbar"),Lr(1,JT,53,58,"div",0),Lr(2,i_,35,30,"div",1)),2&t&&(_n(1),jr("ngIf",e.user),_n(1),jr("ngIf",1==e.changePW))},directives:[Pb,jc,Eu,Fd,Tu,Ec,Ed,Ru,Nd,Ou,of,Hu],pipes:[lv,qc],encapsulation:2}),t})();function s_(t,e){if(1&t){const t=zr();Nr(0,"button",36),Jr("click",(function(){return ei(t),Xr(2).toggleUserGroup()})),mo(1,"Show Groups"),Fr()}}function r_(t,e){if(1&t){const t=zr();Nr(0,"button",37),Jr("click",(function(){return ei(t),Xr(2).toggleUserGroup()})),mo(1,"Show Users"),Fr()}}function o_(t,e){1&t&&(Nr(0,"div",39),Nr(1,"button",48),mo(2,"Add User"),Fr(),Fr())}function a_(t,e){1&t&&(Nr(0,"th"),mo(1,"Delete"),Fr())}function l_(t,e){if(1&t){const t=zr();Nr(0,"td"),Nr(1,"button",51),Jr("click",(function(){ei(t);const e=Xr().index;return Xr(3).helperUserIndex(e)})),mo(2,"\xd7"),Fr(),Fr()}}function c_(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td"),mo(2),Fr(),Nr(3,"td",49),Jr("click",(function(){ei(t);const i=e.index;return Xr(3).calcCombinedPerm(i)})),Nr(4,"a"),mo(5),Fr(),Fr(),Nr(6,"td",50),Jr("click",(function(){return ei(t),Xr(3).toggleUserGroup()})),Nr(7,"a"),mo(8),Fr(),Fr(),Lr(9,l_,3,0,"td",0),Fr()}if(2&t){const t=e.$implicit,i=e.index,n=Xr(3);_n(2),fo(i+1),_n(3),fo(t.email),_n(3),fo(t.groupName),_n(1),jr("ngIf",n.hasSystemPerm(n.permSystem.ManagePerm))}}function d_(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div"),Nr(2,"div",38),Nr(3,"div",39),Nr(4,"h5",40),mo(5," Visbo System Users "),Fr(),Fr(),Lr(6,o_,3,0,"div",41),Fr(),Nr(7,"div",42),Nr(8,"table",43),Nr(9,"thead",44),Nr(10,"tr"),Nr(11,"th"),mo(12,"Nr."),Fr(),Nr(13,"th",45),Jr("click",(function(){return ei(t),Xr(2).sortUserTable(1)})),mo(14,"e-mail"),Fr(),Nr(15,"th",46),Jr("click",(function(){return ei(t),Xr(2).sortUserTable(2)})),mo(16,"Group"),Fr(),Lr(17,a_,2,0,"th",0),Fr(),Fr(),Nr(18,"tbody",47),Lr(19,c_,10,4,"tr",22),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(6),jr("ngIf",t.hasSystemPerm(t.permSystem.ManagePerm)),_n(11),jr("ngIf",t.hasSystemPerm(t.permSystem.ManagePerm)),_n(2),jr("ngForOf",t.vgUsers)}}function u_(t,e){if(1&t){const t=zr();Nr(0,"div",39),Nr(1,"button",55),Jr("click",(function(){return ei(t),Xr(3).initGroup(null)})),mo(2,"Add Group"),Fr(),Fr()}}function h_(t,e){1&t&&(Nr(0,"th"),mo(1,"Delete"),Fr())}function p_(t,e){1&t&&(Nr(0,"td",60),mo(1,"Global"),Fr())}function g_(t,e){1&t&&Br(0,"td",60)}function m_(t,e){if(1&t){const t=zr();Nr(0,"td"),Nr(1,"button",61),Jr("click",(function(){ei(t);const e=Xr().index;return Xr(3).helperRemoveGroup(e)})),mo(2,"\xd7"),Fr(),Fr()}}function f_(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td"),mo(2),Fr(),Nr(3,"td",56),Jr("click",(function(){ei(t);const i=e.index,n=e.$implicit,s=Xr(3);return s.groupIndex=i,s.initGroup(n)})),Nr(4,"a"),mo(5),Fr(),Fr(),Nr(6,"td",57),Jr("click",(function(){return ei(t),Xr(3).toggleUserGroup()})),Nr(7,"a"),mo(8),Fr(),Fr(),Lr(9,p_,2,0,"td",58),Lr(10,g_,1,0,"td",58),Lr(11,m_,3,0,"td",0),Nr(12,"td"),Nr(13,"button",59),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(3).initGroup(i)})),mo(14,"i"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit,i=e.index,n=Xr(3);_n(2),fo(i+1),_n(3),fo(t.name),_n(3),fo(t.users.length),_n(1),jr("ngIf",t.global),_n(1),jr("ngIf",!t.global),_n(1),jr("ngIf",n.hasSystemPerm(n.permSystem.ManagePerm))}}function v_(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div"),Nr(2,"div",38),Nr(3,"div",39),Nr(4,"h5",40),mo(5," Visbo System Groups "),Fr(),Fr(),Lr(6,u_,3,0,"div",41),Fr(),Nr(7,"div",42),Nr(8,"table",43),Nr(9,"thead",52),Nr(10,"tr"),Nr(11,"th"),mo(12,"Nr."),Fr(),Nr(13,"th",53),Jr("click",(function(){return ei(t),Xr(2).sortGroupTable(1)})),mo(14,"Group"),Fr(),Nr(15,"th",53),Jr("click",(function(){return ei(t),Xr(2).sortGroupTable(2)})),mo(16,"Members"),Fr(),Nr(17,"th"),mo(18,"Flag"),Fr(),Lr(19,h_,2,0,"th",0),Nr(20,"th"),mo(21,"Info"),Fr(),Fr(),Fr(),Nr(22,"tbody",54),Lr(23,f_,15,6,"tr",22),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(6),jr("ngIf",t.hasSystemPerm(t.permSystem.ManagePerm)),_n(13),jr("ngIf",t.hasSystemPerm(t.permSystem.ManagePerm)),_n(4),jr("ngForOf",t.vgGroups)}}function b_(t,e){1&t&&(Nr(0,"div",62),mo(1,"E-mail address is required"),Fr())}function y_(t,e){if(1&t&&(Nr(0,"option"),mo(1),Fr()),2&t){const t=e.$implicit;_n(1),fo(t.name)}}function C_(t,e){1&t&&(Nr(0,"div",62),mo(1,"Group must be defined"),Fr())}function V_(t,e){1&t&&(Nr(0,"div",62),mo(1,"Error in Message"),Fr())}function w_(t,e){1&t&&(Nr(0,"button",63),mo(1,"Invite"),Fr())}function A_(t,e){if(1&t){const t=zr();Nr(0,"button",64),Jr("click",(function(){return ei(t),Xr(2).addNewVCUser()})),mo(1,"Invite"),Fr()}}function P_(t,e){if(1&t){const t=zr();Nr(0,"div",5),Nr(1,"div",6),Nr(2,"div",7),Nr(3,"h5",65),mo(4,"Remove User from Visbo System"),Fr(),Nr(5,"button",9),Nr(6,"span",10),mo(7,"\xd7"),Fr(),Fr(),Fr(),Nr(8,"div",11),Nr(9,"div"),Nr(10,"label",66),mo(11,"Do you really want to remove this User from Visbo System? "),Fr(),Fr(),Nr(12,"form"),Nr(13,"div",67),Nr(14,"label",68),mo(15,"Visbo Center:"),Fr(),Nr(16,"label",69),mo(17),Fr(),Fr(),Nr(18,"div",67),Nr(19,"label",70),mo(20,"User:"),Fr(),Nr(21,"label",69),mo(22),Fr(),Fr(),Nr(23,"div",67),Nr(24,"label",70),mo(25,"Group:"),Fr(),Nr(26,"label",69),mo(27),Fr(),Fr(),Fr(),Fr(),Nr(28,"div",26),Nr(29,"button",71),mo(30,"Close"),Fr(),Nr(31,"button",72),Jr("click",(function(){ei(t);const e=Xr(2);return e.removeVCUser(e.vgUsers[e.userIndex],e.visbocenter._id)})),mo(32,"Remove"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(17),vo("",t.visbocenter.name," "),_n(5),fo(t.vgUsers[t.userIndex].email),_n(5),fo(t.vgUsers[t.userIndex].groupName)}}function k_(t,e){1&t&&(Nr(0,"h5",108),mo(1,"Modify a Group in the Visbo System"),Fr())}function D_(t,e){1&t&&(Nr(0,"h5",108),mo(1,"Add a new Group to the Visbo System"),Fr())}function M_(t,e){1&t&&(Nr(0,"div",62),mo(1,"Group Name is required (Minimum 3)"),Fr())}function I_(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div"),mo(2,"Define Visbo Center Permission"),Fr(),Nr(3,"div",79),Nr(4,"input",109,110),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedView=e})),Fr(),Nr(6,"label",111),mo(7,"View Visbo Center"),Fr(),Fr(),Nr(8,"div",79),Nr(9,"input",112,113),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedViewAudit=e})),Fr(),Nr(11,"label",114),mo(12,"View Audit"),Fr(),Fr(),Nr(13,"div",79),Nr(14,"input",115,116),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedModify=e})),Fr(),Nr(16,"label",117),mo(17,"Modify Visbo Center"),Fr(),Fr(),Nr(18,"div",79),Nr(19,"input",118,119),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedCreateVP=e})),Fr(),Nr(21,"label",120),mo(22,"Create Visbo Project"),Fr(),Fr(),Nr(23,"div",79),Nr(24,"input",121,122),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedManagePerm=e})),Fr(),Nr(26,"label",123),mo(27,"Manage Permissions, Users and Groups"),Fr(),Fr(),Nr(28,"div"),mo(29,"Define Visbo Project Permission"),Fr(),Nr(30,"div",79),Nr(31,"input",124,125),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedVPView=e})),Fr(),Nr(33,"label",126),mo(34,"View Visbo Project"),Fr(),Fr(),Nr(35,"div",79),Nr(36,"input",127,128),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedVPViewAudit=e})),Fr(),Nr(38,"label",129),mo(39,"View Project Audit"),Fr(),Fr(),Nr(40,"div",79),Nr(41,"input",130,131),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedVPModify=e})),Fr(),Nr(43,"label",132),mo(44,"Modify Visbo Project"),Fr(),Fr(),Nr(45,"div",79),Nr(46,"input",133,134),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedCreateVariant=e})),Fr(),Nr(48,"label",135),mo(49,"Create Visbo Project Variant"),Fr(),Fr(),Nr(50,"div",79),Nr(51,"input",136,137),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedVPManagePerm=e})),Fr(),Nr(53,"label",138),mo(54,"Manage Permissions, Users and Groups"),Fr(),Fr(),Nr(55,"div",79),Nr(56,"input",139,140),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedVPDelete=e})),Fr(),Nr(58,"label",141),mo(59,"Delete Visbo Project"),Fr(),Fr(),Fr()}if(2&t){const t=Xr(3);_n(4),jr("ngModel",t.actGroup.checkedView),_n(5),jr("ngModel",t.actGroup.checkedViewAudit),_n(5),jr("ngModel",t.actGroup.checkedModify),_n(5),jr("ngModel",t.actGroup.checkedCreateVP),_n(5),jr("ngModel",t.actGroup.checkedManagePerm),_n(7),jr("ngModel",t.actGroup.checkedVPView),_n(5),jr("ngModel",t.actGroup.checkedVPViewAudit),_n(5),jr("ngModel",t.actGroup.checkedVPModify),_n(5),jr("ngModel",t.actGroup.checkedCreateVariant),_n(5),jr("ngModel",t.actGroup.checkedVPManagePerm),_n(5),jr("ngModel",t.actGroup.checkedVPDelete)}}function S_(t,e){if(1&t){const t=zr();Nr(0,"div",146),Nr(1,"a",147),Jr("click",(function(){ei(t);const e=Xr().$implicit;return Xr(4).activateUser(e)})),mo(2),Fr(),Fr()}if(2&t){const t=Xr().$implicit;_n(2),fo(t.email)}}function x_(t,e){if(1&t&&(Hr(0,38),Lr(1,S_,3,1,"div",145),Kr()),2&t){const t=e.$implicit,i=Xr(4);_n(1),jr("ngIf",t.groupName==i.actGroup.name)}}function T_(t,e){if(1&t&&(Nr(0,"div",142),Nr(1,"label",143),mo(2,"Group Members"),Fr(),Lr(3,x_,2,1,"ng-container",144),Fr()),2&t){const t=Xr(3);_n(3),jr("ngForOf",t.vgUsers)}}function __(t,e){1&t&&(Nr(0,"div",142),Nr(1,"label",143),mo(2,"No Group Members"),Fr(),Fr())}function U_(t,e){if(1&t&&(Nr(0,"button",148),mo(1),Fr()),2&t){const t=Xr(3);_n(1),fo(t.confirm)}}function O_(t,e){if(1&t){const t=zr();Nr(0,"button",149),Jr("click",(function(){return ei(t),Xr(3).addModifyVCGroup()})),mo(1),Fr()}if(2&t){const t=Xr(3);_n(1),fo(t.confirm)}}const E_=function(t){return{"has-error":t}};function L_(t,e){if(1&t){const t=zr();Nr(0,"div",6),Nr(1,"div",7),Lr(2,k_,2,0,"h5",73),Lr(3,D_,2,0,"h5",73),Nr(4,"button",9),Nr(5,"span",10),mo(6,"\xd7"),Fr(),Fr(),Fr(),Nr(7,"div",11),Nr(8,"form",74,75),Nr(10,"div",14),Nr(11,"label",76),mo(12,"Name:"),Fr(),Nr(13,"input",77,78),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.name=e})),Fr(),Lr(15,M_,2,0,"div",18),Fr(),Nr(16,"div"),mo(17,"Define System Permission"),Fr(),Nr(18,"div",79),Nr(19,"input",80,81),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedSystemView=e})),Fr(),Nr(21,"label",82),mo(22,"View Visbo Center"),Fr(),Fr(),Nr(23,"div",79),Nr(24,"input",83,84),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedSystemViewAudit=e})),Fr(),Nr(26,"label",85),mo(27,"View Audit"),Fr(),Fr(),Nr(28,"div",79),Nr(29,"input",86,87),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedSystemViewLog=e})),Fr(),Nr(31,"label",88),mo(32,"View Log Files"),Fr(),Fr(),Nr(33,"div",79),Nr(34,"input",89,90),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedSystemModify=e})),Fr(),Nr(36,"label",91),mo(37,"Modify System"),Fr(),Fr(),Nr(38,"div",79),Nr(39,"input",92,93),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedSystemCreateVC=e})),Fr(),Nr(41,"label",94),mo(42,"Create Visbo Center"),Fr(),Fr(),Nr(43,"div",79),Nr(44,"input",95,96),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedSystemDeleteVC=e})),Fr(),Nr(46,"label",97),mo(47,"Delete Visbo Center"),Fr(),Fr(),Nr(48,"div",79),Nr(49,"input",98,99),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedSystemManagePerm=e})),Fr(),Nr(51,"label",100),mo(52,"Manage Permissions, Users and Groups"),Fr(),Fr(),Br(53,"br"),Nr(54,"div",79),Nr(55,"input",101,102),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.global=e})),Fr(),Nr(57,"label",103),mo(58,"Group has Access to all Visbo Centers / Projects"),Fr(),Fr(),Lr(59,I_,60,11,"div",0),Lr(60,T_,4,1,"div",104),Lr(61,__,3,0,"div",104),Nr(62,"div",105),Lr(63,U_,2,1,"button",106),Lr(64,O_,2,1,"button",107),Nr(65,"button",27),mo(66,"Cancel"),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Gr(9),e=Gr(14),i=Xr(2);_n(2),jr("ngIf",i.actGroup._id),_n(1),jr("ngIf",!i.actGroup._id),_n(7),jr("ngClass",ka(18,E_,t.submitted)),_n(3),jr("ngModel",i.actGroup.name),_n(2),jr("ngIf",e.errors&&(e.dirty||e.touched)),_n(4),jr("ngModel",i.actGroup.checkedSystemView),_n(5),jr("ngModel",i.actGroup.checkedSystemViewAudit),_n(5),jr("ngModel",i.actGroup.checkedSystemViewLog),_n(5),jr("ngModel",i.actGroup.checkedSystemModify),_n(5),jr("ngModel",i.actGroup.checkedSystemCreateVC),_n(5),jr("ngModel",i.actGroup.checkedSystemDeleteVC),_n(5),jr("ngModel",i.actGroup.checkedSystemManagePerm),_n(6),jr("ngModel",i.actGroup.global),_n(4),jr("ngIf",i.actGroup.global),_n(1),jr("ngIf",i.helperUsersPerGroup(i.actGroup.name)),_n(1),jr("ngIf",!i.helperUsersPerGroup(i.actGroup.name)),_n(2),jr("ngIf",!(t.form.valid&&i.hasSystemPerm(i.permSystem.ManagePerm))),_n(1),jr("ngIf",t.form.valid&&i.hasSystemPerm(i.permSystem.ManagePerm))}}function G_(t,e){if(1&t){const t=zr();Nr(0,"div",5),Nr(1,"div",6),Nr(2,"div",7),Nr(3,"h5",65),mo(4,"Remove Group from Visbo System"),Fr(),Nr(5,"button",9),Nr(6,"span",10),mo(7,"\xd7"),Fr(),Fr(),Fr(),Nr(8,"div",11),Nr(9,"div"),Nr(10,"label",66),mo(11,"Do you really want to remove this Group from Visbo System? "),Fr(),Fr(),Nr(12,"form"),Nr(13,"div",67),Nr(14,"label",68),mo(15,"Visbo Center:"),Fr(),Nr(16,"label",69),mo(17),Fr(),Fr(),Nr(18,"div",67),Nr(19,"label",70),mo(20,"Group:"),Fr(),Nr(21,"label",69),mo(22),Fr(),Fr(),Nr(23,"div",67),Nr(24,"label",70),mo(25,"Members:"),Fr(),Nr(26,"label",69),mo(27),Fr(),Fr(),Fr(),Fr(),Nr(28,"div",26),Nr(29,"button",27),mo(30,"Close"),Fr(),Nr(31,"button",150),Jr("click",(function(){ei(t);const e=Xr(2);return e.removeVCGroup(e.vgGroups[e.groupIndex])})),mo(32,"Remove"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(17),vo("",t.visbocenter.name," "),_n(5),fo(t.vgGroups[t.groupIndex].name),_n(5),fo(t.vgGroups[t.groupIndex].users.length)}}function R_(t,e){1&t&&Br(0,"input",182)}function j_(t,e){1&t&&Br(0,"input",183)}function $_(t,e){1&t&&Br(0,"input",182)}function N_(t,e){1&t&&Br(0,"input",183)}function F_(t,e){1&t&&Br(0,"input",182)}function B_(t,e){1&t&&Br(0,"input",183)}function H_(t,e){1&t&&Br(0,"input",182)}function K_(t,e){1&t&&Br(0,"input",183)}function q_(t,e){1&t&&Br(0,"input",182)}function z_(t,e){1&t&&Br(0,"input",183)}function Q_(t,e){1&t&&Br(0,"input",182)}function W_(t,e){1&t&&Br(0,"input",183)}function J_(t,e){1&t&&Br(0,"input",182)}function Y_(t,e){1&t&&Br(0,"input",183)}function Z_(t,e){1&t&&Br(0,"input",184)}function X_(t,e){1&t&&Br(0,"input",185)}function tU(t,e){1&t&&Br(0,"input",186)}function eU(t,e){1&t&&Br(0,"input",187)}function iU(t,e){1&t&&Br(0,"input",188)}function nU(t,e){1&t&&Br(0,"input",189)}function sU(t,e){1&t&&Br(0,"input",190)}function rU(t,e){1&t&&Br(0,"input",191)}function oU(t,e){1&t&&Br(0,"input",192)}function aU(t,e){1&t&&Br(0,"input",193)}function lU(t,e){1&t&&Br(0,"input",194)}function cU(t,e){1&t&&Br(0,"input",195)}function dU(t,e){1&t&&Br(0,"input",196)}function uU(t,e){1&t&&Br(0,"input",197)}function hU(t,e){1&t&&Br(0,"input",198)}function pU(t,e){1&t&&Br(0,"input",199)}function gU(t,e){1&t&&Br(0,"input",200)}function mU(t,e){1&t&&Br(0,"input",201)}function fU(t,e){1&t&&Br(0,"input",202)}function vU(t,e){1&t&&Br(0,"input",203)}function bU(t,e){1&t&&Br(0,"input",204)}function yU(t,e){1&t&&Br(0,"input",205)}function CU(t,e){if(1&t){const t=zr();Nr(0,"div",146),Nr(1,"a",206),Jr("click",(function(){ei(t);const e=Xr().$implicit;return Xr(3).activateGroup(e)})),mo(2),Fr(),Fr()}if(2&t){const t=Xr().$implicit;_n(2),fo(t.groupName)}}function VU(t,e){if(1&t&&(Hr(0,38),Lr(1,CU,3,1,"div",145),Kr()),2&t){const t=e.$implicit,i=Xr(3);_n(1),jr("ngIf",t.email==i.vgUsers[i.userIndex].email)}}function wU(t,e){if(1&t&&(Nr(0,"div",151),Nr(1,"div",152),Nr(2,"div",6),Nr(3,"div",7),Nr(4,"h5",153),mo(5),Fr(),Nr(6,"button",9),Nr(7,"span",10),mo(8,"\xd7"),Fr(),Fr(),Fr(),Nr(9,"div",11),Nr(10,"div"),mo(11,"Define System Permission"),Fr(),Nr(12,"div",79),Lr(13,R_,1,0,"input",154),Lr(14,j_,1,0,"input",155),Nr(15,"label",156),mo(16,"View Visbo Center"),Fr(),Fr(),Nr(17,"div",79),Lr(18,$_,1,0,"input",154),Lr(19,N_,1,0,"input",155),Nr(20,"label",156),mo(21,"View Audit"),Fr(),Fr(),Nr(22,"div",79),Lr(23,F_,1,0,"input",154),Lr(24,B_,1,0,"input",155),Nr(25,"label",156),mo(26,"View Log Files"),Fr(),Fr(),Nr(27,"div",79),Lr(28,H_,1,0,"input",154),Lr(29,K_,1,0,"input",155),Nr(30,"label",156),mo(31,"Modify System"),Fr(),Fr(),Nr(32,"div",79),Lr(33,q_,1,0,"input",154),Lr(34,z_,1,0,"input",155),Nr(35,"label",156),mo(36,"Create Visbo Center"),Fr(),Fr(),Nr(37,"div",79),Lr(38,Q_,1,0,"input",154),Lr(39,W_,1,0,"input",155),Nr(40,"label",156),mo(41,"Delete Visbo Center"),Fr(),Fr(),Nr(42,"div",79),Lr(43,J_,1,0,"input",154),Lr(44,Y_,1,0,"input",155),Nr(45,"label",156),mo(46,"Manage Permissions, Users and Groups"),Fr(),Fr(),Br(47,"br"),Nr(48,"div",142),mo(49,"Visbo Center Permission for User"),Fr(),Nr(50,"div",79),Lr(51,Z_,1,0,"input",157),Lr(52,X_,1,0,"input",158),Nr(53,"label",111),mo(54,"View Visbo Center"),Fr(),Fr(),Nr(55,"div",79),Lr(56,tU,1,0,"input",159),Lr(57,eU,1,0,"input",160),Nr(58,"label",114),mo(59,"View Audit"),Fr(),Fr(),Nr(60,"div",79),Lr(61,iU,1,0,"input",161),Lr(62,nU,1,0,"input",162),Nr(63,"label",117),mo(64,"Modify Visbo Center"),Fr(),Fr(),Nr(65,"div",79),Lr(66,sU,1,0,"input",163),Lr(67,rU,1,0,"input",164),Nr(68,"label",120),mo(69,"Create Visbo Project"),Fr(),Fr(),Nr(70,"div",79),Lr(71,oU,1,0,"input",165),Lr(72,aU,1,0,"input",166),Nr(73,"label",123),mo(74,"Manage Permissions, Users and Groups"),Fr(),Fr(),Br(75,"br"),Nr(76,"div"),mo(77,"Visbo Project Permission for User"),Fr(),Nr(78,"div",79),Lr(79,lU,1,0,"input",167),Lr(80,cU,1,0,"input",168),Nr(81,"label",126),mo(82,"View Visbo Project"),Fr(),Fr(),Nr(83,"div",79),Lr(84,dU,1,0,"input",169),Lr(85,uU,1,0,"input",170),Nr(86,"label",129),mo(87,"View Project Audit"),Fr(),Fr(),Nr(88,"div",79),Lr(89,hU,1,0,"input",171),Lr(90,pU,1,0,"input",172),Nr(91,"label",132),mo(92,"Modify Visbo Project"),Fr(),Fr(),Nr(93,"div",79),Lr(94,gU,1,0,"input",173),Lr(95,mU,1,0,"input",174),Nr(96,"label",135),mo(97,"Create Visbo Project Variant"),Fr(),Fr(),Nr(98,"div",79),Lr(99,fU,1,0,"input",175),Lr(100,vU,1,0,"input",176),Nr(101,"label",138),mo(102,"Manage Permissions, Users and Groups"),Fr(),Fr(),Nr(103,"div",79),Lr(104,bU,1,0,"input",177),Lr(105,yU,1,0,"input",178),Nr(106,"label",141),mo(107,"Delete Visbo Project"),Fr(),Fr(),Nr(108,"label",179),mo(109,"Group Member Ship"),Fr(),Lr(110,VU,2,1,"ng-container",144),Nr(111,"div",180),Nr(112,"button",181),mo(113,"Close"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr(2);_n(5),vo("Permission for ",t.vgUsers[t.userIndex].email,""),_n(8),jr("ngIf",t.hasUserSystemPerm(t.permSystem.View)),_n(1),jr("ngIf",!t.hasUserSystemPerm(t.permSystem.View)),_n(4),jr("ngIf",t.hasUserSystemPerm(t.permSystem.ViewAudit)),_n(1),jr("ngIf",!t.hasUserSystemPerm(t.permSystem.ViewAudit)),_n(4),jr("ngIf",t.hasUserSystemPerm(t.permSystem.ViewLog)),_n(1),jr("ngIf",!t.hasUserSystemPerm(t.permSystem.ViewLog)),_n(4),jr("ngIf",t.hasUserSystemPerm(t.permSystem.Modify)),_n(1),jr("ngIf",!t.hasUserSystemPerm(t.permSystem.Modify)),_n(4),jr("ngIf",t.hasUserSystemPerm(t.permSystem.CreateVC)),_n(1),jr("ngIf",!t.hasUserSystemPerm(t.permSystem.CreateVC)),_n(4),jr("ngIf",t.hasUserSystemPerm(t.permSystem.DeleteVC)),_n(1),jr("ngIf",!t.hasUserSystemPerm(t.permSystem.DeleteVC)),_n(4),jr("ngIf",t.hasUserSystemPerm(t.permSystem.ManagePerm)),_n(1),jr("ngIf",!t.hasUserSystemPerm(t.permSystem.ManagePerm)),_n(7),jr("ngIf",t.hasUserVCPerm(t.permVC.View)),_n(1),jr("ngIf",!t.hasUserVCPerm(t.permVC.View)),_n(4),jr("ngIf",t.hasUserVCPerm(t.permVC.ViewAudit)),_n(1),jr("ngIf",!t.hasUserVCPerm(t.permVC.ViewAudit)),_n(4),jr("ngIf",t.hasUserVCPerm(t.permVC.Modify)),_n(1),jr("ngIf",!t.hasUserVCPerm(t.permVC.Modify)),_n(4),jr("ngIf",t.hasUserVCPerm(t.permVC.CreateVP)),_n(1),jr("ngIf",!t.hasUserVCPerm(t.permVC.CreateVP)),_n(4),jr("ngIf",t.hasUserVCPerm(t.permVC.ManagePerm)),_n(1),jr("ngIf",!t.hasUserVCPerm(t.permVC.ManagePerm)),_n(7),jr("ngIf",t.hasUserVPPerm(t.permVP.View)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.View)),_n(4),jr("ngIf",t.hasUserVPPerm(t.permVP.ViewAudit)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.ViewAudit)),_n(4),jr("ngIf",t.hasUserVPPerm(t.permVP.Modify)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.Modify)),_n(4),jr("ngIf",t.hasUserVPPerm(t.permVP.CreateVariant)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.CreateVariant)),_n(4),jr("ngIf",t.hasUserVPPerm(t.permVP.ManagePerm)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.ManagePerm)),_n(4),jr("ngIf",t.hasUserVPPerm(t.permVP.DeleteVP)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.DeleteVP)),_n(5),jr("ngForOf",t.vgUsers)}}function AU(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"h3"),mo(2),Ua(3,"uppercase"),Fr(),Nr(4,"div",1),Lr(5,s_,2,0,"button",2),Lr(6,r_,2,0,"button",3),Fr(),Lr(7,d_,20,3,"div",0),Lr(8,v_,24,3,"div",0),Nr(9,"div",4),Nr(10,"div",5),Nr(11,"div",6),Nr(12,"div",7),Nr(13,"h5",8),mo(14,"Add a new User to the Visbo System"),Fr(),Nr(15,"button",9),Nr(16,"span",10),mo(17,"\xd7"),Fr(),Fr(),Fr(),Nr(18,"div",11),Nr(19,"form",12,13),Nr(21,"div",14),Nr(22,"label",15),mo(23,"Name:"),Fr(),Nr(24,"input",16,17),Jr("ngModelChange",(function(e){return ei(t),Xr().newUserInvite.email=e})),Fr(),Lr(26,b_,2,0,"div",18),Fr(),Nr(27,"div",14),Nr(28,"label",19),mo(29,"Group:"),Fr(),Nr(30,"select",20,21),Jr("ngModelChange",(function(e){return ei(t),Xr().newUserInvite.groupName=e})),Br(32,"option"),Lr(33,y_,2,1,"option",22),Fr(),Lr(34,C_,2,0,"div",18),Fr(),Nr(35,"div",14),Nr(36,"label",23),mo(37,"Message:"),Fr(),Nr(38,"textarea",24,25),Jr("ngModelChange",(function(e){return ei(t),Xr().newUserInvite.inviteMessage=e})),mo(40," "),Fr(),Fr(),Lr(41,V_,2,0,"div",18),Nr(42,"div",26),Nr(43,"button",27),mo(44,"Cancel"),Fr(),Lr(45,w_,2,0,"button",28),Lr(46,A_,2,0,"button",29),Fr(),Fr(),Fr(),Fr(),Fr(),Fr(),Nr(47,"div",30),Lr(48,P_,33,3,"div",31),Fr(),Nr(49,"div",32),Nr(50,"div",5),Lr(51,L_,67,20,"div",33),Fr(),Fr(),Nr(52,"div",34),Lr(53,G_,33,3,"div",31),Fr(),Lr(54,wU,114,38,"div",35),Fr()}if(2&t){const t=Gr(20),e=Gr(25),i=Gr(31),n=Gr(39),s=Xr();_n(2),vo("System: ",Oa(3,21,s.visbocenter.name),""),_n(3),jr("ngIf",!s.showGroups),_n(1),jr("ngIf",s.showGroups),_n(1),jr("ngIf",!s.showGroups),_n(1),jr("ngIf",s.showGroups),_n(13),jr("ngClass",ka(23,E_,t.submitted&&!e.valid)),_n(3),jr("ngModel",s.newUserInvite.email),_n(2),jr("ngIf",t.submitted&&!e.valid),_n(1),jr("ngClass",ka(25,E_,t.submitted&&!i.valid)),_n(3),jr("ngModel",s.newUserInvite.groupName),_n(3),jr("ngForOf",s.vgGroups),_n(1),jr("ngIf",t.submitted&&!i.valid),_n(1),jr("ngClass",ka(27,E_,t.submitted&&!n.valid)),_n(3),jr("ngModel",s.newUserInvite.inviteMessage),_n(3),jr("ngIf",t.submitted&&!n.valid),_n(4),jr("ngIf",!(e.valid&&i.valid)),_n(1),jr("ngIf",e.valid&&i.valid),_n(2),jr("ngIf",s.userIndex>=0&&s.userIndex<s.vgUsers.length),_n(3),jr("ngIf",s.actGroup),_n(2),jr("ngIf",s.groupIndex>=0&&s.groupIndex<s.vgGroups.length),_n(1),jr("ngIf",s.vgUsers&&s.userIndex>=0)}}let PU=(()=>{class t{constructor(t,e,i,n,s,r){this.messageService=t,this.visbocenterService=e,this.route=i,this.location=n,this.router=s,this.alertService=r,this.newUserInvite=new Zh,this.permSystem=Mv,this.permVC=Iv,this.permVP=Sv,this.sortUserColumn=1,this.sortUserAscending=!0,this.sortGroupColumn=1,this.sortGroupAscending=!0}ngOnInit(){this.getSysVisboCenter(),this.combinedPerm=this.visbocenterService.getSysAdminRole()}getSysVisboCenter(){this.visbocenterService.getSysVisboCenter().subscribe(t=>{this.visbocenter=t[0],this.getVisboCenterUsers(),this.log(`System VisboCenter initialised ${this.visbocenter._id} Perm Sys ${JSON.stringify(this.combinedPerm)} `)},t=>{this.log(`get VC failed: error: ${t.status} message: ${t.error.message} `),this.alertService.error(403===t.status?"Permission Denied: Visbo Center "+this.visbocenter.name:Gh(t))})}hasSystemPerm(t){return(this.combinedPerm.system&t)>0}hasVCPerm(t){return(this.combinedPerm.vc&t)>0}hasVPPerm(t){return(this.combinedPerm.vp&t)>0}hasUserSystemPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.system&t)>0}hasUserVCPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vc&t)>0}hasUserVPPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vp&t)>0}getVisboCenterUsers(){const t=this.visbocenter._id;this.log("VisboCenter UserList of: "+t),this.visbocenterService.getVCUsers(t,!0).subscribe(t=>{this.vgUsers=t.users,this.vgGroups=t.groups,this.log(`fetched Users ${this.vgUsers.length}, Groups ${this.vgGroups.length}`),this.sortUserTable(),this.sortGroupTable()},t=>{this.log(`Get VC Users failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(403===t.status?"Permission Denied":Gh(t))})}gotoVPList(t){this.router.navigate(["sysvp/".concat(t._id)])}goBack(){this.location.back()}save(){this.visbocenterService.updateVisboCenter(this.visbocenter).subscribe(t=>{this.alertService.success(`Visbo Center ${t.name} updated successfully`,!0)},t=>{this.log(`save VC failed: error: ${t.status} message: ${t.error.message} `),this.alertService.error(403===t.status?"Permission Denied: Visbo Center "+this.visbocenter.name:409===t.status?`Visbo Center ${this.visbocenter.name} exists already`:Gh(t))})}toggleUserGroup(){this.showGroups=!this.showGroups}addNewVCUser(){const t=this.newUserInvite.email.trim(),e=this.newUserInvite.groupName.trim(),i=this.vgGroups.filter(t=>t.name===e)[0]._id,n=this.visbocenter._id;let s="";this.newUserInvite.inviteMessage&&(s=this.newUserInvite.inviteMessage.trim()),this.log(`Add VisboCenter User: ${t} Group: ${e}/${i} VC: ${n}`),t&&i&&this.visbocenterService.addVCUser(t,i,s,n,!0).subscribe(e=>{const i=new _v;i.userId=e.users.filter(e=>e.email===t)[0].userId,i.email=t,i.groupId=e._id,i.groupName=e.name,this.log("Add VisboCenter User Push: "+JSON.stringify(i)),this.vgUsers.push(i),this.sortUserTable();for(let t=0;t<this.vgGroups.length;t++)if(this.vgGroups[t]._id===e._id){this.vgGroups[t]=e;break}this.alertService.success(`User ${t} added successfully`)},t=>{this.log("Add VisboCenter User error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Add User to Visbo Center"):(this.log("Error during add VC user "+t.error.message),this.alertService.error(Gh(t)))})}helperUserIndex(t){this.userIndex=t}calcCombinedPerm(t){this.userIndex=t,this.combinedUserPerm={system:0,vc:0,vp:0},this.vgUsers.forEach(this.addUserPerm,this),this.log(`Combined Permission for ${this.vgUsers[t].email}  ${JSON.stringify(this.combinedUserPerm)}`)}addUserPerm(t){if(t.email!==this.vgUsers[this.userIndex].email)return;this.log("Add User Permission for "+t.groupName);const e=this.vgGroups.findIndex(e=>e.name===t.groupName);e>=0?this.vgGroups[e].permission?(this.combinedUserPerm.system=this.combinedUserPerm.system|(this.vgGroups[e].permission.system||0),this.combinedUserPerm.vc=this.combinedUserPerm.vc|(this.vgGroups[e].permission.vc||0),this.combinedUserPerm.vp=this.combinedUserPerm.vp|(this.vgGroups[e].permission.vp||0)):this.log("Permission for Group not set "+t.groupName):this.log("Group not found "+t.groupName)}helperRemoveGroup(t){this.groupIndex=t}helperUsersPerGroup(t){const e=this.vgGroups&&this.vgGroups.find(e=>e.name===t);return e?e.users.length:0}removeVCUser(t,e){this.log(`Remove VisboCenter User: ${t.email}/${t.userId} Group: ${t.groupName} VC: ${e}`),this.visbocenterService.deleteVCUser(t,e,!0).subscribe(()=>{this.vgUsers=this.vgUsers.filter(e=>e!==t);for(let e=0;e<this.vgGroups.length;e++)if(this.vgGroups[e]._id===t.groupId){for(let i=0;i<this.vgGroups[e].users.length;i++)if(this.vgGroups[e].users[i].userId===t.userId){this.vgGroups[e].users.splice(i,1);break}break}this.alertService.success(`User ${t.email} removed successfully`)},t=>{this.log("Remove VisboCenter User error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Remove User from Visbo Center"):(this.log("Error during remove VC user "+t.error.message),this.alertService.error(Gh(t)))})}helperSystemPerm(t){let e=0;return t.checkedSystemView&&(e+=this.permSystem.View),t.checkedSystemViewAudit&&(e+=this.permSystem.ViewAudit),t.checkedSystemViewLog&&(e+=this.permSystem.ViewLog),t.checkedSystemModify&&(e+=this.permSystem.Modify),t.checkedSystemCreateVC&&(e+=this.permSystem.CreateVC),t.checkedSystemDeleteVC&&(e+=this.permSystem.DeleteVC),t.checkedSystemManagePerm&&(e+=this.permSystem.ManagePerm),e}helperVCPerm(t){let e=0;return t.checkedView&&(e+=this.permVC.View),t.checkedViewAudit&&(e+=this.permVC.ViewAudit),t.checkedModify&&(e+=this.permVC.Modify),t.checkedCreateVP&&(e+=this.permVC.CreateVP),t.checkedManagePerm&&(e+=this.permVC.ManagePerm),e}helperVPPerm(t){let e=0;return t.checkedVPView&&(e+=this.permVP.View),t.checkedVPViewAudit&&(e+=this.permVP.ViewAudit),t.checkedVPModify&&(e+=this.permVP.Modify),t.checkedCreateVariant&&(e+=this.permVP.CreateVariant),t.checkedVPManagePerm&&(e+=this.permVP.ManagePerm),t.checkedVPDelete&&(e+=this.permVP.DeleteVP),e}activateGroup(t){this.log("Activate Group : "+t.groupName);const e=this.vgGroups.find(e=>e.name==t.groupName);this.initGroup(e)}activateUser(t){this.log("Activate User : "+t.email);const e=this.vgUsers.findIndex(e=>e.email==t.email);e>=0&&this.calcCombinedPerm(e)}initGroup(t){this.actGroup=new Tv,t?(this.confirm="Modify",this.actGroup._id=t._id,this.log(`Init Group Set GroupID : ${this.actGroup._id} ID ${t._id}`),this.actGroup.name=t.name,this.actGroup.checkedSystemView=(t.permission.system&this.permSystem.View)>0,this.actGroup.checkedSystemViewAudit=(t.permission.system&this.permSystem.ViewAudit)>0,this.actGroup.checkedSystemViewLog=(t.permission.system&this.permSystem.ViewLog)>0,this.actGroup.checkedSystemModify=(t.permission.system&this.permSystem.Modify)>0,this.actGroup.checkedSystemCreateVC=(t.permission.system&this.permSystem.CreateVC)>0,this.actGroup.checkedSystemDeleteVC=(t.permission.system&this.permSystem.DeleteVC)>0,this.actGroup.checkedSystemManagePerm=(t.permission.system&this.permSystem.ManagePerm)>0,this.actGroup.global=t.global,this.actGroup.checkedView=(t.permission.vc&this.permVC.View)>0,this.actGroup.checkedViewAudit=(t.permission.vc&this.permVC.ViewAudit)>0,this.actGroup.checkedModify=(t.permission.vc&this.permVC.Modify)>0,this.actGroup.checkedCreateVP=(t.permission.vc&this.permVC.CreateVP)>0,this.actGroup.checkedManagePerm=(t.permission.vc&this.permVC.ManagePerm)>0,this.actGroup.checkedVPView=(t.permission.vp&this.permVP.View)>0,this.actGroup.checkedVPViewAudit=(t.permission.vp&this.permVP.ViewAudit)>0,this.actGroup.checkedVPModify=(t.permission.vp&this.permVP.Modify)>0,this.actGroup.checkedCreateVariant=(t.permission.vp&this.permVP.CreateVariant)>0,this.actGroup.checkedVPManagePerm=(t.permission.vp&this.permVP.ManagePerm)>0,this.actGroup.checkedVPDelete=(t.permission.vp&this.permVP.DeleteVP)>0):(this.actGroup._id=void 0,this.confirm="Create",this.actGroup.name="",this.actGroup.global=!1,this.actGroup.checkedView=!0),this.log(`Init Group for Creation / Modification: ${this.actGroup.name} ID ${this.actGroup._id}`)}addModifyVCGroup(){const t=new xv;t.name=this.actGroup.name.trim(),t.global=this.actGroup.global,t.vcid=this.visbocenter._id,t.permission=new Dv,t.permission.system=this.helperSystemPerm(this.actGroup),t.global&&(t.permission.vc=this.helperVCPerm(this.actGroup),t.permission.vp=this.helperVPPerm(this.actGroup)),this.log(`Add/Modify VisboCenter Group: Group: ${t.name} New/Modify ${this.actGroup._id} Perm: ${JSON.stringify(t.permission)}`),this.actGroup._id?(this.log(`Modify VisboCenter Group: Group: ${t.name} VC: ${t.vcid} Perm: ${JSON.stringify(t.permission)}`),t._id=this.actGroup._id,this.visbocenterService.modifyVCGroup(t,!0).subscribe(e=>{this.vgGroups=this.vgGroups.filter(e=>e._id!==t._id),this.vgGroups.push(e);for(let i=0;i<this.vgUsers.length;i++)this.vgUsers[i].groupId===t._id&&(this.vgUsers[i].groupName=e.name);this.sortUserTable(),this.sortGroupTable(),this.alertService.success(`Group ${e.name} changed successfully`)},t=>{this.log("Modify VisboCenter Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Modify Group to Visbo Center"):(this.log("Error during add VC Group "+t.error.message),this.alertService.error(Gh(t)))})):(this.log(`Add VisboCenter Group: Group: ${t.name} VC: ${t.vcid} Perm: vc ${JSON.stringify(t.permission)}`),this.visbocenterService.addVCGroup(t,!0).subscribe(t=>{this.vgGroups.push(t),this.alertService.success(`Group ${t.name} added successfully`)},t=>{this.log("Add VisboCenter Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Add Group to Visbo Center"):(this.log("Error during add VC Group "+t.error.message),this.alertService.error(Gh(t)))}))}removeVCGroup(t){this.log(`Remove VisboCenter Group: ${t.name}/${t._id} VC: ${t.vcid}`),this.visbocenterService.deleteVCGroup(t,!0).subscribe(e=>{this.log("Remove VisboCenter Group result: "+JSON.stringify(e)),this.vgGroups=this.vgGroups.filter(e=>e!==t),this.vgUsers=this.vgUsers.filter(e=>e.groupId!==t._id),this.alertService.success(`Group ${t.name} removed successfully`)},t=>{this.log("Remove VisboCenter Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Remove Group from Visbo Center"):(this.log("Error during remove VC user "+t.error.message),this.alertService.error(Gh(t)))})}sortUserTable(t){this.vgUsers&&(void 0===t&&void 0!==this.sortUserColumn||(t!==this.sortUserColumn&&(this.sortUserColumn=t,this.sortUserAscending=void 0),this.sortUserAscending=void 0===this.sortUserAscending?1===t||2===t:!this.sortUserAscending),1===this.sortUserColumn?this.vgUsers.sort((function(t,e){return xh(t.email,e.email)})):2===this.sortUserColumn&&this.vgUsers.sort((function(t,e){return xh(t.groupName.toLowerCase(),e.groupName.toLowerCase())})),this.sortUserAscending||this.vgUsers.reverse())}sortGroupTable(t){this.vgGroups&&(void 0===t&&void 0!==this.sortGroupColumn||(t!==this.sortGroupColumn&&(this.sortGroupColumn=t,this.sortGroupAscending=void 0),this.sortGroupAscending=void 0===this.sortGroupAscending?1===t:!this.sortGroupAscending),1===this.sortGroupColumn?this.vgGroups.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortGroupColumn&&this.vgGroups.sort((function(t,e){return e.users.length-t.users.length})),this.sortGroupAscending||this.vgGroups.reverse())}log(t){this.messageService.add("Sys VisboCenter: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(Ev),Rr(Bg),Rr(Xl),Rr(rf),Rr(Mf))},t.\u0275cmp=le({type:t,selectors:[["app-sysvisbosystem"]],decls:2,vars:1,consts:[[4,"ngIf"],[1,"btn-toolbar"],["id","ViewGroup","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewUser","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","VcUserModalCreate","tabindex","-1","role","dialog","aria-labelledby","VcUserModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VcUserModalCenterTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["name","newUserInvite","novalidate",""],["f1","ngForm"],[1,"form-group",3,"ngClass"],["for","email",1,"col-form-label"],["id","AddUserName","type","email","name","email","required","","pattern","[^@\\s]+@[^@\\s]+\\.[^@\\s]+","autocomplete","email",1,"form-control",3,"ngModel","ngModelChange"],["email","ngModel"],["class","help-block",4,"ngIf"],["for","group",1,"col-form-label"],["id","AddUserGroupName","name","group","required","",1,"form-control",3,"ngModel","ngModelChange"],["group","ngModel"],[4,"ngFor","ngForOf"],["for","inviteMessage",1,"col-form-label"],["id","AddUserMessage","name","inviteMessage",1,"form-control",3,"ngModel","ngModelChange"],["inviteMessage","ngModel"],[1,"modal-footer","align-items-end"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-secondary"],["id","AddUserConfirm","type","button","class","btn btn-primary",4,"ngIf"],["id","AddUserConfirm","type","button","class","btn btn-primary","data-dismiss","modal",3,"click",4,"ngIf"],["id","VcUserRemove","tabindex","-1","role","dialog","aria-labelledby","VcUserModalRemoveTitle","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-dialog-centered","role","document",4,"ngIf"],["id","SystemGroupModalCreate","tabindex","-1","role","dialog","aria-labelledby","SystemGroupModalCreateTitle","aria-hidden","true",1,"modal","fade"],["class","modal-content",4,"ngIf"],["id","VcGroupRemove","tabindex","-1","role","dialog","aria-labelledby","VcGroupModalRemoveTitle","aria-hidden","true",1,"modal","fade"],["class","modal fade","id","SystemUserDetail","tabindex","-1","role","dialog","aria-labelledby","SystemUserDetailTitle","aria-hidden","true",4,"ngIf"],["id","ViewGroup","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],["id","ViewUser","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],[1,"row"],[1,"col"],[1,"panel-heading"],["class","col",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover"],["id","UserHead"],["id","SortUser",3,"click"],["id","SortGroup",3,"click"],["id","UserList"],["id","AddUser","type","button","data-toggle","modal","data-target","#VcUserModalCreate",1,"btn","btn-primary","float-right","my-1"],["id","ColUser","data-toggle","modal","data-target","#SystemUserDetail",3,"click"],["id","ColGroup",3,"click"],["id","ColDeleteUser","title","Remove User","data-toggle","modal","data-target","#VcUserRemove",1,"Detail",3,"click"],["id","GroupHead"],[3,"click"],["id","GroupList"],["id","AddGroup","type","button","data-toggle","modal","data-target","#SystemGroupModalCreate",1,"btn","btn-primary","float-right","my-1",3,"click"],["id","ColGroup","data-toggle","modal","data-target","#SystemGroupModalCreate",3,"click"],["id","ColMembers",3,"click"],["id","ColGlobal",4,"ngIf"],["id","ColDetail","title","Detail of Group","data-toggle","modal","data-target","#SystemGroupModalCreate",1,"Detail",3,"click"],["id","ColGlobal"],["id","ColDeleteGroup","title","Remove Group","data-toggle","modal","data-target","#VcGroupRemove",1,"Detail",3,"click"],[1,"help-block"],["id","AddUserConfirm","type","button",1,"btn","btn-primary"],["id","AddUserConfirm","type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"],["id","VcUserRemoveTitle",1,"modal-title"],[1,"bg-warning"],[1,"form-group"],["for","VcName",1,"col-form-label"],[1,"col-8","form-control-static"],[1,"col-form-label"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["id","DeleteUserConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning",3,"click"],["class","modal-title","id","VcGroupModalCenterTitle",4,"ngIf"],["name","actGroup","novalidate",""],["f2","ngForm"],["for","groupName",1,"col-form-label"],["id","AddGroupName","type","text","name","groupName","required","","minlength","3",1,"form-control",3,"ngModel","ngModelChange"],["groupName","ngModel"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","sysperm1","name","checkedSystemView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedSystemView","ngModel"],["for","sysperm1",1,"custom-control-label"],["type","checkbox","id","sysperm2","name","checkedSystemViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedSystemViewAudit","ngModel"],["for","sysperm2",1,"custom-control-label"],["type","checkbox","id","sysperm3","name","checkedSystemViewLog",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedSystemViewLog","ngModel"],["for","sysperm3",1,"custom-control-label"],["type","checkbox","id","sysperm3a","name","checkedSystemModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedSystemModify","ngModel"],["for","sysperm3a",1,"custom-control-label"],["type","checkbox","id","sysperm4","name","checkedSystemCreateVC",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedSystemCreateVC","ngModel"],["for","sysperm4",1,"custom-control-label"],["type","checkbox","id","sysperm5","name","checkedSystemDeleteVC",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedSystemDeleteVC","ngModel"],["for","sysperm5",1,"custom-control-label"],["type","checkbox","id","sysperm6","name","checkedSystemManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedSystemManagePerm","ngModel"],["for","sysperm6",1,"custom-control-label"],["type","checkbox","id","global","name","global",1,"custom-control-input",3,"ngModel","ngModelChange"],["global","ngModel"],["for","global",1,"custom-control-label"],["class","mt-2",4,"ngIf"],[1,"modal-footer","align-items-end","mt-3"],["id","AddGroupConfirm","type","button","class","btn btn-primary disabled",4,"ngIf"],["id","AddGroupConfirm","type","button","class","btn btn-primary","data-dismiss","modal",3,"click",4,"ngIf"],["id","VcGroupModalCenterTitle",1,"modal-title"],["type","checkbox","id","perm1","name","checkedView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedView","ngModel"],["for","perm1",1,"custom-control-label"],["type","checkbox","id","perm2","name","checkedViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedViewAudit","ngModel"],["for","perm2",1,"custom-control-label"],["type","checkbox","id","perm3","name","checkedModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedModify","ngModel"],["for","perm3",1,"custom-control-label"],["type","checkbox","id","perm4","name","checkedCreateVP",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVP","ngModel"],["for","perm4",1,"custom-control-label"],["type","checkbox","id","perm5","name","checkedManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedManagePerm","ngModel"],["for","perm5",1,"custom-control-label"],["type","checkbox","id","permVP1","name","checkedVPView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPView","ngModel"],["for","permVP1",1,"custom-control-label"],["type","checkbox","id","permVP2","name","checkedVPViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPViewAudit","ngModel"],["for","permVP2",1,"custom-control-label"],["type","checkbox","id","permVP3","name","checkedVPModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPModify","ngModel"],["for","permVP3",1,"custom-control-label"],["type","checkbox","id","permVP4","name","checkedCreateVariant",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVariant","ngModel"],["for","permVP4",1,"custom-control-label"],["type","checkbox","id","permVP5","name","checkedVPManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPManagePerm","ngModel"],["for","permVP5",1,"custom-control-label"],["type","checkbox","id","permVP6","name","checkedVPDelete",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPDelete","ngModel"],["for","permVP6",1,"custom-control-label"],[1,"mt-2"],[1,"form-control-static"],["class","row",4,"ngFor","ngForOf"],["class","col-8 ml-3",4,"ngIf"],[1,"col-8","ml-3"],["data-dismiss","modal","data-toggle","modal","data-target","#SystemUserDetail",3,"click"],["id","AddGroupConfirm","type","button",1,"btn","btn-primary","disabled"],["id","AddGroupConfirm","type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"],["id","DeleteGroupConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning",3,"click"],["id","SystemUserDetail","tabindex","-1","role","dialog","aria-labelledby","SystemUserDetailTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],["id","SystemUserDetailTitle",1,"modal-title"],["type","checkbox","checked","","disabled","","class","custom-control-input",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input",4,"ngIf"],[1,"custom-control-label"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],[1,"form-control-static","mt-2"],[1,"form-group","mt-2"],["id","ButtonBack","data-dismiss","modal",1,"btn","btn-primary"],["type","checkbox","checked","","disabled","",1,"custom-control-input"],["type","checkbox","disabled","",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["data-dismiss","modal","data-toggle","modal","data-target","#SystemGroupModalCreate",3,"click"]],template:function(t,e){1&t&&(Br(0,"app-sysnavbar"),Lr(1,AU,55,29,"div",0)),2&t&&(_n(1),jr("ngIf",e.visbocenter))},directives:[CC,jc,Eu,Fd,Tu,Ec,Ed,Ru,Hu,Nd,Ou,cu,du,gu,Gc,Fu,_d],pipes:[Kc],styles:[""]}),t})();function kU(t,e){if(1&t){const t=zr();Nr(0,"button",36),Jr("click",(function(){return ei(t),Xr(2).toggleVisboCenters()})),mo(1,"Show Deleted"),Fr()}}function DU(t,e){if(1&t){const t=zr();Nr(0,"button",37),Jr("click",(function(){return ei(t),Xr(2).toggleVisboCenters()})),mo(1,"Show Existing"),Fr()}}function MU(t,e){1&t&&(Nr(0,"button",38),mo(1,"Create New"),Fr())}function IU(t,e){if(1&t&&(Nr(0,"div",32),Lr(1,kU,2,0,"button",33),Lr(2,DU,2,0,"button",34),Lr(3,MU,2,0,"button",35),Fr()),2&t){const t=Xr();_n(1),jr("ngIf",!t.deleted),_n(1),jr("ngIf",t.deleted),_n(1),jr("ngIf",t.hasSystemPerm(t.permSystem.CreateVC))}}function SU(t,e){if(1&t){const t=zr();Nr(0,"tr",39),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr().gotoClickedRow(i)})),Nr(1,"td",8),mo(2),Fr(),Nr(3,"td",40),Nr(4,"a"),mo(5),Fr(),Fr(),Nr(6,"td",41),mo(7),Ua(8,"date"),Fr(),Nr(9,"td",42),mo(10),Ua(11,"date"),Fr(),Nr(12,"td",43),mo(13),Fr(),Nr(14,"td",44),Nr(15,"button",45),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr().gotoDetail(i)})),mo(16,"i"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit,i=e.index;_n(2),fo(i+1),_n(3),fo(t.name),_n(2),fo(Ea(8,5,t.updatedAt,"dd.MM.yyyy HH:mm")),_n(3),fo(Ea(11,8,t.updatedAt,"dd.MM.yy")),_n(3),fo(t.vpCount)}}let xU=(()=>{class t{constructor(t,e,i,n,s){this.visbocenterService=t,this.messageService=e,this.alertService=i,this.route=n,this.router=s,this.combinedPerm=void 0,this.deleted=!1,this.permSystem=Mv,this.permVC=Iv,this.permVP=Sv}ngOnInit(){this.log("Init SysVC Deleted: "+this.deleted),this.log("Init GetVisboCenters "+JSON.stringify(this.route.snapshot.queryParams)),this.deleted=!!this.route.snapshot.queryParams.deleted,this.getVisboCenters(this.deleted),this.combinedPerm=this.visbocenterService.getSysAdminRole()}toggleVisboCenters(){this.deleted=!this.deleted,this.log("VC toggleVisboCenters "+this.deleted),this.getVisboCenters(this.deleted),this.router.navigate(["sysvc"],this.deleted?{queryParams:{deleted:this.deleted}}:{})}getVisboCenters(t){this.log(`VC getVisboCenters ${JSON.stringify(this.combinedPerm)} deleted ${this.deleted}`),this.visbocenterService.getVisboCenters(!0,t).subscribe(t=>{this.visbocenters=t,this.sortVCTable(1),this.log("get VCs success")},t=>{this.log(`get VCs failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}getSysVisboCenter(){this.visbocenterService.getSysVisboCenter().subscribe(t=>{t.length>0&&(this.sysvisbocenter=t[0])})}add(t,e){t=t.trim(),e=e.trim(),this.log("VC: Add VC: "+t),t&&this.visbocenterService.addVisboCenter({name:t,description:e}).subscribe(t=>{this.visbocenters.push(t),this.sortVCTable(void 0),this.alertService.success(`Visbo Center ${t.name} created successfully`)},e=>{this.log(`add VC failed: error: ${e.status} message: ${e.error.message}`),this.alertService.error(403===e.status?"Permission Denied for Visbo Center "+t:409===e.status?`Visbo Center Name ${t} already exists or not allowed`:Gh(e))})}delete(t){this.messageService.add(`VC: Delete VC: ${t.name} ID: ${t._id}`),this.visbocenters=this.visbocenters.filter(e=>e!==t),this.visbocenterService.deleteVisboCenter(t).subscribe(()=>{this.alertService.success("Deleted Visbo Center: "+t.name,!0)},t=>{this.log("delete VC failed: error: "+JSON.stringify(t)),this.alertService.error(403===t.status?"Permission Denied: Visbo Center "+name:Gh(t))})}gotoDetail(t){const e=!!t.deletedAt;this.log(`navigate to VC Detail ${t._id} Deleted ${e}`),this.router.navigate(["sysvcDetail/"+t._id],e?{queryParams:{deleted:e}}:{})}gotoClickedRow(t){this.log("clicked row "+t.name),this.hasSystemPerm(this.permVC.View)&&this.router.navigate(["sysvp/"+t._id])}hasSystemPerm(t){return(this.combinedPerm.system&t)>0}hasVCPerm(t){return(this.combinedPerm.vc&t)>0}hasVPPerm(t){return(this.combinedPerm.vp&t)>0}sortVCTable(t){this.visbocenters&&(void 0===t&&void 0!==this.sortColumn||(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t:!this.sortAscending),1===this.sortColumn?this.visbocenters.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortColumn?this.visbocenters.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})):3===this.sortColumn&&this.visbocenters.sort((function(t,e){return t.vpCount-e.vpCount})),this.sortAscending||this.visbocenters.reverse())}log(t){this.messageService.add("Sys VisboCenter: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Ev),Rr(jh),Rr(Mf),Rr(Bg),Rr(rf))},t.\u0275cmp=le({type:t,selectors:[["app-sysvisbocenters"]],decls:49,vars:2,consts:[[1,"well"],[1,"row"],[1,"col"],[1,"panel-heading","ml-0"],["class","btn-group",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],["id","VCHead"],[1,"d-none","d-md-table-cell"],["id","SortName",3,"click"],["id","SortDate",1,"d-none","d-sm-table-cell",3,"click"],["id","SortProjects",1,"d-none","d-md-table-cell",3,"click"],["id","VCList"],[3,"click",4,"ngFor","ngForOf"],["id","VcModalCreate","tabindex","-1","role","dialog","aria-labelledby","VcModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VcModalCenterTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group"],["for","vcName",1,"col-form-label"],["id","CreateVCName","type","text",1,"form-control"],["vcName",""],["for","vcDescription",1,"col-form-label"],["id","CreateVCDesc",1,"form-control"],["vcDescription",""],[1,"modal-footer","align-items-end"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-secondary"],["id","CreateVCConfirm","type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"],[1,"btn-group"],["id","DeletedVC","type","button","class","m-1 btn btn-secondary",3,"click",4,"ngIf"],["id","UnDeletedVC","type","button","class","m-1 btn btn-secondary",3,"click",4,"ngIf"],["id","CreateVC","type","button","class","m-1 btn btn-primary","data-toggle","modal","data-target","#VcModalCreate",4,"ngIf"],["id","DeletedVC","type","button",1,"m-1","btn","btn-secondary",3,"click"],["id","UnDeletedVC","type","button",1,"m-1","btn","btn-secondary",3,"click"],["id","CreateVC","type","button","data-toggle","modal","data-target","#VcModalCreate",1,"m-1","btn","btn-primary"],[3,"click"],["id","ColName"],["id","ColDate",1,"d-none","d-md-table-cell"],["id","ColDate",1,"d-none","d-sm-table-cell","d-md-none"],["id","ColProjects",1,"d-none","d-md-table-cell"],["id","ColDetail"],["title","Detail of Visbo Center",1,"Detail",3,"click"]],template:function(t,e){if(1&t){const t=zr();Br(0,"app-sysnavbar"),Nr(1,"div",0),Nr(2,"div",1),Nr(3,"div",2),Nr(4,"h2",3),mo(5," Visbo Centers "),Fr(),Fr(),Lr(6,IU,4,3,"div",4),Fr(),Nr(7,"div",5),Nr(8,"table",6),Nr(9,"thead",7),Nr(10,"tr"),Nr(11,"th",8),mo(12,"Nr."),Fr(),Nr(13,"th",9),Jr("click",(function(){return e.sortVCTable(1)})),mo(14,"Name"),Fr(),Nr(15,"th",10),Jr("click",(function(){return e.sortVCTable(2)})),mo(16,"Modified"),Fr(),Nr(17,"th",11),Jr("click",(function(){return e.sortVCTable(3)})),mo(18,"# Projects"),Fr(),Nr(19,"th"),mo(20,"Detail"),Fr(),Fr(),Fr(),Nr(21,"tbody",12),Lr(22,SU,17,11,"tr",13),Fr(),Fr(),Fr(),Fr(),Nr(23,"div",14),Nr(24,"div",15),Nr(25,"div",16),Nr(26,"div",17),Nr(27,"h5",18),mo(28,"Create a new Visbo Center"),Fr(),Nr(29,"button",19),Nr(30,"span",20),mo(31,"\xd7"),Fr(),Fr(),Fr(),Nr(32,"div",21),Nr(33,"form"),Nr(34,"div",22),Nr(35,"label",23),mo(36,"Name:"),Fr(),Br(37,"input",24,25),Fr(),Nr(39,"div",22),Nr(40,"label",26),mo(41,"Description:"),Fr(),Br(42,"textarea",27,28),Fr(),Fr(),Fr(),Nr(44,"div",29),Nr(45,"button",30),mo(46,"Close"),Fr(),Nr(47,"button",31),Jr("click",(function(){ei(t);const i=Gr(38),n=Gr(43);return e.add(i.value,n.value),i.value="",n.value=""})),mo(48,"Save"),Fr(),Fr(),Fr(),Fr(),Fr()}2&t&&(_n(6),jr("ngIf",e.hasSystemPerm(e.permSystem.DeleteVC)),_n(16),jr("ngForOf",e.visbocenters))},directives:[CC,jc,Gc,Eu,Fd,Tu],pipes:[qc],encapsulation:2}),t})();function TU(t,e){if(1&t){const t=zr();Nr(0,"input",63),Jr("ngModelChange",(function(e){return ei(t),Xr(2).visbocenter.name=e})),Fr()}2&t&&jr("ngModel",Xr(2).visbocenter.name)}function _U(t,e){if(1&t&&(Nr(0,"label",64),mo(1),Fr()),2&t){const t=Xr(2);_n(1),vo("",t.visbocenter.name," ")}}function UU(t,e){if(1&t){const t=zr();Nr(0,"textarea",65),Jr("ngModelChange",(function(e){return ei(t),Xr(2).visbocenter.description=e})),Fr()}2&t&&jr("ngModel",Xr(2).visbocenter.description)}function OU(t,e){if(1&t&&(Nr(0,"label",66),mo(1),Fr()),2&t){const t=Xr(2);_n(1),vo("",t.visbocenter.description," ")}}function EU(t,e){if(1&t){const t=zr();Nr(0,"button",67),Jr("click",(function(){ei(t);const e=Xr(2);return e.gotoVCAudit(e.visbocenter)})),mo(1,"View Audit"),Fr()}}function LU(t,e){if(1&t){const t=zr();Nr(0,"button",68),Jr("click",(function(){return ei(t),Xr(2).toggleUserGroup()})),mo(1,"Show Groups"),Fr()}}function GU(t,e){if(1&t){const t=zr();Nr(0,"button",69),Jr("click",(function(){return ei(t),Xr(2).toggleUserGroup()})),mo(1,"Show Users"),Fr()}}function RU(t,e){1&t&&(Nr(0,"div",71),Nr(1,"button",78),mo(2,"Add User"),Fr(),Fr())}function jU(t,e){1&t&&(Nr(0,"th"),mo(1,"Delete"),Fr())}function $U(t,e){if(1&t){const t=zr();Nr(0,"td"),Nr(1,"button",81),Jr("click",(function(){ei(t);const e=Xr().index;return Xr(3).helperUserIndex(e)})),mo(2,"\xd7"),Fr(),Fr()}}function NU(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td"),mo(2),Fr(),Nr(3,"td",79),Jr("click",(function(){ei(t);const i=e.index;return Xr(3).calcCombinedPerm(i)})),mo(4),Fr(),Nr(5,"td",80),mo(6),Fr(),Lr(7,$U,3,0,"td",0),Fr()}if(2&t){const t=e.$implicit,i=e.index,n=Xr(3);_n(2),fo(i+1),_n(2),fo(t.email),_n(2),fo(t.groupName),_n(1),jr("ngIf",!n.deleted&&n.hasVCPerm(n.permVC.ManagePerm))}}function FU(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div"),Nr(2,"div",70),Nr(3,"div",71),Nr(4,"h5",72),mo(5," Visbo Center Users "),Fr(),Fr(),Lr(6,RU,3,0,"div",73),Fr(),Nr(7,"div",74),Nr(8,"table",75),Nr(9,"thead",76),Nr(10,"tr"),Nr(11,"th"),mo(12,"Nr."),Fr(),Nr(13,"th",1),Jr("click",(function(){return ei(t),Xr(2).sortUserTable(1)})),mo(14,"e-mail"),Fr(),Nr(15,"th",1),Jr("click",(function(){return ei(t),Xr(2).sortUserTable(2)})),mo(16,"Group"),Fr(),Lr(17,jU,2,0,"th",0),Fr(),Fr(),Nr(18,"tbody",77),Lr(19,NU,8,4,"tr",38),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(6),jr("ngIf",t.hasVCPerm(t.permVC.ManagePerm)),_n(11),jr("ngIf",!t.deleted&&t.hasVCPerm(t.permVC.ManagePerm)),_n(2),jr("ngForOf",t.vgUsers)}}function BU(t,e){1&t&&(Nr(0,"th"),mo(1,"Delete"),Fr())}function HU(t,e){1&t&&(Nr(0,"td",88),mo(1,"Global"),Fr())}function KU(t,e){1&t&&Br(0,"td",88)}function qU(t,e){if(1&t){const t=zr();Nr(0,"td"),Nr(1,"button",89),Jr("click",(function(){ei(t);const e=Xr().index;return Xr(3).helperRemoveGroup(e)})),mo(2,"\xd7"),Fr(),Fr()}}function zU(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td"),mo(2),Fr(),Nr(3,"td",84),Jr("click",(function(){ei(t);const i=e.index,n=e.$implicit,s=Xr(3);return s.groupIndex=i,s.initGroup(n)})),mo(4),Fr(),Nr(5,"td",85),mo(6),Fr(),Lr(7,HU,2,0,"td",86),Lr(8,KU,1,0,"td",86),Lr(9,qU,3,0,"td",0),Nr(10,"td"),Nr(11,"button",87),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(3).initGroup(i)})),mo(12,"i"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit,i=e.index,n=Xr(3);_n(2),fo(i+1),_n(2),fo(t.name),_n(2),fo(t.users.length),_n(1),jr("ngIf",t.global),_n(1),jr("ngIf",!t.global),_n(1),jr("ngIf",!n.deleted&&n.hasVCPerm(n.permVC.ManagePerm))}}function QU(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div"),Nr(2,"div",70),Nr(3,"div",71),Nr(4,"h5",72),mo(5," Visbo Center Groups "),Fr(),Fr(),Fr(),Nr(6,"div",74),Nr(7,"table",75),Nr(8,"thead",82),Nr(9,"tr"),Nr(10,"th"),mo(11,"Nr."),Fr(),Nr(12,"th",1),Jr("click",(function(){return ei(t),Xr(2).sortGroupTable(1)})),mo(13,"Group"),Fr(),Nr(14,"th",1),Jr("click",(function(){return ei(t),Xr(2).sortGroupTable(2)})),mo(15,"Members"),Fr(),Nr(16,"th"),mo(17,"Flag"),Fr(),Lr(18,BU,2,0,"th",0),Nr(19,"th"),mo(20,"Info"),Fr(),Fr(),Fr(),Nr(21,"tbody",83),Lr(22,zU,13,6,"tr",38),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(18),jr("ngIf",!t.deleted&&t.hasVCPerm(t.permVC.ManagePerm)),_n(4),jr("ngForOf",t.vgGroups)}}function WU(t,e){if(1&t){const t=zr();Nr(0,"button",90),Jr("click",(function(){return ei(t),Xr(2).save()})),mo(1,"save"),Fr()}}function JU(t,e){if(1&t){const t=zr();Nr(0,"button",90),Jr("click",(function(){return ei(t),Xr(2).save()})),mo(1,"Restore"),Fr()}}function YU(t,e){1&t&&(Nr(0,"button",91),mo(1,"Delete!"),Fr())}function ZU(t,e){1&t&&(Nr(0,"button",92),mo(1,"Destroy!"),Fr())}function XU(t,e){1&t&&(Nr(0,"div",93),mo(1,"E-mail address is required"),Fr())}function tO(t,e){if(1&t&&(Nr(0,"option"),mo(1),Fr()),2&t){const t=e.$implicit;_n(1),fo(t.name)}}function eO(t,e){1&t&&(Nr(0,"div",93),mo(1,"Group must be defined"),Fr())}function iO(t,e){1&t&&(Nr(0,"div",93),mo(1,"Error in Message"),Fr())}function nO(t,e){1&t&&(Nr(0,"button",94),mo(1,"Invite"),Fr())}function sO(t,e){if(1&t){const t=zr();Nr(0,"button",95),Jr("click",(function(){return ei(t),Xr(2).addNewVCUser()})),mo(1,"Invite"),Fr()}}function rO(t,e){if(1&t){const t=zr();Nr(0,"div",21),Nr(1,"div",22),Nr(2,"div",23),Nr(3,"h5",96),mo(4,"Remove User from Visbo Center"),Fr(),Nr(5,"button",25),Nr(6,"span",26),mo(7,"\xd7"),Fr(),Fr(),Fr(),Nr(8,"div",27),Nr(9,"div"),Nr(10,"label",97),mo(11,"Do you really want to remove this User from Visbo Center? "),Fr(),Fr(),Nr(12,"form"),Nr(13,"div",42),Nr(14,"label",54),mo(15,"Visbo Center:"),Fr(),Nr(16,"label",55),mo(17),Fr(),Fr(),Nr(18,"div",42),Nr(19,"label",54),mo(20,"User:"),Fr(),Nr(21,"label",55),mo(22),Fr(),Fr(),Nr(23,"div",42),Nr(24,"label",54),mo(25,"Group:"),Fr(),Nr(26,"label",55),mo(27),Fr(),Fr(),Fr(),Fr(),Nr(28,"div",58),Nr(29,"button",59),mo(30,"Close"),Fr(),Nr(31,"button",98),Jr("click",(function(){ei(t);const e=Xr(2);return e.removeVCUser(e.vgUsers[e.userIndex],e.visbocenter._id)})),mo(32,"Remove"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(17),vo("",t.visbocenter.name," "),_n(5),fo(t.vgUsers[t.userIndex].email),_n(5),fo(t.vgUsers[t.userIndex].groupName)}}function oO(t,e){1&t&&(Nr(0,"h5",127),mo(1,"Modify a Group in the Visbo Center"),Fr())}function aO(t,e){1&t&&(Nr(0,"h5",127),mo(1,"Add a new Group to the Visbo Center"),Fr())}function lO(t,e){1&t&&(Nr(0,"div",93),mo(1,"Group Name is required"),Fr())}function cO(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div"),mo(2,"Define Visbo Project Permission"),Fr(),Nr(3,"div",104),Nr(4,"input",128,129),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedVPView=e})),Fr(),Nr(6,"label",130),mo(7,"View Visbo Project"),Fr(),Fr(),Nr(8,"div",104),Nr(9,"input",131,132),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedVPViewAudit=e})),Fr(),Nr(11,"label",133),mo(12,"View Project Audit"),Fr(),Fr(),Nr(13,"div",104),Nr(14,"input",134,135),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedVPModify=e})),Fr(),Nr(16,"label",136),mo(17,"Modify Visbo Project"),Fr(),Fr(),Nr(18,"div",104),Nr(19,"input",137,138),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedCreateVariant=e})),Fr(),Nr(21,"label",139),mo(22,"Create Visbo Project Variant"),Fr(),Fr(),Nr(23,"div",104),Nr(24,"input",140,141),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedVPManagePerm=e})),Fr(),Nr(26,"label",142),mo(27,"Manage Permissions, Users and Groups"),Fr(),Fr(),Nr(28,"div",104),Nr(29,"input",143,144),Jr("ngModelChange",(function(e){return ei(t),Xr(3).actGroup.checkedVPDelete=e})),Fr(),Nr(31,"label",145),mo(32,"Delete Visbo Project"),Fr(),Fr(),Fr()}if(2&t){const t=Xr(3);_n(4),jr("ngModel",t.actGroup.checkedVPView),_n(5),jr("ngModel",t.actGroup.checkedVPViewAudit),_n(5),jr("ngModel",t.actGroup.checkedVPModify),_n(5),jr("ngModel",t.actGroup.checkedCreateVariant),_n(5),jr("ngModel",t.actGroup.checkedVPManagePerm),_n(5),jr("ngModel",t.actGroup.checkedVPDelete)}}function dO(t,e){if(1&t){const t=zr();Nr(0,"div",150),Nr(1,"a",151),Jr("click",(function(){ei(t);const e=Xr().$implicit;return Xr(4).activateUser(e)})),mo(2),Fr(),Fr()}if(2&t){const t=Xr().$implicit;_n(2),fo(t.email)}}function uO(t,e){if(1&t&&(Hr(0,70),Lr(1,dO,3,1,"div",149),Kr()),2&t){const t=e.$implicit,i=Xr(4);_n(1),jr("ngIf",t.groupName==i.actGroup.name)}}function hO(t,e){if(1&t&&(Nr(0,"div",146),Nr(1,"label",147),mo(2,"Group Members"),Fr(),Lr(3,uO,2,1,"ng-container",148),Fr()),2&t){const t=Xr(3);_n(3),jr("ngForOf",t.vgUsers)}}function pO(t,e){1&t&&(Nr(0,"div",146),Nr(1,"label",147),mo(2,"No Group Members"),Fr(),Fr())}function gO(t,e){if(1&t&&(Nr(0,"button",152),mo(1),Fr()),2&t){const t=Xr(3);_n(1),fo(t.confirm)}}function mO(t,e){if(1&t){const t=zr();Nr(0,"button",153),Jr("click",(function(){return ei(t),Xr(3).addModifyVCGroup()})),mo(1),Fr()}if(2&t){const t=Xr(3);_n(1),fo(t.confirm)}}const fO=function(t){return{"has-error":t}};function vO(t,e){if(1&t){const t=zr();Nr(0,"div",21),Nr(1,"div",22),Nr(2,"div",23),Lr(3,oO,2,0,"h5",99),Lr(4,aO,2,0,"h5",99),Nr(5,"button",25),Nr(6,"span",26),mo(7,"\xd7"),Fr(),Fr(),Fr(),Nr(8,"div",27),Nr(9,"form",100,29),Nr(11,"div",30),Nr(12,"label",101),mo(13,"Name:"),Fr(),Nr(14,"input",102,103),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.name=e})),Fr(),Lr(16,lO,2,0,"div",34),Fr(),Nr(17,"div"),mo(18,"Define Visbo Center Permission"),Fr(),Nr(19,"div",104),Nr(20,"input",105,106),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedView=e})),Fr(),Nr(22,"label",107),mo(23,"View Visbo Center"),Fr(),Fr(),Nr(24,"div",104),Nr(25,"input",108,109),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedViewAudit=e})),Fr(),Nr(27,"label",110),mo(28,"View Audit"),Fr(),Fr(),Nr(29,"div",104),Nr(30,"input",111,112),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedModify=e})),Fr(),Nr(32,"label",113),mo(33,"Modify Visbo Center"),Fr(),Fr(),Nr(34,"div",104),Nr(35,"input",114,115),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedCreateVP=e})),Fr(),Nr(37,"label",116),mo(38,"Create Visbo Project"),Fr(),Fr(),Nr(39,"div",104),Nr(40,"input",117,118),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedManagePerm=e})),Fr(),Nr(42,"label",119),mo(43,"Manage Permissions, Users and Groups"),Fr(),Fr(),Br(44,"br"),Nr(45,"div",104),Nr(46,"input",120,121),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.global=e})),Fr(),Nr(48,"label",122),mo(49,"Group has Access to all Visbo Projects"),Fr(),Fr(),Lr(50,cO,33,6,"div",0),Lr(51,hO,4,1,"div",123),Lr(52,pO,3,0,"div",123),Nr(53,"div",124),Lr(54,gO,2,1,"button",125),Lr(55,mO,2,1,"button",126),Nr(56,"button",45),mo(57,"Cancel"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Gr(10),e=Gr(15);Xr();const i=Gr(54),n=Xr();_n(3),jr("ngIf",n.actGroup._id),_n(1),jr("ngIf",!n.actGroup._id),_n(7),jr("ngClass",ka(16,fO,t.submitted&&!i.valid)),_n(3),jr("ngModel",n.actGroup.name),_n(2),jr("ngIf",t.submitted&&!e.valid),_n(4),jr("ngModel",n.actGroup.checkedView),_n(5),jr("ngModel",n.actGroup.checkedViewAudit),_n(5),jr("ngModel",n.actGroup.checkedModify),_n(5),jr("ngModel",n.actGroup.checkedCreateVP),_n(5),jr("ngModel",n.actGroup.checkedManagePerm),_n(6),jr("ngModel",n.actGroup.global),_n(4),jr("ngIf",n.actGroup.global),_n(1),jr("ngIf",n.helperUsersPerGroup(n.actGroup.name)),_n(1),jr("ngIf",!n.helperUsersPerGroup(n.actGroup.name)),_n(2),jr("ngIf",!(t.form.valid&&!n.deleted&&n.hasVCPerm(n.permVC.ManagePerm))),_n(1),jr("ngIf",t.form.valid&&!n.deleted&&n.hasVCPerm(n.permVC.ManagePerm))}}function bO(t,e){if(1&t){const t=zr();Nr(0,"div",21),Nr(1,"div",22),Nr(2,"div",23),Nr(3,"h5",96),mo(4,"Remove Group from Visbo Center"),Fr(),Nr(5,"button",25),Nr(6,"span",26),mo(7,"\xd7"),Fr(),Fr(),Fr(),Nr(8,"div",27),Nr(9,"div"),Nr(10,"label",97),mo(11,"Do you really want to remove this Group from Visbo Center? "),Fr(),Fr(),Nr(12,"form"),Nr(13,"div",42),Nr(14,"label",54),mo(15,"Visbo Center:"),Fr(),Nr(16,"label",55),mo(17),Fr(),Fr(),Nr(18,"div",42),Nr(19,"label",54),mo(20,"Group:"),Fr(),Nr(21,"label",55),mo(22),Fr(),Fr(),Nr(23,"div",42),Nr(24,"label",54),mo(25,"Members:"),Fr(),Nr(26,"label",55),mo(27),Fr(),Fr(),Fr(),Fr(),Nr(28,"div",58),Nr(29,"button",45),mo(30,"Close"),Fr(),Nr(31,"button",154),Jr("click",(function(){ei(t);const e=Xr(2);return e.removeVCGroup(e.vgGroups[e.groupIndex])})),mo(32,"Remove"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(17),vo("",t.visbocenter.name," "),_n(5),fo(t.vgGroups[t.groupIndex].name),_n(5),fo(t.vgGroups[t.groupIndex].users.length)}}function yO(t,e){1&t&&(Nr(0,"label",97),mo(1,"Do you really want to delete this Visbo Center? "),Fr())}function CO(t,e){1&t&&(Nr(0,"label",155),mo(1,"Do you really want to destroy this Visbo Center? "),Fr())}function VO(t,e){if(1&t){const t=zr();Nr(0,"button",156),Jr("click",(function(){ei(t);const e=Xr(2);return e.delete(e.visbocenter)})),mo(1,"Delete"),Fr()}}function wO(t,e){if(1&t){const t=zr();Nr(0,"button",157),Jr("click",(function(){ei(t);const e=Xr(2);return e.delete(e.visbocenter)})),mo(1,"Destroy"),Fr()}}function AO(t,e){1&t&&Br(0,"input",185)}function PO(t,e){1&t&&Br(0,"input",186)}function kO(t,e){1&t&&Br(0,"input",187)}function DO(t,e){1&t&&Br(0,"input",188)}function MO(t,e){1&t&&Br(0,"input",189)}function IO(t,e){1&t&&Br(0,"input",190)}function SO(t,e){1&t&&Br(0,"input",191)}function xO(t,e){1&t&&Br(0,"input",192)}function TO(t,e){1&t&&Br(0,"input",193)}function _O(t,e){1&t&&Br(0,"input",194)}function UO(t,e){1&t&&Br(0,"input",195)}function OO(t,e){1&t&&Br(0,"input",196)}function EO(t,e){1&t&&Br(0,"input",197)}function LO(t,e){1&t&&Br(0,"input",198)}function GO(t,e){1&t&&Br(0,"input",199)}function RO(t,e){1&t&&Br(0,"input",200)}function jO(t,e){1&t&&Br(0,"input",201)}function $O(t,e){1&t&&Br(0,"input",202)}function NO(t,e){1&t&&Br(0,"input",203)}function FO(t,e){1&t&&Br(0,"input",204)}function BO(t,e){1&t&&Br(0,"input",205)}function HO(t,e){1&t&&Br(0,"input",206)}function KO(t,e){if(1&t){const t=zr();Nr(0,"div",150),Nr(1,"a",207),Jr("click",(function(){ei(t);const e=Xr().$implicit;return Xr(3).activateGroup(e)})),mo(2),Fr(),Fr()}if(2&t){const t=Xr().$implicit;_n(2),fo(t.groupName)}}function qO(t,e){if(1&t&&(Hr(0,70),Lr(1,KO,3,1,"div",149),Kr()),2&t){const t=e.$implicit,i=Xr(3);_n(1),jr("ngIf",t.email==i.vgUsers[i.userIndex].email)}}function zO(t,e){if(1&t&&(Nr(0,"div",158),Nr(1,"div",159),Nr(2,"div",22),Nr(3,"div",23),Nr(4,"h5",160),mo(5),Fr(),Nr(6,"button",25),Nr(7,"span",26),mo(8,"\xd7"),Fr(),Fr(),Fr(),Nr(9,"div",27),Nr(10,"div",146),mo(11,"Visbo Center Permission for User"),Fr(),Nr(12,"div",104),Lr(13,AO,1,0,"input",161),Lr(14,PO,1,0,"input",162),Nr(15,"label",107),mo(16,"View Visbo Center"),Fr(),Fr(),Nr(17,"div",104),Lr(18,kO,1,0,"input",163),Lr(19,DO,1,0,"input",164),Nr(20,"label",110),mo(21,"View Audit"),Fr(),Fr(),Nr(22,"div",104),Lr(23,MO,1,0,"input",165),Lr(24,IO,1,0,"input",166),Nr(25,"label",113),mo(26,"Modify Visbo Center"),Fr(),Fr(),Nr(27,"div",104),Lr(28,SO,1,0,"input",167),Lr(29,xO,1,0,"input",168),Nr(30,"label",116),mo(31,"Create Visbo Project"),Fr(),Fr(),Nr(32,"div",104),Lr(33,TO,1,0,"input",169),Lr(34,_O,1,0,"input",170),Nr(35,"label",119),mo(36,"Manage Permissions, Users and Groups"),Fr(),Fr(),Br(37,"br"),Nr(38,"div"),mo(39,"Visbo Project Permission for User"),Fr(),Nr(40,"div",104),Lr(41,UO,1,0,"input",171),Lr(42,OO,1,0,"input",172),Nr(43,"label",130),mo(44,"View Visbo Project"),Fr(),Fr(),Nr(45,"div",104),Lr(46,EO,1,0,"input",173),Lr(47,LO,1,0,"input",174),Nr(48,"label",133),mo(49,"View Project Audit"),Fr(),Fr(),Nr(50,"div",104),Lr(51,GO,1,0,"input",175),Lr(52,RO,1,0,"input",176),Nr(53,"label",136),mo(54,"Modify Visbo Project"),Fr(),Fr(),Nr(55,"div",104),Lr(56,jO,1,0,"input",177),Lr(57,$O,1,0,"input",178),Nr(58,"label",139),mo(59,"Create Visbo Project Variant"),Fr(),Fr(),Nr(60,"div",104),Lr(61,NO,1,0,"input",179),Lr(62,FO,1,0,"input",180),Nr(63,"label",142),mo(64,"Manage Permissions, Users and Groups"),Fr(),Fr(),Nr(65,"div",104),Lr(66,BO,1,0,"input",181),Lr(67,HO,1,0,"input",182),Nr(68,"label",145),mo(69,"Delete Visbo Project"),Fr(),Fr(),Nr(70,"label",183),mo(71,"Group Member Ship"),Fr(),Lr(72,qO,2,1,"ng-container",148),Nr(73,"div",124),Nr(74,"button",184),mo(75,"Close"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr(2);_n(5),vo("Permission for ",t.vgUsers[t.userIndex].email,""),_n(8),jr("ngIf",t.hasUserVCPerm(t.permVC.View)),_n(1),jr("ngIf",!t.hasUserVCPerm(t.permVC.View)),_n(4),jr("ngIf",t.hasUserVCPerm(t.permVC.ViewAudit)),_n(1),jr("ngIf",!t.hasUserVCPerm(t.permVC.ViewAudit)),_n(4),jr("ngIf",t.hasUserVCPerm(t.permVC.Modify)),_n(1),jr("ngIf",!t.hasUserVCPerm(t.permVC.Modify)),_n(4),jr("ngIf",t.hasUserVCPerm(t.permVC.CreateVP)),_n(1),jr("ngIf",!t.hasUserVCPerm(t.permVC.CreateVP)),_n(4),jr("ngIf",t.hasUserVCPerm(t.permVC.ManagePerm)),_n(1),jr("ngIf",!t.hasUserVCPerm(t.permVC.ManagePerm)),_n(7),jr("ngIf",t.hasUserVPPerm(t.permVP.View)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.View)),_n(4),jr("ngIf",t.hasUserVPPerm(t.permVP.ViewAudit)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.ViewAudit)),_n(4),jr("ngIf",t.hasUserVPPerm(t.permVP.Modify)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.Modify)),_n(4),jr("ngIf",t.hasUserVPPerm(t.permVP.CreateVariant)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.CreateVariant)),_n(4),jr("ngIf",t.hasUserVPPerm(t.permVP.ManagePerm)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.ManagePerm)),_n(4),jr("ngIf",t.hasUserVPPerm(t.permVP.DeleteVP)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.DeleteVP)),_n(5),jr("ngForOf",t.vgUsers)}}function QO(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"h3"),mo(2,"Visbo Center: "),Nr(3,"a",1),Jr("click",(function(){ei(t);const e=Xr();return e.gotoVPList(e.visbocenter)})),mo(4),Ua(5,"uppercase"),Fr(),Fr(),Nr(6,"form"),Nr(7,"div",2),Nr(8,"label",3),mo(9,"Name:"),Fr(),Lr(10,TU,1,1,"input",4),Lr(11,_U,2,1,"label",5),Fr(),Nr(12,"div",2),Nr(13,"label",6),mo(14,"Description:"),Fr(),Lr(15,UU,1,1,"textarea",7),Lr(16,OU,2,1,"label",8),Fr(),Nr(17,"div",2),Nr(18,"label",9),mo(19,"Created / Updated at:"),Fr(),Nr(20,"label",10),mo(21),Ua(22,"date"),Fr(),Nr(23,"label",11),mo(24),Ua(25,"date"),Fr(),Fr(),Fr(),Nr(26,"div",12),Lr(27,EU,2,0,"button",13),Lr(28,LU,2,0,"button",14),Lr(29,GU,2,0,"button",15),Fr(),Lr(30,FU,20,3,"div",0),Lr(31,QU,23,2,"div",0),Lr(32,WU,2,0,"button",16),Lr(33,JU,2,0,"button",16),Nr(34,"button",17),Jr("click",(function(){return ei(t),Xr().goBack()})),mo(35,"go back"),Fr(),Lr(36,YU,2,0,"button",18),Lr(37,ZU,2,0,"button",19),Nr(38,"div",20),Nr(39,"div",21),Nr(40,"div",22),Nr(41,"div",23),Nr(42,"h5",24),mo(43,"Add a new User to the Visbo Center"),Fr(),Nr(44,"button",25),Nr(45,"span",26),mo(46,"\xd7"),Fr(),Fr(),Fr(),Nr(47,"div",27),Nr(48,"form",28,29),Nr(50,"div",30),Nr(51,"label",31),mo(52,"Name:"),Fr(),Nr(53,"input",32,33),Jr("ngModelChange",(function(e){return ei(t),Xr().newUserInvite.email=e})),Fr(),Lr(55,XU,2,0,"div",34),Fr(),Nr(56,"div",30),Nr(57,"label",35),mo(58,"Group:"),Fr(),Nr(59,"select",36,37),Jr("ngModelChange",(function(e){return ei(t),Xr().newUserInvite.groupName=e})),Br(61,"option"),Lr(62,tO,2,1,"option",38),Fr(),Lr(63,eO,2,0,"div",34),Fr(),Nr(64,"div",30),Nr(65,"label",39),mo(66,"Message:"),Fr(),Nr(67,"textarea",40,41),Jr("ngModelChange",(function(e){return ei(t),Xr().newUserInvite.inviteMessage=e})),mo(69," "),Fr(),Fr(),Lr(70,iO,2,0,"div",34),Nr(71,"div",42),Lr(72,nO,2,0,"button",43),Lr(73,sO,2,0,"button",44),Nr(74,"button",45),mo(75,"Cancel"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr(),Fr(),Nr(76,"div",46),Lr(77,rO,33,3,"div",47),Fr(),Nr(78,"div",48),Lr(79,vO,58,18,"div",47),Fr(),Nr(80,"div",49),Lr(81,bO,33,3,"div",47),Fr(),Nr(82,"div",50),Nr(83,"div",21),Nr(84,"div",22),Nr(85,"div",23),Nr(86,"h5",51),mo(87,"Delete this Visbo Center"),Fr(),Nr(88,"button",25),Nr(89,"span",26),mo(90,"\xd7"),Fr(),Fr(),Fr(),Nr(91,"div",27),Nr(92,"div"),Lr(93,yO,2,0,"label",52),Lr(94,CO,2,0,"label",53),Fr(),Nr(95,"form"),Nr(96,"div",42),Nr(97,"label",54),mo(98,"Name:"),Fr(),Nr(99,"label",55),mo(100),Fr(),Fr(),Nr(101,"div",42),Nr(102,"label",56),mo(103,"Description:"),Fr(),Nr(104,"label",55),mo(105),Fr(),Fr(),Nr(106,"div",42),Nr(107,"label",57),mo(108,"Projects:"),Fr(),Nr(109,"label",55),mo(110),Fr(),Fr(),Fr(),Fr(),Nr(111,"div",58),Nr(112,"button",59),mo(113,"Close"),Fr(),Lr(114,VO,2,0,"button",60),Lr(115,wO,2,0,"button",61),Fr(),Fr(),Fr(),Fr(),Lr(116,zO,76,24,"div",62),Fr()}if(2&t){const t=Gr(49),e=Gr(54),i=Gr(60),n=Gr(68),s=Xr();_n(4),fo(Oa(5,39,s.visbocenter.name)),_n(6),jr("ngIf",s.hasVCPerm(s.permVC.Modify)),_n(1),jr("ngIf",!s.hasVCPerm(s.permVC.Modify)),_n(4),jr("ngIf",s.hasVCPerm(s.permVC.Modify)),_n(1),jr("ngIf",!s.hasVCPerm(s.permVC.Modify)),_n(5),vo("",Ea(22,41,s.visbocenter.createdAt,"dd.MM.yyyy HH:mm:ss")," "),_n(3),vo("",Ea(25,44,s.visbocenter.updatedAt,"dd.MM.yyyy HH:mm:ss")," "),_n(3),jr("ngIf",s.hasVCPerm(s.permVC.ViewAudit)),_n(1),jr("ngIf",!s.showGroups),_n(1),jr("ngIf",s.showGroups),_n(1),jr("ngIf",!s.showGroups),_n(1),jr("ngIf",s.showGroups),_n(1),jr("ngIf",!s.deleted&&s.hasVCPerm(s.permVC.Modify)),_n(1),jr("ngIf",s.deleted&&s.hasSystemPerm(s.permSystem.DeleteVC)),_n(3),jr("ngIf",!s.deleted&&s.hasSystemPerm(s.permSystem.DeleteVC)),_n(1),jr("ngIf",s.deleted&&s.hasSystemPerm(s.permSystem.DeleteVC)),_n(13),jr("ngClass",ka(47,fO,t.submitted&&!e.valid)),_n(3),jr("ngModel",s.newUserInvite.email),_n(2),jr("ngIf",t.submitted&&!e.valid),_n(1),jr("ngClass",ka(49,fO,t.submitted&&!i.valid)),_n(3),jr("ngModel",s.newUserInvite.groupName),_n(3),jr("ngForOf",s.vgGroups),_n(1),jr("ngIf",t.submitted&&!i.valid),_n(1),jr("ngClass",ka(51,fO,t.submitted&&!n.valid)),_n(3),jr("ngModel",s.newUserInvite.inviteMessage),_n(3),jr("ngIf",t.submitted&&!n.valid),_n(2),jr("ngIf",!(e.valid&&i.valid)),_n(1),jr("ngIf",e.valid&&i.valid),_n(4),jr("ngIf",s.userIndex>=0&&s.userIndex<s.vgUsers.length),_n(2),jr("ngIf",s.actGroup),_n(2),jr("ngIf",s.groupIndex>=0&&s.groupIndex<s.vgGroups.length),_n(12),jr("ngIf",!s.deleted),_n(1),jr("ngIf",s.deleted),_n(6),vo("",s.visbocenter.name," "),_n(5),vo("",s.visbocenter.description," "),_n(5),vo("",s.visbocenter.vpCount," "),_n(4),jr("ngIf",!s.deleted),_n(1),jr("ngIf",s.deleted),_n(1),jr("ngIf",s.vgUsers&&s.userIndex>=0)}}let WO=(()=>{class t{constructor(t,e,i,n,s,r){this.messageService=t,this.visbocenterService=e,this.route=i,this.location=n,this.router=s,this.alertService=r,this.newUserInvite=new Zh,this.permSystem=Mv,this.permVC=Iv,this.permVP=Sv,this.deleted=!1,this.sortUserColumn=1,this.sortUserAscending=!0,this.sortGroupColumn=1,this.sortGroupAscending=!0}ngOnInit(){this.log("SysVisboCenter Init: "+JSON.stringify(this.visbocenter)),this.deleted=!!this.route.snapshot.queryParams.deleted,this.getVisboCenter(),this.getVisboCenterUsers(),this.combinedPerm=this.visbocenterService.getSysAdminRole()}getVisboCenter(){const t=this.route.snapshot.paramMap.get("id");this.log(`VisboCenter Detail of: ${t} Deleted ${this.deleted}`),this.visbocenterService.getVisboCenter(t,!0,this.deleted).subscribe(t=>{this.visbocenter=t,this.combinedPerm=t.perm},t=>{this.log(`Get VC failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(403===t.status?"Permission Denied":Gh(t))})}hasSystemPerm(t){return(this.combinedPerm.system&t)>0}hasVCPerm(t){return(this.combinedPerm.vc&t)>0}hasVPPerm(t){return(this.combinedPerm.vp&t)>0}hasUserVCPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vc&t)>0}hasUserVPPerm(t){return void 0!==this.combinedUserPerm&&(this.combinedUserPerm.vp&t)>0}getVisboCenterUsers(){const t=this.route.snapshot.paramMap.get("id");this.log(`VisboCenter UserList of ${t} Deleted ${this.deleted}`),this.visbocenterService.getVCUsers(t,!0,this.deleted).subscribe(t=>{this.vgUsers=t.users,this.vgGroups=t.groups,this.log(`fetched Users ${this.vgUsers.length}, Groups ${this.vgGroups.length}`),this.sortUserTable(),this.sortGroupTable()},t=>{this.log(`Get VC Users failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(403===t.status?"Permission Denied":Gh(t))})}gotoVCAudit(t){this.log(`GoTo VC Audit ${t.name} ${this.visbocenter.name}`);const e=this.deleted?{sysadmin:1,deleted:1}:{sysadmin:1};this.log(`GoTo VC Audit ${t.name} ${this.visbocenter.name} ${JSON.stringify(e)}`),this.router.navigate(["vcAudit/".concat(t._id)],{queryParams:e})}gotoVPList(t){this.log("GoTo VP List "+JSON.stringify(this.combinedPerm)),this.hasVPPerm(this.permVP.View)&&this.router.navigate(["sysvp/".concat(t._id)])}goBack(){this.location.back()}save(){this.log(`PUT VC: ${this.visbocenter.name} ID: ${this.visbocenter._id} Deleted: ${this.deleted}`),this.visbocenterService.updateVisboCenter(this.visbocenter,!0,this.deleted).subscribe(t=>{this.alertService.success(`Visbo Center ${t.name} updated successfully`,!0),this.goBack()},t=>{this.log(`save VC failed: error: ${t.status} message: ${t.error.message} `),this.alertService.error(403===t.status?"Permission Denied: Visbo Center "+this.visbocenter.name:409===t.status?`Visbo Center ${this.visbocenter.name} exists already`:Gh(t))})}delete(t){this.log(`Delete VC: ${t.name} ID: ${t._id} Deleted: ${this.deleted}`),this.visbocenterService.deleteVisboCenter(t,!0,this.deleted).subscribe(()=>{this.alertService.success(`Visbo Center ${t.name} deleted successfully`,!0),this.deleted?this.router.navigate(["sysvc"]):this.goBack()},e=>{this.log(`delete VC failed: error: ${e.status} message: ${e.error.message}`),this.alertService.error(403===e.status?"Permission Denied: Visbo Center "+t.name:Gh(e))})}toggleUserGroup(){this.showGroups=!this.showGroups}addNewVCUser(){const t=this.newUserInvite.email.trim(),e=this.newUserInvite.groupName.trim(),i=this.vgGroups.filter(t=>t.name===e)[0]._id,n=this.visbocenter._id;let s="";this.newUserInvite.inviteMessage&&(s=this.newUserInvite.inviteMessage.trim()),this.log(`Add VisboCenter User: ${t} Group: ${e}/${i} VC: ${n}`),t&&i&&this.visbocenterService.addVCUser(t,i,s,n,!0).subscribe(e=>{const i=new _v;i.userId=e.users.filter(e=>e.email===t)[0].userId,i.email=t,i.groupId=e._id,i.groupName=e.name,this.log("Add VisboCenter User Push: "+JSON.stringify(i)),this.vgUsers.push(i),this.sortUserTable();for(let t=0;t<this.vgGroups.length;t++)if(this.vgGroups[t]._id===e._id){this.vgGroups[t]=e;break}this.alertService.success(`User ${t} added successfully`)},t=>{this.log("Add VisboCenter User error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Add User to Visbo Center"):(this.log("Error during add VC user "+t.error.message),this.alertService.error(Gh(t)))})}helperUserIndex(t){this.userIndex=t}calcCombinedPerm(t){this.userIndex=t,this.combinedUserPerm={system:0,vc:0,vp:0},this.vgUsers.forEach(this.addUserPerm,this),this.log(`Combined Permission for ${this.vgUsers[t].email}  ${JSON.stringify(this.combinedUserPerm)}`)}addUserPerm(t){if(t.email!==this.vgUsers[this.userIndex].email)return;this.log("Add User Permission for "+t.groupName);const e=this.vgGroups.findIndex(e=>e.name===t.groupName);e>=0?this.vgGroups[e].permission?(this.combinedUserPerm.system=this.combinedUserPerm.system|(this.vgGroups[e].permission.system||0),this.combinedUserPerm.vc=this.combinedUserPerm.vc|(this.vgGroups[e].permission.vc||0),this.combinedUserPerm.vp=this.combinedUserPerm.vp|(this.vgGroups[e].permission.vp||0)):this.log("Permission for Group not set "+t.groupName):this.log("Group not found "+t.groupName)}helperRemoveGroup(t){this.groupIndex=t}helperUsersPerGroup(t){const e=this.vgGroups&&this.vgGroups.find(e=>e.name===t);return e?e.users.length:0}removeVCUser(t,e){this.log(`Remove VisboCenter User: ${t.email}/${t.userId} Group: ${t.groupName} VC: ${e}`),this.visbocenterService.deleteVCUser(t,e,!0).subscribe(()=>{this.vgUsers=this.vgUsers.filter(e=>e!==t);for(let e=0;e<this.vgGroups.length;e++)if(this.vgGroups[e]._id===t.groupId){for(let i=0;i<this.vgGroups[e].users.length;i++)if(this.vgGroups[e].users[i].userId===t.userId){this.vgGroups[e].users.splice(i,1);break}break}this.alertService.success(`User ${t.email} removed successfully`)},t=>{this.log("Remove VisboCenter User error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Remove User from Visbo Center"):(this.log("Error during remove VC user "+t.error.message),this.alertService.error(Gh(t)))})}helperVCPerm(t){let e=0;return t.checkedView&&(e+=this.permVC.View),t.checkedViewAudit&&(e+=this.permVC.ViewAudit),t.checkedModify&&(e+=this.permVC.Modify),t.checkedCreateVP&&(e+=this.permVC.CreateVP),t.checkedManagePerm&&(e+=this.permVC.ManagePerm),e}helperVPPerm(t){let e=0;return t.checkedVPView&&(e+=this.permVP.View),t.checkedVPViewAudit&&(e+=this.permVP.ViewAudit),t.checkedVPModify&&(e+=this.permVP.Modify),t.checkedCreateVariant&&(e+=this.permVP.CreateVariant),t.checkedVPManagePerm&&(e+=this.permVP.ManagePerm),t.checkedVPDelete&&(e+=this.permVP.DeleteVP),e}activateGroup(t){this.log("Activate Group : "+t.groupName);const e=this.vgGroups.find(e=>e.name==t.groupName);this.initGroup(e)}activateUser(t){this.log("Activate User : "+t.email);const e=this.vgUsers.findIndex(e=>e.email==t.email);e>=0&&this.calcCombinedPerm(e)}initGroup(t){this.actGroup=new Tv,t?(this.confirm="Modify",this.actGroup._id=t._id,this.log(`Init Group Set GroupID : ${this.actGroup._id} ID ${t._id}`),this.actGroup.name=t.name,this.actGroup.global=t.global,this.actGroup.checkedView=(t.permission.vc&this.permVC.View)>0,this.actGroup.checkedViewAudit=(t.permission.vc&this.permVC.ViewAudit)>0,this.actGroup.checkedModify=(t.permission.vc&this.permVC.Modify)>0,this.actGroup.checkedCreateVP=(t.permission.vc&this.permVC.CreateVP)>0,this.actGroup.checkedManagePerm=(t.permission.vc&this.permVC.ManagePerm)>0,this.actGroup.checkedVPView=(t.permission.vp&this.permVP.View)>0,this.actGroup.checkedVPViewAudit=(t.permission.vp&this.permVP.ViewAudit)>0,this.actGroup.checkedVPModify=(t.permission.vp&this.permVP.Modify)>0,this.actGroup.checkedCreateVariant=(t.permission.vp&this.permVP.CreateVariant)>0,this.actGroup.checkedVPManagePerm=(t.permission.vp&this.permVP.ManagePerm)>0,this.actGroup.checkedVPDelete=(t.permission.vp&this.permVP.DeleteVP)>0):(this.confirm="Add",this.actGroup._id=void 0,this.actGroup.name="",this.actGroup.global=!1,this.actGroup.checkedView=!0),this.log(`Init Group for Creation / Modification: ${this.actGroup.name} ID ${this.actGroup._id}`)}addModifyVCGroup(){const t=new xv;t.name=this.actGroup.name.trim(),t.global=this.actGroup.global,t.vcid=this.visbocenter._id,t.permission=new Dv,t.permission.vc=this.helperVCPerm(this.actGroup),t.permission.vp=this.helperVPPerm(this.actGroup),this.log(`Add/Modify VisboCenter Group: Group: ${t.name} New/Modify ${this.actGroup._id}`),this.actGroup._id?(this.log(`Modify VisboCenter Group: Group: ${t.name} VC: ${t.vcid} Perm: vc ${t.permission.vc} vp ${t.permission.vp}`),t._id=this.actGroup._id,this.visbocenterService.modifyVCGroup(t,!0).subscribe(e=>{this.vgGroups=this.vgGroups.filter(e=>e._id!==t._id),this.vgGroups.push(e);for(let i=0;i<this.vgUsers.length;i++)this.vgUsers[i].groupId===t._id&&(this.vgUsers[i].groupName=e.name);this.sortUserTable(),this.sortGroupTable(),this.alertService.success(`Group ${e.name} changed successfully`)},t=>{this.log("Modify VisboCenter Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Modify Group to Visbo Center"):(this.log("Error during add VC Group "+t.error.message),this.alertService.error(Gh(t)))})):(this.log(`Add VisboCenter Group: Group: ${t.name} VC: ${t.vcid} Perm: vc ${t.permission.vc} vp ${t.permission.vp}`),this.visbocenterService.addVCGroup(t,!0).subscribe(t=>{this.vgGroups.push(t),this.alertService.success(`Group ${t.name} added successfully`)},t=>{this.log("Add VisboCenter Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Add Group to Visbo Center"):(this.log("Error during add VC Group "+t.error.message),this.alertService.error(Gh(t)))}))}removeVCGroup(t){this.log(`Remove VisboCenter Group: ${t.name}/${t._id} VC: ${t.vcid}`),this.visbocenterService.deleteVCGroup(t,!0).subscribe(e=>{this.log("Remove VisboCenter Group result: "+JSON.stringify(e)),this.vgGroups=this.vgGroups.filter(e=>e!==t),this.vgUsers=this.vgUsers.filter(e=>e.groupId!==t._id),this.alertService.success(`Group ${t.name} removed successfully`)},t=>{this.log("Remove VisboCenter Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Remove Group from Visbo Center"):(this.log("Error during remove VC user "+t.error.message),this.alertService.error(Gh(t)))})}sortUserTable(t){this.vgUsers&&(void 0===t&&void 0!==this.sortUserColumn||(t!==this.sortUserColumn&&(this.sortUserColumn=t,this.sortUserAscending=void 0),this.sortUserAscending=void 0===this.sortUserAscending?1===t||2===t:!this.sortUserAscending),1===this.sortUserColumn?this.vgUsers.sort((function(t,e){return xh(t.email,e.email)})):2===this.sortUserColumn&&this.vgUsers.sort((function(t,e){return xh(t.groupName.toLowerCase(),e.groupName.toLowerCase())})),this.sortUserAscending||this.vgUsers.reverse())}sortGroupTable(t){this.vgGroups&&(void 0===t&&void 0!==this.sortGroupColumn||(t!==this.sortGroupColumn&&(this.sortGroupColumn=t,this.sortGroupAscending=void 0),this.sortGroupAscending=void 0===this.sortGroupAscending?1===t:!this.sortGroupAscending),1===this.sortGroupColumn?this.vgGroups.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortGroupColumn&&this.vgGroups.sort((function(t,e){return e.users.length-t.users.length})),this.sortGroupAscending||this.vgGroups.reverse())}log(t){this.messageService.add("Sys VisboCenter Details: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(Ev),Rr(Bg),Rr(Xl),Rr(rf),Rr(Mf))},t.\u0275cmp=le({type:t,selectors:[["app-sysvisbocenter-detail"]],inputs:{visbocenter:"visbocenter"},decls:2,vars:1,consts:[[4,"ngIf"],[3,"click"],[1,"form-group","row"],["for","vcName",1,"col-4","col-md-3","col-form-label"],["id","VCName","type","text","name","vcName","class","col-sm-8 form-control","placeholder","Name",3,"ngModel","ngModelChange",4,"ngIf"],["id","VCName","class","col-8 form-control-static",4,"ngIf"],["for","vcDescription",1,"col-4","col-md-3","col-form-label"],["id","VCDesc","name","vcDescription","class","col-8 form-control","placeholder","Type in your description",3,"ngModel","ngModelChange",4,"ngIf"],["id","VCDesc","class","col-8 form-control-static",4,"ngIf"],["for","Created",1,"col-4","col-md-3","col-form-label"],["id","VCCreated",1,"col","form-control-static","col-form-label"],["id","VCUpdated",1,"col","form-control-static","col-form-label"],[1,"btn-toolbar"],["id","ViewAudit","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewGroup","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewUser","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","Save","class","btn btn-primary mx-1",3,"click",4,"ngIf"],["id","Save",1,"btn","btn-secondary","mx-1",3,"click"],["id","DeleteVC","class","btn btn-md mx-1 bg-warning","style","float: right","title","Delete Visbo Center","data-toggle","modal","data-target","#VcDelete",4,"ngIf"],["id","DestroyVC","class","btn btn-md mx-1 bg-danger text-white","style","float: right","title","Destroy Visbo Center","data-toggle","modal","data-target","#VcDelete",4,"ngIf"],["id","VcUserModalCreate","tabindex","-1","role","dialog","aria-labelledby","VcUserModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","VcUserModalCenterTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["name","newUserInvite","novalidate",""],["f","ngForm"],[1,"form-group",3,"ngClass"],["for","email",1,"col-form-label"],["id","AddUserName","type","email","name","email","required","","pattern","[^@\\s]+@[^@\\s]+\\.[^@\\s]+","autocomplete","email",1,"form-control",3,"ngModel","ngModelChange"],["email","ngModel"],["class","help-block",4,"ngIf"],["for","group",1,"col-form-label"],["id","AddUserGroupName","name","group","required","",1,"form-control",3,"ngModel","ngModelChange"],["group","ngModel"],[4,"ngFor","ngForOf"],["for","inviteMessage",1,"col-form-label"],["id","AddUserMessage","name","inviteMessage",1,"form-control",3,"ngModel","ngModelChange"],["inviteMessage","ngModel"],[1,"form-group"],["id","AddUserConfirm","type","submit","class","btn btn-primary mx-1",4,"ngIf"],["id","AddUserConfirm","type","submit","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-secondary","mx-1"],["id","VcUserRemove","tabindex","-1","role","dialog","aria-labelledby","VcUserModalRemoveTitle","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-dialog-centered","role","document",4,"ngIf"],["id","VcGroupModalCreate","tabindex","-1","role","dialog","aria-labelledby","VcGroupModalCreateTitle","aria-hidden","true",1,"modal","fade"],["id","VcGroupRemove","tabindex","-1","role","dialog","aria-labelledby","VcGroupModalRemoveTitle","aria-hidden","true",1,"modal","fade"],["id","VcDelete","tabindex","-1","role","dialog","aria-labelledby","Delete Visbo Center","aria-hidden","true",1,"modal","fade"],["id","VcDeleteTitle",1,"modal-title"],["class","bg-warning",4,"ngIf"],["class","bg-danger text-white",4,"ngIf"],[1,"col-form-label"],[1,"col-8","form-control-static"],["for","VcDescription",1,"col-form-label"],["for","VcProjects",1,"col-form-label"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary","mx-1"],["id","DeleteVCConfirm","type","button","class","btn btn-warning text-white mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","DeleteVCConfirm","type","button","class","btn btn-danger text-white mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["class","modal fade","id","VCUserDetail","tabindex","-1","role","dialog","aria-labelledby","VCUserDetailTitle","aria-hidden","true",4,"ngIf"],["id","VCName","type","text","name","vcName","placeholder","Name",1,"col-sm-8","form-control",3,"ngModel","ngModelChange"],["id","VCName",1,"col-8","form-control-static"],["id","VCDesc","name","vcDescription","placeholder","Type in your description",1,"col-8","form-control",3,"ngModel","ngModelChange"],["id","VCDesc",1,"col-8","form-control-static"],["id","ViewAudit","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],["id","ViewGroup","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],["id","ViewUser","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],[1,"row"],[1,"col"],[1,"panel-heading"],["class","col",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover"],["id","UserHead"],["id","UserList"],["id","AddUser","type","button","data-toggle","modal","data-target","#VcUserModalCreate",1,"btn","btn-primary","float-right","my-1"],["id","ColUser","data-toggle","modal","data-target","#VCUserDetail",3,"click"],["id","ColGroup"],["id","ColDeleteUser","title","Remove User","data-toggle","modal","data-target","#VcUserRemove",1,"Detail",3,"click"],["id","GroupHead"],["id","GroupList"],["id","ColGroup","data-toggle","modal","data-target","#VcGroupModalCreate",3,"click"],["id","ColMembers"],["id","ColGlobal",4,"ngIf"],["id","ColDetail","title","Detail of Group","data-toggle","modal","data-target","#VcGroupModalCreate",1,"Detail",3,"click"],["id","ColGlobal"],["id","ColDeleteGroup","title","Remove Group","data-toggle","modal","data-target","#VcGroupRemove",1,"Detail",3,"click"],["id","Save",1,"btn","btn-primary","mx-1",3,"click"],["id","DeleteVC","title","Delete Visbo Center","data-toggle","modal","data-target","#VcDelete",1,"btn","btn-md","mx-1","bg-warning",2,"float","right"],["id","DestroyVC","title","Destroy Visbo Center","data-toggle","modal","data-target","#VcDelete",1,"btn","btn-md","mx-1","bg-danger","text-white",2,"float","right"],[1,"help-block"],["id","AddUserConfirm","type","submit",1,"btn","btn-primary","mx-1"],["id","AddUserConfirm","type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["id","VcUserRemoveTitle",1,"modal-title"],[1,"bg-warning"],["id","DeleteUserConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning","mx-1",3,"click"],["class","modal-title","id","VcGroupModalCenterTitle",4,"ngIf"],["name","actGroup","novalidate",""],["for","name",1,"col-form-label"],["id","AddGroupName","type","text","name","name","required","",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","perm1","name","checkedView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedView","ngModel"],["for","perm1",1,"custom-control-label"],["type","checkbox","id","perm2","name","checkedViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedViewAudit","ngModel"],["for","perm2",1,"custom-control-label"],["type","checkbox","id","perm3","name","checkedModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedModify","ngModel"],["for","perm3",1,"custom-control-label"],["type","checkbox","id","perm4","name","checkedCreateVP",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVP","ngModel"],["for","perm4",1,"custom-control-label"],["type","checkbox","id","perm5","name","checkedManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedManagePerm","ngModel"],["for","perm5",1,"custom-control-label"],["type","checkbox","id","global","name","global",1,"custom-control-input",3,"ngModel","ngModelChange"],["global","ngModel"],["for","global",1,"custom-control-label"],["class","mt-2",4,"ngIf"],[1,"form-group","mt-2"],["id","AddGroupConfirm","type","submit","class","btn btn-primary disabled mx-1",4,"ngIf"],["id","AddGroupConfirm","type","submit","class","btn btn-primary mx-1","data-dismiss","modal",3,"click",4,"ngIf"],["id","VcGroupModalCenterTitle",1,"modal-title"],["type","checkbox","id","permVP1","name","checkedVPView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPView","ngModel"],["for","permVP1",1,"custom-control-label"],["type","checkbox","id","permVP2","name","checkedVPViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPViewAudit","ngModel"],["for","permVP2",1,"custom-control-label"],["type","checkbox","id","permVP3","name","checkedVPModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPModify","ngModel"],["for","permVP3",1,"custom-control-label"],["type","checkbox","id","permVP4","name","checkedCreateVariant",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVariant","ngModel"],["for","permVP4",1,"custom-control-label"],["type","checkbox","id","permVP5","name","checkedVPManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPManagePerm","ngModel"],["for","permVP5",1,"custom-control-label"],["type","checkbox","id","permVP6","name","checkedVPDelete",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPDelete","ngModel"],["for","permVP6",1,"custom-control-label"],[1,"mt-2"],[1,"form-control-static"],["class","row",4,"ngFor","ngForOf"],["class","col-8 ml-3",4,"ngIf"],[1,"col-8","ml-3"],["data-dismiss","modal","data-toggle","modal","data-target","#VCUserDetail",3,"click"],["id","AddGroupConfirm","type","submit",1,"btn","btn-primary","disabled","mx-1"],["id","AddGroupConfirm","type","submit","data-dismiss","modal",1,"btn","btn-primary","mx-1",3,"click"],["id","DeleteGroupConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning","mx-1",3,"click"],[1,"bg-danger","text-white"],["id","DeleteVCConfirm","type","button","data-dismiss","modal",1,"btn","btn-warning","text-white","mx-1",3,"click"],["id","DeleteVCConfirm","type","button","data-dismiss","modal",1,"btn","btn-danger","text-white","mx-1",3,"click"],["id","VCUserDetail","tabindex","-1","role","dialog","aria-labelledby","VCUserDetailTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],["id","VCUserDetailTitle",1,"modal-title"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","perm5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","perm5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],[1,"form-control-static","mt-2"],["id","ButtonBack","data-dismiss","modal",1,"btn","btn-primary"],["type","checkbox","checked","","disabled","","id","perm1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","perm5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","perm5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["data-dismiss","modal","data-toggle","modal","data-target","#VcGroupModalCreate",3,"click"]],template:function(t,e){1&t&&(Br(0,"app-sysnavbar"),Lr(1,QO,117,53,"div",0)),2&t&&(_n(1),jr("ngIf",e.visbocenter))},directives:[CC,jc,Eu,Fd,Tu,Ec,Ed,Ru,Hu,Nd,Ou,cu,du,gu,Gc,_d],pipes:[Kc,qc],styles:[""]}),t})();function JO(t,e){1&t&&(Nr(0,"h2"),mo(1," Projects "),Fr())}function YO(t,e){if(1&t){const t=zr();Nr(0,"h2"),mo(1," Projects in: "),Nr(2,"a",15),Jr("click",(function(){ei(t);const e=Xr();return e.gotoVCDetail(e.vcActive)})),mo(3),Fr(),Fr()}if(2&t){const t=Xr();_n(3),fo(t.vcActive.name)}}function ZO(t,e){if(1&t&&(Nr(0,"td",24),mo(1),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(t.vc.name)}}function XO(t,e){1&t&&Br(0,"td",24)}function tE(t,e){if(1&t){const t=zr();Nr(0,"tr",15),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr().gotoClickedRow(i)})),Nr(1,"td",7),mo(2),Fr(),Nr(3,"td",16),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr().gotoDetail(i)})),Nr(4,"a"),mo(5),Fr(),Fr(),Nr(6,"td",17),mo(7),Fr(),Nr(8,"td",18),mo(9),Ua(10,"date"),Fr(),Nr(11,"td",19),mo(12),Ua(13,"date"),Fr(),Nr(14,"td",20),mo(15),Fr(),Lr(16,ZO,2,1,"td",21),Lr(17,XO,1,0,"td",21),Nr(18,"td",22),Nr(19,"button",23),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr().gotoDetail(i)})),mo(20,"i"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit,i=e.index,n=Xr();_n(2),fo(i+1),_n(3),fo(t.name),_n(2),fo(n.getVPType(t.vpType)),_n(2),fo(Ea(10,8,t.updatedAt,"dd.MM.yyyy HH:mm")),_n(3),fo(Ea(13,11,t.updatedAt,"dd.MM.yy")),_n(3),fo(t.vpvCount),_n(1),jr("ngIf",t.vc),_n(1),jr("ngIf",!t.vc)}}let eE=(()=>{class t{constructor(t,e,i,n,s,r,o){this.messageService=t,this.alertService=e,this.visboprojectService=i,this.visbocenterService=n,this.route=s,this.router=r,this.translate=o,this.combinedPerm=void 0,this.permVC=Iv,this.permVP=Sv}ngOnInit(){this.getVisboProjects(),this.combinedPerm=this.visbocenterService.getSysAdminRole()}getVisboProjects(){this.log("VP getSysVisboProjects SysAdminRole "+JSON.stringify(this.combinedPerm));const t=this.route.snapshot.paramMap.get("id");this.vcSelected=t,t?this.visbocenterService.getVisboCenter(t,!0).subscribe(e=>{this.vcActive=e,this.combinedPerm=e.perm,this.log(`Get VisboProject for VC ${t} Perm ${JSON.stringify(this.combinedPerm)}`),this.combinedPerm.vp&this.permVP.View?this.visboprojectService.getVisboProjects(t,!0).subscribe(t=>{this.visboprojects=t,this.sortVPTable(1)},t=>{this.log(`get VPs failed: error:  ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))}):this.visboprojects=[]},t=>{this.log(`get VC failed: error:  ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))}):(this.vcSelected=null,this.vcActive=null,this.visboprojectService.getVisboProjects(null,!0).subscribe(t=>{this.visboprojects=t,this.sortVPTable(1)},t=>{this.log(`get VPs all failed: error:  ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))}))}getVPType(t){return this.translate.instant("vp.type.vpType"+t)}gotoClickedRow(t){this.log("clicked row "+t.name)}gotoDetail(t){this.router.navigate(["sysvpDetail/".concat(t._id)])}gotoVCDetail(t){this.router.navigate(["sysvcDetail/".concat(t._id)])}sortVPTable(t){this.visboprojects&&(void 0!==t&&(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t||3===t:!this.sortAscending),1===this.sortColumn?this.visboprojects.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortColumn?this.visboprojects.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})):3===this.sortColumn?this.visboprojects.sort((function(t,e){return xh(t.vc.name.toLowerCase(),e.vc.name.toLowerCase())})):4===this.sortColumn&&this.visboprojects.sort((function(t,e){return t.vpvCount-e.vpvCount})),this.sortAscending||this.visboprojects.reverse())}log(t){this.messageService.add("VisboProject: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(Mf),Rr(Vb),Rr(Ev),Rr(Bg),Rr(rf),Rr(av))},t.\u0275cmp=le({type:t,selectors:[["app-sysvisboprojects"]],decls:26,vars:3,consts:[[1,"well"],[1,"row"],[1,"col"],[4,"ngIf"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],["id","VPHead"],[1,"d-none","d-md-table-cell"],["id","SortName",3,"click"],["id","SortType"],["id","SortDate",1,"d-none","d-sm-table-cell",3,"click"],["id","SortVersions",1,"d-none","d-md-table-cell",3,"click"],["id","SortVC",1,"d-none","d-lg-table-cell",3,"click"],["id","VPList"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["id","ColName",3,"click"],["id","ColType",1,"d-none","d-md-table-cell"],["id","ColDate",1,"d-none","d-lg-table-cell"],["id","ColDate",1,"d-none","d-md-table-cell","d-lg-none"],["id","ColVersions",1,"d-none","d-md-table-cell"],["id","ColVC","class","d-none d-lg-table-cell",4,"ngIf"],["id","ColDetail"],["title","Detail of Visbo Project",1,"Detail",3,"click"],["id","ColVC",1,"d-none","d-lg-table-cell"]],template:function(t,e){1&t&&(Br(0,"app-sysnavbar"),Nr(1,"div",0),Nr(2,"div",1),Nr(3,"div",2),Lr(4,JO,2,0,"h2",3),Lr(5,YO,4,1,"h2",3),Fr(),Fr(),Nr(6,"div",4),Nr(7,"table",5),Nr(8,"thead",6),Nr(9,"tr"),Nr(10,"th",7),mo(11,"Nr."),Fr(),Nr(12,"th",8),Jr("click",(function(){return e.sortVPTable(1)})),mo(13,"Name"),Fr(),Nr(14,"th",9),mo(15,"Type"),Fr(),Nr(16,"th",10),Jr("click",(function(){return e.sortVPTable(2)})),mo(17,"Modified"),Fr(),Nr(18,"th",11),Jr("click",(function(){return e.sortVPTable(4)})),mo(19,"# Versions"),Fr(),Nr(20,"th",12),Jr("click",(function(){return e.sortVPTable(3)})),mo(21,"Visbo Center"),Fr(),Nr(22,"th"),mo(23,"Info"),Fr(),Fr(),Fr(),Nr(24,"tbody",13),Lr(25,tE,21,14,"tr",14),Fr(),Fr(),Fr(),Fr()),2&t&&(_n(4),jr("ngIf",!e.vcActive),_n(1),jr("ngIf",e.vcActive),_n(20),jr("ngForOf",e.visboprojects))},directives:[CC,jc,Gc],pipes:[qc],encapsulation:2}),t})();function iE(t,e){if(1&t){const t=zr();Nr(0,"button",17),Jr("click",(function(){ei(t);const e=Xr(2);return e.gotoVPAudit(e.visboproject)})),mo(1,"View Audit"),Fr()}}function nE(t,e){if(1&t){const t=zr();Nr(0,"button",18),Jr("click",(function(){return ei(t),Xr(2).toggleUserGroup()})),mo(1,"Show Groups"),Fr()}}function sE(t,e){if(1&t){const t=zr();Nr(0,"button",19),Jr("click",(function(){return ei(t),Xr(2).toggleUserGroup()})),mo(1,"Show Users"),Fr()}}function rE(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td"),mo(2),Fr(),Nr(3,"td",28),Jr("click",(function(){ei(t);const i=e.index;return Xr(3).calcCombinedPerm(i)})),mo(4),Fr(),Nr(5,"td",29),mo(6),Fr(),Fr()}if(2&t){const t=e.$implicit,i=e.index;_n(2),fo(i+1),_n(2),fo(t.email),_n(2),fo(t.groupName)}}function oE(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div"),Nr(2,"div",20),Nr(3,"div",21),Nr(4,"h5",22),mo(5," Visbo Project Users "),Fr(),Fr(),Fr(),Nr(6,"div",23),Nr(7,"table",24),Nr(8,"thead",25),Nr(9,"tr"),Nr(10,"th"),mo(11,"Nr."),Fr(),Nr(12,"th",2),Jr("click",(function(){return ei(t),Xr(2).sortUserTable(1)})),mo(13,"e-mail"),Fr(),Nr(14,"th",2),Jr("click",(function(){return ei(t),Xr(2).sortUserTable(2)})),mo(15,"Group"),Fr(),Fr(),Fr(),Nr(16,"tbody",26),Lr(17,rE,7,3,"tr",27),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(17),jr("ngForOf",t.vgUsers)}}function aE(t,e){1&t&&(Nr(0,"td",35),mo(1,"Global"),Fr())}function lE(t,e){1&t&&Br(0,"td",35)}function cE(t,e){if(1&t){const t=zr();Nr(0,"tr"),Nr(1,"td"),mo(2),Fr(),Nr(3,"td",29),mo(4),Fr(),Nr(5,"td",32),mo(6),Fr(),Lr(7,aE,2,0,"td",33),Lr(8,lE,1,0,"td",33),Nr(9,"td"),Nr(10,"button",34),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr(3).initGroup(i)})),mo(11,"i"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit,i=e.index;_n(2),fo(i+1),_n(2),fo(t.name),_n(2),fo(t.users.length),_n(1),jr("ngIf",t.global),_n(1),jr("ngIf",!t.global)}}function dE(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div"),Nr(2,"div",20),Nr(3,"div",21),Nr(4,"h5",22),mo(5," Visbo Project Groups "),Fr(),Fr(),Fr(),Nr(6,"div",23),Nr(7,"table",24),Nr(8,"thead",30),Nr(9,"tr"),Nr(10,"th"),mo(11,"Nr."),Fr(),Nr(12,"th",2),Jr("click",(function(){return ei(t),Xr(2).sortGroupTable(1)})),mo(13,"Group"),Fr(),Nr(14,"th",2),Jr("click",(function(){return ei(t),Xr(2).sortGroupTable(2)})),mo(15,"Members"),Fr(),Nr(16,"th"),mo(17,"Flag"),Fr(),Nr(18,"th"),mo(19,"Info"),Fr(),Fr(),Fr(),Nr(20,"tbody",31),Lr(21,cE,12,5,"tr",27),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(21),jr("ngForOf",t.vgGroups)}}function uE(t,e){1&t&&(Nr(0,"h5",73),mo(1,"Modify a Group in the Visbo Center"),Fr())}function hE(t,e){1&t&&(Nr(0,"h5",73),mo(1,"Add a new Group to the Visbo Center"),Fr())}function pE(t,e){1&t&&(Nr(0,"div",74),mo(1,"Group Name is required"),Fr())}function gE(t,e){if(1&t){const t=zr();Nr(0,"div",79),Nr(1,"a",80),Jr("click",(function(){ei(t);const e=Xr().$implicit;return Xr(4).activateUser(e)})),mo(2),Fr(),Fr()}if(2&t){const t=Xr().$implicit;_n(2),fo(t.email)}}function mE(t,e){if(1&t&&(Hr(0,20),Lr(1,gE,3,1,"div",78),Kr()),2&t){const t=e.$implicit,i=Xr(4);_n(1),jr("ngIf",t.groupName==i.actGroup.name)}}function fE(t,e){if(1&t&&(Nr(0,"div",75),Nr(1,"label",76),mo(2,"Group Members"),Fr(),Lr(3,mE,2,1,"ng-container",77),Fr()),2&t){const t=Xr(3);_n(3),jr("ngForOf",t.vgUsers)}}function vE(t,e){1&t&&(Nr(0,"div",75),Nr(1,"label",76),mo(2,"No Group Members"),Fr(),Fr())}const bE=function(t){return{"has-error":t}};function yE(t,e){if(1&t){const t=zr();Nr(0,"div",36),Nr(1,"div",37),Nr(2,"div",38),Nr(3,"div",39),Lr(4,uE,2,0,"h5",40),Lr(5,hE,2,0,"h5",40),Nr(6,"button",41),Nr(7,"span",42),mo(8,"\xd7"),Fr(),Fr(),Fr(),Nr(9,"div",43),Nr(10,"form",44,45),Nr(12,"div",46),Nr(13,"label",47),mo(14,"Name:"),Fr(),Nr(15,"input",48,49),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.name=e})),Fr(),Lr(17,pE,2,0,"div",50),Fr(),Nr(18,"div"),Nr(19,"div"),mo(20,"Define Visbo Project Permission"),Fr(),Nr(21,"div",51),Nr(22,"input",52,53),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedVPView=e})),Fr(),Nr(24,"label",54),mo(25,"View Visbo Project"),Fr(),Fr(),Nr(26,"div",51),Nr(27,"input",55,56),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedVPViewAudit=e})),Fr(),Nr(29,"label",57),mo(30,"View Project Audit"),Fr(),Fr(),Nr(31,"div",51),Nr(32,"input",58,59),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedVPModify=e})),Fr(),Nr(34,"label",60),mo(35,"Modify Visbo Project"),Fr(),Fr(),Nr(36,"div",51),Nr(37,"input",61,62),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedCreateVariant=e})),Fr(),Nr(39,"label",63),mo(40,"Create Visbo Project Variant"),Fr(),Fr(),Nr(41,"div",51),Nr(42,"input",64,65),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedVPManagePerm=e})),Fr(),Nr(44,"label",66),mo(45,"Manage Permissions, Users and Groups"),Fr(),Fr(),Nr(46,"div",51),Nr(47,"input",67,68),Jr("ngModelChange",(function(e){return ei(t),Xr(2).actGroup.checkedVPDelete=e})),Fr(),Nr(49,"label",69),mo(50,"Delete Visbo Project"),Fr(),Fr(),Fr(),Lr(51,fE,4,1,"div",70),Lr(52,vE,3,0,"div",70),Nr(53,"div",71),Nr(54,"button",72),mo(55,"Cancel"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Gr(11),e=Gr(16),i=Xr(2);_n(4),jr("ngIf",i.actGroup._id),_n(1),jr("ngIf",!i.actGroup._id),_n(7),jr("ngClass",ka(13,bE,t.submitted&&!e.valid)),_n(3),jr("ngModel",i.actGroup.name),_n(2),jr("ngIf",t.submitted&&!e.valid),_n(5),jr("ngModel",i.actGroup.checkedVPView),_n(5),jr("ngModel",i.actGroup.checkedVPViewAudit),_n(5),jr("ngModel",i.actGroup.checkedVPModify),_n(5),jr("ngModel",i.actGroup.checkedCreateVariant),_n(5),jr("ngModel",i.actGroup.checkedVPManagePerm),_n(5),jr("ngModel",i.actGroup.checkedVPDelete),_n(4),jr("ngIf",i.helperUsersPerGroup(i.actGroup.name)),_n(1),jr("ngIf",!i.helperUsersPerGroup(i.actGroup.name))}}function CE(t,e){1&t&&Br(0,"input",99)}function VE(t,e){1&t&&Br(0,"input",100)}function wE(t,e){1&t&&Br(0,"input",101)}function AE(t,e){1&t&&Br(0,"input",102)}function PE(t,e){1&t&&Br(0,"input",103)}function kE(t,e){1&t&&Br(0,"input",104)}function DE(t,e){1&t&&Br(0,"input",105)}function ME(t,e){1&t&&Br(0,"input",106)}function IE(t,e){1&t&&Br(0,"input",107)}function SE(t,e){1&t&&Br(0,"input",108)}function xE(t,e){1&t&&Br(0,"input",109)}function TE(t,e){1&t&&Br(0,"input",110)}function _E(t,e){if(1&t){const t=zr();Nr(0,"div",79),Nr(1,"a",111),Jr("click",(function(){ei(t);const e=Xr().$implicit;return Xr(3).activateGroup(e)})),mo(2),Fr(),Fr()}if(2&t){const t=Xr().$implicit;_n(2),fo(t.groupName)}}function UE(t,e){if(1&t&&(Hr(0,20),Lr(1,_E,3,1,"div",78),Kr()),2&t){const t=e.$implicit,i=Xr(3);_n(1),jr("ngIf",t.email==i.vgUsers[i.userIndex].email)}}function OE(t,e){if(1&t&&(Nr(0,"div",81),Nr(1,"div",82),Nr(2,"div",38),Nr(3,"div",39),Nr(4,"h5",83),mo(5),Fr(),Nr(6,"button",41),Nr(7,"span",42),mo(8,"\xd7"),Fr(),Fr(),Fr(),Nr(9,"div",43),Nr(10,"div"),mo(11,"Visbo Project Permission for User"),Fr(),Nr(12,"div",51),Lr(13,CE,1,0,"input",84),Lr(14,VE,1,0,"input",85),Nr(15,"label",54),mo(16,"View Visbo Project"),Fr(),Fr(),Nr(17,"div",51),Lr(18,wE,1,0,"input",86),Lr(19,AE,1,0,"input",87),Nr(20,"label",57),mo(21,"View Project Audit"),Fr(),Fr(),Nr(22,"div",51),Lr(23,PE,1,0,"input",88),Lr(24,kE,1,0,"input",89),Nr(25,"label",60),mo(26,"Modify Visbo Project"),Fr(),Fr(),Nr(27,"div",51),Lr(28,DE,1,0,"input",90),Lr(29,ME,1,0,"input",91),Nr(30,"label",63),mo(31,"Create Visbo Project Variant"),Fr(),Fr(),Nr(32,"div",51),Lr(33,IE,1,0,"input",92),Lr(34,SE,1,0,"input",93),Nr(35,"label",66),mo(36,"Manage Permissions, Users and Groups"),Fr(),Fr(),Nr(37,"div",51),Lr(38,xE,1,0,"input",94),Lr(39,TE,1,0,"input",95),Nr(40,"label",69),mo(41,"Delete Visbo Project"),Fr(),Fr(),Nr(42,"label",96),mo(43,"Group Member Ship"),Fr(),Lr(44,UE,2,1,"ng-container",77),Nr(45,"div",97),Nr(46,"button",98),mo(47,"Close"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr()),2&t){const t=Xr(2);_n(5),vo("Permission for ",t.vgUsers[t.userIndex].email,""),_n(8),jr("ngIf",t.hasUserVPPerm(t.permVP.View)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.View)),_n(4),jr("ngIf",t.hasUserVPPerm(t.permVP.ViewAudit)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.ViewAudit)),_n(4),jr("ngIf",t.hasUserVPPerm(t.permVP.Modify)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.Modify)),_n(4),jr("ngIf",t.hasUserVPPerm(t.permVP.CreateVariant)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.CreateVariant)),_n(4),jr("ngIf",t.hasUserVPPerm(t.permVP.ManagePerm)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.ManagePerm)),_n(4),jr("ngIf",t.hasUserVPPerm(t.permVP.DeleteVP)),_n(1),jr("ngIf",!t.hasUserVPPerm(t.permVP.DeleteVP)),_n(5),jr("ngForOf",t.vgUsers)}}function EE(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div",1),Nr(2,"h3"),mo(3,"Project: "),Nr(4,"a",2),Jr("click",(function(){ei(t);const e=Xr();return e.gotoVPList(e.visboproject)})),mo(5),Ua(6,"uppercase"),Fr(),Fr(),Nr(7,"h5"),mo(8,"Visbo Center: "),Nr(9,"a",2),Jr("click",(function(){ei(t);const e=Xr();return e.gotoVCDetail(e.visboproject)})),mo(10),Fr(),Fr(),Nr(11,"form"),Nr(12,"div",3),Nr(13,"label",4),mo(14,"Name:"),Fr(),Nr(15,"label",5),mo(16),Fr(),Fr(),Nr(17,"div",3),Nr(18,"label",6),mo(19,"Description:"),Fr(),Nr(20,"label",7),mo(21),Fr(),Fr(),Nr(22,"div",3),Nr(23,"label",8),mo(24,"Created / Updated at:"),Fr(),Nr(25,"label",9),mo(26),Ua(27,"date"),Fr(),Nr(28,"label",10),mo(29),Ua(30,"date"),Fr(),Fr(),Fr(),Nr(31,"div",11),Lr(32,iE,2,0,"button",12),Lr(33,nE,2,0,"button",13),Lr(34,sE,2,0,"button",14),Fr(),Lr(35,oE,18,1,"div",0),Lr(36,dE,22,1,"div",0),Fr(),Lr(37,yE,56,15,"div",15),Lr(38,OE,48,14,"div",16),Fr()}if(2&t){const t=Xr();_n(5),fo(Oa(6,13,t.visboproject.name)),_n(5),fo(t.visboproject.vc.name),_n(6),vo("",t.visboproject.name," "),_n(5),vo("",t.visboproject.description," "),_n(5),vo("",Ea(27,15,t.visboproject.createdAt,"dd.MM.yyyy HH:mm:ss")," "),_n(3),vo("",Ea(30,18,t.visboproject.updatedAt,"dd.MM.yyyy HH:mm:ss")," "),_n(3),jr("ngIf",t.hasVPPerm(t.permVP.ViewAudit)),_n(1),jr("ngIf",!t.showGroups),_n(1),jr("ngIf",t.showGroups),_n(1),jr("ngIf",!t.showGroups),_n(1),jr("ngIf",t.showGroups),_n(1),jr("ngIf",t.actGroup),_n(1),jr("ngIf",t.vgUsers&&t.userIndex>=0)}}let LE=(()=>{class t{constructor(t,e,i,n,s,r,o){this.messageService=t,this.visbocenterService=e,this.route=i,this.visboprojectService=n,this.location=s,this.alertService=r,this.router=o,this.newUserInvite=new Zh,this.permSystem=Mv,this.permVC=Iv,this.permVP=Sv,this.deleted=!1,this.sortUserColumn=1,this.sortUserAscending=!0,this.sortGroupColumn=1,this.sortGroupAscending=!0}ngOnInit(){this.combinedPerm=this.visbocenterService.getSysAdminRole(),this.getVisboProject(),this.getVisboProjectUsers(),this.log("SysAdmin Role: "+JSON.stringify(this.combinedPerm))}getVisboProject(){const t=this.route.snapshot.paramMap.get("id");this.log("VisboProject Detail of: "+t),this.visboprojectService.getVisboProject(t,!0).subscribe(e=>{this.visboproject=e,this.combinedPerm=e.perm,this.log(`Get VisboProject ${t} Perm ${JSON.stringify(this.combinedPerm)}`)},t=>{this.log(`get VPs failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}gotoVPAudit(t){this.log(`GoTo VP Audit ${t.name} ${this.visboproject.name}`),this.router.navigate(["vpAudit/".concat(t._id)],{queryParams:{sysadmin:1}})}hasSystemPerm(t){return(this.combinedPerm.system&t)>0}hasVCPerm(t){return(this.combinedPerm.vc&t)>0}hasVPPerm(t){return(this.combinedPerm.vp&t)>0}hasUserVPPerm(t){return void 0!==this.combinedUserPerm&&(this.log(`Has User VP Permission ${t}? ${(this.combinedUserPerm.vp&t)>0} `),(this.combinedUserPerm.vp&t)>0)}toggleUserGroup(){this.showGroups=!this.showGroups}getVisboProjectUsers(){const t=this.route.snapshot.paramMap.get("id");this.log("VisboProject UserList of: "+t),this.visboprojectService.getVPUsers(t,!0).subscribe(t=>{this.vgUsers=t.users,this.vgGroups=t.groups,this.log(`fetched Users ${this.vgUsers.length}, Groups ${this.vgGroups.length}`),this.sortUserTable(),this.sortGroupTable()},t=>{this.log(`Get VP Users failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(403===t.status?"Permission Denied":Gh(t))})}goBack(){this.location.back()}delete(t){this.visboprojectService.deleteVisboProject(t).subscribe(()=>{this.goBack()},e=>{this.log(`delete VP failed: error: ${e.status} message: ${e.error.message}`),this.alertService.error(403===e.status?"Permission Denied: Visbo Project "+t.name:Gh(e))})}gotoVCDetail(t){this.router.navigate(["sysvcDetail/".concat(t.vcid)])}gotoVPList(t){this.router.navigate(["sysvp/".concat(t.vcid)])}save(){this.visboprojectService.updateVisboProject(this.visboproject).subscribe(t=>{this.alertService.success(`Visbo Project ${t.name} updated successfully`,!0),this.goBack()},t=>{this.log(`save VP failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(403===t.status?"Permission Denied: Visbo Project "+this.visboproject.name:409===t.status?`Visbo Project ${this.visboproject.name} exists already`:Gh(t))})}addNewVPUser(){const t=this.newUserInvite.email.trim(),e=this.newUserInvite.groupName.trim(),i=this.vgGroups.filter(t=>t.name===e)[0],n=i._id,s=this.visboproject._id;let r="";this.newUserInvite.inviteMessage&&(r=this.newUserInvite.inviteMessage.trim()),this.log(`Add VisboProject User: ${t} Group: ${e}/${n} VP: ${s}`),t&&n&&this.visboprojectService.addVPUser(t,n,r,s,!0).subscribe(e=>{const n=new _v;n.userId=e.users.filter(e=>e.email===t)[0].userId,n.email=t,n.groupId=e._id,n.groupName=e.name,n.groupType=i.groupType,n.internal=i.internal,this.log("Add VisboCenter User Push: "+JSON.stringify(n)),this.vgUsers.push(n),this.sortUserTable();for(let t=0;t<this.vgGroups.length;t++)if(this.vgGroups[t]._id===e._id){this.vgGroups[t]=e;break}this.alertService.success(`User ${t} added successfully`)},t=>{this.log("Add VisboProject User error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Add User to Visbo Project"):(this.log("Error during add VP user "+t.error.message),this.alertService.error(Gh(t)))})}calcCombinedPerm(t){this.userIndex=t,this.combinedUserPerm={system:0,vc:0,vp:0},this.vgUsers.forEach(this.addUserPerm,this),this.log(`Combined Permission for ${this.vgUsers[t].email}  ${JSON.stringify(this.combinedUserPerm)}`)}addUserPerm(t){if(t.email!==this.vgUsers[this.userIndex].email)return;this.log("Add User Permission for "+t.groupName);const e=this.vgGroups.findIndex(e=>e.name===t.groupName);e>=0?this.vgGroups[e].permission?this.combinedUserPerm.vp=this.combinedUserPerm.vp|(this.vgGroups[e].permission.vp||0):this.log("Permission for Group not set "+t.groupName):this.log("Group not found "+t.groupName)}helperRemoveUser(t){this.userIndex=t}helperRemoveGroup(t){this.groupIndex=t}helperUsersPerGroup(t){const e=this.vgGroups&&this.vgGroups.find(e=>e.name===t);return e?e.users.length:0}removeVPUser(t,e){this.log(`Remove VisboProject User: ${t.email}/${t.userId} Group: ${t.groupName} VP: ${e}`),this.visboprojectService.deleteVPUser(t,e,!0).subscribe(()=>{this.vgUsers=this.vgUsers.filter(e=>e!==t);for(let e=0;e<this.vgGroups.length;e++)if(this.vgGroups[e]._id===t.groupId){for(let i=0;i<this.vgGroups[e].users.length;i++)if(this.vgGroups[e].users[i].userId===t.userId){this.vgGroups[e].users.splice(i,1);break}break}this.alertService.success(`User ${t.email} removed successfully`)},t=>{this.log("Remove VisboProject User error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Remove User from Visbo Project"):(this.log("Error during remove User from VP user "+t.error.message),this.alertService.error(Gh(t)))})}helperVPPerm(t){let e=0;return t.checkedVPView&&(e+=this.permVP.View),t.checkedVPViewAudit&&(e+=this.permVP.ViewAudit),t.checkedVPModify&&(e+=this.permVP.Modify),t.checkedCreateVariant&&(e+=this.permVP.CreateVariant),t.checkedVPManagePerm&&(e+=this.permVP.ManagePerm),t.checkedVPDelete&&(e+=this.permVP.DeleteVP),e}activateGroup(t){this.log("Activate Group : "+t.groupName);const e=this.vgGroups.find(e=>e.name==t.groupName);this.initGroup(e)}activateUser(t){this.log("Activate User : "+t.email);const e=this.vgUsers.findIndex(e=>e.email==t.email);e>=0&&this.calcCombinedPerm(e)}initGroup(t){this.actGroup=new Tv,t?(this.confirm="VP"===t.groupType?"Modify":"View",this.actGroup._id=t._id,this.log(`Init Group Set GroupID : ${this.actGroup._id} ID ${t._id}`),this.actGroup.name=t.name,this.actGroup.groupType=t.groupType,this.actGroup.internal=t.internal,this.actGroup.global=t.global,this.actGroup.checkedView=(t.permission.vc&this.permVC.View)>0,this.actGroup.checkedViewAudit=(t.permission.vc&this.permVC.ViewAudit)>0,this.actGroup.checkedModify=(t.permission.vc&this.permVC.Modify)>0,this.actGroup.checkedCreateVP=(t.permission.vc&this.permVC.CreateVP)>0,this.actGroup.checkedManagePerm=(t.permission.vc&this.permVC.ManagePerm)>0,this.actGroup.checkedVPView=(t.permission.vp&this.permVP.View)>0,this.actGroup.checkedVPViewAudit=(t.permission.vp&this.permVP.ViewAudit)>0,this.actGroup.checkedVPModify=(t.permission.vp&this.permVP.Modify)>0,this.actGroup.checkedCreateVariant=(t.permission.vp&this.permVP.CreateVariant)>0,this.actGroup.checkedVPManagePerm=(t.permission.vp&this.permVP.ManagePerm)>0,this.actGroup.checkedVPDelete=(t.permission.vp&this.permVP.DeleteVP)>0):(this.confirm="Add",this.actGroup._id=void 0,this.actGroup.name="",this.actGroup.groupType="VP",this.actGroup.internal=!1,this.actGroup.global=!1,this.actGroup.checkedView=!0),this.log(`Init Group for Creation / Modification: ${this.actGroup.name} ID ${this.actGroup._id} Action ${this.confirm} `)}addModifyVPGroup(){const t=new xv;this.log(`Modify VisboProject Group: Group: ${this.actGroup.name} VC: ${this.visboproject.vcid} VP: ${this.visboproject._id} }`),t.name=this.actGroup.name.trim(),t.global=!1,t.vcid=this.visboproject.vcid,t.vpids=[],t.vpids.push(this.visboproject._id),t.permission=new Dv,t.permission.vp=this.helperVPPerm(this.actGroup),this.actGroup._id?(this.log(`Modify VisboProject Group: Group: ${t.name} VC: ${t.vcid} Perm: ${JSON.stringify(t.permission)}`),t._id=this.actGroup._id,this.visboprojectService.modifyVPGroup(t).subscribe(e=>{this.log("Modify VisboProject Group Push: "+JSON.stringify(e)),this.vgGroups=this.vgGroups.filter(e=>e._id!==t._id),this.vgGroups.push(e);for(let i=0;i<this.vgUsers.length;i++)this.vgUsers[i].groupId===t._id&&(this.vgUsers[i].groupName=e.name);this.sortUserTable(),this.sortGroupTable(),this.alertService.success(`Group ${e.name} changed successfully`)},t=>{this.log("Modify VisboProject Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Modify Group to Visbo Project"):(this.log("Error during modify VP Group "+t.error.message),this.alertService.error(Gh(t)))})):(this.log(`Add VisboCenter Group: Group: ${t.name} VP: ${t.vpids[0]} Perm: ${JSON.stringify(t.permission)}`),this.visboprojectService.addVPGroup(t).subscribe(t=>{this.vgGroups.push(t),this.alertService.success(`Group ${t.name} added successfully`)},t=>{this.log("Add VisboCenter Group error: "+t.error.message),403===t.status?this.alertService.error("Permission Denied: Add Group to Visbo Center"):(this.log("Error during add VC Group "+t.error.message),this.alertService.error(Gh(t)))}))}sortUserTable(t){this.vgUsers&&(void 0===t&&void 0!==this.sortUserColumn||(t!==this.sortUserColumn&&(this.sortUserColumn=t,this.sortUserAscending=void 0),this.sortUserAscending=void 0===this.sortUserAscending?1===t||2===t:!this.sortUserAscending),1===this.sortUserColumn?this.vgUsers.sort((function(t,e){return xh(t.email,e.email)})):2===this.sortUserColumn&&this.vgUsers.sort((function(t,e){return xh(t.groupName.toLowerCase(),e.groupName.toLowerCase())})),this.sortUserAscending||this.vgUsers.reverse())}sortGroupTable(t){this.vgGroups&&(void 0===t&&void 0!==this.sortGroupColumn||(t!==this.sortGroupColumn&&(this.sortGroupColumn=t,this.sortGroupAscending=void 0),this.sortGroupAscending=void 0===this.sortGroupAscending?1===t:!this.sortGroupAscending),1===this.sortGroupColumn?this.vgGroups.sort((function(t,e){return xh(t.name.toLowerCase(),e.name.toLowerCase())})):2===this.sortGroupColumn&&this.vgGroups.sort((function(t,e){return e.users.length-t.users.length})),this.sortGroupAscending||this.vgGroups.reverse())}log(t){this.messageService.add("VisboProjectDetail: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(jh),Rr(Ev),Rr(Bg),Rr(Vb),Rr(Xl),Rr(Mf),Rr(rf))},t.\u0275cmp=le({type:t,selectors:[["app-sysvisboproject-detail"]],inputs:{visboproject:"visboproject"},decls:2,vars:1,consts:[[4,"ngIf"],[1,"container"],[3,"click"],[1,"form-group","row"],["for","vpName",1,"col-4","col-md-3","col-form-label"],["id","VPName",1,"col-8","form-control-static"],["for","vpDescription",1,"col-4","col-md-3","col-form-label"],["id","VPDesc",1,"col-8","form-control-static"],["for","Created",1,"col-4","col-md-3","col-form-label"],["id","VPCreated",1,"col","form-control-static","col-form-label"],["id","VPUpdated",1,"col","form-control-static","col-form-label"],[1,"btn-toolbar"],["id","ViewAudit","type","button","class","btn btn-md btn-light mr-1",3,"click",4,"ngIf"],["id","ViewGroup","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["id","ViewUser","type","button","class","btn btn-md btn-light mx-1",3,"click",4,"ngIf"],["class","modal fade","id","VpGroupModalCreate","tabindex","-1","role","dialog","aria-labelledby","VpGroupModalCreateTitle","aria-hidden","true",4,"ngIf"],["class","modal fade","id","VPUserDetail","tabindex","-1","role","dialog","aria-labelledby","VPUserDetailTitle","aria-hidden","true",4,"ngIf"],["id","ViewAudit","type","button",1,"btn","btn-md","btn-light","mr-1",3,"click"],["id","ViewGroup","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],["id","ViewUser","type","button",1,"btn","btn-md","btn-light","mx-1",3,"click"],[1,"row"],[1,"col"],[1,"panel-heading"],[1,"panel-body"],[1,"table","table-hover"],["id","UserHead"],["id","UserList"],[4,"ngFor","ngForOf"],["id","ColUser","data-toggle","modal","data-target","#VPUserDetail",3,"click"],["id","ColGroup"],["id","GroupHead"],["id","GroupList"],["id","ColMembers"],["id","ColGlobal",4,"ngIf"],["id","ColDetail","title","Detail of Group","data-toggle","modal","data-target","#VpGroupModalCreate",1,"Detail",3,"click"],["id","ColGlobal"],["id","VpGroupModalCreate","tabindex","-1","role","dialog","aria-labelledby","VpGroupModalCreateTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["class","modal-title","id","VpGroupModalCenterTitle",4,"ngIf"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["name","actGroup","novalidate",""],["f","ngForm"],[1,"form-group",3,"ngClass"],["for","name",1,"col-form-label"],["type","text","name","name","required","",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],["class","help-block",4,"ngIf"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","permVP1","name","checkedVPView",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPView","ngModel"],["for","permVP1",1,"custom-control-label"],["type","checkbox","id","permVP2","name","checkedVPViewAudit",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPViewAudit","ngModel"],["for","permVP2",1,"custom-control-label"],["type","checkbox","id","permVP3","name","checkedVPModify",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPModify","ngModel"],["for","permVP3",1,"custom-control-label"],["type","checkbox","id","permVP4","name","checkedCreateVariant",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedCreateVariant","ngModel"],["for","permVP4",1,"custom-control-label"],["type","checkbox","id","permVP5","name","checkedVPManagePerm",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPManagePerm","ngModel"],["for","permVP5",1,"custom-control-label"],["type","checkbox","id","permVP6","name","checkedVPDelete",1,"custom-control-input",3,"ngModel","ngModelChange"],["checkedVPDelete","ngModel"],["for","permVP6",1,"custom-control-label"],["class","mt-2",4,"ngIf"],[1,"form-group"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["id","VpGroupModalCenterTitle",1,"modal-title"],[1,"help-block"],[1,"mt-2"],[1,"form-control-static"],["class","row",4,"ngFor","ngForOf"],["class","col-8 ml-3",4,"ngIf"],[1,"col-8","ml-3"],["data-dismiss","modal","data-toggle","modal","data-target","#VPUserDetail",3,"click"],["id","VPUserDetail","tabindex","-1","role","dialog","aria-labelledby","VPUserDetailTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],["id","VPUserDetailTitle",1,"modal-title"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP1","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP2","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP3","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP4","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP5","name","checkedView",4,"ngIf"],["type","checkbox","checked","","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],["type","checkbox","disabled","","class","custom-control-input","id","permVP6","name","checkedView",4,"ngIf"],[1,"form-control-static","mt-2"],[1,"form-group","mt-2"],["data-dismiss","modal",1,"btn","btn-primary"],["type","checkbox","checked","","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP1","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP2","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP3","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP4","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP5","name","checkedView",1,"custom-control-input"],["type","checkbox","checked","","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["type","checkbox","disabled","","id","permVP6","name","checkedView",1,"custom-control-input"],["data-dismiss","modal","data-toggle","modal","data-target","#VpGroupModalCreate",3,"click"]],template:function(t,e){1&t&&(Br(0,"app-sysnavbar"),Lr(1,EE,39,21,"div",0)),2&t&&(_n(1),jr("ngIf",e.visboproject))},directives:[CC,jc,Eu,Fd,Tu,Gc,Ec,Ed,Ru,Nd,Ou,_d],pipes:[Kc,qc],styles:[""]}),t})(),GE=(()=>{class t{constructor(t){this.gChartService=t}ngOnInit(){this.language||(this.language="de"),this.gLib=this.gChartService.getGoogle(),this.gLib.charts.load("current",{packages:["corechart","table"],language:this.language}),this.gLib.charts.setOnLoadCallback(this.drawChart.bind(this)),this.elementID&&""!==this.elementID||(this.elementID="divColumnChart")}ngOnChanges(){this.initialised&&this.drawChart()}drawChart(){const t=new this.gLib.visualization.ColumnChart(document.getElementById(this.elementID)),e=new this.gLib.visualization.arrayToDataTable(this.graphData);t.draw(e,this.graphOptions||{title:"Column Chart"}),this.initialised=!0}}return t.\u0275fac=function(e){return new(e||t)(Rr(RV))},t.\u0275cmp=le({type:t,selectors:[["app-column-chart"]],inputs:{elementID:"elementID",graphData:"graphData",language:"language",graphOptions:"graphOptions",parentThis:"parentThis"},features:[_e],decls:1,vars:1,consts:[[3,"id"]],template:function(t,e){1&t&&Br(0,"div",0),2&t&&to("id",e.elementID)},styles:["#divColumnChart[_ngcontent-%COMP%]{width:100%;height:700px}"]}),t})();function RE(t,e){if(1&t&&(Nr(0,"option"),mo(1),Fr()),2&t){const t=e.$implicit;_n(1),fo(t.name)}}function jE(t,e){if(1&t&&(Nr(0,"option"),mo(1),Fr()),2&t){const t=e.$implicit;_n(1),fo(t.name)}}function $E(t,e){if(1&t&&(Nr(0,"div",3),Br(1,"app-column-chart",27),Fr()),2&t){const t=Xr(2);_n(1),jr("elementID",t.divColumnChart2)("graphData",t.graphDataBrowserChart)("graphOptions",t.graphOptionsBrowserChart)}}function NE(t,e){if(1&t&&(Nr(0,"div",1),Nr(1,"h3",4),mo(2," Visbo Chart "),Nr(3,"div",3),Br(4,"app-pie-chart",25),Fr(),Nr(5,"div",3),Br(6,"app-line-chart",26),Fr(),Nr(7,"div",3),Br(8,"app-column-chart",27),Fr(),Lr(9,$E,2,3,"div",28),Fr(),Fr()),2&t){const t=Xr();_n(4),jr("graphData",t.graphData)("graphLegend",t.graphLegend)("graphOptions",t.graphOptions)("parentThis",t.parentThis),_n(2),jr("graphData",t.graphDataLineChart)("graphOptions",t.graphOptionsLineChart),_n(2),jr("elementID",t.divColumnChart1)("graphData",t.graphDataUserChart)("graphOptions",t.graphOptionsUserChart),_n(1),jr("ngIf",t.graphDataBrowserChart&&t.graphDataBrowserChart.length>0)}}function FE(t,e){if(1&t&&(Nr(0,"td",50),mo(1),Ua(2,"date"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.createdAt,"HH:mm:ss"))}}function BE(t,e){if(1&t&&(Nr(0,"td",50),mo(1),Ua(2,"date"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.createdAt,"dd.MM HH:mm"))}}function HE(t,e){if(1&t&&(Nr(0,"td",51),mo(1),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(t.user.email)}}function KE(t,e){1&t&&(Nr(0,"td",51),mo(1," Unknown "),Fr())}function qE(t,e){if(1&t){const t=zr();Nr(0,"tr",42),Jr("click",(function(){ei(t);const i=e.index;return Xr(2).helperAuditIndex(i)})),Lr(1,FE,3,4,"td",43),Lr(2,BE,3,4,"td",43),Lr(3,HE,2,1,"td",44),Lr(4,KE,2,0,"td",44),Nr(5,"td",45),mo(6),Fr(),Nr(7,"td",46),mo(8),Fr(),Nr(9,"td",47),mo(10),Fr(),Nr(11,"td",48),mo(12),Fr(),Nr(13,"td",47),mo(14),Fr(),Nr(15,"td"),Nr(16,"button",49),Jr("click",(function(){ei(t);const i=e.index;return Xr(2).helperAuditIndex(i)})),mo(17,"i"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit,i=e.index,n=Xr(2);_n(1),jr("ngIf",n.isToday(t.createdAt)),_n(1),jr("ngIf",!n.isToday(t.createdAt)),_n(1),jr("ngIf",t.user),_n(1),jr("ngIf",!t.user),_n(2),fo(t.actionDescription),_n(2),fo(n.helperShortenText(t.actionInfo,30)),_n(2),fo(n.helperResponseText(t)),_n(2),vo("",t.result.time," ms"),_n(2),fo(n.helperFormatBytes(n.audit[i].result.size||0,2))}}function zE(t,e){1&t&&(Nr(0,"div"),Nr(1,"h3",52),mo(2," No Audit Entry for the time frame or the filter condition "),Fr(),Fr())}function QE(t,e){if(1&t){const t=zr();Nr(0,"div",1),Nr(1,"div",29),Nr(2,"table",30),Nr(3,"thead",31),Nr(4,"tr"),Nr(5,"th",32),Jr("click",(function(){return ei(t),Xr().sortTable(1)})),mo(6,"Created"),Fr(),Nr(7,"th",33),Jr("click",(function(){return ei(t),Xr().sortTable(2)})),mo(8,"User"),Fr(),Nr(9,"th",34),Jr("click",(function(){return ei(t),Xr().sortTable(3)})),mo(10," Action"),Fr(),Nr(11,"th",35),Jr("click",(function(){return ei(t),Xr().sortTable(4)})),mo(12," Info"),Fr(),Nr(13,"th",36),Jr("click",(function(){return ei(t),Xr().sortTable(5)})),mo(14," Result"),Fr(),Nr(15,"th",37),Jr("click",(function(){return ei(t),Xr().sortTable(6)})),mo(16," Duration"),Fr(),Nr(17,"th",38),Jr("click",(function(){return ei(t),Xr().sortTable(7)})),mo(18," Size"),Fr(),Nr(19,"th"),mo(20,"Detail"),Fr(),Fr(),Fr(),Nr(21,"tbody",39),Lr(22,qE,18,9,"tr",40),Fr(),Fr(),Lr(23,zE,3,0,"div",41),Fr(),Fr()}if(2&t){const t=Xr();_n(22),jr("ngForOf",t.audit),_n(1),jr("ngIf",t.audit&&0==t.audit.length)}}function WE(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",68),mo(2,"Info:"),Fr(),Nr(3,"label",72),mo(4),Fr(),Fr()),2&t){const t=Xr(2);_n(4),vo("",t.audit[t.auditIndex].actionInfo," ")}}function JE(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",68),mo(2,"Visbo Center:"),Fr(),Nr(3,"label",77),mo(4),Fr(),Fr()),2&t){const t=Xr(2);_n(4),vo("",t.audit[t.auditIndex].vc.name," ")}}function YE(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",68),mo(2,"Visbo Project:"),Fr(),Nr(3,"label",78),mo(4),Fr(),Fr()),2&t){const t=Xr(2);_n(4),bo("",t.audit[t.auditIndex].vp.name," (",t.audit[t.auditIndex].vp.vpid,") ")}}function ZE(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",68),mo(2,"Project Version:"),Fr(),Nr(3,"label",79),mo(4),Fr(),Fr()),2&t){const t=Xr(2);_n(4),bo("",t.audit[t.auditIndex].vpv.name," (",t.audit[t.auditIndex].vpv.vpvid,")")}}function XE(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",68),mo(2,"tech. Action:"),Fr(),Nr(3,"label",72),mo(4),Fr(),Fr()),2&t){const t=Xr(2);_n(4),vo("",t.audit[t.auditIndex].action," ")}}function tL(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",68),mo(2,"URL:"),Fr(),Nr(3,"label",80),mo(4),Fr(),Fr()),2&t){const t=Xr(2);_n(4),vo("",t.audit[t.auditIndex].url," ")}}function eL(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",68),mo(2,"Response Time:"),Fr(),Nr(3,"label",72),mo(4),Fr(),Fr()),2&t){const t=Xr(2);_n(4),vo("",t.audit[t.auditIndex].result.time," ms ")}}function iL(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",68),mo(2,"Response Size:"),Fr(),Nr(3,"label",72),mo(4),Fr(),Fr()),2&t){const t=Xr(2);_n(4),vo("",t.helperFormatBytes(t.audit[t.auditIndex].result.size||0,2)," ")}}function nL(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",68),mo(2,"User Agent:"),Fr(),Nr(3,"label",72),mo(4),Fr(),Fr()),2&t){const t=Xr(2);_n(4),fo(t.audit[t.auditIndex].userAgent)}}function sL(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",68),mo(2,"IP:"),Fr(),Nr(3,"label",72),mo(4),Fr(),Fr()),2&t){const t=Xr(2);_n(4),fo(t.audit[t.auditIndex].ip)}}function rL(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",68),mo(2,"TTL:"),Fr(),Nr(3,"label",72),mo(4),Ua(5,"date"),Fr(),Fr()),2&t){const t=Xr(2);_n(4),fo(Ea(5,1,t.audit[t.auditIndex].ttl,"dd.MM HH:mm"))}}function oL(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"label",68),mo(2,"Host:"),Fr(),Nr(3,"label",72),mo(4),Fr(),Fr()),2&t){const t=Xr(2);_n(4),fo(t.audit[t.auditIndex].host)}}function aL(t,e){if(1&t){const t=zr();Nr(0,"button",81),Jr("click",(function(){return ei(t),Xr(2).toggleDetail()})),mo(1,"More"),Fr()}}function lL(t,e){if(1&t){const t=zr();Nr(0,"button",82),Jr("click",(function(){return ei(t),Xr(2).toggleDetail()})),mo(1,"Less"),Fr()}}function cL(t,e){if(1&t){const t=zr();Nr(0,"div",53),Nr(1,"div",54),Nr(2,"div",55),Nr(3,"h5",56),mo(4,"Detail of Audit Entry"),Fr(),Nr(5,"button",57),Nr(6,"span",58),mo(7,"\xd7"),Fr(),Fr(),Fr(),Nr(8,"div",59),Nr(9,"div",2),Nr(10,"div",60),Nr(11,"h3",61),Jr("click",(function(){return ei(t),Xr().pageAuditIndex(-1)})),Br(12,"a",62),Fr(),Fr(),Nr(13,"div",63),Nr(14,"h3",64),Jr("click",(function(){return ei(t),Xr().pageAuditIndex(1)})),Br(15,"a",65),Fr(),Fr(),Fr(),Nr(16,"form",66),Nr(17,"div",67),Nr(18,"label",68),mo(19,"Created:"),Fr(),Nr(20,"label",69),mo(21),Ua(22,"date"),Fr(),Nr(23,"label",68),mo(24,"User:"),Fr(),Nr(25,"label",70),mo(26),Fr(),Nr(27,"label",68),mo(28,"Action:"),Fr(),Nr(29,"label",71),mo(30),Fr(),Fr(),Lr(31,WE,5,1,"div",41),Lr(32,JE,5,1,"div",41),Lr(33,YE,5,2,"div",41),Lr(34,ZE,5,2,"div",41),Nr(35,"div"),Nr(36,"label",68),mo(37,"Result:"),Fr(),Nr(38,"label",72),mo(39),Fr(),Fr(),Lr(40,XE,5,1,"div",41),Lr(41,tL,5,1,"div",41),Lr(42,eL,5,1,"div",41),Lr(43,iL,5,1,"div",41),Lr(44,nL,5,1,"div",41),Lr(45,sL,5,1,"div",41),Lr(46,rL,6,4,"div",41),Lr(47,oL,5,1,"div",41),Fr(),Fr(),Nr(48,"div",73),Lr(49,aL,2,0,"button",74),Lr(50,lL,2,0,"button",75),Nr(51,"button",76),mo(52,"Close"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr();_n(21),vo("",Ea(22,18,t.audit[t.auditIndex].createdAt,"dd.MM.yyyy HH:mm:ss.SSS")," "),_n(5),vo("",t.audit[t.auditIndex].user.email," "),_n(4),vo("",t.helperFormatActionDescription(t.audit[t.auditIndex])," "),_n(1),jr("ngIf",t.audit[t.auditIndex].actionInfo),_n(1),jr("ngIf",t.audit[t.auditIndex].vc),_n(1),jr("ngIf",t.audit[t.auditIndex].vp),_n(1),jr("ngIf",t.audit[t.auditIndex].vpv),_n(5),vo("",t.helperResponseText(t.audit[t.auditIndex])," "),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore&&t.audit[t.auditIndex].ip),_n(1),jr("ngIf",t.showMore&&t.audit[t.auditIndex].ttl),_n(1),jr("ngIf",t.showMore&&t.audit[t.auditIndex].host),_n(2),jr("ngIf",!t.showMore),_n(1),jr("ngIf",t.showMore)}}function dL(t){let e;return t?(e=t.replace(/\t/g," "),"="!==e[0]&&"+"!==e[0]&&"-"!==e[0]||(e="'".concat(e)),e):t}let uL=(()=>{class t{constructor(t,e,i,n,s,r){this.visboauditService=t,this.visbocenterService=e,this.messageService=i,this.alertService=n,this.route=s,this.router=r,this.auditTypeList=[{name:"All",action:""},{name:"Read",action:"GET"},{name:"Create",action:"POST"},{name:"Update",action:"PUT"},{name:"Delete",action:"DELETE"}],this.auditAreaList=[{name:"Overview",action:"other"},{name:"System",action:"sys"},{name:"Visbo Center",action:"vc"},{name:"Visbo Project",action:"vp"},{name:"All",action:""}],this.sysVCId="",this.chart=!1,this.parentThis=this,this.divColumnChart1="SysAudit_User_div",this.divColumnChart2="SysAudit_Browser_div",this.chartButton="Chart",this.graphData=[],this.graphLegend=[["string","Action Type"],["number","Count"]],this.graphOptions={title:"Audit Activity by Action",sliceVisibilityThreshold:.025},this.graphDataLineChart=[],this.graphOptionsLineChart={title:"Audit Activity by Time",explorer:{actions:["dragToZoom","rightClickToReset"],maxZoomIn:.01},vAxis:{title:"Number of Activities",minorGridlines:{count:0}},hAxis:{format:"dd.MM.yy",gridlines:{count:-1},minorGridlines:{count:0}},pointSize:6,curveType:"function",colors:["blue","red","green","yellow"]},this.graphDataUserChart=[],this.graphOptionsUserChart={title:"Audit Activity by User",isStacked:!0,hAxis:{direction:-1,slantedText:!0,slantedTextAngle:45}},this.graphDataBrowserChart=[],this.graphOptionsBrowserChart={title:"Audit Activity by User Agent",isStacked:!0,hAxis:{direction:-1,slantedText:!0,slantedTextAngle:45}},this.listOS=["Windows","Macintosh","iPhone","iPad","Android","Linux","Unknown"]}ngOnInit(){this.auditCount=50,this.auditType=this.auditTypeList[0].name,this.auditArea=this.auditAreaList[0].name,this.today=new Date,this.today.setHours(0,0,0,0),this.sysVCId=this.visbocenterService.getSysVCId(),this.getVisboAudits()}getVisboAudits(){const t=new gC;t.to=this.auditTo?new Date(this.auditTo):new Date,this.auditFrom&&(t.from=new Date(this.auditFrom)),this.auditText&&(t.text=this.auditText.trim());for(let e=0;e<this.auditTypeList.length;e++)if(this.auditType===this.auditTypeList[e].name){t.actionType=this.auditTypeList[e].action;break}for(let e=0;e<this.auditAreaList.length;e++)if(this.auditArea===this.auditAreaList[e].name){t.area=this.auditAreaList[e].action;break}t.maxcount=this.auditCount,this.visboauditService.getVisboAudits(!0,t).subscribe(t=>{this.audit=t,this.alertService.success("Successfully accessed Audit",!0),this.sortTable(void 0),this.groupGraphData(),this.groupgraphDataActivityChart(),this.groupgraphDataUserChart(),this.groupgraphDataBrowserChart()},t=>{this.log(`get Audit failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}gotoDetail(t){this.router.navigate(["sysaudit/"+t._id])}downloadVisboAudit(){let t;this.log(`sysAudit Download ${this.audit.length} Items`),t="sep=\t\n",t+="date\ttime UTC\temail\tactionDescription\taction\turl\tactionInfo\tresponseTime\tresponseStatus\tvcid\tvcname\tvpid\tvpname\tvpvid\tsize\tip\tuserId\tuserAgent\tttl\tVC Details\tVP Details\n";for(let s=0;s<this.audit.length;s++){const e=new Date(this.audit[s].createdAt).toISOString(),i=(this.audit[s].userAgent||"").replace(/,/g,";"),n=e.substr(0,10)+"\t"+e.substr(11,12)+"\t"+dL(this.audit[s].user.email)+"\t"+dL(this.audit[s].actionDescription)+"\t"+this.audit[s].action+"\t"+this.audit[s].url+"\t"+this.audit[s].actionInfo+"\t"+(this.audit[s].result?this.audit[s].result.time:"")+"\t"+(this.audit[s].result?this.audit[s].result.status:"")+"\t"+(this.audit[s].vc?this.audit[s].vc.vcid:"")+"\t"+(this.audit[s].vc?dL(this.audit[s].vc.name):"")+"\t"+(this.audit[s].vp?this.audit[s].vp.vpid:"")+"\t"+(this.audit[s].vp?dL(this.audit[s].vp.name):"")+"\t"+(this.audit[s].vpv?this.audit[s].vpv.vpvid:"")+"\t"+(this.audit[s].result?this.audit[s].result.size:"0")+"\t"+this.audit[s].ip+"\t"+this.audit[s].user.userId+"\t"+dL(i)+"\t"+(this.audit[s].ttl||"")+"\t"+(this.audit[s].vc&&dL(this.audit[s].vc.vcjson)||"")+"\t"+(this.audit[s].vp&&dL(this.audit[s].vp.vpjson)||"")+"\n";t=t.concat(n)}this.log(`sysAudit CSV Len ${t.length} `);const e=new Blob([t],{type:"text/plain"}),i=window.URL.createObjectURL(e),n=document.createElement("a");document.body.appendChild(n),n.href=i,n.download="auditlog.csv",this.log(`Open URL ${i} doc ${JSON.stringify(n)}`),n.click(),window.URL.revokeObjectURL(i)}switchChart(){this.chart=!this.chart,this.chartButton=this.chart?"List":"Chart"}groupGraphData(){const t=[],e=[];for(const i in this.audit)this.audit[i].actionDescription&&(t[this.audit[i].actionDescription]=(t[this.audit[i].actionDescription]||0)+1);for(const i in t)e.push([i,t[i]]);e.sort((function(t,e){let i=0;return t[1]>e[1]?i=-1:t[1]<e[1]&&(i=1),i})),this.graphData=e}groupgraphDataActivityChart(){const t=[],e=[];for(const i in this.audit)if(this.audit[i].createdAt){const e=new Date(this.audit[i].createdAt);e.setHours(0,0,0,0);const n=Math.trunc(e.getTime()/1e3/60/60/24);void 0===t[n]&&(t[n]=[new Date(e),0,0,0,0]),t[n][1]=t[n][1]+1,this.audit[i].vpv?t[n][4]=t[n][4]+1:this.audit[i].vp?t[n][3]=t[n][3]+1:this.audit[i].vc&&this.audit[i].vc.vcid.toString()!==this.sysVCId&&(t[n][2]=t[n][2]+1)}for(const i in t)e.push(t[i]);if(1===e.length){const t=new Date(e[0][0].toISOString());t.setMinutes(t.getMinutes()-1),e.push([t,0,0,0,0])}e.sort((function(t,e){return e[0]-t[0]})),e.push(["Date","All","VC","VP","VPV"]),e.reverse(),this.graphOptionsLineChart.hAxis.gridlines.count=e.length-1,this.log(`Group Graph Time Chart Gridlines ${e.length-1} `),this.graphDataLineChart=e}groupgraphDataUserChart(){const t=[],e=[];for(const i in this.audit)if(this.audit[i].user&&this.audit[i].user.email){const e=this.audit[i].user.email;void 0===t[e]&&(t[e]=[e,0,0,0,0,0,0,""]),this.audit[i].vpv||this.auditGroup(this.audit[i],"/vpv")?t[e][3]=t[e][3]+1:this.audit[i].vp||this.auditGroup(this.audit[i],"/vp")?t[e][2]=t[e][2]+1:this.audit[i].vc&&this.audit[i].vc.vcid.toString()!==this.sysVCId||this.auditGroup(this.audit[i],"/vc")?t[e][1]=t[e][1]+1:this.audit[i].vc&&this.audit[i].vc.vcid.toString()===this.sysVCId||this.auditGroup(this.audit[i],"/audit")?t[e][4]=t[e][4]+1:this.auditGroup(this.audit[i],"/token")||this.auditGroup(this.audit[i],"/user")?t[e][5]=t[e][5]+1:t[e][6]=t[e][6]+1}for(const i in t)e.push(t[i]);e.sort((function(t,e){return t[1]+t[2]+t[3]+t[4]+t[5]+t[6]-(e[1]+e[2]+e[3]+e[4]+e[5]+e[6])})),e.push(["User","VC","VP","VPV","System","User","Other",{role:"annotation"}]),e.reverse(),this.log("Group Graph Column Chart Element "+JSON.stringify(e[0])),this.log("Group Graph Column Chart Element "+JSON.stringify(e[1])),this.graphDataUserChart=e}getUserAgent(t){const e=["VISBO Projectboard","VISBO Smartinfo","Chrome","Firefox","Safari","Postman"];let i="Unknown";t=t||"";for(let n=0;n<e.length;n++)if(t.indexOf(e[n])>=0){i=e[n];break}return i}getOSAgent(t){let e=this.listOS.length-1;t=t||"";for(let i=0;i<this.listOS.length;i++)if(t.indexOf(this.listOS[i])>=0){e=i;break}return e}groupgraphDataBrowserChart(){const t=[],e=[];for(const i in this.audit){const e=this.audit[i].userAgent,n=this.getUserAgent(e),s=this.getOSAgent(e);void 0===t[n]&&(t[n]=[n,0,0,0,0,0,0,0,""]),t[n][s+1]+=1}for(const i in t)e.push(t[i]);e.sort((function(t,e){return t[1]+t[2]+t[3]+t[4]+t[5]+t[6]+t[7]-(e[1]+e[2]+e[3]+e[4]+e[5]+e[6]+e[7])})),e.push(["UserAgent",this.listOS[0],this.listOS[1],this.listOS[2],this.listOS[3],this.listOS[4],this.listOS[5],this.listOS[6],{role:"annotation"}]),e.reverse(),this.graphDataBrowserChart=e}auditGroup(t,e){let i=!1;return 0===t.url.indexOf(e)&&(i=!0),i}helperAuditIndex(t){this.auditIndex=t}helperFormatActionDescription(t){if(this.log(`AuditDescription  ${t.actionDescription} `),"GET"===t.actionDescription||"POST"===t.actionDescription||"PUT"===t.actionDescription||"DELETE"===t.actionDescription){let e=t.actionDescription.concat(" ",t.url);return e.length>20&&(e=e.substring(0,17)+"..."),e}return t.actionDescription}helperFormatBytes(t,e=2){if(0===t)return"0 B";const i=e||2,n=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,n)).toFixed(i))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}pageAuditIndex(t){let e=this.auditIndex+t;e<0&&(e=0),e>=this.audit.length&&(e=this.audit.length-1),this.auditIndex=e}helperResponseText(t){if(t.result.statusText)return t.result.statusText;const e=t.result.status;return"200"===e||"304"===e?"Success":"400"===e?"Bad Request":"401"===e?"Not Authenticated":"403"===e?"Permission Denied":"404"===e?"URL not found":"409"===e?"Conflict":"423"===e?"Locked":"500"===e?"Server Error":e.toString()}helperShortenText(t,e){return Lh(t,e)}toggleDetail(){this.log("Toggle ShowMore"),this.showMore=!this.showMore}isToday(t){return new Date(t)>this.today}sortTable(t){this.audit&&(void 0!==t?t!==this.sortColumn?(this.sortColumn=t,this.sortAscending=void 0):void 0!==this.sortAscending&&(this.sortAscending=!this.sortAscending):(this.sortColumn=1,this.sortAscending=void 0),void 0===this.sortAscending&&(this.sortAscending=2===t||3===t||4===t),1===this.sortColumn?this.audit.sort((function(t,e){return Th(t.createdAt,e.createdAt)})):2===this.sortColumn?this.audit.sort((function(t,e){return xh(t.user.email.toLowerCase(),e.user.email.toLowerCase())})):3===this.sortColumn?this.audit.sort((function(t,e){return xh(t.actionDescription,e.actionDescription)})):4===this.sortColumn?this.audit.sort((function(t,e){return xh(t.url,e.url)})):5===this.sortColumn?this.audit.sort((function(t,e){return xh(t.result.status,e.result.status)})):6===this.sortColumn?this.audit.sort((function(t,e){return t.result.time-e.result.time})):7===this.sortColumn&&this.audit.sort((function(t,e){return(t.result.size||0)-(e.result.size||0)})),this.sortAscending||this.audit.reverse())}log(t){this.messageService.add("Sys Audit: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(fC),Rr(Ev),Rr(jh),Rr(Mf),Rr(Bg),Rr(rf))},t.\u0275cmp=le({type:t,selectors:[["app-sysaudit"]],decls:46,vars:12,consts:[[1,"well"],[1,"container-fluid"],[1,"row"],[1,"col"],[1,"panel-heading"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group","row"],["for","auditFrom",1,"col-1","col-form-label"],["id","auditFrom","type","date","name","auditFrom",1,"col-4","col-md-2","form-control",3,"ngModel","ngModelChange"],["for","auditTo",1,"col-1","col-form-label"],["id","auditTo","type","date","name","auditTo",1,"col-4","col-md-2","form-control",3,"ngModel","ngModelChange"],["for","auditText",1,"col-1","col-form-label"],["id","auditText","type","text","name","auditText",1,"col-3","col-md-2","form-control",3,"ngModel","ngModelChange"],["for","auditCount",1,"col-1","col-form-label"],["id","auditCount","name","auditCount",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],["id","auditArea","id","auditType","name","auditArea",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["id","auditType","id","auditType","name","actiontype",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],[1,"btn-group"],["type","button",1,"btn","btn-sm","btn-primary","ml-auto","mx-1",3,"click"],["type","button",1,"btn","btn-sm","btn-secondary","ml-auto","mx-1",3,"click"],["class","container-fluid",4,"ngIf"],["id","AuditDetail","tabindex","-1","role","dialog","aria-labelledby","Audit Detail","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-lg modal-dialog-centered","role","document",4,"ngIf"],[3,"graphData","graphLegend","graphOptions","parentThis"],[3,"graphData","graphOptions"],[3,"elementID","graphData","graphOptions"],["class","col",4,"ngIf"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],["id","AuditHead"],["id","SortDate",1,"d-none","d-md-table-cell",3,"click"],["id","SortUser",3,"click"],["id","SortAction",3,"click"],["id","SortInfo",1,"d-none","d-md-table-cell",3,"click"],["id","SortResult",1,"d-none","d-lg-table-cell",3,"click"],["id","SortDuration",1,"d-none","d-lg-table-cell",3,"click"],["id","SortSize",1,"d-none","d-lg-table-cell",3,"click"],["id","AuditList"],["data-toggle","modal","data-target","#AuditDetail",3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],["data-toggle","modal","data-target","#AuditDetail",3,"click"],["id","ColCreated","class","d-none d-md-table-cell",4,"ngIf"],["id","ColUser",4,"ngIf"],["id","ColAction"],["id","ColInfo",1,"d-none","d-md-table-cell"],["id","ColResult",1,"d-none","d-lg-table-cell"],["id","ColDuration",1,"d-none","d-lg-table-cell"],["id","ColDetail","title","Detail of Visbo Audit","data-toggle","modal","data-target","#AuditDetail",1,"Detail",3,"click"],["id","ColCreated",1,"d-none","d-md-table-cell"],["id","ColUser"],[1,"d-flex","justify-content-center"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","AuditDetailTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"col-11"],["id","ButtonPrev","title","Previous Entry",3,"click"],[1,"px-3","col-1","fas","fa-caret-square-left"],[1,"col-1"],["id","ButtonNext","title","Next Entry",3,"click"],[1,"px-3","col-1","fas","fa-caret-square-right"],["id","auditEntry"],[1,"v_compact_t"],[1,"v_compact_t","col-4","form-control-static"],["id","auditCreated",1,"v_compact_t","col-7","form-control-static"],["id","auditUser",1,"v_compact_t","col-7","form-control-static"],["id","auditAction",1,"v_compact_t","col-7","form-control-static"],[1,"v_compact_t","col-7","form-control-static"],[1,"modal-footer","align-items-end"],["id","ButtonMore","type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["id","ButtonLess","type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["id","ButtonBack","type","button","data-dismiss","modal",1,"btn","btn-primary"],["id","auditVC",1,"v_compact_t","col-7","form-control-static"],["id","auditVP",1,"v_compact_t","col-7","form-control-static"],["id","auditVPV",1,"v_compact_t","col-7","form-control-static"],[1,"v_compact_t","col-7","form-control-static",2,"overflow-wrap","break-word"],["id","ButtonMore","type","button",1,"btn","btn-secondary",3,"click"],["id","ButtonLess","type","button",1,"btn","btn-secondary",3,"click"]],template:function(t,e){1&t&&(Br(0,"app-sysnavbar"),Nr(1,"div",0),Nr(2,"div",1),Nr(3,"div",2),Nr(4,"div",3),Nr(5,"h2",4),mo(6," Visbo System Audit "),Fr(),Fr(),Fr(),Fr(),Nr(7,"form",5,6),Jr("ngSubmit",(function(){return e.getVisboAudits()})),Nr(9,"div",7),Nr(10,"label",8),mo(11,"From:"),Fr(),Nr(12,"input",9),Jr("ngModelChange",(function(t){return e.auditFrom=t})),Fr(),Nr(13,"label",10),mo(14,"To:"),Fr(),Nr(15,"input",11),Jr("ngModelChange",(function(t){return e.auditTo=t})),Fr(),Fr(),Nr(16,"div",7),Nr(17,"label",12),mo(18,"Filter:"),Fr(),Nr(19,"input",13),Jr("ngModelChange",(function(t){return e.auditText=t})),Fr(),Nr(20,"label",14),mo(21,"Max:"),Fr(),Nr(22,"select",15),Jr("ngModelChange",(function(t){return e.auditCount=t})),Nr(23,"option"),mo(24,"50"),Fr(),Nr(25,"option"),mo(26,"100"),Fr(),Nr(27,"option"),mo(28,"500"),Fr(),Nr(29,"option"),mo(30,"2000"),Fr(),Fr(),Nr(31,"select",16),Jr("ngModelChange",(function(t){return e.auditArea=t})),Lr(32,RE,2,1,"option",17),Fr(),Nr(33,"select",18),Jr("ngModelChange",(function(t){return e.auditType=t})),Lr(34,jE,2,1,"option",17),Fr(),Nr(35,"div",19),Nr(36,"button",20),Jr("click",(function(){return e.getVisboAudits()})),mo(37,"Filter"),Fr(),Nr(38,"button",21),Jr("click",(function(){return e.downloadVisboAudit()})),mo(39,"Download"),Fr(),Nr(40,"button",21),Jr("click",(function(){return e.switchChart()})),mo(41),Fr(),Fr(),Fr(),Fr(),Lr(42,NE,10,10,"div",22),Lr(43,QE,24,2,"div",22),Fr(),Nr(44,"div",23),Lr(45,cL,53,21,"div",24),Fr()),2&t&&(_n(12),jr("ngModel",e.auditFrom),_n(3),jr("ngModel",e.auditTo),_n(4),jr("ngModel",e.auditText),_n(3),jr("ngModel",e.auditCount),_n(9),jr("ngModel",e.auditArea),_n(1),jr("ngForOf",e.auditAreaList),_n(1),jr("ngModel",e.auditType),_n(1),jr("ngForOf",e.auditTypeList),_n(7),fo(e.chartButton),_n(1),jr("ngIf",e.chart),_n(1),jr("ngIf",!e.chart),_n(2),jr("ngIf",e.auditIndex>=0&&e.auditIndex<e.audit.length))},directives:[CC,Eu,Fd,Tu,Ed,Nd,Ou,cu,du,gu,Gc,jc,yS,EM,GE],pipes:[qc],styles:[".v_compact_t[_ngcontent-%COMP%]{margin:0;padding-top:0}"]}),t})();const hL=new th({"Content-Type":"application/json"});let pL=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.serviceUrl=this.env.restUrl.concat("/sysuser")}getSysUsers(t){const e=this.serviceUrl;let i=new nh;return t&&(i=i.append("email",t)),i=i.append("maxcount","100"),this.log(`Calling HTTP Request: ${e} `),this.http.get(e,{headers:hL,params:i}).pipe(D(t=>t.user),qh(t=>this.log(`fetched ${t.length} Users `)),Fh(this.handleError("getSysUsers",[])))}handleError(t="operation",e){return i=>(this.log(`HTTP Request ${t} failed: ${i.error.message} status:${i.status}, Result ${JSON.stringify(e)}`),$h(i))}log(t){this.messageService.add("SysUserService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(jh),Kt(sp))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function gL(t,e){if(1&t&&(Nr(0,"td",12),mo(1),Ua(2,"date"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.status.lastLoginAt,"dd.MM.yy"))}}function mL(t,e){1&t&&(Nr(0,"td",12),mo(1,"Never"),Fr())}function fL(t,e){if(1&t&&(Nr(0,"td",12),mo(1),Ua(2,"date"),Fr()),2&t){const t=Xr().$implicit;_n(1),fo(Ea(2,1,t.status.lastLoginFailedAt,"dd.MM.yy"))}}function vL(t,e){1&t&&(Nr(0,"td",12),mo(1,"Never"),Fr())}function bL(t,e){if(1&t){const t=zr();Nr(0,"tr",18),Jr("click",(function(){ei(t);const i=e.index;return Xr().helperUserIndex(i)})),Nr(1,"td",12),mo(2),Fr(),Nr(3,"td"),Nr(4,"a"),mo(5),Fr(),Fr(),Nr(6,"td",12),mo(7),Ua(8,"date"),Fr(),Lr(9,gL,3,4,"td",19),Lr(10,mL,2,0,"td",19),Lr(11,fL,3,4,"td",19),Lr(12,vL,2,0,"td",19),Nr(13,"td"),Nr(14,"button",20),Jr("click",(function(){ei(t);const i=e.index;return Xr().helperUserIndex(i)})),mo(15,"i"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit,i=e.index;_n(2),fo(i+1),_n(3),fo(t.email),_n(2),fo(Ea(8,7,t.updatedAt,"dd.MM.yy")),_n(2),jr("ngIf",t.status&&t.status.lastLoginAt),_n(1),jr("ngIf",!(t.status&&t.status.lastLoginAt)),_n(1),jr("ngIf",t.status&&t.status.lastLoginFailedAt),_n(1),jr("ngIf",!(t.status&&t.status.lastLoginFailedAt))}}function yL(t,e){if(1&t&&(Nr(0,"div",32),Nr(1,"label",33),mo(2,"Name:"),Fr(),Nr(3,"label",34),mo(4),Fr(),Fr()),2&t){const t=Xr(2);_n(4),bo("",t.user[t.userIndex].profile.firstName," ",t.user[t.userIndex].profile.lastName,"")}}function CL(t,e){if(1&t&&(Nr(0,"div",32),Nr(1,"label",33),mo(2,"Company:"),Fr(),Nr(3,"label",34),mo(4),Fr(),Fr()),2&t){const t=Xr(2);_n(4),fo(t.user[t.userIndex].profile.company)}}function VL(t,e){if(1&t&&(Nr(0,"div",32),Nr(1,"label",33),mo(2,"Phone:"),Fr(),Nr(3,"label",34),mo(4),Fr(),Fr()),2&t){const t=Xr(2);_n(4),fo(t.user[t.userIndex].profile.phone)}}function wL(t,e){if(1&t&&(Nr(0,"div",32),Nr(1,"label",33),mo(2,"Created:"),Fr(),Nr(3,"label",34),mo(4),Ua(5,"date"),Fr(),Fr()),2&t){const t=Xr(2);_n(4),vo("",Ea(5,1,t.user[t.userIndex].createdAt,"dd.MM.yyyy HH:mm:ss")," ")}}function AL(t,e){if(1&t&&(Nr(0,"div",32),Nr(1,"label",33),mo(2,"Updated:"),Fr(),Nr(3,"label",34),mo(4),Ua(5,"date"),Fr(),Fr()),2&t){const t=Xr(2);_n(4),vo("",Ea(5,1,t.user[t.userIndex].updatedAt,"dd.MM.yyyy HH:mm:ss")," ")}}function PL(t,e){if(1&t&&(Nr(0,"label",34),mo(1),Ua(2,"date"),Fr()),2&t){const t=Xr(2);_n(1),vo("",Ea(2,1,t.user[t.userIndex].status.registeredAt,"dd.MM.yyyy HH:mm:ss")," ")}}function kL(t,e){1&t&&(Nr(0,"label",34),mo(1,"Not registered yet "),Fr())}function DL(t,e){if(1&t&&(Nr(0,"div",32),Nr(1,"label",33),mo(2,"Locked:"),Fr(),Nr(3,"label",34),mo(4),Ua(5,"date"),Fr(),Fr()),2&t){const t=Xr(2);_n(4),vo("",Ea(5,1,t.user[t.userIndex].status.lockedUntil,"dd.MM.yyyy HH:mm:ss")," ")}}function ML(t,e){if(1&t&&(Nr(0,"div",32),Nr(1,"label",33),mo(2,"Retries:"),Fr(),Nr(3,"label",34),mo(4),Fr(),Fr()),2&t){const t=Xr(2);_n(4),vo("",t.user[t.userIndex].status.loginRetries," ")}}function IL(t,e){if(1&t&&(Nr(0,"div",32),Nr(1,"label",33),mo(2,"Last Login:"),Fr(),Nr(3,"label",34),mo(4),Ua(5,"date"),Fr(),Fr()),2&t){const t=Xr(2);_n(4),vo("",Ea(5,1,t.user[t.userIndex].status.lastLoginAt,"dd.MM.yyyy HH:mm:ss")," ")}}function SL(t,e){if(1&t){const t=zr();Nr(0,"button",40),Jr("click",(function(){return ei(t),Xr(2).toggleDetail()})),mo(1,"More"),Fr()}}function xL(t,e){if(1&t){const t=zr();Nr(0,"button",40),Jr("click",(function(){return ei(t),Xr(2).toggleDetail()})),mo(1,"Less"),Fr()}}function TL(t,e){if(1&t){const t=zr();Nr(0,"div",21),Nr(1,"div",22),Nr(2,"div",23),Nr(3,"h5",24),mo(4,"Detail of User"),Fr(),Nr(5,"button",25),Nr(6,"span",26),mo(7,"\xd7"),Fr(),Fr(),Fr(),Nr(8,"div",27),Nr(9,"div",1),Nr(10,"div",28),Nr(11,"button",29),Jr("click",(function(){return ei(t),Xr().pageUserIndex(-1)})),mo(12,"Prev"),Fr(),Fr(),Nr(13,"div",30),Nr(14,"button",31),Jr("click",(function(){return ei(t),Xr().pageUserIndex(1)})),mo(15,"Next"),Fr(),Fr(),Fr(),Nr(16,"form"),Nr(17,"div",32),Nr(18,"label",33),mo(19,"User:"),Fr(),Nr(20,"label",34),mo(21),Fr(),Fr(),Lr(22,yL,5,2,"div",35),Lr(23,CL,5,1,"div",35),Lr(24,VL,5,1,"div",35),Lr(25,wL,6,4,"div",35),Lr(26,AL,6,4,"div",35),Nr(27,"div",32),Nr(28,"label",33),mo(29,"Registered:"),Fr(),Lr(30,PL,3,4,"label",36),Lr(31,kL,2,0,"label",36),Fr(),Lr(32,DL,6,4,"div",35),Lr(33,ML,5,1,"div",35),Lr(34,IL,6,4,"div",35),Fr(),Fr(),Nr(35,"div",37),Lr(36,SL,2,0,"button",38),Lr(37,xL,2,0,"button",38),Nr(38,"button",39),mo(39,"Close"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr();_n(21),vo("",t.user[t.userIndex].email," "),_n(1),jr("ngIf",t.user[t.userIndex].profile),_n(1),jr("ngIf",t.user[t.userIndex].profile),_n(1),jr("ngIf",t.user[t.userIndex].profile),_n(1),jr("ngIf",t.showMore),_n(1),jr("ngIf",t.showMore),_n(4),jr("ngIf",t.user[t.userIndex].status&&t.user[t.userIndex].status.registeredAt),_n(1),jr("ngIf",!(t.user[t.userIndex].status&&t.user[t.userIndex].status.registeredAt)),_n(1),jr("ngIf",t.user[t.userIndex].status&&t.user[t.userIndex].status.lockedUntil),_n(1),jr("ngIf",t.user[t.userIndex].status&&t.user[t.userIndex].status.loginRetries),_n(1),jr("ngIf",t.user[t.userIndex].status),_n(2),jr("ngIf",!t.showMore),_n(1),jr("ngIf",t.showMore)}}let _L=(()=>{class t{constructor(t,e,i,n,s){this.sysuserService=t,this.messageService=e,this.alertService=i,this.route=n,this.router=s}ngOnInit(){this.getSysUsers(),this.sortTable(void 0)}getSysUsers(){this.userMatch&&(this.userMatch=this.userMatch.trim()),this.log("Get with filter "+this.userMatch),this.sysuserService.getSysUsers(this.userMatch).subscribe(t=>{this.user=t,this.sortTable(void 0),this.log("get success")},t=>{this.log(`get failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}helperUserIndex(t){this.userIndex=t}pageUserIndex(t){let e=this.userIndex+t;e<0&&(e=0),e>=this.user.length&&(e=this.user.length-1),this.userIndex=e}helperShortenText(t,e){return Lh(t,e)}toggleDetail(){this.log("Toggle ShowMore"),this.showMore=!this.showMore}sortTable(t){this.user&&(this.log("Sort Table Column "+t),void 0!==t?t!==this.sortColumn?(this.sortColumn=t,this.sortAscending=void 0):void 0!==this.sortAscending&&(this.sortAscending=!this.sortAscending):(this.sortColumn=2,this.sortAscending=void 0),void 0===this.sortAscending&&(this.sortAscending=1===t),1===this.sortColumn?this.user.sort((function(t,e){return xh(t.email,e.email)})):2===this.sortColumn?this.user.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})):3===this.sortColumn?this.user.sort((function(t,e){return Th(t.status&&t.status.lastLoginAt?new Date(t.status.lastLoginAt):new Date("2001-01-01"),e.status&&e.status.lastLoginAt?new Date(e.status.lastLoginAt):new Date("2001-01-01"))})):4===this.sortColumn&&this.user.sort((function(t,e){return Th(t.status&&t.status.lastLoginFailedAt?new Date(t.status.lastLoginFailedAt):new Date("2001-01-01"),e.status&&e.status.lastLoginFailedAt?new Date(e.status.lastLoginFailedAt):new Date("2001-01-01"))})),this.sortAscending||this.user.reverse())}log(t){this.messageService.add("Sys User: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(pL),Rr(jh),Rr(Mf),Rr(Bg),Rr(rf))},t.\u0275cmp=le({type:t,selectors:[["app-sysuser"]],decls:34,vars:3,consts:[[1,"well"],[1,"row"],[1,"panel-heading"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group","row"],["for","userMatch",1,"col-2","col-form-label"],["id","userMatch","type","text","name","userMatch",1,"col-2","col-sm-4","form-control","mx-1",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-primary","mx-1",3,"click"],[1,"container-fluid"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[1,"d-none","d-md-table-cell"],[3,"click"],[1,"d-none","d-md-table-cell",3,"click"],["data-toggle","modal","data-target","#UserDetail",3,"click",4,"ngFor","ngForOf"],["id","UserDetail","tabindex","-1","role","dialog","aria-labelledby","User Detail","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-lg modal-dialog-centered","role","document",4,"ngIf"],["data-toggle","modal","data-target","#UserDetail",3,"click"],["class","d-none d-md-table-cell",4,"ngIf"],["title","Detail of Visbo User","data-toggle","modal","data-target","#UserDetail",1,"Detail",3,"click"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","UserDetailTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"col-10"],["type","button","title","Prev User",1,"btn","btn-secondary",3,"click"],[1,"col-2"],["type","button","title","Next User",1,"btn","btn-secondary","align-self-end",3,"click"],[1,"form-group"],[1,"col-4","col-form-label"],[1,"col-7","form-control-static"],["class","form-group",4,"ngIf"],["class","col-7 form-control-static",4,"ngIf"],[1,"modal-footer","align-items-end"],["type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["type","button","data-dismiss","modal",1,"btn","btn-primary"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(t,e){1&t&&(Br(0,"app-sysnavbar"),Nr(1,"div",0),Nr(2,"div",1),Nr(3,"h2",2),mo(4," Visbo Users "),Fr(),Fr(),Nr(5,"form",3,4),Jr("ngSubmit",(function(){return e.getSysUsers()})),Nr(7,"div",5),Nr(8,"label",6),mo(9,"Filter:"),Fr(),Nr(10,"input",7),Jr("ngModelChange",(function(t){return e.userMatch=t})),Fr(),Nr(11,"button",8),Jr("click",(function(){return e.getSysUsers()})),mo(12,"Filter"),Fr(),Fr(),Fr(),Nr(13,"div",9),Nr(14,"div",10),Nr(15,"table",11),Nr(16,"thead"),Nr(17,"tr"),Nr(18,"th",12),mo(19,"Nr."),Fr(),Nr(20,"th",13),Jr("click",(function(){return e.sortTable(1)})),mo(21,"User"),Fr(),Nr(22,"th",14),Jr("click",(function(){return e.sortTable(2)})),mo(23,"Updated"),Fr(),Nr(24,"th",14),Jr("click",(function(){return e.sortTable(3)})),mo(25,"Last Login"),Fr(),Nr(26,"th",14),Jr("click",(function(){return e.sortTable(4)})),mo(27,"Failed Login"),Fr(),Nr(28,"th"),mo(29,"Detail"),Fr(),Fr(),Fr(),Nr(30,"tbody"),Lr(31,bL,16,10,"tr",15),Fr(),Fr(),Fr(),Fr(),Fr(),Nr(32,"div",16),Lr(33,TL,40,13,"div",17),Fr()),2&t&&(_n(10),jr("ngModel",e.userMatch),_n(21),jr("ngForOf",e.user),_n(2),jr("ngIf",e.userIndex>=0&&e.userIndex<e.user.length))},directives:[CC,Eu,Fd,Tu,Ed,Nd,Ou,Gc,jc],pipes:[qc],styles:[""]}),t})(),UL=(()=>{class t{constructor(t,e,i){this.http=t,this.messageService=e,this.env=i,this.serviceUrl=this.env.restUrl.concat("/syslog")}getSysLogs(t){const e=this.serviceUrl,i=new th({"Content-Type":"application/json"});let n=new nh;return n=n.append("ageDays",t.toString()),this.log("Calling HTTP Request: "+e),this.http.get(e,{headers:i,params:n}).pipe(D(t=>t.files),qh(t=>this.log(`fetched ${t.length} Log Files `)),Fh(this.handleError("getSysLog")))}getSysLog(t,e){const i=`${this.serviceUrl}/file/${t}/${e}`;this.log("Calling HTTP Request for a specific log file: "+i);let n=void 0;return n={},n.observe="body",n.responseType="text",this.http.get(i,n).pipe(qh(()=>this.log("fetched Log File Response ")),Fh(this.handleError(`getSysLog name:${e} `)))}handleError(t="operation",e){return i=>(this.log(`HTTP Request ${t} failed: ${i.error.message} status:${i.status}, Result ${JSON.stringify(e)}`),$h(i))}log(t){this.messageService.add("VisboLogsService: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(gh),Kt(jh),Kt(sp))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function OL(t,e){if(1&t){const t=zr();Nr(0,"tr",16),Jr("click",(function(){ei(t);const i=e.index;return Xr().helperFileIndex(i)}))("click",(function(){ei(t);const i=e.$implicit;return Xr().getVisboLogFile(i)})),Nr(1,"td",15),Nr(2,"a"),mo(3),Fr(),Fr(),Nr(4,"td",15),mo(5),Fr(),Nr(6,"td"),mo(7),Ua(8,"date"),Fr(),Nr(9,"td"),mo(10),Fr(),Nr(11,"td"),Nr(12,"button",29),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr().getVisboLogFile(i)})),mo(13,"i"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit,i=Xr();_n(3),fo(t.name),_n(2),fo(t.folder),_n(2),fo(Ea(8,4,t.updatedAt,"dd.MM HH:mm")),_n(3),fo(i.formatBytes(t.size,void 0))}}function EL(t,e){if(1&t){const t=zr();Nr(0,"div",30),Nr(1,"form"),Nr(2,"div",7),Nr(3,"label",31),mo(4,"VC:"),Fr(),Nr(5,"select",32),Jr("ngModelChange",(function(e){return ei(t),Xr().logLevelSetting.value.VC=e})),Nr(6,"option",33),mo(7,"Fatal"),Fr(),Nr(8,"option",34),mo(9,"Warning"),Fr(),Nr(10,"option",35),mo(11,"Information"),Fr(),Nr(12,"option",36),mo(13,"Debug"),Fr(),Nr(14,"option",37),mo(15,"Trace"),Fr(),Fr(),Fr(),Nr(16,"div",7),Nr(17,"label",31),mo(18,"VP:"),Fr(),Nr(19,"select",38),Jr("ngModelChange",(function(e){return ei(t),Xr().logLevelSetting.value.VP=e})),Nr(20,"option",33),mo(21,"Fatal"),Fr(),Nr(22,"option",34),mo(23,"Warning"),Fr(),Nr(24,"option",35),mo(25,"Information"),Fr(),Nr(26,"option",36),mo(27,"Debug"),Fr(),Nr(28,"option",37),mo(29,"Trace"),Fr(),Fr(),Fr(),Nr(30,"div",7),Nr(31,"label",31),mo(32,"VPV:"),Fr(),Nr(33,"select",39),Jr("ngModelChange",(function(e){return ei(t),Xr().logLevelSetting.value.VPV=e})),Nr(34,"option",33),mo(35,"Fatal"),Fr(),Nr(36,"option",34),mo(37,"Warning"),Fr(),Nr(38,"option",35),mo(39,"Information"),Fr(),Nr(40,"option",36),mo(41,"Debug"),Fr(),Nr(42,"option",37),mo(43,"Trace"),Fr(),Fr(),Fr(),Nr(44,"div",7),Nr(45,"label",31),mo(46,"USER:"),Fr(),Nr(47,"select",40),Jr("ngModelChange",(function(e){return ei(t),Xr().logLevelSetting.value.USER=e})),Nr(48,"option",33),mo(49,"Fatal"),Fr(),Nr(50,"option",34),mo(51,"Warning"),Fr(),Nr(52,"option",35),mo(53,"Information"),Fr(),Nr(54,"option",36),mo(55,"Debug"),Fr(),Nr(56,"option",37),mo(57,"Trace"),Fr(),Fr(),Fr(),Nr(58,"div",7),Nr(59,"label",31),mo(60,"MAIL:"),Fr(),Nr(61,"select",41),Jr("ngModelChange",(function(e){return ei(t),Xr().logLevelSetting.value.MAIL=e})),Nr(62,"option",33),mo(63,"Fatal"),Fr(),Nr(64,"option",34),mo(65,"Warning"),Fr(),Nr(66,"option",35),mo(67,"Information"),Fr(),Nr(68,"option",36),mo(69,"Debug"),Fr(),Nr(70,"option",37),mo(71,"Trace"),Fr(),Fr(),Fr(),Nr(72,"div",7),Nr(73,"label",31),mo(74,"OTHER:"),Fr(),Nr(75,"select",42),Jr("ngModelChange",(function(e){return ei(t),Xr().logLevelSetting.value.OTHER=e})),Nr(76,"option",33),mo(77,"Fatal"),Fr(),Nr(78,"option",34),mo(79,"Warning"),Fr(),Nr(80,"option",35),mo(81,"Information"),Fr(),Nr(82,"option",36),mo(83,"Debug"),Fr(),Nr(84,"option",37),mo(85,"Trace"),Fr(),Fr(),Fr(),Nr(86,"div",7),Nr(87,"label",31),mo(88,"All:"),Fr(),Nr(89,"select",43),Jr("ngModelChange",(function(e){return ei(t),Xr().logLevelSetting.value.All=e})),Nr(90,"option",33),mo(91,"Fatal"),Fr(),Nr(92,"option",34),mo(93,"Warning"),Fr(),Nr(94,"option",35),mo(95,"Information"),Fr(),Nr(96,"option",36),mo(97,"Debug"),Fr(),Nr(98,"option",37),mo(99,"Trace"),Fr(),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr();_n(5),jr("ngModel",t.logLevelSetting.value.VC),_n(14),jr("ngModel",t.logLevelSetting.value.VP),_n(14),jr("ngModel",t.logLevelSetting.value.VPV),_n(14),jr("ngModel",t.logLevelSetting.value.USER),_n(14),jr("ngModel",t.logLevelSetting.value.MAIL),_n(14),jr("ngModel",t.logLevelSetting.value.OTHER),_n(14),jr("ngModel",t.logLevelSetting.value.All)}}function LL(t,e){if(1&t){const t=zr();Nr(0,"tr",13),Jr("click",(function(){ei(t);const i=e.index;return Xr().helperTaskIndex(i)})),Nr(1,"td"),Nr(2,"a"),mo(3),Fr(),Fr(),Nr(4,"td",14),mo(5),Ua(6,"date"),Fr(),Nr(7,"td",14),mo(8),Ua(9,"date"),Fr(),Nr(10,"td"),mo(11),Fr(),Nr(12,"td"),Nr(13,"button",15),mo(14,"i"),Fr(),Fr(),Fr()}if(2&t){const t=e.$implicit;_n(3),fo(t.name),_n(2),fo(Ea(6,4,t.value.lastRun,"dd.MM HH:mm:ss")),_n(3),fo(Ea(9,7,t.value.nextRun,"dd.MM HH:mm:ss")),_n(3),fo(t.value.taskSpecific&&t.value.taskSpecific.result)}}function GL(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"div",27),Nr(2,"label",28),mo(3,"Result:"),Fr(),Nr(4,"label",29),mo(5),Fr(),Fr(),Nr(6,"div",27),Nr(7,"label",28),mo(8,"Message:"),Fr(),Nr(9,"label",29),mo(10),Fr(),Fr(),Fr()),2&t){const t=Xr(3);_n(5),fo(t.vcsetting[t.taskIndex].value.taskSpecific.result),_n(5),fo(t.vcsetting[t.taskIndex].value.taskSpecific.resultDescription)}}function RL(t,e){if(1&t&&(Nr(0,"div"),Nr(1,"div",27),Nr(2,"label",28),mo(3,"Last Run:"),Fr(),Nr(4,"label",29),mo(5),Ua(6,"date"),Fr(),Fr(),Nr(7,"div",27),Nr(8,"label",28),mo(9,"Next Run:"),Fr(),Nr(10,"label",29),mo(11),Ua(12,"date"),Fr(),Fr(),Nr(13,"div",27),Nr(14,"label",28),mo(15,"Last Duration:"),Fr(),Nr(16,"label",29),mo(17),Ua(18,"date"),Fr(),Fr(),Lr(19,GL,11,2,"div",30),Fr()),2&t){const t=Xr(2);_n(5),fo(Ea(6,4,t.vcsetting[t.taskIndex].value.lastRun,"dd.MM HH:mm:ss")),_n(6),fo(Ea(12,7,t.vcsetting[t.taskIndex].value.nextRun,"dd.MM HH:mm:ss")),_n(6),fo(Ea(18,10,t.vcsetting[t.taskIndex].value.lastDuration,"mm:ss:SSS")),_n(2),jr("ngIf",t.vcsetting[t.taskIndex].value.taskSpecific)}}function jL(t,e){if(1&t){const t=zr();Nr(0,"div",16),Nr(1,"div",17),Nr(2,"div",18),Nr(3,"h5",19),mo(4,"Detail of Task"),Fr(),Nr(5,"button",20),Nr(6,"span",21),mo(7,"\xd7"),Fr(),Fr(),Fr(),Nr(8,"div",22),Nr(9,"div",1),Nr(10,"div",23),Nr(11,"button",24),Jr("click",(function(){return ei(t),Xr().pageTaskIndex(-1)})),mo(12,"Prev"),Fr(),Fr(),Nr(13,"div",25),Nr(14,"button",26),Jr("click",(function(){return ei(t),Xr().pageTaskIndex(1)})),mo(15,"Next"),Fr(),Fr(),Fr(),Nr(16,"form"),Nr(17,"div",27),Nr(18,"label",28),mo(19,"Task:"),Fr(),Nr(20,"label",29),mo(21),Fr(),Fr(),Lr(22,RL,20,13,"div",30),Fr(),Fr(),Nr(23,"div",31),Nr(24,"button",32),mo(25,"Close"),Fr(),Nr(26,"button",33),Jr("click",(function(){return ei(t),Xr().executeTask()})),mo(27,"Execute"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr();_n(21),vo("",t.vcsetting[t.taskIndex].name," "),_n(1),jr("ngIf",t.vcsetting[t.taskIndex].value)}}function $L(t,e){if(1&t){const t=zr();Nr(0,"tr",11),Jr("click",(function(){ei(t);const i=e.$implicit;return Xr().editConfigName(i.name)})),Nr(1,"td"),Nr(2,"a"),mo(3),Fr(),Fr(),Nr(4,"td"),mo(5),Fr(),Nr(6,"td"),mo(7),Ua(8,"date"),Fr(),Fr()}if(2&t){const t=e.$implicit,i=Xr();_n(3),fo(t.name),_n(2),fo(i.getMainInfo(t)),_n(2),fo(Ea(8,3,t.updatedAt,"dd.MM HH:mm:ss"))}}function NL(t,e){1&t&&(Nr(0,"h5",23),mo(1,"Config UI URL"),Fr())}function FL(t,e){1&t&&(Nr(0,"h5",23),mo(1,"Config Debug Setting"),Fr())}function BL(t,e){1&t&&(Nr(0,"h5",23),mo(1,"Config Password Policy"),Fr())}function HL(t,e){1&t&&(Nr(0,"h5",23),mo(1,"Config SMTP Setting"),Fr())}function KL(t,e){1&t&&(Nr(0,"h5",23),mo(1,"Config Redis Address"),Fr())}function qL(t,e){1&t&&(Nr(0,"h5",23),mo(1,"Config Maximum Log File Age"),Fr())}function zL(t,e){if(1&t){const t=zr();Nr(0,"form"),Nr(1,"div"),Nr(2,"div",24),Nr(3,"label",25),mo(4,"UI Url:"),Fr(),Nr(5,"input",26),Jr("ngModelChange",(function(e){ei(t);const i=Xr(2);return i.vcsetting[i.editIndex].value.UIUrl=e})),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(5),jr("ngModel",t.vcsetting[t.editIndex].value.UIUrl)}}function QL(t,e){if(1&t){const t=zr();Nr(0,"form"),Nr(1,"div"),Nr(2,"div",24),Nr(3,"label",27),mo(4,"PW Policy Regex:"),Fr(),Nr(5,"input",28),Jr("ngModelChange",(function(e){ei(t);const i=Xr(2);return i.vcsetting[i.editIndex].value.PWPolicy=e})),Fr(),Fr(),Nr(6,"div",24),Nr(7,"label",29),mo(8,"PW Policy Description:"),Fr(),Nr(9,"textarea",30),Jr("ngModelChange",(function(e){ei(t);const i=Xr(2);return i.vcsetting[i.editIndex].value.Description=e})),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(5),jr("ngModel",t.vcsetting[t.editIndex].value.PWPolicy),_n(4),jr("ngModel",t.vcsetting[t.editIndex].value.Description)}}function WL(t,e){if(1&t){const t=zr();Nr(0,"div"),Nr(1,"div",24),Nr(2,"label",31),mo(3,"SMTP Host:"),Fr(),Nr(4,"input",32),Jr("ngModelChange",(function(e){ei(t);const i=Xr(3);return i.vcsetting[i.editIndex].value.host=e})),Fr(),Fr(),Nr(5,"div",24),Nr(6,"label",33),mo(7,"User:"),Fr(),Nr(8,"input",34),Jr("ngModelChange",(function(e){ei(t);const i=Xr(3);return i.vcsetting[i.editIndex].value.auth.user=e})),Fr(),Fr(),Nr(9,"div",24),Nr(10,"label",35),mo(11,"Password:"),Fr(),Nr(12,"input",36),Jr("ngModelChange",(function(e){ei(t);const i=Xr(3);return i.vcsetting[i.editIndex].value.auth.pass=e})),Fr(),Fr(),Nr(13,"div",24),Nr(14,"label",37),mo(15,"Port:"),Fr(),Nr(16,"input",38),Jr("ngModelChange",(function(e){ei(t);const i=Xr(3);return i.vcsetting[i.editIndex].value.port=e})),Fr(),Fr(),Nr(17,"div",24),Nr(18,"label",39),mo(19,"Connection Timeout:"),Fr(),Nr(20,"input",40),Jr("ngModelChange",(function(e){ei(t);const i=Xr(3);return i.vcsetting[i.editIndex].value.connectionTimeout=e})),Fr(),Fr(),Nr(21,"div",24),Nr(22,"label",41),mo(23,"Greeting Timeout:"),Fr(),Nr(24,"input",42),Jr("ngModelChange",(function(e){ei(t);const i=Xr(3);return i.vcsetting[i.editIndex].value.greetingTimeout=e})),Fr(),Fr(),Nr(25,"div",43),Nr(26,"input",44,45),Jr("ngModelChange",(function(e){ei(t);const i=Xr(3);return i.vcsetting[i.editIndex].value.pool=e})),Fr(),Nr(28,"label",46),mo(29,"Pool Connections"),Fr(),Fr(),Nr(30,"div",43),Nr(31,"input",47,48),Jr("ngModelChange",(function(e){ei(t);const i=Xr(3);return i.vcsetting[i.editIndex].value.secure=e})),Fr(),Nr(33,"label",49),mo(34,"Secure Connection"),Fr(),Fr(),Nr(35,"div",43),Nr(36,"input",50,51),Jr("ngModelChange",(function(e){ei(t);const i=Xr(3);return i.vcsetting[i.editIndex].value.requireTLS=e})),Fr(),Nr(38,"label",52),mo(39,"Require TLS"),Fr(),Fr(),Fr()}if(2&t){const t=Xr(3);_n(4),jr("ngModel",t.vcsetting[t.editIndex].value.host),_n(4),jr("ngModel",t.vcsetting[t.editIndex].value.auth.user),_n(4),jr("ngModel",t.vcsetting[t.editIndex].value.auth.pass),_n(4),jr("ngModel",t.vcsetting[t.editIndex].value.port),_n(4),jr("ngModel",t.vcsetting[t.editIndex].value.connectionTimeout),_n(4),jr("ngModel",t.vcsetting[t.editIndex].value.greetingTimeout),_n(2),jr("ngModel",t.vcsetting[t.editIndex].value.pool),_n(5),jr("ngModel",t.vcsetting[t.editIndex].value.secure),_n(5),jr("ngModel",t.vcsetting[t.editIndex].value.requireTLS)}}function JL(t,e){if(1&t&&(Nr(0,"form"),Lr(1,WL,40,9,"div",19),Fr()),2&t){const t=Xr(2);_n(1),jr("ngIf",t.editIndex>=0&&"SMTP"==t.vcsetting[t.editIndex].name)}}function YL(t,e){if(1&t){const t=zr();Nr(0,"form"),Nr(1,"div"),Nr(2,"div",24),Nr(3,"label",53),mo(4,"Host:"),Fr(),Nr(5,"input",54),Jr("ngModelChange",(function(e){ei(t);const i=Xr(2);return i.vcsetting[i.editIndex].value.host=e})),Fr(),Fr(),Nr(6,"div",24),Nr(7,"label",55),mo(8,"Port:"),Fr(),Nr(9,"input",56),Jr("ngModelChange",(function(e){ei(t);const i=Xr(2);return i.vcsetting[i.editIndex].value.port=e})),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(5),jr("ngModel",t.vcsetting[t.editIndex].value.host),_n(4),jr("ngModel",t.vcsetting[t.editIndex].value.port)}}function ZL(t,e){if(1&t){const t=zr();Nr(0,"form"),Nr(1,"div",57),Nr(2,"label",58),mo(3,"VC:"),Fr(),Nr(4,"select",59),Jr("ngModelChange",(function(e){ei(t);const i=Xr(2);return i.vcsetting[i.editIndex].value.VC=e})),Nr(5,"option",60),mo(6,"Fatal"),Fr(),Nr(7,"option",61),mo(8,"Warning"),Fr(),Nr(9,"option",62),mo(10,"Information"),Fr(),Nr(11,"option",63),mo(12,"Debug"),Fr(),Nr(13,"option",64),mo(14,"Trace"),Fr(),Fr(),Fr(),Nr(15,"div",57),Nr(16,"label",58),mo(17,"VP:"),Fr(),Nr(18,"select",65),Jr("ngModelChange",(function(e){ei(t);const i=Xr(2);return i.vcsetting[i.editIndex].value.VP=e})),Nr(19,"option",60),mo(20,"Fatal"),Fr(),Nr(21,"option",61),mo(22,"Warning"),Fr(),Nr(23,"option",62),mo(24,"Information"),Fr(),Nr(25,"option",63),mo(26,"Debug"),Fr(),Nr(27,"option",64),mo(28,"Trace"),Fr(),Fr(),Fr(),Nr(29,"div",57),Nr(30,"label",58),mo(31,"VPV:"),Fr(),Nr(32,"select",66),Jr("ngModelChange",(function(e){ei(t);const i=Xr(2);return i.vcsetting[i.editIndex].value.VPV=e})),Nr(33,"option",60),mo(34,"Fatal"),Fr(),Nr(35,"option",61),mo(36,"Warning"),Fr(),Nr(37,"option",62),mo(38,"Information"),Fr(),Nr(39,"option",63),mo(40,"Debug"),Fr(),Nr(41,"option",64),mo(42,"Trace"),Fr(),Fr(),Fr(),Nr(43,"div",57),Nr(44,"label",58),mo(45,"USER:"),Fr(),Nr(46,"select",67),Jr("ngModelChange",(function(e){ei(t);const i=Xr(2);return i.vcsetting[i.editIndex].value.USER=e})),Nr(47,"option",60),mo(48,"Fatal"),Fr(),Nr(49,"option",61),mo(50,"Warning"),Fr(),Nr(51,"option",62),mo(52,"Information"),Fr(),Nr(53,"option",63),mo(54,"Debug"),Fr(),Nr(55,"option",64),mo(56,"Trace"),Fr(),Fr(),Fr(),Nr(57,"div",57),Nr(58,"label",58),mo(59,"MAIL:"),Fr(),Nr(60,"select",68),Jr("ngModelChange",(function(e){ei(t);const i=Xr(2);return i.vcsetting[i.editIndex].value.MAIL=e})),Nr(61,"option",60),mo(62,"Fatal"),Fr(),Nr(63,"option",61),mo(64,"Warning"),Fr(),Nr(65,"option",62),mo(66,"Information"),Fr(),Nr(67,"option",63),mo(68,"Debug"),Fr(),Nr(69,"option",64),mo(70,"Trace"),Fr(),Fr(),Fr(),Nr(71,"div",57),Nr(72,"label",58),mo(73,"OTHER:"),Fr(),Nr(74,"select",69),Jr("ngModelChange",(function(e){ei(t);const i=Xr(2);return i.vcsetting[i.editIndex].value.OTHER=e})),Nr(75,"option",60),mo(76,"Fatal"),Fr(),Nr(77,"option",61),mo(78,"Warning"),Fr(),Nr(79,"option",62),mo(80,"Information"),Fr(),Nr(81,"option",63),mo(82,"Debug"),Fr(),Nr(83,"option",64),mo(84,"Trace"),Fr(),Fr(),Fr(),Nr(85,"div",57),Nr(86,"label",58),mo(87,"All:"),Fr(),Nr(88,"select",70),Jr("ngModelChange",(function(e){ei(t);const i=Xr(2);return i.vcsetting[i.editIndex].value.All=e})),Nr(89,"option",60),mo(90,"Fatal"),Fr(),Nr(91,"option",61),mo(92,"Warning"),Fr(),Nr(93,"option",62),mo(94,"Information"),Fr(),Nr(95,"option",63),mo(96,"Debug"),Fr(),Nr(97,"option",64),mo(98,"Trace"),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(4),jr("ngModel",t.vcsetting[t.editIndex].value.VC),_n(14),jr("ngModel",t.vcsetting[t.editIndex].value.VP),_n(14),jr("ngModel",t.vcsetting[t.editIndex].value.VPV),_n(14),jr("ngModel",t.vcsetting[t.editIndex].value.USER),_n(14),jr("ngModel",t.vcsetting[t.editIndex].value.MAIL),_n(14),jr("ngModel",t.vcsetting[t.editIndex].value.OTHER),_n(14),jr("ngModel",t.vcsetting[t.editIndex].value.All)}}function XL(t,e){if(1&t){const t=zr();Nr(0,"form"),Nr(1,"div"),Nr(2,"div",24),Nr(3,"label",71),mo(4,"Max Age:"),Fr(),Nr(5,"input",72),Jr("ngModelChange",(function(e){ei(t);const i=Xr(2);return i.vcsetting[i.editIndex].value.duration=e})),Fr(),Fr(),Fr(),Fr()}if(2&t){const t=Xr(2);_n(5),jr("ngModel",t.vcsetting[t.editIndex].value.duration)}}function tG(t,e){if(1&t){const t=zr();Nr(0,"button",73),Jr("click",(function(){ei(t);const e=Xr(2);return e.updateConfig(e.vcsetting[e.editIndex])})),mo(1,"Update"),Fr()}}function eG(t,e){if(1&t&&(Nr(0,"div",12),Nr(1,"div",13),Nr(2,"div",14),Lr(3,NL,2,0,"h5",15),Lr(4,FL,2,0,"h5",15),Lr(5,BL,2,0,"h5",15),Lr(6,HL,2,0,"h5",15),Lr(7,KL,2,0,"h5",15),Lr(8,qL,2,0,"h5",15),Nr(9,"button",16),Nr(10,"span",17),mo(11,"\xd7"),Fr(),Fr(),Fr(),Nr(12,"div",18),Lr(13,zL,6,1,"form",19),Lr(14,QL,10,2,"form",19),Lr(15,JL,2,1,"form",19),Lr(16,YL,10,2,"form",19),Lr(17,ZL,99,7,"form",19),Lr(18,XL,6,1,"form",19),Fr(),Nr(19,"div",20),Nr(20,"button",21),mo(21,"Close"),Fr(),Lr(22,tG,2,0,"button",22),Fr(),Fr(),Fr()),2&t){const t=Xr();_n(3),jr("ngIf","UI URL"==t.vcsetting[t.editIndex].name),_n(1),jr("ngIf","DEBUG"==t.vcsetting[t.editIndex].name),_n(1),jr("ngIf","PW Policy"==t.vcsetting[t.editIndex].name),_n(1),jr("ngIf","SMTP"==t.vcsetting[t.editIndex].name),_n(1),jr("ngIf","REDIS"==t.vcsetting[t.editIndex].name),_n(1),jr("ngIf","Log Age"==t.vcsetting[t.editIndex].name),_n(5),jr("ngIf","UI URL"==t.vcsetting[t.editIndex].name),_n(1),jr("ngIf","PW Policy"==t.vcsetting[t.editIndex].name),_n(1),jr("ngIf","SMTP"==t.vcsetting[t.editIndex].name),_n(1),jr("ngIf","REDIS"==t.vcsetting[t.editIndex].name),_n(1),jr("ngIf","DEBUG"==t.vcsetting[t.editIndex].name),_n(1),jr("ngIf","Log Age"==t.vcsetting[t.editIndex].name),_n(4),jr("ngIf",t.hasSystemPerm(t.permSystem.Modify))}}const iG=[{path:"login",component:Nv},{path:"register",component:tb},{path:"registerconfirm",component:ib},{path:"oauthconfirm",component:sb},{path:"register/:id",component:tb},{path:"pwforgotten",component:db},{path:"pwreset",component:fb},{path:"dashboard",component:xb,canActivate:[rb]},{path:"vc",component:Ob,canActivate:[rb]},{path:"vcDetail/:id",component:pC,canActivate:[rb]},{path:"vcAudit/:id",component:WC,canActivate:[rb]},{path:"vp",component:VP,canActivate:[rb]},{path:"vp/:id",component:VP,canActivate:[rb]},{path:"vpDetail/:id",component:dD,canActivate:[rb]},{path:"vpAudit/:id",component:AV,canActivate:[rb]},{path:"vpViewCost/:id",component:PT,canActivate:[rb]},{path:"vpViewDeadlines/:id",component:PT,canActivate:[rb]},{path:"vpViewDeliveries/:id",component:PT,canActivate:[rb]},{path:"vpView/:id",component:PT,canActivate:[rb]},{path:"vpKeyMetrics/:id",component:PT,canActivate:[rb]},{path:"vpRestrict/:id",component:$T,canActivate:[rb]},{path:"vpv",component:$D,canActivate:[rb]},{path:"vpv/:id",component:$D,canActivate:[rb]},{path:"vpf/:id",component:OM,canActivate:[rb]},{path:"settings",component:NT,canActivate:[rb]},{path:"profile",component:n_,canActivate:[rb]},{path:"sysadmins",component:PU,canActivate:[rb]},{path:"sysvc",component:xU,canActivate:[rb]},{path:"sysvcDetail/:id",component:WO,canActivate:[rb]},{path:"sysvp/:id",component:eE,canActivate:[rb]},{path:"sysvpDetail/:id",component:LE,canActivate:[rb]},{path:"sysaudit",component:uL,canActivate:[rb]},{path:"sysuser",component:_L,canActivate:[rb]},{path:"syslog",component:(()=>{class t{constructor(t,e,i,n,s){this.visbocenterService=t,this.visbosettingService=e,this.syslogService=i,this.messageService=n,this.alertService=s}ngOnInit(){this.systemVC=this.visbocenterService.getSysVCId(),this.ageDays=3,this.sortColumn=2,this.getVisboLogs(),this.sortTable(1),this.log("syslog init VC ID "+this.systemVC)}getVisboLogs(){this.log("syslog getVisboLogs"),this.sortAscending=!this.sortAscending,this.syslogService.getSysLogs(this.ageDays).subscribe(t=>{this.files=t,this.sortTable(this.sortColumn),this.log("get Logs success")},t=>{this.log(`get Logs failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}helperFileIndex(t){this.fileIndex=t}switchView(){this.logDataShow=!this.logDataShow}getVisboLogFile(t){this.log("syslog getVisboLogFile"),this.syslogService.getSysLog(t.folder,t.name).subscribe(e=>{this.log("get Log Content success Start: "+e.substring(0,30)),this.downloadFile(e,t.name)},t=>{this.log(`get Log Content failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}getLogLevel(){this.log("syslog getLogLevel"),this.visbosettingService.getVCSettingByName(this.systemVC,"DEBUG",!0).subscribe(t=>{this.logLevelSetting=t[0],this.log("get Log Level success "+JSON.stringify(this.logLevelSetting))},t=>{this.log(`get Log Level failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}setLogLevel(){this.log("syslog setLogLevel"),this.visbosettingService.updateVCSetting(this.systemVC,this.logLevelSetting,!0).subscribe(t=>{this.log("set Log Level success "+JSON.stringify(t)),this.alertService.success("Successfully changed Log Level",!0),this.logLevelSetting=t},t=>{this.log(`set Log Level failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}downloadFile(t,e){this.log("download File succeeded Len: "+t.length);const i=new Blob([t],{type:"text/plain"}),n=window.URL.createObjectURL(i);this.log("Open URL "+n);const s=document.createElement("a");document.body.appendChild(s),s.href=n,s.download=e+".log",s.click(),window.URL.revokeObjectURL(n)}formatBytes(t,e=2){if(0===t)return"0 Bytes";const i=e||2,n=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,n)).toFixed(i))+" "+["Bytes","KB","MB","GB"][n]}sortTable(t){this.files&&(void 0===t&&void 0!==this.sortColumn||(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t:!this.sortAscending),1===this.sortColumn?this.files.sort((function(t,e){return xh(t.name,e.name)})):2===this.sortColumn?this.files.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})):3===this.sortColumn&&this.files.sort((function(t,e){return t.size-e.size})),this.sortAscending||this.files.reverse())}log(t){this.messageService.add("Sys Logs: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Ev),Rr(Eb),Rr(UL),Rr(jh),Rr(Mf))},t.\u0275cmp=le({type:t,selectors:[["app-syslog"]],decls:62,vars:3,consts:[[1,"well"],[1,"container-fluid"],[1,"row"],[1,"col"],[1,"panel-heading"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group","row"],["for","auditCount",1,"col-form-label"],["name","ageDays",1,"col-1","form-control","mx-1",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-primary","mx-1",3,"click"],["type","button","data-toggle","modal","data-target","#ChangeLogLevel",1,"btn","btn-sm","btn-primary","float-right",3,"click"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[1,"d-none","d-md-table-cell",3,"click"],[1,"d-none","d-md-table-cell"],[3,"click"],[3,"click",4,"ngFor","ngForOf"],["id","ChangeLogLevel","tabindex","-1","role","dialog","aria-labelledby","ChangeLogLevelTitle","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","ChangeLogLevelTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],["class","modal-body",4,"ngIf"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"],["title","Save As",1,"Detail",3,"click"],[1,"modal-body"],[1,"col-3","col-form-label"],["name","VC",1,"col-8","form-control",3,"ngModel","ngModelChange"],["value","fatal"],["value","warn"],["value","info"],["value","debug"],["value","trace"],["name","VP",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","VPV",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","USER",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","MAIL",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","OTHER",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","All",1,"col-8","form-control",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(Br(0,"app-sysnavbar"),Nr(1,"div",0),Nr(2,"div",1),Nr(3,"div",2),Nr(4,"div",3),Nr(5,"h2",4),mo(6," Visbo Log Files "),Fr(),Fr(),Fr(),Nr(7,"div",3),Nr(8,"form",5,6),Jr("ngSubmit",(function(){return e.getVisboLogs()})),Nr(10,"div",7),Nr(11,"label",8),mo(12,"Max age in days:"),Fr(),Nr(13,"select",9),Jr("ngModelChange",(function(t){return e.ageDays=t})),Nr(14,"option"),mo(15,"0"),Fr(),Nr(16,"option"),mo(17,"3"),Fr(),Nr(18,"option"),mo(19,"7"),Fr(),Nr(20,"option"),mo(21,"30"),Fr(),Nr(22,"option"),mo(23,"365"),Fr(),Fr(),Nr(24,"button",10),Jr("click",(function(){return e.getVisboLogs()})),mo(25,"Refresh"),Fr(),Nr(26,"div",3),Nr(27,"button",11),Jr("click",(function(){return e.getLogLevel()})),mo(28,"Change Log Level"),Fr(),Fr(),Fr(),Fr(),Fr(),Fr(),Nr(29,"div"),Nr(30,"div",1),Nr(31,"div",12),Nr(32,"table",13),Nr(33,"thead"),Nr(34,"tr"),Nr(35,"th",14),Jr("click",(function(){return e.sortTable(1)})),mo(36,"Name"),Fr(),Nr(37,"th",15),mo(38,"Host"),Fr(),Nr(39,"th",16),Jr("click",(function(){return e.sortTable(2)})),mo(40,"Modified"),Fr(),Nr(41,"th",16),Jr("click",(function(){return e.sortTable(3)})),mo(42," Size"),Fr(),Nr(43,"th"),mo(44,"Detail"),Fr(),Fr(),Fr(),Nr(45,"tbody"),Lr(46,OL,14,7,"tr",17),Fr(),Fr(),Fr(),Fr(),Fr(),Fr(),Nr(47,"div",18),Nr(48,"div",19),Nr(49,"div",20),Nr(50,"div",21),Nr(51,"h5",22),mo(52,"Change Log Level"),Fr(),Nr(53,"button",23),Nr(54,"span",24),mo(55,"\xd7"),Fr(),Fr(),Fr(),Lr(56,EL,100,7,"div",25),Nr(57,"div",26),Nr(58,"button",27),mo(59,"Close"),Fr(),Nr(60,"button",28),Jr("click",(function(){return e.setLogLevel()})),mo(61,"Save"),Fr(),Fr(),Fr(),Fr(),Fr()),2&t&&(_n(13),jr("ngModel",e.ageDays),_n(33),jr("ngForOf",e.files),_n(10),jr("ngIf",e.logLevelSetting))},directives:[CC,Eu,Fd,Tu,cu,Nd,Ou,du,gu,Gc,jc],pipes:[qc],encapsulation:2}),t})(),canActivate:[rb]},{path:"systasks",component:(()=>{class t{constructor(t,e,i,n){this.visbocenterService=t,this.visbosettingService=e,this.messageService=i,this.alertService=n}ngOnInit(){this.systemVC=this.visbocenterService.getSysVCId(),this.getVisboTasks()}getVisboTasks(){this.log("getVisboTasks"),this.visbosettingService.getVCSettingByType(this.systemVC,"Task",!0).subscribe(t=>{this.vcsetting=t,this.sortTable(void 0),this.log("get Settings success "+t.length),this.alertService.clear()},t=>{this.log(`get Settings failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}helperTaskIndex(t){this.taskIndex=t}pageTaskIndex(t){let e;e=this.taskIndex+t,e<0&&(e=0),e>=this.vcsetting.length&&(e=this.vcsetting.length-1),this.taskIndex=e}executeTask(){this.log(`execute Task Immediately: ${this.vcsetting[this.taskIndex].name} `),this.vcsetting[this.taskIndex].value.nextRun=new Date,this.visbosettingService.updateVCSetting(this.systemVC,this.vcsetting[this.taskIndex],!0).subscribe(t=>{this.log("execute Task success "+JSON.stringify(t)),this.alertService.success("Successfully set Task to execute",!1),this.vcsetting[this.taskIndex]=t},t=>{this.log(`execute Task failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}sortTable(t){this.vcsetting&&(void 0===t&&void 0!==this.sortColumn||(void 0===this.sortColumn&&(this.sortColumn=1),t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?0===t:!this.sortAscending),1===this.sortColumn?this.vcsetting.sort((function(t,e){return xh(t.name,e.name)})):2===this.sortColumn?this.vcsetting.sort((function(t,e){let i=0;return t.value.lastRun>e.value.lastRun?i=1:t.value.lastRun<e.value.lastRun&&(i=-1),i})):3===this.sortColumn?this.vcsetting.sort((function(t,e){let i=0;return t.value.nextRun>e.value.nextRun?i=1:t.value.nextRun<e.value.nextRun&&(i=-1),i})):4===this.sortColumn&&this.vcsetting.sort((function(t,e){let i=0,n=0;return t.value.taskSpecific&&t.value.taskSpecific.result&&(i=t.value.taskSpecific.result),e.value.taskSpecific&&e.value.taskSpecific.result&&(n=e.value.taskSpecific.result),i-n})),this.sortAscending||this.vcsetting.reverse())}log(t){this.messageService.add("Sys Tasks: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Ev),Rr(Eb),Rr(jh),Rr(Mf))},t.\u0275cmp=le({type:t,selectors:[["app-systasks"]],decls:29,vars:2,consts:[[1,"well"],[1,"row"],[1,"col"],[1,"panel-heading"],["type","button",1,"btn","btn-primary","float-right",3,"click"],[1,"container-fluid"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[3,"click"],[1,"d-none","d-md-table-cell",3,"click"],["data-toggle","modal","data-target","#TaskDetail",3,"click",4,"ngFor","ngForOf"],["id","TaskDetail","tabindex","-1","role","dialog","aria-labelledby","Task Detail","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-lg modal-dialog-centered","role","document",4,"ngIf"],["data-toggle","modal","data-target","#TaskDetail",3,"click"],[1,"d-none","d-md-table-cell"],["title","detail",1,"Detail"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","TaskDetailTitle",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"col-10"],["type","button","title","Prev Task",1,"btn","btn-secondary",3,"click"],[1,"col-2"],["type","button","title","Next Task",1,"btn","btn-secondary","align-self-end",3,"click"],[1,"form-group"],[1,"col-4","col-form-label"],[1,"col-7","form-control-static"],[4,"ngIf"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(Br(0,"app-sysnavbar"),Nr(1,"div",0),Nr(2,"div",1),Nr(3,"div",2),Nr(4,"h2",3),mo(5," Visbo Task System View "),Fr(),Fr(),Nr(6,"div",2),Nr(7,"button",4),Jr("click",(function(){return e.getVisboTasks()})),mo(8,"Refresh"),Fr(),Fr(),Fr(),Nr(9,"div"),Nr(10,"div",5),Nr(11,"div",6),Nr(12,"table",7),Nr(13,"thead"),Nr(14,"tr"),Nr(15,"th",8),Jr("click",(function(){return e.sortTable(1)})),mo(16,"Name"),Fr(),Nr(17,"th",9),Jr("click",(function(){return e.sortTable(2)})),mo(18,"Last Run"),Fr(),Nr(19,"th",9),Jr("click",(function(){return e.sortTable(3)})),mo(20,"Next Run"),Fr(),Nr(21,"th",8),Jr("click",(function(){return e.sortTable(4)})),mo(22,"Last Result"),Fr(),Nr(23,"th"),mo(24,"Detail"),Fr(),Fr(),Fr(),Nr(25,"tbody"),Lr(26,LL,15,10,"tr",10),Fr(),Fr(),Fr(),Fr(),Fr(),Fr(),Nr(27,"div",11),Lr(28,jL,28,2,"div",12),Fr()),2&t&&(_n(26),jr("ngForOf",e.vcsetting),_n(2),jr("ngIf",e.taskIndex>=0&&e.taskIndex<e.vcsetting.length))},directives:[CC,Gc,jc,Eu,Fd,Tu],pipes:[qc],styles:[""]}),t})(),canActivate:[rb]},{path:"sysconfig",component:(()=>{class t{constructor(t,e,i,n){this.visbocenterService=t,this.visbosettingService=e,this.messageService=i,this.alertService=n,this.combinedPerm=void 0,this.permSystem=Mv}ngOnInit(){this.systemVC=this.visbocenterService.getSysVCId(),this.getVisboConfig(),this.combinedPerm=this.visbocenterService.getSysAdminRole()}getVisboConfig(){this.log("get VisboConfig Values"),this.visbosettingService.getVCSettingByType(this.systemVC,"SysConfig",!0).subscribe(t=>{this.vcsetting=t,this.sortTable(1),this.log("get Settings success "+t.length)},t=>{this.log(`get Settings failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}getMainInfo(t){let e="";if(t.value)switch(t.name){case"UI URL":e=t.value.UIUrl;break;case"SMTP":e=t.value.auth&&t.value.auth.user;break;case"PW Policy":e=(t.value.Description||"").substring(0,60).concat("...");break;case"DEBUG":e=JSON.stringify(t.value).substring(0,60).concat("...");break;case"Log Age":e=t.value.duration;break;case"REDIS":e=t.value.host}return e||""}helperConfigName(t){for(let e=0;e<this.vcsetting.length;e++)if(this.vcsetting[e].name===t)return e}editConfigName(t){this.log("Edit Config  "+t);for(let e=0;e<this.vcsetting.length;e++)if(this.vcsetting[e].name===t)return this.editIndex=e,e}updateConfig(t){this.log("Update Config  "+JSON.stringify(t)),this.visbosettingService.updateVCSetting(this.systemVC,t,!0).subscribe(e=>{this.log("set System Config success "+JSON.stringify(e)),this.alertService.success("Successfully changed System Configuration",!0),this.vcsetting[this.helperConfigName(t.name)]=e},t=>{this.log(`set System Config failed: error: ${t.status} message: ${t.error.message}`),this.alertService.error(Gh(t))})}hasSystemPerm(t){return(this.combinedPerm.system&t)>0}sortTable(t){this.vcsetting&&(void 0===t&&void 0!==this.sortColumn||(t!==this.sortColumn&&(this.sortColumn=t,this.sortAscending=void 0),this.sortAscending=void 0===this.sortAscending?1===t:!this.sortAscending),1===this.sortColumn?this.vcsetting.sort((function(t,e){return xh(t.name,e.name)})):3===this.sortColumn&&this.vcsetting.sort((function(t,e){return Th(t.updatedAt,e.updatedAt)})),this.sortAscending||this.vcsetting.reverse())}log(t){this.messageService.add("Sys Config: "+t)}}return t.\u0275fac=function(e){return new(e||t)(Rr(Ev),Rr(Eb),Rr(jh),Rr(Mf))},t.\u0275cmp=le({type:t,selectors:[["app-sysconfig"]],decls:21,vars:2,consts:[[1,"well"],[1,"row"],[1,"panel-heading"],[1,"container-fluid"],[1,"panel-body"],[1,"table","table-hover","table-sortable"],[3,"click"],[1,"d-none","d-md-table-cell",3,"click"],["data-toggle","modal","data-target","#ConfigValue",3,"click",4,"ngFor","ngForOf"],["id","ConfigValue","tabindex","-1","role","dialog","aria-labelledby","Config Value","aria-hidden","true",1,"modal","fade"],["class","modal-dialog modal-lg modal-dialog-centered","role","document",4,"ngIf"],["data-toggle","modal","data-target","#ConfigValue",3,"click"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["class","modal-title","id","ConfigDetailTitle",4,"ngIf"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[4,"ngIf"],[1,"modal-footer","align-items-end"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button","class","btn btn-primary","data-dismiss","modal",3,"click",4,"ngIf"],["id","ConfigDetailTitle",1,"modal-title"],[1,"form-group"],["for","configUIUrl",1,"col-3","col-form-label"],["type","text","name","configUIUrl","placeholder","URL for Web UI",1,"col-7","form-control",3,"ngModel","ngModelChange"],["for","configPWPolicy",1,"col-4","col-form-label"],["type","text","name","configPWPolicy",1,"form-control",3,"ngModel","ngModelChange"],["for","configPWPolicyDesc",1,"col-4","col-form-label"],["name","configPWPolicyDesc",1,"form-control",3,"ngModel","ngModelChange"],["for","configSMTPHost",1,"col-4","col-form-label"],["type","text","name","configSMTPHost",1,"form-control",3,"ngModel","ngModelChange"],["for","configSMTPUser",1,"col-4","col-form-label"],["type","text","name","configSMTPUser",1,"form-control",3,"ngModel","ngModelChange"],["for","configSMTPUserPW",1,"col-4","col-form-label"],["type","password","name","configSMTPUserPW",1,"form-control",3,"ngModel","ngModelChange"],["for","configSMTPPort",1,"col-4","col-form-label"],["type","number","name","configSMTPPort",1,"form-control",3,"ngModel","ngModelChange"],["for","configSMTPConTimeout",1,"col-4","col-form-label"],["type","number","name","configSMTPConTimeout",1,"form-control",3,"ngModel","ngModelChange"],["for","configSMTPGreetTimeout",1,"col-4","col-form-label"],["type","number","name","configSMTPGreetTimeout",1,"form-control",3,"ngModel","ngModelChange"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","check1","name","configSMTPPool",1,"custom-control-input",3,"ngModel","ngModelChange"],["configSMTPPool","ngModel"],["for","check1",1,"custom-control-label"],["type","checkbox","id","check2","name","configSMTPSecure",1,"custom-control-input",3,"ngModel","ngModelChange"],["configSMTPSecure","ngModel"],["for","check2",1,"custom-control-label"],["type","checkbox","id","check3","name","configSMTPTls",1,"custom-control-input",3,"ngModel","ngModelChange"],["configSMTPTls","ngModel"],["for","check3",1,"custom-control-label"],["for","configREDISHost",1,"col-4","col-form-label"],["type","text","name","configREDISHost",1,"form-control",3,"ngModel","ngModelChange"],["for","configREDISPort",1,"col-4","col-form-label"],["type","number","name","configREDISPort",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group","row"],[1,"col-3","col-form-label"],["name","VC",1,"col-8","form-control",3,"ngModel","ngModelChange"],["value","fatal"],["value","warn"],["value","info"],["value","debug"],["value","trace"],["name","VP",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","VPV",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","USER",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","MAIL",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","OTHER",1,"col-8","form-control",3,"ngModel","ngModelChange"],["name","All",1,"col-8","form-control",3,"ngModel","ngModelChange"],["for","configLogAge",1,"col-4","col-form-label"],["type","number","name","configLogAge",1,"form-control",3,"ngModel","ngModelChange"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(Br(0,"app-sysnavbar"),Nr(1,"div",0),Nr(2,"div",1),Nr(3,"h2",2),mo(4," Visbo Config System View "),Fr(),Fr(),Nr(5,"div"),Nr(6,"div",3),Nr(7,"div",4),Nr(8,"table",5),Nr(9,"thead"),Nr(10,"tr"),Nr(11,"th",6),Jr("click",(function(){return e.sortTable(1)})),mo(12,"Name"),Fr(),Nr(13,"th",7),Jr("click",(function(){return e.sortTable(2)})),mo(14,"Info"),Fr(),Nr(15,"th",6),Jr("click",(function(){return e.sortTable(3)})),mo(16,"Updated"),Fr(),Fr(),Fr(),Nr(17,"tbody"),Lr(18,$L,9,6,"tr",8),Fr(),Fr(),Fr(),Fr(),Fr(),Fr(),Nr(19,"div",9),Lr(20,eG,23,13,"div",10),Fr()),2&t&&(_n(18),jr("ngForOf",e.vcsetting),_n(2),jr("ngIf",e.vcsetting&&e.editIndex>=0))},directives:[CC,Gc,jc,Eu,Fd,Tu,Ed,Nd,Ou,eu,_d,cu,du,gu],pipes:[qc],styles:[""]}),t})(),canActivate:[rb]},{path:"",redirectTo:"/dashboard",pathMatch:"full"},{path:"**",redirectTo:"/dashboard"}];let nG=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[bf.forRoot(iG,{onSameUrlNavigation:"reload"})],bf]}),t})();class sG{constructor(t,e="/assets/i18n/",i=".json"){this.http=t,this.prefix=e,this.suffix=i}getTranslation(t){return this.http.get(`${this.prefix}${t}${this.suffix}`)}}let rG=(()=>{class t{constructor(t,e){this.authenticationService=t,this.alertService=e}intercept(t,e){const i=JSON.parse(localStorage.getItem("currentToken"));return i&&(t=t.clone({setHeaders:{"access-key":""+i}})),e.handle(t).pipe(Fh(t=>(t&&401===t.status&&(console.log("Interceptor: Session Expired, redirect to login"),this.authenticationService.logout(),this.alertService.error("Session expired",!0),location.reload()),$h(t))))}}return t.\u0275fac=function(e){return new(e||t)(Kt(op),Kt(Mf))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const oG={provide:sp,useFactory:()=>{const t=new sp,e=(window||{}).__env||{};for(const i in e)e.hasOwnProperty(i)&&(t[i]=window.__env[i]);return t},deps:[]};let aG=(()=>{class t{}return t.\u0275mod=he({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[],imports:[[Qc,GV]]}),t})(),lG=(()=>{class t{}return t.\u0275mod=he({type:t,bootstrap:[kv]}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[Md,qc,rb,Mf,op,BT,Ev,Eb,Vb,xV,fC,pL,UL,{provide:fh,useClass:rG,multi:!0},jh,oG],imports:[[kd,qu,nG,LV,Sh,cv.forRoot({loader:{provide:Ff,useFactory:cG,deps:[gh]}}),aG]]}),t})();function cG(t){return new sG(t)}Ad().bootstrapModule(lG)}},[[0,0]]]);